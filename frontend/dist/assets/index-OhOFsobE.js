var lb=n=>{throw TypeError(n)};var Wf=(n,e,t)=>e.has(n)||lb("Cannot "+t);var Et=(n,e,t)=>(Wf(n,e,"read from private field"),t?t.call(n):e.get(n)),Hn=(n,e,t)=>e.has(n)?lb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Ms=(n,e,t,s)=>(Wf(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),zn=(n,e,t)=>(Wf(n,e,"access private method"),t);var ob=(n,e,t,s)=>({set _(i){Ms(n,e,i,t)},get _(){return Et(n,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(i){if(i.ep)return;i.ep=!0;const l=t(i);fetch(i.href,l)}})();function GS(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Xf={exports:{}},so={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cb;function YS(){if(cb)return so;cb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,i,l){var c=null;if(l!==void 0&&(c=""+l),i.key!==void 0&&(c=""+i.key),"key"in i){l={};for(var u in i)u!=="key"&&(l[u]=i[u])}else l=i;return i=l.ref,{$$typeof:n,type:s,key:c,ref:i!==void 0?i:null,props:l}}return so.Fragment=e,so.jsx=t,so.jsxs=t,so}var db;function WS(){return db||(db=1,Xf.exports=YS()),Xf.exports}var r=WS(),Qf={exports:{}},qe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ub;function XS(){if(ub)return qe;ub=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),x=Symbol.iterator;function y(T){return T===null||typeof T!="object"?null:(T=x&&T[x]||T["@@iterator"],typeof T=="function"?T:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,A={};function N(T,G,M){this.props=T,this.context=G,this.refs=A,this.updater=M||v}N.prototype.isReactComponent={},N.prototype.setState=function(T,G){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,G,"setState")},N.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function j(){}j.prototype=N.prototype;function _(T,G,M){this.props=T,this.context=G,this.refs=A,this.updater=M||v}var C=_.prototype=new j;C.constructor=_,w(C,N.prototype),C.isPureReactComponent=!0;var k=Array.isArray,D={H:null,A:null,T:null,S:null,V:null},P=Object.prototype.hasOwnProperty;function F(T,G,M,O,ae,ee){return M=ee.ref,{$$typeof:n,type:T,key:G,ref:M!==void 0?M:null,props:ee}}function U(T,G){return F(T.type,G,void 0,void 0,void 0,T.props)}function I(T){return typeof T=="object"&&T!==null&&T.$$typeof===n}function K(T){var G={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(M){return G[M]})}var H=/\/+/g;function X(T,G){return typeof T=="object"&&T!==null&&T.key!=null?K(""+T.key):G.toString(36)}function W(){}function ce(T){switch(T.status){case"fulfilled":return T.value;case"rejected":throw T.reason;default:switch(typeof T.status=="string"?T.then(W,W):(T.status="pending",T.then(function(G){T.status==="pending"&&(T.status="fulfilled",T.value=G)},function(G){T.status==="pending"&&(T.status="rejected",T.reason=G)})),T.status){case"fulfilled":return T.value;case"rejected":throw T.reason}}throw T}function me(T,G,M,O,ae){var ee=typeof T;(ee==="undefined"||ee==="boolean")&&(T=null);var pe=!1;if(T===null)pe=!0;else switch(ee){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(T.$$typeof){case n:case e:pe=!0;break;case p:return pe=T._init,me(pe(T._payload),G,M,O,ae)}}if(pe)return ae=ae(T),pe=O===""?"."+X(T,0):O,k(ae)?(M="",pe!=null&&(M=pe.replace(H,"$&/")+"/"),me(ae,G,M,"",function(ue){return ue})):ae!=null&&(I(ae)&&(ae=U(ae,M+(ae.key==null||T&&T.key===ae.key?"":(""+ae.key).replace(H,"$&/")+"/")+pe)),G.push(ae)),1;pe=0;var we=O===""?".":O+":";if(k(T))for(var Te=0;Te<T.length;Te++)O=T[Te],ee=we+X(O,Te),pe+=me(O,G,M,ee,ae);else if(Te=y(T),typeof Te=="function")for(T=Te.call(T),Te=0;!(O=T.next()).done;)O=O.value,ee=we+X(O,Te++),pe+=me(O,G,M,ee,ae);else if(ee==="object"){if(typeof T.then=="function")return me(ce(T),G,M,O,ae);throw G=String(T),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return pe}function L(T,G,M){if(T==null)return T;var O=[],ae=0;return me(T,O,"","",function(ee){return G.call(M,ee,ae++)}),O}function q(T){if(T._status===-1){var G=T._result;G=G(),G.then(function(M){(T._status===0||T._status===-1)&&(T._status=1,T._result=M)},function(M){(T._status===0||T._status===-1)&&(T._status=2,T._result=M)}),T._status===-1&&(T._status=0,T._result=G)}if(T._status===1)return T._result.default;throw T._result}var V=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",T);return}console.error(T)};function B(){}return qe.Children={map:L,forEach:function(T,G,M){L(T,function(){G.apply(this,arguments)},M)},count:function(T){var G=0;return L(T,function(){G++}),G},toArray:function(T){return L(T,function(G){return G})||[]},only:function(T){if(!I(T))throw Error("React.Children.only expected to receive a single React element child.");return T}},qe.Component=N,qe.Fragment=t,qe.Profiler=i,qe.PureComponent=_,qe.StrictMode=s,qe.Suspense=h,qe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,qe.__COMPILER_RUNTIME={__proto__:null,c:function(T){return D.H.useMemoCache(T)}},qe.cache=function(T){return function(){return T.apply(null,arguments)}},qe.cloneElement=function(T,G,M){if(T==null)throw Error("The argument must be a React element, but you passed "+T+".");var O=w({},T.props),ae=T.key,ee=void 0;if(G!=null)for(pe in G.ref!==void 0&&(ee=void 0),G.key!==void 0&&(ae=""+G.key),G)!P.call(G,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&G.ref===void 0||(O[pe]=G[pe]);var pe=arguments.length-2;if(pe===1)O.children=M;else if(1<pe){for(var we=Array(pe),Te=0;Te<pe;Te++)we[Te]=arguments[Te+2];O.children=we}return F(T.type,ae,void 0,void 0,ee,O)},qe.createContext=function(T){return T={$$typeof:c,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null},T.Provider=T,T.Consumer={$$typeof:l,_context:T},T},qe.createElement=function(T,G,M){var O,ae={},ee=null;if(G!=null)for(O in G.key!==void 0&&(ee=""+G.key),G)P.call(G,O)&&O!=="key"&&O!=="__self"&&O!=="__source"&&(ae[O]=G[O]);var pe=arguments.length-2;if(pe===1)ae.children=M;else if(1<pe){for(var we=Array(pe),Te=0;Te<pe;Te++)we[Te]=arguments[Te+2];ae.children=we}if(T&&T.defaultProps)for(O in pe=T.defaultProps,pe)ae[O]===void 0&&(ae[O]=pe[O]);return F(T,ee,void 0,void 0,null,ae)},qe.createRef=function(){return{current:null}},qe.forwardRef=function(T){return{$$typeof:u,render:T}},qe.isValidElement=I,qe.lazy=function(T){return{$$typeof:p,_payload:{_status:-1,_result:T},_init:q}},qe.memo=function(T,G){return{$$typeof:m,type:T,compare:G===void 0?null:G}},qe.startTransition=function(T){var G=D.T,M={};D.T=M;try{var O=T(),ae=D.S;ae!==null&&ae(M,O),typeof O=="object"&&O!==null&&typeof O.then=="function"&&O.then(B,V)}catch(ee){V(ee)}finally{D.T=G}},qe.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},qe.use=function(T){return D.H.use(T)},qe.useActionState=function(T,G,M){return D.H.useActionState(T,G,M)},qe.useCallback=function(T,G){return D.H.useCallback(T,G)},qe.useContext=function(T){return D.H.useContext(T)},qe.useDebugValue=function(){},qe.useDeferredValue=function(T,G){return D.H.useDeferredValue(T,G)},qe.useEffect=function(T,G,M){var O=D.H;if(typeof M=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return O.useEffect(T,G)},qe.useId=function(){return D.H.useId()},qe.useImperativeHandle=function(T,G,M){return D.H.useImperativeHandle(T,G,M)},qe.useInsertionEffect=function(T,G){return D.H.useInsertionEffect(T,G)},qe.useLayoutEffect=function(T,G){return D.H.useLayoutEffect(T,G)},qe.useMemo=function(T,G){return D.H.useMemo(T,G)},qe.useOptimistic=function(T,G){return D.H.useOptimistic(T,G)},qe.useReducer=function(T,G,M){return D.H.useReducer(T,G,M)},qe.useRef=function(T){return D.H.useRef(T)},qe.useState=function(T){return D.H.useState(T)},qe.useSyncExternalStore=function(T,G,M){return D.H.useSyncExternalStore(T,G,M)},qe.useTransition=function(){return D.H.useTransition()},qe.version="19.1.1",qe}var hb;function bp(){return hb||(hb=1,Qf.exports=XS()),Qf.exports}var E=bp();const Eo=GS(E);var Zf={exports:{}},no={},Kf={exports:{}},Jf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fb;function QS(){return fb||(fb=1,(function(n){function e(L,q){var V=L.length;L.push(q);e:for(;0<V;){var B=V-1>>>1,T=L[B];if(0<i(T,q))L[B]=q,L[V]=T,V=B;else break e}}function t(L){return L.length===0?null:L[0]}function s(L){if(L.length===0)return null;var q=L[0],V=L.pop();if(V!==q){L[0]=V;e:for(var B=0,T=L.length,G=T>>>1;B<G;){var M=2*(B+1)-1,O=L[M],ae=M+1,ee=L[ae];if(0>i(O,V))ae<T&&0>i(ee,O)?(L[B]=ee,L[ae]=V,B=ae):(L[B]=O,L[M]=V,B=M);else if(ae<T&&0>i(ee,V))L[B]=ee,L[ae]=V,B=ae;else break e}}return q}function i(L,q){var V=L.sortIndex-q.sortIndex;return V!==0?V:L.id-q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();n.unstable_now=function(){return c.now()-u}}var h=[],m=[],p=1,x=null,y=3,v=!1,w=!1,A=!1,N=!1,j=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function k(L){for(var q=t(m);q!==null;){if(q.callback===null)s(m);else if(q.startTime<=L)s(m),q.sortIndex=q.expirationTime,e(h,q);else break;q=t(m)}}function D(L){if(A=!1,k(L),!w)if(t(h)!==null)w=!0,P||(P=!0,X());else{var q=t(m);q!==null&&me(D,q.startTime-L)}}var P=!1,F=-1,U=5,I=-1;function K(){return N?!0:!(n.unstable_now()-I<U)}function H(){if(N=!1,P){var L=n.unstable_now();I=L;var q=!0;try{e:{w=!1,A&&(A=!1,_(F),F=-1),v=!0;var V=y;try{t:{for(k(L),x=t(h);x!==null&&!(x.expirationTime>L&&K());){var B=x.callback;if(typeof B=="function"){x.callback=null,y=x.priorityLevel;var T=B(x.expirationTime<=L);if(L=n.unstable_now(),typeof T=="function"){x.callback=T,k(L),q=!0;break t}x===t(h)&&s(h),k(L)}else s(h);x=t(h)}if(x!==null)q=!0;else{var G=t(m);G!==null&&me(D,G.startTime-L),q=!1}}break e}finally{x=null,y=V,v=!1}q=void 0}}finally{q?X():P=!1}}}var X;if(typeof C=="function")X=function(){C(H)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,ce=W.port2;W.port1.onmessage=H,X=function(){ce.postMessage(null)}}else X=function(){j(H,0)};function me(L,q){F=j(function(){L(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(L){L.callback=null},n.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<L?Math.floor(1e3/L):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_next=function(L){switch(y){case 1:case 2:case 3:var q=3;break;default:q=y}var V=y;y=q;try{return L()}finally{y=V}},n.unstable_requestPaint=function(){N=!0},n.unstable_runWithPriority=function(L,q){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var V=y;y=L;try{return q()}finally{y=V}},n.unstable_scheduleCallback=function(L,q,V){var B=n.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?B+V:B):V=B,L){case 1:var T=-1;break;case 2:T=250;break;case 5:T=1073741823;break;case 4:T=1e4;break;default:T=5e3}return T=V+T,L={id:p++,callback:q,priorityLevel:L,startTime:V,expirationTime:T,sortIndex:-1},V>B?(L.sortIndex=V,e(m,L),t(h)===null&&L===t(m)&&(A?(_(F),F=-1):A=!0,me(D,V-B))):(L.sortIndex=T,e(h,L),w||v||(w=!0,P||(P=!0,X()))),L},n.unstable_shouldYield=K,n.unstable_wrapCallback=function(L){var q=y;return function(){var V=y;y=q;try{return L.apply(this,arguments)}finally{y=V}}}})(Jf)),Jf}var mb;function ZS(){return mb||(mb=1,Kf.exports=QS()),Kf.exports}var em={exports:{}},gs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pb;function KS(){if(pb)return gs;pb=1;var n=bp();function e(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)m+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function l(h,m,p){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:x==null?null:""+x,children:h,containerInfo:m,implementation:p}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return gs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,gs.createPortal=function(h,m){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(h,m,null,p)},gs.flushSync=function(h){var m=c.T,p=s.p;try{if(c.T=null,s.p=2,h)return h()}finally{c.T=m,s.p=p,s.d.f()}},gs.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(h,m))},gs.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},gs.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var p=m.as,x=u(p,m.crossOrigin),y=typeof m.integrity=="string"?m.integrity:void 0,v=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;p==="style"?s.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:v}):p==="script"&&s.d.X(h,{crossOrigin:x,integrity:y,fetchPriority:v,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},gs.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var p=u(m.as,m.crossOrigin);s.d.M(h,{crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(h)},gs.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var p=m.as,x=u(p,m.crossOrigin);s.d.L(h,p,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},gs.preloadModule=function(h,m){if(typeof h=="string")if(m){var p=u(m.as,m.crossOrigin);s.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(h)},gs.requestFormReset=function(h){s.d.r(h)},gs.unstable_batchedUpdates=function(h,m){return h(m)},gs.useFormState=function(h,m,p){return c.H.useFormState(h,m,p)},gs.useFormStatus=function(){return c.H.useHostTransitionStatus()},gs.version="19.1.1",gs}var gb;function bw(){if(gb)return em.exports;gb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),em.exports=KS(),em.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xb;function JS(){if(xb)return no;xb=1;var n=ZS(),e=bp(),t=bw();function s(a){var o="https://react.dev/errors/"+a;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var o=a,d=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,(o.flags&4098)!==0&&(d=o.return),a=o.return;while(a)}return o.tag===3?d:null}function c(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function u(a){if(l(a)!==a)throw Error(s(188))}function h(a){var o=a.alternate;if(!o){if(o=l(a),o===null)throw Error(s(188));return o!==a?null:a}for(var d=a,f=o;;){var g=d.return;if(g===null)break;var b=g.alternate;if(b===null){if(f=g.return,f!==null){d=f;continue}break}if(g.child===b.child){for(b=g.child;b;){if(b===d)return u(g),a;if(b===f)return u(g),o;b=b.sibling}throw Error(s(188))}if(d.return!==f.return)d=g,f=b;else{for(var S=!1,R=g.child;R;){if(R===d){S=!0,d=g,f=b;break}if(R===f){S=!0,f=g,d=b;break}R=R.sibling}if(!S){for(R=b.child;R;){if(R===d){S=!0,d=b,f=g;break}if(R===f){S=!0,f=b,d=g;break}R=R.sibling}if(!S)throw Error(s(189))}}if(d.alternate!==f)throw Error(s(190))}if(d.tag!==3)throw Error(s(188));return d.stateNode.current===d?a:o}function m(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a;for(a=a.child;a!==null;){if(o=m(a),o!==null)return o;a=a.sibling}return null}var p=Object.assign,x=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),C=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),K=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function X(a){return a===null||typeof a!="object"?null:(a=H&&a[H]||a["@@iterator"],typeof a=="function"?a:null)}var W=Symbol.for("react.client.reference");function ce(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===W?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case w:return"Fragment";case N:return"Profiler";case A:return"StrictMode";case D:return"Suspense";case P:return"SuspenseList";case I:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case v:return"Portal";case C:return(a.displayName||"Context")+".Provider";case _:return(a._context.displayName||"Context")+".Consumer";case k:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case F:return o=a.displayName||null,o!==null?o:ce(a.type)||"Memo";case U:o=a._payload,a=a._init;try{return ce(a(o))}catch{}}return null}var me=Array.isArray,L=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},B=[],T=-1;function G(a){return{current:a}}function M(a){0>T||(a.current=B[T],B[T]=null,T--)}function O(a,o){T++,B[T]=a.current,a.current=o}var ae=G(null),ee=G(null),pe=G(null),we=G(null);function Te(a,o){switch(O(pe,o),O(ee,a),O(ae,null),o.nodeType){case 9:case 11:a=(a=o.documentElement)&&(a=a.namespaceURI)?Oy(a):0;break;default:if(a=o.tagName,o=o.namespaceURI)o=Oy(o),a=Py(o,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}M(ae),O(ae,a)}function ue(){M(ae),M(ee),M(pe)}function He(a){a.memoizedState!==null&&O(we,a);var o=ae.current,d=Py(o,a.type);o!==d&&(O(ee,a),O(ae,d))}function ze(a){ee.current===a&&(M(ae),M(ee)),we.current===a&&(M(we),Zl._currentValue=V)}var at=Object.prototype.hasOwnProperty,At=n.unstable_scheduleCallback,le=n.unstable_cancelCallback,be=n.unstable_shouldYield,ye=n.unstable_requestPaint,Ee=n.unstable_now,Xe=n.unstable_getCurrentPriorityLevel,te=n.unstable_ImmediatePriority,Ne=n.unstable_UserBlockingPriority,Ie=n.unstable_NormalPriority,Ze=n.unstable_LowPriority,Nt=n.unstable_IdlePriority,ls=n.log,de=n.unstable_setDisableYieldValue,Ae=null,je=null;function $e(a){if(typeof ls=="function"&&de(a),je&&typeof je.setStrictMode=="function")try{je.setStrictMode(Ae,a)}catch{}}var ct=Math.clz32?Math.clz32:Rt,Xt=Math.log,Qn=Math.LN2;function Rt(a){return a>>>=0,a===0?32:31-(Xt(a)/Qn|0)|0}var tn=256,Hs=4194304;function ws(a){var o=a&42;if(o!==0)return o;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function gn(a,o,d){var f=a.pendingLanes;if(f===0)return 0;var g=0,b=a.suspendedLanes,S=a.pingedLanes;a=a.warmLanes;var R=f&134217727;return R!==0?(f=R&~b,f!==0?g=ws(f):(S&=R,S!==0?g=ws(S):d||(d=R&~a,d!==0&&(g=ws(d))))):(R=f&~b,R!==0?g=ws(R):S!==0?g=ws(S):d||(d=f&~a,d!==0&&(g=ws(d)))),g===0?0:o!==0&&o!==g&&(o&b)===0&&(b=g&-g,d=o&-o,b>=d||b===32&&(d&4194048)!==0)?o:g}function zs(a,o){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&o)===0}function ri(a,o){switch(a){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function li(){var a=tn;return tn<<=1,(tn&4194048)===0&&(tn=256),a}function xn(){var a=Hs;return Hs<<=1,(Hs&62914560)===0&&(Hs=4194304),a}function er(a){for(var o=[],d=0;31>d;d++)o.push(a);return o}function Fs(a,o){a.pendingLanes|=o,o!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function tr(a,o,d,f,g,b){var S=a.pendingLanes;a.pendingLanes=d,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=d,a.entangledLanes&=d,a.errorRecoveryDisabledLanes&=d,a.shellSuspendCounter=0;var R=a.entanglements,z=a.expirationTimes,J=a.hiddenUpdates;for(d=S&~d;0<d;){var he=31-ct(d),ge=1<<he;R[he]=0,z[he]=-1;var se=J[he];if(se!==null)for(J[he]=null,he=0;he<se.length;he++){var ne=se[he];ne!==null&&(ne.lane&=-536870913)}d&=~ge}f!==0&&zu(a,f,0),b!==0&&g===0&&a.tag!==0&&(a.suspendedLanes|=b&~(S&~o))}function zu(a,o,d){a.pendingLanes|=o,a.suspendedLanes&=~o;var f=31-ct(o);a.entangledLanes|=o,a.entanglements[f]=a.entanglements[f]|1073741824|d&4194090}function oi(a,o){var d=a.entangledLanes|=o;for(a=a.entanglements;d;){var f=31-ct(d),g=1<<f;g&o|a[f]&o&&(a[f]|=o),d&=~g}}function Q(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function ve(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Ce(){var a=q.p;return a!==0?a:(a=window.event,a===void 0?32:tb(a.type))}function Ge(a,o){var d=q.p;try{return q.p=a,o()}finally{q.p=d}}var vt=Math.random().toString(36).slice(2),yt="__reactFiber$"+vt,jt="__reactProps$"+vt,sn="__reactContainer$"+vt,_s="__reactEvents$"+vt,yn="__reactListeners$"+vt,Us="__reactHandles$"+vt,Cs="__reactResources$"+vt,bn="__reactMarker$"+vt;function ms(a){delete a[yt],delete a[jt],delete a[_s],delete a[yn],delete a[Us]}function vn(a){var o=a[yt];if(o)return o;for(var d=a.parentNode;d;){if(o=d[sn]||d[yt]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(a=zy(a);a!==null;){if(d=a[yt])return d;a=zy(a)}return o}a=d,d=a.parentNode}return null}function Mn(a){if(a=a[yt]||a[sn]){var o=a.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return a}return null}function wa(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a.stateNode;throw Error(s(33))}function sr(a){var o=a[Cs];return o||(o=a[Cs]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Jt(a){a[bn]=!0}var jg=new Set,Sg={};function ci(a,o){nr(a,o),nr(a+"Capture",o)}function nr(a,o){for(Sg[a]=o,a=0;a<o.length;a++)jg.add(o[a])}var BN=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Eg={},_g={};function HN(a){return at.call(_g,a)?!0:at.call(Eg,a)?!1:BN.test(a)?_g[a]=!0:(Eg[a]=!0,!1)}function tc(a,o,d){if(HN(o))if(d===null)a.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":a.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(o);return}}a.setAttribute(o,""+d)}}function sc(a,o,d){if(d===null)a.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttribute(o,""+d)}}function Zn(a,o,d,f){if(f===null)a.removeAttribute(d);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(d);return}a.setAttributeNS(o,d,""+f)}}var Fu,Cg;function ar(a){if(Fu===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);Fu=o&&o[1]||"",Cg=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Fu+a+Cg}var Uu=!1;function $u(a,o){if(!a||Uu)return"";Uu=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var ge=function(){throw Error()};if(Object.defineProperty(ge.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ge,[])}catch(ne){var se=ne}Reflect.construct(a,[],ge)}else{try{ge.call()}catch(ne){se=ne}a.call(ge.prototype)}}else{try{throw Error()}catch(ne){se=ne}(ge=a())&&typeof ge.catch=="function"&&ge.catch(function(){})}}catch(ne){if(ne&&se&&typeof ne.stack=="string")return[ne.stack,se.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=f.DetermineComponentFrameRoot(),S=b[0],R=b[1];if(S&&R){var z=S.split(`
`),J=R.split(`
`);for(g=f=0;f<z.length&&!z[f].includes("DetermineComponentFrameRoot");)f++;for(;g<J.length&&!J[g].includes("DetermineComponentFrameRoot");)g++;if(f===z.length||g===J.length)for(f=z.length-1,g=J.length-1;1<=f&&0<=g&&z[f]!==J[g];)g--;for(;1<=f&&0<=g;f--,g--)if(z[f]!==J[g]){if(f!==1||g!==1)do if(f--,g--,0>g||z[f]!==J[g]){var he=`
`+z[f].replace(" at new "," at ");return a.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",a.displayName)),he}while(1<=f&&0<=g);break}}}finally{Uu=!1,Error.prepareStackTrace=d}return(d=a?a.displayName||a.name:"")?ar(d):""}function zN(a){switch(a.tag){case 26:case 27:case 5:return ar(a.type);case 16:return ar("Lazy");case 13:return ar("Suspense");case 19:return ar("SuspenseList");case 0:case 15:return $u(a.type,!1);case 11:return $u(a.type.render,!1);case 1:return $u(a.type,!0);case 31:return ar("Activity");default:return""}}function Tg(a){try{var o="";do o+=zN(a),a=a.return;while(a);return o}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function nn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Dg(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function FN(a){var o=Dg(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,o),f=""+a[o];if(!a.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var g=d.get,b=d.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return g.call(this)},set:function(S){f=""+S,b.call(this,S)}}),Object.defineProperty(a,o,{enumerable:d.enumerable}),{getValue:function(){return f},setValue:function(S){f=""+S},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function nc(a){a._valueTracker||(a._valueTracker=FN(a))}function Rg(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var d=o.getValue(),f="";return a&&(f=Dg(a)?a.checked?"true":"false":a.value),a=f,a!==d?(o.setValue(a),!0):!1}function ac(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var UN=/[\n"\\]/g;function an(a){return a.replace(UN,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Vu(a,o,d,f,g,b,S,R){a.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?a.type=S:a.removeAttribute("type"),o!=null?S==="number"?(o===0&&a.value===""||a.value!=o)&&(a.value=""+nn(o)):a.value!==""+nn(o)&&(a.value=""+nn(o)):S!=="submit"&&S!=="reset"||a.removeAttribute("value"),o!=null?qu(a,S,nn(o)):d!=null?qu(a,S,nn(d)):f!=null&&a.removeAttribute("value"),g==null&&b!=null&&(a.defaultChecked=!!b),g!=null&&(a.checked=g&&typeof g!="function"&&typeof g!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?a.name=""+nn(R):a.removeAttribute("name")}function kg(a,o,d,f,g,b,S,R){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(a.type=b),o!=null||d!=null){if(!(b!=="submit"&&b!=="reset"||o!=null))return;d=d!=null?""+nn(d):"",o=o!=null?""+nn(o):d,R||o===a.value||(a.value=o),a.defaultValue=o}f=f??g,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=R?a.checked:!!f,a.defaultChecked=!!f,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(a.name=S)}function qu(a,o,d){o==="number"&&ac(a.ownerDocument)===a||a.defaultValue===""+d||(a.defaultValue=""+d)}function ir(a,o,d,f){if(a=a.options,o){o={};for(var g=0;g<d.length;g++)o["$"+d[g]]=!0;for(d=0;d<a.length;d++)g=o.hasOwnProperty("$"+a[d].value),a[d].selected!==g&&(a[d].selected=g),g&&f&&(a[d].defaultSelected=!0)}else{for(d=""+nn(d),o=null,g=0;g<a.length;g++){if(a[g].value===d){a[g].selected=!0,f&&(a[g].defaultSelected=!0);return}o!==null||a[g].disabled||(o=a[g])}o!==null&&(o.selected=!0)}}function Mg(a,o,d){if(o!=null&&(o=""+nn(o),o!==a.value&&(a.value=o),d==null)){a.defaultValue!==o&&(a.defaultValue=o);return}a.defaultValue=d!=null?""+nn(d):""}function Lg(a,o,d,f){if(o==null){if(f!=null){if(d!=null)throw Error(s(92));if(me(f)){if(1<f.length)throw Error(s(93));f=f[0]}d=f}d==null&&(d=""),o=d}d=nn(o),a.defaultValue=d,f=a.textContent,f===d&&f!==""&&f!==null&&(a.value=f)}function rr(a,o){if(o){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=o;return}}a.textContent=o}var $N=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Og(a,o,d){var f=o.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?f?a.setProperty(o,""):o==="float"?a.cssFloat="":a[o]="":f?a.setProperty(o,d):typeof d!="number"||d===0||$N.has(o)?o==="float"?a.cssFloat=d:a[o]=(""+d).trim():a[o]=d+"px"}function Pg(a,o,d){if(o!=null&&typeof o!="object")throw Error(s(62));if(a=a.style,d!=null){for(var f in d)!d.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var g in o)f=o[g],o.hasOwnProperty(g)&&d[g]!==f&&Og(a,g,f)}else for(var b in o)o.hasOwnProperty(b)&&Og(a,b,o[b])}function Gu(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var VN=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qN=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ic(a){return qN.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var Yu=null;function Wu(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var lr=null,or=null;function Ig(a){var o=Mn(a);if(o&&(a=o.stateNode)){var d=a[jt]||null;e:switch(a=o.stateNode,o.type){case"input":if(Vu(a,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),o=d.name,d.type==="radio"&&o!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+an(""+o)+'"][type="radio"]'),o=0;o<d.length;o++){var f=d[o];if(f!==a&&f.form===a.form){var g=f[jt]||null;if(!g)throw Error(s(90));Vu(f,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<d.length;o++)f=d[o],f.form===a.form&&Rg(f)}break e;case"textarea":Mg(a,d.value,d.defaultValue);break e;case"select":o=d.value,o!=null&&ir(a,!!d.multiple,o,!1)}}}var Xu=!1;function Bg(a,o,d){if(Xu)return a(o,d);Xu=!0;try{var f=a(o);return f}finally{if(Xu=!1,(lr!==null||or!==null)&&(Vc(),lr&&(o=lr,a=or,or=lr=null,Ig(o),a)))for(o=0;o<a.length;o++)Ig(a[o])}}function dl(a,o){var d=a.stateNode;if(d===null)return null;var f=d[jt]||null;if(f===null)return null;d=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(s(231,o,typeof d));return d}var Kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qu=!1;if(Kn)try{var ul={};Object.defineProperty(ul,"passive",{get:function(){Qu=!0}}),window.addEventListener("test",ul,ul),window.removeEventListener("test",ul,ul)}catch{Qu=!1}var Aa=null,Zu=null,rc=null;function Hg(){if(rc)return rc;var a,o=Zu,d=o.length,f,g="value"in Aa?Aa.value:Aa.textContent,b=g.length;for(a=0;a<d&&o[a]===g[a];a++);var S=d-a;for(f=1;f<=S&&o[d-f]===g[b-f];f++);return rc=g.slice(a,1<f?1-f:void 0)}function lc(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function oc(){return!0}function zg(){return!1}function Ts(a){function o(d,f,g,b,S){this._reactName=d,this._targetInst=g,this.type=f,this.nativeEvent=b,this.target=S,this.currentTarget=null;for(var R in a)a.hasOwnProperty(R)&&(d=a[R],this[R]=d?d(b):b[R]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?oc:zg,this.isPropagationStopped=zg,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=oc)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=oc)},persist:function(){},isPersistent:oc}),o}var di={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cc=Ts(di),hl=p({},di,{view:0,detail:0}),GN=Ts(hl),Ku,Ju,fl,dc=p({},hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:th,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==fl&&(fl&&a.type==="mousemove"?(Ku=a.screenX-fl.screenX,Ju=a.screenY-fl.screenY):Ju=Ku=0,fl=a),Ku)},movementY:function(a){return"movementY"in a?a.movementY:Ju}}),Fg=Ts(dc),YN=p({},dc,{dataTransfer:0}),WN=Ts(YN),XN=p({},hl,{relatedTarget:0}),eh=Ts(XN),QN=p({},di,{animationName:0,elapsedTime:0,pseudoElement:0}),ZN=Ts(QN),KN=p({},di,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),JN=Ts(KN),ej=p({},di,{data:0}),Ug=Ts(ej),tj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aj(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=nj[a])?!!o[a]:!1}function th(){return aj}var ij=p({},hl,{key:function(a){if(a.key){var o=tj[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=lc(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?sj[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:th,charCode:function(a){return a.type==="keypress"?lc(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?lc(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),rj=Ts(ij),lj=p({},dc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$g=Ts(lj),oj=p({},hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:th}),cj=Ts(oj),dj=p({},di,{propertyName:0,elapsedTime:0,pseudoElement:0}),uj=Ts(dj),hj=p({},dc,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),fj=Ts(hj),mj=p({},di,{newState:0,oldState:0}),pj=Ts(mj),gj=[9,13,27,32],sh=Kn&&"CompositionEvent"in window,ml=null;Kn&&"documentMode"in document&&(ml=document.documentMode);var xj=Kn&&"TextEvent"in window&&!ml,Vg=Kn&&(!sh||ml&&8<ml&&11>=ml),qg=" ",Gg=!1;function Yg(a,o){switch(a){case"keyup":return gj.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wg(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var cr=!1;function yj(a,o){switch(a){case"compositionend":return Wg(o);case"keypress":return o.which!==32?null:(Gg=!0,qg);case"textInput":return a=o.data,a===qg&&Gg?null:a;default:return null}}function bj(a,o){if(cr)return a==="compositionend"||!sh&&Yg(a,o)?(a=Hg(),rc=Zu=Aa=null,cr=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Vg&&o.locale!=="ko"?null:o.data;default:return null}}var vj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xg(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!vj[a.type]:o==="textarea"}function Qg(a,o,d,f){lr?or?or.push(f):or=[f]:lr=f,o=Qc(o,"onChange"),0<o.length&&(d=new cc("onChange","change",null,d,f),a.push({event:d,listeners:o}))}var pl=null,gl=null;function wj(a){Dy(a,0)}function uc(a){var o=wa(a);if(Rg(o))return a}function Zg(a,o){if(a==="change")return o}var Kg=!1;if(Kn){var nh;if(Kn){var ah="oninput"in document;if(!ah){var Jg=document.createElement("div");Jg.setAttribute("oninput","return;"),ah=typeof Jg.oninput=="function"}nh=ah}else nh=!1;Kg=nh&&(!document.documentMode||9<document.documentMode)}function ex(){pl&&(pl.detachEvent("onpropertychange",tx),gl=pl=null)}function tx(a){if(a.propertyName==="value"&&uc(gl)){var o=[];Qg(o,gl,a,Wu(a)),Bg(wj,o)}}function Aj(a,o,d){a==="focusin"?(ex(),pl=o,gl=d,pl.attachEvent("onpropertychange",tx)):a==="focusout"&&ex()}function Nj(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return uc(gl)}function jj(a,o){if(a==="click")return uc(o)}function Sj(a,o){if(a==="input"||a==="change")return uc(o)}function Ej(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var $s=typeof Object.is=="function"?Object.is:Ej;function xl(a,o){if($s(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var d=Object.keys(a),f=Object.keys(o);if(d.length!==f.length)return!1;for(f=0;f<d.length;f++){var g=d[f];if(!at.call(o,g)||!$s(a[g],o[g]))return!1}return!0}function sx(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function nx(a,o){var d=sx(a);a=0;for(var f;d;){if(d.nodeType===3){if(f=a+d.textContent.length,a<=o&&f>=o)return{node:d,offset:o-a};a=f}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=sx(d)}}function ax(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?ax(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function ix(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var o=ac(a.document);o instanceof a.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)a=o.contentWindow;else break;o=ac(a.document)}return o}function ih(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}var _j=Kn&&"documentMode"in document&&11>=document.documentMode,dr=null,rh=null,yl=null,lh=!1;function rx(a,o,d){var f=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;lh||dr==null||dr!==ac(f)||(f=dr,"selectionStart"in f&&ih(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),yl&&xl(yl,f)||(yl=f,f=Qc(rh,"onSelect"),0<f.length&&(o=new cc("onSelect","select",null,o,d),a.push({event:o,listeners:f}),o.target=dr)))}function ui(a,o){var d={};return d[a.toLowerCase()]=o.toLowerCase(),d["Webkit"+a]="webkit"+o,d["Moz"+a]="moz"+o,d}var ur={animationend:ui("Animation","AnimationEnd"),animationiteration:ui("Animation","AnimationIteration"),animationstart:ui("Animation","AnimationStart"),transitionrun:ui("Transition","TransitionRun"),transitionstart:ui("Transition","TransitionStart"),transitioncancel:ui("Transition","TransitionCancel"),transitionend:ui("Transition","TransitionEnd")},oh={},lx={};Kn&&(lx=document.createElement("div").style,"AnimationEvent"in window||(delete ur.animationend.animation,delete ur.animationiteration.animation,delete ur.animationstart.animation),"TransitionEvent"in window||delete ur.transitionend.transition);function hi(a){if(oh[a])return oh[a];if(!ur[a])return a;var o=ur[a],d;for(d in o)if(o.hasOwnProperty(d)&&d in lx)return oh[a]=o[d];return a}var ox=hi("animationend"),cx=hi("animationiteration"),dx=hi("animationstart"),Cj=hi("transitionrun"),Tj=hi("transitionstart"),Dj=hi("transitioncancel"),ux=hi("transitionend"),hx=new Map,ch="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ch.push("scrollEnd");function wn(a,o){hx.set(a,o),ci(o,[a])}var fx=new WeakMap;function rn(a,o){if(typeof a=="object"&&a!==null){var d=fx.get(a);return d!==void 0?d:(o={value:a,source:o,stack:Tg(o)},fx.set(a,o),o)}return{value:a,source:o,stack:Tg(o)}}var ln=[],hr=0,dh=0;function hc(){for(var a=hr,o=dh=hr=0;o<a;){var d=ln[o];ln[o++]=null;var f=ln[o];ln[o++]=null;var g=ln[o];ln[o++]=null;var b=ln[o];if(ln[o++]=null,f!==null&&g!==null){var S=f.pending;S===null?g.next=g:(g.next=S.next,S.next=g),f.pending=g}b!==0&&mx(d,g,b)}}function fc(a,o,d,f){ln[hr++]=a,ln[hr++]=o,ln[hr++]=d,ln[hr++]=f,dh|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function uh(a,o,d,f){return fc(a,o,d,f),mc(a)}function fr(a,o){return fc(a,null,null,o),mc(a)}function mx(a,o,d){a.lanes|=d;var f=a.alternate;f!==null&&(f.lanes|=d);for(var g=!1,b=a.return;b!==null;)b.childLanes|=d,f=b.alternate,f!==null&&(f.childLanes|=d),b.tag===22&&(a=b.stateNode,a===null||a._visibility&1||(g=!0)),a=b,b=b.return;return a.tag===3?(b=a.stateNode,g&&o!==null&&(g=31-ct(d),a=b.hiddenUpdates,f=a[g],f===null?a[g]=[o]:f.push(o),o.lane=d|536870912),b):null}function mc(a){if(50<$l)throw $l=0,yf=null,Error(s(185));for(var o=a.return;o!==null;)a=o,o=a.return;return a.tag===3?a.stateNode:null}var mr={};function Rj(a,o,d,f){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vs(a,o,d,f){return new Rj(a,o,d,f)}function hh(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Jn(a,o){var d=a.alternate;return d===null?(d=Vs(a.tag,o,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=o,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&65011712,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,o=a.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d.refCleanup=a.refCleanup,d}function px(a,o){a.flags&=65011714;var d=a.alternate;return d===null?(a.childLanes=0,a.lanes=o,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=d.childLanes,a.lanes=d.lanes,a.child=d.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=d.memoizedProps,a.memoizedState=d.memoizedState,a.updateQueue=d.updateQueue,a.type=d.type,o=d.dependencies,a.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),a}function pc(a,o,d,f,g,b){var S=0;if(f=a,typeof a=="function")hh(a)&&(S=1);else if(typeof a=="string")S=MS(a,d,ae.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case I:return a=Vs(31,d,o,g),a.elementType=I,a.lanes=b,a;case w:return fi(d.children,g,b,o);case A:S=8,g|=24;break;case N:return a=Vs(12,d,o,g|2),a.elementType=N,a.lanes=b,a;case D:return a=Vs(13,d,o,g),a.elementType=D,a.lanes=b,a;case P:return a=Vs(19,d,o,g),a.elementType=P,a.lanes=b,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case j:case C:S=10;break e;case _:S=9;break e;case k:S=11;break e;case F:S=14;break e;case U:S=16,f=null;break e}S=29,d=Error(s(130,a===null?"null":typeof a,"")),f=null}return o=Vs(S,d,o,g),o.elementType=a,o.type=f,o.lanes=b,o}function fi(a,o,d,f){return a=Vs(7,a,f,o),a.lanes=d,a}function fh(a,o,d){return a=Vs(6,a,null,o),a.lanes=d,a}function mh(a,o,d){return o=Vs(4,a.children!==null?a.children:[],a.key,o),o.lanes=d,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}var pr=[],gr=0,gc=null,xc=0,on=[],cn=0,mi=null,ea=1,ta="";function pi(a,o){pr[gr++]=xc,pr[gr++]=gc,gc=a,xc=o}function gx(a,o,d){on[cn++]=ea,on[cn++]=ta,on[cn++]=mi,mi=a;var f=ea;a=ta;var g=32-ct(f)-1;f&=~(1<<g),d+=1;var b=32-ct(o)+g;if(30<b){var S=g-g%5;b=(f&(1<<S)-1).toString(32),f>>=S,g-=S,ea=1<<32-ct(o)+g|d<<g|f,ta=b+a}else ea=1<<b|d<<g|f,ta=a}function ph(a){a.return!==null&&(pi(a,1),gx(a,1,0))}function gh(a){for(;a===gc;)gc=pr[--gr],pr[gr]=null,xc=pr[--gr],pr[gr]=null;for(;a===mi;)mi=on[--cn],on[cn]=null,ta=on[--cn],on[cn]=null,ea=on[--cn],on[cn]=null}var As=null,Ot=null,lt=!1,gi=null,Ln=!1,xh=Error(s(519));function xi(a){var o=Error(s(418,""));throw wl(rn(o,a)),xh}function xx(a){var o=a.stateNode,d=a.type,f=a.memoizedProps;switch(o[yt]=a,o[jt]=f,d){case"dialog":Je("cancel",o),Je("close",o);break;case"iframe":case"object":case"embed":Je("load",o);break;case"video":case"audio":for(d=0;d<ql.length;d++)Je(ql[d],o);break;case"source":Je("error",o);break;case"img":case"image":case"link":Je("error",o),Je("load",o);break;case"details":Je("toggle",o);break;case"input":Je("invalid",o),kg(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),nc(o);break;case"select":Je("invalid",o);break;case"textarea":Je("invalid",o),Lg(o,f.value,f.defaultValue,f.children),nc(o)}d=f.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||o.textContent===""+d||f.suppressHydrationWarning===!0||Ly(o.textContent,d)?(f.popover!=null&&(Je("beforetoggle",o),Je("toggle",o)),f.onScroll!=null&&Je("scroll",o),f.onScrollEnd!=null&&Je("scrollend",o),f.onClick!=null&&(o.onclick=Zc),o=!0):o=!1,o||xi(a)}function yx(a){for(As=a.return;As;)switch(As.tag){case 5:case 13:Ln=!1;return;case 27:case 3:Ln=!0;return;default:As=As.return}}function bl(a){if(a!==As)return!1;if(!lt)return yx(a),lt=!0,!1;var o=a.tag,d;if((d=o!==3&&o!==27)&&((d=o===5)&&(d=a.type,d=!(d!=="form"&&d!=="button")||Lf(a.type,a.memoizedProps)),d=!d),d&&Ot&&xi(a),yx(a),o===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(s(317));e:{for(a=a.nextSibling,o=0;a;){if(a.nodeType===8)if(d=a.data,d==="/$"){if(o===0){Ot=Nn(a.nextSibling);break e}o--}else d!=="$"&&d!=="$!"&&d!=="$?"||o++;a=a.nextSibling}Ot=null}}else o===27?(o=Ot,Ba(a.type)?(a=Bf,Bf=null,Ot=a):Ot=o):Ot=As?Nn(a.stateNode.nextSibling):null;return!0}function vl(){Ot=As=null,lt=!1}function bx(){var a=gi;return a!==null&&(ks===null?ks=a:ks.push.apply(ks,a),gi=null),a}function wl(a){gi===null?gi=[a]:gi.push(a)}var yh=G(null),yi=null,sa=null;function Na(a,o,d){O(yh,o._currentValue),o._currentValue=d}function na(a){a._currentValue=yh.current,M(yh)}function bh(a,o,d){for(;a!==null;){var f=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),a===d)break;a=a.return}}function vh(a,o,d,f){var g=a.child;for(g!==null&&(g.return=a);g!==null;){var b=g.dependencies;if(b!==null){var S=g.child;b=b.firstContext;e:for(;b!==null;){var R=b;b=g;for(var z=0;z<o.length;z++)if(R.context===o[z]){b.lanes|=d,R=b.alternate,R!==null&&(R.lanes|=d),bh(b.return,d,a),f||(S=null);break e}b=R.next}}else if(g.tag===18){if(S=g.return,S===null)throw Error(s(341));S.lanes|=d,b=S.alternate,b!==null&&(b.lanes|=d),bh(S,d,a),S=null}else S=g.child;if(S!==null)S.return=g;else for(S=g;S!==null;){if(S===a){S=null;break}if(g=S.sibling,g!==null){g.return=S.return,S=g;break}S=S.return}g=S}}function Al(a,o,d,f){a=null;for(var g=o,b=!1;g!==null;){if(!b){if((g.flags&524288)!==0)b=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var S=g.alternate;if(S===null)throw Error(s(387));if(S=S.memoizedProps,S!==null){var R=g.type;$s(g.pendingProps.value,S.value)||(a!==null?a.push(R):a=[R])}}else if(g===we.current){if(S=g.alternate,S===null)throw Error(s(387));S.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(a!==null?a.push(Zl):a=[Zl])}g=g.return}a!==null&&vh(o,a,d,f),o.flags|=262144}function yc(a){for(a=a.firstContext;a!==null;){if(!$s(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function bi(a){yi=a,sa=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function ps(a){return vx(yi,a)}function bc(a,o){return yi===null&&bi(a),vx(a,o)}function vx(a,o){var d=o._currentValue;if(o={context:o,memoizedValue:d,next:null},sa===null){if(a===null)throw Error(s(308));sa=o,a.dependencies={lanes:0,firstContext:o},a.flags|=524288}else sa=sa.next=o;return d}var kj=typeof AbortController<"u"?AbortController:function(){var a=[],o=this.signal={aborted:!1,addEventListener:function(d,f){a.push(f)}};this.abort=function(){o.aborted=!0,a.forEach(function(d){return d()})}},Mj=n.unstable_scheduleCallback,Lj=n.unstable_NormalPriority,Qt={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wh(){return{controller:new kj,data:new Map,refCount:0}}function Nl(a){a.refCount--,a.refCount===0&&Mj(Lj,function(){a.controller.abort()})}var jl=null,Ah=0,xr=0,yr=null;function Oj(a,o){if(jl===null){var d=jl=[];Ah=0,xr=Sf(),yr={status:"pending",value:void 0,then:function(f){d.push(f)}}}return Ah++,o.then(wx,wx),o}function wx(){if(--Ah===0&&jl!==null){yr!==null&&(yr.status="fulfilled");var a=jl;jl=null,xr=0,yr=null;for(var o=0;o<a.length;o++)(0,a[o])()}}function Pj(a,o){var d=[],f={status:"pending",value:null,reason:null,then:function(g){d.push(g)}};return a.then(function(){f.status="fulfilled",f.value=o;for(var g=0;g<d.length;g++)(0,d[g])(o)},function(g){for(f.status="rejected",f.reason=g,g=0;g<d.length;g++)(0,d[g])(void 0)}),f}var Ax=L.S;L.S=function(a,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&Oj(a,o),Ax!==null&&Ax(a,o)};var vi=G(null);function Nh(){var a=vi.current;return a!==null?a:wt.pooledCache}function vc(a,o){o===null?O(vi,vi.current):O(vi,o.pool)}function Nx(){var a=Nh();return a===null?null:{parent:Qt._currentValue,pool:a}}var Sl=Error(s(460)),jx=Error(s(474)),wc=Error(s(542)),jh={then:function(){}};function Sx(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Ac(){}function Ex(a,o,d){switch(d=a[d],d===void 0?a.push(o):d!==o&&(o.then(Ac,Ac),o=d),o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,Cx(a),a;default:if(typeof o.status=="string")o.then(Ac,Ac);else{if(a=wt,a!==null&&100<a.shellSuspendCounter)throw Error(s(482));a=o,a.status="pending",a.then(function(f){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=f}},function(f){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,Cx(a),a}throw El=o,Sl}}var El=null;function _x(){if(El===null)throw Error(s(459));var a=El;return El=null,a}function Cx(a){if(a===Sl||a===wc)throw Error(s(483))}var ja=!1;function Sh(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Eh(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Sa(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Ea(a,o,d){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(dt&2)!==0){var g=f.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),f.pending=o,o=mc(a),mx(a,null,d),o}return fc(a,f,o,d),mc(a)}function _l(a,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194048)!==0)){var f=o.lanes;f&=a.pendingLanes,d|=f,o.lanes=d,oi(a,d)}}function _h(a,o){var d=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,d===f)){var g=null,b=null;if(d=d.firstBaseUpdate,d!==null){do{var S={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};b===null?g=b=S:b=b.next=S,d=d.next}while(d!==null);b===null?g=b=o:b=b.next=o}else g=b=o;d={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:b,shared:f.shared,callbacks:f.callbacks},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=o:a.next=o,d.lastBaseUpdate=o}var Ch=!1;function Cl(){if(Ch){var a=yr;if(a!==null)throw a}}function Tl(a,o,d,f){Ch=!1;var g=a.updateQueue;ja=!1;var b=g.firstBaseUpdate,S=g.lastBaseUpdate,R=g.shared.pending;if(R!==null){g.shared.pending=null;var z=R,J=z.next;z.next=null,S===null?b=J:S.next=J,S=z;var he=a.alternate;he!==null&&(he=he.updateQueue,R=he.lastBaseUpdate,R!==S&&(R===null?he.firstBaseUpdate=J:R.next=J,he.lastBaseUpdate=z))}if(b!==null){var ge=g.baseState;S=0,he=J=z=null,R=b;do{var se=R.lane&-536870913,ne=se!==R.lane;if(ne?(nt&se)===se:(f&se)===se){se!==0&&se===xr&&(Ch=!0),he!==null&&(he=he.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var Be=a,Le=R;se=o;var pt=d;switch(Le.tag){case 1:if(Be=Le.payload,typeof Be=="function"){ge=Be.call(pt,ge,se);break e}ge=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=Le.payload,se=typeof Be=="function"?Be.call(pt,ge,se):Be,se==null)break e;ge=p({},ge,se);break e;case 2:ja=!0}}se=R.callback,se!==null&&(a.flags|=64,ne&&(a.flags|=8192),ne=g.callbacks,ne===null?g.callbacks=[se]:ne.push(se))}else ne={lane:se,tag:R.tag,payload:R.payload,callback:R.callback,next:null},he===null?(J=he=ne,z=ge):he=he.next=ne,S|=se;if(R=R.next,R===null){if(R=g.shared.pending,R===null)break;ne=R,R=ne.next,ne.next=null,g.lastBaseUpdate=ne,g.shared.pending=null}}while(!0);he===null&&(z=ge),g.baseState=z,g.firstBaseUpdate=J,g.lastBaseUpdate=he,b===null&&(g.shared.lanes=0),La|=S,a.lanes=S,a.memoizedState=ge}}function Tx(a,o){if(typeof a!="function")throw Error(s(191,a));a.call(o)}function Dx(a,o){var d=a.callbacks;if(d!==null)for(a.callbacks=null,a=0;a<d.length;a++)Tx(d[a],o)}var br=G(null),Nc=G(0);function Rx(a,o){a=da,O(Nc,a),O(br,o),da=a|o.baseLanes}function Th(){O(Nc,da),O(br,br.current)}function Dh(){da=Nc.current,M(br),M(Nc)}var _a=0,We=null,ft=null,$t=null,jc=!1,vr=!1,wi=!1,Sc=0,Dl=0,wr=null,Ij=0;function Bt(){throw Error(s(321))}function Rh(a,o){if(o===null)return!1;for(var d=0;d<o.length&&d<a.length;d++)if(!$s(a[d],o[d]))return!1;return!0}function kh(a,o,d,f,g,b){return _a=b,We=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,L.H=a===null||a.memoizedState===null?m0:p0,wi=!1,b=d(f,g),wi=!1,vr&&(b=Mx(o,d,f,g)),kx(a),b}function kx(a){L.H=Rc;var o=ft!==null&&ft.next!==null;if(_a=0,$t=ft=We=null,jc=!1,Dl=0,wr=null,o)throw Error(s(300));a===null||es||(a=a.dependencies,a!==null&&yc(a)&&(es=!0))}function Mx(a,o,d,f){We=a;var g=0;do{if(vr&&(wr=null),Dl=0,vr=!1,25<=g)throw Error(s(301));if(g+=1,$t=ft=null,a.updateQueue!=null){var b=a.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}L.H=Vj,b=o(d,f)}while(vr);return b}function Bj(){var a=L.H,o=a.useState()[0];return o=typeof o.then=="function"?Rl(o):o,a=a.useState()[0],(ft!==null?ft.memoizedState:null)!==a&&(We.flags|=1024),o}function Mh(){var a=Sc!==0;return Sc=0,a}function Lh(a,o,d){o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~d}function Oh(a){if(jc){for(a=a.memoizedState;a!==null;){var o=a.queue;o!==null&&(o.pending=null),a=a.next}jc=!1}_a=0,$t=ft=We=null,vr=!1,Dl=Sc=0,wr=null}function Ds(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $t===null?We.memoizedState=$t=a:$t=$t.next=a,$t}function Vt(){if(ft===null){var a=We.alternate;a=a!==null?a.memoizedState:null}else a=ft.next;var o=$t===null?We.memoizedState:$t.next;if(o!==null)$t=o,ft=a;else{if(a===null)throw We.alternate===null?Error(s(467)):Error(s(310));ft=a,a={memoizedState:ft.memoizedState,baseState:ft.baseState,baseQueue:ft.baseQueue,queue:ft.queue,next:null},$t===null?We.memoizedState=$t=a:$t=$t.next=a}return $t}function Ph(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Rl(a){var o=Dl;return Dl+=1,wr===null&&(wr=[]),a=Ex(wr,a,o),o=We,($t===null?o.memoizedState:$t.next)===null&&(o=o.alternate,L.H=o===null||o.memoizedState===null?m0:p0),a}function Ec(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Rl(a);if(a.$$typeof===C)return ps(a)}throw Error(s(438,String(a)))}function Ih(a){var o=null,d=We.updateQueue;if(d!==null&&(o=d.memoCache),o==null){var f=We.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),d===null&&(d=Ph(),We.updateQueue=d),d.memoCache=o,d=o.data[o.index],d===void 0)for(d=o.data[o.index]=Array(a),f=0;f<a;f++)d[f]=K;return o.index++,d}function aa(a,o){return typeof o=="function"?o(a):o}function _c(a){var o=Vt();return Bh(o,ft,a)}function Bh(a,o,d){var f=a.queue;if(f===null)throw Error(s(311));f.lastRenderedReducer=d;var g=a.baseQueue,b=f.pending;if(b!==null){if(g!==null){var S=g.next;g.next=b.next,b.next=S}o.baseQueue=g=b,f.pending=null}if(b=a.baseState,g===null)a.memoizedState=b;else{o=g.next;var R=S=null,z=null,J=o,he=!1;do{var ge=J.lane&-536870913;if(ge!==J.lane?(nt&ge)===ge:(_a&ge)===ge){var se=J.revertLane;if(se===0)z!==null&&(z=z.next={lane:0,revertLane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),ge===xr&&(he=!0);else if((_a&se)===se){J=J.next,se===xr&&(he=!0);continue}else ge={lane:0,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},z===null?(R=z=ge,S=b):z=z.next=ge,We.lanes|=se,La|=se;ge=J.action,wi&&d(b,ge),b=J.hasEagerState?J.eagerState:d(b,ge)}else se={lane:ge,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},z===null?(R=z=se,S=b):z=z.next=se,We.lanes|=ge,La|=ge;J=J.next}while(J!==null&&J!==o);if(z===null?S=b:z.next=R,!$s(b,a.memoizedState)&&(es=!0,he&&(d=yr,d!==null)))throw d;a.memoizedState=b,a.baseState=S,a.baseQueue=z,f.lastRenderedState=b}return g===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function Hh(a){var o=Vt(),d=o.queue;if(d===null)throw Error(s(311));d.lastRenderedReducer=a;var f=d.dispatch,g=d.pending,b=o.memoizedState;if(g!==null){d.pending=null;var S=g=g.next;do b=a(b,S.action),S=S.next;while(S!==g);$s(b,o.memoizedState)||(es=!0),o.memoizedState=b,o.baseQueue===null&&(o.baseState=b),d.lastRenderedState=b}return[b,f]}function Lx(a,o,d){var f=We,g=Vt(),b=lt;if(b){if(d===void 0)throw Error(s(407));d=d()}else d=o();var S=!$s((ft||g).memoizedState,d);S&&(g.memoizedState=d,es=!0),g=g.queue;var R=Ix.bind(null,f,g,a);if(kl(2048,8,R,[a]),g.getSnapshot!==o||S||$t!==null&&$t.memoizedState.tag&1){if(f.flags|=2048,Ar(9,Cc(),Px.bind(null,f,g,d,o),null),wt===null)throw Error(s(349));b||(_a&124)!==0||Ox(f,o,d)}return d}function Ox(a,o,d){a.flags|=16384,a={getSnapshot:o,value:d},o=We.updateQueue,o===null?(o=Ph(),We.updateQueue=o,o.stores=[a]):(d=o.stores,d===null?o.stores=[a]:d.push(a))}function Px(a,o,d,f){o.value=d,o.getSnapshot=f,Bx(o)&&Hx(a)}function Ix(a,o,d){return d(function(){Bx(o)&&Hx(a)})}function Bx(a){var o=a.getSnapshot;a=a.value;try{var d=o();return!$s(a,d)}catch{return!0}}function Hx(a){var o=fr(a,2);o!==null&&Xs(o,a,2)}function zh(a){var o=Ds();if(typeof a=="function"){var d=a;if(a=d(),wi){$e(!0);try{d()}finally{$e(!1)}}}return o.memoizedState=o.baseState=a,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:aa,lastRenderedState:a},o}function zx(a,o,d,f){return a.baseState=d,Bh(a,ft,typeof f=="function"?f:aa)}function Hj(a,o,d,f,g){if(Dc(a))throw Error(s(485));if(a=o.action,a!==null){var b={payload:g,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){b.listeners.push(S)}};L.T!==null?d(!0):b.isTransition=!1,f(b),d=o.pending,d===null?(b.next=o.pending=b,Fx(o,b)):(b.next=d.next,o.pending=d.next=b)}}function Fx(a,o){var d=o.action,f=o.payload,g=a.state;if(o.isTransition){var b=L.T,S={};L.T=S;try{var R=d(g,f),z=L.S;z!==null&&z(S,R),Ux(a,o,R)}catch(J){Fh(a,o,J)}finally{L.T=b}}else try{b=d(g,f),Ux(a,o,b)}catch(J){Fh(a,o,J)}}function Ux(a,o,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(f){$x(a,o,f)},function(f){return Fh(a,o,f)}):$x(a,o,d)}function $x(a,o,d){o.status="fulfilled",o.value=d,Vx(o),a.state=d,o=a.pending,o!==null&&(d=o.next,d===o?a.pending=null:(d=d.next,o.next=d,Fx(a,d)))}function Fh(a,o,d){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=d,Vx(o),o=o.next;while(o!==f)}a.action=null}function Vx(a){a=a.listeners;for(var o=0;o<a.length;o++)(0,a[o])()}function qx(a,o){return o}function Gx(a,o){if(lt){var d=wt.formState;if(d!==null){e:{var f=We;if(lt){if(Ot){t:{for(var g=Ot,b=Ln;g.nodeType!==8;){if(!b){g=null;break t}if(g=Nn(g.nextSibling),g===null){g=null;break t}}b=g.data,g=b==="F!"||b==="F"?g:null}if(g){Ot=Nn(g.nextSibling),f=g.data==="F!";break e}}xi(f)}f=!1}f&&(o=d[0])}}return d=Ds(),d.memoizedState=d.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qx,lastRenderedState:o},d.queue=f,d=u0.bind(null,We,f),f.dispatch=d,f=zh(!1),b=Gh.bind(null,We,!1,f.queue),f=Ds(),g={state:o,dispatch:null,action:a,pending:null},f.queue=g,d=Hj.bind(null,We,g,b,d),g.dispatch=d,f.memoizedState=a,[o,d,!1]}function Yx(a){var o=Vt();return Wx(o,ft,a)}function Wx(a,o,d){if(o=Bh(a,o,qx)[0],a=_c(aa)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=Rl(o)}catch(S){throw S===Sl?wc:S}else f=o;o=Vt();var g=o.queue,b=g.dispatch;return d!==o.memoizedState&&(We.flags|=2048,Ar(9,Cc(),zj.bind(null,g,d),null)),[f,b,a]}function zj(a,o){a.action=o}function Xx(a){var o=Vt(),d=ft;if(d!==null)return Wx(o,d,a);Vt(),o=o.memoizedState,d=Vt();var f=d.queue.dispatch;return d.memoizedState=a,[o,f,!1]}function Ar(a,o,d,f){return a={tag:a,create:d,deps:f,inst:o,next:null},o=We.updateQueue,o===null&&(o=Ph(),We.updateQueue=o),d=o.lastEffect,d===null?o.lastEffect=a.next=a:(f=d.next,d.next=a,a.next=f,o.lastEffect=a),a}function Cc(){return{destroy:void 0,resource:void 0}}function Qx(){return Vt().memoizedState}function Tc(a,o,d,f){var g=Ds();f=f===void 0?null:f,We.flags|=a,g.memoizedState=Ar(1|o,Cc(),d,f)}function kl(a,o,d,f){var g=Vt();f=f===void 0?null:f;var b=g.memoizedState.inst;ft!==null&&f!==null&&Rh(f,ft.memoizedState.deps)?g.memoizedState=Ar(o,b,d,f):(We.flags|=a,g.memoizedState=Ar(1|o,b,d,f))}function Zx(a,o){Tc(8390656,8,a,o)}function Kx(a,o){kl(2048,8,a,o)}function Jx(a,o){return kl(4,2,a,o)}function e0(a,o){return kl(4,4,a,o)}function t0(a,o){if(typeof o=="function"){a=a();var d=o(a);return function(){typeof d=="function"?d():o(null)}}if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function s0(a,o,d){d=d!=null?d.concat([a]):null,kl(4,4,t0.bind(null,o,a),d)}function Uh(){}function n0(a,o){var d=Vt();o=o===void 0?null:o;var f=d.memoizedState;return o!==null&&Rh(o,f[1])?f[0]:(d.memoizedState=[a,o],a)}function a0(a,o){var d=Vt();o=o===void 0?null:o;var f=d.memoizedState;if(o!==null&&Rh(o,f[1]))return f[0];if(f=a(),wi){$e(!0);try{a()}finally{$e(!1)}}return d.memoizedState=[f,o],f}function $h(a,o,d){return d===void 0||(_a&1073741824)!==0?a.memoizedState=o:(a.memoizedState=d,a=ly(),We.lanes|=a,La|=a,d)}function i0(a,o,d,f){return $s(d,o)?d:br.current!==null?(a=$h(a,d,f),$s(a,o)||(es=!0),a):(_a&42)===0?(es=!0,a.memoizedState=d):(a=ly(),We.lanes|=a,La|=a,o)}function r0(a,o,d,f,g){var b=q.p;q.p=b!==0&&8>b?b:8;var S=L.T,R={};L.T=R,Gh(a,!1,o,d);try{var z=g(),J=L.S;if(J!==null&&J(R,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var he=Pj(z,f);Ml(a,o,he,Ws(a))}else Ml(a,o,f,Ws(a))}catch(ge){Ml(a,o,{then:function(){},status:"rejected",reason:ge},Ws())}finally{q.p=b,L.T=S}}function Fj(){}function Vh(a,o,d,f){if(a.tag!==5)throw Error(s(476));var g=l0(a).queue;r0(a,g,o,V,d===null?Fj:function(){return o0(a),d(f)})}function l0(a){var o=a.memoizedState;if(o!==null)return o;o={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:aa,lastRenderedState:V},next:null};var d={};return o.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:aa,lastRenderedState:d},next:null},a.memoizedState=o,a=a.alternate,a!==null&&(a.memoizedState=o),o}function o0(a){var o=l0(a).next.queue;Ml(a,o,{},Ws())}function qh(){return ps(Zl)}function c0(){return Vt().memoizedState}function d0(){return Vt().memoizedState}function Uj(a){for(var o=a.return;o!==null;){switch(o.tag){case 24:case 3:var d=Ws();a=Sa(d);var f=Ea(o,a,d);f!==null&&(Xs(f,o,d),_l(f,o,d)),o={cache:wh()},a.payload=o;return}o=o.return}}function $j(a,o,d){var f=Ws();d={lane:f,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},Dc(a)?h0(o,d):(d=uh(a,o,d,f),d!==null&&(Xs(d,a,f),f0(d,o,f)))}function u0(a,o,d){var f=Ws();Ml(a,o,d,f)}function Ml(a,o,d,f){var g={lane:f,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(Dc(a))h0(o,g);else{var b=a.alternate;if(a.lanes===0&&(b===null||b.lanes===0)&&(b=o.lastRenderedReducer,b!==null))try{var S=o.lastRenderedState,R=b(S,d);if(g.hasEagerState=!0,g.eagerState=R,$s(R,S))return fc(a,o,g,0),wt===null&&hc(),!1}catch{}finally{}if(d=uh(a,o,g,f),d!==null)return Xs(d,a,f),f0(d,o,f),!0}return!1}function Gh(a,o,d,f){if(f={lane:2,revertLane:Sf(),action:f,hasEagerState:!1,eagerState:null,next:null},Dc(a)){if(o)throw Error(s(479))}else o=uh(a,d,f,2),o!==null&&Xs(o,a,2)}function Dc(a){var o=a.alternate;return a===We||o!==null&&o===We}function h0(a,o){vr=jc=!0;var d=a.pending;d===null?o.next=o:(o.next=d.next,d.next=o),a.pending=o}function f0(a,o,d){if((d&4194048)!==0){var f=o.lanes;f&=a.pendingLanes,d|=f,o.lanes=d,oi(a,d)}}var Rc={readContext:ps,use:Ec,useCallback:Bt,useContext:Bt,useEffect:Bt,useImperativeHandle:Bt,useLayoutEffect:Bt,useInsertionEffect:Bt,useMemo:Bt,useReducer:Bt,useRef:Bt,useState:Bt,useDebugValue:Bt,useDeferredValue:Bt,useTransition:Bt,useSyncExternalStore:Bt,useId:Bt,useHostTransitionStatus:Bt,useFormState:Bt,useActionState:Bt,useOptimistic:Bt,useMemoCache:Bt,useCacheRefresh:Bt},m0={readContext:ps,use:Ec,useCallback:function(a,o){return Ds().memoizedState=[a,o===void 0?null:o],a},useContext:ps,useEffect:Zx,useImperativeHandle:function(a,o,d){d=d!=null?d.concat([a]):null,Tc(4194308,4,t0.bind(null,o,a),d)},useLayoutEffect:function(a,o){return Tc(4194308,4,a,o)},useInsertionEffect:function(a,o){Tc(4,2,a,o)},useMemo:function(a,o){var d=Ds();o=o===void 0?null:o;var f=a();if(wi){$e(!0);try{a()}finally{$e(!1)}}return d.memoizedState=[f,o],f},useReducer:function(a,o,d){var f=Ds();if(d!==void 0){var g=d(o);if(wi){$e(!0);try{d(o)}finally{$e(!1)}}}else g=o;return f.memoizedState=f.baseState=g,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:g},f.queue=a,a=a.dispatch=$j.bind(null,We,a),[f.memoizedState,a]},useRef:function(a){var o=Ds();return a={current:a},o.memoizedState=a},useState:function(a){a=zh(a);var o=a.queue,d=u0.bind(null,We,o);return o.dispatch=d,[a.memoizedState,d]},useDebugValue:Uh,useDeferredValue:function(a,o){var d=Ds();return $h(d,a,o)},useTransition:function(){var a=zh(!1);return a=r0.bind(null,We,a.queue,!0,!1),Ds().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,o,d){var f=We,g=Ds();if(lt){if(d===void 0)throw Error(s(407));d=d()}else{if(d=o(),wt===null)throw Error(s(349));(nt&124)!==0||Ox(f,o,d)}g.memoizedState=d;var b={value:d,getSnapshot:o};return g.queue=b,Zx(Ix.bind(null,f,b,a),[a]),f.flags|=2048,Ar(9,Cc(),Px.bind(null,f,b,d,o),null),d},useId:function(){var a=Ds(),o=wt.identifierPrefix;if(lt){var d=ta,f=ea;d=(f&~(1<<32-ct(f)-1)).toString(32)+d,o="«"+o+"R"+d,d=Sc++,0<d&&(o+="H"+d.toString(32)),o+="»"}else d=Ij++,o="«"+o+"r"+d.toString(32)+"»";return a.memoizedState=o},useHostTransitionStatus:qh,useFormState:Gx,useActionState:Gx,useOptimistic:function(a){var o=Ds();o.memoizedState=o.baseState=a;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=d,o=Gh.bind(null,We,!0,d),d.dispatch=o,[a,o]},useMemoCache:Ih,useCacheRefresh:function(){return Ds().memoizedState=Uj.bind(null,We)}},p0={readContext:ps,use:Ec,useCallback:n0,useContext:ps,useEffect:Kx,useImperativeHandle:s0,useInsertionEffect:Jx,useLayoutEffect:e0,useMemo:a0,useReducer:_c,useRef:Qx,useState:function(){return _c(aa)},useDebugValue:Uh,useDeferredValue:function(a,o){var d=Vt();return i0(d,ft.memoizedState,a,o)},useTransition:function(){var a=_c(aa)[0],o=Vt().memoizedState;return[typeof a=="boolean"?a:Rl(a),o]},useSyncExternalStore:Lx,useId:c0,useHostTransitionStatus:qh,useFormState:Yx,useActionState:Yx,useOptimistic:function(a,o){var d=Vt();return zx(d,ft,a,o)},useMemoCache:Ih,useCacheRefresh:d0},Vj={readContext:ps,use:Ec,useCallback:n0,useContext:ps,useEffect:Kx,useImperativeHandle:s0,useInsertionEffect:Jx,useLayoutEffect:e0,useMemo:a0,useReducer:Hh,useRef:Qx,useState:function(){return Hh(aa)},useDebugValue:Uh,useDeferredValue:function(a,o){var d=Vt();return ft===null?$h(d,a,o):i0(d,ft.memoizedState,a,o)},useTransition:function(){var a=Hh(aa)[0],o=Vt().memoizedState;return[typeof a=="boolean"?a:Rl(a),o]},useSyncExternalStore:Lx,useId:c0,useHostTransitionStatus:qh,useFormState:Xx,useActionState:Xx,useOptimistic:function(a,o){var d=Vt();return ft!==null?zx(d,ft,a,o):(d.baseState=a,[a,d.queue.dispatch])},useMemoCache:Ih,useCacheRefresh:d0},Nr=null,Ll=0;function kc(a){var o=Ll;return Ll+=1,Nr===null&&(Nr=[]),Ex(Nr,a,o)}function Ol(a,o){o=o.props.ref,a.ref=o!==void 0?o:null}function Mc(a,o){throw o.$$typeof===x?Error(s(525)):(a=Object.prototype.toString.call(o),Error(s(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a)))}function g0(a){var o=a._init;return o(a._payload)}function x0(a){function o(Y,$){if(a){var Z=Y.deletions;Z===null?(Y.deletions=[$],Y.flags|=16):Z.push($)}}function d(Y,$){if(!a)return null;for(;$!==null;)o(Y,$),$=$.sibling;return null}function f(Y){for(var $=new Map;Y!==null;)Y.key!==null?$.set(Y.key,Y):$.set(Y.index,Y),Y=Y.sibling;return $}function g(Y,$){return Y=Jn(Y,$),Y.index=0,Y.sibling=null,Y}function b(Y,$,Z){return Y.index=Z,a?(Z=Y.alternate,Z!==null?(Z=Z.index,Z<$?(Y.flags|=67108866,$):Z):(Y.flags|=67108866,$)):(Y.flags|=1048576,$)}function S(Y){return a&&Y.alternate===null&&(Y.flags|=67108866),Y}function R(Y,$,Z,fe){return $===null||$.tag!==6?($=fh(Z,Y.mode,fe),$.return=Y,$):($=g($,Z),$.return=Y,$)}function z(Y,$,Z,fe){var _e=Z.type;return _e===w?he(Y,$,Z.props.children,fe,Z.key):$!==null&&($.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===U&&g0(_e)===$.type)?($=g($,Z.props),Ol($,Z),$.return=Y,$):($=pc(Z.type,Z.key,Z.props,null,Y.mode,fe),Ol($,Z),$.return=Y,$)}function J(Y,$,Z,fe){return $===null||$.tag!==4||$.stateNode.containerInfo!==Z.containerInfo||$.stateNode.implementation!==Z.implementation?($=mh(Z,Y.mode,fe),$.return=Y,$):($=g($,Z.children||[]),$.return=Y,$)}function he(Y,$,Z,fe,_e){return $===null||$.tag!==7?($=fi(Z,Y.mode,fe,_e),$.return=Y,$):($=g($,Z),$.return=Y,$)}function ge(Y,$,Z){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=fh(""+$,Y.mode,Z),$.return=Y,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case y:return Z=pc($.type,$.key,$.props,null,Y.mode,Z),Ol(Z,$),Z.return=Y,Z;case v:return $=mh($,Y.mode,Z),$.return=Y,$;case U:var fe=$._init;return $=fe($._payload),ge(Y,$,Z)}if(me($)||X($))return $=fi($,Y.mode,Z,null),$.return=Y,$;if(typeof $.then=="function")return ge(Y,kc($),Z);if($.$$typeof===C)return ge(Y,bc(Y,$),Z);Mc(Y,$)}return null}function se(Y,$,Z,fe){var _e=$!==null?$.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return _e!==null?null:R(Y,$,""+Z,fe);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case y:return Z.key===_e?z(Y,$,Z,fe):null;case v:return Z.key===_e?J(Y,$,Z,fe):null;case U:return _e=Z._init,Z=_e(Z._payload),se(Y,$,Z,fe)}if(me(Z)||X(Z))return _e!==null?null:he(Y,$,Z,fe,null);if(typeof Z.then=="function")return se(Y,$,kc(Z),fe);if(Z.$$typeof===C)return se(Y,$,bc(Y,Z),fe);Mc(Y,Z)}return null}function ne(Y,$,Z,fe,_e){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return Y=Y.get(Z)||null,R($,Y,""+fe,_e);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case y:return Y=Y.get(fe.key===null?Z:fe.key)||null,z($,Y,fe,_e);case v:return Y=Y.get(fe.key===null?Z:fe.key)||null,J($,Y,fe,_e);case U:var Qe=fe._init;return fe=Qe(fe._payload),ne(Y,$,Z,fe,_e)}if(me(fe)||X(fe))return Y=Y.get(Z)||null,he($,Y,fe,_e,null);if(typeof fe.then=="function")return ne(Y,$,Z,kc(fe),_e);if(fe.$$typeof===C)return ne(Y,$,Z,bc($,fe),_e);Mc($,fe)}return null}function Be(Y,$,Z,fe){for(var _e=null,Qe=null,De=$,Oe=$=0,ss=null;De!==null&&Oe<Z.length;Oe++){De.index>Oe?(ss=De,De=null):ss=De.sibling;var it=se(Y,De,Z[Oe],fe);if(it===null){De===null&&(De=ss);break}a&&De&&it.alternate===null&&o(Y,De),$=b(it,$,Oe),Qe===null?_e=it:Qe.sibling=it,Qe=it,De=ss}if(Oe===Z.length)return d(Y,De),lt&&pi(Y,Oe),_e;if(De===null){for(;Oe<Z.length;Oe++)De=ge(Y,Z[Oe],fe),De!==null&&($=b(De,$,Oe),Qe===null?_e=De:Qe.sibling=De,Qe=De);return lt&&pi(Y,Oe),_e}for(De=f(De);Oe<Z.length;Oe++)ss=ne(De,Y,Oe,Z[Oe],fe),ss!==null&&(a&&ss.alternate!==null&&De.delete(ss.key===null?Oe:ss.key),$=b(ss,$,Oe),Qe===null?_e=ss:Qe.sibling=ss,Qe=ss);return a&&De.forEach(function($a){return o(Y,$a)}),lt&&pi(Y,Oe),_e}function Le(Y,$,Z,fe){if(Z==null)throw Error(s(151));for(var _e=null,Qe=null,De=$,Oe=$=0,ss=null,it=Z.next();De!==null&&!it.done;Oe++,it=Z.next()){De.index>Oe?(ss=De,De=null):ss=De.sibling;var $a=se(Y,De,it.value,fe);if($a===null){De===null&&(De=ss);break}a&&De&&$a.alternate===null&&o(Y,De),$=b($a,$,Oe),Qe===null?_e=$a:Qe.sibling=$a,Qe=$a,De=ss}if(it.done)return d(Y,De),lt&&pi(Y,Oe),_e;if(De===null){for(;!it.done;Oe++,it=Z.next())it=ge(Y,it.value,fe),it!==null&&($=b(it,$,Oe),Qe===null?_e=it:Qe.sibling=it,Qe=it);return lt&&pi(Y,Oe),_e}for(De=f(De);!it.done;Oe++,it=Z.next())it=ne(De,Y,Oe,it.value,fe),it!==null&&(a&&it.alternate!==null&&De.delete(it.key===null?Oe:it.key),$=b(it,$,Oe),Qe===null?_e=it:Qe.sibling=it,Qe=it);return a&&De.forEach(function(qS){return o(Y,qS)}),lt&&pi(Y,Oe),_e}function pt(Y,$,Z,fe){if(typeof Z=="object"&&Z!==null&&Z.type===w&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case y:e:{for(var _e=Z.key;$!==null;){if($.key===_e){if(_e=Z.type,_e===w){if($.tag===7){d(Y,$.sibling),fe=g($,Z.props.children),fe.return=Y,Y=fe;break e}}else if($.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===U&&g0(_e)===$.type){d(Y,$.sibling),fe=g($,Z.props),Ol(fe,Z),fe.return=Y,Y=fe;break e}d(Y,$);break}else o(Y,$);$=$.sibling}Z.type===w?(fe=fi(Z.props.children,Y.mode,fe,Z.key),fe.return=Y,Y=fe):(fe=pc(Z.type,Z.key,Z.props,null,Y.mode,fe),Ol(fe,Z),fe.return=Y,Y=fe)}return S(Y);case v:e:{for(_e=Z.key;$!==null;){if($.key===_e)if($.tag===4&&$.stateNode.containerInfo===Z.containerInfo&&$.stateNode.implementation===Z.implementation){d(Y,$.sibling),fe=g($,Z.children||[]),fe.return=Y,Y=fe;break e}else{d(Y,$);break}else o(Y,$);$=$.sibling}fe=mh(Z,Y.mode,fe),fe.return=Y,Y=fe}return S(Y);case U:return _e=Z._init,Z=_e(Z._payload),pt(Y,$,Z,fe)}if(me(Z))return Be(Y,$,Z,fe);if(X(Z)){if(_e=X(Z),typeof _e!="function")throw Error(s(150));return Z=_e.call(Z),Le(Y,$,Z,fe)}if(typeof Z.then=="function")return pt(Y,$,kc(Z),fe);if(Z.$$typeof===C)return pt(Y,$,bc(Y,Z),fe);Mc(Y,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint"?(Z=""+Z,$!==null&&$.tag===6?(d(Y,$.sibling),fe=g($,Z),fe.return=Y,Y=fe):(d(Y,$),fe=fh(Z,Y.mode,fe),fe.return=Y,Y=fe),S(Y)):d(Y,$)}return function(Y,$,Z,fe){try{Ll=0;var _e=pt(Y,$,Z,fe);return Nr=null,_e}catch(De){if(De===Sl||De===wc)throw De;var Qe=Vs(29,De,null,Y.mode);return Qe.lanes=fe,Qe.return=Y,Qe}finally{}}}var jr=x0(!0),y0=x0(!1),dn=G(null),On=null;function Ca(a){var o=a.alternate;O(Zt,Zt.current&1),O(dn,a),On===null&&(o===null||br.current!==null||o.memoizedState!==null)&&(On=a)}function b0(a){if(a.tag===22){if(O(Zt,Zt.current),O(dn,a),On===null){var o=a.alternate;o!==null&&o.memoizedState!==null&&(On=a)}}else Ta()}function Ta(){O(Zt,Zt.current),O(dn,dn.current)}function ia(a){M(dn),On===a&&(On=null),M(Zt)}var Zt=G(0);function Lc(a){for(var o=a;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||If(d)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Yh(a,o,d,f){o=a.memoizedState,d=d(f,o),d=d==null?o:p({},o,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var Wh={enqueueSetState:function(a,o,d){a=a._reactInternals;var f=Ws(),g=Sa(f);g.payload=o,d!=null&&(g.callback=d),o=Ea(a,g,f),o!==null&&(Xs(o,a,f),_l(o,a,f))},enqueueReplaceState:function(a,o,d){a=a._reactInternals;var f=Ws(),g=Sa(f);g.tag=1,g.payload=o,d!=null&&(g.callback=d),o=Ea(a,g,f),o!==null&&(Xs(o,a,f),_l(o,a,f))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var d=Ws(),f=Sa(d);f.tag=2,o!=null&&(f.callback=o),o=Ea(a,f,d),o!==null&&(Xs(o,a,d),_l(o,a,d))}};function v0(a,o,d,f,g,b,S){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,b,S):o.prototype&&o.prototype.isPureReactComponent?!xl(d,f)||!xl(g,b):!0}function w0(a,o,d,f){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,f),o.state!==a&&Wh.enqueueReplaceState(o,o.state,null)}function Ai(a,o){var d=o;if("ref"in o){d={};for(var f in o)f!=="ref"&&(d[f]=o[f])}if(a=a.defaultProps){d===o&&(d=p({},d));for(var g in a)d[g]===void 0&&(d[g]=a[g])}return d}var Oc=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function A0(a){Oc(a)}function N0(a){console.error(a)}function j0(a){Oc(a)}function Pc(a,o){try{var d=a.onUncaughtError;d(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function S0(a,o,d){try{var f=a.onCaughtError;f(d.value,{componentStack:d.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Xh(a,o,d){return d=Sa(d),d.tag=3,d.payload={element:null},d.callback=function(){Pc(a,o)},d}function E0(a){return a=Sa(a),a.tag=3,a}function _0(a,o,d,f){var g=d.type.getDerivedStateFromError;if(typeof g=="function"){var b=f.value;a.payload=function(){return g(b)},a.callback=function(){S0(o,d,f)}}var S=d.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(a.callback=function(){S0(o,d,f),typeof g!="function"&&(Oa===null?Oa=new Set([this]):Oa.add(this));var R=f.stack;this.componentDidCatch(f.value,{componentStack:R!==null?R:""})})}function qj(a,o,d,f,g){if(d.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=d.alternate,o!==null&&Al(o,d,g,!0),d=dn.current,d!==null){switch(d.tag){case 13:return On===null?vf():d.alternate===null&&Pt===0&&(Pt=3),d.flags&=-257,d.flags|=65536,d.lanes=g,f===jh?d.flags|=16384:(o=d.updateQueue,o===null?d.updateQueue=new Set([f]):o.add(f),Af(a,f,g)),!1;case 22:return d.flags|=65536,f===jh?d.flags|=16384:(o=d.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},d.updateQueue=o):(d=o.retryQueue,d===null?o.retryQueue=new Set([f]):d.add(f)),Af(a,f,g)),!1}throw Error(s(435,d.tag))}return Af(a,f,g),vf(),!1}if(lt)return o=dn.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,f!==xh&&(a=Error(s(422),{cause:f}),wl(rn(a,d)))):(f!==xh&&(o=Error(s(423),{cause:f}),wl(rn(o,d))),a=a.current.alternate,a.flags|=65536,g&=-g,a.lanes|=g,f=rn(f,d),g=Xh(a.stateNode,f,g),_h(a,g),Pt!==4&&(Pt=2)),!1;var b=Error(s(520),{cause:f});if(b=rn(b,d),Ul===null?Ul=[b]:Ul.push(b),Pt!==4&&(Pt=2),o===null)return!0;f=rn(f,d),d=o;do{switch(d.tag){case 3:return d.flags|=65536,a=g&-g,d.lanes|=a,a=Xh(d.stateNode,f,a),_h(d,a),!1;case 1:if(o=d.type,b=d.stateNode,(d.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Oa===null||!Oa.has(b))))return d.flags|=65536,g&=-g,d.lanes|=g,g=E0(g),_0(g,a,d,f),_h(d,g),!1}d=d.return}while(d!==null);return!1}var C0=Error(s(461)),es=!1;function os(a,o,d,f){o.child=a===null?y0(o,null,d,f):jr(o,a.child,d,f)}function T0(a,o,d,f,g){d=d.render;var b=o.ref;if("ref"in f){var S={};for(var R in f)R!=="ref"&&(S[R]=f[R])}else S=f;return bi(o),f=kh(a,o,d,S,b,g),R=Mh(),a!==null&&!es?(Lh(a,o,g),ra(a,o,g)):(lt&&R&&ph(o),o.flags|=1,os(a,o,f,g),o.child)}function D0(a,o,d,f,g){if(a===null){var b=d.type;return typeof b=="function"&&!hh(b)&&b.defaultProps===void 0&&d.compare===null?(o.tag=15,o.type=b,R0(a,o,b,f,g)):(a=pc(d.type,null,f,o,o.mode,g),a.ref=o.ref,a.return=o,o.child=a)}if(b=a.child,!nf(a,g)){var S=b.memoizedProps;if(d=d.compare,d=d!==null?d:xl,d(S,f)&&a.ref===o.ref)return ra(a,o,g)}return o.flags|=1,a=Jn(b,f),a.ref=o.ref,a.return=o,o.child=a}function R0(a,o,d,f,g){if(a!==null){var b=a.memoizedProps;if(xl(b,f)&&a.ref===o.ref)if(es=!1,o.pendingProps=f=b,nf(a,g))(a.flags&131072)!==0&&(es=!0);else return o.lanes=a.lanes,ra(a,o,g)}return Qh(a,o,d,f,g)}function k0(a,o,d){var f=o.pendingProps,g=f.children,b=a!==null?a.memoizedState:null;if(f.mode==="hidden"){if((o.flags&128)!==0){if(f=b!==null?b.baseLanes|d:d,a!==null){for(g=o.child=a.child,b=0;g!==null;)b=b|g.lanes|g.childLanes,g=g.sibling;o.childLanes=b&~f}else o.childLanes=0,o.child=null;return M0(a,o,f,d)}if((d&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},a!==null&&vc(o,b!==null?b.cachePool:null),b!==null?Rx(o,b):Th(),b0(o);else return o.lanes=o.childLanes=536870912,M0(a,o,b!==null?b.baseLanes|d:d,d)}else b!==null?(vc(o,b.cachePool),Rx(o,b),Ta(),o.memoizedState=null):(a!==null&&vc(o,null),Th(),Ta());return os(a,o,g,d),o.child}function M0(a,o,d,f){var g=Nh();return g=g===null?null:{parent:Qt._currentValue,pool:g},o.memoizedState={baseLanes:d,cachePool:g},a!==null&&vc(o,null),Th(),b0(o),a!==null&&Al(a,o,f,!0),null}function Ic(a,o){var d=o.ref;if(d===null)a!==null&&a.ref!==null&&(o.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(s(284));(a===null||a.ref!==d)&&(o.flags|=4194816)}}function Qh(a,o,d,f,g){return bi(o),d=kh(a,o,d,f,void 0,g),f=Mh(),a!==null&&!es?(Lh(a,o,g),ra(a,o,g)):(lt&&f&&ph(o),o.flags|=1,os(a,o,d,g),o.child)}function L0(a,o,d,f,g,b){return bi(o),o.updateQueue=null,d=Mx(o,f,d,g),kx(a),f=Mh(),a!==null&&!es?(Lh(a,o,b),ra(a,o,b)):(lt&&f&&ph(o),o.flags|=1,os(a,o,d,b),o.child)}function O0(a,o,d,f,g){if(bi(o),o.stateNode===null){var b=mr,S=d.contextType;typeof S=="object"&&S!==null&&(b=ps(S)),b=new d(f,b),o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=Wh,o.stateNode=b,b._reactInternals=o,b=o.stateNode,b.props=f,b.state=o.memoizedState,b.refs={},Sh(o),S=d.contextType,b.context=typeof S=="object"&&S!==null?ps(S):mr,b.state=o.memoizedState,S=d.getDerivedStateFromProps,typeof S=="function"&&(Yh(o,d,S,f),b.state=o.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(S=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),S!==b.state&&Wh.enqueueReplaceState(b,b.state,null),Tl(o,f,b,g),Cl(),b.state=o.memoizedState),typeof b.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(a===null){b=o.stateNode;var R=o.memoizedProps,z=Ai(d,R);b.props=z;var J=b.context,he=d.contextType;S=mr,typeof he=="object"&&he!==null&&(S=ps(he));var ge=d.getDerivedStateFromProps;he=typeof ge=="function"||typeof b.getSnapshotBeforeUpdate=="function",R=o.pendingProps!==R,he||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(R||J!==S)&&w0(o,b,f,S),ja=!1;var se=o.memoizedState;b.state=se,Tl(o,f,b,g),Cl(),J=o.memoizedState,R||se!==J||ja?(typeof ge=="function"&&(Yh(o,d,ge,f),J=o.memoizedState),(z=ja||v0(o,d,z,f,se,J,S))?(he||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(o.flags|=4194308)):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=J),b.props=f,b.state=J,b.context=S,f=z):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{b=o.stateNode,Eh(a,o),S=o.memoizedProps,he=Ai(d,S),b.props=he,ge=o.pendingProps,se=b.context,J=d.contextType,z=mr,typeof J=="object"&&J!==null&&(z=ps(J)),R=d.getDerivedStateFromProps,(J=typeof R=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(S!==ge||se!==z)&&w0(o,b,f,z),ja=!1,se=o.memoizedState,b.state=se,Tl(o,f,b,g),Cl();var ne=o.memoizedState;S!==ge||se!==ne||ja||a!==null&&a.dependencies!==null&&yc(a.dependencies)?(typeof R=="function"&&(Yh(o,d,R,f),ne=o.memoizedState),(he=ja||v0(o,d,he,f,se,ne,z)||a!==null&&a.dependencies!==null&&yc(a.dependencies))?(J||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(f,ne,z),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(f,ne,z)),typeof b.componentDidUpdate=="function"&&(o.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof b.componentDidUpdate!="function"||S===a.memoizedProps&&se===a.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||S===a.memoizedProps&&se===a.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=ne),b.props=f,b.state=ne,b.context=z,f=he):(typeof b.componentDidUpdate!="function"||S===a.memoizedProps&&se===a.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||S===a.memoizedProps&&se===a.memoizedState||(o.flags|=1024),f=!1)}return b=f,Ic(a,o),f=(o.flags&128)!==0,b||f?(b=o.stateNode,d=f&&typeof d.getDerivedStateFromError!="function"?null:b.render(),o.flags|=1,a!==null&&f?(o.child=jr(o,a.child,null,g),o.child=jr(o,null,d,g)):os(a,o,d,g),o.memoizedState=b.state,a=o.child):a=ra(a,o,g),a}function P0(a,o,d,f){return vl(),o.flags|=256,os(a,o,d,f),o.child}var Zh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Kh(a){return{baseLanes:a,cachePool:Nx()}}function Jh(a,o,d){return a=a!==null?a.childLanes&~d:0,o&&(a|=un),a}function I0(a,o,d){var f=o.pendingProps,g=!1,b=(o.flags&128)!==0,S;if((S=b)||(S=a!==null&&a.memoizedState===null?!1:(Zt.current&2)!==0),S&&(g=!0,o.flags&=-129),S=(o.flags&32)!==0,o.flags&=-33,a===null){if(lt){if(g?Ca(o):Ta(),lt){var R=Ot,z;if(z=R){e:{for(z=R,R=Ln;z.nodeType!==8;){if(!R){R=null;break e}if(z=Nn(z.nextSibling),z===null){R=null;break e}}R=z}R!==null?(o.memoizedState={dehydrated:R,treeContext:mi!==null?{id:ea,overflow:ta}:null,retryLane:536870912,hydrationErrors:null},z=Vs(18,null,null,0),z.stateNode=R,z.return=o,o.child=z,As=o,Ot=null,z=!0):z=!1}z||xi(o)}if(R=o.memoizedState,R!==null&&(R=R.dehydrated,R!==null))return If(R)?o.lanes=32:o.lanes=536870912,null;ia(o)}return R=f.children,f=f.fallback,g?(Ta(),g=o.mode,R=Bc({mode:"hidden",children:R},g),f=fi(f,g,d,null),R.return=o,f.return=o,R.sibling=f,o.child=R,g=o.child,g.memoizedState=Kh(d),g.childLanes=Jh(a,S,d),o.memoizedState=Zh,f):(Ca(o),ef(o,R))}if(z=a.memoizedState,z!==null&&(R=z.dehydrated,R!==null)){if(b)o.flags&256?(Ca(o),o.flags&=-257,o=tf(a,o,d)):o.memoizedState!==null?(Ta(),o.child=a.child,o.flags|=128,o=null):(Ta(),g=f.fallback,R=o.mode,f=Bc({mode:"visible",children:f.children},R),g=fi(g,R,d,null),g.flags|=2,f.return=o,g.return=o,f.sibling=g,o.child=f,jr(o,a.child,null,d),f=o.child,f.memoizedState=Kh(d),f.childLanes=Jh(a,S,d),o.memoizedState=Zh,o=g);else if(Ca(o),If(R)){if(S=R.nextSibling&&R.nextSibling.dataset,S)var J=S.dgst;S=J,f=Error(s(419)),f.stack="",f.digest=S,wl({value:f,source:null,stack:null}),o=tf(a,o,d)}else if(es||Al(a,o,d,!1),S=(d&a.childLanes)!==0,es||S){if(S=wt,S!==null&&(f=d&-d,f=(f&42)!==0?1:Q(f),f=(f&(S.suspendedLanes|d))!==0?0:f,f!==0&&f!==z.retryLane))throw z.retryLane=f,fr(a,f),Xs(S,a,f),C0;R.data==="$?"||vf(),o=tf(a,o,d)}else R.data==="$?"?(o.flags|=192,o.child=a.child,o=null):(a=z.treeContext,Ot=Nn(R.nextSibling),As=o,lt=!0,gi=null,Ln=!1,a!==null&&(on[cn++]=ea,on[cn++]=ta,on[cn++]=mi,ea=a.id,ta=a.overflow,mi=o),o=ef(o,f.children),o.flags|=4096);return o}return g?(Ta(),g=f.fallback,R=o.mode,z=a.child,J=z.sibling,f=Jn(z,{mode:"hidden",children:f.children}),f.subtreeFlags=z.subtreeFlags&65011712,J!==null?g=Jn(J,g):(g=fi(g,R,d,null),g.flags|=2),g.return=o,f.return=o,f.sibling=g,o.child=f,f=g,g=o.child,R=a.child.memoizedState,R===null?R=Kh(d):(z=R.cachePool,z!==null?(J=Qt._currentValue,z=z.parent!==J?{parent:J,pool:J}:z):z=Nx(),R={baseLanes:R.baseLanes|d,cachePool:z}),g.memoizedState=R,g.childLanes=Jh(a,S,d),o.memoizedState=Zh,f):(Ca(o),d=a.child,a=d.sibling,d=Jn(d,{mode:"visible",children:f.children}),d.return=o,d.sibling=null,a!==null&&(S=o.deletions,S===null?(o.deletions=[a],o.flags|=16):S.push(a)),o.child=d,o.memoizedState=null,d)}function ef(a,o){return o=Bc({mode:"visible",children:o},a.mode),o.return=a,a.child=o}function Bc(a,o){return a=Vs(22,a,null,o),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function tf(a,o,d){return jr(o,a.child,null,d),a=ef(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function B0(a,o,d){a.lanes|=o;var f=a.alternate;f!==null&&(f.lanes|=o),bh(a.return,o,d)}function sf(a,o,d,f,g){var b=a.memoizedState;b===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:d,tailMode:g}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=f,b.tail=d,b.tailMode=g)}function H0(a,o,d){var f=o.pendingProps,g=f.revealOrder,b=f.tail;if(os(a,o,f.children,d),f=Zt.current,(f&2)!==0)f=f&1|2,o.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&B0(a,d,o);else if(a.tag===19)B0(a,d,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}f&=1}switch(O(Zt,f),g){case"forwards":for(d=o.child,g=null;d!==null;)a=d.alternate,a!==null&&Lc(a)===null&&(g=d),d=d.sibling;d=g,d===null?(g=o.child,o.child=null):(g=d.sibling,d.sibling=null),sf(o,!1,g,d,b);break;case"backwards":for(d=null,g=o.child,o.child=null;g!==null;){if(a=g.alternate,a!==null&&Lc(a)===null){o.child=g;break}a=g.sibling,g.sibling=d,d=g,g=a}sf(o,!0,d,null,b);break;case"together":sf(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function ra(a,o,d){if(a!==null&&(o.dependencies=a.dependencies),La|=o.lanes,(d&o.childLanes)===0)if(a!==null){if(Al(a,o,d,!1),(d&o.childLanes)===0)return null}else return null;if(a!==null&&o.child!==a.child)throw Error(s(153));if(o.child!==null){for(a=o.child,d=Jn(a,a.pendingProps),o.child=d,d.return=o;a.sibling!==null;)a=a.sibling,d=d.sibling=Jn(a,a.pendingProps),d.return=o;d.sibling=null}return o.child}function nf(a,o){return(a.lanes&o)!==0?!0:(a=a.dependencies,!!(a!==null&&yc(a)))}function Gj(a,o,d){switch(o.tag){case 3:Te(o,o.stateNode.containerInfo),Na(o,Qt,a.memoizedState.cache),vl();break;case 27:case 5:He(o);break;case 4:Te(o,o.stateNode.containerInfo);break;case 10:Na(o,o.type,o.memoizedProps.value);break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(Ca(o),o.flags|=128,null):(d&o.child.childLanes)!==0?I0(a,o,d):(Ca(o),a=ra(a,o,d),a!==null?a.sibling:null);Ca(o);break;case 19:var g=(a.flags&128)!==0;if(f=(d&o.childLanes)!==0,f||(Al(a,o,d,!1),f=(d&o.childLanes)!==0),g){if(f)return H0(a,o,d);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),O(Zt,Zt.current),f)break;return null;case 22:case 23:return o.lanes=0,k0(a,o,d);case 24:Na(o,Qt,a.memoizedState.cache)}return ra(a,o,d)}function z0(a,o,d){if(a!==null)if(a.memoizedProps!==o.pendingProps)es=!0;else{if(!nf(a,d)&&(o.flags&128)===0)return es=!1,Gj(a,o,d);es=(a.flags&131072)!==0}else es=!1,lt&&(o.flags&1048576)!==0&&gx(o,xc,o.index);switch(o.lanes=0,o.tag){case 16:e:{a=o.pendingProps;var f=o.elementType,g=f._init;if(f=g(f._payload),o.type=f,typeof f=="function")hh(f)?(a=Ai(f,a),o.tag=1,o=O0(null,o,f,a,d)):(o.tag=0,o=Qh(null,o,f,a,d));else{if(f!=null){if(g=f.$$typeof,g===k){o.tag=11,o=T0(null,o,f,a,d);break e}else if(g===F){o.tag=14,o=D0(null,o,f,a,d);break e}}throw o=ce(f)||f,Error(s(306,o,""))}}return o;case 0:return Qh(a,o,o.type,o.pendingProps,d);case 1:return f=o.type,g=Ai(f,o.pendingProps),O0(a,o,f,g,d);case 3:e:{if(Te(o,o.stateNode.containerInfo),a===null)throw Error(s(387));f=o.pendingProps;var b=o.memoizedState;g=b.element,Eh(a,o),Tl(o,f,null,d);var S=o.memoizedState;if(f=S.cache,Na(o,Qt,f),f!==b.cache&&vh(o,[Qt],d,!0),Cl(),f=S.element,b.isDehydrated)if(b={element:f,isDehydrated:!1,cache:S.cache},o.updateQueue.baseState=b,o.memoizedState=b,o.flags&256){o=P0(a,o,f,d);break e}else if(f!==g){g=rn(Error(s(424)),o),wl(g),o=P0(a,o,f,d);break e}else{switch(a=o.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Ot=Nn(a.firstChild),As=o,lt=!0,gi=null,Ln=!0,d=y0(o,null,f,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(vl(),f===g){o=ra(a,o,d);break e}os(a,o,f,d)}o=o.child}return o;case 26:return Ic(a,o),a===null?(d=Vy(o.type,null,o.pendingProps,null))?o.memoizedState=d:lt||(d=o.type,a=o.pendingProps,f=Kc(pe.current).createElement(d),f[yt]=o,f[jt]=a,ds(f,d,a),Jt(f),o.stateNode=f):o.memoizedState=Vy(o.type,a.memoizedProps,o.pendingProps,a.memoizedState),null;case 27:return He(o),a===null&&lt&&(f=o.stateNode=Fy(o.type,o.pendingProps,pe.current),As=o,Ln=!0,g=Ot,Ba(o.type)?(Bf=g,Ot=Nn(f.firstChild)):Ot=g),os(a,o,o.pendingProps.children,d),Ic(a,o),a===null&&(o.flags|=4194304),o.child;case 5:return a===null&&lt&&((g=f=Ot)&&(f=vS(f,o.type,o.pendingProps,Ln),f!==null?(o.stateNode=f,As=o,Ot=Nn(f.firstChild),Ln=!1,g=!0):g=!1),g||xi(o)),He(o),g=o.type,b=o.pendingProps,S=a!==null?a.memoizedProps:null,f=b.children,Lf(g,b)?f=null:S!==null&&Lf(g,S)&&(o.flags|=32),o.memoizedState!==null&&(g=kh(a,o,Bj,null,null,d),Zl._currentValue=g),Ic(a,o),os(a,o,f,d),o.child;case 6:return a===null&&lt&&((a=d=Ot)&&(d=wS(d,o.pendingProps,Ln),d!==null?(o.stateNode=d,As=o,Ot=null,a=!0):a=!1),a||xi(o)),null;case 13:return I0(a,o,d);case 4:return Te(o,o.stateNode.containerInfo),f=o.pendingProps,a===null?o.child=jr(o,null,f,d):os(a,o,f,d),o.child;case 11:return T0(a,o,o.type,o.pendingProps,d);case 7:return os(a,o,o.pendingProps,d),o.child;case 8:return os(a,o,o.pendingProps.children,d),o.child;case 12:return os(a,o,o.pendingProps.children,d),o.child;case 10:return f=o.pendingProps,Na(o,o.type,f.value),os(a,o,f.children,d),o.child;case 9:return g=o.type._context,f=o.pendingProps.children,bi(o),g=ps(g),f=f(g),o.flags|=1,os(a,o,f,d),o.child;case 14:return D0(a,o,o.type,o.pendingProps,d);case 15:return R0(a,o,o.type,o.pendingProps,d);case 19:return H0(a,o,d);case 31:return f=o.pendingProps,d=o.mode,f={mode:f.mode,children:f.children},a===null?(d=Bc(f,d),d.ref=o.ref,o.child=d,d.return=o,o=d):(d=Jn(a.child,f),d.ref=o.ref,o.child=d,d.return=o,o=d),o;case 22:return k0(a,o,d);case 24:return bi(o),f=ps(Qt),a===null?(g=Nh(),g===null&&(g=wt,b=wh(),g.pooledCache=b,b.refCount++,b!==null&&(g.pooledCacheLanes|=d),g=b),o.memoizedState={parent:f,cache:g},Sh(o),Na(o,Qt,g)):((a.lanes&d)!==0&&(Eh(a,o),Tl(o,null,null,d),Cl()),g=a.memoizedState,b=o.memoizedState,g.parent!==f?(g={parent:f,cache:f},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),Na(o,Qt,f)):(f=b.cache,Na(o,Qt,f),f!==g.cache&&vh(o,[Qt],d,!0))),os(a,o,o.pendingProps.children,d),o.child;case 29:throw o.pendingProps}throw Error(s(156,o.tag))}function la(a){a.flags|=4}function F0(a,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!Xy(o)){if(o=dn.current,o!==null&&((nt&4194048)===nt?On!==null:(nt&62914560)!==nt&&(nt&536870912)===0||o!==On))throw El=jh,jx;a.flags|=8192}}function Hc(a,o){o!==null&&(a.flags|=4),a.flags&16384&&(o=a.tag!==22?xn():536870912,a.lanes|=o,Cr|=o)}function Pl(a,o){if(!lt)switch(a.tailMode){case"hidden":o=a.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var f=null;d!==null;)d.alternate!==null&&(f=d),d=d.sibling;f===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function kt(a){var o=a.alternate!==null&&a.alternate.child===a.child,d=0,f=0;if(o)for(var g=a.child;g!==null;)d|=g.lanes|g.childLanes,f|=g.subtreeFlags&65011712,f|=g.flags&65011712,g.return=a,g=g.sibling;else for(g=a.child;g!==null;)d|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=a,g=g.sibling;return a.subtreeFlags|=f,a.childLanes=d,o}function Yj(a,o,d){var f=o.pendingProps;switch(gh(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kt(o),null;case 1:return kt(o),null;case 3:return d=o.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),na(Qt),ue(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(a===null||a.child===null)&&(bl(o)?la(o):a===null||a.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,bx())),kt(o),null;case 26:return d=o.memoizedState,a===null?(la(o),d!==null?(kt(o),F0(o,d)):(kt(o),o.flags&=-16777217)):d?d!==a.memoizedState?(la(o),kt(o),F0(o,d)):(kt(o),o.flags&=-16777217):(a.memoizedProps!==f&&la(o),kt(o),o.flags&=-16777217),null;case 27:ze(o),d=pe.current;var g=o.type;if(a!==null&&o.stateNode!=null)a.memoizedProps!==f&&la(o);else{if(!f){if(o.stateNode===null)throw Error(s(166));return kt(o),null}a=ae.current,bl(o)?xx(o):(a=Fy(g,f,d),o.stateNode=a,la(o))}return kt(o),null;case 5:if(ze(o),d=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==f&&la(o);else{if(!f){if(o.stateNode===null)throw Error(s(166));return kt(o),null}if(a=ae.current,bl(o))xx(o);else{switch(g=Kc(pe.current),a){case 1:a=g.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:a=g.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":a=g.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":a=g.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":a=g.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof f.is=="string"?g.createElement("select",{is:f.is}):g.createElement("select"),f.multiple?a.multiple=!0:f.size&&(a.size=f.size);break;default:a=typeof f.is=="string"?g.createElement(d,{is:f.is}):g.createElement(d)}}a[yt]=o,a[jt]=f;e:for(g=o.child;g!==null;){if(g.tag===5||g.tag===6)a.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===o)break e;for(;g.sibling===null;){if(g.return===null||g.return===o)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}o.stateNode=a;e:switch(ds(a,d,f),d){case"button":case"input":case"select":case"textarea":a=!!f.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&la(o)}}return kt(o),o.flags&=-16777217,null;case 6:if(a&&o.stateNode!=null)a.memoizedProps!==f&&la(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(s(166));if(a=pe.current,bl(o)){if(a=o.stateNode,d=o.memoizedProps,f=null,g=As,g!==null)switch(g.tag){case 27:case 5:f=g.memoizedProps}a[yt]=o,a=!!(a.nodeValue===d||f!==null&&f.suppressHydrationWarning===!0||Ly(a.nodeValue,d)),a||xi(o)}else a=Kc(a).createTextNode(f),a[yt]=o,o.stateNode=a}return kt(o),null;case 13:if(f=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(g=bl(o),f!==null&&f.dehydrated!==null){if(a===null){if(!g)throw Error(s(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(s(317));g[yt]=o}else vl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;kt(o),g=!1}else g=bx(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(ia(o),o):(ia(o),null)}if(ia(o),(o.flags&128)!==0)return o.lanes=d,o;if(d=f!==null,a=a!==null&&a.memoizedState!==null,d){f=o.child,g=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(g=f.alternate.memoizedState.cachePool.pool);var b=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(b=f.memoizedState.cachePool.pool),b!==g&&(f.flags|=2048)}return d!==a&&d&&(o.child.flags|=8192),Hc(o,o.updateQueue),kt(o),null;case 4:return ue(),a===null&&Tf(o.stateNode.containerInfo),kt(o),null;case 10:return na(o.type),kt(o),null;case 19:if(M(Zt),g=o.memoizedState,g===null)return kt(o),null;if(f=(o.flags&128)!==0,b=g.rendering,b===null)if(f)Pl(g,!1);else{if(Pt!==0||a!==null&&(a.flags&128)!==0)for(a=o.child;a!==null;){if(b=Lc(a),b!==null){for(o.flags|=128,Pl(g,!1),a=b.updateQueue,o.updateQueue=a,Hc(o,a),o.subtreeFlags=0,a=d,d=o.child;d!==null;)px(d,a),d=d.sibling;return O(Zt,Zt.current&1|2),o.child}a=a.sibling}g.tail!==null&&Ee()>Uc&&(o.flags|=128,f=!0,Pl(g,!1),o.lanes=4194304)}else{if(!f)if(a=Lc(b),a!==null){if(o.flags|=128,f=!0,a=a.updateQueue,o.updateQueue=a,Hc(o,a),Pl(g,!0),g.tail===null&&g.tailMode==="hidden"&&!b.alternate&&!lt)return kt(o),null}else 2*Ee()-g.renderingStartTime>Uc&&d!==536870912&&(o.flags|=128,f=!0,Pl(g,!1),o.lanes=4194304);g.isBackwards?(b.sibling=o.child,o.child=b):(a=g.last,a!==null?a.sibling=b:o.child=b,g.last=b)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=Ee(),o.sibling=null,a=Zt.current,O(Zt,f?a&1|2:a&1),o):(kt(o),null);case 22:case 23:return ia(o),Dh(),f=o.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(d&536870912)!==0&&(o.flags&128)===0&&(kt(o),o.subtreeFlags&6&&(o.flags|=8192)):kt(o),d=o.updateQueue,d!==null&&Hc(o,d.retryQueue),d=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==d&&(o.flags|=2048),a!==null&&M(vi),null;case 24:return d=null,a!==null&&(d=a.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),na(Qt),kt(o),null;case 25:return null;case 30:return null}throw Error(s(156,o.tag))}function Wj(a,o){switch(gh(o),o.tag){case 1:return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return na(Qt),ue(),a=o.flags,(a&65536)!==0&&(a&128)===0?(o.flags=a&-65537|128,o):null;case 26:case 27:case 5:return ze(o),null;case 13:if(ia(o),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(s(340));vl()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return M(Zt),null;case 4:return ue(),null;case 10:return na(o.type),null;case 22:case 23:return ia(o),Dh(),a!==null&&M(vi),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 24:return na(Qt),null;case 25:return null;default:return null}}function U0(a,o){switch(gh(o),o.tag){case 3:na(Qt),ue();break;case 26:case 27:case 5:ze(o);break;case 4:ue();break;case 13:ia(o);break;case 19:M(Zt);break;case 10:na(o.type);break;case 22:case 23:ia(o),Dh(),a!==null&&M(vi);break;case 24:na(Qt)}}function Il(a,o){try{var d=o.updateQueue,f=d!==null?d.lastEffect:null;if(f!==null){var g=f.next;d=g;do{if((d.tag&a)===a){f=void 0;var b=d.create,S=d.inst;f=b(),S.destroy=f}d=d.next}while(d!==g)}}catch(R){bt(o,o.return,R)}}function Da(a,o,d){try{var f=o.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var b=g.next;f=b;do{if((f.tag&a)===a){var S=f.inst,R=S.destroy;if(R!==void 0){S.destroy=void 0,g=o;var z=d,J=R;try{J()}catch(he){bt(g,z,he)}}}f=f.next}while(f!==b)}}catch(he){bt(o,o.return,he)}}function $0(a){var o=a.updateQueue;if(o!==null){var d=a.stateNode;try{Dx(o,d)}catch(f){bt(a,a.return,f)}}}function V0(a,o,d){d.props=Ai(a.type,a.memoizedProps),d.state=a.memoizedState;try{d.componentWillUnmount()}catch(f){bt(a,o,f)}}function Bl(a,o){try{var d=a.ref;if(d!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof d=="function"?a.refCleanup=d(f):d.current=f}}catch(g){bt(a,o,g)}}function Pn(a,o){var d=a.ref,f=a.refCleanup;if(d!==null)if(typeof f=="function")try{f()}catch(g){bt(a,o,g)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(g){bt(a,o,g)}else d.current=null}function q0(a){var o=a.type,d=a.memoizedProps,f=a.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":d.autoFocus&&f.focus();break e;case"img":d.src?f.src=d.src:d.srcSet&&(f.srcset=d.srcSet)}}catch(g){bt(a,a.return,g)}}function af(a,o,d){try{var f=a.stateNode;pS(f,a.type,d,o),f[jt]=o}catch(g){bt(a,a.return,g)}}function G0(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Ba(a.type)||a.tag===4}function rf(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||G0(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Ba(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function lf(a,o,d){var f=a.tag;if(f===5||f===6)a=a.stateNode,o?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(a,o):(o=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,o.appendChild(a),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=Zc));else if(f!==4&&(f===27&&Ba(a.type)&&(d=a.stateNode,o=null),a=a.child,a!==null))for(lf(a,o,d),a=a.sibling;a!==null;)lf(a,o,d),a=a.sibling}function zc(a,o,d){var f=a.tag;if(f===5||f===6)a=a.stateNode,o?d.insertBefore(a,o):d.appendChild(a);else if(f!==4&&(f===27&&Ba(a.type)&&(d=a.stateNode),a=a.child,a!==null))for(zc(a,o,d),a=a.sibling;a!==null;)zc(a,o,d),a=a.sibling}function Y0(a){var o=a.stateNode,d=a.memoizedProps;try{for(var f=a.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);ds(o,f,d),o[yt]=a,o[jt]=d}catch(b){bt(a,a.return,b)}}var oa=!1,Ht=!1,of=!1,W0=typeof WeakSet=="function"?WeakSet:Set,ts=null;function Xj(a,o){if(a=a.containerInfo,kf=ad,a=ix(a),ih(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var f=d.getSelection&&d.getSelection();if(f&&f.rangeCount!==0){d=f.anchorNode;var g=f.anchorOffset,b=f.focusNode;f=f.focusOffset;try{d.nodeType,b.nodeType}catch{d=null;break e}var S=0,R=-1,z=-1,J=0,he=0,ge=a,se=null;t:for(;;){for(var ne;ge!==d||g!==0&&ge.nodeType!==3||(R=S+g),ge!==b||f!==0&&ge.nodeType!==3||(z=S+f),ge.nodeType===3&&(S+=ge.nodeValue.length),(ne=ge.firstChild)!==null;)se=ge,ge=ne;for(;;){if(ge===a)break t;if(se===d&&++J===g&&(R=S),se===b&&++he===f&&(z=S),(ne=ge.nextSibling)!==null)break;ge=se,se=ge.parentNode}ge=ne}d=R===-1||z===-1?null:{start:R,end:z}}else d=null}d=d||{start:0,end:0}}else d=null;for(Mf={focusedElem:a,selectionRange:d},ad=!1,ts=o;ts!==null;)if(o=ts,a=o.child,(o.subtreeFlags&1024)!==0&&a!==null)a.return=o,ts=a;else for(;ts!==null;){switch(o=ts,b=o.alternate,a=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&b!==null){a=void 0,d=o,g=b.memoizedProps,b=b.memoizedState,f=d.stateNode;try{var Be=Ai(d.type,g,d.elementType===d.type);a=f.getSnapshotBeforeUpdate(Be,b),f.__reactInternalSnapshotBeforeUpdate=a}catch(Le){bt(d,d.return,Le)}}break;case 3:if((a&1024)!==0){if(a=o.stateNode.containerInfo,d=a.nodeType,d===9)Pf(a);else if(d===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Pf(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(s(163))}if(a=o.sibling,a!==null){a.return=o.return,ts=a;break}ts=o.return}}function X0(a,o,d){var f=d.flags;switch(d.tag){case 0:case 11:case 15:Ra(a,d),f&4&&Il(5,d);break;case 1:if(Ra(a,d),f&4)if(a=d.stateNode,o===null)try{a.componentDidMount()}catch(S){bt(d,d.return,S)}else{var g=Ai(d.type,o.memoizedProps);o=o.memoizedState;try{a.componentDidUpdate(g,o,a.__reactInternalSnapshotBeforeUpdate)}catch(S){bt(d,d.return,S)}}f&64&&$0(d),f&512&&Bl(d,d.return);break;case 3:if(Ra(a,d),f&64&&(a=d.updateQueue,a!==null)){if(o=null,d.child!==null)switch(d.child.tag){case 27:case 5:o=d.child.stateNode;break;case 1:o=d.child.stateNode}try{Dx(a,o)}catch(S){bt(d,d.return,S)}}break;case 27:o===null&&f&4&&Y0(d);case 26:case 5:Ra(a,d),o===null&&f&4&&q0(d),f&512&&Bl(d,d.return);break;case 12:Ra(a,d);break;case 13:Ra(a,d),f&4&&K0(a,d),f&64&&(a=d.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(d=aS.bind(null,d),AS(a,d))));break;case 22:if(f=d.memoizedState!==null||oa,!f){o=o!==null&&o.memoizedState!==null||Ht,g=oa;var b=Ht;oa=f,(Ht=o)&&!b?ka(a,d,(d.subtreeFlags&8772)!==0):Ra(a,d),oa=g,Ht=b}break;case 30:break;default:Ra(a,d)}}function Q0(a){var o=a.alternate;o!==null&&(a.alternate=null,Q0(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&ms(o)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var St=null,Rs=!1;function ca(a,o,d){for(d=d.child;d!==null;)Z0(a,o,d),d=d.sibling}function Z0(a,o,d){if(je&&typeof je.onCommitFiberUnmount=="function")try{je.onCommitFiberUnmount(Ae,d)}catch{}switch(d.tag){case 26:Ht||Pn(d,o),ca(a,o,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Ht||Pn(d,o);var f=St,g=Rs;Ba(d.type)&&(St=d.stateNode,Rs=!1),ca(a,o,d),Yl(d.stateNode),St=f,Rs=g;break;case 5:Ht||Pn(d,o);case 6:if(f=St,g=Rs,St=null,ca(a,o,d),St=f,Rs=g,St!==null)if(Rs)try{(St.nodeType===9?St.body:St.nodeName==="HTML"?St.ownerDocument.body:St).removeChild(d.stateNode)}catch(b){bt(d,o,b)}else try{St.removeChild(d.stateNode)}catch(b){bt(d,o,b)}break;case 18:St!==null&&(Rs?(a=St,Hy(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,d.stateNode),to(a)):Hy(St,d.stateNode));break;case 4:f=St,g=Rs,St=d.stateNode.containerInfo,Rs=!0,ca(a,o,d),St=f,Rs=g;break;case 0:case 11:case 14:case 15:Ht||Da(2,d,o),Ht||Da(4,d,o),ca(a,o,d);break;case 1:Ht||(Pn(d,o),f=d.stateNode,typeof f.componentWillUnmount=="function"&&V0(d,o,f)),ca(a,o,d);break;case 21:ca(a,o,d);break;case 22:Ht=(f=Ht)||d.memoizedState!==null,ca(a,o,d),Ht=f;break;default:ca(a,o,d)}}function K0(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{to(a)}catch(d){bt(o,o.return,d)}}function Qj(a){switch(a.tag){case 13:case 19:var o=a.stateNode;return o===null&&(o=a.stateNode=new W0),o;case 22:return a=a.stateNode,o=a._retryCache,o===null&&(o=a._retryCache=new W0),o;default:throw Error(s(435,a.tag))}}function cf(a,o){var d=Qj(a);o.forEach(function(f){var g=iS.bind(null,a,f);d.has(f)||(d.add(f),f.then(g,g))})}function qs(a,o){var d=o.deletions;if(d!==null)for(var f=0;f<d.length;f++){var g=d[f],b=a,S=o,R=S;e:for(;R!==null;){switch(R.tag){case 27:if(Ba(R.type)){St=R.stateNode,Rs=!1;break e}break;case 5:St=R.stateNode,Rs=!1;break e;case 3:case 4:St=R.stateNode.containerInfo,Rs=!0;break e}R=R.return}if(St===null)throw Error(s(160));Z0(b,S,g),St=null,Rs=!1,b=g.alternate,b!==null&&(b.return=null),g.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)J0(o,a),o=o.sibling}var An=null;function J0(a,o){var d=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:qs(o,a),Gs(a),f&4&&(Da(3,a,a.return),Il(3,a),Da(5,a,a.return));break;case 1:qs(o,a),Gs(a),f&512&&(Ht||d===null||Pn(d,d.return)),f&64&&oa&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(d=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=d===null?f:d.concat(f))));break;case 26:var g=An;if(qs(o,a),Gs(a),f&512&&(Ht||d===null||Pn(d,d.return)),f&4){var b=d!==null?d.memoizedState:null;if(f=a.memoizedState,d===null)if(f===null)if(a.stateNode===null){e:{f=a.type,d=a.memoizedProps,g=g.ownerDocument||g;t:switch(f){case"title":b=g.getElementsByTagName("title")[0],(!b||b[bn]||b[yt]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=g.createElement(f),g.head.insertBefore(b,g.querySelector("head > title"))),ds(b,f,d),b[yt]=a,Jt(b),f=b;break e;case"link":var S=Yy("link","href",g).get(f+(d.href||""));if(S){for(var R=0;R<S.length;R++)if(b=S[R],b.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&b.getAttribute("rel")===(d.rel==null?null:d.rel)&&b.getAttribute("title")===(d.title==null?null:d.title)&&b.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){S.splice(R,1);break t}}b=g.createElement(f),ds(b,f,d),g.head.appendChild(b);break;case"meta":if(S=Yy("meta","content",g).get(f+(d.content||""))){for(R=0;R<S.length;R++)if(b=S[R],b.getAttribute("content")===(d.content==null?null:""+d.content)&&b.getAttribute("name")===(d.name==null?null:d.name)&&b.getAttribute("property")===(d.property==null?null:d.property)&&b.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&b.getAttribute("charset")===(d.charSet==null?null:d.charSet)){S.splice(R,1);break t}}b=g.createElement(f),ds(b,f,d),g.head.appendChild(b);break;default:throw Error(s(468,f))}b[yt]=a,Jt(b),f=b}a.stateNode=f}else Wy(g,a.type,a.stateNode);else a.stateNode=Gy(g,f,a.memoizedProps);else b!==f?(b===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):b.count--,f===null?Wy(g,a.type,a.stateNode):Gy(g,f,a.memoizedProps)):f===null&&a.stateNode!==null&&af(a,a.memoizedProps,d.memoizedProps)}break;case 27:qs(o,a),Gs(a),f&512&&(Ht||d===null||Pn(d,d.return)),d!==null&&f&4&&af(a,a.memoizedProps,d.memoizedProps);break;case 5:if(qs(o,a),Gs(a),f&512&&(Ht||d===null||Pn(d,d.return)),a.flags&32){g=a.stateNode;try{rr(g,"")}catch(ne){bt(a,a.return,ne)}}f&4&&a.stateNode!=null&&(g=a.memoizedProps,af(a,g,d!==null?d.memoizedProps:g)),f&1024&&(of=!0);break;case 6:if(qs(o,a),Gs(a),f&4){if(a.stateNode===null)throw Error(s(162));f=a.memoizedProps,d=a.stateNode;try{d.nodeValue=f}catch(ne){bt(a,a.return,ne)}}break;case 3:if(td=null,g=An,An=Jc(o.containerInfo),qs(o,a),An=g,Gs(a),f&4&&d!==null&&d.memoizedState.isDehydrated)try{to(o.containerInfo)}catch(ne){bt(a,a.return,ne)}of&&(of=!1,ey(a));break;case 4:f=An,An=Jc(a.stateNode.containerInfo),qs(o,a),Gs(a),An=f;break;case 12:qs(o,a),Gs(a);break;case 13:qs(o,a),Gs(a),a.child.flags&8192&&a.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(pf=Ee()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,cf(a,f)));break;case 22:g=a.memoizedState!==null;var z=d!==null&&d.memoizedState!==null,J=oa,he=Ht;if(oa=J||g,Ht=he||z,qs(o,a),Ht=he,oa=J,Gs(a),f&8192)e:for(o=a.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(d===null||z||oa||Ht||Ni(a)),d=null,o=a;;){if(o.tag===5||o.tag===26){if(d===null){z=d=o;try{if(b=z.stateNode,g)S=b.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{R=z.stateNode;var ge=z.memoizedProps.style,se=ge!=null&&ge.hasOwnProperty("display")?ge.display:null;R.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(ne){bt(z,z.return,ne)}}}else if(o.tag===6){if(d===null){z=o;try{z.stateNode.nodeValue=g?"":z.memoizedProps}catch(ne){bt(z,z.return,ne)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===a)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;d===o&&(d=null),o=o.return}d===o&&(d=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=a.updateQueue,f!==null&&(d=f.retryQueue,d!==null&&(f.retryQueue=null,cf(a,d))));break;case 19:qs(o,a),Gs(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,cf(a,f)));break;case 30:break;case 21:break;default:qs(o,a),Gs(a)}}function Gs(a){var o=a.flags;if(o&2){try{for(var d,f=a.return;f!==null;){if(G0(f)){d=f;break}f=f.return}if(d==null)throw Error(s(160));switch(d.tag){case 27:var g=d.stateNode,b=rf(a);zc(a,b,g);break;case 5:var S=d.stateNode;d.flags&32&&(rr(S,""),d.flags&=-33);var R=rf(a);zc(a,R,S);break;case 3:case 4:var z=d.stateNode.containerInfo,J=rf(a);lf(a,J,z);break;default:throw Error(s(161))}}catch(he){bt(a,a.return,he)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function ey(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var o=a;ey(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),a=a.sibling}}function Ra(a,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)X0(a,o.alternate,o),o=o.sibling}function Ni(a){for(a=a.child;a!==null;){var o=a;switch(o.tag){case 0:case 11:case 14:case 15:Da(4,o,o.return),Ni(o);break;case 1:Pn(o,o.return);var d=o.stateNode;typeof d.componentWillUnmount=="function"&&V0(o,o.return,d),Ni(o);break;case 27:Yl(o.stateNode);case 26:case 5:Pn(o,o.return),Ni(o);break;case 22:o.memoizedState===null&&Ni(o);break;case 30:Ni(o);break;default:Ni(o)}a=a.sibling}}function ka(a,o,d){for(d=d&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,g=a,b=o,S=b.flags;switch(b.tag){case 0:case 11:case 15:ka(g,b,d),Il(4,b);break;case 1:if(ka(g,b,d),f=b,g=f.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(J){bt(f,f.return,J)}if(f=b,g=f.updateQueue,g!==null){var R=f.stateNode;try{var z=g.shared.hiddenCallbacks;if(z!==null)for(g.shared.hiddenCallbacks=null,g=0;g<z.length;g++)Tx(z[g],R)}catch(J){bt(f,f.return,J)}}d&&S&64&&$0(b),Bl(b,b.return);break;case 27:Y0(b);case 26:case 5:ka(g,b,d),d&&f===null&&S&4&&q0(b),Bl(b,b.return);break;case 12:ka(g,b,d);break;case 13:ka(g,b,d),d&&S&4&&K0(g,b);break;case 22:b.memoizedState===null&&ka(g,b,d),Bl(b,b.return);break;case 30:break;default:ka(g,b,d)}o=o.sibling}}function df(a,o){var d=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),a=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(a=o.memoizedState.cachePool.pool),a!==d&&(a!=null&&a.refCount++,d!=null&&Nl(d))}function uf(a,o){a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Nl(a))}function In(a,o,d,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)ty(a,o,d,f),o=o.sibling}function ty(a,o,d,f){var g=o.flags;switch(o.tag){case 0:case 11:case 15:In(a,o,d,f),g&2048&&Il(9,o);break;case 1:In(a,o,d,f);break;case 3:In(a,o,d,f),g&2048&&(a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Nl(a)));break;case 12:if(g&2048){In(a,o,d,f),a=o.stateNode;try{var b=o.memoizedProps,S=b.id,R=b.onPostCommit;typeof R=="function"&&R(S,o.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(z){bt(o,o.return,z)}}else In(a,o,d,f);break;case 13:In(a,o,d,f);break;case 23:break;case 22:b=o.stateNode,S=o.alternate,o.memoizedState!==null?b._visibility&2?In(a,o,d,f):Hl(a,o):b._visibility&2?In(a,o,d,f):(b._visibility|=2,Sr(a,o,d,f,(o.subtreeFlags&10256)!==0)),g&2048&&df(S,o);break;case 24:In(a,o,d,f),g&2048&&uf(o.alternate,o);break;default:In(a,o,d,f)}}function Sr(a,o,d,f,g){for(g=g&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var b=a,S=o,R=d,z=f,J=S.flags;switch(S.tag){case 0:case 11:case 15:Sr(b,S,R,z,g),Il(8,S);break;case 23:break;case 22:var he=S.stateNode;S.memoizedState!==null?he._visibility&2?Sr(b,S,R,z,g):Hl(b,S):(he._visibility|=2,Sr(b,S,R,z,g)),g&&J&2048&&df(S.alternate,S);break;case 24:Sr(b,S,R,z,g),g&&J&2048&&uf(S.alternate,S);break;default:Sr(b,S,R,z,g)}o=o.sibling}}function Hl(a,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var d=a,f=o,g=f.flags;switch(f.tag){case 22:Hl(d,f),g&2048&&df(f.alternate,f);break;case 24:Hl(d,f),g&2048&&uf(f.alternate,f);break;default:Hl(d,f)}o=o.sibling}}var zl=8192;function Er(a){if(a.subtreeFlags&zl)for(a=a.child;a!==null;)sy(a),a=a.sibling}function sy(a){switch(a.tag){case 26:Er(a),a.flags&zl&&a.memoizedState!==null&&OS(An,a.memoizedState,a.memoizedProps);break;case 5:Er(a);break;case 3:case 4:var o=An;An=Jc(a.stateNode.containerInfo),Er(a),An=o;break;case 22:a.memoizedState===null&&(o=a.alternate,o!==null&&o.memoizedState!==null?(o=zl,zl=16777216,Er(a),zl=o):Er(a));break;default:Er(a)}}function ny(a){var o=a.alternate;if(o!==null&&(a=o.child,a!==null)){o.child=null;do o=a.sibling,a.sibling=null,a=o;while(a!==null)}}function Fl(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var d=0;d<o.length;d++){var f=o[d];ts=f,iy(f,a)}ny(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)ay(a),a=a.sibling}function ay(a){switch(a.tag){case 0:case 11:case 15:Fl(a),a.flags&2048&&Da(9,a,a.return);break;case 3:Fl(a);break;case 12:Fl(a);break;case 22:var o=a.stateNode;a.memoizedState!==null&&o._visibility&2&&(a.return===null||a.return.tag!==13)?(o._visibility&=-3,Fc(a)):Fl(a);break;default:Fl(a)}}function Fc(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var d=0;d<o.length;d++){var f=o[d];ts=f,iy(f,a)}ny(a)}for(a=a.child;a!==null;){switch(o=a,o.tag){case 0:case 11:case 15:Da(8,o,o.return),Fc(o);break;case 22:d=o.stateNode,d._visibility&2&&(d._visibility&=-3,Fc(o));break;default:Fc(o)}a=a.sibling}}function iy(a,o){for(;ts!==null;){var d=ts;switch(d.tag){case 0:case 11:case 15:Da(8,d,o);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var f=d.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Nl(d.memoizedState.cache)}if(f=d.child,f!==null)f.return=d,ts=f;else e:for(d=a;ts!==null;){f=ts;var g=f.sibling,b=f.return;if(Q0(f),f===d){ts=null;break e}if(g!==null){g.return=b,ts=g;break e}ts=b}}}var Zj={getCacheForType:function(a){var o=ps(Qt),d=o.data.get(a);return d===void 0&&(d=a(),o.data.set(a,d)),d}},Kj=typeof WeakMap=="function"?WeakMap:Map,dt=0,wt=null,Ke=null,nt=0,ut=0,Ys=null,Ma=!1,_r=!1,hf=!1,da=0,Pt=0,La=0,ji=0,ff=0,un=0,Cr=0,Ul=null,ks=null,mf=!1,pf=0,Uc=1/0,$c=null,Oa=null,cs=0,Pa=null,Tr=null,Dr=0,gf=0,xf=null,ry=null,$l=0,yf=null;function Ws(){if((dt&2)!==0&&nt!==0)return nt&-nt;if(L.T!==null){var a=xr;return a!==0?a:Sf()}return Ce()}function ly(){un===0&&(un=(nt&536870912)===0||lt?li():536870912);var a=dn.current;return a!==null&&(a.flags|=32),un}function Xs(a,o,d){(a===wt&&(ut===2||ut===9)||a.cancelPendingCommit!==null)&&(Rr(a,0),Ia(a,nt,un,!1)),Fs(a,d),((dt&2)===0||a!==wt)&&(a===wt&&((dt&2)===0&&(ji|=d),Pt===4&&Ia(a,nt,un,!1)),Bn(a))}function oy(a,o,d){if((dt&6)!==0)throw Error(s(327));var f=!d&&(o&124)===0&&(o&a.expiredLanes)===0||zs(a,o),g=f?tS(a,o):wf(a,o,!0),b=f;do{if(g===0){_r&&!f&&Ia(a,o,0,!1);break}else{if(d=a.current.alternate,b&&!Jj(d)){g=wf(a,o,!1),b=!1;continue}if(g===2){if(b=o,a.errorRecoveryDisabledLanes&b)var S=0;else S=a.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){o=S;e:{var R=a;g=Ul;var z=R.current.memoizedState.isDehydrated;if(z&&(Rr(R,S).flags|=256),S=wf(R,S,!1),S!==2){if(hf&&!z){R.errorRecoveryDisabledLanes|=b,ji|=b,g=4;break e}b=ks,ks=g,b!==null&&(ks===null?ks=b:ks.push.apply(ks,b))}g=S}if(b=!1,g!==2)continue}}if(g===1){Rr(a,0),Ia(a,o,0,!0);break}e:{switch(f=a,b=g,b){case 0:case 1:throw Error(s(345));case 4:if((o&4194048)!==o)break;case 6:Ia(f,o,un,!Ma);break e;case 2:ks=null;break;case 3:case 5:break;default:throw Error(s(329))}if((o&62914560)===o&&(g=pf+300-Ee(),10<g)){if(Ia(f,o,un,!Ma),gn(f,0,!0)!==0)break e;f.timeoutHandle=Iy(cy.bind(null,f,d,ks,$c,mf,o,un,ji,Cr,Ma,b,2,-0,0),g);break e}cy(f,d,ks,$c,mf,o,un,ji,Cr,Ma,b,0,-0,0)}}break}while(!0);Bn(a)}function cy(a,o,d,f,g,b,S,R,z,J,he,ge,se,ne){if(a.timeoutHandle=-1,ge=o.subtreeFlags,(ge&8192||(ge&16785408)===16785408)&&(Ql={stylesheets:null,count:0,unsuspend:LS},sy(o),ge=PS(),ge!==null)){a.cancelPendingCommit=ge(gy.bind(null,a,o,b,d,f,g,S,R,z,he,1,se,ne)),Ia(a,b,S,!J);return}gy(a,o,b,d,f,g,S,R,z)}function Jj(a){for(var o=a;;){var d=o.tag;if((d===0||d===11||d===15)&&o.flags&16384&&(d=o.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var f=0;f<d.length;f++){var g=d[f],b=g.getSnapshot;g=g.value;try{if(!$s(b(),g))return!1}catch{return!1}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ia(a,o,d,f){o&=~ff,o&=~ji,a.suspendedLanes|=o,a.pingedLanes&=~o,f&&(a.warmLanes|=o),f=a.expirationTimes;for(var g=o;0<g;){var b=31-ct(g),S=1<<b;f[b]=-1,g&=~S}d!==0&&zu(a,d,o)}function Vc(){return(dt&6)===0?(Vl(0),!1):!0}function bf(){if(Ke!==null){if(ut===0)var a=Ke.return;else a=Ke,sa=yi=null,Oh(a),Nr=null,Ll=0,a=Ke;for(;a!==null;)U0(a.alternate,a),a=a.return;Ke=null}}function Rr(a,o){var d=a.timeoutHandle;d!==-1&&(a.timeoutHandle=-1,xS(d)),d=a.cancelPendingCommit,d!==null&&(a.cancelPendingCommit=null,d()),bf(),wt=a,Ke=d=Jn(a.current,null),nt=o,ut=0,Ys=null,Ma=!1,_r=zs(a,o),hf=!1,Cr=un=ff=ji=La=Pt=0,ks=Ul=null,mf=!1,(o&8)!==0&&(o|=o&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=o;0<f;){var g=31-ct(f),b=1<<g;o|=a[g],f&=~b}return da=o,hc(),d}function dy(a,o){We=null,L.H=Rc,o===Sl||o===wc?(o=_x(),ut=3):o===jx?(o=_x(),ut=4):ut=o===C0?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ys=o,Ke===null&&(Pt=1,Pc(a,rn(o,a.current)))}function uy(){var a=L.H;return L.H=Rc,a===null?Rc:a}function hy(){var a=L.A;return L.A=Zj,a}function vf(){Pt=4,Ma||(nt&4194048)!==nt&&dn.current!==null||(_r=!0),(La&134217727)===0&&(ji&134217727)===0||wt===null||Ia(wt,nt,un,!1)}function wf(a,o,d){var f=dt;dt|=2;var g=uy(),b=hy();(wt!==a||nt!==o)&&($c=null,Rr(a,o)),o=!1;var S=Pt;e:do try{if(ut!==0&&Ke!==null){var R=Ke,z=Ys;switch(ut){case 8:bf(),S=6;break e;case 3:case 2:case 9:case 6:dn.current===null&&(o=!0);var J=ut;if(ut=0,Ys=null,kr(a,R,z,J),d&&_r){S=0;break e}break;default:J=ut,ut=0,Ys=null,kr(a,R,z,J)}}eS(),S=Pt;break}catch(he){dy(a,he)}while(!0);return o&&a.shellSuspendCounter++,sa=yi=null,dt=f,L.H=g,L.A=b,Ke===null&&(wt=null,nt=0,hc()),S}function eS(){for(;Ke!==null;)fy(Ke)}function tS(a,o){var d=dt;dt|=2;var f=uy(),g=hy();wt!==a||nt!==o?($c=null,Uc=Ee()+500,Rr(a,o)):_r=zs(a,o);e:do try{if(ut!==0&&Ke!==null){o=Ke;var b=Ys;t:switch(ut){case 1:ut=0,Ys=null,kr(a,o,b,1);break;case 2:case 9:if(Sx(b)){ut=0,Ys=null,my(o);break}o=function(){ut!==2&&ut!==9||wt!==a||(ut=7),Bn(a)},b.then(o,o);break e;case 3:ut=7;break e;case 4:ut=5;break e;case 7:Sx(b)?(ut=0,Ys=null,my(o)):(ut=0,Ys=null,kr(a,o,b,7));break;case 5:var S=null;switch(Ke.tag){case 26:S=Ke.memoizedState;case 5:case 27:var R=Ke;if(!S||Xy(S)){ut=0,Ys=null;var z=R.sibling;if(z!==null)Ke=z;else{var J=R.return;J!==null?(Ke=J,qc(J)):Ke=null}break t}}ut=0,Ys=null,kr(a,o,b,5);break;case 6:ut=0,Ys=null,kr(a,o,b,6);break;case 8:bf(),Pt=6;break e;default:throw Error(s(462))}}sS();break}catch(he){dy(a,he)}while(!0);return sa=yi=null,L.H=f,L.A=g,dt=d,Ke!==null?0:(wt=null,nt=0,hc(),Pt)}function sS(){for(;Ke!==null&&!be();)fy(Ke)}function fy(a){var o=z0(a.alternate,a,da);a.memoizedProps=a.pendingProps,o===null?qc(a):Ke=o}function my(a){var o=a,d=o.alternate;switch(o.tag){case 15:case 0:o=L0(d,o,o.pendingProps,o.type,void 0,nt);break;case 11:o=L0(d,o,o.pendingProps,o.type.render,o.ref,nt);break;case 5:Oh(o);default:U0(d,o),o=Ke=px(o,da),o=z0(d,o,da)}a.memoizedProps=a.pendingProps,o===null?qc(a):Ke=o}function kr(a,o,d,f){sa=yi=null,Oh(o),Nr=null,Ll=0;var g=o.return;try{if(qj(a,g,o,d,nt)){Pt=1,Pc(a,rn(d,a.current)),Ke=null;return}}catch(b){if(g!==null)throw Ke=g,b;Pt=1,Pc(a,rn(d,a.current)),Ke=null;return}o.flags&32768?(lt||f===1?a=!0:_r||(nt&536870912)!==0?a=!1:(Ma=a=!0,(f===2||f===9||f===3||f===6)&&(f=dn.current,f!==null&&f.tag===13&&(f.flags|=16384))),py(o,a)):qc(o)}function qc(a){var o=a;do{if((o.flags&32768)!==0){py(o,Ma);return}a=o.return;var d=Yj(o.alternate,o,da);if(d!==null){Ke=d;return}if(o=o.sibling,o!==null){Ke=o;return}Ke=o=a}while(o!==null);Pt===0&&(Pt=5)}function py(a,o){do{var d=Wj(a.alternate,a);if(d!==null){d.flags&=32767,Ke=d;return}if(d=a.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!o&&(a=a.sibling,a!==null)){Ke=a;return}Ke=a=d}while(a!==null);Pt=6,Ke=null}function gy(a,o,d,f,g,b,S,R,z){a.cancelPendingCommit=null;do Gc();while(cs!==0);if((dt&6)!==0)throw Error(s(327));if(o!==null){if(o===a.current)throw Error(s(177));if(b=o.lanes|o.childLanes,b|=dh,tr(a,d,b,S,R,z),a===wt&&(Ke=wt=null,nt=0),Tr=o,Pa=a,Dr=d,gf=b,xf=g,ry=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,rS(Ie,function(){return wy(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=L.T,L.T=null,g=q.p,q.p=2,S=dt,dt|=4;try{Xj(a,o,d)}finally{dt=S,q.p=g,L.T=f}}cs=1,xy(),yy(),by()}}function xy(){if(cs===1){cs=0;var a=Pa,o=Tr,d=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||d){d=L.T,L.T=null;var f=q.p;q.p=2;var g=dt;dt|=4;try{J0(o,a);var b=Mf,S=ix(a.containerInfo),R=b.focusedElem,z=b.selectionRange;if(S!==R&&R&&R.ownerDocument&&ax(R.ownerDocument.documentElement,R)){if(z!==null&&ih(R)){var J=z.start,he=z.end;if(he===void 0&&(he=J),"selectionStart"in R)R.selectionStart=J,R.selectionEnd=Math.min(he,R.value.length);else{var ge=R.ownerDocument||document,se=ge&&ge.defaultView||window;if(se.getSelection){var ne=se.getSelection(),Be=R.textContent.length,Le=Math.min(z.start,Be),pt=z.end===void 0?Le:Math.min(z.end,Be);!ne.extend&&Le>pt&&(S=pt,pt=Le,Le=S);var Y=nx(R,Le),$=nx(R,pt);if(Y&&$&&(ne.rangeCount!==1||ne.anchorNode!==Y.node||ne.anchorOffset!==Y.offset||ne.focusNode!==$.node||ne.focusOffset!==$.offset)){var Z=ge.createRange();Z.setStart(Y.node,Y.offset),ne.removeAllRanges(),Le>pt?(ne.addRange(Z),ne.extend($.node,$.offset)):(Z.setEnd($.node,$.offset),ne.addRange(Z))}}}}for(ge=[],ne=R;ne=ne.parentNode;)ne.nodeType===1&&ge.push({element:ne,left:ne.scrollLeft,top:ne.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<ge.length;R++){var fe=ge[R];fe.element.scrollLeft=fe.left,fe.element.scrollTop=fe.top}}ad=!!kf,Mf=kf=null}finally{dt=g,q.p=f,L.T=d}}a.current=o,cs=2}}function yy(){if(cs===2){cs=0;var a=Pa,o=Tr,d=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||d){d=L.T,L.T=null;var f=q.p;q.p=2;var g=dt;dt|=4;try{X0(a,o.alternate,o)}finally{dt=g,q.p=f,L.T=d}}cs=3}}function by(){if(cs===4||cs===3){cs=0,ye();var a=Pa,o=Tr,d=Dr,f=ry;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?cs=5:(cs=0,Tr=Pa=null,vy(a,a.pendingLanes));var g=a.pendingLanes;if(g===0&&(Oa=null),ve(d),o=o.stateNode,je&&typeof je.onCommitFiberRoot=="function")try{je.onCommitFiberRoot(Ae,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=L.T,g=q.p,q.p=2,L.T=null;try{for(var b=a.onRecoverableError,S=0;S<f.length;S++){var R=f[S];b(R.value,{componentStack:R.stack})}}finally{L.T=o,q.p=g}}(Dr&3)!==0&&Gc(),Bn(a),g=a.pendingLanes,(d&4194090)!==0&&(g&42)!==0?a===yf?$l++:($l=0,yf=a):$l=0,Vl(0)}}function vy(a,o){(a.pooledCacheLanes&=o)===0&&(o=a.pooledCache,o!=null&&(a.pooledCache=null,Nl(o)))}function Gc(a){return xy(),yy(),by(),wy()}function wy(){if(cs!==5)return!1;var a=Pa,o=gf;gf=0;var d=ve(Dr),f=L.T,g=q.p;try{q.p=32>d?32:d,L.T=null,d=xf,xf=null;var b=Pa,S=Dr;if(cs=0,Tr=Pa=null,Dr=0,(dt&6)!==0)throw Error(s(331));var R=dt;if(dt|=4,ay(b.current),ty(b,b.current,S,d),dt=R,Vl(0,!1),je&&typeof je.onPostCommitFiberRoot=="function")try{je.onPostCommitFiberRoot(Ae,b)}catch{}return!0}finally{q.p=g,L.T=f,vy(a,o)}}function Ay(a,o,d){o=rn(d,o),o=Xh(a.stateNode,o,2),a=Ea(a,o,2),a!==null&&(Fs(a,2),Bn(a))}function bt(a,o,d){if(a.tag===3)Ay(a,a,d);else for(;o!==null;){if(o.tag===3){Ay(o,a,d);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Oa===null||!Oa.has(f))){a=rn(d,a),d=E0(2),f=Ea(o,d,2),f!==null&&(_0(d,f,o,a),Fs(f,2),Bn(f));break}}o=o.return}}function Af(a,o,d){var f=a.pingCache;if(f===null){f=a.pingCache=new Kj;var g=new Set;f.set(o,g)}else g=f.get(o),g===void 0&&(g=new Set,f.set(o,g));g.has(d)||(hf=!0,g.add(d),a=nS.bind(null,a,o,d),o.then(a,a))}function nS(a,o,d){var f=a.pingCache;f!==null&&f.delete(o),a.pingedLanes|=a.suspendedLanes&d,a.warmLanes&=~d,wt===a&&(nt&d)===d&&(Pt===4||Pt===3&&(nt&62914560)===nt&&300>Ee()-pf?(dt&2)===0&&Rr(a,0):ff|=d,Cr===nt&&(Cr=0)),Bn(a)}function Ny(a,o){o===0&&(o=xn()),a=fr(a,o),a!==null&&(Fs(a,o),Bn(a))}function aS(a){var o=a.memoizedState,d=0;o!==null&&(d=o.retryLane),Ny(a,d)}function iS(a,o){var d=0;switch(a.tag){case 13:var f=a.stateNode,g=a.memoizedState;g!==null&&(d=g.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(s(314))}f!==null&&f.delete(o),Ny(a,d)}function rS(a,o){return At(a,o)}var Yc=null,Mr=null,Nf=!1,Wc=!1,jf=!1,Si=0;function Bn(a){a!==Mr&&a.next===null&&(Mr===null?Yc=Mr=a:Mr=Mr.next=a),Wc=!0,Nf||(Nf=!0,oS())}function Vl(a,o){if(!jf&&Wc){jf=!0;do for(var d=!1,f=Yc;f!==null;){if(a!==0){var g=f.pendingLanes;if(g===0)var b=0;else{var S=f.suspendedLanes,R=f.pingedLanes;b=(1<<31-ct(42|a)+1)-1,b&=g&~(S&~R),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(d=!0,_y(f,b))}else b=nt,b=gn(f,f===wt?b:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(b&3)===0||zs(f,b)||(d=!0,_y(f,b));f=f.next}while(d);jf=!1}}function lS(){jy()}function jy(){Wc=Nf=!1;var a=0;Si!==0&&(gS()&&(a=Si),Si=0);for(var o=Ee(),d=null,f=Yc;f!==null;){var g=f.next,b=Sy(f,o);b===0?(f.next=null,d===null?Yc=g:d.next=g,g===null&&(Mr=d)):(d=f,(a!==0||(b&3)!==0)&&(Wc=!0)),f=g}Vl(a)}function Sy(a,o){for(var d=a.suspendedLanes,f=a.pingedLanes,g=a.expirationTimes,b=a.pendingLanes&-62914561;0<b;){var S=31-ct(b),R=1<<S,z=g[S];z===-1?((R&d)===0||(R&f)!==0)&&(g[S]=ri(R,o)):z<=o&&(a.expiredLanes|=R),b&=~R}if(o=wt,d=nt,d=gn(a,a===o?d:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,d===0||a===o&&(ut===2||ut===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&le(f),a.callbackNode=null,a.callbackPriority=0;if((d&3)===0||zs(a,d)){if(o=d&-d,o===a.callbackPriority)return o;switch(f!==null&&le(f),ve(d)){case 2:case 8:d=Ne;break;case 32:d=Ie;break;case 268435456:d=Nt;break;default:d=Ie}return f=Ey.bind(null,a),d=At(d,f),a.callbackPriority=o,a.callbackNode=d,o}return f!==null&&f!==null&&le(f),a.callbackPriority=2,a.callbackNode=null,2}function Ey(a,o){if(cs!==0&&cs!==5)return a.callbackNode=null,a.callbackPriority=0,null;var d=a.callbackNode;if(Gc()&&a.callbackNode!==d)return null;var f=nt;return f=gn(a,a===wt?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(oy(a,f,o),Sy(a,Ee()),a.callbackNode!=null&&a.callbackNode===d?Ey.bind(null,a):null)}function _y(a,o){if(Gc())return null;oy(a,o,!0)}function oS(){yS(function(){(dt&6)!==0?At(te,lS):jy()})}function Sf(){return Si===0&&(Si=li()),Si}function Cy(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:ic(""+a)}function Ty(a,o){var d=o.ownerDocument.createElement("input");return d.name=o.name,d.value=o.value,a.id&&d.setAttribute("form",a.id),o.parentNode.insertBefore(d,o),a=new FormData(a),d.parentNode.removeChild(d),a}function cS(a,o,d,f,g){if(o==="submit"&&d&&d.stateNode===g){var b=Cy((g[jt]||null).action),S=f.submitter;S&&(o=(o=S[jt]||null)?Cy(o.formAction):S.getAttribute("formAction"),o!==null&&(b=o,S=null));var R=new cc("action","action",null,f,g);a.push({event:R,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Si!==0){var z=S?Ty(g,S):new FormData(g);Vh(d,{pending:!0,data:z,method:g.method,action:b},null,z)}}else typeof b=="function"&&(R.preventDefault(),z=S?Ty(g,S):new FormData(g),Vh(d,{pending:!0,data:z,method:g.method,action:b},b,z))},currentTarget:g}]})}}for(var Ef=0;Ef<ch.length;Ef++){var _f=ch[Ef],dS=_f.toLowerCase(),uS=_f[0].toUpperCase()+_f.slice(1);wn(dS,"on"+uS)}wn(ox,"onAnimationEnd"),wn(cx,"onAnimationIteration"),wn(dx,"onAnimationStart"),wn("dblclick","onDoubleClick"),wn("focusin","onFocus"),wn("focusout","onBlur"),wn(Cj,"onTransitionRun"),wn(Tj,"onTransitionStart"),wn(Dj,"onTransitionCancel"),wn(ux,"onTransitionEnd"),nr("onMouseEnter",["mouseout","mouseover"]),nr("onMouseLeave",["mouseout","mouseover"]),nr("onPointerEnter",["pointerout","pointerover"]),nr("onPointerLeave",["pointerout","pointerover"]),ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ci("onBeforeInput",["compositionend","keypress","textInput","paste"]),ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ql="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ql));function Dy(a,o){o=(o&4)!==0;for(var d=0;d<a.length;d++){var f=a[d],g=f.event;f=f.listeners;e:{var b=void 0;if(o)for(var S=f.length-1;0<=S;S--){var R=f[S],z=R.instance,J=R.currentTarget;if(R=R.listener,z!==b&&g.isPropagationStopped())break e;b=R,g.currentTarget=J;try{b(g)}catch(he){Oc(he)}g.currentTarget=null,b=z}else for(S=0;S<f.length;S++){if(R=f[S],z=R.instance,J=R.currentTarget,R=R.listener,z!==b&&g.isPropagationStopped())break e;b=R,g.currentTarget=J;try{b(g)}catch(he){Oc(he)}g.currentTarget=null,b=z}}}}function Je(a,o){var d=o[_s];d===void 0&&(d=o[_s]=new Set);var f=a+"__bubble";d.has(f)||(Ry(o,a,2,!1),d.add(f))}function Cf(a,o,d){var f=0;o&&(f|=4),Ry(d,a,f,o)}var Xc="_reactListening"+Math.random().toString(36).slice(2);function Tf(a){if(!a[Xc]){a[Xc]=!0,jg.forEach(function(d){d!=="selectionchange"&&(hS.has(d)||Cf(d,!1,a),Cf(d,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[Xc]||(o[Xc]=!0,Cf("selectionchange",!1,o))}}function Ry(a,o,d,f){switch(tb(o)){case 2:var g=HS;break;case 8:g=zS;break;default:g=$f}d=g.bind(null,o,d,a),g=void 0,!Qu||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),f?g!==void 0?a.addEventListener(o,d,{capture:!0,passive:g}):a.addEventListener(o,d,!0):g!==void 0?a.addEventListener(o,d,{passive:g}):a.addEventListener(o,d,!1)}function Df(a,o,d,f,g){var b=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var R=f.stateNode.containerInfo;if(R===g)break;if(S===4)for(S=f.return;S!==null;){var z=S.tag;if((z===3||z===4)&&S.stateNode.containerInfo===g)return;S=S.return}for(;R!==null;){if(S=vn(R),S===null)return;if(z=S.tag,z===5||z===6||z===26||z===27){f=b=S;continue e}R=R.parentNode}}f=f.return}Bg(function(){var J=b,he=Wu(d),ge=[];e:{var se=hx.get(a);if(se!==void 0){var ne=cc,Be=a;switch(a){case"keypress":if(lc(d)===0)break e;case"keydown":case"keyup":ne=rj;break;case"focusin":Be="focus",ne=eh;break;case"focusout":Be="blur",ne=eh;break;case"beforeblur":case"afterblur":ne=eh;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=Fg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=WN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=cj;break;case ox:case cx:case dx:ne=ZN;break;case ux:ne=uj;break;case"scroll":case"scrollend":ne=GN;break;case"wheel":ne=fj;break;case"copy":case"cut":case"paste":ne=JN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=$g;break;case"toggle":case"beforetoggle":ne=pj}var Le=(o&4)!==0,pt=!Le&&(a==="scroll"||a==="scrollend"),Y=Le?se!==null?se+"Capture":null:se;Le=[];for(var $=J,Z;$!==null;){var fe=$;if(Z=fe.stateNode,fe=fe.tag,fe!==5&&fe!==26&&fe!==27||Z===null||Y===null||(fe=dl($,Y),fe!=null&&Le.push(Gl($,fe,Z))),pt)break;$=$.return}0<Le.length&&(se=new ne(se,Be,null,d,he),ge.push({event:se,listeners:Le}))}}if((o&7)===0){e:{if(se=a==="mouseover"||a==="pointerover",ne=a==="mouseout"||a==="pointerout",se&&d!==Yu&&(Be=d.relatedTarget||d.fromElement)&&(vn(Be)||Be[sn]))break e;if((ne||se)&&(se=he.window===he?he:(se=he.ownerDocument)?se.defaultView||se.parentWindow:window,ne?(Be=d.relatedTarget||d.toElement,ne=J,Be=Be?vn(Be):null,Be!==null&&(pt=l(Be),Le=Be.tag,Be!==pt||Le!==5&&Le!==27&&Le!==6)&&(Be=null)):(ne=null,Be=J),ne!==Be)){if(Le=Fg,fe="onMouseLeave",Y="onMouseEnter",$="mouse",(a==="pointerout"||a==="pointerover")&&(Le=$g,fe="onPointerLeave",Y="onPointerEnter",$="pointer"),pt=ne==null?se:wa(ne),Z=Be==null?se:wa(Be),se=new Le(fe,$+"leave",ne,d,he),se.target=pt,se.relatedTarget=Z,fe=null,vn(he)===J&&(Le=new Le(Y,$+"enter",Be,d,he),Le.target=Z,Le.relatedTarget=pt,fe=Le),pt=fe,ne&&Be)t:{for(Le=ne,Y=Be,$=0,Z=Le;Z;Z=Lr(Z))$++;for(Z=0,fe=Y;fe;fe=Lr(fe))Z++;for(;0<$-Z;)Le=Lr(Le),$--;for(;0<Z-$;)Y=Lr(Y),Z--;for(;$--;){if(Le===Y||Y!==null&&Le===Y.alternate)break t;Le=Lr(Le),Y=Lr(Y)}Le=null}else Le=null;ne!==null&&ky(ge,se,ne,Le,!1),Be!==null&&pt!==null&&ky(ge,pt,Be,Le,!0)}}e:{if(se=J?wa(J):window,ne=se.nodeName&&se.nodeName.toLowerCase(),ne==="select"||ne==="input"&&se.type==="file")var _e=Zg;else if(Xg(se))if(Kg)_e=Sj;else{_e=Nj;var Qe=Aj}else ne=se.nodeName,!ne||ne.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?J&&Gu(J.elementType)&&(_e=Zg):_e=jj;if(_e&&(_e=_e(a,J))){Qg(ge,_e,d,he);break e}Qe&&Qe(a,se,J),a==="focusout"&&J&&se.type==="number"&&J.memoizedProps.value!=null&&qu(se,"number",se.value)}switch(Qe=J?wa(J):window,a){case"focusin":(Xg(Qe)||Qe.contentEditable==="true")&&(dr=Qe,rh=J,yl=null);break;case"focusout":yl=rh=dr=null;break;case"mousedown":lh=!0;break;case"contextmenu":case"mouseup":case"dragend":lh=!1,rx(ge,d,he);break;case"selectionchange":if(_j)break;case"keydown":case"keyup":rx(ge,d,he)}var De;if(sh)e:{switch(a){case"compositionstart":var Oe="onCompositionStart";break e;case"compositionend":Oe="onCompositionEnd";break e;case"compositionupdate":Oe="onCompositionUpdate";break e}Oe=void 0}else cr?Yg(a,d)&&(Oe="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Oe="onCompositionStart");Oe&&(Vg&&d.locale!=="ko"&&(cr||Oe!=="onCompositionStart"?Oe==="onCompositionEnd"&&cr&&(De=Hg()):(Aa=he,Zu="value"in Aa?Aa.value:Aa.textContent,cr=!0)),Qe=Qc(J,Oe),0<Qe.length&&(Oe=new Ug(Oe,a,null,d,he),ge.push({event:Oe,listeners:Qe}),De?Oe.data=De:(De=Wg(d),De!==null&&(Oe.data=De)))),(De=xj?yj(a,d):bj(a,d))&&(Oe=Qc(J,"onBeforeInput"),0<Oe.length&&(Qe=new Ug("onBeforeInput","beforeinput",null,d,he),ge.push({event:Qe,listeners:Oe}),Qe.data=De)),cS(ge,a,J,d,he)}Dy(ge,o)})}function Gl(a,o,d){return{instance:a,listener:o,currentTarget:d}}function Qc(a,o){for(var d=o+"Capture",f=[];a!==null;){var g=a,b=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||b===null||(g=dl(a,d),g!=null&&f.unshift(Gl(a,g,b)),g=dl(a,o),g!=null&&f.push(Gl(a,g,b))),a.tag===3)return f;a=a.return}return[]}function Lr(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function ky(a,o,d,f,g){for(var b=o._reactName,S=[];d!==null&&d!==f;){var R=d,z=R.alternate,J=R.stateNode;if(R=R.tag,z!==null&&z===f)break;R!==5&&R!==26&&R!==27||J===null||(z=J,g?(J=dl(d,b),J!=null&&S.unshift(Gl(d,J,z))):g||(J=dl(d,b),J!=null&&S.push(Gl(d,J,z)))),d=d.return}S.length!==0&&a.push({event:o,listeners:S})}var fS=/\r\n?/g,mS=/\u0000|\uFFFD/g;function My(a){return(typeof a=="string"?a:""+a).replace(fS,`
`).replace(mS,"")}function Ly(a,o){return o=My(o),My(a)===o}function Zc(){}function mt(a,o,d,f,g,b){switch(d){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||rr(a,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&rr(a,""+f);break;case"className":sc(a,"class",f);break;case"tabIndex":sc(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":sc(a,d,f);break;case"style":Pg(a,f,b);break;case"data":if(o!=="object"){sc(a,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||d!=="href")){a.removeAttribute(d);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(d);break}f=ic(""+f),a.setAttribute(d,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(d==="formAction"?(o!=="input"&&mt(a,o,"name",g.name,g,null),mt(a,o,"formEncType",g.formEncType,g,null),mt(a,o,"formMethod",g.formMethod,g,null),mt(a,o,"formTarget",g.formTarget,g,null)):(mt(a,o,"encType",g.encType,g,null),mt(a,o,"method",g.method,g,null),mt(a,o,"target",g.target,g,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(d);break}f=ic(""+f),a.setAttribute(d,f);break;case"onClick":f!=null&&(a.onclick=Zc);break;case"onScroll":f!=null&&Je("scroll",a);break;case"onScrollEnd":f!=null&&Je("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(s(61));if(d=f.__html,d!=null){if(g.children!=null)throw Error(s(60));a.innerHTML=d}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}d=ic(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(d,""+f):a.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(d,""):a.removeAttribute(d);break;case"capture":case"download":f===!0?a.setAttribute(d,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(d,f):a.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(d,f):a.removeAttribute(d);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(d):a.setAttribute(d,f);break;case"popover":Je("beforetoggle",a),Je("toggle",a),tc(a,"popover",f);break;case"xlinkActuate":Zn(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Zn(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Zn(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Zn(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Zn(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Zn(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Zn(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Zn(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Zn(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":tc(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=VN.get(d)||d,tc(a,d,f))}}function Rf(a,o,d,f,g,b){switch(d){case"style":Pg(a,f,b);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(s(61));if(d=f.__html,d!=null){if(g.children!=null)throw Error(s(60));a.innerHTML=d}}break;case"children":typeof f=="string"?rr(a,f):(typeof f=="number"||typeof f=="bigint")&&rr(a,""+f);break;case"onScroll":f!=null&&Je("scroll",a);break;case"onScrollEnd":f!=null&&Je("scrollend",a);break;case"onClick":f!=null&&(a.onclick=Zc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Sg.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(g=d.endsWith("Capture"),o=d.slice(2,g?d.length-7:void 0),b=a[jt]||null,b=b!=null?b[d]:null,typeof b=="function"&&a.removeEventListener(o,b,g),typeof f=="function")){typeof b!="function"&&b!==null&&(d in a?a[d]=null:a.hasAttribute(d)&&a.removeAttribute(d)),a.addEventListener(o,f,g);break e}d in a?a[d]=f:f===!0?a.setAttribute(d,""):tc(a,d,f)}}}function ds(a,o,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Je("error",a),Je("load",a);var f=!1,g=!1,b;for(b in d)if(d.hasOwnProperty(b)){var S=d[b];if(S!=null)switch(b){case"src":f=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,o));default:mt(a,o,b,S,d,null)}}g&&mt(a,o,"srcSet",d.srcSet,d,null),f&&mt(a,o,"src",d.src,d,null);return;case"input":Je("invalid",a);var R=b=S=g=null,z=null,J=null;for(f in d)if(d.hasOwnProperty(f)){var he=d[f];if(he!=null)switch(f){case"name":g=he;break;case"type":S=he;break;case"checked":z=he;break;case"defaultChecked":J=he;break;case"value":b=he;break;case"defaultValue":R=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(s(137,o));break;default:mt(a,o,f,he,d,null)}}kg(a,b,R,z,J,S,g,!1),nc(a);return;case"select":Je("invalid",a),f=S=b=null;for(g in d)if(d.hasOwnProperty(g)&&(R=d[g],R!=null))switch(g){case"value":b=R;break;case"defaultValue":S=R;break;case"multiple":f=R;default:mt(a,o,g,R,d,null)}o=b,d=S,a.multiple=!!f,o!=null?ir(a,!!f,o,!1):d!=null&&ir(a,!!f,d,!0);return;case"textarea":Je("invalid",a),b=g=f=null;for(S in d)if(d.hasOwnProperty(S)&&(R=d[S],R!=null))switch(S){case"value":f=R;break;case"defaultValue":g=R;break;case"children":b=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(s(91));break;default:mt(a,o,S,R,d,null)}Lg(a,f,g,b),nc(a);return;case"option":for(z in d)if(d.hasOwnProperty(z)&&(f=d[z],f!=null))switch(z){case"selected":a.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:mt(a,o,z,f,d,null)}return;case"dialog":Je("beforetoggle",a),Je("toggle",a),Je("cancel",a),Je("close",a);break;case"iframe":case"object":Je("load",a);break;case"video":case"audio":for(f=0;f<ql.length;f++)Je(ql[f],a);break;case"image":Je("error",a),Je("load",a);break;case"details":Je("toggle",a);break;case"embed":case"source":case"link":Je("error",a),Je("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in d)if(d.hasOwnProperty(J)&&(f=d[J],f!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,o));default:mt(a,o,J,f,d,null)}return;default:if(Gu(o)){for(he in d)d.hasOwnProperty(he)&&(f=d[he],f!==void 0&&Rf(a,o,he,f,d,void 0));return}}for(R in d)d.hasOwnProperty(R)&&(f=d[R],f!=null&&mt(a,o,R,f,d,null))}function pS(a,o,d,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,b=null,S=null,R=null,z=null,J=null,he=null;for(ne in d){var ge=d[ne];if(d.hasOwnProperty(ne)&&ge!=null)switch(ne){case"checked":break;case"value":break;case"defaultValue":z=ge;default:f.hasOwnProperty(ne)||mt(a,o,ne,null,f,ge)}}for(var se in f){var ne=f[se];if(ge=d[se],f.hasOwnProperty(se)&&(ne!=null||ge!=null))switch(se){case"type":b=ne;break;case"name":g=ne;break;case"checked":J=ne;break;case"defaultChecked":he=ne;break;case"value":S=ne;break;case"defaultValue":R=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(s(137,o));break;default:ne!==ge&&mt(a,o,se,ne,f,ge)}}Vu(a,S,R,z,J,he,b,g);return;case"select":ne=S=R=se=null;for(b in d)if(z=d[b],d.hasOwnProperty(b)&&z!=null)switch(b){case"value":break;case"multiple":ne=z;default:f.hasOwnProperty(b)||mt(a,o,b,null,f,z)}for(g in f)if(b=f[g],z=d[g],f.hasOwnProperty(g)&&(b!=null||z!=null))switch(g){case"value":se=b;break;case"defaultValue":R=b;break;case"multiple":S=b;default:b!==z&&mt(a,o,g,b,f,z)}o=R,d=S,f=ne,se!=null?ir(a,!!d,se,!1):!!f!=!!d&&(o!=null?ir(a,!!d,o,!0):ir(a,!!d,d?[]:"",!1));return;case"textarea":ne=se=null;for(R in d)if(g=d[R],d.hasOwnProperty(R)&&g!=null&&!f.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:mt(a,o,R,null,f,g)}for(S in f)if(g=f[S],b=d[S],f.hasOwnProperty(S)&&(g!=null||b!=null))switch(S){case"value":se=g;break;case"defaultValue":ne=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(s(91));break;default:g!==b&&mt(a,o,S,g,f,b)}Mg(a,se,ne);return;case"option":for(var Be in d)if(se=d[Be],d.hasOwnProperty(Be)&&se!=null&&!f.hasOwnProperty(Be))switch(Be){case"selected":a.selected=!1;break;default:mt(a,o,Be,null,f,se)}for(z in f)if(se=f[z],ne=d[z],f.hasOwnProperty(z)&&se!==ne&&(se!=null||ne!=null))switch(z){case"selected":a.selected=se&&typeof se!="function"&&typeof se!="symbol";break;default:mt(a,o,z,se,f,ne)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Le in d)se=d[Le],d.hasOwnProperty(Le)&&se!=null&&!f.hasOwnProperty(Le)&&mt(a,o,Le,null,f,se);for(J in f)if(se=f[J],ne=d[J],f.hasOwnProperty(J)&&se!==ne&&(se!=null||ne!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(s(137,o));break;default:mt(a,o,J,se,f,ne)}return;default:if(Gu(o)){for(var pt in d)se=d[pt],d.hasOwnProperty(pt)&&se!==void 0&&!f.hasOwnProperty(pt)&&Rf(a,o,pt,void 0,f,se);for(he in f)se=f[he],ne=d[he],!f.hasOwnProperty(he)||se===ne||se===void 0&&ne===void 0||Rf(a,o,he,se,f,ne);return}}for(var Y in d)se=d[Y],d.hasOwnProperty(Y)&&se!=null&&!f.hasOwnProperty(Y)&&mt(a,o,Y,null,f,se);for(ge in f)se=f[ge],ne=d[ge],!f.hasOwnProperty(ge)||se===ne||se==null&&ne==null||mt(a,o,ge,se,f,ne)}var kf=null,Mf=null;function Kc(a){return a.nodeType===9?a:a.ownerDocument}function Oy(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Py(a,o){if(a===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&o==="foreignObject"?0:a}function Lf(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Of=null;function gS(){var a=window.event;return a&&a.type==="popstate"?a===Of?!1:(Of=a,!0):(Of=null,!1)}var Iy=typeof setTimeout=="function"?setTimeout:void 0,xS=typeof clearTimeout=="function"?clearTimeout:void 0,By=typeof Promise=="function"?Promise:void 0,yS=typeof queueMicrotask=="function"?queueMicrotask:typeof By<"u"?function(a){return By.resolve(null).then(a).catch(bS)}:Iy;function bS(a){setTimeout(function(){throw a})}function Ba(a){return a==="head"}function Hy(a,o){var d=o,f=0,g=0;do{var b=d.nextSibling;if(a.removeChild(d),b&&b.nodeType===8)if(d=b.data,d==="/$"){if(0<f&&8>f){d=f;var S=a.ownerDocument;if(d&1&&Yl(S.documentElement),d&2&&Yl(S.body),d&4)for(d=S.head,Yl(d),S=d.firstChild;S;){var R=S.nextSibling,z=S.nodeName;S[bn]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&S.rel.toLowerCase()==="stylesheet"||d.removeChild(S),S=R}}if(g===0){a.removeChild(b),to(o);return}g--}else d==="$"||d==="$?"||d==="$!"?g++:f=d.charCodeAt(0)-48;else f=0;d=b}while(d);to(o)}function Pf(a){var o=a.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var d=o;switch(o=o.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":Pf(d),ms(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}a.removeChild(d)}}function vS(a,o,d,f){for(;a.nodeType===1;){var g=d;if(a.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[bn])switch(o){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(b=a.getAttribute("rel"),b==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(b!==g.rel||a.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||a.getAttribute("title")!==(g.title==null?null:g.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(b=a.getAttribute("src"),(b!==(g.src==null?null:g.src)||a.getAttribute("type")!==(g.type==null?null:g.type)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&b&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(o==="input"&&a.type==="hidden"){var b=g.name==null?null:""+g.name;if(g.type==="hidden"&&a.getAttribute("name")===b)return a}else return a;if(a=Nn(a.nextSibling),a===null)break}return null}function wS(a,o,d){if(o==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!d||(a=Nn(a.nextSibling),a===null))return null;return a}function If(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function AS(a,o){var d=a.ownerDocument;if(a.data!=="$?"||d.readyState==="complete")o();else{var f=function(){o(),d.removeEventListener("DOMContentLoaded",f)};d.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function Nn(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return a}var Bf=null;function zy(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(o===0)return a;o--}else d==="/$"&&o++}a=a.previousSibling}return null}function Fy(a,o,d){switch(o=Kc(d),a){case"html":if(a=o.documentElement,!a)throw Error(s(452));return a;case"head":if(a=o.head,!a)throw Error(s(453));return a;case"body":if(a=o.body,!a)throw Error(s(454));return a;default:throw Error(s(451))}}function Yl(a){for(var o=a.attributes;o.length;)a.removeAttributeNode(o[0]);ms(a)}var hn=new Map,Uy=new Set;function Jc(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var ua=q.d;q.d={f:NS,r:jS,D:SS,C:ES,L:_S,m:CS,X:DS,S:TS,M:RS};function NS(){var a=ua.f(),o=Vc();return a||o}function jS(a){var o=Mn(a);o!==null&&o.tag===5&&o.type==="form"?o0(o):ua.r(a)}var Or=typeof document>"u"?null:document;function $y(a,o,d){var f=Or;if(f&&typeof o=="string"&&o){var g=an(o);g='link[rel="'+a+'"][href="'+g+'"]',typeof d=="string"&&(g+='[crossorigin="'+d+'"]'),Uy.has(g)||(Uy.add(g),a={rel:a,crossOrigin:d,href:o},f.querySelector(g)===null&&(o=f.createElement("link"),ds(o,"link",a),Jt(o),f.head.appendChild(o)))}}function SS(a){ua.D(a),$y("dns-prefetch",a,null)}function ES(a,o){ua.C(a,o),$y("preconnect",a,o)}function _S(a,o,d){ua.L(a,o,d);var f=Or;if(f&&a&&o){var g='link[rel="preload"][as="'+an(o)+'"]';o==="image"&&d&&d.imageSrcSet?(g+='[imagesrcset="'+an(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(g+='[imagesizes="'+an(d.imageSizes)+'"]')):g+='[href="'+an(a)+'"]';var b=g;switch(o){case"style":b=Pr(a);break;case"script":b=Ir(a)}hn.has(b)||(a=p({rel:"preload",href:o==="image"&&d&&d.imageSrcSet?void 0:a,as:o},d),hn.set(b,a),f.querySelector(g)!==null||o==="style"&&f.querySelector(Wl(b))||o==="script"&&f.querySelector(Xl(b))||(o=f.createElement("link"),ds(o,"link",a),Jt(o),f.head.appendChild(o)))}}function CS(a,o){ua.m(a,o);var d=Or;if(d&&a){var f=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+an(f)+'"][href="'+an(a)+'"]',b=g;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Ir(a)}if(!hn.has(b)&&(a=p({rel:"modulepreload",href:a},o),hn.set(b,a),d.querySelector(g)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(Xl(b)))return}f=d.createElement("link"),ds(f,"link",a),Jt(f),d.head.appendChild(f)}}}function TS(a,o,d){ua.S(a,o,d);var f=Or;if(f&&a){var g=sr(f).hoistableStyles,b=Pr(a);o=o||"default";var S=g.get(b);if(!S){var R={loading:0,preload:null};if(S=f.querySelector(Wl(b)))R.loading=5;else{a=p({rel:"stylesheet",href:a,"data-precedence":o},d),(d=hn.get(b))&&Hf(a,d);var z=S=f.createElement("link");Jt(z),ds(z,"link",a),z._p=new Promise(function(J,he){z.onload=J,z.onerror=he}),z.addEventListener("load",function(){R.loading|=1}),z.addEventListener("error",function(){R.loading|=2}),R.loading|=4,ed(S,o,f)}S={type:"stylesheet",instance:S,count:1,state:R},g.set(b,S)}}}function DS(a,o){ua.X(a,o);var d=Or;if(d&&a){var f=sr(d).hoistableScripts,g=Ir(a),b=f.get(g);b||(b=d.querySelector(Xl(g)),b||(a=p({src:a,async:!0},o),(o=hn.get(g))&&zf(a,o),b=d.createElement("script"),Jt(b),ds(b,"link",a),d.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(g,b))}}function RS(a,o){ua.M(a,o);var d=Or;if(d&&a){var f=sr(d).hoistableScripts,g=Ir(a),b=f.get(g);b||(b=d.querySelector(Xl(g)),b||(a=p({src:a,async:!0,type:"module"},o),(o=hn.get(g))&&zf(a,o),b=d.createElement("script"),Jt(b),ds(b,"link",a),d.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(g,b))}}function Vy(a,o,d,f){var g=(g=pe.current)?Jc(g):null;if(!g)throw Error(s(446));switch(a){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(o=Pr(d.href),d=sr(g).hoistableStyles,f=d.get(o),f||(f={type:"style",instance:null,count:0,state:null},d.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){a=Pr(d.href);var b=sr(g).hoistableStyles,S=b.get(a);if(S||(g=g.ownerDocument||g,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(a,S),(b=g.querySelector(Wl(a)))&&!b._p&&(S.instance=b,S.state.loading=5),hn.has(a)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},hn.set(a,d),b||kS(g,a,d,S.state))),o&&f===null)throw Error(s(528,""));return S}if(o&&f!==null)throw Error(s(529,""));return null;case"script":return o=d.async,d=d.src,typeof d=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Ir(d),d=sr(g).hoistableScripts,f=d.get(o),f||(f={type:"script",instance:null,count:0,state:null},d.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,a))}}function Pr(a){return'href="'+an(a)+'"'}function Wl(a){return'link[rel="stylesheet"]['+a+"]"}function qy(a){return p({},a,{"data-precedence":a.precedence,precedence:null})}function kS(a,o,d,f){a.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=a.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),ds(o,"link",d),Jt(o),a.head.appendChild(o))}function Ir(a){return'[src="'+an(a)+'"]'}function Xl(a){return"script[async]"+a}function Gy(a,o,d){if(o.count++,o.instance===null)switch(o.type){case"style":var f=a.querySelector('style[data-href~="'+an(d.href)+'"]');if(f)return o.instance=f,Jt(f),f;var g=p({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),Jt(f),ds(f,"style",g),ed(f,d.precedence,a),o.instance=f;case"stylesheet":g=Pr(d.href);var b=a.querySelector(Wl(g));if(b)return o.state.loading|=4,o.instance=b,Jt(b),b;f=qy(d),(g=hn.get(g))&&Hf(f,g),b=(a.ownerDocument||a).createElement("link"),Jt(b);var S=b;return S._p=new Promise(function(R,z){S.onload=R,S.onerror=z}),ds(b,"link",f),o.state.loading|=4,ed(b,d.precedence,a),o.instance=b;case"script":return b=Ir(d.src),(g=a.querySelector(Xl(b)))?(o.instance=g,Jt(g),g):(f=d,(g=hn.get(b))&&(f=p({},d),zf(f,g)),a=a.ownerDocument||a,g=a.createElement("script"),Jt(g),ds(g,"link",f),a.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(s(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,ed(f,d.precedence,a));return o.instance}function ed(a,o,d){for(var f=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=f.length?f[f.length-1]:null,b=g,S=0;S<f.length;S++){var R=f[S];if(R.dataset.precedence===o)b=R;else if(b!==g)break}b?b.parentNode.insertBefore(a,b.nextSibling):(o=d.nodeType===9?d.head:d,o.insertBefore(a,o.firstChild))}function Hf(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.title==null&&(a.title=o.title)}function zf(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.integrity==null&&(a.integrity=o.integrity)}var td=null;function Yy(a,o,d){if(td===null){var f=new Map,g=td=new Map;g.set(d,f)}else g=td,f=g.get(d),f||(f=new Map,g.set(d,f));if(f.has(a))return f;for(f.set(a,null),d=d.getElementsByTagName(a),g=0;g<d.length;g++){var b=d[g];if(!(b[bn]||b[yt]||a==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var S=b.getAttribute(o)||"";S=a+S;var R=f.get(S);R?R.push(b):f.set(S,[b])}}return f}function Wy(a,o,d){a=a.ownerDocument||a,a.head.insertBefore(d,o==="title"?a.querySelector("head > title"):null)}function MS(a,o,d){if(d===1||o.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return a=o.disabled,typeof o.precedence=="string"&&a==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Xy(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var Ql=null;function LS(){}function OS(a,o,d){if(Ql===null)throw Error(s(475));var f=Ql;if(o.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Pr(d.href),b=a.querySelector(Wl(g));if(b){a=b._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(f.count++,f=sd.bind(f),a.then(f,f)),o.state.loading|=4,o.instance=b,Jt(b);return}b=a.ownerDocument||a,d=qy(d),(g=hn.get(g))&&Hf(d,g),b=b.createElement("link"),Jt(b);var S=b;S._p=new Promise(function(R,z){S.onload=R,S.onerror=z}),ds(b,"link",d),o.instance=b}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(f.count++,o=sd.bind(f),a.addEventListener("load",o),a.addEventListener("error",o))}}function PS(){if(Ql===null)throw Error(s(475));var a=Ql;return a.stylesheets&&a.count===0&&Ff(a,a.stylesheets),0<a.count?function(o){var d=setTimeout(function(){if(a.stylesheets&&Ff(a,a.stylesheets),a.unsuspend){var f=a.unsuspend;a.unsuspend=null,f()}},6e4);return a.unsuspend=o,function(){a.unsuspend=null,clearTimeout(d)}}:null}function sd(){if(this.count--,this.count===0){if(this.stylesheets)Ff(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var nd=null;function Ff(a,o){a.stylesheets=null,a.unsuspend!==null&&(a.count++,nd=new Map,o.forEach(IS,a),nd=null,sd.call(a))}function IS(a,o){if(!(o.state.loading&4)){var d=nd.get(a);if(d)var f=d.get(null);else{d=new Map,nd.set(a,d);for(var g=a.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<g.length;b++){var S=g[b];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(d.set(S.dataset.precedence,S),f=S)}f&&d.set(null,f)}g=o.instance,S=g.getAttribute("data-precedence"),b=d.get(S)||f,b===f&&d.set(null,g),d.set(S,g),this.count++,f=sd.bind(this),g.addEventListener("load",f),g.addEventListener("error",f),b?b.parentNode.insertBefore(g,b.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(g,a.firstChild)),o.state.loading|=4}}var Zl={$$typeof:C,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function BS(a,o,d,f,g,b,S,R){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=er(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=er(0),this.hiddenUpdates=er(null),this.identifierPrefix=f,this.onUncaughtError=g,this.onCaughtError=b,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function Qy(a,o,d,f,g,b,S,R,z,J,he,ge){return a=new BS(a,o,d,S,R,z,J,ge),o=1,b===!0&&(o|=24),b=Vs(3,null,null,o),a.current=b,b.stateNode=a,o=wh(),o.refCount++,a.pooledCache=o,o.refCount++,b.memoizedState={element:f,isDehydrated:d,cache:o},Sh(b),a}function Zy(a){return a?(a=mr,a):mr}function Ky(a,o,d,f,g,b){g=Zy(g),f.context===null?f.context=g:f.pendingContext=g,f=Sa(o),f.payload={element:d},b=b===void 0?null:b,b!==null&&(f.callback=b),d=Ea(a,f,o),d!==null&&(Xs(d,a,o),_l(d,a,o))}function Jy(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<o?d:o}}function Uf(a,o){Jy(a,o),(a=a.alternate)&&Jy(a,o)}function eb(a){if(a.tag===13){var o=fr(a,67108864);o!==null&&Xs(o,a,67108864),Uf(a,67108864)}}var ad=!0;function HS(a,o,d,f){var g=L.T;L.T=null;var b=q.p;try{q.p=2,$f(a,o,d,f)}finally{q.p=b,L.T=g}}function zS(a,o,d,f){var g=L.T;L.T=null;var b=q.p;try{q.p=8,$f(a,o,d,f)}finally{q.p=b,L.T=g}}function $f(a,o,d,f){if(ad){var g=Vf(f);if(g===null)Df(a,o,f,id,d),sb(a,f);else if(US(g,a,o,d,f))f.stopPropagation();else if(sb(a,f),o&4&&-1<FS.indexOf(a)){for(;g!==null;){var b=Mn(g);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var S=ws(b.pendingLanes);if(S!==0){var R=b;for(R.pendingLanes|=2,R.entangledLanes|=2;S;){var z=1<<31-ct(S);R.entanglements[1]|=z,S&=~z}Bn(b),(dt&6)===0&&(Uc=Ee()+500,Vl(0))}}break;case 13:R=fr(b,2),R!==null&&Xs(R,b,2),Vc(),Uf(b,2)}if(b=Vf(f),b===null&&Df(a,o,f,id,d),b===g)break;g=b}g!==null&&f.stopPropagation()}else Df(a,o,f,null,d)}}function Vf(a){return a=Wu(a),qf(a)}var id=null;function qf(a){if(id=null,a=vn(a),a!==null){var o=l(a);if(o===null)a=null;else{var d=o.tag;if(d===13){if(a=c(o),a!==null)return a;a=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return id=a,null}function tb(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xe()){case te:return 2;case Ne:return 8;case Ie:case Ze:return 32;case Nt:return 268435456;default:return 32}default:return 32}}var Gf=!1,Ha=null,za=null,Fa=null,Kl=new Map,Jl=new Map,Ua=[],FS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function sb(a,o){switch(a){case"focusin":case"focusout":Ha=null;break;case"dragenter":case"dragleave":za=null;break;case"mouseover":case"mouseout":Fa=null;break;case"pointerover":case"pointerout":Kl.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jl.delete(o.pointerId)}}function eo(a,o,d,f,g,b){return a===null||a.nativeEvent!==b?(a={blockedOn:o,domEventName:d,eventSystemFlags:f,nativeEvent:b,targetContainers:[g]},o!==null&&(o=Mn(o),o!==null&&eb(o)),a):(a.eventSystemFlags|=f,o=a.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),a)}function US(a,o,d,f,g){switch(o){case"focusin":return Ha=eo(Ha,a,o,d,f,g),!0;case"dragenter":return za=eo(za,a,o,d,f,g),!0;case"mouseover":return Fa=eo(Fa,a,o,d,f,g),!0;case"pointerover":var b=g.pointerId;return Kl.set(b,eo(Kl.get(b)||null,a,o,d,f,g)),!0;case"gotpointercapture":return b=g.pointerId,Jl.set(b,eo(Jl.get(b)||null,a,o,d,f,g)),!0}return!1}function nb(a){var o=vn(a.target);if(o!==null){var d=l(o);if(d!==null){if(o=d.tag,o===13){if(o=c(d),o!==null){a.blockedOn=o,Ge(a.priority,function(){if(d.tag===13){var f=Ws();f=Q(f);var g=fr(d,f);g!==null&&Xs(g,d,f),Uf(d,f)}});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function rd(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var d=Vf(a.nativeEvent);if(d===null){d=a.nativeEvent;var f=new d.constructor(d.type,d);Yu=f,d.target.dispatchEvent(f),Yu=null}else return o=Mn(d),o!==null&&eb(o),a.blockedOn=d,!1;o.shift()}return!0}function ab(a,o,d){rd(a)&&d.delete(o)}function $S(){Gf=!1,Ha!==null&&rd(Ha)&&(Ha=null),za!==null&&rd(za)&&(za=null),Fa!==null&&rd(Fa)&&(Fa=null),Kl.forEach(ab),Jl.forEach(ab)}function ld(a,o){a.blockedOn===o&&(a.blockedOn=null,Gf||(Gf=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,$S)))}var od=null;function ib(a){od!==a&&(od=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){od===a&&(od=null);for(var o=0;o<a.length;o+=3){var d=a[o],f=a[o+1],g=a[o+2];if(typeof f!="function"){if(qf(f||d)===null)continue;break}var b=Mn(d);b!==null&&(a.splice(o,3),o-=3,Vh(b,{pending:!0,data:g,method:d.method,action:f},f,g))}}))}function to(a){function o(z){return ld(z,a)}Ha!==null&&ld(Ha,a),za!==null&&ld(za,a),Fa!==null&&ld(Fa,a),Kl.forEach(o),Jl.forEach(o);for(var d=0;d<Ua.length;d++){var f=Ua[d];f.blockedOn===a&&(f.blockedOn=null)}for(;0<Ua.length&&(d=Ua[0],d.blockedOn===null);)nb(d),d.blockedOn===null&&Ua.shift();if(d=(a.ownerDocument||a).$$reactFormReplay,d!=null)for(f=0;f<d.length;f+=3){var g=d[f],b=d[f+1],S=g[jt]||null;if(typeof b=="function")S||ib(d);else if(S){var R=null;if(b&&b.hasAttribute("formAction")){if(g=b,S=b[jt]||null)R=S.formAction;else if(qf(g)!==null)continue}else R=S.action;typeof R=="function"?d[f+1]=R:(d.splice(f,3),f-=3),ib(d)}}}function Yf(a){this._internalRoot=a}cd.prototype.render=Yf.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(s(409));var d=o.current,f=Ws();Ky(d,f,a,o,null,null)},cd.prototype.unmount=Yf.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;Ky(a.current,2,null,a,null,null),Vc(),o[sn]=null}};function cd(a){this._internalRoot=a}cd.prototype.unstable_scheduleHydration=function(a){if(a){var o=Ce();a={blockedOn:null,target:a,priority:o};for(var d=0;d<Ua.length&&o!==0&&o<Ua[d].priority;d++);Ua.splice(d,0,a),d===0&&nb(a)}};var rb=e.version;if(rb!=="19.1.1")throw Error(s(527,rb,"19.1.1"));q.findDOMNode=function(a){var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(s(188)):(a=Object.keys(a).join(","),Error(s(268,a)));return a=h(o),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var VS={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dd.isDisabled&&dd.supportsFiber)try{Ae=dd.inject(VS),je=dd}catch{}}return no.createRoot=function(a,o){if(!i(a))throw Error(s(299));var d=!1,f="",g=A0,b=N0,S=j0,R=null;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(R=o.unstable_transitionCallbacks)),o=Qy(a,1,!1,null,null,d,f,g,b,S,R,null),a[sn]=o.current,Tf(a),new Yf(o)},no.hydrateRoot=function(a,o,d){if(!i(a))throw Error(s(299));var f=!1,g="",b=A0,S=N0,R=j0,z=null,J=null;return d!=null&&(d.unstable_strictMode===!0&&(f=!0),d.identifierPrefix!==void 0&&(g=d.identifierPrefix),d.onUncaughtError!==void 0&&(b=d.onUncaughtError),d.onCaughtError!==void 0&&(S=d.onCaughtError),d.onRecoverableError!==void 0&&(R=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(z=d.unstable_transitionCallbacks),d.formState!==void 0&&(J=d.formState)),o=Qy(a,1,!0,o,d??null,f,g,b,S,R,z,J),o.context=Zy(null),d=o.current,f=Ws(),f=Q(f),g=Sa(f),g.callback=null,Ea(d,g,f),d=f,o.current.lanes=d,Fs(o,d),Bn(o),a[sn]=o.current,Tf(a),new cd(o)},no.version="19.1.1",no}var yb;function eE(){if(yb)return Zf.exports;yb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Zf.exports=JS(),Zf.exports}var tE=eE();/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var bb="popstate";function sE(n={}){function e(s,i){let{pathname:l,search:c,hash:u}=s.location;return Hm("",{pathname:l,search:c,hash:u},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(s,i){return typeof i=="string"?i:_o(i)}return aE(e,t,null,n)}function Dt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function En(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function nE(){return Math.random().toString(36).substring(2,10)}function vb(n,e){return{usr:n.state,key:n.key,idx:e}}function Hm(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?sl(e):e,state:t,key:e&&e.key||s||nE()}}function _o({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function sl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function aE(n,e,t,s={}){let{window:i=document.defaultView,v5Compat:l=!1}=s,c=i.history,u="POP",h=null,m=p();m==null&&(m=0,c.replaceState({...c.state,idx:m},""));function p(){return(c.state||{idx:null}).idx}function x(){u="POP";let N=p(),j=N==null?null:N-m;m=N,h&&h({action:u,location:A.location,delta:j})}function y(N,j){u="PUSH";let _=Hm(A.location,N,j);m=p()+1;let C=vb(_,m),k=A.createHref(_);try{c.pushState(C,"",k)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;i.location.assign(k)}l&&h&&h({action:u,location:A.location,delta:1})}function v(N,j){u="REPLACE";let _=Hm(A.location,N,j);m=p();let C=vb(_,m),k=A.createHref(_);c.replaceState(C,"",k),l&&h&&h({action:u,location:A.location,delta:0})}function w(N){return iE(N)}let A={get action(){return u},get location(){return n(i,c)},listen(N){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(bb,x),h=N,()=>{i.removeEventListener(bb,x),h=null}},createHref(N){return e(i,N)},createURL:w,encodeLocation(N){let j=w(N);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:y,replace:v,go(N){return c.go(N)}};return A}function iE(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Dt(t,"No window.location.(origin|href) available to create URL");let s=typeof n=="string"?n:_o(n);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function vw(n,e,t="/"){return rE(n,e,t,!1)}function rE(n,e,t,s){let i=typeof e=="string"?sl(e):e,l=xa(i.pathname||"/",t);if(l==null)return null;let c=ww(n);lE(c);let u=null;for(let h=0;u==null&&h<c.length;++h){let m=yE(l);u=gE(c[h],m,s)}return u}function ww(n,e=[],t=[],s="",i=!1){let l=(c,u,h=i,m)=>{let p={relativePath:m===void 0?c.path||"":m,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(s)&&h)return;Dt(p.relativePath.startsWith(s),`Absolute route path "${p.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(s.length)}let x=ga([s,p.relativePath]),y=t.concat(p);c.children&&c.children.length>0&&(Dt(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),ww(c.children,e,y,x,h)),!(c.path==null&&!c.index)&&e.push({path:x,score:mE(x,c.index),routesMeta:y})};return n.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))l(c,u);else for(let h of Aw(c.path))l(c,u,!0,h)}),e}function Aw(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,i=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return i?[l,""]:[l];let c=Aw(s.join("/")),u=[];return u.push(...c.map(h=>h===""?l:[l,h].join("/"))),i&&u.push(...c),u.map(h=>n.startsWith("/")&&h===""?"/":h)}function lE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:pE(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var oE=/^:[\w-]+$/,cE=3,dE=2,uE=1,hE=10,fE=-2,wb=n=>n==="*";function mE(n,e){let t=n.split("/"),s=t.length;return t.some(wb)&&(s+=fE),e&&(s+=dE),t.filter(i=>!wb(i)).reduce((i,l)=>i+(oE.test(l)?cE:l===""?uE:hE),s)}function pE(n,e){return n.length===e.length&&n.slice(0,-1).every((s,i)=>s===e[i])?n[n.length-1]-e[e.length-1]:0}function gE(n,e,t=!1){let{routesMeta:s}=n,i={},l="/",c=[];for(let u=0;u<s.length;++u){let h=s[u],m=u===s.length-1,p=l==="/"?e:e.slice(l.length)||"/",x=zd({path:h.relativePath,caseSensitive:h.caseSensitive,end:m},p),y=h.route;if(!x&&m&&t&&!s[s.length-1].route.index&&(x=zd({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!x)return null;Object.assign(i,x.params),c.push({params:i,pathname:ga([l,x.pathname]),pathnameBase:AE(ga([l,x.pathnameBase])),route:y}),x.pathnameBase!=="/"&&(l=ga([l,x.pathnameBase]))}return c}function zd(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=xE(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let l=i[0],c=l.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:s.reduce((m,{paramName:p,isOptional:x},y)=>{if(p==="*"){let w=u[y]||"";c=l.slice(0,l.length-w.length).replace(/(.)\/+$/,"$1")}const v=u[y];return x&&!v?m[p]=void 0:m[p]=(v||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:c,pattern:n}}function xE(n,e=!1,t=!0){En(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,h)=>(s.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(s.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function yE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return En(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function xa(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}function bE(n,e="/"){let{pathname:t,search:s="",hash:i=""}=typeof n=="string"?sl(n):n;return{pathname:t?t.startsWith("/")?t:vE(t,e):e,search:NE(s),hash:jE(i)}}function vE(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function tm(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function vp(n){let e=wE(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function wp(n,e,t,s=!1){let i;typeof n=="string"?i=sl(n):(i={...n},Dt(!i.pathname||!i.pathname.includes("?"),tm("?","pathname","search",i)),Dt(!i.pathname||!i.pathname.includes("#"),tm("#","pathname","hash",i)),Dt(!i.search||!i.search.includes("#"),tm("#","search","hash",i)));let l=n===""||i.pathname==="",c=l?"/":i.pathname,u;if(c==null)u=t;else{let x=e.length-1;if(!s&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),x-=1;i.pathname=y.join("/")}u=x>=0?e[x]:"/"}let h=bE(i,u),m=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(m||p)&&(h.pathname+="/"),h}var ga=n=>n.join("/").replace(/\/\/+/g,"/"),AE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),NE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,jE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function SE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var Nw=["POST","PUT","PATCH","DELETE"];new Set(Nw);var EE=["GET",...Nw];new Set(EE);var nl=E.createContext(null);nl.displayName="DataRouter";var uu=E.createContext(null);uu.displayName="DataRouterState";E.createContext(!1);var jw=E.createContext({isTransitioning:!1});jw.displayName="ViewTransition";var _E=E.createContext(new Map);_E.displayName="Fetchers";var CE=E.createContext(null);CE.displayName="Await";var Tn=E.createContext(null);Tn.displayName="Navigation";var Bo=E.createContext(null);Bo.displayName="Location";var Dn=E.createContext({outlet:null,matches:[],isDataRoute:!1});Dn.displayName="Route";var Ap=E.createContext(null);Ap.displayName="RouteError";function TE(n,{relative:e}={}){Dt(al(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=E.useContext(Tn),{hash:i,pathname:l,search:c}=Ho(n,{relative:e}),u=l;return t!=="/"&&(u=l==="/"?t:ga([t,l])),s.createHref({pathname:u,search:c,hash:i})}function al(){return E.useContext(Bo)!=null}function ba(){return Dt(al(),"useLocation() may be used only in the context of a <Router> component."),E.useContext(Bo).location}var Sw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ew(n){E.useContext(Tn).static||E.useLayoutEffect(n)}function il(){let{isDataRoute:n}=E.useContext(Dn);return n?VE():DE()}function DE(){Dt(al(),"useNavigate() may be used only in the context of a <Router> component.");let n=E.useContext(nl),{basename:e,navigator:t}=E.useContext(Tn),{matches:s}=E.useContext(Dn),{pathname:i}=ba(),l=JSON.stringify(vp(s)),c=E.useRef(!1);return Ew(()=>{c.current=!0}),E.useCallback((h,m={})=>{if(En(c.current,Sw),!c.current)return;if(typeof h=="number"){t.go(h);return}let p=wp(h,JSON.parse(l),i,m.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:ga([e,p.pathname])),(m.replace?t.replace:t.push)(p,m.state,m)},[e,t,l,i,n])}var RE=E.createContext(null);function kE(n){let e=E.useContext(Dn).outlet;return e&&E.createElement(RE.Provider,{value:n},e)}function Ho(n,{relative:e}={}){let{matches:t}=E.useContext(Dn),{pathname:s}=ba(),i=JSON.stringify(vp(t));return E.useMemo(()=>wp(n,JSON.parse(i),s,e==="path"),[n,i,s,e])}function ME(n,e){return _w(n,e)}function _w(n,e,t,s,i){Dt(al(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=E.useContext(Tn),{matches:c}=E.useContext(Dn),u=c[c.length-1],h=u?u.params:{},m=u?u.pathname:"/",p=u?u.pathnameBase:"/",x=u&&u.route;{let _=x&&x.path||"";Cw(m,!x||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let y=ba(),v;if(e){let _=typeof e=="string"?sl(e):e;Dt(p==="/"||_.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${_.pathname}" was given in the \`location\` prop.`),v=_}else v=y;let w=v.pathname||"/",A=w;if(p!=="/"){let _=p.replace(/^\//,"").split("/");A="/"+w.replace(/^\//,"").split("/").slice(_.length).join("/")}let N=vw(n,{pathname:A});En(x||N!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),En(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let j=BE(N&&N.map(_=>Object.assign({},_,{params:Object.assign({},h,_.params),pathname:ga([p,l.encodeLocation?l.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?p:ga([p,l.encodeLocation?l.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),c,t,s,i);return e&&j?E.createElement(Bo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},j):j}function LE(){let n=$E(),e=SE(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},c=null;return console.error("Error handled by React Router default ErrorBoundary:",n),c=E.createElement(E.Fragment,null,E.createElement("p",null,"💿 Hey developer 👋"),E.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",E.createElement("code",{style:l},"ErrorBoundary")," or"," ",E.createElement("code",{style:l},"errorElement")," prop on your route.")),E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),t?E.createElement("pre",{style:i},t):null,c)}var OE=E.createElement(LE,null),PE=class extends E.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.unstable_onError?this.props.unstable_onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?E.createElement(Dn.Provider,{value:this.props.routeContext},E.createElement(Ap.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function IE({routeContext:n,match:e,children:t}){let s=E.useContext(nl);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),E.createElement(Dn.Provider,{value:n},t)}function BE(n,e=[],t=null,s=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let l=n,c=t?.errors;if(c!=null){let m=l.findIndex(p=>p.route.id&&c?.[p.route.id]!==void 0);Dt(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,m+1))}let u=!1,h=-1;if(t)for(let m=0;m<l.length;m++){let p=l[m];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=m),p.route.id){let{loaderData:x,errors:y}=t,v=p.route.loader&&!x.hasOwnProperty(p.route.id)&&(!y||y[p.route.id]===void 0);if(p.route.lazy||v){u=!0,h>=0?l=l.slice(0,h+1):l=[l[0]];break}}}return l.reduceRight((m,p,x)=>{let y,v=!1,w=null,A=null;t&&(y=c&&p.route.id?c[p.route.id]:void 0,w=p.route.errorElement||OE,u&&(h<0&&x===0?(Cw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,A=null):h===x&&(v=!0,A=p.route.hydrateFallbackElement||null)));let N=e.concat(l.slice(0,x+1)),j=()=>{let _;return y?_=w:v?_=A:p.route.Component?_=E.createElement(p.route.Component,null):p.route.element?_=p.route.element:_=m,E.createElement(IE,{match:p,routeContext:{outlet:m,matches:N,isDataRoute:t!=null},children:_})};return t&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?E.createElement(PE,{location:t.location,revalidation:t.revalidation,component:w,error:y,children:j(),routeContext:{outlet:null,matches:N,isDataRoute:!0},unstable_onError:s}):j()},null)}function Np(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function HE(n){let e=E.useContext(nl);return Dt(e,Np(n)),e}function zE(n){let e=E.useContext(uu);return Dt(e,Np(n)),e}function FE(n){let e=E.useContext(Dn);return Dt(e,Np(n)),e}function jp(n){let e=FE(n),t=e.matches[e.matches.length-1];return Dt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function UE(){return jp("useRouteId")}function $E(){let n=E.useContext(Ap),e=zE("useRouteError"),t=jp("useRouteError");return n!==void 0?n:e.errors?.[t]}function VE(){let{router:n}=HE("useNavigate"),e=jp("useNavigate"),t=E.useRef(!1);return Ew(()=>{t.current=!0}),E.useCallback(async(i,l={})=>{En(t.current,Sw),t.current&&(typeof i=="number"?n.navigate(i):await n.navigate(i,{fromRouteId:e,...l}))},[n,e])}var Ab={};function Cw(n,e,t){!e&&!Ab[n]&&(Ab[n]=!0,En(!1,t))}E.memo(qE);function qE({routes:n,future:e,state:t,unstable_onError:s}){return _w(n,void 0,t,s,e)}function pa({to:n,replace:e,state:t,relative:s}){Dt(al(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=E.useContext(Tn);En(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=E.useContext(Dn),{pathname:c}=ba(),u=il(),h=wp(n,vp(l),c,s==="path"),m=JSON.stringify(h);return E.useEffect(()=>{u(JSON.parse(m),{replace:e,state:t,relative:s})},[u,m,s,e,t]),null}function Sp(n){return kE(n.context)}function gt(n){Dt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function GE({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:i,static:l=!1}){Dt(!al(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=n.replace(/^\/*/,"/"),u=E.useMemo(()=>({basename:c,navigator:i,static:l,future:{}}),[c,i,l]);typeof t=="string"&&(t=sl(t));let{pathname:h="/",search:m="",hash:p="",state:x=null,key:y="default"}=t,v=E.useMemo(()=>{let w=xa(h,c);return w==null?null:{location:{pathname:w,search:m,hash:p,state:x,key:y},navigationType:s}},[c,h,m,p,x,y,s]);return En(v!=null,`<Router basename="${c}"> is not able to match the URL "${h}${m}${p}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:E.createElement(Tn.Provider,{value:u},E.createElement(Bo.Provider,{children:e,value:v}))}function YE({children:n,location:e}){return ME(zm(n),e)}function zm(n,e=[]){let t=[];return E.Children.forEach(n,(s,i)=>{if(!E.isValidElement(s))return;let l=[...e,i];if(s.type===E.Fragment){t.push.apply(t,zm(s.props.children,l));return}Dt(s.type===gt,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Dt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let c={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=zm(s.props.children,l)),t.push(c)}),t}var _d="get",Cd="application/x-www-form-urlencoded";function hu(n){return n!=null&&typeof n.tagName=="string"}function WE(n){return hu(n)&&n.tagName.toLowerCase()==="button"}function XE(n){return hu(n)&&n.tagName.toLowerCase()==="form"}function QE(n){return hu(n)&&n.tagName.toLowerCase()==="input"}function ZE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function KE(n,e){return n.button===0&&(!e||e==="_self")&&!ZE(n)}var ud=null;function JE(){if(ud===null)try{new FormData(document.createElement("form"),0),ud=!1}catch{ud=!0}return ud}var e_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function sm(n){return n!=null&&!e_.has(n)?(En(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Cd}"`),null):n}function t_(n,e){let t,s,i,l,c;if(XE(n)){let u=n.getAttribute("action");s=u?xa(u,e):null,t=n.getAttribute("method")||_d,i=sm(n.getAttribute("enctype"))||Cd,l=new FormData(n)}else if(WE(n)||QE(n)&&(n.type==="submit"||n.type==="image")){let u=n.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=n.getAttribute("formaction")||u.getAttribute("action");if(s=h?xa(h,e):null,t=n.getAttribute("formmethod")||u.getAttribute("method")||_d,i=sm(n.getAttribute("formenctype"))||sm(u.getAttribute("enctype"))||Cd,l=new FormData(u,n),!JE()){let{name:m,type:p,value:x}=n;if(p==="image"){let y=m?`${m}.`:"";l.append(`${y}x`,"0"),l.append(`${y}y`,"0")}else m&&l.append(m,x)}}else{if(hu(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=_d,s=null,i=Cd,c=n}return l&&i==="text/plain"&&(c=l,l=void 0),{action:s,method:t.toLowerCase(),encType:i,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ep(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function s_(n,e,t){let s=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return s.pathname==="/"?s.pathname=`_root.${t}`:e&&xa(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${t}`,s}async function n_(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function a_(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function i_(n,e,t){let s=await Promise.all(n.map(async i=>{let l=e.routes[i.route.id];if(l){let c=await n_(l,t);return c.links?c.links():[]}return[]}));return c_(s.flat(1).filter(a_).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function Nb(n,e,t,s,i,l){let c=(h,m)=>t[m]?h.route.id!==t[m].route.id:!0,u=(h,m)=>t[m].pathname!==h.pathname||t[m].route.path?.endsWith("*")&&t[m].params["*"]!==h.params["*"];return l==="assets"?e.filter((h,m)=>c(h,m)||u(h,m)):l==="data"?e.filter((h,m)=>{let p=s.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(c(h,m)||u(h,m))return!0;if(h.route.shouldRevalidate){let x=h.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function r_(n,e,{includeHydrateFallback:t}={}){return l_(n.map(s=>{let i=e.routes[s.route.id];if(!i)return[];let l=[i.module];return i.clientActionModule&&(l=l.concat(i.clientActionModule)),i.clientLoaderModule&&(l=l.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(l=l.concat(i.hydrateFallbackModule)),i.imports&&(l=l.concat(i.imports)),l}).flat(1))}function l_(n){return[...new Set(n)]}function o_(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function c_(n,e){let t=new Set;return new Set(e),n.reduce((s,i)=>{let l=JSON.stringify(o_(i));return t.has(l)||(t.add(l),s.push({key:l,link:i})),s},[])}function Tw(){let n=E.useContext(nl);return Ep(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function d_(){let n=E.useContext(uu);return Ep(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var _p=E.createContext(void 0);_p.displayName="FrameworkContext";function Dw(){let n=E.useContext(_p);return Ep(n,"You must render this element inside a <HydratedRouter> element"),n}function u_(n,e){let t=E.useContext(_p),[s,i]=E.useState(!1),[l,c]=E.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:m,onMouseLeave:p,onTouchStart:x}=e,y=E.useRef(null);E.useEffect(()=>{if(n==="render"&&c(!0),n==="viewport"){let A=j=>{j.forEach(_=>{c(_.isIntersecting)})},N=new IntersectionObserver(A,{threshold:.5});return y.current&&N.observe(y.current),()=>{N.disconnect()}}},[n]),E.useEffect(()=>{if(s){let A=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(A)}}},[s]);let v=()=>{i(!0)},w=()=>{i(!1),c(!1)};return t?n!=="intent"?[l,y,{}]:[l,y,{onFocus:ao(u,v),onBlur:ao(h,w),onMouseEnter:ao(m,v),onMouseLeave:ao(p,w),onTouchStart:ao(x,v)}]:[!1,y,{}]}function ao(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function h_({page:n,...e}){let{router:t}=Tw(),s=E.useMemo(()=>vw(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?E.createElement(m_,{page:n,matches:s,...e}):null}function f_(n){let{manifest:e,routeModules:t}=Dw(),[s,i]=E.useState([]);return E.useEffect(()=>{let l=!1;return i_(n,e,t).then(c=>{l||i(c)}),()=>{l=!0}},[n,e,t]),s}function m_({page:n,matches:e,...t}){let s=ba(),{manifest:i,routeModules:l}=Dw(),{basename:c}=Tw(),{loaderData:u,matches:h}=d_(),m=E.useMemo(()=>Nb(n,e,h,i,s,"data"),[n,e,h,i,s]),p=E.useMemo(()=>Nb(n,e,h,i,s,"assets"),[n,e,h,i,s]),x=E.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let w=new Set,A=!1;if(e.forEach(j=>{let _=i.routes[j.route.id];!_||!_.hasLoader||(!m.some(C=>C.route.id===j.route.id)&&j.route.id in u&&l[j.route.id]?.shouldRevalidate||_.hasClientLoader?A=!0:w.add(j.route.id))}),w.size===0)return[];let N=s_(n,c,"data");return A&&w.size>0&&N.searchParams.set("_routes",e.filter(j=>w.has(j.route.id)).map(j=>j.route.id).join(",")),[N.pathname+N.search]},[c,u,s,i,m,e,n,l]),y=E.useMemo(()=>r_(p,i),[p,i]),v=f_(p);return E.createElement(E.Fragment,null,x.map(w=>E.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),y.map(w=>E.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),v.map(({key:w,link:A})=>E.createElement("link",{key:w,nonce:t.nonce,...A})))}function p_(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Rw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Rw&&(window.__reactRouterVersion="7.8.2")}catch{}function g_({basename:n,children:e,window:t}){let s=E.useRef();s.current==null&&(s.current=sE({window:t,v5Compat:!0}));let i=s.current,[l,c]=E.useState({action:i.action,location:i.location}),u=E.useCallback(h=>{E.startTransition(()=>c(h))},[c]);return E.useLayoutEffect(()=>i.listen(u),[i,u]),E.createElement(GE,{basename:n,children:e,location:l.location,navigationType:l.action,navigator:i})}var kw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Cp=E.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:i,reloadDocument:l,replace:c,state:u,target:h,to:m,preventScrollReset:p,viewTransition:x,...y},v){let{basename:w}=E.useContext(Tn),A=typeof m=="string"&&kw.test(m),N,j=!1;if(typeof m=="string"&&A&&(N=m,Rw))try{let I=new URL(window.location.href),K=m.startsWith("//")?new URL(I.protocol+m):new URL(m),H=xa(K.pathname,w);K.origin===I.origin&&H!=null?m=H+K.search+K.hash:j=!0}catch{En(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=TE(m,{relative:i}),[C,k,D]=u_(s,y),P=v_(m,{replace:c,state:u,target:h,preventScrollReset:p,relative:i,viewTransition:x});function F(I){e&&e(I),I.defaultPrevented||P(I)}let U=E.createElement("a",{...y,...D,href:N||_,onClick:j||l?e:F,ref:p_(v,k),target:h,"data-discover":!A&&t==="render"?"true":void 0});return C&&!A?E.createElement(E.Fragment,null,U,E.createElement(h_,{page:_})):U});Cp.displayName="Link";var x_=E.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:i=!1,style:l,to:c,viewTransition:u,children:h,...m},p){let x=Ho(c,{relative:m.relative}),y=ba(),v=E.useContext(uu),{navigator:w,basename:A}=E.useContext(Tn),N=v!=null&&S_(x)&&u===!0,j=w.encodeLocation?w.encodeLocation(x).pathname:x.pathname,_=y.pathname,C=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(_=_.toLowerCase(),C=C?C.toLowerCase():null,j=j.toLowerCase()),C&&A&&(C=xa(C,A)||C);const k=j!=="/"&&j.endsWith("/")?j.length-1:j.length;let D=_===j||!i&&_.startsWith(j)&&_.charAt(k)==="/",P=C!=null&&(C===j||!i&&C.startsWith(j)&&C.charAt(j.length)==="/"),F={isActive:D,isPending:P,isTransitioning:N},U=D?e:void 0,I;typeof s=="function"?I=s(F):I=[s,D?"active":null,P?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let K=typeof l=="function"?l(F):l;return E.createElement(Cp,{...m,"aria-current":U,className:I,ref:p,style:K,to:c,viewTransition:u},typeof h=="function"?h(F):h)});x_.displayName="NavLink";var y_=E.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:i,state:l,method:c=_d,action:u,onSubmit:h,relative:m,preventScrollReset:p,viewTransition:x,...y},v)=>{let w=N_(),A=j_(u,{relative:m}),N=c.toLowerCase()==="get"?"get":"post",j=typeof u=="string"&&kw.test(u),_=C=>{if(h&&h(C),C.defaultPrevented)return;C.preventDefault();let k=C.nativeEvent.submitter,D=k?.getAttribute("formmethod")||c;w(k||C.currentTarget,{fetcherKey:e,method:D,navigate:t,replace:i,state:l,relative:m,preventScrollReset:p,viewTransition:x})};return E.createElement("form",{ref:v,method:N,action:A,onSubmit:s?h:_,...y,"data-discover":!j&&n==="render"?"true":void 0})});y_.displayName="Form";function b_(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Mw(n){let e=E.useContext(nl);return Dt(e,b_(n)),e}function v_(n,{target:e,replace:t,state:s,preventScrollReset:i,relative:l,viewTransition:c}={}){let u=il(),h=ba(),m=Ho(n,{relative:l});return E.useCallback(p=>{if(KE(p,e)){p.preventDefault();let x=t!==void 0?t:_o(h)===_o(m);u(n,{replace:x,state:s,preventScrollReset:i,relative:l,viewTransition:c})}},[h,u,m,t,s,e,n,i,l,c])}var w_=0,A_=()=>`__${String(++w_)}__`;function N_(){let{router:n}=Mw("useSubmit"),{basename:e}=E.useContext(Tn),t=UE();return E.useCallback(async(s,i={})=>{let{action:l,method:c,encType:u,formData:h,body:m}=t_(s,e);if(i.navigate===!1){let p=i.fetcherKey||A_();await n.fetch(p,t,i.action||l,{preventScrollReset:i.preventScrollReset,formData:h,body:m,formMethod:i.method||c,formEncType:i.encType||u,flushSync:i.flushSync})}else await n.navigate(i.action||l,{preventScrollReset:i.preventScrollReset,formData:h,body:m,formMethod:i.method||c,formEncType:i.encType||u,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[n,e,t])}function j_(n,{relative:e}={}){let{basename:t}=E.useContext(Tn),s=E.useContext(Dn);Dt(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),l={...Ho(n||".",{relative:e})},c=ba();if(n==null){l.search=c.search;let u=new URLSearchParams(l.search),h=u.getAll("index");if(h.some(p=>p==="")){u.delete("index"),h.filter(x=>x).forEach(x=>u.append("index",x));let p=u.toString();l.search=p?`?${p}`:""}}return(!n||n===".")&&i.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(l.pathname=l.pathname==="/"?t:ga([t,l.pathname])),_o(l)}function S_(n,{relative:e}={}){let t=E.useContext(jw);Dt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Mw("useViewTransitionState"),i=Ho(n,{relative:e});if(!t.isTransitioning)return!1;let l=xa(t.currentLocation.pathname,s)||t.currentLocation.pathname,c=xa(t.nextLocation.pathname,s)||t.nextLocation.pathname;return zd(i.pathname,c)!=null||zd(i.pathname,l)!=null}var Fm=bw();function Lw(n,e){return function(){return n.apply(e,arguments)}}const{toString:E_}=Object.prototype,{getPrototypeOf:Tp}=Object,{iterator:fu,toStringTag:Ow}=Symbol,mu=(n=>e=>{const t=E_.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Rn=n=>(n=n.toLowerCase(),e=>mu(e)===n),pu=n=>e=>typeof e===n,{isArray:rl}=Array,Co=pu("undefined");function zo(n){return n!==null&&!Co(n)&&n.constructor!==null&&!Co(n.constructor)&&Is(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Pw=Rn("ArrayBuffer");function __(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Pw(n.buffer),e}const C_=pu("string"),Is=pu("function"),Iw=pu("number"),Fo=n=>n!==null&&typeof n=="object",T_=n=>n===!0||n===!1,Td=n=>{if(mu(n)!=="object")return!1;const e=Tp(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Ow in n)&&!(fu in n)},D_=n=>{if(!Fo(n)||zo(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},R_=Rn("Date"),k_=Rn("File"),M_=Rn("Blob"),L_=Rn("FileList"),O_=n=>Fo(n)&&Is(n.pipe),P_=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Is(n.append)&&((e=mu(n))==="formdata"||e==="object"&&Is(n.toString)&&n.toString()==="[object FormData]"))},I_=Rn("URLSearchParams"),[B_,H_,z_,F_]=["ReadableStream","Request","Response","Headers"].map(Rn),U_=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Uo(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let s,i;if(typeof n!="object"&&(n=[n]),rl(n))for(s=0,i=n.length;s<i;s++)e.call(null,n[s],s,n);else{if(zo(n))return;const l=t?Object.getOwnPropertyNames(n):Object.keys(n),c=l.length;let u;for(s=0;s<c;s++)u=l[s],e.call(null,n[u],u,n)}}function Bw(n,e){if(zo(n))return null;e=e.toLowerCase();const t=Object.keys(n);let s=t.length,i;for(;s-- >0;)if(i=t[s],e===i.toLowerCase())return i;return null}const Ri=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Hw=n=>!Co(n)&&n!==Ri;function Um(){const{caseless:n}=Hw(this)&&this||{},e={},t=(s,i)=>{const l=n&&Bw(e,i)||i;Td(e[l])&&Td(s)?e[l]=Um(e[l],s):Td(s)?e[l]=Um({},s):rl(s)?e[l]=s.slice():e[l]=s};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Uo(arguments[s],t);return e}const $_=(n,e,t,{allOwnKeys:s}={})=>(Uo(e,(i,l)=>{t&&Is(i)?n[l]=Lw(i,t):n[l]=i},{allOwnKeys:s}),n),V_=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),q_=(n,e,t,s)=>{n.prototype=Object.create(e.prototype,s),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},G_=(n,e,t,s)=>{let i,l,c;const u={};if(e=e||{},n==null)return e;do{for(i=Object.getOwnPropertyNames(n),l=i.length;l-- >0;)c=i[l],(!s||s(c,n,e))&&!u[c]&&(e[c]=n[c],u[c]=!0);n=t!==!1&&Tp(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},Y_=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const s=n.indexOf(e,t);return s!==-1&&s===t},W_=n=>{if(!n)return null;if(rl(n))return n;let e=n.length;if(!Iw(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},X_=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&Tp(Uint8Array)),Q_=(n,e)=>{const s=(n&&n[fu]).call(n);let i;for(;(i=s.next())&&!i.done;){const l=i.value;e.call(n,l[0],l[1])}},Z_=(n,e)=>{let t;const s=[];for(;(t=n.exec(e))!==null;)s.push(t);return s},K_=Rn("HTMLFormElement"),J_=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,s,i){return s.toUpperCase()+i}),jb=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),e2=Rn("RegExp"),zw=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),s={};Uo(t,(i,l)=>{let c;(c=e(i,l,n))!==!1&&(s[l]=c||i)}),Object.defineProperties(n,s)},t2=n=>{zw(n,(e,t)=>{if(Is(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const s=n[t];if(Is(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},s2=(n,e)=>{const t={},s=i=>{i.forEach(l=>{t[l]=!0})};return rl(n)?s(n):s(String(n).split(e)),t},n2=()=>{},a2=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function i2(n){return!!(n&&Is(n.append)&&n[Ow]==="FormData"&&n[fu])}const r2=n=>{const e=new Array(10),t=(s,i)=>{if(Fo(s)){if(e.indexOf(s)>=0)return;if(zo(s))return s;if(!("toJSON"in s)){e[i]=s;const l=rl(s)?[]:{};return Uo(s,(c,u)=>{const h=t(c,i+1);!Co(h)&&(l[u]=h)}),e[i]=void 0,l}}return s};return t(n,0)},l2=Rn("AsyncFunction"),o2=n=>n&&(Fo(n)||Is(n))&&Is(n.then)&&Is(n.catch),Fw=((n,e)=>n?setImmediate:e?((t,s)=>(Ri.addEventListener("message",({source:i,data:l})=>{i===Ri&&l===t&&s.length&&s.shift()()},!1),i=>{s.push(i),Ri.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Is(Ri.postMessage)),c2=typeof queueMicrotask<"u"?queueMicrotask.bind(Ri):typeof process<"u"&&process.nextTick||Fw,d2=n=>n!=null&&Is(n[fu]),oe={isArray:rl,isArrayBuffer:Pw,isBuffer:zo,isFormData:P_,isArrayBufferView:__,isString:C_,isNumber:Iw,isBoolean:T_,isObject:Fo,isPlainObject:Td,isEmptyObject:D_,isReadableStream:B_,isRequest:H_,isResponse:z_,isHeaders:F_,isUndefined:Co,isDate:R_,isFile:k_,isBlob:M_,isRegExp:e2,isFunction:Is,isStream:O_,isURLSearchParams:I_,isTypedArray:X_,isFileList:L_,forEach:Uo,merge:Um,extend:$_,trim:U_,stripBOM:V_,inherits:q_,toFlatObject:G_,kindOf:mu,kindOfTest:Rn,endsWith:Y_,toArray:W_,forEachEntry:Q_,matchAll:Z_,isHTMLForm:K_,hasOwnProperty:jb,hasOwnProp:jb,reduceDescriptors:zw,freezeMethods:t2,toObjectSet:s2,toCamelCase:J_,noop:n2,toFiniteNumber:a2,findKey:Bw,global:Ri,isContextDefined:Hw,isSpecCompliantForm:i2,toJSONObject:r2,isAsyncFn:l2,isThenable:o2,setImmediate:Fw,asap:c2,isIterable:d2};function Ve(n,e,t,s,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),s&&(this.request=s),i&&(this.response=i,this.status=i.status?i.status:null)}oe.inherits(Ve,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:oe.toJSONObject(this.config),code:this.code,status:this.status}}});const Uw=Ve.prototype,$w={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{$w[n]={value:n}});Object.defineProperties(Ve,$w);Object.defineProperty(Uw,"isAxiosError",{value:!0});Ve.from=(n,e,t,s,i,l)=>{const c=Object.create(Uw);return oe.toFlatObject(n,c,function(h){return h!==Error.prototype},u=>u!=="isAxiosError"),Ve.call(c,n.message,e,t,s,i),c.cause=n,c.name=n.name,l&&Object.assign(c,l),c};const u2=null;function $m(n){return oe.isPlainObject(n)||oe.isArray(n)}function Vw(n){return oe.endsWith(n,"[]")?n.slice(0,-2):n}function Sb(n,e,t){return n?n.concat(e).map(function(i,l){return i=Vw(i),!t&&l?"["+i+"]":i}).join(t?".":""):e}function h2(n){return oe.isArray(n)&&!n.some($m)}const f2=oe.toFlatObject(oe,{},null,function(e){return/^is[A-Z]/.test(e)});function gu(n,e,t){if(!oe.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=oe.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(A,N){return!oe.isUndefined(N[A])});const s=t.metaTokens,i=t.visitor||p,l=t.dots,c=t.indexes,h=(t.Blob||typeof Blob<"u"&&Blob)&&oe.isSpecCompliantForm(e);if(!oe.isFunction(i))throw new TypeError("visitor must be a function");function m(w){if(w===null)return"";if(oe.isDate(w))return w.toISOString();if(oe.isBoolean(w))return w.toString();if(!h&&oe.isBlob(w))throw new Ve("Blob is not supported. Use a Buffer instead.");return oe.isArrayBuffer(w)||oe.isTypedArray(w)?h&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function p(w,A,N){let j=w;if(w&&!N&&typeof w=="object"){if(oe.endsWith(A,"{}"))A=s?A:A.slice(0,-2),w=JSON.stringify(w);else if(oe.isArray(w)&&h2(w)||(oe.isFileList(w)||oe.endsWith(A,"[]"))&&(j=oe.toArray(w)))return A=Vw(A),j.forEach(function(C,k){!(oe.isUndefined(C)||C===null)&&e.append(c===!0?Sb([A],k,l):c===null?A:A+"[]",m(C))}),!1}return $m(w)?!0:(e.append(Sb(N,A,l),m(w)),!1)}const x=[],y=Object.assign(f2,{defaultVisitor:p,convertValue:m,isVisitable:$m});function v(w,A){if(!oe.isUndefined(w)){if(x.indexOf(w)!==-1)throw Error("Circular reference detected in "+A.join("."));x.push(w),oe.forEach(w,function(j,_){(!(oe.isUndefined(j)||j===null)&&i.call(e,j,oe.isString(_)?_.trim():_,A,y))===!0&&v(j,A?A.concat(_):[_])}),x.pop()}}if(!oe.isObject(n))throw new TypeError("data must be an object");return v(n),e}function Eb(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function Dp(n,e){this._pairs=[],n&&gu(n,this,e)}const qw=Dp.prototype;qw.append=function(e,t){this._pairs.push([e,t])};qw.toString=function(e){const t=e?function(s){return e.call(this,s,Eb)}:Eb;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function m2(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Gw(n,e,t){if(!e)return n;const s=t&&t.encode||m2;oe.isFunction(t)&&(t={serialize:t});const i=t&&t.serialize;let l;if(i?l=i(e,t):l=oe.isURLSearchParams(e)?e.toString():new Dp(e,t).toString(s),l){const c=n.indexOf("#");c!==-1&&(n=n.slice(0,c)),n+=(n.indexOf("?")===-1?"?":"&")+l}return n}class _b{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){oe.forEach(this.handlers,function(s){s!==null&&e(s)})}}const Yw={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},p2=typeof URLSearchParams<"u"?URLSearchParams:Dp,g2=typeof FormData<"u"?FormData:null,x2=typeof Blob<"u"?Blob:null,y2={isBrowser:!0,classes:{URLSearchParams:p2,FormData:g2,Blob:x2},protocols:["http","https","file","blob","url","data"]},Rp=typeof window<"u"&&typeof document<"u",Vm=typeof navigator=="object"&&navigator||void 0,b2=Rp&&(!Vm||["ReactNative","NativeScript","NS"].indexOf(Vm.product)<0),v2=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",w2=Rp&&window.location.href||"http://localhost",A2=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Rp,hasStandardBrowserEnv:b2,hasStandardBrowserWebWorkerEnv:v2,navigator:Vm,origin:w2},Symbol.toStringTag,{value:"Module"})),ys={...A2,...y2};function N2(n,e){return gu(n,new ys.classes.URLSearchParams,{visitor:function(t,s,i,l){return ys.isNode&&oe.isBuffer(t)?(this.append(s,t.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...e})}function j2(n){return oe.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function S2(n){const e={},t=Object.keys(n);let s;const i=t.length;let l;for(s=0;s<i;s++)l=t[s],e[l]=n[l];return e}function Ww(n){function e(t,s,i,l){let c=t[l++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),h=l>=t.length;return c=!c&&oe.isArray(i)?i.length:c,h?(oe.hasOwnProp(i,c)?i[c]=[i[c],s]:i[c]=s,!u):((!i[c]||!oe.isObject(i[c]))&&(i[c]=[]),e(t,s,i[c],l)&&oe.isArray(i[c])&&(i[c]=S2(i[c])),!u)}if(oe.isFormData(n)&&oe.isFunction(n.entries)){const t={};return oe.forEachEntry(n,(s,i)=>{e(j2(s),i,t,0)}),t}return null}function E2(n,e,t){if(oe.isString(n))try{return(e||JSON.parse)(n),oe.trim(n)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(n)}const $o={transitional:Yw,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",i=s.indexOf("application/json")>-1,l=oe.isObject(e);if(l&&oe.isHTMLForm(e)&&(e=new FormData(e)),oe.isFormData(e))return i?JSON.stringify(Ww(e)):e;if(oe.isArrayBuffer(e)||oe.isBuffer(e)||oe.isStream(e)||oe.isFile(e)||oe.isBlob(e)||oe.isReadableStream(e))return e;if(oe.isArrayBufferView(e))return e.buffer;if(oe.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let u;if(l){if(s.indexOf("application/x-www-form-urlencoded")>-1)return N2(e,this.formSerializer).toString();if((u=oe.isFileList(e))||s.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return gu(u?{"files[]":e}:e,h&&new h,this.formSerializer)}}return l||i?(t.setContentType("application/json",!1),E2(e)):e}],transformResponse:[function(e){const t=this.transitional||$o.transitional,s=t&&t.forcedJSONParsing,i=this.responseType==="json";if(oe.isResponse(e)||oe.isReadableStream(e))return e;if(e&&oe.isString(e)&&(s&&!this.responseType||i)){const c=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(u){if(c)throw u.name==="SyntaxError"?Ve.from(u,Ve.ERR_BAD_RESPONSE,this,null,this.response):u}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ys.classes.FormData,Blob:ys.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};oe.forEach(["delete","get","head","post","put","patch"],n=>{$o.headers[n]={}});const _2=oe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),C2=n=>{const e={};let t,s,i;return n&&n.split(`
`).forEach(function(c){i=c.indexOf(":"),t=c.substring(0,i).trim().toLowerCase(),s=c.substring(i+1).trim(),!(!t||e[t]&&_2[t])&&(t==="set-cookie"?e[t]?e[t].push(s):e[t]=[s]:e[t]=e[t]?e[t]+", "+s:s)}),e},Cb=Symbol("internals");function io(n){return n&&String(n).trim().toLowerCase()}function Dd(n){return n===!1||n==null?n:oe.isArray(n)?n.map(Dd):String(n)}function T2(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=t.exec(n);)e[s[1]]=s[2];return e}const D2=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function nm(n,e,t,s,i){if(oe.isFunction(s))return s.call(this,e,t);if(i&&(e=t),!!oe.isString(e)){if(oe.isString(s))return e.indexOf(s)!==-1;if(oe.isRegExp(s))return s.test(e)}}function R2(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}function k2(n,e){const t=oe.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(n,s+t,{value:function(i,l,c){return this[s].call(this,e,i,l,c)},configurable:!0})})}let Bs=class{constructor(e){e&&this.set(e)}set(e,t,s){const i=this;function l(u,h,m){const p=io(h);if(!p)throw new Error("header name must be a non-empty string");const x=oe.findKey(i,p);(!x||i[x]===void 0||m===!0||m===void 0&&i[x]!==!1)&&(i[x||h]=Dd(u))}const c=(u,h)=>oe.forEach(u,(m,p)=>l(m,p,h));if(oe.isPlainObject(e)||e instanceof this.constructor)c(e,t);else if(oe.isString(e)&&(e=e.trim())&&!D2(e))c(C2(e),t);else if(oe.isObject(e)&&oe.isIterable(e)){let u={},h,m;for(const p of e){if(!oe.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[m=p[0]]=(h=u[m])?oe.isArray(h)?[...h,p[1]]:[h,p[1]]:p[1]}c(u,t)}else e!=null&&l(t,e,s);return this}get(e,t){if(e=io(e),e){const s=oe.findKey(this,e);if(s){const i=this[s];if(!t)return i;if(t===!0)return T2(i);if(oe.isFunction(t))return t.call(this,i,s);if(oe.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=io(e),e){const s=oe.findKey(this,e);return!!(s&&this[s]!==void 0&&(!t||nm(this,this[s],s,t)))}return!1}delete(e,t){const s=this;let i=!1;function l(c){if(c=io(c),c){const u=oe.findKey(s,c);u&&(!t||nm(s,s[u],u,t))&&(delete s[u],i=!0)}}return oe.isArray(e)?e.forEach(l):l(e),i}clear(e){const t=Object.keys(this);let s=t.length,i=!1;for(;s--;){const l=t[s];(!e||nm(this,this[l],l,e,!0))&&(delete this[l],i=!0)}return i}normalize(e){const t=this,s={};return oe.forEach(this,(i,l)=>{const c=oe.findKey(s,l);if(c){t[c]=Dd(i),delete t[l];return}const u=e?R2(l):String(l).trim();u!==l&&delete t[l],t[u]=Dd(i),s[u]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return oe.forEach(this,(s,i)=>{s!=null&&s!==!1&&(t[i]=e&&oe.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach(i=>s.set(i)),s}static accessor(e){const s=(this[Cb]=this[Cb]={accessors:{}}).accessors,i=this.prototype;function l(c){const u=io(c);s[u]||(k2(i,c),s[u]=!0)}return oe.isArray(e)?e.forEach(l):l(e),this}};Bs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);oe.reduceDescriptors(Bs.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(s){this[t]=s}}});oe.freezeMethods(Bs);function am(n,e){const t=this||$o,s=e||t,i=Bs.from(s.headers);let l=s.data;return oe.forEach(n,function(u){l=u.call(t,l,i.normalize(),e?e.status:void 0)}),i.normalize(),l}function Xw(n){return!!(n&&n.__CANCEL__)}function ll(n,e,t){Ve.call(this,n??"canceled",Ve.ERR_CANCELED,e,t),this.name="CanceledError"}oe.inherits(ll,Ve,{__CANCEL__:!0});function Qw(n,e,t){const s=t.config.validateStatus;!t.status||!s||s(t.status)?n(t):e(new Ve("Request failed with status code "+t.status,[Ve.ERR_BAD_REQUEST,Ve.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function M2(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function L2(n,e){n=n||10;const t=new Array(n),s=new Array(n);let i=0,l=0,c;return e=e!==void 0?e:1e3,function(h){const m=Date.now(),p=s[l];c||(c=m),t[i]=h,s[i]=m;let x=l,y=0;for(;x!==i;)y+=t[x++],x=x%n;if(i=(i+1)%n,i===l&&(l=(l+1)%n),m-c<e)return;const v=p&&m-p;return v?Math.round(y*1e3/v):void 0}}function O2(n,e){let t=0,s=1e3/e,i,l;const c=(m,p=Date.now())=>{t=p,i=null,l&&(clearTimeout(l),l=null),n(...m)};return[(...m)=>{const p=Date.now(),x=p-t;x>=s?c(m,p):(i=m,l||(l=setTimeout(()=>{l=null,c(i)},s-x)))},()=>i&&c(i)]}const Fd=(n,e,t=3)=>{let s=0;const i=L2(50,250);return O2(l=>{const c=l.loaded,u=l.lengthComputable?l.total:void 0,h=c-s,m=i(h),p=c<=u;s=c;const x={loaded:c,total:u,progress:u?c/u:void 0,bytes:h,rate:m||void 0,estimated:m&&u&&p?(u-c)/m:void 0,event:l,lengthComputable:u!=null,[e?"download":"upload"]:!0};n(x)},t)},Tb=(n,e)=>{const t=n!=null;return[s=>e[0]({lengthComputable:t,total:n,loaded:s}),e[1]]},Db=n=>(...e)=>oe.asap(()=>n(...e)),P2=ys.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,ys.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(ys.origin),ys.navigator&&/(msie|trident)/i.test(ys.navigator.userAgent)):()=>!0,I2=ys.hasStandardBrowserEnv?{write(n,e,t,s,i,l){const c=[n+"="+encodeURIComponent(e)];oe.isNumber(t)&&c.push("expires="+new Date(t).toGMTString()),oe.isString(s)&&c.push("path="+s),oe.isString(i)&&c.push("domain="+i),l===!0&&c.push("secure"),document.cookie=c.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function B2(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function H2(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function Zw(n,e,t){let s=!B2(e);return n&&(s||t==!1)?H2(n,e):e}const Rb=n=>n instanceof Bs?{...n}:n;function zi(n,e){e=e||{};const t={};function s(m,p,x,y){return oe.isPlainObject(m)&&oe.isPlainObject(p)?oe.merge.call({caseless:y},m,p):oe.isPlainObject(p)?oe.merge({},p):oe.isArray(p)?p.slice():p}function i(m,p,x,y){if(oe.isUndefined(p)){if(!oe.isUndefined(m))return s(void 0,m,x,y)}else return s(m,p,x,y)}function l(m,p){if(!oe.isUndefined(p))return s(void 0,p)}function c(m,p){if(oe.isUndefined(p)){if(!oe.isUndefined(m))return s(void 0,m)}else return s(void 0,p)}function u(m,p,x){if(x in e)return s(m,p);if(x in n)return s(void 0,m)}const h={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(m,p,x)=>i(Rb(m),Rb(p),x,!0)};return oe.forEach(Object.keys({...n,...e}),function(p){const x=h[p]||i,y=x(n[p],e[p],p);oe.isUndefined(y)&&x!==u||(t[p]=y)}),t}const Kw=n=>{const e=zi({},n);let{data:t,withXSRFToken:s,xsrfHeaderName:i,xsrfCookieName:l,headers:c,auth:u}=e;e.headers=c=Bs.from(c),e.url=Gw(Zw(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let h;if(oe.isFormData(t)){if(ys.hasStandardBrowserEnv||ys.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if((h=c.getContentType())!==!1){const[m,...p]=h?h.split(";").map(x=>x.trim()).filter(Boolean):[];c.setContentType([m||"multipart/form-data",...p].join("; "))}}if(ys.hasStandardBrowserEnv&&(s&&oe.isFunction(s)&&(s=s(e)),s||s!==!1&&P2(e.url))){const m=i&&l&&I2.read(l);m&&c.set(i,m)}return e},z2=typeof XMLHttpRequest<"u",F2=z2&&function(n){return new Promise(function(t,s){const i=Kw(n);let l=i.data;const c=Bs.from(i.headers).normalize();let{responseType:u,onUploadProgress:h,onDownloadProgress:m}=i,p,x,y,v,w;function A(){v&&v(),w&&w(),i.cancelToken&&i.cancelToken.unsubscribe(p),i.signal&&i.signal.removeEventListener("abort",p)}let N=new XMLHttpRequest;N.open(i.method.toUpperCase(),i.url,!0),N.timeout=i.timeout;function j(){if(!N)return;const C=Bs.from("getAllResponseHeaders"in N&&N.getAllResponseHeaders()),D={data:!u||u==="text"||u==="json"?N.responseText:N.response,status:N.status,statusText:N.statusText,headers:C,config:n,request:N};Qw(function(F){t(F),A()},function(F){s(F),A()},D),N=null}"onloadend"in N?N.onloadend=j:N.onreadystatechange=function(){!N||N.readyState!==4||N.status===0&&!(N.responseURL&&N.responseURL.indexOf("file:")===0)||setTimeout(j)},N.onabort=function(){N&&(s(new Ve("Request aborted",Ve.ECONNABORTED,n,N)),N=null)},N.onerror=function(){s(new Ve("Network Error",Ve.ERR_NETWORK,n,N)),N=null},N.ontimeout=function(){let k=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const D=i.transitional||Yw;i.timeoutErrorMessage&&(k=i.timeoutErrorMessage),s(new Ve(k,D.clarifyTimeoutError?Ve.ETIMEDOUT:Ve.ECONNABORTED,n,N)),N=null},l===void 0&&c.setContentType(null),"setRequestHeader"in N&&oe.forEach(c.toJSON(),function(k,D){N.setRequestHeader(D,k)}),oe.isUndefined(i.withCredentials)||(N.withCredentials=!!i.withCredentials),u&&u!=="json"&&(N.responseType=i.responseType),m&&([y,w]=Fd(m,!0),N.addEventListener("progress",y)),h&&N.upload&&([x,v]=Fd(h),N.upload.addEventListener("progress",x),N.upload.addEventListener("loadend",v)),(i.cancelToken||i.signal)&&(p=C=>{N&&(s(!C||C.type?new ll(null,n,N):C),N.abort(),N=null)},i.cancelToken&&i.cancelToken.subscribe(p),i.signal&&(i.signal.aborted?p():i.signal.addEventListener("abort",p)));const _=M2(i.url);if(_&&ys.protocols.indexOf(_)===-1){s(new Ve("Unsupported protocol "+_+":",Ve.ERR_BAD_REQUEST,n));return}N.send(l||null)})},U2=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let s=new AbortController,i;const l=function(m){if(!i){i=!0,u();const p=m instanceof Error?m:this.reason;s.abort(p instanceof Ve?p:new ll(p instanceof Error?p.message:p))}};let c=e&&setTimeout(()=>{c=null,l(new Ve(`timeout ${e} of ms exceeded`,Ve.ETIMEDOUT))},e);const u=()=>{n&&(c&&clearTimeout(c),c=null,n.forEach(m=>{m.unsubscribe?m.unsubscribe(l):m.removeEventListener("abort",l)}),n=null)};n.forEach(m=>m.addEventListener("abort",l));const{signal:h}=s;return h.unsubscribe=()=>oe.asap(u),h}},$2=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let s=0,i;for(;s<t;)i=s+e,yield n.slice(s,i),s=i},V2=async function*(n,e){for await(const t of q2(n))yield*$2(t,e)},q2=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:s}=await e.read();if(t)break;yield s}}finally{await e.cancel()}},kb=(n,e,t,s)=>{const i=V2(n,e);let l=0,c,u=h=>{c||(c=!0,s&&s(h))};return new ReadableStream({async pull(h){try{const{done:m,value:p}=await i.next();if(m){u(),h.close();return}let x=p.byteLength;if(t){let y=l+=x;t(y)}h.enqueue(new Uint8Array(p))}catch(m){throw u(m),m}},cancel(h){return u(h),i.return()}},{highWaterMark:2})},xu=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Jw=xu&&typeof ReadableStream=="function",G2=xu&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),e1=(n,...e)=>{try{return!!n(...e)}catch{return!1}},Y2=Jw&&e1(()=>{let n=!1;const e=new Request(ys.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),Mb=64*1024,qm=Jw&&e1(()=>oe.isReadableStream(new Response("").body)),Ud={stream:qm&&(n=>n.body)};xu&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Ud[e]&&(Ud[e]=oe.isFunction(n[e])?t=>t[e]():(t,s)=>{throw new Ve(`Response type '${e}' is not supported`,Ve.ERR_NOT_SUPPORT,s)})})})(new Response);const W2=async n=>{if(n==null)return 0;if(oe.isBlob(n))return n.size;if(oe.isSpecCompliantForm(n))return(await new Request(ys.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(oe.isArrayBufferView(n)||oe.isArrayBuffer(n))return n.byteLength;if(oe.isURLSearchParams(n)&&(n=n+""),oe.isString(n))return(await G2(n)).byteLength},X2=async(n,e)=>{const t=oe.toFiniteNumber(n.getContentLength());return t??W2(e)},Q2=xu&&(async n=>{let{url:e,method:t,data:s,signal:i,cancelToken:l,timeout:c,onDownloadProgress:u,onUploadProgress:h,responseType:m,headers:p,withCredentials:x="same-origin",fetchOptions:y}=Kw(n);m=m?(m+"").toLowerCase():"text";let v=U2([i,l&&l.toAbortSignal()],c),w;const A=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let N;try{if(h&&Y2&&t!=="get"&&t!=="head"&&(N=await X2(p,s))!==0){let D=new Request(e,{method:"POST",body:s,duplex:"half"}),P;if(oe.isFormData(s)&&(P=D.headers.get("content-type"))&&p.setContentType(P),D.body){const[F,U]=Tb(N,Fd(Db(h)));s=kb(D.body,Mb,F,U)}}oe.isString(x)||(x=x?"include":"omit");const j="credentials"in Request.prototype;w=new Request(e,{...y,signal:v,method:t.toUpperCase(),headers:p.normalize().toJSON(),body:s,duplex:"half",credentials:j?x:void 0});let _=await fetch(w,y);const C=qm&&(m==="stream"||m==="response");if(qm&&(u||C&&A)){const D={};["status","statusText","headers"].forEach(I=>{D[I]=_[I]});const P=oe.toFiniteNumber(_.headers.get("content-length")),[F,U]=u&&Tb(P,Fd(Db(u),!0))||[];_=new Response(kb(_.body,Mb,F,()=>{U&&U(),A&&A()}),D)}m=m||"text";let k=await Ud[oe.findKey(Ud,m)||"text"](_,n);return!C&&A&&A(),await new Promise((D,P)=>{Qw(D,P,{data:k,headers:Bs.from(_.headers),status:_.status,statusText:_.statusText,config:n,request:w})})}catch(j){throw A&&A(),j&&j.name==="TypeError"&&/Load failed|fetch/i.test(j.message)?Object.assign(new Ve("Network Error",Ve.ERR_NETWORK,n,w),{cause:j.cause||j}):Ve.from(j,j&&j.code,n,w)}}),Gm={http:u2,xhr:F2,fetch:Q2};oe.forEach(Gm,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const Lb=n=>`- ${n}`,Z2=n=>oe.isFunction(n)||n===null||n===!1,t1={getAdapter:n=>{n=oe.isArray(n)?n:[n];const{length:e}=n;let t,s;const i={};for(let l=0;l<e;l++){t=n[l];let c;if(s=t,!Z2(t)&&(s=Gm[(c=String(t)).toLowerCase()],s===void 0))throw new Ve(`Unknown adapter '${c}'`);if(s)break;i[c||"#"+l]=s}if(!s){const l=Object.entries(i).map(([u,h])=>`adapter ${u} `+(h===!1?"is not supported by the environment":"is not available in the build"));let c=e?l.length>1?`since :
`+l.map(Lb).join(`
`):" "+Lb(l[0]):"as no adapter specified";throw new Ve("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return s},adapters:Gm};function im(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new ll(null,n)}function Ob(n){return im(n),n.headers=Bs.from(n.headers),n.data=am.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),t1.getAdapter(n.adapter||$o.adapter)(n).then(function(s){return im(n),s.data=am.call(n,n.transformResponse,s),s.headers=Bs.from(s.headers),s},function(s){return Xw(s)||(im(n),s&&s.response&&(s.response.data=am.call(n,n.transformResponse,s.response),s.response.headers=Bs.from(s.response.headers))),Promise.reject(s)})}const s1="1.11.0",yu={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{yu[n]=function(s){return typeof s===n||"a"+(e<1?"n ":" ")+n}});const Pb={};yu.transitional=function(e,t,s){function i(l,c){return"[Axios v"+s1+"] Transitional option '"+l+"'"+c+(s?". "+s:"")}return(l,c,u)=>{if(e===!1)throw new Ve(i(c," has been removed"+(t?" in "+t:"")),Ve.ERR_DEPRECATED);return t&&!Pb[c]&&(Pb[c]=!0,console.warn(i(c," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(l,c,u):!0}};yu.spelling=function(e){return(t,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function K2(n,e,t){if(typeof n!="object")throw new Ve("options must be an object",Ve.ERR_BAD_OPTION_VALUE);const s=Object.keys(n);let i=s.length;for(;i-- >0;){const l=s[i],c=e[l];if(c){const u=n[l],h=u===void 0||c(u,l,n);if(h!==!0)throw new Ve("option "+l+" must be "+h,Ve.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Ve("Unknown option "+l,Ve.ERR_BAD_OPTION)}}const Rd={assertOptions:K2,validators:yu},Fn=Rd.validators;let Ii=class{constructor(e){this.defaults=e||{},this.interceptors={request:new _b,response:new _b}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const l=i.stack?i.stack.replace(/^.+\n/,""):"";try{s.stack?l&&!String(s.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+l):s.stack=l}catch{}}throw s}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=zi(this.defaults,t);const{transitional:s,paramsSerializer:i,headers:l}=t;s!==void 0&&Rd.assertOptions(s,{silentJSONParsing:Fn.transitional(Fn.boolean),forcedJSONParsing:Fn.transitional(Fn.boolean),clarifyTimeoutError:Fn.transitional(Fn.boolean)},!1),i!=null&&(oe.isFunction(i)?t.paramsSerializer={serialize:i}:Rd.assertOptions(i,{encode:Fn.function,serialize:Fn.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Rd.assertOptions(t,{baseUrl:Fn.spelling("baseURL"),withXsrfToken:Fn.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let c=l&&oe.merge(l.common,l[t.method]);l&&oe.forEach(["delete","get","head","post","put","patch","common"],w=>{delete l[w]}),t.headers=Bs.concat(c,l);const u=[];let h=!0;this.interceptors.request.forEach(function(A){typeof A.runWhen=="function"&&A.runWhen(t)===!1||(h=h&&A.synchronous,u.unshift(A.fulfilled,A.rejected))});const m=[];this.interceptors.response.forEach(function(A){m.push(A.fulfilled,A.rejected)});let p,x=0,y;if(!h){const w=[Ob.bind(this),void 0];for(w.unshift(...u),w.push(...m),y=w.length,p=Promise.resolve(t);x<y;)p=p.then(w[x++],w[x++]);return p}y=u.length;let v=t;for(x=0;x<y;){const w=u[x++],A=u[x++];try{v=w(v)}catch(N){A.call(this,N);break}}try{p=Ob.call(this,v)}catch(w){return Promise.reject(w)}for(x=0,y=m.length;x<y;)p=p.then(m[x++],m[x++]);return p}getUri(e){e=zi(this.defaults,e);const t=Zw(e.baseURL,e.url,e.allowAbsoluteUrls);return Gw(t,e.params,e.paramsSerializer)}};oe.forEach(["delete","get","head","options"],function(e){Ii.prototype[e]=function(t,s){return this.request(zi(s||{},{method:e,url:t,data:(s||{}).data}))}});oe.forEach(["post","put","patch"],function(e){function t(s){return function(l,c,u){return this.request(zi(u||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:l,data:c}))}}Ii.prototype[e]=t(),Ii.prototype[e+"Form"]=t(!0)});let J2=class n1{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(l){t=l});const s=this;this.promise.then(i=>{if(!s._listeners)return;let l=s._listeners.length;for(;l-- >0;)s._listeners[l](i);s._listeners=null}),this.promise.then=i=>{let l;const c=new Promise(u=>{s.subscribe(u),l=u}).then(i);return c.cancel=function(){s.unsubscribe(l)},c},e(function(l,c,u){s.reason||(s.reason=new ll(l,c,u),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=s=>{e.abort(s)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new n1(function(i){e=i}),cancel:e}}};function eC(n){return function(t){return n.apply(null,t)}}function tC(n){return oe.isObject(n)&&n.isAxiosError===!0}const Ym={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ym).forEach(([n,e])=>{Ym[e]=n});function a1(n){const e=new Ii(n),t=Lw(Ii.prototype.request,e);return oe.extend(t,Ii.prototype,e,{allOwnKeys:!0}),oe.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return a1(zi(n,i))},t}const Ft=a1($o);Ft.Axios=Ii;Ft.CanceledError=ll;Ft.CancelToken=J2;Ft.isCancel=Xw;Ft.VERSION=s1;Ft.toFormData=gu;Ft.AxiosError=Ve;Ft.Cancel=Ft.CanceledError;Ft.all=function(e){return Promise.all(e)};Ft.spread=eC;Ft.isAxiosError=tC;Ft.mergeConfig=zi;Ft.AxiosHeaders=Bs;Ft.formToJSON=n=>Ww(oe.isHTMLForm(n)?new FormData(n):n);Ft.getAdapter=t1.getAdapter;Ft.HttpStatusCode=Ym;Ft.default=Ft;const{Axios:aI,AxiosError:iI,CanceledError:rI,isCancel:lI,CancelToken:oI,VERSION:cI,all:dI,Cancel:uI,isAxiosError:hI,spread:fI,toFormData:mI,AxiosHeaders:pI,HttpStatusCode:gI,formToJSON:xI,getAdapter:yI,mergeConfig:bI}=Ft,xe=Ft.create({baseURL:"https://gys-hrms.vercel.app/api",headers:{"Content-Type":"application/json"}});xe.interceptors.request.use(n=>{const e=localStorage.getItem("token");return e&&(n.headers.Authorization=`Bearer ${e}`),n},n=>Promise.reject(n));const i1=E.createContext(),sC=({children:n})=>{const[e,t]=E.useState(null),[s,i]=E.useState(localStorage.getItem("token")||null),[l,c]=E.useState(!0),u=async(y,v)=>{const w=await xe.post("/auth/login",{email:y,password:v});i(w.data.token),localStorage.setItem("token",w.data.token),t(w.data.user)},h=()=>{t(null),i(null),localStorage.removeItem("token")},m=async y=>(await xe.post("/auth/forgot-password",{email:y})).data,p=async(y,v)=>(await xe.post("/auth/verify-otp",{email:y,otp:v})).data,x=async(y,v,w)=>(await xe.post("/auth/reset-password",{email:y,otp:v,password:w})).data;return E.useEffect(()=>{(async()=>{if(s)try{const v=await xe.get("/auth/me",{headers:{Authorization:`Bearer ${s}`}});t(v.data)}catch{h()}c(!1)})()},[s]),r.jsx(i1.Provider,{value:{user:e,token:s,loading:l,login:u,logout:h,requestPasswordReset:m,verifyOtp:p,resetPassword:x},children:n})},rs=()=>E.useContext(i1);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nC=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),aC=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),Ib=n=>{const e=aC(n);return e.charAt(0).toUpperCase()+e.slice(1)},r1=(...n)=>n.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim(),iC=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lC=E.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:i="",children:l,iconNode:c,...u},h)=>E.createElement("svg",{ref:h,...rC,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:r1("lucide",i),...!l&&!iC(u)&&{"aria-hidden":"true"},...u},[...c.map(([m,p])=>E.createElement(m,p)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=(n,e)=>{const t=E.forwardRef(({className:s,...i},l)=>E.createElement(lC,{ref:l,iconNode:e,className:r1(`lucide-${nC(Ib(n))}`,`lucide-${n}`,s),...i}));return t.displayName=Ib(n),t};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oC=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],cC=tt("arrow-left",oC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],rm=tt("arrow-right",dC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uC=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],hC=tt("camera",uC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fC=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Js=tt("calendar",fC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mC=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],lm=tt("chart-column",mC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pC=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],fo=tt("chevron-down",pC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gC=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],xC=tt("chevron-left",gC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yC=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],bC=tt("chevron-right",yC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vC=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],mo=tt("chevron-up",vC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ns=tt("circle-alert",wC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AC=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],bs=tt("circle-check-big",AC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],Bb=tt("circle-user",NC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ks=tt("circle-x",jC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SC=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],pn=tt("clock",SC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EC=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],$d=tt("coffee",EC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _C=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],om=tt("credit-card",_C);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CC=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],TC=tt("dollar-sign",CC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DC=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Wm=tt("eye-off",DC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RC=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],To=tt("eye",RC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kC=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],bo=tt("file-text",kC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MC=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],l1=tt("funnel",MC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LC=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Vd=tt("heart",LC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OC=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],PC=tt("loader",OC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IC=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],$r=tt("lock",IC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BC=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],HC=tt("log-out",BC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zC=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],o1=tt("mail",zC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FC=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],c1=tt("menu",FC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Bi=tt("plus",UC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $C=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Fi=tt("refresh-cw",$C);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VC=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],kp=tt("search",VC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Xm=tt("square-pen",qC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Mp=tt("trash-2",GC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],WC=tt("user-check",YC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XC=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],d1=tt("user",XC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],qd=tt("users",QC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Vo=tt("x",ZC),KC=()=>{const[n,e]=E.useState(""),[t,s]=E.useState(""),[i,l]=E.useState(!1),[c,u]=E.useState(!1),[h,m]=E.useState(""),{login:p}=rs(),x=il(),y=async v=>{if(v.preventDefault(),m(""),u(!0),!n||!t){m("Please fill in all fields"),u(!1);return}if(!n.includes("@")){m("Please enter a valid email address"),u(!1);return}try{await p(n,t);const w=JSON.parse(localStorage.getItem("user"))?.role;x(w==="admin"?"/admin":w==="hr"?"/hr":"/employee")}catch(w){m(w.response?.data?.message||"Invalid credentials")}finally{u(!1)}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 flex items-center justify-center px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"max-w-md w-full space-y-8",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto h-16 w-16 bg-[#104774] rounded-full flex items-center justify-center mb-4",children:r.jsx($r,{className:"h-8 w-8 text-white"})}),r.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome back"}),r.jsx("p",{className:"text-gray-600",children:"Please sign in to your account"})]}),r.jsx("div",{className:"bg-white py-8 px-6 shadow-xl rounded-xl border border-gray-100",children:r.jsxs("form",{onSubmit:y,className:"space-y-6",children:[h&&r.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[r.jsx(ns,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),r.jsx("span",{className:"text-sm text-red-700",children:h})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email address"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(o1,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] focus:border-[#104774] focus:z-10 sm:text-sm transition-colors duration-200",placeholder:"Enter your email",value:n,onChange:v=>e(v.target.value),disabled:c})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx($r,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"password",name:"password",type:i?"text":"password",autoComplete:"current-password",required:!0,className:"appearance-none relative block w-full pl-10 pr-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] focus:border-[#104774] focus:z-10 sm:text-sm transition-colors duration-200",placeholder:"Enter your password",value:t,onChange:v=>s(v.target.value),disabled:c}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>l(!i),disabled:c,children:i?r.jsx(Wm,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):r.jsx(To,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),r.jsx("div",{className:"flex items-center justify-end",children:r.jsx("button",{onClick:()=>x("/forgot-password"),type:"button",className:"text-sm text-[#104774] hover:text-[#0d385d] font-medium transition-colors duration-200",children:"Forgot your password?"})}),r.jsx("div",{children:r.jsx("button",{type:"submit",disabled:c,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-[#104774] hover:bg-[#0d385d] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#104774] disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105 active:scale-95",children:c?r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),r.jsx("span",{children:"Signing in..."})]}):"Sign in"})})]})})]})})},JC="/assets/gys_logo-Blem-OFh.png",Lp=({closeSidebar:n})=>{const{user:e,logout:t}=rs(),s=ba();if(!e)return null;const i={admin:[{label:"Dashboard",path:"/admin",icon:lm},{label:"Manage Employees",path:"/admin/manage-employees",icon:qd},{label:"Attendance Management",path:"/admin/attendance",icon:pn},{label:"Payroll Approval",path:"/admin/payroll-approval",icon:om},{label:"Calendar",path:"/admin/calendar",icon:Js},{label:"Leaves Management",path:"/admin/leaves",icon:bo}],hr:[{label:"Dashboard",path:"/hr",icon:lm},{label:"Manage Employees",path:"/hr/manage-employees",icon:qd},{label:"Attendance Management",path:"/hr/attendance",icon:pn},{label:"Payroll",path:"/hr/payroll",icon:om},{label:"Leaves Management",path:"/hr/leaves",icon:bo},{label:"My Profile",path:"/hr/profile",icon:Bb},{label:"Calendar",path:"/hr/calendar",icon:Js}],employee:[{label:"Dashboard",path:"/employee",icon:lm},{label:"My Attendance",path:"/employee/attendance",icon:pn},{label:"My Leaves",path:"/employee/leaves",icon:bo},{label:"Payslip",path:"/employee/payslip",icon:om},{label:"My Profile",path:"/employee/profile",icon:Bb},{label:"Calendar",path:"/employee/calendar",icon:Js}]};return r.jsxs("div",{className:"bg-white shadow-lg w-48 sm:w-56 lg:w-60 min-h-screen flex flex-col relative transition-all duration-200",children:[r.jsxs("div",{className:"px-3 py-2 border-b border-gray-100 flex items-center justify-between",children:[r.jsx("div",{className:"flex items-center min-w-0 flex-1",children:r.jsx("img",{src:JC,alt:"GYS Logo",className:"h-20 w-auto object-contain max-w-full"})}),r.jsx("button",{onClick:n,className:"lg:hidden text-gray-600 hover:text-gray-900 p-1 rounded-md hover:bg-gray-100 transition-colors flex-shrink-0",children:r.jsx("span",{className:"text-base",children:"✕"})})]}),r.jsx("div",{className:"p-3 border-b border-gray-100",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[e?.avatarUrl?r.jsx("img",{src:e?.avatarUrl,alt:e.firstName,className:"w-10 h-10 rounded-full object-cover border border-gray-200 flex-shrink-0"}):r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-gray-300 to-gray-400 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(d1,{size:16,className:"text-gray-600"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-semibold text-gray-800 text-sm truncate",children:`${e?.firstName||""} ${e?.lastName||""}`}),r.jsx("div",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full mt-1 truncate",children:e?.designation?.toUpperCase()||e?.role?.toUpperCase()})]})]})}),r.jsx("nav",{className:"flex-1 p-2 space-y-1 overflow-y-auto",children:i[e.role]?.map((l,c)=>{const u=l.icon,h=s.pathname===l.path;return r.jsxs(Cp,{to:l.path,onClick:n,className:`w-full flex items-center px-3 py-2 rounded-md transition-all duration-200 group min-h-[2.25rem] ${h?"bg-gradient-to-r from-[#104774] to-[#0d3a61] text-white shadow-sm scale-[1.02]":"text-gray-600 hover:bg-gray-50 hover:text-[#104774]"}`,children:[r.jsx(u,{size:16,className:`mr-3 transition-transform duration-200 flex-shrink-0 w-4 h-4 ${h?"scale-110":"group-hover:scale-110"}`}),r.jsx("span",{className:"font-medium text-sm truncate flex-1 leading-tight",children:l.label})]},c)})}),r.jsx("div",{className:"p-3 border-t border-gray-100 mt-4",children:r.jsxs("button",{onClick:t,className:"w-full flex items-center px-3 py-2 text-red-600 hover:bg-red-50 rounded-md transition-all duration-200 group min-h-[2.25rem]",children:[r.jsx(HC,{size:16,className:"mr-3 transition-transform duration-200 group-hover:scale-110 flex-shrink-0 w-4 h-4"}),r.jsx("span",{className:"font-medium text-sm truncate",children:"Log Out"})]})})]})},Op=({onMenuClick:n})=>{const{user:e}=rs();if(!e)return null;const t=new Date().toLocaleDateString("en-US",{weekday:"long",day:"numeric",month:"short"}),s=new Date().getHours();let i="Hello";return s<12?i="Good Morning":s<18?i="Good Afternoon":i="Good Evening",r.jsxs("div",{className:"sticky top-0 z-50 bg-gradient-to-r from-white to-gray-50 px-3 py-2 flex justify-between items-center border-b border-gray-200 shadow-sm min-h-[56px]",children:[r.jsxs("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:[r.jsx("button",{onClick:n,className:"lg:hidden p-1.5 rounded-md text-gray-700 hover:bg-gray-100 transition-colors flex-shrink-0",children:r.jsx(c1,{size:18,className:"w-5 h-5"})}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("h1",{className:"text-sm font-bold text-gray-800 leading-tight truncate",children:[i,", ",e.firstName]}),r.jsx("p",{className:"text-xs text-gray-500 font-medium truncate",children:t})]})]}),r.jsx("div",{className:"flex-shrink-0 ml-3",children:r.jsx("span",{className:"px-2 py-0.5 bg-gradient-to-r from-[#104774] to-[#0d3a61] text-white rounded-full text-xs font-medium shadow whitespace-nowrap",children:e.role.toUpperCase()})})]})},eT=()=>{const[n,e]=E.useState(!1);return r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:`fixed inset-0 z-40 lg:static lg:translate-x-0 transition-transform duration-300 ${n?"translate-x-0":"-translate-x-full"}`,children:r.jsx(Lp,{closeSidebar:()=>e(!1)})}),r.jsxs("div",{className:"flex-1 flex flex-col min-h-screen",children:[r.jsx(Op,{onMenuClick:()=>e(!0)}),r.jsx("div",{className:"p-6 flex-1 bg-gray-50 overflow-y-auto",children:r.jsx(Sp,{})})]})]})},tT=()=>{const[n,e]=E.useState(!1);return r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:`fixed inset-0 z-40 lg:static lg:translate-x-0 transition-transform duration-300 ${n?"translate-x-0":"-translate-x-full"}`,children:r.jsx(Lp,{closeSidebar:()=>e(!1)})}),r.jsxs("div",{className:"flex-1 flex flex-col min-h-screen",children:[r.jsx(Op,{onMenuClick:()=>e(!0)}),r.jsx("div",{className:"p-6 flex-1 bg-gray-50 overflow-y-auto",children:r.jsx(Sp,{})})]})]})},sT=()=>{const[n,e]=E.useState(!1);return r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:`fixed inset-0 z-40 lg:static lg:translate-x-0 transition-transform duration-300 ${n?"translate-x-0":"-translate-x-full"}`,children:r.jsx(Lp,{closeSidebar:()=>e(!1)})}),r.jsxs("div",{className:"flex-1 flex flex-col min-h-screen",children:[r.jsx(Op,{onMenuClick:()=>e(!0)}),r.jsx("div",{className:"p-6 flex-1 bg-gray-50 overflow-y-auto",children:r.jsx(Sp,{})})]})]})},nT=({formData:n,errors:e,handleInputChange:t,isEditMode:s=!1})=>{const i=l=>{if(!l)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(l))return l;const c=new Date(l);return isNaN(c.getTime())?"":c.toISOString().split("T")[0]};return r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Job Information"}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enter the employee's job details"}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Designation *"}),r.jsx("input",{type:"text",value:n.jobInfo.designation,onChange:l=>t("jobInfo","designation",l.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.designation?"border-red-500":"border-gray-300"}`,placeholder:"e.g., Software Developer"}),e.designation&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.designation})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department *"}),r.jsxs("select",{value:n.jobInfo.department,onChange:l=>t("jobInfo","department",l.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.department?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select Department"}),r.jsx("option",{value:"Software Developer",children:"Software Developer"}),r.jsx("option",{value:"UI",children:"UI/UX Designer"}),r.jsx("option",{value:"HR",children:"Human Resources"}),r.jsx("option",{value:"Finance",children:"Finance"}),r.jsx("option",{value:"Marketing",children:"Marketing"}),r.jsx("option",{value:"Sales",children:"Sales"}),r.jsx("option",{value:"Operations",children:"Operations"})]}),e.department&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.department})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Joining *"}),r.jsx("input",{type:"date",value:i(n.jobInfo.dateOfJoining),onChange:l=>t("jobInfo","dateOfJoining",l.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.dateOfJoining?"border-red-500":"border-gray-300"}`,disabled:s}),e.dateOfJoining&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.dateOfJoining}),s&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Joining date cannot be changed"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment Type"}),r.jsxs("select",{value:n.jobInfo.employmentType||"full-time",onChange:l=>t("jobInfo","employmentType",l.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",children:[r.jsx("option",{value:"full-time",children:"Full Time"}),r.jsx("option",{value:"intern",children:"Intern"}),r.jsx("option",{value:"part-time",children:"Part Time"}),r.jsx("option",{value:"contract",children:"Contract"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Work Mode"}),r.jsxs("select",{value:n.jobInfo.workMode||"work-from-home",onChange:l=>t("jobInfo","workMode",l.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",children:[r.jsx("option",{value:"work-from-home",children:"Work From Home"}),r.jsx("option",{value:"work-from-office",children:"Work From Office"}),r.jsx("option",{value:"hybrid",children:"Hybrid"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shift Start Time"}),r.jsx("input",{type:"time",value:n.jobInfo.shiftTiming?.start||"",onChange:l=>{const c={...n.jobInfo.shiftTiming,start:l.target.value};t("jobInfo","shiftTiming",c)},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shift End Time"}),r.jsx("input",{type:"time",value:n.jobInfo.shiftTiming?.end||"",onChange:l=>{const c={...n.jobInfo.shiftTiming,end:l.target.value};t("jobInfo","shiftTiming",c)},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent"})]})]})]})},aT=({formData:n,errors:e,handlePasswordChange:t,handleRoleChange:s,isEditMode:i=!1})=>r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Account Credentials"}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:i?"Update employee's login credentials":"Set up login credentials for the employee"}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),r.jsx("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-300",children:r.jsx("span",{className:"text-gray-800",children:n.basicInfo.email})}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"This will be the username for login"})]}),!i&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Create Password *"}),r.jsx("input",{type:"password",value:n.password,onChange:t,className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.password?"border-red-500":"border-gray-300"}`,placeholder:"Enter secure password"}),e.password&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.password}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Minimum 6 characters required"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Role"}),r.jsxs("select",{value:n.role,onChange:s,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",children:[r.jsx("option",{value:"employee",children:"Employee"}),r.jsx("option",{value:"hr",children:"HR Manager"})]}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:n.role==="hr"?"HR managers can manage employees and leave requests":"Employees can view their profile and submit leave requests"})]}),!i&&r.jsxs("div",{className:"bg-[#104774]/10 p-4 rounded-lg border border-[#104774]/40",children:[r.jsx("h4",{className:"font-semibold text-[#104774] mb-2",children:"📧 Login Instructions"}),r.jsx("p",{className:"text-sm text-[#104774]",children:"The employee will receive an email with these credentials to access their account on their joining date."})]})]}),iT=({formData:n,handleDocumentUpload:e,removeDocument:t,isEditMode:s=!1,uploadProgress:i={},uploadingDocs:l={}})=>{const[c,u]=E.useState(!0),[h,m]=E.useState(""),[p,x]=E.useState([]),y=[{id:"aadhar",label:"Aadhar Card",required:!0},{id:"pan",label:"PAN Card",required:!0},{id:"tenth",label:"10th Marksheet",required:!0},{id:"twelfth",label:"12th Marksheet",required:!0},{id:"bank",label:"Bank Passbook",required:!0}],v=[{id:"provisional",label:"Provisional Certificate",required:!0},{id:"graduation",label:"Graduation Marksheet",required:!0}],w=j=>{u(j)},A=()=>{const j=(h||"").trim();if(!j)return alert("Enter a document name");const _=`custom_${Date.now()}`;x(C=>[...C,{id:_,label:j,required:!1}]),m("")},N=(j,_)=>{const C=n.basicInfo.documents||[];let k=C.find(P=>P.type===j);if(k)return k;const D=(_||"").toLowerCase().split(" ")[0];return k=C.find(P=>P.name&&P.name.toLowerCase().includes(D)||P.originalName&&P.originalName.toLowerCase().includes(D))||null,k};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Student Status"}),r.jsxs("div",{className:"flex space-x-4",children:[r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",checked:c,onChange:()=>w(!0),className:"form-radio text-[#104774]"}),r.jsx("span",{className:"ml-2",children:"Student"})]}),r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",checked:!c,onChange:()=>w(!1),className:"form-radio text-[#104774]"}),r.jsx("span",{className:"ml-2",children:"Graduated"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Required Documents"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.map(j=>r.jsx(cm,{doc:j,uploadedFile:N(j.id,j.label),handleDocumentUpload:e,removeDocument:t,isEditMode:s,uploadProgress:i[j.id]||0,isUploading:l[j.id]||!1},j.id)),!c&&v.map(j=>r.jsx(cm,{doc:j,uploadedFile:N(j.id,j.label),handleDocumentUpload:e,removeDocument:t,isEditMode:s,uploadProgress:i[j.id]||0,isUploading:l[j.id]||!1},j.id)),p.map(j=>r.jsx(cm,{doc:j,uploadedFile:N(j.id,j.label),handleDocumentUpload:e,removeDocument:t,isEditMode:s,uploadProgress:i[j.id]||0,isUploading:l[j.id]||!1},j.id))]}),r.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[r.jsx("input",{type:"text",value:h,onChange:j=>m(j.target.value),placeholder:"New document name (e.g. Driving Licence)",className:"w-[80%] p-2 border border-gray-300 rounded-lg"}),r.jsx("button",{type:"button",onClick:A,className:"px-4 py-2 bg-[#104774] text-white rounded-lg",children:"+ Add Document"})]})]})]})},cm=({doc:n,uploadedFile:e,handleDocumentUpload:t,removeDocument:s,isEditMode:i=!1,uploadProgress:l=0,isUploading:c=!1})=>{const u=`document-${n.id}`,h=e&&(e.displayName||e.name)||n.label||"Document";return r.jsxs("div",{className:"border border-gray-300 rounded-lg p-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[n.label," ",n.required&&r.jsx("span",{className:"text-red-500",children:"*"})]}),e?r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-gray-100 rounded-lg mr-2",children:r.jsx("i",{className:"far fa-file text-gray-600"})}),r.jsx("span",{className:"text-sm text-gray-700 truncate",children:h})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("a",{href:e.url,target:"_blank",rel:"noreferrer",className:"text-sm text-[#104774] underline",children:"View"}),r.jsx("button",{type:"button",onClick:()=>s(e),className:"text-red-500 hover:text-red-700 text-sm",children:"remove"})]})]}):r.jsxs("div",{children:[r.jsx("input",{type:"file",id:u,onChange:m=>t(m,n),className:"hidden",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",disabled:c}),r.jsx("label",{htmlFor:u,className:`cursor-pointer flex items-center justify-center p-3 border border-dashed border-gray-300 rounded-lg text-center transition-colors ${c?"opacity-50":"hover:border-[#104774]"}`,children:c?r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-8 h-8 border-2 border-[#104774] border-t-transparent rounded-full animate-spin mx-auto mb-2"}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Uploading... ",l,"%"]})]}):r.jsxs("div",{children:[r.jsx("i",{className:"far fa-cloud-upload text-gray-400 text-xl mb-1"}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Upload ",n.label]}),r.jsx("p",{className:"text-xs text-gray-400",children:"PDF, JPG, PNG (Max 5MB)"})]})})]})]})},rT=({formData:n,errors:e,handleInputChange:t,handleDocumentUpload:s,removeDocument:i,profileImage:l,handleProfileImageUpload:c,removeProfileImage:u,isEditMode:h=!1,uploadProgress:m,uploadingDocs:p})=>{const x=y=>{if(!y)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(y))return y;const v=new Date(y);return isNaN(v.getTime())?"":v.toISOString().split("T")[0]};return r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Basic Information"}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enter the employee's personal details"}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Profile Photo"}),r.jsxs("div",{className:"flex items-center space-x-4",children:[l?r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:l.url||l,alt:"Profile preview",className:"w-20 h-20 rounded-full object-cover border-2 border-gray-300"}),!h&&r.jsx("button",{type:"button",onClick:u,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 text-xs",children:"✕"})]}):r.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-200 flex items-center justify-center",children:r.jsx("span",{className:"text-gray-500 text-sm",children:"No image"})}),!h&&r.jsxs("div",{children:[r.jsx("input",{type:"file",accept:"image/*",onChange:c,className:"hidden",id:"profile-image-upload",disabled:p.profile}),r.jsx("label",{htmlFor:"profile-image-upload",className:`cursor-pointer text-white px-4 py-2 rounded-lg text-sm transition-colors ${p.profile?"bg-gray-400":"bg-[#104774] hover:bg-[#104774]"}`,children:p.profile?`Uploading... ${m.profile||0}%`:l?"Change Photo":"Upload Photo"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG (Max 5MB)"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),r.jsx("input",{type:"text",value:n.basicInfo.firstName,onChange:y=>t("basicInfo","firstName",y.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.firstName?"border-red-500":"border-gray-300"}`,placeholder:"Enter first name"}),e.firstName&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.firstName})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),r.jsx("input",{type:"text",value:n.basicInfo.lastName,onChange:y=>t("basicInfo","lastName",y.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Enter last name"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),r.jsx("input",{type:"email",value:n.basicInfo.email,onChange:y=>t("basicInfo","email",y.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.email?"border-red-500":"border-gray-300"}`,placeholder:"employee@company.com",disabled:h}),e.email&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.email}),h&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),r.jsx("input",{type:"tel",value:n.basicInfo.phone,onChange:y=>t("basicInfo","phone",y.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.phone?"border-red-500":"border-gray-300"}`,placeholder:"+91 1234567890"}),e.phone&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.phone})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth *"}),r.jsx("input",{type:"date",value:x(n.basicInfo.dob),max:new Date(new Date().setFullYear(new Date().getFullYear()-16)).toISOString().split("T")[0],onChange:y=>t("basicInfo","dob",y.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.dob?"border-red-500":"border-gray-300"}`}),e.dob&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.dob})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),r.jsxs("select",{value:n.basicInfo.gender,onChange:y=>t("basicInfo","gender",y.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",children:[r.jsx("option",{value:"male",children:"Male"}),r.jsx("option",{value:"female",children:"Female"}),r.jsx("option",{value:"other",children:"Other"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),r.jsx("textarea",{value:n.basicInfo.address||"",onChange:y=>t("basicInfo","address",y.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Enter complete address",rows:"3"})]}),r.jsx(iT,{formData:n,handleDocumentUpload:s,removeDocument:i,isEditMode:h,uploadProgress:m,uploadingDocs:p})]})},lT=({formData:n,errors:e,handleInputChange:t,handleAddAllowance:s,handleRemoveAllowance:i,handleAddDeduction:l,handleRemoveDeduction:c,isEditMode:u=!1})=>{const h=parseFloat(n.payrollInfo.basic)||0,m=parseFloat(n.payrollInfo.hra)||0,p=parseFloat(n.payrollInfo.tax)||0,x=Math.round(h*p/100*100)/100,y=n.payrollInfo.allowances.reduce((N,j)=>N+(parseFloat(j.amount)||0),0),v=n.payrollInfo.deductions.reduce((N,j)=>N+(parseFloat(j.amount)||0),0)+x,w=h+m+y,A=w-v;return r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Payroll Information"}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Set up the employee's salary structure"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Basic Salary *"}),r.jsx("input",{type:"number",value:n.payrollInfo.basic,onChange:N=>t("payrollInfo","basic",N.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.basic?"border-red-500":"border-gray-300"}`,placeholder:"0.00",min:"0"}),e.basic&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.basic})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HRA"}),r.jsx("input",{type:"number",value:n.payrollInfo.hra,onChange:N=>t("payrollInfo","hra",N.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"0.00",min:"0"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax (%)"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:n.payrollInfo.tax,onChange:N=>t("payrollInfo","tax",N.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Tax percentage e.g. 2"})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Allowances"}),r.jsx("button",{type:"button",onClick:s,className:"text-sm text-[#104774] hover:text-[#104774] font-medium",children:"+ Add Allowance"})]}),n.payrollInfo.allowances.map((N,j)=>r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-2",children:[r.jsx("input",{type:"text",value:N.title,onChange:_=>{const C=[...n.payrollInfo.allowances];C[j].title=_.target.value,t("payrollInfo","allowances",C)},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Allowance title"}),r.jsx("input",{type:"number",value:N.amount,onChange:_=>{const C=[...n.payrollInfo.allowances];C[j].amount=_.target.value,t("payrollInfo","allowances",C)},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Amount",min:"0"}),r.jsx("button",{type:"button",onClick:()=>i(j),className:"px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200",children:"Remove"})]},j))]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Deductions"}),r.jsx("button",{type:"button",onClick:l,className:"text-sm text-[#104774] hover:text-[#104774] font-medium",children:"+ Add Deduction"})]}),n.payrollInfo.deductions.map((N,j)=>r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-2",children:[r.jsx("input",{type:"text",value:N.title,onChange:_=>{const C=[...n.payrollInfo.deductions];C[j].title=_.target.value,t("payrollInfo","deductions",C)},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Deduction title"}),r.jsx("input",{type:"number",value:N.amount,onChange:_=>{const C=[...n.payrollInfo.deductions];C[j].amount=_.target.value,t("payrollInfo","deductions",C)},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Amount",min:"0"}),r.jsx("button",{type:"button",onClick:()=>c(j),className:"px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200",children:"Remove"})]},j))]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payroll Month *"}),r.jsx("input",{type:"month",value:n.payrollInfo.month,onChange:N=>t("payrollInfo","month",N.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.month?"border-red-500":"border-gray-300"}`}),e.month&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.month})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mt-4",children:[r.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Salary Summary"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Basic Salary:"}),r.jsxs("span",{className:"font-medium",children:["₹",h.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"HRA:"}),r.jsxs("span",{className:"font-medium",children:["₹",m.toLocaleString()]})]}),n.payrollInfo.allowances.map((N,j)=>r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-gray-600",children:[N.title||"Allowance",":"]}),r.jsxs("span",{className:"font-medium",children:["₹",(parseFloat(N.amount)||0).toLocaleString()]})]},j)),r.jsxs("div",{className:"flex justify-between border-t border-gray-200 pt-2",children:[r.jsx("span",{className:"text-gray-600",children:"Total Earnings:"}),r.jsxs("span",{className:"font-medium text-green-600",children:["₹",w.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-gray-600",children:["Tax Deduction (",p,"%):"]}),r.jsxs("span",{className:"font-medium text-red-600",children:["-₹",x.toLocaleString()]})]}),n.payrollInfo.deductions.map((N,j)=>r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-gray-600",children:[N.title||"Deduction",":"]}),r.jsxs("span",{className:"font-medium text-red-600",children:["-₹",(parseFloat(N.amount)||0).toLocaleString()]})]},j)),r.jsxs("div",{className:"flex justify-between border-t border-gray-200 pt-2",children:[r.jsx("span",{className:"text-gray-800 font-semibold",children:"Net Pay:"}),r.jsxs("span",{className:"font-bold text-[#104774]",children:["₹",A.toLocaleString()]})]})]})]})]})},oT=({onClose:n,employee:e,isEditMode:t=!1})=>{const[s,i]=E.useState(1),[l,c]=E.useState({basicInfo:{firstName:"",lastName:"",email:"",phone:"",dob:"",gender:"other",address:"",documents:[],profileImage:null},jobInfo:{designation:"",department:"",dateOfJoining:"",employmentType:"full-time",workMode:"work-from-home",shiftTiming:{start:"",end:""}},payrollInfo:{basic:"",hra:"",tax:"",allowances:[],deductions:[],month:new Date().toISOString().slice(0,7),status:"draft"},password:"",role:"employee"}),[u,h]=E.useState({}),[m,p]=E.useState(!1),[x,y]=E.useState(null),[v,w]=E.useState({}),[A,N]=E.useState({});E.useEffect(()=>{if(t&&e){const B=(e.documents||[]).map(T=>({type:T.type||T.docType||null,name:T.name||T.originalName||T.filename||T.fileName||T._id||"",originalName:T.originalName||T.name||null,url:T.url||T.path||T.secure_url||T.link||"",fileType:T.fileType||T.type||null,uploadedAt:T.uploadedAt||T.createdAt||null,raw:T}));c(T=>({...T,basicInfo:{firstName:e.firstName||"",lastName:e.lastName||"",email:e.user?.email||"",phone:e.phone||"",dob:e.dob||"",gender:e.gender||"other",address:e.address||"",documents:B||[],profileImage:e.avatarUrl?{url:e.avatarUrl}:null},jobInfo:{designation:e.designation||"",department:e.department||"",dateOfJoining:e.dateOfJoining||"",employmentType:e.employmentType||"full-time",workMode:e.workMode||"work-from-home",shiftTiming:e.shiftTiming||{start:"",end:""}},role:e.user?.role||"employee",payrollInfo:{...T.payrollInfo,basic:e.payrollInfo?.basic??T.payrollInfo.basic,hra:e.payrollInfo?.hra??T.payrollInfo.hra,tax:e.payrollInfo?.tax??T.payrollInfo.tax,allowances:e.payrollInfo?.allowances||T.payrollInfo.allowances,deductions:e.payrollInfo?.deductions||T.payrollInfo.deductions,month:e.payrollInfo?.month||T.payrollInfo.month,status:e.payrollInfo?.status||T.payrollInfo.status}})),e.avatarUrl&&y({url:e.avatarUrl})}},[t,e]);const j=async B=>{try{const T=new FormData;return B.forEach(M=>T.append("documents",M.file)),B.forEach(M=>T.append("types[]",M.type||"")),B.forEach(M=>T.append("originalNames[]",M.name||M.file.name)),(await xe.post("/upload-files/upload",T,{onUploadProgress:M=>{if(M.total){const O=Math.round(M.loaded*100/M.total);console.log("overall upload:",O,"%")}}})).data.files.map((M,O)=>({type:M.type||B[O]?.type||null,originalName:M.originalName||M.name||B[O]?.name,url:M.url||M.secure_url||M.path||"",raw:M}))}catch(T){throw console.error("File upload error (frontend):",T),T.response?(console.error("Server response:",T.response.status,T.response.data),T.response.status===413?new Error("File too large: Maximum size is 5MB"):new Error(T.response.data?.message||"Server error while uploading files")):T.request?new Error("Network error: Please check your connection"):new Error(T.message||"Failed to upload files")}},_=B=>{const T={};if(B===1){l.basicInfo.firstName.trim()||(T.firstName="First name is required"),l.basicInfo.email.trim()?/\S+@\S+\.\S+/.test(l.basicInfo.email)||(T.email="Invalid email format"):T.email="Email is required",l.basicInfo.phone.trim()||(T.phone="Phone number is required"),l.basicInfo.dob||(T.dob="Date of birth is required");const G=["aadhar","pan","tenth","twelfth","bank"],M=(l.basicInfo.documents||[]).map(ae=>ae.type);G.filter(ae=>!M.includes(ae)).length>0&&!t&&(T.documents="Please upload all required documents")}return B===2&&(l.jobInfo.designation.trim()||(T.designation="Designation is required"),l.jobInfo.department.trim()||(T.department="Department is required"),l.jobInfo.dateOfJoining||(T.dateOfJoining="Date of joining is required")),B===3&&((!l.payrollInfo.basic||l.payrollInfo.basic<=0)&&(T.basic="Valid basic salary is required"),l.payrollInfo.month||(T.month="Payroll month is required")),B===4&&!t&&(l.password.trim()?l.password.length<6&&(T.password="Password must be at least 6 characters"):T.password="Password is required"),h(T),Object.keys(T).length===0},C=()=>{_(s)&&i(B=>B+1)},k=()=>i(B=>Math.max(1,B-1)),D=(B,T,G)=>{c(M=>({...M,[B]:{...M[B],[T]:G}})),u[T]&&h(M=>({...M,[T]:""}))},P=B=>{const T=B.target.value;c(G=>({...G,password:T})),u.password&&h(G=>({...G,password:""}))},F=B=>{const T=B.target.value;c(G=>({...G,role:T}))},U=async(B,T)=>{const G=B.target.files?.[0];if(!G)return;const M=typeof T=="string"?T:T.id,O=typeof T=="object"?T.label:null;if(G.size>5*1024*1024){alert("File size must be less than 5MB"),B.target.value="";return}if(!["image/jpeg","image/png","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(G.type)){alert("Only JPEG, PNG, PDF, DOC, and DOCX files are allowed"),B.target.value="";return}N(ee=>({...ee,[M]:!0})),w(ee=>({...ee,[M]:0}));try{const ee=new FormData;ee.append("document",G);const pe=await xe.post("/upload-files/upload",ee,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:we=>{if(we.total){const Te=Math.round(we.loaded*100/we.total);w(ue=>({...ue,[M]:Te}))}}});if(pe.data?.success&&pe.data?.file){const we=pe.data.file,Te={type:M,name:O||we.originalName||G.name,originalName:we.originalName||G.name,url:we.url,fileType:we.type};c(ue=>{const He=(ue.basicInfo.documents||[]).filter(ze=>ze.type!==M);return{...ue,basicInfo:{...ue.basicInfo,documents:[...He,Te]}}})}else throw new Error("Invalid upload response")}catch(ee){console.error("Document upload failed:",ee),alert(ee.response?.data?.message||ee.message||"Upload failed")}finally{N(ee=>({...ee,[M]:!1})),w(ee=>({...ee,[M]:0})),B.target.value=""}},I=B=>{const T=typeof B=="string"?B:B&&(B.type||B.url||B.originalName||B.name);if(!window.confirm("Are you sure you want to remove this document?"))return;const G=(l.basicInfo.documents||[]).filter(M=>{if(!T)return!0;const O=M.type&&T&&M.type===T,ae=M.url&&T&&M.url===T,ee=M.originalName&&T&&M.originalName===T,pe=M.name&&T&&M.name===T;return!(O||ae||ee||pe)});c(M=>({...M,basicInfo:{...M.basicInfo,documents:G}}))},K=async B=>{const T=B.target.files[0];if(T){if(T.size>5*1024*1024){alert("Profile image must be less than 5MB");return}if(!T.type.startsWith("image/")){alert("Please select an image file");return}N(G=>({...G,profile:!0})),w(G=>({...G,profile:0}));try{const G=new FormData;G.append("document",T);const M=await xe.post("/upload-files/upload",G,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:O=>{if(O.total){const ae=Math.round(O.loaded*100/O.total);w(ee=>({...ee,profile:ae}))}}});if(M.data.success){const O=M.data.file,ae={name:O.originalName,url:O.url,fileType:O.type};y(ae),c(ee=>({...ee,basicInfo:{...ee.basicInfo,profileImage:{url:O.url}}}))}}catch(G){console.error("Profile image upload error:",G),alert("Profile image upload failed. Please try again.")}finally{N(G=>({...G,profile:!1})),w(G=>({...G,profile:0})),B.target.value=""}}},H=()=>{y(null),c(B=>({...B,basicInfo:{...B.basicInfo,profileImage:null}}))},X=()=>{c(B=>({...B,payrollInfo:{...B.payrollInfo,allowances:[...B.payrollInfo.allowances,{title:"",amount:0}]}}))},W=B=>{c(T=>({...T,payrollInfo:{...T.payrollInfo,allowances:T.payrollInfo.allowances.filter((G,M)=>M!==B)}}))},ce=()=>{c(B=>({...B,payrollInfo:{...B.payrollInfo,deductions:[...B.payrollInfo.deductions,{title:"",amount:0}]}}))},me=B=>{c(T=>({...T,payrollInfo:{...T.payrollInfo,deductions:T.payrollInfo.deductions.filter((G,M)=>M!==B)}}))},L=async()=>{if(_(4)){p(!0);try{let B=null;if(x&&x.file){const ee=new FormData;ee.append("document",x.file);const pe=await xe.post("/upload-files/upload",ee,{headers:{"Content-Type":"multipart/form-data"}});pe.data.file&&(B=pe.data.file)}let T=[];const G=(l.basicInfo.documents||[]).filter(ee=>!ee.url&&ee.file);G.length>0&&(T=await j(G));const M=(l.basicInfo.documents||[]).map(ee=>{const pe=T.find(we=>we.type===ee.type||we.originalName===ee.originalName);return pe?{type:pe.type,name:ee.name||pe.originalName,url:pe.url}:{type:ee.type,name:ee.name||ee.originalName||ee.name,url:ee.url}}),O={basicInfo:{...l.basicInfo,profileImage:B?{url:B.url}:l.basicInfo.profileImage,documents:M},jobInfo:l.jobInfo,payrollInfo:l.payrollInfo,password:l.password,role:l.role},ae=await xe.post("/employee/add",O);alert("Employee added successfully!"),n()}catch(B){console.error("Error adding employee:",B),alert(B.response?.data?.message||"Error adding employee")}finally{p(!1)}}},q=async()=>{if(_(4)){p(!0);try{let B=null;if(x&&x.file){const ee=new FormData;ee.append("document",x.file);const pe=await xe.post("/upload-files/upload",ee,{headers:{"Content-Type":"multipart/form-data"}});pe.data.file&&(B=pe.data.file)}let T=[];const G=(l.basicInfo.documents||[]).filter(ee=>!ee.url&&ee.file);G.length>0&&(T=await j(G));const M=(l.basicInfo.documents||[]).map(ee=>{const pe=T.find(we=>we.type===ee.type||we.originalName===ee.originalName);return pe?{type:pe.type,name:ee.name||pe.originalName,url:pe.url}:{type:ee.type,name:ee.name||ee.originalName||ee.name,url:ee.url}}),O={basicInfo:{...l.basicInfo,profileImage:B?{url:B.url}:l.basicInfo.profileImage,documents:M},jobInfo:l.jobInfo,payrollInfo:l.payrollInfo},ae=await xe.put(`/employee/update/${e._id}`,O);alert("Employee updated successfully!"),n()}catch(B){console.error("Error updating employee:",B),alert(B.response?.data?.message||"Error updating employee")}finally{p(!1)}}},V=s/4*100;return r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto mx-auto my-8 relative",children:[r.jsx("button",{onClick:n,className:"absolute top-4 right-4 z-10 bg-gray-200 hover:bg-gray-300 rounded-full p-2",children:"✕"}),r.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl",children:[r.jsx("div",{className:"flex justify-between items-center mb-4",children:r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:t?"Edit Employee":"Add New Employee"})}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:r.jsx("div",{className:"bg-[#104774] h-2 rounded-full transition-all duration-300",style:{width:`${V}%`}})}),r.jsx("div",{className:"flex justify-between mb-2",children:["Basic Info","Job Details","Payroll","Credentials"].map((B,T)=>r.jsx("div",{className:`text-xs font-medium ${s>T+1?"text-green-600":s===T+1?"text-[#104774]":"text-gray-500"}`,children:B},B))})]}),r.jsxs("div",{className:"p-6",children:[s===1&&r.jsx(rT,{formData:l,errors:u,handleInputChange:D,handleDocumentUpload:U,removeDocument:I,profileImage:x,handleProfileImageUpload:K,removeProfileImage:H,isEditMode:t,uploadProgress:v,uploadingDocs:A}),s===2&&r.jsx(nT,{formData:l,errors:u,handleInputChange:D,isEditMode:t}),s===3&&r.jsx(lT,{formData:l,errors:u,handleInputChange:D,handleAddAllowance:X,handleRemoveAllowance:W,handleAddDeduction:ce,handleRemoveDeduction:me,isEditMode:t}),s===4&&r.jsx(aT,{formData:l,errors:u,handlePasswordChange:P,handleRoleChange:F,isEditMode:t})]}),r.jsx("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 p-6 rounded-b-xl",children:r.jsxs("div",{className:"flex justify-between",children:[s>1?r.jsx("button",{onClick:k,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",disabled:m,children:"← Back"}):r.jsx("div",{}),s<4?r.jsx("button",{onClick:C,className:"px-6 py-3 bg-[#104774] text-white rounded-lg hover:bg-[#104774] transition-colors",children:"Next →"}):r.jsx("button",{onClick:t?q:L,disabled:m,className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-400 transition-colors",children:m?r.jsxs("span",{className:"flex items-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),t?"Updating...":"Creating..."]}):t?"Update Employee":"Create Employee"})]})})]})},js=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Qm=[.001,0,0,.001,0,0],dm=1.35,Qs={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ya={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},u1="pdfjs_internal_editor_",Fe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},st={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},cT={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},xs={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},kd={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Gt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Hr={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},bu={ERRORS:0,WARNINGS:1,INFOS:5},Gd={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},hd={moveTo:0,lineTo:1,curveTo:2,closePath:3},dT={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let vu=bu.WARNINGS;function uT(n){Number.isInteger(n)&&(vu=n)}function hT(){return vu}function wu(n){vu>=bu.INFOS&&console.log(`Info: ${n}`)}function Ue(n){vu>=bu.WARNINGS&&console.log(`Warning: ${n}`)}function xt(n){throw new Error(n)}function Wt(n,e){n||xt(e)}function fT(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function h1(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"&&(t.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),t.tryConvertEncoding))try{n=yT(n)}catch{}const s=e?URL.parse(n,e):URL.parse(n);return fT(s)?s:null}function f1(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&h1(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function et(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const Gi=(function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e})();class Hb extends Gi{constructor(e,t){super(e,"PasswordException"),this.code=t}}class um extends Gi{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Zm extends Gi{constructor(e){super(e,"InvalidPDFException")}}class Yd extends Gi{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class mT extends Gi{constructor(e){super(e,"FormatError")}}class Ja extends Gi{constructor(e){super(e,"AbortException")}}function m1(n){(typeof n!="object"||n?.length===void 0)&&xt("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const l=Math.min(i+t,e),c=n.subarray(i,l);s.push(String.fromCharCode.apply(null,c))}return s.join("")}function qo(n){typeof n!="string"&&xt("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function pT(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function gT(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function xT(){try{return new Function(""),!0}catch{return!1}}class fs{static get isLittleEndian(){return et(this,"isLittleEndian",gT())}static get isEvalSupported(){return et(this,"isEvalSupported",xT())}static get isOffscreenCanvasSupported(){return et(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return et(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return et(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return et(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const hm=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class Re{static makeHexColor(e,t,s){return`#${hm[e]}${hm[t]}${hm[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,s=0){const i=e[s],l=e[s+1];e[s]=i*t[0]+l*t[2]+t[4],e[s+1]=i*t[1]+l*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const i=t[0],l=t[1],c=t[2],u=t[3],h=t[4],m=t[5];for(let p=0;p<6;p+=2){const x=e[s+p],y=e[s+p+1];e[s+p]=x*i+y*c+h,e[s+p+1]=x*l+y*u+m}}static applyInverseTransform(e,t){const s=e[0],i=e[1],l=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/l,e[1]=(-s*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/l}static axialAlignedBoundingBox(e,t,s){const i=t[0],l=t[1],c=t[2],u=t[3],h=t[4],m=t[5],p=e[0],x=e[1],y=e[2],v=e[3];let w=i*p+h,A=w,N=i*y+h,j=N,_=u*x+m,C=_,k=u*v+m,D=k;if(l!==0||c!==0){const P=l*p,F=l*y,U=c*x,I=c*v;w+=U,j+=U,N+=I,A+=I,_+=P,D+=P,k+=F,C+=F}s[0]=Math.min(s[0],w,N,A,j),s[1]=Math.min(s[1],_,k,C,D),s[2]=Math.max(s[2],w,N,A,j),s[3]=Math.max(s[3],_,k,C,D)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],i=e[1],l=e[2],c=e[3],u=s**2+i**2,h=s*l+i*c,m=l**2+c**2,p=(u+m)/2,x=Math.sqrt(p**2-(u*m-h**2));t[0]=Math.sqrt(p+x||1),t[1]=Math.sqrt(p-x||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const l=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),c=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return l>c?null:[s,l,i,c]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,i,l){l[0]=Math.min(l[0],e,s),l[1]=Math.min(l[1],t,i),l[2]=Math.max(l[2],e,s),l[3]=Math.max(l[3],t,i)}static#e(e,t,s,i,l,c,u,h,m,p){if(m<=0||m>=1)return;const x=1-m,y=m*m,v=y*m,w=x*(x*(x*e+3*m*t)+3*y*s)+v*i,A=x*(x*(x*l+3*m*c)+3*y*u)+v*h;p[0]=Math.min(p[0],w),p[1]=Math.min(p[1],A),p[2]=Math.max(p[2],w),p[3]=Math.max(p[3],A)}static#t(e,t,s,i,l,c,u,h,m,p,x,y){if(Math.abs(m)<1e-12){Math.abs(p)>=1e-12&&this.#e(e,t,s,i,l,c,u,h,-x/p,y);return}const v=p**2-4*x*m;if(v<0)return;const w=Math.sqrt(v),A=2*m;this.#e(e,t,s,i,l,c,u,h,(-p+w)/A,y),this.#e(e,t,s,i,l,c,u,h,(-p-w)/A,y)}static bezierBoundingBox(e,t,s,i,l,c,u,h,m){m[0]=Math.min(m[0],e,u),m[1]=Math.min(m[1],t,h),m[2]=Math.max(m[2],e,u),m[3]=Math.max(m[3],t,h),this.#t(e,s,l,u,t,i,c,h,3*(-e+3*(s-l)+u),6*(e-2*s+l),3*(s-e),m),this.#t(e,s,l,u,t,i,c,h,3*(-t+3*(i-c)+h),6*(t-2*i+c),3*(i-t),m)}}function yT(n){return decodeURIComponent(escape(n))}let fm=null,zb=null;function bT(n){return fm||(fm=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,zb=new Map([["ﬅ","ſt"]])),n.replaceAll(fm,(e,t,s)=>t?t.normalize("NFKC"):zb.get(s))}function p1(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),m1(n)}const Pp="pdfjs_internal_id_";function vT(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,i,...l]=t;if(!n(s)&&!Number.isInteger(s)||!e(i))return!1;const c=l.length;let u=!0;switch(i.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const h of l)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function Ss(n,e,t){return Math.min(Math.max(n,e),t)}function g1(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(m1(n))}function wT(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):qo(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const ha="http://www.w3.org/2000/svg";class Kr{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Go(n,e="text"){if(po(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class Yo{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:l=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=l,this.offsetY=c,s*=t;const h=(e[2]+e[0])/2,m=(e[3]+e[1])/2;let p,x,y,v;switch(i%=360,i<0&&(i+=360),i){case 180:p=-1,x=0,y=0,v=1;break;case 90:p=0,x=1,y=1,v=0;break;case 270:p=0,x=-1,y=-1,v=0;break;case 0:p=1,x=0,y=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(y=-y,v=-v);let w,A,N,j;p===0?(w=Math.abs(m-e[1])*s+l,A=Math.abs(h-e[0])*s+c,N=(e[3]-e[1])*s,j=(e[2]-e[0])*s):(w=Math.abs(h-e[0])*s+l,A=Math.abs(m-e[1])*s+c,N=(e[2]-e[0])*s,j=(e[3]-e[1])*s),this.transform=[p*s,x*s,y*s,v*s,w-p*s*h-y*s*m,A-x*s*h-v*s*m],this.width=N,this.height=j}get rawDims(){const e=this.viewBox;return et(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:l=!1}={}){return new Yo({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:l})}convertToViewportPoint(e,t){const s=[e,t];return Re.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];Re.applyTransform(t,this.transform);const s=[e[2],e[3]];return Re.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return Re.applyInverseTransform(s,this.transform),s}}class Ip extends Gi{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Au(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function Bp(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function AT(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function NT(n,e="document.pdf"){if(typeof n!="string")return e;if(Au(n))return Ue('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(n);if(!s)return e;const i=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},l=/\.pdf$/i,c=s.pathname.split("/").at(-1);if(l.test(c))return i(c);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const m of u)if(l.test(m))return i(m);const h=Array.from(s.searchParams.keys()).reverse();for(const m of h)if(l.test(m))return i(m)}if(s.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(h)return i(h[0])}return e}class Fb{started=Object.create(null);times=[];time(e){e in this.started&&Ue(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ue(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:l}of this.times)e.push(`${s.padEnd(t)} ${l-i}ms
`);return e.join("")}}function po(n,e){const t=e?URL.parse(n,e):URL.parse(n);return t?.protocol==="http:"||t?.protocol==="https:"}function _n(n){n.preventDefault()}function Yt(n){n.preventDefault(),n.stopPropagation()}function jT(n){console.log("Deprecated API usage: "+n)}class x1{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let l=parseInt(t[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(t[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(t[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const m=t[7]||"Z";let p=parseInt(t[8],10);p=p>=0&&p<=23?p:0;let x=parseInt(t[9],10)||0;return x=x>=0&&x<=59?x:0,m==="-"?(c+=p,u+=x):m==="+"&&(c-=p,u-=x),new Date(Date.UTC(s,i,l,c,u,h))}}function ST(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,l=[0,0,parseInt(s),parseInt(i)];return new Yo({viewBox:l,userUnit:1,scale:e,rotation:t})}function Hp(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ue(`Not a valid color format: "${n}"`),[0,0,0])}function ET(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,Hp(s))}e.remove()}function Mt(n){const{a:e,b:t,c:s,d:i,e:l,f:c}=n.getTransform();return[e,t,s,i,l,c]}function Un(n){const{a:e,b:t,c:s,d:i,e:l,f:c}=n.getTransform().invertSelf();return[e,t,s,i,l,c]}function Ui(n,e,t=!1,s=!0){if(e instanceof Yo){const{pageWidth:i,pageHeight:l}=e.rawDims,{style:c}=n,u=fs.isCSSRoundSupported,h=`var(--total-scale-factor) * ${i}px`,m=`var(--total-scale-factor) * ${l}px`,p=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,x=u?`round(down, ${m}, var(--scale-round-y))`:`calc(${m})`;!t||e.rotation%180===0?(c.width=p,c.height=x):(c.width=x,c.height=p)}s&&n.setAttribute("data-main-rotation",e.rotation)}class Wn{constructor(){const{pixelRatio:e}=Wn;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,i,l=-1){let c=1/0,u=1/0,h=1/0;s=Wn.capPixels(s,l),s>0&&(c=Math.sqrt(s/(e*t))),i!==-1&&(u=i/e,h=i/t);const m=Math.min(c,u,h);return this.sx>m||this.sy>m?(this.sx=m,this.sy=m,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const Km=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class vo{#e=null;#t=null;#s;#n=null;#i=null;#a=null;static#l=null;constructor(e){this.#s=e,vo.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#s._uiManager._signal;e.addEventListener("contextmenu",_n,{signal:t}),e.addEventListener("pointerdown",vo.#r,{signal:t});const s=this.#n=document.createElement("div");s.className="buttons",e.append(s);const i=this.#s.toolbarPosition;if(i){const{style:l}=e,c=this.#s._uiManager.direction==="ltr"?1-i[0]:i[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#r(e){e.stopPropagation()}#u(e){this.#s._focusEventsAllowed=!1,Yt(e)}#o(e){this.#s._focusEventsAllowed=!0,Yt(e)}#h(e){const t=this.#s._uiManager._signal;e.addEventListener("focusin",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#o.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",_n,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#i?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#s,s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",vo.#l[e]),this.#h(s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),this.#n.append(s)}get#d(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#h(t),this.#n.append(t,this.#d),this.#i=e}addColorPicker(e){this.#t=e;const t=e.renderButton();this.#h(t),this.#n.append(t,this.#d)}async addEditSignatureButton(e){const t=this.#a=await e.renderEditButton(this.#s);this.#h(t),this.#n.append(t,this.#d)}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break}}updateEditSignatureButton(e){this.#a&&(this.#a.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class _T{#e=null;#t=null;#s;constructor(e){this.#s=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",_n,{signal:this.#s._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#a(),e}#i(e,t){let s=0,i=0;for(const l of e){const c=l.y+l.height;if(c<s)continue;const u=l.x+(t?l.width:0);if(c>s){i=u,s=c;continue}t?u>i&&(i=u):u<i&&(i=u)}return[t?1-i:i,s]}show(e,t,s){const[i,l]=this.#i(t,s),{style:c}=this.#t||=this.#n();e.append(this.#t),c.insetInlineEnd=`${100*i}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#a(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=this.#s._signal;e.addEventListener("contextmenu",_n,{signal:s}),e.addEventListener("click",()=>{this.#s.highlightSelection("floating_button")},{signal:s}),this.#e.append(e)}}function y1(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}class CT{#e=0;get id(){return`${u1}${this.#e++}`}}class zp{#e=p1();#t=0;#s=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const l=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return et(this,"_isSVGFittingCanvas",l)}async#n(e,t){this.#s||=new Map;let s=this.#s.get(e);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let i;if(typeof t=="string"?(s.url=t,i=await Go(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const l=zp._isSVGFittingCanvas,c=new FileReader,u=new Image,h=new Promise((m,p)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,m()},c.onload=async()=>{const x=s.svgUrl=c.result;u.src=await l?`${x}#svgView(preserveAspectRatio(none))`:x},u.onerror=c.onerror=p});c.readAsDataURL(i),await h}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){Ue(i),s=null}return this.#s.set(e,s),s&&this.#s.set(s.id,s),s}async getFromFile(e){const{lastModified:t,name:s,size:i,type:l}=e;return this.#n(`${t}_${s}_${i}_${l}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const s=await t;return this.#n(e,s)}async getFromId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#s||=new Map;let s=this.#s.get(e);if(s?.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#s.set(e,s),this.#s.set(s.id,s),s}getSvgUrl(e){const t=this.#s.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(s.width,s.height);i.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=i.convertToBlob()}s.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class TT{#e=[];#t=!1;#s;#n=-1;constructor(e=128){this.#s=e}add({cmd:e,undo:t,post:s,mustExec:i,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(i&&e(),this.#t)return;const h={cmd:e,undo:t,post:s,type:l};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(h);return}if(c&&this.#e[this.#n].type===l){u&&(h.undo=this.#e[this.#n].undo),this.#e[this.#n]=h;return}const m=this.#n+1;m===this.#s?this.#e.splice(0,1):(this.#n=m,m<this.#e.length&&this.#e.splice(m)),this.#e.push(h)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class Wo{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=fs.platform;for(const[s,i,l={}]of e)for(const c of s){const u=c.startsWith("mac+");t&&u?(this.callbacks.set(c.slice(4),{callback:i,options:l}),this.allKeys.add(c.split("+").at(-1))):!t&&!u&&(this.callbacks.set(c,{callback:i,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(this.#e(t));if(!s)return;const{callback:i,options:{bubbles:l=!1,args:c=[],checker:u=null}}=s;u&&!u(e,t)||(i.bind(e,...c,t)(),l||Yt(t))}}class Fp{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return ET(e),et(this,"_colors",e)}convert(e){const t=Hp(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((l,c)=>l===t[c]))return Fp._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?Re.makeHexColor(...t):e}}class ei{#e=new AbortController;#t=null;#s=new Map;#n=new Map;#i=null;#a=null;#l=null;#r=new TT;#u=null;#o=null;#h=0;#d=new Set;#f=null;#m=null;#p=new Set;_editorUndoBar=null;#c=!1;#g=!1;#x=!1;#y=null;#v=null;#w=null;#A=null;#S=!1;#_=null;#T=new CT;#N=!1;#C=!1;#E=null;#R=null;#k=null;#M=null;#z=null;#j=Fe.NONE;#b=new Set;#I=null;#B=null;#$=null;#V=null;#q={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#F=[0,0];#L=null;#O=null;#U=null;#X=null;#P=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=ei.prototype,t=c=>c.#O.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),s=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return et(this,"_keyboardManager",new Wo([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#O.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#O.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-l,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[l,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-l],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,l],checker:t}]]))}constructor(e,t,s,i,l,c,u,h,m,p,x,y,v,w,A){const N=this._signal=this.#e.signal;this.#O=e,this.#U=t,this.#X=s,this.#i=i,this.#B=l,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:N}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:N}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:N}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:N}),c._on("setpreference",this.onSetPreference.bind(this),{signal:N}),c._on("switchannotationeditorparams",j=>this.updateParams(j.type,j.value),{signal:N}),this.#ae(),this.#oe(),this.#Z(),this.#a=u.annotationStorage,this.#y=u.filterFactory,this.#$=h,this.#A=m||null,this.#c=p,this.#g=x,this.#x=y,this.#z=v||null,this.viewParameters={realScale:Kr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=w||null,this._supportsPinchToZoom=A!==!1}destroy(){this.#P?.resolve(),this.#P=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#n.values())e.destroy();this.#n.clear(),this.#s.clear(),this.#p.clear(),this.#M?.clear(),this.#t=null,this.#b.clear(),this.#r.destroy(),this.#i?.destroy(),this.#B?.destroy(),this.#_?.hide(),this.#_=null,this.#k?.destroy(),this.#k=null,this.#v&&(clearTimeout(this.#v),this.#v=null),this.#L&&(clearTimeout(this.#L),this.#L=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#z}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#x}get hcmFilter(){return et(this,"hcmFilter",this.#$?this.#y.addHCMFilter(this.#$.foreground,this.#$.background):"none")}get direction(){return et(this,"direction",getComputedStyle(this.#O).direction)}get highlightColors(){return et(this,"highlightColors",this.#A?new Map(this.#A.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColorNames(){return et(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#o=e}setMainHighlightColorPicker(e){this.#k=e}editAltText(e,t=!1){this.#i?.editAltText(this,e,t)}getSignature(e){this.#B?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#B}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#x=t;break}}onPageChanging({pageNumber:e}){this.#h=e-1}focusMainContainer(){this.#O.focus()}findParent(e,t){for(const s of this.#n.values()){const{x:i,y:l,width:c,height:u}=s.div.getBoundingClientRect();if(e>=i&&e<=i+c&&t>=l&&t<=l+u)return s}return null}disableUserSelect(e=!1){this.#U.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Kr.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#o?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#Y({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#Q(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of this.#n.values())if(s.hasTextLayer(e))return s;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:l,focusOffset:c}=t,u=t.toString(),m=this.#Y(t).closest(".textLayer"),p=this.getSelectionBoxes(m);if(!p)return;t.empty();const x=this.#Q(m),y=this.#j===Fe.NONE,v=()=>{x?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:p,anchorNode:s,anchorOffset:i,focusNode:l,focusOffset:c,text:u}),y&&this.showAllEditors("highlight",!0,!0)};if(y){this.switchToMode(Fe.HIGHLIGHT,v);return}v()}#se(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=this.#Y(e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(this.#_||=new _T(this),this.#_.show(s,i,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#a&&!this.#a.has(e.id)&&this.#a.setValue(e.id,e)}a11yAlert(e,t=null){const s=this.#X;s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}#ne(){const e=document.getSelection();if(!e||e.isCollapsed){this.#I&&(this.#_?.hide(),this.#I=null,this.#D({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#I)return;const i=this.#Y(e).closest(".textLayer");if(!i){this.#I&&(this.#_?.hide(),this.#I=null,this.#D({hasSelectedText:!1}));return}if(this.#_?.hide(),this.#I=t,this.#D({hasSelectedText:!0}),!(this.#j!==Fe.HIGHLIGHT&&this.#j!==Fe.NONE)&&(this.#j===Fe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#j===Fe.HIGHLIGHT?this.#Q(i):null;l?.toggleDrawing();const c=new AbortController,u=this.combinedSignal(c),h=m=>{m.type==="pointerup"&&m.button!==0||(c.abort(),l?.toggleDrawing(!0),m.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}}#W(e=""){this.#j===Fe.HIGHLIGHT?this.highlightSelection(e):this.#c&&this.#se()}#ae(){document.addEventListener("selectionchange",this.#ne.bind(this),{signal:this._signal})}#ie(){if(this.#w)return;this.#w=new AbortController;const e=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#re(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#W("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#b)if(t.div.contains(e)){this.#R=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#R)return;const[e,t]=this.#R;this.#R=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#Z(){if(this.#E)return;this.#E=new AbortController;const e=this.combinedSignal(this.#E);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#le(){this.#E?.abort(),this.#E=null}#K(){if(this.#u)return;this.#u=new AbortController;const e=this.combinedSignal(this.#u);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#J(){this.#u?.abort(),this.#u=null}#oe(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#Z(),this.#K()}removeEditListeners(){this.#le(),this.#J()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of this.#m)if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of this.#m)if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of this.#b){const i=s.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const l of t.items)for(const c of this.#m)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(l){Ue(`paste: "${l.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const l=[];for(const h of s){const m=await i.deserialize(h);if(!m)return;l.push(m)}const c=()=>{for(const h of l)this.#ee(h);this.#te(l)},u=()=>{for(const h of l)h.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(l){Ue(`paste: "${l.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#j!==Fe.NONE&&!this.isEditorHandlingKeyboard&&ei._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#W("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#D(e){Object.entries(e).some(([s,i])=>this.#q[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#q,e)}),this.#j===Fe.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#H([[st.HIGHLIGHT_FREE,!0]]))}#H(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#ie(),this.#K(),this.#D({isEditing:this.#j!==Fe.NONE,isEmpty:this.#G(),hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:this.#r.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#re(),this.#J(),this.#D({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#m){this.#m=e;for(const t of this.#m)this.#H(t.defaultPropertiesToUpdate)}}getId(){return this.#T.id}get currentLayer(){return this.#n.get(this.#h)}getLayer(e){return this.#n.get(e)}get currentPageIndex(){return this.#h}addLayer(e){this.#n.set(e.pageIndex,e),this.#N?e.enable():e.disable()}removeLayer(e){this.#n.delete(e.pageIndex)}async updateMode(e,t=null,s=!1,i=!1){if(this.#j!==e&&!(this.#P&&(await this.#P.promise,!this.#P))){if(this.#P=Promise.withResolvers(),this.#o?.commitOrRemove(),this.#j=e,e===Fe.NONE){this.setEditingState(!1),this.#de(),this._editorUndoBar?.hide(),this.#P.resolve();return}e===Fe.SIGNATURE&&await this.#B?.loadSignatures(),this.setEditingState(!0),await this.#ce(),this.unselectAll();for(const l of this.#n.values())l.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),this.#P.resolve();return}for(const l of this.#s.values())l.annotationElementId===t||l.id===t?(this.setSelected(l),i&&l.enterInEditMode()):l.unselect();this.#P.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#j&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#m){switch(e){case st.CREATE:this.currentLayer.addNewEditor(t);return;case st.HIGHLIGHT_DEFAULT_COLOR:this.#k?.updateColor(t);break;case st.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#V||=new Map).set(e,t),this.showAllEditors("highlight",t);break}for(const s of this.#b)s.updateParams(e,t);for(const s of this.#m)s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){for(const l of this.#s.values())l.editorType===e&&l.show(t);(this.#V?.get(st.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#H([[st.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#C!==e){this.#C=e;for(const t of this.#n.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#ce(){if(!this.#N){this.#N=!0;const e=[];for(const t of this.#n.values())e.push(t.enable());await Promise.all(e);for(const t of this.#s.values())t.enable()}}#de(){if(this.unselectAll(),this.#N){this.#N=!1;for(const e of this.#n.values())e.disable();for(const e of this.#s.values())e.disable()}}getEditors(e){const t=[];for(const s of this.#s.values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return this.#s.get(e)}addEditor(e){this.#s.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.focusMainContainer(),this.#v=null},0)),this.#s.delete(e.id),e.annotationElementId&&this.#M?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#d.has(e.annotationElementId))&&this.#a?.remove(e.id)}addDeletedAnnotationElement(e){this.#d.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#d.has(e)}removeDeletedAnnotationElement(e){this.#d.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#ee(e){const t=this.#n.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#H(e.propertiesToUpdate))}get#ue(){let e=null;for(e of this.#b);return e}updateUI(e){this.#ue===e&&this.#H(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#H(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#b.has(e)){this.#b.delete(e),e.unselect(),this.#D({hasSelectedEditor:this.hasSelection});return}this.#b.add(e),e.select(),this.#H(e.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.id}),this.#o?.commitOrRemove();for(const t of this.#b)t!==e&&t.unselect();this.#b.clear(),this.#b.add(e),e.select(),this.#H(e.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}isSelected(e){return this.#b.has(e)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(e){e.unselect(),this.#b.delete(e),this.#D({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#r.undo(),this.#D({hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#G()}),this._editorUndoBar?.hide()}redo(){this.#r.redo(),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:this.#r.hasSomethingToRedo(),isEmpty:this.#G()})}addCommands(e){this.#r.add(e),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#G()})}cleanUndoStack(e){this.#r.cleanType(e)}#G(){if(this.#s.size===0)return!0;if(this.#s.size===1)for(const e of this.#s.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#b],s=()=>{this._editorUndoBar?.show(i,t.length===1?t[0].editorType:t.length);for(const l of t)l.remove()},i=()=>{for(const l of t)this.#ee(l)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#te(e){for(const t of this.#b)t.unselect();this.#b.clear();for(const t of e)t.isEmpty()||(this.#b.add(t),t.select());this.#D({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#b)e.commit();this.#te(this.#s.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#j!==Fe.NONE))&&!this.#o?.commitOrRemove()&&this.hasSelection){for(const e of this.#b)e.unselect();this.#b.clear(),this.#D({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#F[0]+=e,this.#F[1]+=t;const[i,l]=this.#F,c=[...this.#b],u=1e3;this.#L&&clearTimeout(this.#L),this.#L=setTimeout(()=>{this.#L=null,this.#F[0]=this.#F[1]=0,this.addCommands({cmd:()=>{for(const h of c)this.#s.has(h.id)&&(h.translateInPage(i,l),h.translationDone())},undo:()=>{for(const h of c)this.#s.has(h.id)&&(h.translateInPage(-i,-l),h.translationDone())},mustExec:!1})},u);for(const h of c)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(const e of this.#b)this.#f.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);const e=this.#f;this.#f=null;let t=!1;for(const[{x:i,y:l,pageIndex:c},u]of e)u.newX=i,u.newY=l,u.newPageIndex=c,t||=i!==u.savedX||l!==u.savedY||c!==u.savedPageIndex;if(!t)return!1;const s=(i,l,c,u)=>{if(this.#s.has(i.id)){const h=this.#n.get(u);h?i._setParentAndPosition(h,l,c):(i.pageIndex=u,i.x=l,i.y=c)}};return this.addCommands({cmd:()=>{for(const[i,{newX:l,newY:c,newPageIndex:u}]of e)s(i,l,c,u)},undo:()=>{for(const[i,{savedX:l,savedY:c,savedPageIndex:u}]of e)s(i,l,c,u)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#f)for(const s of this.#f.keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#j}get imageManager(){return et(this,"imageManager",new zp)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let m=0,p=t.rangeCount;m<p;m++)if(!e.contains(t.getRangeAt(m).commonAncestorContainer))return null;const{x:s,y:i,width:l,height:c}=e.getBoundingClientRect();let u;switch(e.getAttribute("data-main-rotation")){case"90":u=(m,p,x,y)=>({x:(p-i)/c,y:1-(m+x-s)/l,width:y/c,height:x/l});break;case"180":u=(m,p,x,y)=>({x:1-(m+x-s)/l,y:1-(p+y-i)/c,width:x/l,height:y/c});break;case"270":u=(m,p,x,y)=>({x:1-(p+y-i)/c,y:(m-s)/l,width:y/c,height:x/l});break;default:u=(m,p,x,y)=>({x:(m-s)/l,y:(p-i)/c,width:x/l,height:y/c});break}const h=[];for(let m=0,p=t.rangeCount;m<p;m++){const x=t.getRangeAt(m);if(!x.collapsed)for(const{x:y,y:v,width:w,height:A}of x.getClientRects())w===0||A===0||h.push(u(y,v,w,A))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#l||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#l?.delete(e)}renderAnnotationElement(e){const t=this.#l?.get(e.data.id);if(!t)return;const s=this.#a.getRawValue(t);s&&(this.#j===Fe.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){const i=this.#M?.get(e);i&&(i.setCanvas(t,s),this.#M.delete(e))}addMissingCanvas(e,t){(this.#M||=new Map).set(e,t)}}class qn{#e=null;#t=!1;#s=null;#n=null;#i=null;#a=null;#l=!1;#r=null;#u=null;#o=null;#h=null;#d=!1;static#f=null;static _l10n=null;constructor(e){this.#u=e,this.#d=e._uiManager.useNewAltTextFlow,qn.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){qn._l10n??=e}async render(){const e=this.#s=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#d?(e.classList.add("new"),e.setAttribute("data-l10n-id",qn.#f.missing),t.setAttribute("data-l10n-id",qn.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#u._uiManager._signal;e.addEventListener("contextmenu",_n,{signal:s}),e.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:s});const i=l=>{l.preventDefault(),this.#u._uiManager.editAltText(this.#u),this.#d&&this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",l=>{l.target===e&&l.key==="Enter"&&(this.#l=!0,i(l))},{signal:s}),await this.#p(),e}get#m(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#d?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#d?this.#e!==null||!!this.#o:this.isEmpty()}get guessedText(){return this.#o}async setGuessedText(e){this.#e===null&&(this.#o=e,this.#h=await qn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#p())}toggleAltTextBadge(e=!1){if(!this.#d||this.#e){this.#r?.remove(),this.#r=null;return}if(!this.#r){const t=this.#r=document.createElement("div");t.className="noAltTextBadge",this.#u.div.append(t)}this.#r.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#o===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#o,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:l=!1}){s&&(this.#o=s,this.#h=i),!(this.#e===e&&this.#t===t)&&(l||(this.#e=e,this.#t=t),this.#p())}toggle(e=!1){this.#s&&(!e&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#s.disabled=!e)}shown(){this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#s?.remove(),this.#s=null,this.#n=null,this.#i=null,this.#r?.remove(),this.#r=null}async#p(){const e=this.#s;if(!e)return;if(this.#d){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",qn.#f[this.#m]),this.#n?.setAttribute("data-l10n-id",qn.#f[`${this.#m}-label`]),!this.#e){this.#i?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#i?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#i;if(!t){this.#i=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#u.id}`;const i=100,l=this.#u._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#a),this.#a=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#i.classList.add("show"),this.#u._reportTelemetry({action:"alt_text_tooltip"})},i)},{signal:l}),e.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#i?.classList.remove("show")},{signal:l})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#u.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class Nu{#e;#t=!1;#s=null;#n;#i;#a;#l;#r=null;#u;#o=null;#h;#d=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:l=null,onPinchEnd:c=null,signal:u}){this.#e=e,this.#s=s,this.#n=t,this.#i=i,this.#a=l,this.#l=c,this.#h=new AbortController,this.#u=AbortSignal.any([u,this.#h.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#u})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Wn.pixelRatio}#f(e){if(this.#n?.())return;if(e.touches.length===1){if(this.#r)return;const i=this.#r=new AbortController,l=AbortSignal.any([this.#u,i.signal]),c=this.#e,u={capture:!0,signal:l,passive:!1},h=m=>{m.pointerType==="touch"&&(this.#r?.abort(),this.#r=null)};c.addEventListener("pointerdown",m=>{m.pointerType==="touch"&&(Yt(m),h(m))},u),c.addEventListener("pointerup",h,u),c.addEventListener("pointercancel",h,u);return}if(!this.#d){this.#d=new AbortController;const i=AbortSignal.any([this.#u,this.#d.signal]),l=this.#e,c={signal:i,capture:!1,passive:!1};l.addEventListener("touchmove",this.#m.bind(this),c);const u=this.#p.bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",Yt,c),l.addEventListener("pointermove",Yt,c),l.addEventListener("pointercancel",Yt,c),l.addEventListener("pointerup",Yt,c),this.#i?.()}if(Yt(e),e.touches.length!==2||this.#s?.()){this.#o=null;return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),this.#o={touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#m(e){if(!this.#o||e.touches.length!==2)return;Yt(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:l}=t,{screenX:c,screenY:u}=s,h=this.#o,{touch0X:m,touch0Y:p,touch1X:x,touch1Y:y}=h,v=x-m,w=y-p,A=c-i,N=u-l,j=Math.hypot(A,N)||1,_=Math.hypot(v,w)||1;if(!this.#t&&Math.abs(_-j)<=Nu.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=i,h.touch0Y=l,h.touch1X=c,h.touch1Y=u,!this.#t){this.#t=!0;return}const C=[(i+c)/2,(l+u)/2];this.#a?.(C,_,j)}#p(e){e.touches.length>=2||(this.#d&&(this.#d.abort(),this.#d=null,this.#l?.()),this.#o&&(Yt(e),this.#o=null,this.#t=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#r?.abort(),this.#r=null}}class ke{#e=null;#t=null;#s=null;#n=!1;#i=null;#a="";#l=!1;#r=null;#u=null;#o=null;#h=null;#d="";#f=!1;#m=null;#p=!1;#c=!1;#g=!1;#x=null;#y=0;#v=0;#w=null;#A=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#_=ke._zIndex++;static _borderLineWidth=-1;static _colorManager=new Fp;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=ke.prototype._resizeWithKeyboard,t=ei.TRANSLATE_SMALL,s=ei.TRANSLATE_BIG;return et(this,"_resizerKeyboardManager",new Wo([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],ke.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[l,c];const[u,h]=this.parentDimensions;this.x=e.x/u,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return et(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new DT({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ke._l10n??=e,ke._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),ke._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ke._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){xt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(e){this.#S=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#_}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#U(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[l,c]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/l,this.y=(t+i)/c,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,i]=this.parentDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i),this._onTranslated()}#T([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#T(this.parentDimensions,e,t)}translateInPage(e,t){this.#m||=[this.x,this.y,this.width,this.height],this.#T(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#m||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[i,l]}=this;if(this.x+=e/i,this.y+=t/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x,y}=this.div.getBoundingClientRect();this.parent.findNewParent(this,x,y)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[h,m]=this.getBaseTranslation();c+=h,u+=m;const{style:p}=s;p.left=`${(100*c).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#m&&(this.#m[0]!==this.x||this.#m[1]!==this.y)}get _hasBeenResized(){return!!this.#m&&(this.#m[2]!==this.width||this.#m[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=ke,i=s/e,l=s/t;switch(this.rotation){case 90:return[-i,l];case 180:return[i,l];case 270:return[i,-l];default:return[-i,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:l,y:c,width:u,height:h}=this;if(u*=s,h*=i,l*=s,c*=i,this._mustFixPosition)switch(e){case 0:l=Ss(l,0,s-u),c=Ss(c,0,i-h);break;case 90:l=Ss(l,0,s-h),c=Ss(c,u,i);break;case 180:l=Ss(l,u,s),c=Ss(c,h,i);break;case 270:l=Ss(l,h,s),c=Ss(c,0,i-u);break}this.x=l/=s,this.y=c/=i;const[m,p]=this.getBaseTranslation();l+=m,c+=p,t.left=`${(100*l).toFixed(2)}%`,t.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#N(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return ke.#N(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return ke.#N(e,t,360-this.parentRotation)}#C(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:l}=this.div;l.width=`${(100*e/s).toFixed(2)}%`,this.#l||(l.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),l=!this.#l&&t.endsWith("%");if(i&&l)return;const[c,u]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/c).toFixed(2)}%`),!this.#l&&!l&&(e.height=`${(100*parseFloat(t)/u).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#E(){if(this.#r)return;this.#r=document.createElement("div"),this.#r.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");this.#r.append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",this.#R.bind(this,s),{signal:t}),i.addEventListener("contextmenu",_n,{signal:t}),i.tabIndex=-1}this.div.prepend(this.#r)}#R(e,t){t.preventDefault();const{isMac:s}=fs.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#s?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#u=[t.screenX,t.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#z.bind(this,e),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",Yt,{passive:!1,signal:c}),window.addEventListener("contextmenu",_n,{signal:c}),this.#o={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const m=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#M()};window.addEventListener("pointerup",m,{signal:c}),window.addEventListener("blur",m,{signal:c})}#k(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[l,c]=this.parentDimensions;this.setDims(l*s,c*i),this.fixAndSetPosition(),this._onResized()}_onResized(){}#M(){if(!this.#o)return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=this.#o;this.#o=null;const l=this.x,c=this.y,u=this.width,h=this.height;l===e&&c===t&&u===s&&h===i||this.addCommands({cmd:this.#k.bind(this,l,c,u,h),undo:this.#k.bind(this,e,t,s,i),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#z(e,t){const[s,i]=this.parentDimensions,l=this.x,c=this.y,u=this.width,h=this.height,m=ke.MIN_SIZE/s,p=ke.MIN_SIZE/i,x=this.#C(this.rotation),y=(L,q)=>[x[0]*L+x[2]*q,x[1]*L+x[3]*q],v=this.#C(360-this.rotation),w=(L,q)=>[v[0]*L+v[2]*q,v[1]*L+v[3]*q];let A,N,j=!1,_=!1;switch(e){case"topLeft":j=!0,A=(L,q)=>[0,0],N=(L,q)=>[L,q];break;case"topMiddle":A=(L,q)=>[L/2,0],N=(L,q)=>[L/2,q];break;case"topRight":j=!0,A=(L,q)=>[L,0],N=(L,q)=>[0,q];break;case"middleRight":_=!0,A=(L,q)=>[L,q/2],N=(L,q)=>[0,q/2];break;case"bottomRight":j=!0,A=(L,q)=>[L,q],N=(L,q)=>[0,0];break;case"bottomMiddle":A=(L,q)=>[L/2,q],N=(L,q)=>[L/2,0];break;case"bottomLeft":j=!0,A=(L,q)=>[0,q],N=(L,q)=>[L,0];break;case"middleLeft":_=!0,A=(L,q)=>[0,q/2],N=(L,q)=>[L,q/2];break}const C=A(u,h),k=N(u,h);let D=y(...k);const P=ke._round(l+D[0]),F=ke._round(c+D[1]);let U=1,I=1,K,H;if(t.fromKeyboard)({deltaX:K,deltaY:H}=t);else{const{screenX:L,screenY:q}=t,[V,B]=this.#u;[K,H]=this.screenToPageTranslation(L-V,q-B),this.#u[0]=L,this.#u[1]=q}if([K,H]=w(K/s,H/i),j){const L=Math.hypot(u,h);U=I=Math.max(Math.min(Math.hypot(k[0]-C[0]-K,k[1]-C[1]-H)/L,1/u,1/h),m/u,p/h)}else _?U=Ss(Math.abs(k[0]-C[0]-K),m,1)/u:I=Ss(Math.abs(k[1]-C[1]-H),p,1)/h;const X=ke._round(u*U),W=ke._round(h*I);D=y(...N(X,W));const ce=P-D[0],me=F-D[1];this.#m||=[this.x,this.y,this.width,this.height],this.width=X,this.height=W,this.x=ce,this.y=me,this.setDims(s*X,i*W),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#c)return this._editToolbar;this._editToolbar=new vo(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#s?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#s||(qn.initialize(ke._l10n),this.#s=new qn(this),this.#e&&(this.#s.data=this.#e,this.#e=null)),this.#s}get altTextData(){return this.#s?.data}set altTextData(e){this.#s&&(this.#s.data=e)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(e){await this.#s?.setGuessedText(e)}serializeAltText(e){return this.#s?.serialize(e)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#n?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#V();const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[i,l]=this.getInitialTranslation();return this.translate(i,l),y1(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#A||=new Nu({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#j.bind(this),onPinching:this.#b.bind(this),onPinchEnd:this.#I.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),e}#j(){this.#o={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#s?.toggle(!1),this.parent.togglePointerEvents(!1)}#b(e,t,s){let l=.7*(s/t)+1-.7;if(l===1)return;const c=this.#C(this.rotation),u=(P,F)=>[c[0]*P+c[2]*F,c[1]*P+c[3]*F],[h,m]=this.parentDimensions,p=this.x,x=this.y,y=this.width,v=this.height,w=ke.MIN_SIZE/h,A=ke.MIN_SIZE/m;l=Math.max(Math.min(l,1/y,1/v),w/y,A/v);const N=ke._round(y*l),j=ke._round(v*l);if(N===y&&j===v)return;this.#m||=[p,x,y,v];const _=u(y/2,v/2),C=ke._round(p+_[0]),k=ke._round(x+_[1]),D=u(N/2,j/2);this.x=C-D[0],this.y=k-D[1],this.width=N,this.height=j,this.setDims(h*N,m*j),this.fixAndSetPosition(),this._onResizing()}#I(){this.#s?.toggle(!0),this.parent.togglePointerEvents(!0),this.#M()}pointerdown(e){const{isMac:t}=fs.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#$(e);return}this.#B(e)}#B(e){const{isMac:t}=fs.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#$(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,l=this._uiManager.combinedSignal(i),c={capture:!0,passive:!1,signal:l},u=m=>{i.abort(),this.#i=null,this.#f=!1,this._uiManager.endDragSession()||this.#B(m),s&&this._onStopDragging()};t&&(this.#y=e.clientX,this.#v=e.clientY,this.#i=e.pointerId,this.#a=e.pointerType,window.addEventListener("pointermove",m=>{s||(s=!0,this._onStartDragging());const{clientX:p,clientY:x,pointerId:y}=m;if(y!==this.#i){Yt(m);return}const[v,w]=this.screenToPageTranslation(p-this.#y,x-this.#v);this.#y=p,this.#v=x,this._uiManager.dragSelectedEditors(v,w)},c),window.addEventListener("touchmove",Yt,c),window.addEventListener("pointerdown",m=>{m.pointerType===this.#a&&(this.#A||m.isPrimary)&&u(m),Yt(m)},c));const h=m=>{if(!this.#i||this.#i===m.pointerId){u(m);return}Yt(m)};window.addEventListener("pointerup",h,{signal:l}),window.addEventListener("blur",h,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.#x=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[l,c]=this.pageDimensions,[u,h]=this.pageTranslation,m=e/i,p=t/i,x=this.x*l,y=this.y*c,v=this.width*l,w=this.height*c;switch(s){case 0:return[x+m+u,c-y-p-w+h,x+m+v+u,c-y-p+h];case 90:return[x+p+u,c-y+m+h,x+p+w+u,c-y+m+v+h];case 180:return[x-m-v+u,c-y+p+h,x-m+u,c-y+p+w+h];case 270:return[x-p-w+u,c-y-m-v+h,x-p+u,c-y-m+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,l,c]=e,u=l-s,h=c-i;switch(this.rotation){case 0:return[s,t-c,u,h];case 90:return[s,t-i,h,u];case 180:return[l,t-i,u,h];case 270:return[l,t-c,h,u];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#c=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#c=!1,!0):!1}isInEditMode(){return this.#c}shouldGetKeyboardEvents(){return this.#g}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return t<c&&i>0&&e<l&&s>0}#V(){if(this.#h||!this.div)return;this.#h=new AbortController;const e=this._uiManager.combinedSignal(this.#h);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#V()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){xt("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId});i.rotation=e.rotation,i.#e=e.accessibilityData,i._isCopy=e.isCopy||!1;const[l,c]=i.pageDimensions,[u,h,m,p]=i.getRectInCurrentCoords(e.rect,c);return i.x=u/l,i.y=h/c,i.width=m/l,i.height=p/c,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#h?.abort(),this.#h=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#x&&(clearTimeout(this.#x),this.#x=null),this.#U(),this.removeEditToolbar(),this.#w){for(const e of this.#w.values())clearTimeout(e);this.#w=null}this.parent=null,this.#A?.destroy(),this.#A=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#E(),this.#r.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#o={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#r.children;if(!this.#t){this.#t=Array.from(t);const c=this.#q.bind(this),u=this.#F.bind(this),h=this._uiManager._signal;for(const m of this.#t){const p=m.getAttribute("data-resizer-name");m.setAttribute("role","spinbutton"),m.addEventListener("keydown",c,{signal:h}),m.addEventListener("blur",u,{signal:h}),m.addEventListener("focus",this.#L.bind(this,p),{signal:h}),m.setAttribute("data-l10n-id",ke._l10nResizer[p])}}const s=this.#t[0];let i=0;for(const c of t){if(c===s)break;i++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(l!==i){if(l<i)for(let u=0;u<i-l;u++)this.#r.append(this.#r.firstChild);else if(l>i)for(let u=0;u<l-i;u++)this.#r.firstChild.before(this.#r.lastChild);let c=0;for(const u of t){const m=this.#t[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",ke._l10nResizer[m])}}this.#O(0),this.#g=!0,this.#r.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#q(e){ke._resizerKeyboardManager.exec(this,e)}#F(e){this.#g&&e.relatedTarget?.parentNode!==this.#r&&this.#U()}#L(e){this.#d=this.#g?e:""}#O(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#g&&this.#z(this.#d,{deltaX:e,deltaY:t,fromKeyboard:!0})}#U(){this.#g=!1,this.#O(-1),this.#M()}_stopResizingWithKeyboard(){this.#U(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#r?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#l=!0;const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#w||=new Map;const{action:s}=e;let i=this.#w.get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),this.#w.delete(s),this.#w.size===0&&(this.#w=null)},ke._telemetryTimeout),this.#w.set(s,i);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#n=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#n=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class DT extends ke{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ub=3285377520,fn=4294901760,$n=65535;class b1{constructor(e){this.h1=e?e&4294967295:Ub,this.h2=e?e&4294967295:Ub}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let A=0,N=e.length;A<N;A++){const j=e.charCodeAt(A);j<=255?t[s++]=j:(t[s++]=j>>>8,t[s++]=j&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,l=s-i*4,c=new Uint32Array(t.buffer,0,i);let u=0,h=0,m=this.h1,p=this.h2;const x=3432918353,y=461845907,v=x&$n,w=y&$n;for(let A=0;A<i;A++)A&1?(u=c[A],u=u*x&fn|u*v&$n,u=u<<15|u>>>17,u=u*y&fn|u*w&$n,m^=u,m=m<<13|m>>>19,m=m*5+3864292196):(h=c[A],h=h*x&fn|h*v&$n,h=h<<15|h>>>17,h=h*y&fn|h*w&$n,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,l){case 3:u^=t[i*4+2]<<16;case 2:u^=t[i*4+1]<<8;case 1:u^=t[i*4],u=u*x&fn|u*v&$n,u=u<<15|u>>>17,u=u*y&fn|u*w&$n,i&1?m^=u:p^=u}this.h1=m,this.h2=p}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&fn|e*36045&$n,t=t*4283543511&fn|((t<<16|e>>>16)*2950163797&fn)>>>16,e^=t>>>1,e=e*444984403&fn|e*60499&$n,t=t*3301882366&fn|((t<<16|e>>>16)*3120437893&fn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Jm=Object.freeze({map:null,hash:"",transfer:void 0});class Up{#e=!1;#t=null;#s=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=this.#s.get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return this.#s.get(e)}remove(e){if(this.#s.delete(e),this.#s.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#s.values())if(t instanceof ke)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=this.#s.get(e);let i=!1;if(s!==void 0)for(const[l,c]of Object.entries(t))s[l]!==c&&(i=!0,s[l]=c);else i=!0,this.#s.set(e,t);i&&this.#n(),t instanceof ke&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#s.has(e)}get size(){return this.#s.size}#n(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new v1(this)}get serializable(){if(this.#s.size===0)return Jm;const e=new Map,t=new b1,s=[],i=Object.create(null);let l=!1;for(const[c,u]of this.#s){const h=u instanceof ke?u.serialize(!1,i):u;h&&(e.set(c,h),t.update(`${c}:${JSON.stringify(h)}`),l||=!!h.bitmap)}if(l)for(const c of e.values())c.bitmap&&s.push(c.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Jm}get editorStats(){let e=null;const t=new Map;for(const s of this.#s.values()){if(!(s instanceof ke))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:l}=i;t.has(l)||t.set(l,Object.getPrototypeOf(s).constructor),e||=Object.create(null);const c=e[l]||=new Map;for(const[u,h]of Object.entries(i)){if(u==="type")continue;let m=c.get(u);m||(m=new Map,c.set(u,m));const p=m.get(h)??0;m.set(h,p+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#s.values())!(t instanceof ke)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#s.entries()}}class v1 extends Up{#e;constructor(e){super();const{map:t,hash:s,transfer:i}=e.serializable,l=structuredClone(t,i?{transfer:i}:null);this.#e={map:l,hash:s,transfer:i}}get print(){xt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return et(this,"modifiedIds",{ids:new Set,hash:""})}}class RT{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||this.#e.has(e.loadedName))){if(Wt(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:l,style:c}=e,u=new FontFace(i,l,c);this.addNativeFontFace(u);try{await u.load(),this.#e.add(i),s?.(e)}catch{Ue(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}xt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw Ue(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return et(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return et(this,"isSyncFontLoadingSupported",js||fs.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Wt(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const l=s.shift();setTimeout(l.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return et(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(k,D){return k.charCodeAt(D)<<24|k.charCodeAt(D+1)<<16|k.charCodeAt(D+2)<<8|k.charCodeAt(D+3)&255}function i(k,D,P,F){const U=k.substring(0,D),I=k.substring(D+P);return U+F+I}let l,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let m=0;function p(k,D){if(++m>30){Ue("Load test font never loaded."),D();return}if(h.font="30px "+k,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(p.bind(null,k,D))}const x=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=i(y,976,x.length,x);const w=16,A=1482184792;let N=s(y,w);for(l=0,c=x.length-3;l<c;l+=4)N=N-A+s(x,l)|0;l<x.length&&(N=N-A+s(x+"XXX",l)|0),y=i(y,w,4,pT(N));const j=`url(data:font/opentype;base64,${btoa(y)});`,_=`@font-face {font-family:"${x}";src:${j}}`;this.insertRule(_);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const k of[e.loadedName,x]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=k,C.append(D)}this._document.body.append(C),p(x,()=>{C.remove(),t.complete()})}}class kT{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this._inspectFont=t}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${g1(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(c){Ue(`getPathGenerator - ignoring character: "${c}".`)}const l=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=l}}function MT(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(js)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function LT(n){if(js&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return qo(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function fd(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const ep=n=>typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0,OT=n=>typeof n=="object"&&typeof n?.name=="string",PT=vT.bind(null,ep,OT);class IT{#e=new Map;#t=Promise.resolve();postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[i]of this.#e)i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if(s?.signal instanceof AbortSignal){const{signal:l}=s;if(l.aborted){Ue("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(e,t);i=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#e.set(t,i)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const md={DATA:1,ERROR:2},qt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function $b(){}function Ls(n){if(n instanceof Ja||n instanceof Zm||n instanceof Hb||n instanceof Yd||n instanceof um)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||xt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Ja(n.message);case"InvalidPDFException":return new Zm(n.message);case"PasswordException":return new Hb(n.message,n.code);case"ResponseException":return new Yd(n.message,n.status,n.missing);case"UnknownErrorException":return new um(n.message,n.details)}return new um(n.message,n.toString())}class go{#e=new AbortController;constructor(e,t,s){this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===md.DATA)i.resolve(e.data);else if(e.callback===md.ERROR)i.reject(Ls(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,l=this.comObj;Promise.try(t,e.data).then(function(c){l.postMessage({sourceName:s,targetName:i,callback:md.DATA,callbackId:e.callbackId,data:c})},function(c){l.postMessage({sourceName:s,targetName:i,callback:md.ERROR,callbackId:e.callbackId,reason:Ls(c)})});return}if(e.streamId){this.#s(e);return}t(e.data)}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[i]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(c){l.reject(c)}return l.promise}sendWithStream(e,t,s,i){const l=this.streamId++,c=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:m=>{const p=Promise.withResolvers();return this.streamControllers[l]={controller:m,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:c,targetName:u,action:e,streamId:l,data:t,desiredSize:m.desiredSize},i),p.promise},pull:m=>{const p=Promise.withResolvers();return this.streamControllers[l].pullCall=p,h.postMessage({sourceName:c,targetName:u,stream:qt.PULL,streamId:l,desiredSize:m.desiredSize}),p.promise},cancel:m=>{Wt(m instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[l].cancelCall=p,this.streamControllers[l].isClosed=!0,h.postMessage({sourceName:c,targetName:u,stream:qt.CANCEL,streamId:l,reason:Ls(m)}),p.promise}},s)}#s(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,l=this.comObj,c=this,u=this.actionHandler[e.action],h={enqueue(m,p=1,x){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=p,y>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:s,targetName:i,stream:qt.ENQUEUE,streamId:t,chunk:m},x)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:i,stream:qt.CLOSE,streamId:t}),delete c.streamSinks[t])},error(m){Wt(m instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:i,stream:qt.ERROR,streamId:t,reason:Ls(m)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(u,e.data,h).then(function(){l.postMessage({sourceName:s,targetName:i,stream:qt.START_COMPLETE,streamId:t,success:!0})},function(m){l.postMessage({sourceName:s,targetName:i,stream:qt.START_COMPLETE,streamId:t,reason:Ls(m)})})}#n(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,l=this.comObj,c=this.streamControllers[t],u=this.streamSinks[t];switch(e.stream){case qt.START_COMPLETE:e.success?c.startCall.resolve():c.startCall.reject(Ls(e.reason));break;case qt.PULL_COMPLETE:e.success?c.pullCall.resolve():c.pullCall.reject(Ls(e.reason));break;case qt.PULL:if(!u){l.postMessage({sourceName:s,targetName:i,stream:qt.PULL_COMPLETE,streamId:t,success:!0});break}u.desiredSize<=0&&e.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=e.desiredSize,Promise.try(u.onPull||$b).then(function(){l.postMessage({sourceName:s,targetName:i,stream:qt.PULL_COMPLETE,streamId:t,success:!0})},function(m){l.postMessage({sourceName:s,targetName:i,stream:qt.PULL_COMPLETE,streamId:t,reason:Ls(m)})});break;case qt.ENQUEUE:if(Wt(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(e.chunk);break;case qt.CLOSE:if(Wt(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#i(c,t);break;case qt.ERROR:Wt(c,"error should have stream controller"),c.controller.error(Ls(e.reason)),this.#i(c,t);break;case qt.CANCEL_COMPLETE:e.success?c.cancelCall.resolve():c.cancelCall.reject(Ls(e.reason)),this.#i(c,t);break;case qt.CANCEL:if(!u)break;const h=Ls(e.reason);Promise.try(u.onCancel||$b,h).then(function(){l.postMessage({sourceName:s,targetName:i,stream:qt.CANCEL_COMPLETE,streamId:t,success:!0})},function(m){l.postMessage({sourceName:s,targetName:i,stream:qt.CANCEL_COMPLETE,streamId:t,reason:Ls(m)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#i(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class w1{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){xt("Abstract method `_createCanvas` called.")}}class BT extends w1{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class A1{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){xt("Abstract method `_fetch` called.")}}class Vb extends A1{async _fetch(e){const t=await Go(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):qo(t)}}class N1{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,l){return"none"}destroy(e=!1){}}class HT extends N1{#e;#t;#s;#n;#i;#a;#l=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#i=t}get#r(){return this.#t||=new Map}get#u(){return this.#a||=new Map}get#o(){if(!this.#s){const e=this.#i.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const s=this.#i.createElementNS(ha,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#s=this.#i.createElementNS(ha,"defs"),e.append(s),s.append(this.#s),this.#i.body.append(e)}return this.#s}#h(e){if(e.length===1){const h=e[0],m=new Array(256);for(let x=0;x<256;x++)m[x]=h[x]/255;const p=m.join(",");return[p,p,p]}const[t,s,i]=e,l=new Array(256),c=new Array(256),u=new Array(256);for(let h=0;h<256;h++)l[h]=t[h]/255,c[h]=s[h]/255,u[h]=i[h]/255;return[l.join(","),c.join(","),u.join(",")]}#d(e){if(this.#e===void 0){this.#e="";const t=this.#i.URL;t!==this.#i.baseURI&&(Au(t)?Ue('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=f1(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#r.get(e);if(t)return t;const[s,i,l]=this.#h(e),c=e.length===1?s:`${s}${i}${l}`;if(t=this.#r.get(c),t)return this.#r.set(e,t),t;const u=`g_${this.#n}_transfer_map_${this.#l++}`,h=this.#d(u);this.#r.set(e,h),this.#r.set(c,h);const m=this.#p(u);return this.#g(s,i,l,m),h}addHCMFilter(e,t){const s=`${e}-${t}`,i="base";let l=this.#u.get(i);if(l?.key===s||(l?(l.filter?.remove(),l.key=s,l.url="none",l.filter=null):(l={key:s,url:"none",filter:null},this.#u.set(i,l)),!e||!t))return l.url;const c=this.#y(e);e=Re.makeHexColor(...c);const u=this.#y(t);if(t=Re.makeHexColor(...u),this.#o.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return l.url;const h=new Array(256);for(let v=0;v<=255;v++){const w=v/255;h[v]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const m=h.join(","),p=`g_${this.#n}_hcm_filter`,x=l.filter=this.#p(p);this.#g(m,m,m,x),this.#m(x);const y=(v,w)=>{const A=c[v]/255,N=u[v]/255,j=new Array(w+1);for(let _=0;_<=w;_++)j[_]=A+_/w*(N-A);return j.join(",")};return this.#g(y(0,5),y(1,5),y(2,5),x),l.url=this.#d(p),l.url}addAlphaFilter(e){let t=this.#r.get(e);if(t)return t;const[s]=this.#h([e]),i=`alpha_${s}`;if(t=this.#r.get(i),t)return this.#r.set(e,t),t;const l=`g_${this.#n}_alpha_map_${this.#l++}`,c=this.#d(l);this.#r.set(e,c),this.#r.set(i,c);const u=this.#p(l);return this.#x(s,u),c}addLuminosityFilter(e){let t=this.#r.get(e||"luminosity");if(t)return t;let s,i;if(e?([s]=this.#h([e]),i=`luminosity_${s}`):i="luminosity",t=this.#r.get(i),t)return this.#r.set(e,t),t;const l=`g_${this.#n}_luminosity_map_${this.#l++}`,c=this.#d(l);this.#r.set(e,c),this.#r.set(i,c);const u=this.#p(l);return this.#f(u),e&&this.#x(s,u),c}addHighlightHCMFilter(e,t,s,i,l){const c=`${t}-${s}-${i}-${l}`;let u=this.#u.get(e);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#u.set(e,u)),!t||!s))return u.url;const[h,m]=[t,s].map(this.#y.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),x=Math.round(.2126*m[0]+.7152*m[1]+.0722*m[2]),[y,v]=[i,l].map(this.#y.bind(this));x<p&&([p,x,y,v]=[x,p,v,y]),this.#o.style.color="";const w=(j,_,C)=>{const k=new Array(256),D=(x-p)/C,P=j/255,F=(_-j)/(255*C);let U=0;for(let I=0;I<=C;I++){const K=Math.round(p+I*D),H=P+I*F;for(let X=U;X<=K;X++)k[X]=H;U=K+1}for(let I=U;I<256;I++)k[I]=k[U-1];return k.join(",")},A=`g_${this.#n}_hcm_${e}_filter`,N=u.filter=this.#p(A);return this.#m(N),this.#g(w(y[0],v[0],5),w(y[1],v[1],5),w(y[2],v[2],5),N),u.url=this.#d(A),u.url}destroy(e=!1){e&&this.#a?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#t?.clear(),this.#t=null,this.#a?.clear(),this.#a=null,this.#l=0)}#f(e){const t=this.#i.createElementNS(ha,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#m(e){const t=this.#i.createElementNS(ha,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){const t=this.#i.createElementNS(ha,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#o.append(t),t}#c(e,t,s){const i=this.#i.createElementNS(ha,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",s),e.append(i)}#g(e,t,s,i){const l=this.#i.createElementNS(ha,"feComponentTransfer");i.append(l),this.#c(l,"feFuncR",e),this.#c(l,"feFuncG",t),this.#c(l,"feFuncB",s)}#x(e,t){const s=this.#i.createElementNS(ha,"feComponentTransfer");t.append(s),this.#c(s,"feFuncA",e)}#y(e){return this.#o.style.color=e,Hp(getComputedStyle(this.#o).getPropertyValue("color"))}}class j1{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){xt("Abstract method `_fetch` called.")}}class qb extends j1{async _fetch(e){const t=await Go(e,"arraybuffer");return new Uint8Array(t)}}class S1{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){xt("Abstract method `_fetch` called.")}}class Gb extends S1{async _fetch(e){const t=await Go(e,"arraybuffer");return new Uint8Array(t)}}js&&Ue("Please use the `legacy` build in Node.js environments.");async function $p(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class zT extends N1{}class FT extends w1{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class UT extends A1{async _fetch(e){return $p(e)}}class $T extends j1{async _fetch(e){return $p(e)}}class VT extends S1{async _fetch(e){return $p(e)}}const hs={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function tp(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class Vp{isModifyingCurrentTransform(){return!1}getPattern(){xt("Abstract method `getPattern` called.")}}class qT extends Vp{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let l;if(i===hs.STROKE||i===hs.FILL){const c=t.current.getClippedPathBoundingBox(i,Mt(e))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,h=Math.ceil(c[3]-c[1])||1,m=t.cachedCanvases.getCanvas("pattern",u,h),p=m.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-c[0],-c[1]),s=Re.transform(s,[1,0,0,1,c[0],c[1]]),p.transform(...t.baseTransform),this.matrix&&p.transform(...this.matrix),tp(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),l=e.createPattern(m.canvas,"no-repeat");const x=new DOMMatrix(s);l.setTransform(x)}else tp(e,this._bbox),l=this._createGradient(e);return l}}function mm(n,e,t,s,i,l,c,u){const h=e.coords,m=e.colors,p=n.data,x=n.width*4;let y;h[t+1]>h[s+1]&&(y=t,t=s,s=y,y=l,l=c,c=y),h[s+1]>h[i+1]&&(y=s,s=i,i=y,y=c,c=u,u=y),h[t+1]>h[s+1]&&(y=t,t=s,s=y,y=l,l=c,c=y);const v=(h[t]+e.offsetX)*e.scaleX,w=(h[t+1]+e.offsetY)*e.scaleY,A=(h[s]+e.offsetX)*e.scaleX,N=(h[s+1]+e.offsetY)*e.scaleY,j=(h[i]+e.offsetX)*e.scaleX,_=(h[i+1]+e.offsetY)*e.scaleY;if(w>=_)return;const C=m[l],k=m[l+1],D=m[l+2],P=m[c],F=m[c+1],U=m[c+2],I=m[u],K=m[u+1],H=m[u+2],X=Math.round(w),W=Math.round(_);let ce,me,L,q,V,B,T,G;for(let M=X;M<=W;M++){if(M<N){const we=M<w?0:(w-M)/(w-N);ce=v-(v-A)*we,me=C-(C-P)*we,L=k-(k-F)*we,q=D-(D-U)*we}else{let we;M>_?we=1:N===_?we=0:we=(N-M)/(N-_),ce=A-(A-j)*we,me=P-(P-I)*we,L=F-(F-K)*we,q=U-(U-H)*we}let O;M<w?O=0:M>_?O=1:O=(w-M)/(w-_),V=v-(v-j)*O,B=C-(C-I)*O,T=k-(k-K)*O,G=D-(D-H)*O;const ae=Math.round(Math.min(ce,V)),ee=Math.round(Math.max(ce,V));let pe=x*M+ae*4;for(let we=ae;we<=ee;we++)O=(ce-we)/(ce-V),O<0?O=0:O>1&&(O=1),p[pe++]=me-(me-B)*O|0,p[pe++]=L-(L-T)*O|0,p[pe++]=q-(q-G)*O|0,p[pe++]=255}}function GT(n,e,t){const s=e.coords,i=e.colors;let l,c;switch(e.type){case"lattice":const u=e.verticesPerRow,h=Math.floor(s.length/u)-1,m=u-1;for(l=0;l<h;l++){let p=l*u;for(let x=0;x<m;x++,p++)mm(n,t,s[p],s[p+1],s[p+u],i[p],i[p+1],i[p+u]),mm(n,t,s[p+u+1],s[p+1],s[p+u],i[p+u+1],i[p+1],i[p+u])}break;case"triangles":for(l=0,c=s.length;l<c;l+=3)mm(n,t,s[l],s[l+1],s[l+2],i[l],i[l+1],i[l+2]);break;default:throw new Error("illegal figure")}}class YT extends Vp{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),m=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-h,x=Math.min(Math.ceil(Math.abs(m*e[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),v=m/x,w=p/y,A={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/v,scaleY:1/w},N=x+4,j=y+4,_=s.getCanvas("mesh",N,j),C=_.context,k=C.createImageData(x,y);if(t){const P=k.data;for(let F=0,U=P.length;F<U;F+=4)P[F]=t[0],P[F+1]=t[1],P[F+2]=t[2],P[F+3]=255}for(const P of this._figures)GT(k,P,A);return C.putImageData(k,2,2),{canvas:_.canvas,offsetX:u-2*v,offsetY:h-2*w,scaleX:v,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,i){tp(e,this._bbox);const l=new Float32Array(2);if(i===hs.SHADING)Re.singularValueDecompose2dScale(Mt(e),l);else if(this.matrix){Re.singularValueDecompose2dScale(this.matrix,l);const[u,h]=l;Re.singularValueDecompose2dScale(t.baseTransform,l),l[0]*=u,l[1]*=h}else Re.singularValueDecompose2dScale(t.baseTransform,l);const c=this._createMeshCanvas(l,i===hs.SHADING?null:this._background,t.cachedCanvases);return i!==hs.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(c.offsetX,c.offsetY),e.scale(c.scaleX,c.scaleY),e.createPattern(c.canvas,"no-repeat")}}class WT extends Vp{getPattern(){return"hotpink"}}function XT(n){switch(n[0]){case"RadialAxial":return new qT(n);case"Mesh":return new YT(n);case"Dummy":return new WT}throw new Error(`Unknown IR type: ${n[0]}`)}const Yb={COLORED:1,UNCOLORED:2};class qp{static MAX_PATTERN_SIZE=3e3;constructor(e,t,s,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:l,color:c,canvasGraphicsFactory:u}=this;let{xstep:h,ystep:m}=this;h=Math.abs(h),m=Math.abs(m),wu("TilingType: "+l);const p=t[0],x=t[1],y=t[2],v=t[3],w=y-p,A=v-x,N=new Float32Array(2);Re.singularValueDecompose2dScale(this.matrix,N);const[j,_]=N;Re.singularValueDecompose2dScale(this.baseTransform,N);const C=j*N[0],k=_*N[1];let D=w,P=A,F=!1,U=!1;const I=Math.ceil(h*C),K=Math.ceil(m*k),H=Math.ceil(w*C),X=Math.ceil(A*k);I>=H?D=h:F=!0,K>=X?P=m:U=!0;const W=this.getSizeAndScale(D,this.ctx.canvas.width,C),ce=this.getSizeAndScale(P,this.ctx.canvas.height,k),me=e.cachedCanvases.getCanvas("pattern",W.size,ce.size),L=me.context,q=u.createCanvasGraphics(L);if(q.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(q,i,c),L.translate(-W.scale*p,-ce.scale*x),q.transform(W.scale,0,0,ce.scale,0,0),L.save(),this.clipBbox(q,p,x,y,v),q.baseTransform=Mt(q.ctx),q.executeOperatorList(s),q.endDrawing(),L.restore(),F||U){const V=me.canvas;F&&(D=h),U&&(P=m);const B=this.getSizeAndScale(D,this.ctx.canvas.width,C),T=this.getSizeAndScale(P,this.ctx.canvas.height,k),G=B.size,M=T.size,O=e.cachedCanvases.getCanvas("pattern-workaround",G,M),ae=O.context,ee=F?Math.floor(w/h):0,pe=U?Math.floor(A/m):0;for(let we=0;we<=ee;we++)for(let Te=0;Te<=pe;Te++)ae.drawImage(V,G*we,M*Te,G,M,0,0,G,M);return{canvas:O.canvas,scaleX:B.scale,scaleY:T.scale,offsetX:p,offsetY:x}}return{canvas:me.canvas,scaleX:W.scale,scaleY:ce.scale,offsetX:p,offsetY:x}}getSizeAndScale(e,t,s){const i=Math.max(qp.MAX_PATTERN_SIZE,t);let l=Math.ceil(e*s);return l>=i?l=i:s=l/e,{scale:s,size:l}}clipBbox(e,t,s,i,l){const c=i-t,u=l-s;e.ctx.rect(t,s,c,u),Re.axialAlignedBoundingBox([t,s,i,l],Mt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,l=e.current;switch(t){case Yb.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;i.fillStyle=l.fillColor=c,i.strokeStyle=l.strokeColor=u;break;case Yb.UNCOLORED:i.fillStyle=i.strokeStyle=s,l.fillColor=l.strokeColor=s;break;default:throw new mT(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,i){let l=s;i!==hs.SHADING&&(l=Re.transform(l,t.baseTransform),this.matrix&&(l=Re.transform(l,this.matrix)));const c=this.createPatternCanvas(t);let u=new DOMMatrix(l);u=u.translate(c.offsetX,c.offsetY),u=u.scale(1/c.scaleX,1/c.scaleY);const h=e.createPattern(c.canvas,"repeat");return h.setTransform(u),h}}function QT({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const u=fs.isLittleEndian?4278190080:255,[h,m]=c?[l,u]:[u,l],p=s>>3,x=s&7,y=n.length;t=new Uint32Array(t.buffer);let v=0;for(let w=0;w<i;w++){for(const N=e+p;e<N;e++){const j=e<y?n[e]:255;t[v++]=j&128?m:h,t[v++]=j&64?m:h,t[v++]=j&32?m:h,t[v++]=j&16?m:h,t[v++]=j&8?m:h,t[v++]=j&4?m:h,t[v++]=j&2?m:h,t[v++]=j&1?m:h}if(x===0)continue;const A=e<y?n[e++]:255;for(let N=0;N<x;N++)t[v++]=A&1<<7-N?m:h}return{srcPos:e,destPos:v}}const Wb=16,Xb=100,ZT=15,Qb=10,Os=16,pm=new DOMMatrix,Zs=new Float32Array(2),Vr=new Float32Array([1/0,1/0,-1/0,-1/0]);function KT(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,i,l,c,u){e.transform(t,s,i,l,c,u),this.__originalTransform(t,s,i,l,c,u)},n.setTransform=function(t,s,i,l,c,u){e.setTransform(t,s,i,l,c,u),this.__originalSetTransform(t,s,i,l,c,u)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,l,c,u){e.bezierCurveTo(t,s,i,l,c,u),this.__originalBezierCurveTo(t,s,i,l,c,u)},n.rect=function(t,s,i,l){e.rect(t,s,i,l),this.__originalRect(t,s,i,l)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class JT{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function pd(n,e,t,s,i,l,c,u,h,m){const[p,x,y,v,w,A]=Mt(n);if(x===0&&y===0){const _=c*p+w,C=Math.round(_),k=u*v+A,D=Math.round(k),P=(c+h)*p+w,F=Math.abs(Math.round(P)-C)||1,U=(u+m)*v+A,I=Math.abs(Math.round(U)-D)||1;return n.setTransform(Math.sign(p),0,0,Math.sign(v),C,D),n.drawImage(e,t,s,i,l,0,0,F,I),n.setTransform(p,x,y,v,w,A),[F,I]}if(p===0&&v===0){const _=u*y+w,C=Math.round(_),k=c*x+A,D=Math.round(k),P=(u+m)*y+w,F=Math.abs(Math.round(P)-C)||1,U=(c+h)*x+A,I=Math.abs(Math.round(U)-D)||1;return n.setTransform(0,Math.sign(x),Math.sign(y),0,C,D),n.drawImage(e,t,s,i,l,0,0,I,F),n.setTransform(p,x,y,v,w,A),[I,F]}n.drawImage(e,t,s,i,l,c,u,h,m);const N=Math.hypot(p,x),j=Math.hypot(y,v);return[N*h,j*m]}class Zb{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Qm;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=xs.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t){this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Vr.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=hs.FILL,t=null){const s=this.minMax.slice();if(e===hs.STROKE){t||xt("Stroke bounding box must include transform."),Re.singularValueDecompose2dScale(t,Zs);const i=Zs[0]*this.lineWidth/2,l=Zs[1]*this.lineWidth/2;s[0]-=i,s[1]-=l,s[2]+=i,s[3]+=l}return s}updateClipFromPath(){const e=Re.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Vr,0)}getClippedPathBoundingBox(e=hs.FILL,t=null){return Re.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Kb(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%Os,l=(t-i)/Os,c=i===0?l:l+1,u=n.createImageData(s,Os);let h=0,m;const p=e.data,x=u.data;let y,v,w,A;if(e.kind===kd.GRAYSCALE_1BPP){const N=p.byteLength,j=new Uint32Array(x.buffer,0,x.byteLength>>2),_=j.length,C=s+7>>3,k=4294967295,D=fs.isLittleEndian?4278190080:255;for(y=0;y<c;y++){for(w=y<l?Os:i,m=0,v=0;v<w;v++){const P=N-h;let F=0;const U=P>C?s:P*8-7,I=U&-8;let K=0,H=0;for(;F<I;F+=8)H=p[h++],j[m++]=H&128?k:D,j[m++]=H&64?k:D,j[m++]=H&32?k:D,j[m++]=H&16?k:D,j[m++]=H&8?k:D,j[m++]=H&4?k:D,j[m++]=H&2?k:D,j[m++]=H&1?k:D;for(;F<U;F++)K===0&&(H=p[h++],K=128),j[m++]=H&K?k:D,K>>=1}for(;m<_;)j[m++]=0;n.putImageData(u,0,y*Os)}}else if(e.kind===kd.RGBA_32BPP){for(v=0,A=s*Os*4,y=0;y<l;y++)x.set(p.subarray(h,h+A)),h+=A,n.putImageData(u,0,v),v+=Os;y<c&&(A=s*i*4,x.set(p.subarray(h,h+A)),n.putImageData(u,0,v))}else if(e.kind===kd.RGB_24BPP)for(w=Os,A=s*w,y=0;y<c;y++){for(y>=l&&(w=i,A=s*w),m=0,v=A;v--;)x[m++]=p[h++],x[m++]=p[h++],x[m++]=p[h++],x[m++]=255;n.putImageData(u,0,y*Os)}else throw new Error(`bad image kind: ${e.kind}`)}function Jb(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%Os,l=(t-i)/Os,c=i===0?l:l+1,u=n.createImageData(s,Os);let h=0;const m=e.data,p=u.data;for(let x=0;x<c;x++){const y=x<l?Os:i;({srcPos:h}=QT({src:m,srcPos:h,dest:p,width:s,height:y,nonBlackColor:0})),n.putImageData(u,0,x*Os)}}function ro(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function gd(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function ev(n,e){if(e)return!0;Re.singularValueDecompose2dScale(n,Zs);const t=Math.fround(Wn.pixelRatio*Kr.PDF_TO_CSS_UNITS);return Zs[0]<=t&&Zs[1]<=t}const eD=["butt","round","square"],tD=["miter","round","bevel"],sD={},tv={};class Yr{constructor(e,t,s,i,l,{optionalContentConfig:c,markedContentStack:u=null},h,m){this.ctx=e,this.current=new Zb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new JT(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=m,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=u,s){const h=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Mt(this.compositeCtx))}this.ctx.save(),gd(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Mt(this.ctx)}executeOperatorList(e,t,s,i){const l=e.argsArray,c=e.fnArray;let u=t||0;const h=l.length;if(h===u)return u;const m=h-u>Qb&&typeof s=="function",p=m?Date.now()+ZT:0;let x=0;const y=this.commonObjs,v=this.objs;let w;for(;;){if(i!==void 0&&u===i.nextBreakPoint)return i.breakIt(u,s),u;if(w=c[u],w!==Gd.dependency)this[w].apply(this,l[u]);else for(const A of l[u]){const N=A.startsWith("g_")?y:v;if(!N.has(A))return N.get(A,s),u}if(u++,u===h)return u;if(m&&++x>Qb){if(Date.now()>p)return s(),u;x=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let l=Math.max(Math.hypot(t[0],t[1]),1),c=Math.max(Math.hypot(t[2],t[3]),1),u=s,h=i,m="prescale1",p,x;for(;l>2&&u>1||c>2&&h>1;){let y=u,v=h;l>2&&u>1&&(y=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/y),c>2&&h>1&&(v=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,c/=h/v),p=this.cachedCanvases.getCanvas(m,y,v),x=p.context,x.clearRect(0,0,y,v),x.drawImage(e,0,0,u,h,0,0,y,v),e=p.canvas,u=y,h=v,m=m==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:u,paintHeight:h}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,l=this.current.fillColor,c=this.current.patternFill,u=Mt(t);let h,m,p,x;if((e.bitmap||e.data)&&e.count>1){const I=e.bitmap||e.data.buffer;m=JSON.stringify(c?u:[u.slice(0,4),l]),h=this._cachedBitmapsMap.get(I),h||(h=new Map,this._cachedBitmapsMap.set(I,h));const K=h.get(m);if(K&&!c){const H=Math.round(Math.min(u[0],u[2])+u[4]),X=Math.round(Math.min(u[1],u[3])+u[5]);return{canvas:K,offsetX:H,offsetY:X}}p=K}p||(x=this.cachedCanvases.getCanvas("maskCanvas",s,i),Jb(x.context,e));let y=Re.transform(u,[1/s,0,0,-1/i,0,0]);y=Re.transform(y,[1,0,0,1,0,-i]);const v=Vr.slice();Re.axialAlignedBoundingBox([0,0,s,i],y,v);const[w,A,N,j]=v,_=Math.round(N-w)||1,C=Math.round(j-A)||1,k=this.cachedCanvases.getCanvas("fillCanvas",_,C),D=k.context,P=w,F=A;D.translate(-P,-F),D.transform(...y),p||(p=this._scaleImage(x.canvas,Un(D)),p=p.img,h&&c&&h.set(m,p)),D.imageSmoothingEnabled=ev(Mt(D),e.interpolate),pd(D,p,0,0,p.width,p.height,0,0,s,i),D.globalCompositeOperation="source-in";const U=Re.transform(Un(D),[1,0,0,1,-P,-F]);return D.fillStyle=c?l.getPattern(t,this,U,hs.FILL):l,D.fillRect(0,0,s,i),h&&!c&&(this.cachedCanvases.delete("fillCanvas"),h.set(m,k.canvas)),{canvas:k.canvas,offsetX:Math.round(P),offsetY:Math.round(F)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=eD[e]}setLineJoin(e){this.ctx.lineJoin=tD[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx;const l=this.ctx=i.context;l.setTransform(this.suspendedCtx.getTransform()),ro(this.suspendedCtx,l),KT(l,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ro(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const l=i[0],c=i[1],u=i[2]-l,h=i[3]-c;u===0||h===0||(this.genericComposeSMask(t.context,s,u,h,t.subtype,t.backdrop,t.transferMap,l,c,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,l,c,u,h,m,p,x){let y=e.canvas,v=h-p,w=m-x;if(c)if(v<0||w<0||v+s>y.width||w+i>y.height){const N=this.cachedCanvases.getCanvas("maskExtension",s,i),j=N.context;j.drawImage(y,-v,-w),j.globalCompositeOperation="destination-atop",j.fillStyle=c,j.fillRect(0,0,s,i),j.globalCompositeOperation="source-over",y=N.canvas,v=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const N=new Path2D;N.rect(v,w,s,i),e.clip(N),e.globalCompositeOperation="destination-atop",e.fillStyle=c,e.fillRect(v,w,s,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?t.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(u));const A=new Path2D;A.rect(h,m,s,i),t.clip(A),t.globalCompositeOperation="destination-in",t.drawImage(y,v,w,s,i,h,m,s,i),t.restore()}save(){this.inSMaskMode&&ro(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&ro(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,i,l,c){this.ctx.transform(e,t,s,i,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){let[i]=t;if(!s){i||=t[0]=new Path2D,this[e](i);return}if(!(i instanceof Path2D)){const l=t[0]=new Path2D;for(let c=0,u=i.length;c<u;)switch(i[c++]){case hd.moveTo:l.moveTo(i[c++],i[c++]);break;case hd.lineTo:l.lineTo(i[c++],i[c++]);break;case hd.curveTo:l.bezierCurveTo(i[c++],i[c++],i[c++],i[c++],i[c++],i[c++]);break;case hd.closePath:l.closePath();break;default:Ue(`Unrecognized drawing path operator: ${i[c-1]}`);break}i=l}Re.axialAlignedBoundingBox(s,Mt(this.ctx),this.current.minMax),this[e](i)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const s=this.ctx,i=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&i?.getPattern){const l=i.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=i.getPattern(s,this,Un(s),hs.STROKE),l){const c=new Path2D;c.addPath(e,s.getTransform().invertSelf().multiplySelf(l)),e=c}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(hs.STROKE,Mt(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const s=this.ctx,i=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const h=i.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.fillStyle=i.getPattern(s,this,Un(s),hs.FILL),h){const m=new Path2D;m.addPath(e,s.getTransform().invertSelf().multiplySelf(h)),e=m}c=!0}const u=this.current.getClippedPathBoundingBox();this.contentVisible&&u!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),c&&s.restore(),t&&this.consumePath(e,u)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=sD}eoClip(){this.pendingClip=tv}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const s=new Path2D,i=t.getTransform().invertSelf();for(const{transform:l,x:c,y:u,fontSize:h,path:m}of e)s.addPath(m,new DOMMatrix(l).preMultiplySelf(i).translate(c,u).scale(h,-h));t.clip(s),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||Qm,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Ue("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const l=s.loadedName||"sans-serif",c=s.systemFontInfo?.css||`"${l}", ${s.fallbackName}`;let u="normal";s.black?u="900":s.bold&&(u="bold");const h=s.italic?"italic":"normal";let m=t;t<Wb?m=Wb:t>Xb&&(m=Xb),this.current.fontSizeScale=t/m,this.ctx.font=`${h} ${u} ${m}px ${c}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#s(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i}paintChar(e,t,s,i,l){const c=this.ctx,u=this.current,h=u.font,m=u.textRenderingMode,p=u.fontSize/u.fontSizeScale,x=m&xs.FILL_STROKE_MASK,y=!!(m&xs.ADD_TO_PATH_FLAG),v=u.patternFill&&!h.missingFile,w=u.patternStroke&&!h.missingFile;let A;if((h.disableFontFace||y||v||w)&&(A=h.getPathGenerator(this.commonObjs,e)),h.disableFontFace||v||w){c.save(),c.translate(t,s),c.scale(p,-p);let N;if((x===xs.FILL||x===xs.FILL_STROKE)&&(i?(N=c.getTransform(),c.setTransform(...i),c.fill(this.#s(A,N,i))):c.fill(A)),x===xs.STROKE||x===xs.FILL_STROKE)if(l){N||=c.getTransform(),c.setTransform(...l);const{a:j,b:_,c:C,d:k}=N,D=Re.inverseTransform(l),P=Re.transform([j,_,C,k,0,0],D);Re.singularValueDecompose2dScale(P,Zs),c.lineWidth*=Math.max(Zs[0],Zs[1])/p,c.stroke(this.#s(A,N,l))}else c.lineWidth/=p,c.stroke(A);c.restore()}else(x===xs.FILL||x===xs.FILL_STROKE)&&c.fillText(e,t,s),(x===xs.STROKE||x===xs.FILL_STROKE)&&c.strokeText(e,t,s);y&&(this.pendingTextPaths||=[]).push({transform:Mt(c),x:t,y:s,fontSize:p,path:A})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return et(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const l=this.ctx,c=t.fontSizeScale,u=t.charSpacing,h=t.wordSpacing,m=t.fontDirection,p=t.textHScale*m,x=e.length,y=s.vertical,v=y?1:-1,w=s.defaultVMetrics,A=i*t.fontMatrix[0],N=t.textRenderingMode===xs.FILL&&!s.disableFontFace&&!t.patternFill;l.save(),t.textMatrix&&l.transform(...t.textMatrix),l.translate(t.x,t.y+t.textRise),m>0?l.scale(p,-1):l.scale(p,1);let j,_;if(t.patternFill){l.save();const F=t.fillColor.getPattern(l,this,Un(l),hs.FILL);j=Mt(l),l.restore(),l.fillStyle=F}if(t.patternStroke){l.save();const F=t.strokeColor.getPattern(l,this,Un(l),hs.STROKE);_=Mt(l),l.restore(),l.strokeStyle=F}let C=t.lineWidth;const k=t.textMatrixScale;if(k===0||C===0){const F=t.textRenderingMode&xs.FILL_STROKE_MASK;(F===xs.STROKE||F===xs.FILL_STROKE)&&(C=this.getSinglePixelWidth())}else C/=k;if(c!==1&&(l.scale(c,c),C/=c),l.lineWidth=C,s.isInvalidPDFjsFont){const F=[];let U=0;for(const I of e)F.push(I.unicode),U+=I.width;l.fillText(F.join(""),0,0),t.x+=U*A*p,l.restore(),this.compose();return}let D=0,P;for(P=0;P<x;++P){const F=e[P];if(typeof F=="number"){D+=v*F*i/1e3;continue}let U=!1;const I=(F.isSpace?h:0)+u,K=F.fontChar,H=F.accent;let X,W,ce=F.width;if(y){const L=F.vmetric||w,q=-(F.vmetric?L[1]:ce*.5)*A,V=L[2]*A;ce=L?-L[0]:ce,X=q/c,W=(D+V)/c}else X=D/c,W=0;if(s.remeasure&&ce>0){const L=l.measureText(K).width*1e3/i*c;if(ce<L&&this.isFontSubpixelAAEnabled){const q=ce/L;U=!0,l.save(),l.scale(q,1),X/=q}else ce!==L&&(X+=(ce-L)/2e3*i/c)}if(this.contentVisible&&(F.isInFont||s.missingFile)){if(N&&!H)l.fillText(K,X,W);else if(this.paintChar(K,X,W,j,_),H){const L=X+i*H.offset.x/c,q=W-i*H.offset.y/c;this.paintChar(H.fontChar,L,q,j,_)}}const me=y?ce*A-I*m:ce*A+I*m;D+=me,U&&l.restore()}y?t.y-=D:t.x+=D*p,l.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,l=s.fontSize,c=s.fontDirection,u=i.vertical?1:-1,h=s.charSpacing,m=s.wordSpacing,p=s.textHScale*c,x=s.fontMatrix||Qm,y=e.length,v=s.textRenderingMode===xs.INVISIBLE;let w,A,N,j;if(!(v||l===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),s.textMatrix&&t.transform(...s.textMatrix),t.translate(s.x,s.y+s.textRise),t.scale(p,c),w=0;w<y;++w){if(A=e[w],typeof A=="number"){j=u*A*l/1e3,this.ctx.translate(j,0),s.x+=j*p;continue}const _=(A.isSpace?m:0)+h,C=i.charProcOperatorList[A.operatorListId];C?this.contentVisible&&(this.save(),t.scale(l,l),t.transform(...x),this.executeOperatorList(C),this.restore()):Ue(`Type3 character "${A.operatorListId}" is not available.`);const k=[A.width,0];Re.applyTransform(k,x),N=k[0]*l+_,t.translate(N,0),s.x+=N*p}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,l,c){const u=new Path2D;u.rect(s,i,l-s,c-i),this.ctx.clip(u),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=this.baseTransform||Mt(this.ctx),i={createCanvasGraphics:l=>new Yr(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new qp(e,this.ctx,i,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=XT(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,Un(t),hs.SHADING);const i=Un(t);if(i){const{width:l,height:c}=t.canvas,u=Vr.slice();Re.axialAlignedBoundingBox([0,0,l,c],i,u);const[h,m,p,x]=u;this.ctx.fillRect(h,m,p-h,x-m)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){xt("Should not call beginInlineImage")}beginImageData(){xt("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Mt(this.ctx),t)){Re.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[s,i,l,c]=t,u=new Path2D;u.rect(s,i,l-s,c-i),this.ctx.clip(u),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||wu("TODO: Support non-isolated groups."),e.knockout&&Ue("Knockout groups not supported.");const s=Mt(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=Vr.slice();Re.axialAlignedBoundingBox(e.bbox,Mt(t),i);const l=[0,0,t.canvas.width,t.canvas.height];i=Re.intersect(i,l)||[0,0,0,0];const c=Math.floor(i[0]),u=Math.floor(i[1]),h=Math.max(Math.ceil(i[2])-c,1),m=Math.max(Math.ceil(i[3])-u,1);this.current.startNewPathAndClipBox([0,0,h,m]);let p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);const x=this.cachedCanvases.getCanvas(p,h,m),y=x.context;y.translate(-c,-u),y.transform(...s);let v=new Path2D;const[w,A,N,j]=e.bbox;if(v.rect(w,A,N-w,j-A),e.matrix){const _=new Path2D;_.addPath(v,new DOMMatrix(e.matrix)),v=_}y.clip(v),e.smask?this.smaskStack.push({canvas:x.canvas,context:y,offsetX:c,offsetY:u,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(c,u),t.save()),ro(t,y),this.ctx=y,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Mt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const l=Vr.slice();Re.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i,l),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(e,t,s,i,l){if(this.#e(),gd(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const c=t[2]-t[0],u=t[3]-t[1];if(l&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=c,t[3]=u,Re.singularValueDecompose2dScale(Mt(this.ctx),Zs);const{viewportScale:h}=this,m=Math.ceil(c*this.outputScaleX*h),p=Math.ceil(u*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(m,p);const{canvas:x,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(e,x),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(Zs[0],0,0,-Zs[1],0,u*Zs[1]),gd(this.ctx)}else{gd(this.ctx),this.endPath();const h=new Path2D;h.rect(t[0],t[1],c,u),this.ctx.clip(h)}}this.current=new Zb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this._createMaskCanvas(e),l=i.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(l,i.offsetX,i.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,l,c){if(!this.contentVisible)return;e=this.getObject(e.data,e);const u=this.ctx;u.save();const h=Mt(u);u.transform(t,s,i,l,0,0);const m=this._createMaskCanvas(e);u.setTransform(1,0,0,1,m.offsetX-h[4],m.offsetY-h[5]);for(let p=0,x=c.length;p<x;p+=2){const y=Re.transform(h,[t,s,i,l,c[p],c[p+1]]);u.drawImage(m.canvas,y[4],y[5])}u.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const l of e){const{data:c,width:u,height:h,transform:m}=l,p=this.cachedCanvases.getCanvas("maskCanvas",u,h),x=p.context;x.save();const y=this.getObject(c,l);Jb(x,y),x.globalCompositeOperation="source-in",x.fillStyle=i?s.getPattern(x,this,Un(t),hs.FILL):s,x.fillRect(0,0,u,h),x.restore(),t.save(),t.transform(...m),t.scale(1,-1),pd(t,p.canvas,0,0,u,h,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Ue("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const l=this.getObject(e);if(!l){Ue("Dependent image isn't ready yet");return}const c=l.width,u=l.height,h=[];for(let m=0,p=i.length;m<p;m+=2)h.push({transform:[t,0,0,s,i[m],i[m+1]],x:0,y:0,w:c,h:u});this.paintInlineImageXObjectGroup(l,h)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,l=this.cachedCanvases.getCanvas("inlineImage",s,i),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(t,0,0),c.filter="none",l.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;this.save();const{filter:l}=i;l!=="none"&&l!==""&&(i.filter="none"),i.scale(1/t,-1/s);let c;if(e.bitmap)c=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)c=e;else{const m=this.cachedCanvases.getCanvas("inlineImage",t,s).context;Kb(m,e),c=this.applyTransferMapsToCanvas(m)}const u=this._scaleImage(c,Un(i));i.imageSmoothingEnabled=ev(Mt(i),e.interpolate),pd(i,u.img,0,0,u.paintWidth,u.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const l=e.width,c=e.height,h=this.cachedCanvases.getCanvas("inlineImage",l,c).context;Kb(h,e),i=this.applyTransferMapsToCanvas(h)}for(const l of t)s.save(),s.transform(...l.transform),s.scale(1,-1),pd(s,i,l.x,l.y,l.w,l.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(s||(this.pendingClip===tv?i.clip(e,"evenodd"):i.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Mt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:l}=this.ctx.getTransform();let c,u;if(s===0&&i===0){const h=Math.abs(t),m=Math.abs(l);if(h===m)if(e===0)c=u=1/h;else{const p=h*e;c=u=p<1?1/p:1}else if(e===0)c=1/h,u=1/m;else{const p=h*e,x=m*e;c=p<1?1/p:1,u=x<1?1/x:1}}else{const h=Math.abs(t*l-s*i),m=Math.hypot(t,s),p=Math.hypot(i,l);if(e===0)c=p/h,u=m/h;else{const x=e*h;c=p>x?p/x:1,u=m>x?m/x:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:i}}=this,[l,c]=this.getScaleForStroking();if(l===c){s.lineWidth=(i||1)*l,s.stroke(e);return}const u=s.getLineDash();t&&s.save(),s.scale(l,c),pm.a=1/l,pm.d=1/c;const h=new Path2D;if(h.addPath(e,pm),u.length>0){const m=Math.max(l,c);s.setLineDash(u.map(p=>p/m)),s.lineDashOffset/=m}s.lineWidth=i||1,s.stroke(h),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const n in Gd)Yr.prototype[n]!==void 0&&(Yr.prototype[Gd[n]]=Yr.prototype[n]);class Wr{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class nD{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const zr=Symbol("INTERNAL");class aD{#e=!1;#t=!1;#s=!1;#n=!0;constructor(e,{name:t,intent:s,usage:i,rbGroups:l}){this.#e=!!(e&Qs.DISPLAY),this.#t=!!(e&Qs.PRINT),this.name=t,this.intent=s,this.usage=i,this.rbGroups=l}get visible(){if(this.#s)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,s=!1){e!==zr&&xt("Internal method `_setVisible` called."),this.#s=s,this.#n=t}}class iD{#e=null;#t=new Map;#s=null;#n=null;constructor(e,t=Qs.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const s of e.groups)this.#t.set(s.id,new aD(t,s));if(e.baseState==="OFF")for(const s of this.#t.values())s._setVisible(zr,!1);for(const s of e.on)this.#t.get(s)._setVisible(zr,!0);for(const s of e.off)this.#t.get(s)._setVisible(zr,!1);this.#s=this.getHash()}}#i(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const l=e[i];let c;if(Array.isArray(l))c=this.#i(l);else if(this.#t.has(l))c=this.#t.get(l).visible;else return Ue(`Optional content group not found: ${l}`),!0;switch(s){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return s==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return wu("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Ue(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#i(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Ue(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Ue(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Ue(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Ue(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Ue(`Unknown optional content policy ${e.policy}.`),!0}return Ue(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){const i=this.#t.get(e);if(!i){Ue(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const l of i.rbGroups)for(const c of l)c!==e&&this.#t.get(c)?._setVisible(zr,!1,!0);i._setVisible(zr,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const l=this.#t.get(i);if(l)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!l.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new b1;for(const[t,s]of this.#t)e.update(`${t}:${s.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class rD{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Wt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:l,progressiveDone:c,contentDispositionFilename:u}=e;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=u,l?.length>0){const h=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,m)=>{this._onReceiveData({begin:h,chunk:m})}),e.addProgressListener((h,m)=>{this._onProgress({loaded:h,total:m})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(l){return l._begin!==e?!1:(l._enqueue(s),!0)});Wt(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Wt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new lD(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new oD(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class lD{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=Bp(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class oD{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function cD(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let p=u(t);return p=unescape(p),p=h(p),p=m(p),l(p)}if(t=c(n),t){const p=m(t);return l(p)}if(t=s("filename","i").exec(n),t){t=t[1];let p=u(t);return p=m(p),l(p)}function s(p,x){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',x)}function i(p,x){if(p){if(!/^[\x00-\xFF]+$/.test(x))return x;try{const y=new TextDecoder(p,{fatal:!0}),v=qo(x);x=y.decode(v),e=!1}catch{}}return x}function l(p){return e&&/[\x80-\xff]/.test(p)&&(p=i("utf-8",p),e&&(p=i("iso-8859-1",p))),p}function c(p){const x=[];let y;const v=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=v.exec(p))!==null;){let[,A,N,j]=y;if(A=parseInt(A,10),A in x){if(A===0)break;continue}x[A]=[N,j]}const w=[];for(let A=0;A<x.length&&A in x;++A){let[N,j]=x[A];j=u(j),N&&(j=unescape(j),A===0&&(j=h(j))),w.push(j)}return w.join("")}function u(p){if(p.startsWith('"')){const x=p.slice(1).split('\\"');for(let y=0;y<x.length;++y){const v=x[y].indexOf('"');v!==-1&&(x[y]=x[y].slice(0,v),x.length=y+1),x[y]=x[y].replaceAll(/\\(.)/g,"$1")}p=x.join('"')}return p}function h(p){const x=p.indexOf("'");if(x===-1)return p;const y=p.slice(0,x),w=p.slice(x+1).replace(/^[^']*'/,"");return i(y,w)}function m(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(x,y,v,w){if(v==="q"||v==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,N){return String.fromCharCode(parseInt(N,16))}),i(y,w);try{w=atob(w)}catch{}return i(y,w)})}return""}function E1(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function ju(n){return URL.parse(n)?.origin??null}function _1({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(n.get("Content-Length"),10);return!Number.isInteger(l)||(i.suggestedLength=l,l<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function C1(n){const e=n.get("Content-Disposition");if(e){let t=cD(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Bp(t))return t}return null}function Xo(n,e){return new Yd(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function T1(n){return n===200||n===206}function D1(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function R1(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Ue(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class dD{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=E1(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Wt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new uD(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new hD(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class uD{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,D1(s,this._withCredentials,this._abortController)).then(l=>{if(e._responseOrigin=ju(l.url),!T1(l.status))throw Xo(l.status,i);this._reader=l.body.getReader(),this._headersCapability.resolve();const c=l.headers,{allowRangeRequests:u,suggestedLength:h}=_1({responseHeaders:c,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=C1(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ja("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:R1(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class hD{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const l=new Headers(e.headers);l.append("Range",`bytes=${t}-${s-1}`);const c=i.url;fetch(c,D1(l,this._withCredentials,this._abortController)).then(u=>{const h=ju(u.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!T1(u.status))throw Xo(u.status,c);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:R1(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const gm=200,xm=206;function fD(n){const e=n.response;return typeof e!="string"?e:qo(e).buffer}class mD{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:s}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=E1(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[l,c]of this.headers)t.setRequestHeader(l,c);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=xm):i.expectedStatus=gm,t.responseType="arraybuffer",Wt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){const s=this.pendingRequests[e];s&&s.onProgress?.(t)}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const l=i.status||gm;if(!(l===gm&&s.expectedStatus===xm)&&l!==s.expectedStatus){s.onError(i.status);return}const u=fD(i);if(l===xm){const h=i.getResponseHeader("Content-Range"),m=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);m?s.onDone({begin:parseInt(m[1],10),chunk:u}):(Ue('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class pD{constructor(e){this._source=e,this._manager=new mD(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Wt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new gD(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new xD(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class gD{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=ju(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...m]=u.split(": ");return[h,m.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:c}=_1({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=C1(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Xo(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class xD{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=ju(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=Xo(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const yD=/^[a-z][a-z0-9\-+.]+:/i;function bD(n){if(yD.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class vD{constructor(e){this.source=e,this.url=bD(e.url),Wt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Wt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new wD(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new AD(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class wD{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=Xo(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ja("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class AD{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const lo=Symbol("INITIAL_DATA");class k1{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:lo}}get(e,t=null){if(t){const i=this.#t(e);return i.promise.then(()=>t(i.data)),null}const s=this.#e[e];if(!s||s.data===lo)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=this.#e[e];return!!t&&t.data!==lo}delete(e){const t=this.#e[e];return!t||t.data===lo?!1:(delete this.#e[e],!0)}resolve(e,t=null){const s=this.#t(e);s.data=t,s.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==lo&&(yield[e,t])}}}const ND=1e5,sv=30;class Ns{#e=Promise.withResolvers();#t=null;#s=!1;#n=!!globalThis.FontInspector?.enabled;#i=null;#a=null;#l=0;#r=0;#u=null;#o=null;#h=0;#d=0;#f=Object.create(null);#m=[];#p=null;#c=[];#g=new WeakMap;#x=null;static#y=new Map;static#v=new Map;static#w=new WeakMap;static#A=null;static#S=new Set;constructor({textContentSource:e,container:t,viewport:s}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(h){h.enqueue(e),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#o=t,this.#d=s.scale*Wn.pixelRatio,this.#h=s.rotation,this.#a={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:l,pageX:c,pageY:u}=s.rawDims;this.#x=[1,0,0,-1,-c,u+l],this.#r=i,this.#l=l,Ns.#R(),Ui(t,s),this.#e.promise.finally(()=>{Ns.#S.delete(this),this.#a=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=fs.platform;return et(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#u.read().then(({value:t,done:s})=>{if(s){this.#e.resolve();return}this.#i??=t.lang,Object.assign(this.#f,t.styles),this.#_(t.items),e()},this.#e.reject)};return this.#u=this.#p.getReader(),Ns.#S.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const s=e.scale*Wn.pixelRatio,i=e.rotation;if(i!==this.#h&&(t?.(),this.#h=i,Ui(this.#o,{rotation:i})),s!==this.#d){t?.(),this.#d=s;const l={div:null,properties:null,ctx:Ns.#C(this.#i)};for(const c of this.#c)l.properties=this.#g.get(c),l.div=c,this.#N(l)}}cancel(){const e=new Ja("TextLayer task cancelled.");this.#u?.cancel(e).catch(()=>{}),this.#u=null,this.#e.reject(e)}get textDivs(){return this.#c}get textContentItemsStr(){return this.#m}#_(e){if(this.#s)return;this.#a.ctx??=Ns.#C(this.#i);const t=this.#c,s=this.#m;for(const i of e){if(t.length>ND){Ue("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){const l=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),i.id!==null&&this.#t.setAttribute("id",`${i.id}`),l.append(this.#t)}else i.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}s.push(i.str),this.#T(i)}}#T(e){const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#c.push(t);const i=Re.transform(this.#x,e.transform);let l=Math.atan2(i[1],i[0]);const c=this.#f[e.fontName];c.vertical&&(l+=Math.PI/2);let u=this.#n&&c.fontSubstitution||c.fontFamily;u=Ns.fontFamilyMap.get(u)||u;const h=Math.hypot(i[2],i[3]),m=h*Ns.#k(u,c,this.#i);let p,x;l===0?(p=i[4],x=i[5]-m):(p=i[4]+m*Math.sin(l),x=i[5]-m*Math.cos(l));const y="calc(var(--total-scale-factor) *",v=t.style;this.#t===this.#o?(v.left=`${(100*p/this.#r).toFixed(2)}%`,v.top=`${(100*x/this.#l).toFixed(2)}%`):(v.left=`${y}${p.toFixed(2)}px)`,v.top=`${y}${x.toFixed(2)}px)`),v.fontSize=`${y}${(Ns.#A*h).toFixed(2)}px)`,v.fontFamily=u,s.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=c.fontSubstitutionLoadedName||e.fontName),l!==0&&(s.angle=l*(180/Math.PI));let w=!1;if(e.str.length>1)w=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const A=Math.abs(e.transform[0]),N=Math.abs(e.transform[3]);A!==N&&Math.max(A,N)/Math.min(A,N)>1.5&&(w=!0)}if(w&&(s.canvasWidth=c.vertical?e.height:e.width),this.#g.set(t,s),this.#a.div=t,this.#a.properties=s,this.#N(this.#a),s.hasText&&this.#t.append(t),s.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),this.#t.append(A)}}#N(e){const{div:t,properties:s,ctx:i}=e,{style:l}=t;let c="";if(Ns.#A>1&&(c=`scale(${1/Ns.#A})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:u}=l,{canvasWidth:h,fontSize:m}=s;Ns.#E(i,m*this.#d,u);const{width:p}=i.measureText(t.textContent);p>0&&(c=`scaleX(${h*this.#d/p}) ${c}`)}s.angle!==0&&(c=`rotate(${s.angle}deg) ${c}`),c.length>0&&(l.transform=c)}static cleanup(){if(!(this.#S.size>0)){this.#y.clear();for(const{canvas:e}of this.#v.values())e.remove();this.#v.clear()}}static#C(e=null){let t=this.#v.get(e||="");if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(e,t),this.#w.set(t,{size:0,family:""})}return t}static#E(e,t,s){const i=this.#w.get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)}static#R(){if(this.#A!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#A=e.getBoundingClientRect().height,e.remove()}static#k(e,t,s){const i=this.#y.get(e);if(i)return i;const l=this.#C(s);l.canvas.width=l.canvas.height=sv,this.#E(l,sv,e);const c=l.measureText(""),u=c.fontBoundingBoxAscent,h=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let m=.8;return u?m=u/(u+h):(fs.platform.isFirefox&&Ue("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?m=t.ascent:t.descent&&(m=1+t.descent)),this.#y.set(e,m),m}}class Do{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(l){if(!l)return;let c=null;const u=l.name;if(u==="#text")c=l.value;else if(Do.shouldBuildText(u))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&t.push({str:c}),!!l.children)for(const h of l.children)i(h)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const jD=100;function SD(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new Gp,{docId:t}=e,s=n.url?MT(n.url):null,i=n.data?LT(n.data):null,l=n.httpHeaders||null,c=n.withCredentials===!0,u=n.password??null,h=n.range instanceof M1?n.range:null,m=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let p=n.worker instanceof Ro?n.worker:null;const x=n.verbosity,y=typeof n.docBaseUrl=="string"&&!Au(n.docBaseUrl)?n.docBaseUrl:null,v=fd(n.cMapUrl),w=n.cMapPacked!==!1,A=n.CMapReaderFactory||(js?UT:Vb),N=fd(n.iccUrl),j=fd(n.standardFontDataUrl),_=n.StandardFontDataFactory||(js?$T:qb),C=fd(n.wasmUrl),k=n.WasmFactory||(js?VT:Gb),D=n.stopAtErrors!==!0,P=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,F=n.isEvalSupported!==!1,U=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!js,I=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!js&&(fs.platform.isFirefox||!globalThis.chrome),K=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,H=typeof n.disableFontFace=="boolean"?n.disableFontFace:js,X=n.fontExtraProperties===!0,W=n.enableXfa===!0,ce=n.ownerDocument||globalThis.document,me=n.disableRange===!0,L=n.disableStream===!0,q=n.disableAutoFetch===!0,V=n.pdfBug===!0,B=n.CanvasFactory||(js?FT:BT),T=n.FilterFactory||(js?zT:HT),G=n.enableHWA===!0,M=n.useWasm!==!1,O=h?h.length:n.length??NaN,ae=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!js&&!H,ee=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(A===Vb&&_===qb&&k===Gb&&v&&j&&C&&po(v,document.baseURI)&&po(j,document.baseURI)&&po(C,document.baseURI)),pe=null;uT(x);const we={canvasFactory:new B({ownerDocument:ce,enableHWA:G}),filterFactory:new T({docId:t,ownerDocument:ce}),cMapReaderFactory:ee?null:new A({baseUrl:v,isCompressed:w}),standardFontDataFactory:ee?null:new _({baseUrl:j}),wasmFactory:ee?null:new k({baseUrl:C})};p||(p=Ro.create({verbosity:x,port:Wr.workerPort}),e._worker=p);const Te={docId:t,apiVersion:"5.3.93",data:i,password:u,disableAutoFetch:q,rangeChunkSize:m,length:O,docBaseUrl:y,enableXfa:W,evaluatorOptions:{maxImageSize:P,disableFontFace:H,ignoreErrors:D,isEvalSupported:F,isOffscreenCanvasSupported:U,isImageDecoderSupported:I,canvasMaxAreaInBytes:K,fontExtraProperties:X,useSystemFonts:ae,useWasm:M,useWorkerFetch:ee,cMapUrl:v,iccUrl:N,standardFontDataUrl:j,wasmUrl:C}},ue={ownerDocument:ce,pdfBug:V,styleElement:pe,loadingParams:{disableAutoFetch:q,enableXfa:W}};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const He=p.messageHandler.sendWithPromise("GetDocRequest",Te,i?[i.buffer]:null);let ze;if(h)ze=new rD(h,{disableRange:me,disableStream:L});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");const at=po(s)?dD:js?vD:pD;ze=new at({url:s,length:O,httpHeaders:l,withCredentials:c,rangeChunkSize:m,disableRange:me,disableStream:L})}return He.then(at=>{if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const At=new go(t,at,p.port),le=new CD(At,e,ze,ue,we);e._transport=le,At.send("Ready",null)})}).catch(e._capability.reject),e}class Gp{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Gp.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class M1{#e=Promise.withResolvers();#t=[];#s=[];#n=[];#i=[];constructor(e,t,s=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i}addRangeListener(e){this.#i.push(e)}addProgressListener(e){this.#n.push(e)}addProgressiveReadListener(e){this.#s.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const s of this.#i)s(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const s of this.#n)s(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#s)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){xt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class ED{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return et(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class _D{#e=!1;constructor(e,t,s,i=!1){this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new Fb:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new k1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:l=!1}={}){return new Yo({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:l})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return et(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=Ya.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:u=null,annotationCanvasMap:h=null,pageColors:m=null,printAnnotationStorage:p=null,isEditing:x=!1}){this._stats?.time("Overall");const y=this._transport.getRenderingIntent(s,i,p,x),{renderingIntent:v,cacheKey:w}=y;this.#e=!1,u||=this._transport.getOptionalContentConfig(v);let A=this._intentStates.get(w);A||(A=Object.create(null),this._intentStates.set(w,A)),A.streamReaderCancelTimeout&&(clearTimeout(A.streamReaderCancelTimeout),A.streamReaderCancelTimeout=null);const N=!!(v&Qs.PRINT);A.displayReadyCapability||(A.displayReadyCapability=Promise.withResolvers(),A.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(y));const j=k=>{A.renderTasks.delete(_),N&&(this.#e=!0),this.#t(),k?(_.capability.reject(k),this._abortOperatorList({intentState:A,reason:k instanceof Error?k:new Error(k)})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},_=new qr({callback:j,params:{canvasContext:e,viewport:t,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:A.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!N,pdfBug:this._pdfBug,pageColors:m});(A.renderTasks||=new Set).add(_);const C=_.task;return Promise.all([A.displayReadyCapability.promise,u]).then(([k,D])=>{if(this.destroyed){j();return}if(this._stats?.time("Rendering"),!(D.renderingIntent&v))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");_.initializeGraphics({transparency:k,optionalContentConfig:D}),_.operatorListChanged()}).catch(j),C}getOperatorList({intent:e="display",annotationMode:t=Ya.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const c=this._transport.getRenderingIntent(e,t,s,i,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Do.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function l(){c.read().then(function({value:h,done:m}){if(m){s(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),l()},i)}const c=t.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new Fb),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const s=this._intentStates.get(t);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:l,transfer:c}=s,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:l,modifiedIds:i},c).getReader(),m=this._intentStates.get(t);m.streamReader=h;const p=()=>{h.read().then(({value:x,done:y})=>{if(y){m.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(x,m),p())},x=>{if(m.streamReader=null,!this._transport.destroyed){if(m.operatorList){m.operatorList.lastChunk=!0;for(const y of m.renderTasks)y.operatorListChanged();this.#t()}if(m.displayReadyCapability)m.displayReadyCapability.reject(x);else if(m.opListReadCapability)m.opListReadCapability.reject(x);else throw x}})};p()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof Ip){let i=jD;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Ja(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,l]of this._intentStates)if(l===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}var Wa,jn,ma,Li,du,Oi,Pi,Es,Md,L1,O1,xo,Zr,Ld;const _t=class _t{constructor({name:e=null,port:t=null,verbosity:s=hT()}={}){Hn(this,Es);Hn(this,Wa,Promise.withResolvers());Hn(this,jn,null);Hn(this,ma,null);Hn(this,Li,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(Et(_t,Pi).has(t))throw new Error("Cannot use more than one PDFWorker per port.");Et(_t,Pi).set(t,this),zn(this,Es,L1).call(this,t)}else zn(this,Es,O1).call(this)}get promise(){return Et(this,Wa).promise}get port(){return Et(this,ma)}get messageHandler(){return Et(this,jn)}destroy(){this.destroyed=!0,Et(this,Li)?.terminate(),Ms(this,Li,null),Et(_t,Pi).delete(Et(this,ma)),Ms(this,ma,null),Et(this,jn)?.destroy(),Ms(this,jn,null)}static create(e){const t=Et(this,Pi).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new _t(e)}static get workerSrc(){if(Wr.workerSrc)return Wr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return et(this,"_setupFakeWorkerGlobal",(async()=>Et(this,Zr,Ld)?Et(this,Zr,Ld):(await import(this.workerSrc)).WorkerMessageHandler)())}};Wa=new WeakMap,jn=new WeakMap,ma=new WeakMap,Li=new WeakMap,du=new WeakMap,Oi=new WeakMap,Pi=new WeakMap,Es=new WeakSet,Md=function(){Et(this,Wa).resolve(),Et(this,jn).send("configure",{verbosity:this.verbosity})},L1=function(e){Ms(this,ma,e),Ms(this,jn,new go("main","worker",e)),Et(this,jn).on("ready",()=>{}),zn(this,Es,Md).call(this)},O1=function(){if(Et(_t,Oi)||Et(_t,Zr,Ld)){zn(this,Es,xo).call(this);return}let{workerSrc:e}=_t;try{_t._isSameOrigin(window.location,e)||(e=_t._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new go("main","worker",t),i=()=>{l.abort(),s.destroy(),t.terminate(),this.destroyed?Et(this,Wa).reject(new Error("Worker was destroyed")):zn(this,Es,xo).call(this)},l=new AbortController;t.addEventListener("error",()=>{Et(this,Li)||i()},{signal:l.signal}),s.on("test",u=>{if(l.abort(),this.destroyed||!u){i();return}Ms(this,jn,s),Ms(this,ma,t),Ms(this,Li,t),zn(this,Es,Md).call(this)}),s.on("ready",u=>{if(l.abort(),this.destroyed){i();return}try{c()}catch{zn(this,Es,xo).call(this)}});const c=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};c();return}catch{wu("The worker has been disabled.")}zn(this,Es,xo).call(this)},xo=function(){Et(_t,Oi)||(Ue("Setting up fake worker."),Ms(_t,Oi,!0)),_t._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){Et(this,Wa).reject(new Error("Worker was destroyed"));return}const t=new IT;Ms(this,ma,t);const s=`fake${ob(_t,du)._++}`,i=new go(s+"_worker",s,t);e.setup(i,t),Ms(this,jn,new go(s,s+"_worker",t)),zn(this,Es,Md).call(this)}).catch(e=>{Et(this,Wa).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Zr=new WeakSet,Ld=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Hn(_t,Zr),Hn(_t,du,0),Hn(_t,Oi,!1),Hn(_t,Pi,new WeakMap),js&&(Ms(_t,Oi,!0),Wr.workerSrc||="./pdf.worker.mjs"),_t._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!s?.origin||s.origin==="null")return!1;const i=new URL(t,s);return s.origin===i.origin},_t._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},_t.fromPort=e=>{if(jT("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return _t.create(e)};let Ro=_t;class CD{#e=new Map;#t=new Map;#s=new Map;#n=new Map;#i=null;constructor(e,t,s,i,l){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new k1,this.fontLoader=new RT({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#a(e,t=null){const s=this.#e.get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,i),i}get annotationStorage(){return et(this,"annotationStorage",new Up)}getRenderingIntent(e,t=Ya.ENABLE,s=null,i=!1,l=!1){let c=Qs.DISPLAY,u=Jm;switch(e){case"any":c=Qs.ANY;break;case"display":break;case"print":c=Qs.PRINT;break;default:Ue(`getRenderingIntent - invalid intent: ${e}`)}const h=c&Qs.PRINT&&s instanceof v1?s:this.annotationStorage;switch(t){case Ya.DISABLE:c+=Qs.ANNOTATIONS_DISABLE;break;case Ya.ENABLE:break;case Ya.ENABLE_FORMS:c+=Qs.ANNOTATIONS_FORMS;break;case Ya.ENABLE_STORAGE:c+=Qs.ANNOTATIONS_STORAGE,u=h.serializable;break;default:Ue(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(c+=Qs.IS_EDITING),l&&(c+=Qs.OPLIST);const{ids:m,hash:p}=h.modifiedIds,x=[c,u.hash,p];return{renderingIntent:c,cacheKey:x.join("_"),annotationStorageSerializable:u,modifiedIds:m}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#i?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of this.#t.values())e.push(s._destroy());this.#t.clear(),this.#s.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Ns.cleanup(),this._networkStream?.cancelAllRequests(new Ja("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{Wt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},i.onPull=()=>{this._fullReader.read().then(function({value:l,done:c}){if(c){i.close();return}Wt(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{i.error(l)})},i.onCancel=l=>{this._fullReader.cancel(l),i.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:l,contentLength:c}=this._fullReader;return(!i||!l)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{t.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:i,isRangeSupported:l,contentLength:c}}),e.on("GetRangeReader",(s,i)=>{Wt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(s.begin,s.end);if(!l){i.close();return}i.onPull=()=>{l.read().then(function({value:c,done:u}){if(u){i.close();return}Wt(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{i.error(c)})},i.onCancel=c=>{l.cancel(c),i.ready.catch(u=>{if(!this.destroyed)throw u})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new ED(s,this))}),e.on("DocException",s=>{t._capability.reject(Ls(s))}),e.on("PasswordRequest",s=>{this.#i=Promise.withResolvers();try{if(!t.onPassword)throw Ls(s);const i=l=>{l instanceof Error?this.#i.reject(l):this.#i.resolve({password:l})};t.onPassword(i,s.code)}catch(i){this.#i.reject(i)}return this.#i.promise}),e.on("DataLoaded",s=>{t.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;this.#t.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,l])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":if("error"in l){const m=l.error;Ue(`Error during font loading: ${m}`),this.commonObjs.resolve(s,m);break}const c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(m,p)=>globalThis.FontInspector.fontAdded(m,p):null,u=new kT(l,c);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!u.fontExtraProperties&&u.data&&(u.data=null),this.commonObjs.resolve(s,u)});break;case"CopyLocalImage":const{imageRef:h}=l;Wt(h,"The imageRef must be defined.");for(const m of this.#t.values())for(const[,p]of m.objs)if(p?.ref===h)return p.dataLen?(this.commonObjs.resolve(s,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,l);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,l,c])=>{if(this.destroyed)return;const u=this.#t.get(i);if(!u.objs.has(s)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(s,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),e.on("DocProgress",s=>{this.destroyed||t.onProgress?.({loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[s.type];if(!i)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ue("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=this.#s.get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#n.set(l.refStr,e);const c=new _D(t,l,this,this._params.pdfBug);return this.#t.set(t,c),c});return this.#s.set(t,i),i}getPageIndex(e){return ep(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#a("GetFieldObjects")}hasJSActions(){return this.#a("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#a("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#a("GetOptionalContentConfig").then(t=>new iD(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new nD(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Ns.cleanup()}}cachedPageNumber(e){if(!ep(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#n.get(t)??null}}class TD{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class qr{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:l,operatorList:c,pageIndex:u,canvasFactory:h,filterFactory:m,useRequestAnimationFrame:p=!1,pdfBug:x=!1,pageColors:y=null}){this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=m,this._pdfBug=x,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new TD(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(qr.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");qr.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:l,background:c}=this.params;this.gfx=new Yr(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:l,viewport:i,transparency:e,background:c}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),qr.#t.delete(this._canvas),e||=new Ip(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),qr.#t.delete(this._canvas),this.callback())))}}const P1="5.3.93",DD="cbeef3233";function nv(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function oo(n){return Math.max(0,Math.min(255,255*n))}class av{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=oo(e),[e,e,e]}static G_HTML([e]){const t=nv(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(oo)}static RGB_HTML(e){return`#${e.map(nv).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[oo(1-Math.min(1,e+i)),oo(1-Math.min(1,s+i)),oo(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,l=1-t,c=1-s,u=Math.min(i,l,c);return["CMYK",i,l,c,u]}}class RD{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){xt("Abstract method `_createSVG` called.")}}class Wd extends RD{_createSVG(e){return document.createElementNS(ha,e)}}class I1{static setupStorage(e,t,s,i,l){const c=i.getValue(t,{value:null});switch(s.name){case"textarea":if(c.value!==null&&(e.textContent=c.value),l==="print")break;e.addEventListener("input",u=>{i.setValue(t,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(c.value===s.attributes.xfaOn?e.setAttribute("checked",!0):c.value===s.attributes.xfaOff&&e.removeAttribute("checked"),l==="print")break;e.addEventListener("change",u=>{i.setValue(t,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&e.setAttribute("value",c.value),l==="print")break;e.addEventListener("input",u=>{i.setValue(t,{value:u.target.value})})}break;case"select":if(c.value!==null){e.setAttribute("value",c.value);for(const u of s.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}e.addEventListener("input",u=>{const h=u.target.options,m=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(t,{value:m})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:l}){const{attributes:c}=t,u=e instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${i}`);for(const[h,m]of Object.entries(c))if(m!=null)switch(h){case"class":m.length&&e.setAttribute(h,m.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",m);break;case"style":Object.assign(e.style,m);break;case"textContent":e.textContent=m;break;default:(!u||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,m)}u&&l.addLinkAttributes(e,c.href,c.newWindow),s&&c.dataId&&this.setupStorage(e,c.dataId,t,s)}static render(e){const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,l=e.intent||"display",c=document.createElement(i.name);i.attributes&&this.setAttributes({html:c,element:i,intent:l,linkService:s});const u=l!=="richText",h=e.div;if(h.append(c),e.viewport){const x=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=x}u&&h.setAttribute("class","xfaLayer xfaFont");const m=[];if(i.children.length===0){if(i.value){const x=document.createTextNode(i.value);c.append(x),u&&Do.shouldBuildText(i.name)&&m.push(x)}return{textDivs:m}}const p=[[i,-1,c]];for(;p.length>0;){const[x,y,v]=p.at(-1);if(y+1===x.children.length){p.pop();continue}const w=x.children[++p.at(-1)[1]];if(w===null)continue;const{name:A}=w;if(A==="#text"){const j=document.createTextNode(w.value);m.push(j),v.append(j);continue}const N=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,A):document.createElement(A);if(v.append(N),w.attributes&&this.setAttributes({html:N,element:w,storage:t,intent:l,linkService:s}),w.children?.length>0)p.push([w,-1,N]);else if(w.value){const j=document.createTextNode(w.value);u&&Do.shouldBuildText(A)&&m.push(j),N.append(j)}}for(const x of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))x.setAttribute("readOnly",!0);return{textDivs:m}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const kD=9,$i=new WeakSet;class iv{static create(e){switch(e.data.annotationType){case Gt.LINK:return new B1(e);case Gt.TEXT:return new MD(e);case Gt.WIDGET:switch(e.data.fieldType){case"Tx":return new LD(e);case"Btn":return e.data.radioButton?new H1(e):e.data.checkBox?new PD(e):new ID(e);case"Ch":return new BD(e);case"Sig":return new OD(e)}return new Yi(e);case Gt.POPUP:return new sp(e);case Gt.FREETEXT:return new z1(e);case Gt.LINE:return new zD(e);case Gt.SQUARE:return new FD(e);case Gt.CIRCLE:return new UD(e);case Gt.POLYLINE:return new F1(e);case Gt.CARET:return new VD(e);case Gt.INK:return new Yp(e);case Gt.POLYGON:return new $D(e);case Gt.HIGHLIGHT:return new U1(e);case Gt.UNDERLINE:return new qD(e);case Gt.SQUIGGLY:return new GD(e);case Gt.STRIKEOUT:return new YD(e);case Gt.STAMP:return new $1(e);case Gt.FILEATTACHMENT:return new WD(e);default:return new Ut(e)}}}class Ut{#e=null;#t=!1;#s=null;constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ut._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#n(t),this.#s?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#s?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:u,pageY:h}}}}=this;s?.splice(0,4,...e),t.left=`${100*(e[0]-u)/l}%`,t.top=`${100*(c-e[3]+h)/c}%`,i===0?(t.width=`${100*(e[2]-e[0])/l}%`,t.height=`${100*(e[3]-e[1])/c}%`):this.setRotation(i)}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",t.id),this instanceof Yi||(l.tabIndex=0);const{style:c}=l;if(c.zIndex=this.parent.zIndex++,t.alternativeText&&(l.title=t.alternativeText),t.noRotate&&l.classList.add("norotate"),!t.rect||this instanceof sp){const{rotation:A}=t;return!t.hasOwnCanvas&&A!==0&&this.setRotation(A,l),l}const{width:u,height:h}=this;if(!e&&t.borderStyle.width>0){c.borderWidth=`${t.borderStyle.width}px`;const A=t.borderStyle.horizontalCornerRadius,N=t.borderStyle.verticalCornerRadius;if(A>0||N>0){const _=`calc(${A}px * var(--total-scale-factor)) / calc(${N}px * var(--total-scale-factor))`;c.borderRadius=_}else if(this instanceof H1){const _=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;c.borderRadius=_}switch(t.borderStyle.style){case Hr.SOLID:c.borderStyle="solid";break;case Hr.DASHED:c.borderStyle="dashed";break;case Hr.BEVELED:Ue("Unimplemented border style: beveled");break;case Hr.INSET:Ue("Unimplemented border style: inset");break;case Hr.UNDERLINE:c.borderBottomStyle="solid";break}const j=t.borderColor||null;j?(this.#t=!0,c.borderColor=Re.makeHexColor(j[0]|0,j[1]|0,j[2]|0)):c.borderWidth=0}const m=Re.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:p,pageHeight:x,pageX:y,pageY:v}=i.rawDims;c.left=`${100*(m[0]-y)/p}%`,c.top=`${100*(m[1]-v)/x}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(c.width=`${100*u/p}%`,c.height=`${100*h/x}%`):this.setRotation(w,l),l}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims;let{width:l,height:c}=this;e%180!==0&&([l,c]=[c,l]),t.style.width=`${100*l/s}%`,t.style.height=`${100*c/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const l=i.detail[t],c=l[0],u=l.slice(1);i.target.style[s]=av[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:av[`${c}_rgb`](u)})};return et(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail))(e[i]||s[i])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,l]of Object.entries(t)){const c=s[i];if(c){const u={detail:{[i]:l},target:e};c(u),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,l]=this.data.rect.map(A=>Math.fround(A));if(e.length===8){const[A,N,j,_]=e.subarray(2,6);if(i===A&&l===N&&t===j&&s===_)return}const{style:c}=this.container;let u;if(this.#t){const{borderColor:A,borderWidth:N}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${A}" stroke-width="${N}">`],this.container.classList.add("hasBorder")}const h=i-t,m=l-s,{svgFactory:p}=this,x=p.createElement("svg");x.classList.add("quadrilateralsContainer"),x.setAttribute("width",0),x.setAttribute("height",0),x.role="none";const y=p.createElement("defs");x.append(y);const v=p.createElement("clipPath"),w=`clippath_${this.data.id}`;v.setAttribute("id",w),v.setAttribute("clipPathUnits","objectBoundingBox"),y.append(v);for(let A=2,N=e.length;A<N;A+=8){const j=e[A],_=e[A+1],C=e[A+2],k=e[A+3],D=p.createElement("rect"),P=(C-t)/h,F=(l-_)/m,U=(j-C)/h,I=(_-k)/m;D.setAttribute("x",P),D.setAttribute("y",F),D.setAttribute("width",U),D.setAttribute("height",I),v.append(D),u?.push(`<rect vector-effect="non-scaling-stroke" x="${P}" y="${F}" width="${U}" height="${I}"/>`)}this.#t&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(x),this.container.style.clipPath=`url(#${w})`}_createPopup(){const{data:e}=this,t=this.#s=new sp({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){xt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:l,id:c,exportValues:u}of i){if(l===-1||c===t)continue;const h=typeof u=="string"?u:null,m=document.querySelector(`[data-element-id="${c}"]`);if(m&&!$i.has(m)){Ue(`_getElementsByName - element not allowed: ${c}`);continue}s.push({id:c,exportValue:h,domElement:m})}return s}for(const i of document.getElementsByName(e)){const{exportValue:l}=i,c=i.getAttribute("data-element-id");c!==t&&$i.has(i)&&s.push({id:c,exportValue:l,domElement:i})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class B1 extends Ut{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(s,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(s,e.action),i=!0):e.attachment?(this.#t(s,e.attachment,e.attachmentDest),i=!0):e.setOCGState?(this.#s(s,e.setOCGState),i=!0):e.dest?(this._bindLink(s,e.dest),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),i=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(s,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(s),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,s=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,s),!1),this.#e()}#s(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const l=s.get(i);l&&(e[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Ue('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(e.onclick=()=>!1);return}e.onclick=()=>{s?.();const{fields:i,refs:l,include:c}=t,u=[];if(i.length!==0||l.length!==0){const p=new Set(l);for(const x of i){const y=this._fieldObjects[x]||[];for(const{id:v}of y)p.add(v)}for(const x of Object.values(this._fieldObjects))for(const y of x)p.has(y.id)===c&&u.push(y)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const h=this.annotationStorage,m=[];for(const p of u){const{id:x}=p;switch(m.push(x),p.type){case"text":{const v=p.defaultValue||"";h.setValue(x,{value:v});break}case"checkbox":case"radiobutton":{const v=p.defaultValue===p.exportValues;h.setValue(x,{value:v});break}case"combobox":case"listbox":{const v=p.defaultValue||"";h.setValue(x,{value:v});break}default:continue}const y=document.querySelector(`[data-element-id="${x}"]`);if(y){if(!$i.has(y)){Ue(`_bindResetFormAction - element not allowed: ${x}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:m,name:"ResetForm"}}),!1}}}class MD extends Ut{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Yi extends Ut{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return fs.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,l){s.includes("mouse")?e.addEventListener(s,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):e.addEventListener(s,c=>{if(s==="blur"){if(!t.focused||!c.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:l(c)}})})}_setEventListeners(e,t,s,i){for(const[l,c]of s)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,l,c,i),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Re.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||kD,l=e.style;let c;const u=2,h=m=>Math.round(10*m)/10;if(this.data.multiLine){const m=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(m/(dm*i))||1,x=m/p;c=Math.min(i,h(x/dm))}else{const m=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(i,h(m/dm))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=Re.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(l.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class LD extends Yi{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const l=this.annotationStorage;for(const c of this._getElementsByName(e.name,e.id))c.domElement&&(c.domElement[t]=s),l.setValue(c.id,{[i]:s})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const i=e.getValue(t,{value:this.data.fieldValue});let l=i.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=i.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??l,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??l),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),$i.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const m=this.data.dateFormat||this.data.timeFormat;m&&(s.title=m),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",x=>{e.setValue(t,{value:x.target.value}),this.setPropertyOnSiblings(s,"value",x.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",x=>{const y=this.data.defaultFieldValue??"";s.value=h.userValue=y,h.formattedValue=null});let p=x=>{const{formattedValue:y}=h;y!=null&&(x.target.value=y),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",y=>{if(h.focused)return;const{target:v}=y;h.userValue&&(v.value=h.userValue),h.lastCommittedValue=v.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",y=>{this.showElementAndHideCanvas(y.target);const v={value(w){h.userValue=w.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),w.target.value=h.userValue},formattedValue(w){const{formattedValue:A}=w.detail;h.formattedValue=A,A!=null&&w.target!==document.activeElement&&(w.target.value=A),e.setValue(t,{formattedValue:A})},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{const{charLimit:A}=w.detail,{target:N}=w;if(A===0){N.removeAttribute("maxLength");return}N.setAttribute("maxLength",A);let j=h.userValue;!j||j.length<=A||(j=j.slice(0,A),N.value=h.userValue=j,e.setValue(t,{value:j}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:j,willCommit:!0,commitKey:1,selStart:N.selectionStart,selEnd:N.selectionEnd}}))}};this._dispatchEventFromSandbox(v,y)}),s.addEventListener("keydown",y=>{h.commitKey=1;let v=-1;if(y.key==="Escape"?v=0:y.key==="Enter"&&!this.data.multiLine?v=2:y.key==="Tab"&&(h.commitKey=3),v===-1)return;const{value:w}=y.target;h.lastCommittedValue!==w&&(h.lastCommittedValue=w,h.userValue=w,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:v,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}))});const x=p;p=null,s.addEventListener("blur",y=>{if(!h.focused||!y.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{value:v}=y.target;h.userValue=v,h.lastCommittedValue!==v&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:h.commitKey,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}),x(y)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",y=>{h.lastCommittedValue=null;const{data:v,target:w}=y,{value:A,selectionStart:N,selectionEnd:j}=w;let _=N,C=j;switch(y.inputType){case"deleteWordBackward":{const k=A.substring(0,N).match(/\w*[^\w]*$/);k&&(_-=k[0].length);break}case"deleteWordForward":{const k=A.substring(N).match(/^[^\w]*\w*/);k&&(C+=k[0].length);break}case"deleteContentBackward":N===j&&(_-=1);break;case"deleteContentForward":N===j&&(C+=1);break}y.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,change:v||"",willCommit:!1,selStart:_,selEnd:C}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],y=>y.target.value)}if(p&&s.addEventListener("blur",p),this.data.comb){const y=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${y}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class OD extends Yi{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class PD extends Yi{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return $i.add(l),l.setAttribute("data-element-id",s),l.disabled=t.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=t.fieldName,i&&l.setAttribute("checked",!0),l.setAttribute("exportValue",t.exportValue),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const m of this._getElementsByName(u,s)){const p=h&&m.exportValue===t.exportValue;m.domElement&&(m.domElement.checked=p),e.setValue(m.id,{value:p})}e.setValue(s,{value:h})}),l.addEventListener("resetform",c=>{const u=t.defaultFieldValue||"Off";c.target.checked=u===t.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const u={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class H1 extends Yi{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const c of this._getElementsByName(t.fieldName,s))e.setValue(c.id,{value:!1});const l=document.createElement("input");if($i.add(l),l.setAttribute("data-element-id",s),l.disabled=t.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=t.fieldName,i&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const m of this._getElementsByName(u,s))e.setValue(m.id,{value:!1});e.setValue(s,{value:h})}),l.addEventListener("resetform",c=>{const u=t.defaultFieldValue;c.target.checked=u!=null&&u===t.buttonValue}),this.enableScripting&&this.hasJSActions){const c=t.buttonValue;l.addEventListener("updatefromsandbox",u=>{const h={value:m=>{const p=c===m.detail.value;for(const x of this._getElementsByName(m.target.name)){const y=p&&x.id===s;x.domElement&&(x.domElement.checked=y),e.setValue(x.id,{value:y})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class ID extends B1{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class BD extends Yi{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");$i.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",p=>{const x=this.data.defaultFieldValue;for(const y of i.options)y.selected=y.value===x});for(const p of this.data.options){const x=document.createElement("option");x.textContent=p.displayValue,x.value=p.exportValue,s.value.includes(p.exportValue)&&(x.setAttribute("selected",!0),l=!1),i.append(x)}let c=null;if(l){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),i.prepend(p),c=()=>{p.remove(),i.removeEventListener("input",c),c=null},i.addEventListener("input",c)}const u=p=>{const x=p?"value":"textContent",{options:y,multiple:v}=i;return v?Array.prototype.filter.call(y,w=>w.selected).map(w=>w[x]):y.selectedIndex===-1?null:y[y.selectedIndex][x]};let h=u(!1);const m=p=>{const x=p.target.options;return Array.prototype.map.call(x,y=>({displayValue:y.textContent,exportValue:y.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",p=>{const x={value(y){c?.();const v=y.detail.value,w=new Set(Array.isArray(v)?v:[v]);for(const A of i.options)A.selected=w.has(A.value);e.setValue(t,{value:u(!0)}),h=u(!1)},multipleSelection(y){i.multiple=!0},remove(y){const v=i.options,w=y.detail.remove;v[w].selected=!1,i.remove(w),v.length>0&&Array.prototype.findIndex.call(v,N=>N.selected)===-1&&(v[0].selected=!0),e.setValue(t,{value:u(!0),items:m(y)}),h=u(!1)},clear(y){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),h=u(!1)},insert(y){const{index:v,displayValue:w,exportValue:A}=y.detail.insert,N=i.children[v],j=document.createElement("option");j.textContent=w,j.value=A,N?N.before(j):i.append(j),e.setValue(t,{value:u(!0),items:m(y)}),h=u(!1)},items(y){const{items:v}=y.detail;for(;i.length!==0;)i.remove(0);for(const w of v){const{displayValue:A,exportValue:N}=w,j=document.createElement("option");j.textContent=A,j.value=N,i.append(j)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:u(!0),items:m(y)}),h=u(!1)},indices(y){const v=new Set(y.detail.indices);for(const w of y.target.options)w.selected=v.has(w.index);e.setValue(t,{value:u(!0)}),h=u(!1)},editable(y){y.target.disabled=!y.detail.editable}};this._dispatchEventFromSandbox(x,p)}),i.addEventListener("input",p=>{const x=u(!0),y=u(!1);e.setValue(t,{value:x}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:y,changeEx:x,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):i.addEventListener("input",function(p){e.setValue(t,{value:u(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class sp extends Ut{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:Ut._hasPopupData(t)}),this.elements=s,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new HD({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),s=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",s.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(i=>`${Pp}${i}`).join(",")),this.container}}class HD{#e=this.#_.bind(this);#t=this.#E.bind(this);#s=this.#C.bind(this);#n=this.#N.bind(this);#i=null;#a=null;#l=null;#r=null;#u=null;#o=null;#h=null;#d=!1;#f=null;#m=null;#p=null;#c=null;#g=null;#x=null;#y=!1;constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:l,contentsObj:c,richText:u,parent:h,rect:m,parentRect:p,open:x}){this.#a=e,this.#g=i,this.#l=c,this.#c=u,this.#o=h,this.#i=t,this.#p=m,this.#h=p,this.#u=s,this.#r=x1.toDateObject(l),this.trigger=s.flatMap(y=>y.getElementsToTriggerPopup());for(const y of this.trigger)y.addEventListener("click",this.#n),y.addEventListener("mouseenter",this.#s),y.addEventListener("mouseleave",this.#t),y.classList.add("popupTriggerArea");for(const y of s)y.container?.addEventListener("keydown",this.#e);this.#a.hidden=!0,x&&this.#N()}render(){if(this.#f)return;const e=this.#f=document.createElement("div");if(e.className="popup",this.#i){const l=e.style.outlineColor=Re.makeHexColor(...this.#i);e.style.backgroundColor=`color-mix(in srgb, ${l} 30%, white)`}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=this.#g,e.append(t),this.#r){const l=document.createElement("time");l.classList.add("popupDate"),l.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),l.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#r.valueOf()})),l.dateTime=this.#r.toISOString(),t.append(l)}const i=this.#v;if(i)I1.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const l=this._formatContents(this.#l);e.append(l)}this.#a.append(e)}get#v(){const e=this.#c,t=this.#l;return e?.str&&(!t?.str||t.str===e.str)&&this.#c.html||null}get#w(){return this.#v?.attributes?.style?.fontSize||0}get#A(){return this.#v?.attributes?.style?.color||null}#S(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:this.#A,fontSize:this.#w?`calc(${this.#w}px * var(--total-scale-factor))`:""}};for(const l of e.split(`
`))t.push({name:"span",value:l,attributes:i});return s}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let l=0,c=i.length;l<c;++l){const u=i[l];s.append(document.createTextNode(u)),l<c-1&&s.append(document.createElement("br"))}return s}#_(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#d)&&this.#N()}updateEdited({rect:e,popupContent:t}){this.#x||={contentsObj:this.#l,richText:this.#c},e&&(this.#m=null),t&&(this.#c=this.#S(t),this.#l=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#x&&({contentsObj:this.#l,richText:this.#c}=this.#x,this.#x=null,this.#f?.remove(),this.#f=null,this.#m=null)}#T(){if(this.#m!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:l}}}=this.#o;let c=!!this.#h,u=c?this.#h:this.#p;for(const w of this.#u)if(!u||Re.intersect(w.data.rect,u)!==null){u=w.data.rect,c=!0;break}const h=Re.normalizeRect([u[0],e[3]-u[1]+e[1],u[2],e[3]-u[3]+e[1]]),p=c?u[2]-u[0]+5:0,x=h[0]+p,y=h[1];this.#m=[100*(x-i)/t,100*(y-l)/s];const{style:v}=this.#a;v.left=`${this.#m[0]}%`,v.top=`${this.#m[1]}%`}#N(){this.#d=!this.#d,this.#d?(this.#C(),this.#a.addEventListener("click",this.#n),this.#a.addEventListener("keydown",this.#e)):(this.#E(),this.#a.removeEventListener("click",this.#n),this.#a.removeEventListener("keydown",this.#e))}#C(){this.#f||this.render(),this.isVisible?this.#d&&this.#a.classList.add("focused"):(this.#T(),this.#a.hidden=!1,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)+1e3)}#E(){this.#a.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#a.hidden=!0,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)-1e3)}forceHide(){this.#y=this.isVisible,this.#y&&(this.#a.hidden=!0)}maybeShow(){this.#y&&(this.#f||this.#C(),this.#y=!1,this.#a.hidden=!1)}get isVisible(){return this.#a.hidden===!1}}class z1 extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Fe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class zD extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:s}=this,i=this.svgFactory.create(t,s,!0),l=this.#e=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),l.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),l.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),l.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),l.setAttribute("stroke-width",e.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class FD extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:s}=this,i=this.svgFactory.create(t,s,!0),l=e.borderStyle.width,c=this.#e=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",t-l),c.setAttribute("height",s-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),i.append(c),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class UD extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:s}=this,i=this.svgFactory.create(t,s,!0),l=e.borderStyle.width,c=this.#e=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",t/2),c.setAttribute("cy",s/2),c.setAttribute("rx",t/2-l/2),c.setAttribute("ry",s/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),i.append(c),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class F1 extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:s,popupRef:i},width:l,height:c}=this;if(!t)return this.container;const u=this.svgFactory.create(l,c,!0);let h=[];for(let p=0,x=t.length;p<x;p+=2){const y=t[p]-e[0],v=e[3]-t[p+1];h.push(`${y},${v}`)}h=h.join(" ");const m=this.#e=this.svgFactory.createElement(this.svgElementName);return m.setAttribute("points",h),m.setAttribute("stroke-width",s.width||1),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),u.append(m),this.container.append(u),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class $D extends F1{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class VD extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Yp extends Ut{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Fe.HIGHLIGHT:Fe.INK}#s(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:s,borderStyle:i,popupRef:l}}=this,{transform:c,width:u,height:h}=this.#s(t,e),m=this.svgFactory.create(u,h,!0),p=this.#e=this.svgFactory.createElement("svg:g");m.append(p),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",c);for(let x=0,y=s.length;x<y;x++){const v=this.svgFactory.createElement(this.svgElementName);this.#t.push(v),v.setAttribute("points",s[x].join(",")),p.append(v)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(m),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:s,rect:i}=e,l=this.#e;if(t>=0&&l.setAttribute("stroke-width",t||1),s)for(let c=0,u=this.#t.length;c<u;c++)this.#t[c].setAttribute("points",s[c].join(","));if(i){const{transform:c,width:u,height:h}=this.#s(this.data.rotation,i);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class U1 extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Fe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class qD extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class GD extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class YD extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class $1 extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Fe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class WD extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let s;t.hasAppearance||t.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#t.bind(this)),this.#e=s;const{isMac:i}=fs.platform;return e.addEventListener("keydown",l=>{l.key==="Enter"&&(i?l.metaKey:l.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Wp{#e=null;#t=null;#s=new Map;#n=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:l,viewport:c,structTreeLayer:u}){this.div=e,this.#e=t,this.#t=s,this.#n=u||null,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#s.size>0}async#i(e,t,s){const i=e.firstChild||e,l=i.id=`${Pp}${t}`,c=await this.#n?.getAriaAttributes(l);if(c)for(const[u,h]of c)i.setAttribute(u,h);s?s.at(-1).container.after(e):(this.div.append(e),this.#e?.moveElementInDOM(this.div,e,i,!1))}async render(e){const{annotations:t}=e,s=this.div;Ui(s,this.viewport);const i=new Map,l={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Wd,annotationStorage:e.annotationStorage||new Up,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const u=c.annotationType===Gt.POPUP;if(u){const p=i.get(c.id);if(!p)continue;l.elements=p}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;l.data=c;const h=iv.create(l);if(!h.isRenderable)continue;if(!u&&c.popupRef){const p=i.get(c.popupRef);p?p.push(h):i.set(c.popupRef,[h])}const m=h.render();c.hidden&&(m.style.visibility="hidden"),await this.#i(m,c.id,l.elements),h._isEditable&&(this.#s.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#a()}async addLinkAnnotations(e,t){const s={data:null,layer:this.div,linkService:t,svgFactory:new Wd,parent:this};for(const i of e){i.borderStyle||=Wp._defaultBorderStyle,s.data=i;const l=iv.create(s);if(!l.isRenderable)continue;const c=l.render();await this.#i(c,i.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,Ui(t,{rotation:e.rotation}),this.#a(),t.hidden=!1}#a(){if(!this.#t)return;const e=this.div;for(const[t,s]of this.#t){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:l}=i;l?l.nodeName==="CANVAS"?l.replaceWith(s):l.classList.contains("annotationContent")?l.after(s):l.before(s):i.append(s);const c=this.#s.get(t);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,i.id,s),c._hasNoCanvas=!1):c.canvas=s)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(e){return this.#s.get(e)}static get _defaultBorderStyle(){return et(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Hr.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const xd=/\r\n?|\n/g;class Kt extends ke{#e;#t="";#s=`${this.id}-editor`;#n=null;#i;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=Kt.prototype,t=l=>l.isEmpty(),s=ei.TRANSLATE_SMALL,i=ei.TRANSLATE_BIG;return et(this,"_keyboardManager",new Wo([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}static _type="freetext";static _editorType=Fe.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#e=e.color||Kt._defaultColor||ke._defaultLineColor,this.#i=e.fontSize||Kt._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(e,t){ke.initialize(e,t);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case st.FREETEXT_SIZE:Kt._defaultFontSize=t;break;case st.FREETEXT_COLOR:Kt._defaultColor=t;break}}updateParams(e,t){switch(e){case st.FREETEXT_SIZE:this.#a(t);break;case st.FREETEXT_COLOR:this.#l(t);break}}static get defaultPropertiesToUpdate(){return[[st.FREETEXT_SIZE,Kt._defaultFontSize],[st.FREETEXT_COLOR,Kt._defaultColor||ke._defaultLineColor]]}get propertiesToUpdate(){return[[st.FREETEXT_SIZE,this.#i],[st.FREETEXT_COLOR,this.#e]]}#a(e){const t=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-this.#i)*this.parentScale),this.#i=i,this.#u()},s=this.#i;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(e){const t=i=>{this.#e=this.editorDiv.style.color=i},s=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Kt._internalPadding*e,-(Kt._internalPadding+this.#i)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const e=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#s),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const e=[];this.editorDiv.normalize();let t=null;for(const s of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(Kt.#o(s)),t=s);return e.join(`
`)}#u(){const[e,t]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:i,div:l}=this,c=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",i.div.append(this.div),s=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/t):(this.width=s.height/e,this.height=s.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#t,t=this.#t=this.#r().trimEnd();if(e===t)return;const s=i=>{if(this.#t=i,!i){this.remove();return}this.#h(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{s(t)},undo:()=>{s(e)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Kt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#s),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[m,p]=this.pageDimensions,[x,y]=this.pageTranslation;let v,w;switch(this.rotation){case 0:v=e+(c[0]-x)/m,w=t+this.height-(c[1]-y)/p;break;case 90:v=e+(c[0]-x)/m,w=t-(c[1]-y)/p,[u,h]=[h,-u];break;case 180:v=e-this.width+(c[0]-x)/m,w=t-(c[1]-y)/p,[u,h]=[-u,-h];break;case 270:v=e+(c[0]-x-this.height*p)/m,w=t+(c[1]-y-this.width*m)/p,[u,h]=[-h,u];break}this.setAt(v*i,w*l,u,h)}else this._moveAfterPaste(e,t);this.#h(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#o(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(xd,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:s}=t;if(s.length===1&&s[0]==="text/plain")return;e.preventDefault();const i=Kt.#f(t.getData("text")||"").replaceAll(xd,`
`);if(!i)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!i.includes(`
`)){c.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:h}=c,m=[],p=[];if(u.nodeType===Node.TEXT_NODE){const v=u.parentElement;if(p.push(u.nodeValue.slice(h).replaceAll(xd,"")),v!==this.editorDiv){let w=m;for(const A of this.editorDiv.childNodes){if(A===v){w=p;continue}w.push(Kt.#o(A))}}m.push(u.nodeValue.slice(0,h).replaceAll(xd,""))}else if(u===this.editorDiv){let v=m,w=0;for(const A of this.editorDiv.childNodes)w++===h&&(v=p),v.push(Kt.#o(A))}this.#t=`${m.join(`
`)}${i}${p.join(`
`)}`,this.#h();const x=new Range;let y=Math.sumPrecise(m.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const w=v.nodeValue.length;if(y<=w){x.setStart(v,y),x.setEnd(v,y);break}y-=w}l.removeAllRanges(),l.addRange(x)}#h(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const e of this.#t.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#d(){return this.#t.replaceAll(" "," ")}static#f(e){return e.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,s){let i=null;if(e instanceof z1){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:m,id:p,popupRef:x},textContent:y,textPosition:v,parent:{page:{pageNumber:w}}}=e;if(!y||y.length===0)return null;i=e={annotationType:Fe.FREETEXT,color:Array.from(u),fontSize:c,value:y.join(`
`),position:v,pageIndex:w-1,rect:h.slice(0),rotation:m,annotationElementId:p,id:p,deleted:!1,popupRef:x}}const l=await super.deserialize(e,t,s);return l.#i=e.fontSize,l.#e=Re.makeHexColor(...e.color),l.#t=Kt.#f(e.value),l._initialData=i,l}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Kt._internalPadding*this.parentScale,s=this.getRect(t,t),i=ke._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),l={annotationType:Fe.FREETEXT,color:i,fontSize:this.#i,value:this.#d(),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(l.isCopy=!0,l):this.annotationElementId&&!this.#m(l)?null:(l.id=this.annotationElementId,l)}#m(e){const{value:t,fontSize:s,color:i,pageIndex:l}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==s||e.color.some((c,u)=>c!==i[u])||e.pageIndex!==l}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:s}=t;s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.#e,t.replaceChildren();for(const l of this.#t.split(`
`)){const c=document.createElement("div");c.append(l?document.createTextNode(l):document.createElement("br")),t.append(c)}const i=Kt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(i,i),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class Se{static PRECISION=1e-4;toSVGPath(){xt("Abstract method `toSVGPath` must be implemented.")}get box(){xt("Abstract getter `box` must be implemented.")}serialize(e,t){xt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,l,c){c||=new Float32Array(e.length);for(let u=0,h=e.length;u<h;u+=2)c[u]=t+e[u]*i,c[u+1]=s+e[u+1]*l;return c}static _rescaleAndSwap(e,t,s,i,l,c){c||=new Float32Array(e.length);for(let u=0,h=e.length;u<h;u+=2)c[u]=t+e[u+1]*i,c[u+1]=s+e[u]*l;return c}static _translate(e,t,s,i){i||=new Float32Array(e.length);for(let l=0,c=e.length;l<c;l+=2)i[l]=t+e[l],i[l+1]=s+e[l+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,l){switch(l){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,l,c){return[(e+5*s)/6,(t+5*i)/6,(5*s+l)/6,(5*i+c)/6,(s+l)/2,(i+c)/2]}}class ki{#e;#t=[];#s;#n;#i=[];#a=new Float32Array(18);#l;#r;#u;#o;#h;#d;#f=[];static#m=8;static#p=2;static#c=ki.#m+ki.#p;constructor({x:e,y:t},s,i,l,c,u=0){this.#e=s,this.#d=l*i,this.#n=c,this.#a.set([NaN,NaN,NaN,NaN,e,t],6),this.#s=u,this.#o=ki.#m*i,this.#u=ki.#c*i,this.#h=i,this.#f.push(e,t)}isEmpty(){return isNaN(this.#a[8])}#g(){const e=this.#a.subarray(4,6),t=this.#a.subarray(16,18),[s,i,l,c]=this.#e;return[(this.#l+(e[0]-t[0])/2-s)/l,(this.#r+(e[1]-t[1])/2-i)/c,(this.#l+(t[0]-e[0])/2-s)/l,(this.#r+(t[1]-e[1])/2-i)/c]}add({x:e,y:t}){this.#l=e,this.#r=t;const[s,i,l,c]=this.#e;let[u,h,m,p]=this.#a.subarray(8,12);const x=e-m,y=t-p,v=Math.hypot(x,y);if(v<this.#u)return!1;const w=v-this.#o,A=w/v,N=A*x,j=A*y;let _=u,C=h;u=m,h=p,m+=N,p+=j,this.#f?.push(e,t);const k=-j/w,D=N/w,P=k*this.#d,F=D*this.#d;return this.#a.set(this.#a.subarray(2,8),0),this.#a.set([m+P,p+F],4),this.#a.set(this.#a.subarray(14,18),12),this.#a.set([m-P,p-F],16),isNaN(this.#a[6])?(this.#i.length===0&&(this.#a.set([u+P,h+F],2),this.#i.push(NaN,NaN,NaN,NaN,(u+P-s)/l,(h+F-i)/c),this.#a.set([u-P,h-F],14),this.#t.push(NaN,NaN,NaN,NaN,(u-P-s)/l,(h-F-i)/c)),this.#a.set([_,C,u,h,m,p],6),!this.isEmpty()):(this.#a.set([_,C,u,h,m,p],6),Math.abs(Math.atan2(C-h,_-u)-Math.atan2(j,N))<Math.PI/2?([u,h,m,p]=this.#a.subarray(2,6),this.#i.push(NaN,NaN,NaN,NaN,((u+m)/2-s)/l,((h+p)/2-i)/c),[u,h,_,C]=this.#a.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((_+u)/2-s)/l,((C+h)/2-i)/c),!0):([_,C,u,h,m,p]=this.#a.subarray(0,6),this.#i.push(((_+5*u)/6-s)/l,((C+5*h)/6-i)/c,((5*u+m)/6-s)/l,((5*h+p)/6-i)/c,((u+m)/2-s)/l,((h+p)/2-i)/c),[m,p,u,h,_,C]=this.#a.subarray(12,18),this.#t.push(((_+5*u)/6-s)/l,((C+5*h)/6-i)/c,((5*u+m)/6-s)/l,((5*h+p)/6-i)/c,((u+m)/2-s)/l,((h+p)/2-i)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#i,t=this.#t;if(isNaN(this.#a[6])&&!this.isEmpty())return this.#x();const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);this.#v(s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return this.#y(s),s.join(" ")}#x(){const[e,t,s,i]=this.#e,[l,c,u,h]=this.#g();return`M${(this.#a[2]-e)/s} ${(this.#a[3]-t)/i} L${(this.#a[4]-e)/s} ${(this.#a[5]-t)/i} L${l} ${c} L${u} ${h} L${(this.#a[16]-e)/s} ${(this.#a[17]-t)/i} L${(this.#a[14]-e)/s} ${(this.#a[15]-t)/i} Z`}#y(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#v(e){const[t,s,i,l]=this.#e,c=this.#a.subarray(4,6),u=this.#a.subarray(16,18),[h,m,p,x]=this.#g();e.push(`L${(c[0]-t)/i} ${(c[1]-s)/l} L${h} ${m} L${p} ${x} L${(u[0]-t)/i} ${(u[1]-s)/l}`)}newFreeDrawOutline(e,t,s,i,l,c){return new V1(e,t,s,i,l,c)}getOutlines(){const e=this.#i,t=this.#t,s=this.#a,[i,l,c,u]=this.#e,h=new Float32Array((this.#f?.length??0)+2);for(let x=0,y=h.length-2;x<y;x+=2)h[x]=(this.#f[x]-i)/c,h[x+1]=(this.#f[x+1]-l)/u;if(h[h.length-2]=(this.#l-i)/c,h[h.length-1]=(this.#r-l)/u,isNaN(s[6])&&!this.isEmpty())return this.#w(h);const m=new Float32Array(this.#i.length+24+this.#t.length);let p=e.length;for(let x=0;x<p;x+=2){if(isNaN(e[x])){m[x]=m[x+1]=NaN;continue}m[x]=e[x],m[x+1]=e[x+1]}p=this.#S(m,p);for(let x=t.length-6;x>=6;x-=6)for(let y=0;y<6;y+=2){if(isNaN(t[x+y])){m[p]=m[p+1]=NaN,p+=2;continue}m[p]=t[x+y],m[p+1]=t[x+y+1],p+=2}return this.#A(m,p),this.newFreeDrawOutline(m,h,this.#e,this.#h,this.#s,this.#n)}#w(e){const t=this.#a,[s,i,l,c]=this.#e,[u,h,m,p]=this.#g(),x=new Float32Array(36);return x.set([NaN,NaN,NaN,NaN,(t[2]-s)/l,(t[3]-i)/c,NaN,NaN,NaN,NaN,(t[4]-s)/l,(t[5]-i)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,m,p,NaN,NaN,NaN,NaN,(t[16]-s)/l,(t[17]-i)/c,NaN,NaN,NaN,NaN,(t[14]-s)/l,(t[15]-i)/c],0),this.newFreeDrawOutline(x,e,this.#e,this.#h,this.#s,this.#n)}#A(e,t){const s=this.#t;return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6}#S(e,t){const s=this.#a.subarray(4,6),i=this.#a.subarray(16,18),[l,c,u,h]=this.#e,[m,p,x,y]=this.#g();return e.set([NaN,NaN,NaN,NaN,(s[0]-l)/u,(s[1]-c)/h,NaN,NaN,NaN,NaN,m,p,NaN,NaN,NaN,NaN,x,y,NaN,NaN,NaN,NaN,(i[0]-l)/u,(i[1]-c)/h],t),t+=24}}class V1 extends Se{#e;#t=new Float32Array(4);#s;#n;#i;#a;#l;constructor(e,t,s,i,l,c){super(),this.#l=e,this.#i=t,this.#e=s,this.#a=i,this.#s=l,this.#n=c,this.lastPoint=[NaN,NaN],this.#r(c);const[u,h,m,p]=this.#t;for(let x=0,y=e.length;x<y;x+=2)e[x]=(e[x]-u)/m,e[x+1]=(e[x+1]-h)/p;for(let x=0,y=t.length;x<y;x+=2)t[x]=(t[x]-u)/m,t[x+1]=(t[x+1]-h)/p}toSVGPath(){const e=[`M${this.#l[4]} ${this.#l[5]}`];for(let t=6,s=this.#l.length;t<s;t+=6){if(isNaN(this.#l[t])){e.push(`L${this.#l[t+4]} ${this.#l[t+5]}`);continue}e.push(`C${this.#l[t]} ${this.#l[t+1]} ${this.#l[t+2]} ${this.#l[t+3]} ${this.#l[t+4]} ${this.#l[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,s,i],l){const c=s-e,u=i-t;let h,m;switch(l){case 0:h=Se._rescale(this.#l,e,i,c,-u),m=Se._rescale(this.#i,e,i,c,-u);break;case 90:h=Se._rescaleAndSwap(this.#l,e,t,c,u),m=Se._rescaleAndSwap(this.#i,e,t,c,u);break;case 180:h=Se._rescale(this.#l,s,t,-c,u),m=Se._rescale(this.#i,s,t,-c,u);break;case 270:h=Se._rescaleAndSwap(this.#l,s,i,-c,-u),m=Se._rescaleAndSwap(this.#i,s,i,-c,-u);break}return{outline:Array.from(h),points:[Array.from(m)]}}#r(e){const t=this.#l;let s=t[4],i=t[5];const l=[s,i,s,i];let c=s,u=i;const h=e?Math.max:Math.min;for(let p=6,x=t.length;p<x;p+=6){const y=t[p+4],v=t[p+5];if(isNaN(t[p]))Re.pointBoundingBox(y,v,l),u<v?(c=y,u=v):u===v&&(c=h(c,y));else{const w=[1/0,1/0,-1/0,-1/0];Re.bezierBoundingBox(s,i,...t.slice(p,p+6),w),Re.rectBoundingBox(...w,l),u<w[3]?(c=w[2],u=w[3]):u===w[3]&&(c=h(c,w[2]))}s=y,i=v}const m=this.#t;m[0]=l[0]-this.#s,m[1]=l[1]-this.#s,m[2]=l[2]-l[0]+2*this.#s,m[3]=l[3]-l[1]+2*this.#s,this.lastPoint=[c,u]}get box(){return this.#t}newOutliner(e,t,s,i,l,c=0){return new ki(e,t,s,i,l,c)}getNewOutline(e,t){const[s,i,l,c]=this.#t,[u,h,m,p]=this.#e,x=l*m,y=c*p,v=s*m+u,w=i*p+h,A=this.newOutliner({x:this.#i[0]*x+v,y:this.#i[1]*y+w},this.#e,this.#a,e,this.#n,t??this.#s);for(let N=2;N<this.#i.length;N+=2)A.add({x:this.#i[N]*x+v,y:this.#i[N+1]*y+w});return A.getOutlines()}}class np{#e;#t;#s=[];#n=[];constructor(e,t=0,s=0,i=!0){const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:v,y:w,width:A,height:N}of e){const j=Math.floor((v-t)/c)*c,_=Math.ceil((v+A+t)/c)*c,C=Math.floor((w-t)/c)*c,k=Math.ceil((w+N+t)/c)*c,D=[j,C,k,!0],P=[_,C,k,!1];this.#s.push(D,P),Re.rectBoundingBox(j,C,_,k,l)}const u=l[2]-l[0]+2*s,h=l[3]-l[1]+2*s,m=l[0]-s,p=l[1]-s,x=this.#s.at(i?-1:-2),y=[x[0],x[2]];for(const v of this.#s){const[w,A,N]=v;v[0]=(w-m)/u,v[1]=(A-p)/h,v[2]=(N-p)/h}this.#e=new Float32Array([m,p,u,h]),this.#t=y}getOutlines(){this.#s.sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of this.#s)t[3]?(e.push(...this.#u(t)),this.#l(t)):(this.#r(t),e.push(...this.#u(t)));return this.#i(e)}#i(e){const t=[],s=new Set;for(const c of e){const[u,h,m]=c;t.push([u,h,c],[u,m,c])}t.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=t.length;c<u;c+=2){const h=t[c][2],m=t[c+1][2];h.push(m),m.push(h),s.add(h),s.add(m)}const i=[];let l;for(;s.size>0;){const c=s.values().next().value;let[u,h,m,p,x]=c;s.delete(c);let y=u,v=h;for(l=[u,m],i.push(l);;){let w;if(s.has(p))w=p;else if(s.has(x))w=x;else break;s.delete(w),[u,h,m,p,x]=w,y!==u&&(l.push(y,v,u,v===h?h:m),y=u),v=v===h?m:h}l.push(y,v)}return new XD(i,this.#e,this.#t)}#a(e){const t=this.#n;let s=0,i=t.length-1;for(;s<=i;){const l=s+i>>1,c=t[l][0];if(c===e)return l;c<e?s=l+1:i=l-1}return i+1}#l([,e,t]){const s=this.#a(e);this.#n.splice(s,0,[e,t])}#r([,e,t]){const s=this.#a(e);for(let i=s;i<this.#n.length;i++){const[l,c]=this.#n[i];if(l!==e)break;if(l===e&&c===t){this.#n.splice(i,1);return}}for(let i=s-1;i>=0;i--){const[l,c]=this.#n[i];if(l!==e)break;if(l===e&&c===t){this.#n.splice(i,1);return}}}#u(e){const[t,s,i]=e,l=[[t,s,i]],c=this.#a(i);for(let u=0;u<c;u++){const[h,m]=this.#n[u];for(let p=0,x=l.length;p<x;p++){const[,y,v]=l[p];if(!(m<=y||v<=h)){if(y>=h){if(v>m)l[p][1]=m;else{if(x===1)return[];l.splice(p,1),p--,x--}continue}l[p][2]=h,v>m&&l.push([t,m,v])}}}return l}}class XD extends Se{#e;#t;constructor(e,t,s){super(),this.#t=e,this.#e=t,this.lastPoint=s}toSVGPath(){const e=[];for(const t of this.#t){let[s,i]=t;e.push(`M${s} ${i}`);for(let l=2;l<t.length;l+=2){const c=t[l],u=t[l+1];c===s?(e.push(`V${u}`),i=u):u===i&&(e.push(`H${c}`),s=c)}e.push("Z")}return e.join(" ")}serialize([e,t,s,i],l){const c=[],u=s-e,h=i-t;for(const m of this.#t){const p=new Array(m.length);for(let x=0;x<m.length;x+=2)p[x]=e+m[x]*u,p[x+1]=i-m[x+1]*h;c.push(p)}return c}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class ap extends ki{newFreeDrawOutline(e,t,s,i,l,c){return new QD(e,t,s,i,l,c)}}class QD extends V1{newOutliner(e,t,s,i,l,c=0){return new ap(e,t,s,i,l,c)}}class mn{#e=null;#t=null;#s;#n=null;#i=!1;#a=!1;#l=null;#r;#u=null;#o=null;#h;static#d=null;static get _keyboardManager(){return et(this,"_keyboardManager",new Wo([[["Escape","mac+Escape"],mn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],mn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],mn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],mn.prototype._moveToPrevious],[["Home","mac+Home"],mn.prototype._moveToBeginning],[["End","mac+End"],mn.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#a=!1,this.#h=st.HIGHLIGHT_COLOR,this.#l=e):(this.#a=!0,this.#h=st.HIGHLIGHT_DEFAULT_COLOR),this.#o=e?._uiManager||t,this.#r=this.#o._eventBus,this.#s=e?.color?.toUpperCase()||this.#o?.highlightColors.values().next().value||"#FFFF98",mn.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#l&&(e.ariaControls=`${this.#l.id}_colorpicker_dropdown`);const t=this.#o._signal;e.addEventListener("click",this.#c.bind(this),{signal:t}),e.addEventListener("keydown",this.#p.bind(this),{signal:t});const s=this.#t=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#s,e.append(s),e}renderMainDropdown(){const e=this.#n=this.#f();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#f(){const e=document.createElement("div"),t=this.#o._signal;e.addEventListener("contextmenu",_n,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#l&&(e.id=`${this.#l.id}_colorpicker_dropdown`);for(const[s,i]of this.#o.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",i),l.title=s,l.setAttribute("data-l10n-id",mn.#d[s]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=i,l.ariaSelected=i===this.#s,l.addEventListener("click",this.#m.bind(this,i),{signal:t}),e.append(l)}return e.addEventListener("keydown",this.#p.bind(this),{signal:t}),e}#m(e,t){t.stopPropagation(),this.#r.dispatch("switchannotationeditorparams",{source:this,type:this.#h,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#c(e);return}const t=e.target.getAttribute("data-color");t&&this.#m(t,e)}_moveToNext(e){if(!this.#x){this.#c(e);return}if(e.target===this.#e){this.#n.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstChild||e.target===this.#e){this.#x&&this._hideDropdownFromKeyboard();return}this.#x||this.#c(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#x){this.#c(e);return}this.#n.firstChild?.focus()}_moveToEnd(e){if(!this.#x){this.#c(e);return}this.#n.lastChild?.focus()}#p(e){mn._keyboardManager.exec(this,e)}#c(e){if(this.#x){this.hideDropdown();return}if(this.#i=e.detail===0,this.#u||(this.#u=new AbortController,window.addEventListener("pointerdown",this.#g.bind(this),{signal:this.#o.combinedSignal(this.#u)})),this.#e.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#f();this.#e.append(t)}#g(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#u?.abort(),this.#u=null}get#x(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#a){if(!this.#x){this.#l?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#i})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#o.highlightColors.values();for(const s of this.#n.children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class zt extends ke{#e=null;#t=0;#s;#n=null;#i=null;#a=null;#l=null;#r=0;#u=null;#o=null;#h=null;#d=!1;#f=null;#m;#p=null;#c="";#g;#x="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Fe.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=zt.prototype;return et(this,"_keyboardManager",new Wo([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||zt._defaultColor,this.#g=e.thickness||zt._defaultThickness,this.#m=e.opacity||zt._defaultOpacity,this.#s=e.boxes||null,this.#x=e.methodOfCreation||"",this.#c=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#d=!0,this.#v(e),this.#T()):this.#s&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#l=e.focusNode,this.#r=e.focusOffset,this.#y(),this.#T(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#d?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#g,methodOfCreation:this.#x}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#y(){const e=new np(this.#s,.001);this.#o=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#o.box;const t=new np(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#a=t.getOutlines();const{lastPoint:s}=this.#a;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#v({highlightOutlines:e,highlightId:t,clipPathId:s}){this.#o=e;const i=1.5;if(this.#a=e.getNewOutline(this.#g/2+i,.0025),t>=0)this.#h=t,this.#n=s,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},!0);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:zt.#N(this.#o.box,(p-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:zt.#N(this.#a.box,p),path:{d:this.#a.toSVGPath()}})}const[l,c,u,h]=e.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=u,this.height=h;break;case 90:{const[p,x]=this.parentDimensions;this.x=c,this.y=1-l,this.width=u*x/p,this.height=h*p/x;break}case 180:this.x=1-l,this.y=1-c,this.width=u,this.height=h;break;case 270:{const[p,x]=this.parentDimensions;this.x=1-c,this.y=l,this.width=u*x/p,this.height=h*p/x;break}}const{lastPoint:m}=this.#a;this.#f=[(m[0]-l)/u,(m[1]-c)/h]}static initialize(e,t){ke.initialize(e,t),zt._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case st.HIGHLIGHT_DEFAULT_COLOR:zt._defaultColor=t;break;case st.HIGHLIGHT_THICKNESS:zt._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#f}updateParams(e,t){switch(e){case st.HIGHLIGHT_COLOR:this.#w(t);break;case st.HIGHLIGHT_THICKNESS:this.#A(t);break}}static get defaultPropertiesToUpdate(){return[[st.HIGHLIGHT_DEFAULT_COLOR,zt._defaultColor],[st.HIGHLIGHT_THICKNESS,zt._defaultThickness]]}get propertiesToUpdate(){return[[st.HIGHLIGHT_COLOR,this.color||zt._defaultColor],[st.HIGHLIGHT_THICKNESS,this.#g||zt._defaultThickness],[st.HIGHLIGHT_FREE,this.#d]]}#w(e){const t=(l,c)=>{this.color=l,this.#m=c,this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:l,"fill-opacity":c}}),this.#i?.updateColor(l)},s=this.color,i=this.#m;this.addCommands({cmd:t.bind(this,e,zt._defaultOpacity),undo:t.bind(this,s,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#A(e){const t=this.#g,s=i=>{this.#g=i,this.#S(i)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:st.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#i=new mn({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#R())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#R())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#_(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#T(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#_():e&&(this.#T(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#S(e){if(!this.#d)return;this.#v({highlightOutlines:this.#o.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,s]=this.parentDimensions;this.setDims(this.width*t,this.height*s)}#_(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#T(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#o.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#m},rootClass:{highlight:!0,free:this.#d},path:{d:this.#o.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#d},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},this.#d),this.#u&&(this.#u.style.clipPath=this.#n))}static#N([e,t,s,i],l){switch(l){case 90:return[1-t-i,e,i,s];case 180:return[1-e-s,1-t-i,s,i];case 270:return[t,1-e-s,i,s]}return[e,t,s,i]}rotate(e){const{drawLayer:t}=this.parent;let s;this.#d?(e=(e-this.rotation+360)%360,s=zt.#N(this.#o.box,e)):s=zt.#N([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:s,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:zt.#N(this.#a.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#c&&(e.setAttribute("aria-label",this.#c),e.setAttribute("role","mark")),this.#d?e.classList.add("free"):this.div.addEventListener("keydown",this.#C.bind(this),{signal:this._uiManager._signal});const t=this.#u=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n;const[s,i]=this.parentDimensions;return this.setDims(this.width*s,this.height*i),y1(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#C(e){zt._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#E(!0);break;case 1:case 3:this.#E(!1);break}}#E(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#l,this.#r)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#d||this.#E(!1))}get _mustFixPosition(){return!this.#d}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#R(){return this.#d?this.rotation:0}#k(){if(this.#d)return null;const[e,t]=this.pageDimensions,[s,i]=this.pageTranslation,l=this.#s,c=new Float32Array(l.length*8);let u=0;for(const{x:h,y:m,width:p,height:x}of l){const y=h*e+s,v=(1-m)*t+i;c[u]=c[u+4]=y,c[u+1]=c[u+3]=v,c[u+2]=c[u+6]=y+p*e,c[u+5]=c[u+7]=v-x*t,u+=8}return c}#M(e){return this.#o.serialize(e,this.#R())}static startHighlighting(e,t,{target:s,x:i,y:l}){const{x:c,y:u,width:h,height:m}=s.getBoundingClientRect(),p=new AbortController,x=e.combinedSignal(p),y=v=>{p.abort(),this.#j(e,v)};window.addEventListener("blur",y,{signal:x}),window.addEventListener("pointerup",y,{signal:x}),window.addEventListener("pointerdown",Yt,{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",_n,{signal:x}),s.addEventListener("pointermove",this.#z.bind(this,e),{signal:x}),this._freeHighlight=new ap({x:i,y:l},[c,u,h,m],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#z(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#j(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,s){let i=null;if(e instanceof U1){const{data:{quadPoints:w,rect:A,rotation:N,id:j,color:_,opacity:C,popupRef:k},parent:{page:{pageNumber:D}}}=e;i=e={annotationType:Fe.HIGHLIGHT,color:Array.from(_),opacity:C,quadPoints:w,boxes:null,pageIndex:D-1,rect:A.slice(0),rotation:N,annotationElementId:j,id:j,deleted:!1,popupRef:k}}else if(e instanceof Yp){const{data:{inkLists:w,rect:A,rotation:N,id:j,color:_,borderStyle:{rawWidth:C},popupRef:k},parent:{page:{pageNumber:D}}}=e;i=e={annotationType:Fe.HIGHLIGHT,color:Array.from(_),thickness:C,inkLists:w,boxes:null,pageIndex:D-1,rect:A.slice(0),rotation:N,annotationElementId:j,id:j,deleted:!1,popupRef:k}}const{color:l,quadPoints:c,inkLists:u,opacity:h}=e,m=await super.deserialize(e,t,s);m.color=Re.makeHexColor(...l),m.#m=h||1,u&&(m.#g=e.thickness),m._initialData=i;const[p,x]=m.pageDimensions,[y,v]=m.pageTranslation;if(c){const w=m.#s=[];for(let A=0;A<c.length;A+=8)w.push({x:(c[A]-y)/p,y:1-(c[A+1]-v)/x,width:(c[A+2]-c[A])/p,height:(c[A+1]-c[A+5])/x});m.#y(),m.#T(),m.rotate(m.rotation)}else if(u){m.#d=!0;const w=u[0],A={x:w[0]-y,y:x-(w[1]-v)},N=new ap(A,[0,0,p,x],1,m.#g/2,!0,.001);for(let C=0,k=w.length;C<k;C+=2)A.x=w[C]-y,A.y=x-(w[C+1]-v),N.add(A);const{id:j,clipPathId:_}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:m.color,"fill-opacity":m._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:N.toSVGPath()}},!0,!0);m.#v({highlightOutlines:N.getOutlines(),highlightId:j,clipPathId:_}),m.#T(),m.rotate(m.parentRotation)}return m}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),s=ke._colorManager.convert(this.color),i={annotationType:Fe.HIGHLIGHT,color:s,opacity:this.#m,thickness:this.#g,quadPoints:this.#k(),outlines:this.#M(t),pageIndex:this.pageIndex,rect:t,rotation:this.#R(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#b(i)?null:(i.id=this.annotationElementId,i)}#b(e){const{color:t}=this._initialData;return e.color.some((s,i)=>s!==t[i])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class q1{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){xt("Not implemented")}}class Pe extends ke{#e=null;#t;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#s=null;static#n=null;static#i=null;static#a=NaN;static#l=null;static#r=null;static#u=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}_addOutlines(e){e.drawOutlines&&(this.#o(e),this.#f())}#o({drawOutlines:e,drawId:t,drawingOptions:s}){this.#e=e,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#h(e,this.parent),this.#c(e.box)}#h(e,t){const{id:s}=t.drawLayer.draw(Pe._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(e,t){const s=new Set(Object.keys(e));for(const[i,l]of Object.entries(t))s.has(i)?Object.assign(e[i],l):e[i]=l;return e}static getDefaultDrawingOptions(e){xt("Not implemented")}static get typesMap(){xt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const s=this.typesMap.get(e);s&&this._defaultDrawingOptions.updateProperty(s,t),this._currentParent&&(Pe.#s.updateProperty(s,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const s=this.constructor.typesMap.get(e);s&&this._updateProperty(e,s,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[s,i]of this.typesMap)e.push([s,t[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[s,i]of this.constructor.typesMap)e.push([s,t[i]]);return e}_updateProperty(e,t,s){const i=this._drawingOptions,l=i[t],c=u=>{i.updateProperty(t,u);const h=this.#e.updateProperty(t,u);h&&this.#c(h),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:c.bind(this,s),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Pe._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Pe._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Pe._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#d(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#c(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#d()):e&&(this._uiManager.addShouldRescale(this),this.#f(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#d(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#h(this.#e,e)}}#m([e,t,s,i]){const{parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[t,1-e,s*(c/l),i*(l/c)];case 180:return[1-e,1-t,s,i];case 270:return[1-t,e,s*(c/l),i*(l/c)];default:return[e,t,s,i]}}#p(){const{x:e,y:t,width:s,height:i,parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[1-t,e,s*(l/c),i*(c/l)];case 180:return[1-e,1-t,s,i];case 270:return[t,1-e,s*(l/c),i*(c/l)];default:return[e,t,s,i]}}#c(e){if([this.x,this.y,this.width,this.height]=this.#m(e),this.div){this.fixAndSetPosition();const[t,s]=this.parentDimensions;this.setDims(this.width*t,this.height*s)}this._onResized()}#g(){const{x:e,y:t,width:s,height:i,rotation:l,parentRotation:c,parentDimensions:[u,h]}=this;switch((l*4+c)/90){case 1:return[1-t-i,e,i,s];case 2:return[1-e-s,1-t-i,s,i];case 3:return[t,1-e-s,i,s];case 4:return[e,t-s*(u/h),i*(h/u),s*(u/h)];case 5:return[1-t,e,s*(u/h),i*(h/u)];case 6:return[1-e-i*(h/u),1-t,i*(h/u),s*(u/h)];case 7:return[t-s*(u/h),1-e-i*(h/u),s*(u/h),i*(h/u)];case 8:return[e-s,t-i,s,i];case 9:return[1-t,e-s,i,s];case 10:return[1-e,1-t,s,i];case 11:return[t-i,1-e,i,s];case 12:return[e-i*(h/u),t,i*(h/u),s*(u/h)];case 13:return[1-t-s*(u/h),e-i*(h/u),s*(u/h),i*(h/u)];case 14:return[1-e,1-t-s*(u/h),i*(h/u),s*(u/h)];case 15:return[t,1-e,s*(u/h),i*(h/u)];default:return[e,t,s,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Pe._mergeSVGProperties({bbox:this.#g()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#c(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const s=super.render();s.classList.add("draw");const i=document.createElement("div");s.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[l,c]=this.parentDimensions;return this.setDims(this.width*l,this.height*c),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),s}static createDrawerInstance(e,t,s,i,l){xt("Not implemented")}static startDrawing(e,t,s,i){const{target:l,offsetX:c,offsetY:u,pointerId:h,pointerType:m}=i;if(Pe.#l&&Pe.#l!==m)return;const{viewport:{rotation:p}}=e,{width:x,height:y}=l.getBoundingClientRect(),v=Pe.#n=new AbortController,w=e.combinedSignal(v);if(Pe.#a||=h,Pe.#l??=m,window.addEventListener("pointerup",A=>{Pe.#a===A.pointerId?this._endDraw(A):Pe.#r?.delete(A.pointerId)},{signal:w}),window.addEventListener("pointercancel",A=>{Pe.#a===A.pointerId?this._currentParent.endDrawingSession():Pe.#r?.delete(A.pointerId)},{signal:w}),window.addEventListener("pointerdown",A=>{Pe.#l===A.pointerType&&((Pe.#r||=new Set).add(A.pointerId),Pe.#s.isCancellable()&&(Pe.#s.removeLastElement(),Pe.#s.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",_n,{signal:w}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),l.addEventListener("touchmove",A=>{A.timeStamp===Pe.#u&&Yt(A)},{signal:w}),e.toggleDrawing(),t._editorUndoBar?.hide(),Pe.#s){e.drawLayer.updateProperties(this._currentDrawId,Pe.#s.startNew(c,u,x,y,p));return}t.updateUIForDefaultProperties(this),Pe.#s=this.createDrawerInstance(c,u,x,y,p),Pe.#i=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(Pe.#i.toSVGProperties(),Pe.#s.defaultSVGProperties),!0,!1)}static _drawMove(e){if(Pe.#u=-1,!Pe.#s)return;const{offsetX:t,offsetY:s,pointerId:i}=e;if(Pe.#a===i){if(Pe.#r?.size>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Pe.#s.add(t,s)),Pe.#u=e.timeStamp,Yt(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,Pe.#s=null,Pe.#i=null,Pe.#l=null,Pe.#u=NaN),Pe.#n&&(Pe.#n.abort(),Pe.#n=null,Pe.#a=NaN,Pe.#r=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,Pe.#s.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const s=Pe.#s,i=this._currentDrawId,l=s.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(i,s.setLastElement(l))},undo:()=>{t.drawLayer.updateProperties(i,s.removeLastElement())},mustExec:!1,type:st.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(st.DRAW_STEP),!Pe.#s.isEmpty()){const{pageDimensions:[s,i],scale:l}=t,c=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Pe.#s.getOutlines(s*l,i*l,l,this._INNER_MARGIN),drawingOptions:Pe.#i,mustBeCommitted:!e});return this._cleanup(!0),c}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,s,i,l,c){xt("Not implemented")}static async deserialize(e,t,s){const{rawDims:{pageWidth:i,pageHeight:l,pageX:c,pageY:u}}=t.viewport,h=this.deserializeDraw(c,u,i,l,this._INNER_MARGIN,e),m=await super.deserialize(e,t,s);return m.createDrawingOptions(e),m.#o({drawOutlines:h}),m.#f(),m.onScaleChanging(),m.rotate(),m}serializeDraw(e){const[t,s]=this.pageTranslation,[i,l]=this.pageDimensions;return this.#e.serialize([t,s,i,l],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class ZD{#e=new Float64Array(6);#t;#s;#n;#i;#a;#l="";#r=0;#u=new Qo;#o;#h;constructor(e,t,s,i,l,c){this.#o=s,this.#h=i,this.#n=l,this.#i=c,[e,t]=this.#d(e,t);const u=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#a=[e,t],this.#s=[{line:u,points:this.#a}],this.#e.set(u,0)}updateProperty(e,t){e==="stroke-width"&&(this.#i=t)}#d(e,t){return Se._normalizePoint(e,t,this.#o,this.#h,this.#n)}isEmpty(){return!this.#s||this.#s.length===0}isCancellable(){return this.#a.length<=10}add(e,t){[e,t]=this.#d(e,t);const[s,i,l,c]=this.#e.subarray(2,6),u=e-l,h=t-c;return Math.hypot(this.#o*u,this.#h*h)<=2?null:(this.#a.push(e,t),isNaN(s)?(this.#e.set([l,c,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([s,i,l,c,e,t],0),this.#t.push(...Se.createBezierPoints(s,i,l,c,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(this.#a.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,l){this.#o=s,this.#h=i,this.#n=l,[e,t]=this.#d(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#a=[e,t];const u=this.#s.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#s.push({line:c,points:this.#a}),this.#e.set(c,0),this.#r=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(e){return this.#s?(this.#s.push(e),this.#t=e.line,this.#a=e.points,this.#r=0,{path:{d:this.toSVGPath()}}):this.#u.setLastElement(e)}removeLastElement(){if(!this.#s)return this.#u.removeLastElement();this.#s.pop(),this.#l="";for(let e=0,t=this.#s.length;e<t;e++){const{line:s,points:i}=this.#s[e];this.#t=s,this.#a=i,this.#r=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){const e=Se.svgRound(this.#t[4]),t=Se.svgRound(this.#t[5]);if(this.#a.length===2)return this.#l=`${this.#l} M ${e} ${t} Z`,this.#l;if(this.#a.length<=6){const i=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,i)} M ${e} ${t}`,this.#r=6}if(this.#a.length===4){const i=Se.svgRound(this.#t[10]),l=Se.svgRound(this.#t[11]);return this.#l=`${this.#l} L ${i} ${l}`,this.#r=12,this.#l}const s=[];this.#r===0&&(s.push(`M ${e} ${t}`),this.#r=6);for(let i=this.#r,l=this.#t.length;i<l;i+=6){const[c,u,h,m,p,x]=this.#t.slice(i,i+6).map(Se.svgRound);s.push(`C${c} ${u} ${h} ${m} ${p} ${x}`)}return this.#l+=s.join(" "),this.#r=this.#t.length,this.#l}getOutlines(e,t,s,i){const l=this.#s.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#u.build(this.#s,e,t,s,this.#n,this.#i,i),this.#e=null,this.#t=null,this.#s=null,this.#l=null,this.#u}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Qo extends Se{#e;#t=0;#s;#n;#i;#a;#l;#r;#u;build(e,t,s,i,l,c,u){this.#i=t,this.#a=s,this.#l=i,this.#r=l,this.#u=c,this.#s=u??0,this.#n=e,this.#d()}get thickness(){return this.#u}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${Se.svgRound(t[4])} ${Se.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${Se.svgRound(t[10])} ${Se.svgRound(t[11])}`);continue}for(let s=6,i=t.length;s<i;s+=6){const[l,c,u,h,m,p]=t.subarray(s,s+6).map(Se.svgRound);e.push(`C${l} ${c} ${u} ${h} ${m} ${p}`)}}return e.join("")}serialize([e,t,s,i],l){const c=[],u=[],[h,m,p,x]=this.#h();let y,v,w,A,N,j,_,C,k;switch(this.#r){case 0:k=Se._rescale,y=e,v=t+i,w=s,A=-i,N=e+h*s,j=t+(1-m-x)*i,_=e+(h+p)*s,C=t+(1-m)*i;break;case 90:k=Se._rescaleAndSwap,y=e,v=t,w=s,A=i,N=e+m*s,j=t+h*i,_=e+(m+x)*s,C=t+(h+p)*i;break;case 180:k=Se._rescale,y=e+s,v=t,w=-s,A=i,N=e+(1-h-p)*s,j=t+m*i,_=e+(1-h)*s,C=t+(m+x)*i;break;case 270:k=Se._rescaleAndSwap,y=e+s,v=t+i,w=-s,A=-i,N=e+(1-m-x)*s,j=t+(1-h-p)*i,_=e+(1-m)*s,C=t+(1-h)*i;break}for(const{line:D,points:P}of this.#n)c.push(k(D,y,v,w,A,l?new Array(D.length):null)),u.push(k(P,y,v,w,A,l?new Array(P.length):null));return{lines:c,points:u,rect:[N,j,_,C]}}static deserialize(e,t,s,i,l,{paths:{lines:c,points:u},rotation:h,thickness:m}){const p=[];let x,y,v,w,A;switch(h){case 0:A=Se._rescale,x=-e/s,y=t/i+1,v=1/s,w=-1/i;break;case 90:A=Se._rescaleAndSwap,x=-t/i,y=-e/s,v=1/i,w=1/s;break;case 180:A=Se._rescale,x=e/s+1,y=-t/i,v=-1/s,w=1/i;break;case 270:A=Se._rescaleAndSwap,x=t/i+1,y=e/s+1,v=-1/i,w=-1/s;break}if(!c){c=[];for(const j of u){const _=j.length;if(_===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,j[0],j[1]]));continue}if(_===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,j[0],j[1],NaN,NaN,NaN,NaN,j[2],j[3]]));continue}const C=new Float32Array(3*(_-2));c.push(C);let[k,D,P,F]=j.subarray(0,4);C.set([NaN,NaN,NaN,NaN,k,D],0);for(let U=4;U<_;U+=2){const I=j[U],K=j[U+1];C.set(Se.createBezierPoints(k,D,P,F,I,K),(U-2)*3),[k,D,P,F]=[P,F,I,K]}}}for(let j=0,_=c.length;j<_;j++)p.push({line:A(c[j].map(C=>C??NaN),x,y,v,w),points:A(u[j].map(C=>C??NaN),x,y,v,w)});const N=new this.prototype.constructor;return N.build(p,s,i,1,h,m,l),N}#o(e=this.#u){const t=this.#s+e/2*this.#l;return this.#r%180===0?[t/this.#i,t/this.#a]:[t/this.#a,t/this.#i]}#h(){const[e,t,s,i]=this.#e,[l,c]=this.#o(0);return[e+l,t+c,s-2*l,i-2*c]}#d(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:i}of this.#n){if(i.length<=12){for(let u=4,h=i.length;u<h;u+=6)Re.pointBoundingBox(i[u],i[u+1],e);continue}let l=i[4],c=i[5];for(let u=6,h=i.length;u<h;u+=6){const[m,p,x,y,v,w]=i.subarray(u,u+6);Re.bezierBoundingBox(l,c,m,p,x,y,v,w,e),l=v,c=w}}const[t,s]=this.#o();e[0]=Ss(e[0]-t,0,1),e[1]=Ss(e[1]-s,0,1),e[2]=Ss(e[2]+t,0,1),e[3]=Ss(e[3]+s,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,s]=this.#o();this.#u=e;const[i,l]=this.#o(),[c,u]=[i-t,l-s],h=this.#e;return h[0]-=c,h[1]-=u,h[2]+=2*c,h[3]+=2*u,h}updateParentDimensions([e,t],s){const[i,l]=this.#o();this.#i=e,this.#a=t,this.#l=s;const[c,u]=this.#o(),h=c-i,m=u-l,p=this.#e;return p[0]-=h,p[1]-=m,p[2]+=2*h,p[3]+=2*m,p}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(Se.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Se.svgRound(e)} ${Se.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let s=0,i=0,l=0,c=0,u=0,h=0;switch(this.#t){case 90:i=t/e,l=-e/t,u=e;break;case 180:s=-1,c=-1,u=e,h=t;break;case 270:i=-t/e,l=e/t,h=t;break;default:return""}return`matrix(${s} ${i} ${l} ${c} ${Se.svgRound(u)} ${Se.svgRound(h)})`}getPathResizingSVGProperties([e,t,s,i]){const[l,c]=this.#o(),[u,h,m,p]=this.#e;if(Math.abs(m-l)<=Se.PRECISION||Math.abs(p-c)<=Se.PRECISION){const A=e+s/2-(u+m/2),N=t+i/2-(h+p/2);return{path:{"transform-origin":`${Se.svgRound(e)} ${Se.svgRound(t)}`,transform:`${this.rotationTransform} translate(${A} ${N})`}}}const x=(s-2*l)/(m-2*l),y=(i-2*c)/(p-2*c),v=m/s,w=p/i;return{path:{"transform-origin":`${Se.svgRound(u)} ${Se.svgRound(h)}`,transform:`${this.rotationTransform} scale(${v} ${w}) translate(${Se.svgRound(l)} ${Se.svgRound(c)}) scale(${x} ${y}) translate(${Se.svgRound(-l)} ${Se.svgRound(-c)})`}}}getPathResizedSVGProperties([e,t,s,i]){const[l,c]=this.#o(),u=this.#e,[h,m,p,x]=u;if(u[0]=e,u[1]=t,u[2]=s,u[3]=i,Math.abs(p-l)<=Se.PRECISION||Math.abs(x-c)<=Se.PRECISION){const N=e+s/2-(h+p/2),j=t+i/2-(m+x/2);for(const{line:_,points:C}of this.#n)Se._translate(_,N,j,_),Se._translate(C,N,j,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Se.svgRound(e)} ${Se.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(s-2*l)/(p-2*l),v=(i-2*c)/(x-2*c),w=-y*(h+l)+e+l,A=-v*(m+c)+t+c;if(y!==1||v!==1||w!==0||A!==0)for(const{line:N,points:j}of this.#n)Se._rescale(N,w,A,y,v,N),Se._rescale(j,w,A,y,v,j);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Se.svgRound(e)} ${Se.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],s){const[i,l]=s,c=this.#e,u=e-c[0],h=t-c[1];if(this.#i===i&&this.#a===l)for(const{line:m,points:p}of this.#n)Se._translate(m,u,h,m),Se._translate(p,u,h,p);else{const m=this.#i/i,p=this.#a/l;this.#i=i,this.#a=l;for(const{line:x,points:y}of this.#n)Se._rescale(x,u,h,m,p,x),Se._rescale(y,u,h,m,p,y);c[2]*=m,c[3]*=p}return c[0]=e,c[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Se.svgRound(e)} ${Se.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Se.svgRound(e[0])} ${Se.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Su extends q1{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:ke._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Su(this._viewParameters);return e.updateAll(this),e}}class Xp extends Pe{static _type="ink";static _editorType=Fe.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){ke.initialize(e,t),this._defaultDrawingOptions=new Su(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return et(this,"typesMap",new Map([[st.INK_THICKNESS,"stroke-width"],[st.INK_COLOR,"stroke"],[st.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,s,i,l){return new ZD(e,t,s,i,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,s,i,l,c){return Qo.deserialize(e,t,s,i,l,c)}static async deserialize(e,t,s){let i=null;if(e instanceof Yp){const{data:{inkLists:c,rect:u,rotation:h,id:m,color:p,opacity:x,borderStyle:{rawWidth:y},popupRef:v},parent:{page:{pageNumber:w}}}=e;i=e={annotationType:Fe.INK,color:Array.from(p),thickness:y,opacity:x,paths:{points:c},boxes:null,pageIndex:w-1,rect:u.slice(0),rotation:h,annotationElementId:m,id:m,deleted:!1,popupRef:v}}const l=await super.deserialize(e,t,s);return l._initialData=i,l}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:s}=this;t.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:s}){this._drawingOptions=Xp.getDefaultDrawingOptions({stroke:Re.makeHexColor(...e),"stroke-width":t,"stroke-opacity":s})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:s,rect:i}=this.serializeDraw(e),{_drawingOptions:{stroke:l,"stroke-opacity":c,"stroke-width":u}}=this,h={annotationType:Fe.INK,color:ke._colorManager.convert(l),opacity:c,thickness:u,paths:{lines:t,points:s},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(h.isCopy=!0,h):this.annotationElementId&&!this.#e(h)?null:(h.id=this.annotationElementId,h)}#e(e){const{color:t,thickness:s,opacity:i,pageIndex:l}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((c,u)=>c!==t[u])||e.thickness!==s||e.opacity!==i||e.pageIndex!==l}renderAnnotationElement(e){const{points:t,rect:s}=this.serializeDraw(!1);return e.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:t}),null}}class ip extends Qo{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const yd=8,co=3;class Fr{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,s,i){return s-=e,i-=t,s===0?i>0?0:4:s===1?i+6:2-i}static#s=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(e,t,s,i,l,c,u){const h=this.#t(s,i,l,c);for(let m=0;m<8;m++){const p=(-m+h-u+16)%8,x=this.#s[2*p],y=this.#s[2*p+1];if(e[(s+x)*t+(i+y)]!==0)return p}return-1}static#i(e,t,s,i,l,c,u){const h=this.#t(s,i,l,c);for(let m=0;m<8;m++){const p=(m+h+u+16)%8,x=this.#s[2*p],y=this.#s[2*p+1];if(e[(s+x)*t+(i+y)]!==0)return p}return-1}static#a(e,t,s,i){const l=e.length,c=new Int32Array(l);for(let p=0;p<l;p++)c[p]=e[p]<=i?1:0;for(let p=1;p<s-1;p++)c[p*t]=c[p*t+t-1]=0;for(let p=0;p<t;p++)c[p]=c[t*s-1-p]=0;let u=1,h;const m=[];for(let p=1;p<s-1;p++){h=1;for(let x=1;x<t-1;x++){const y=p*t+x,v=c[y];if(v===0)continue;let w=p,A=x;if(v===1&&c[y-1]===0)u+=1,A-=1;else if(v>=1&&c[y+1]===0)u+=1,A+=1,v>1&&(h=v);else{v!==1&&(h=Math.abs(v));continue}const N=[x,p],j=A===x+1,_={isHole:j,points:N,id:u,parent:0};m.push(_);let C;for(const H of m)if(H.id===h){C=H;break}C?C.isHole?_.parent=j?C.parent:h:_.parent=j?h:C.parent:_.parent=j?h:0;const k=this.#n(c,t,p,x,w,A,0);if(k===-1){c[y]=-u,c[y]!==1&&(h=Math.abs(c[y]));continue}let D=this.#s[2*k],P=this.#s[2*k+1];const F=p+D,U=x+P;w=F,A=U;let I=p,K=x;for(;;){const H=this.#i(c,t,I,K,w,A,1);D=this.#s[2*H],P=this.#s[2*H+1];const X=I+D,W=K+P;N.push(W,X);const ce=I*t+K;if(c[ce+1]===0?c[ce]=-u:c[ce]===1&&(c[ce]=u),X===p&&W===x&&I===F&&K===U){c[y]!==1&&(h=Math.abs(c[y]));break}else w=I,A=K,I=X,K=W}}}return m}static#l(e,t,s,i){if(s-t<=4){for(let F=t;F<s-2;F+=2)i.push(e[F],e[F+1]);return}const l=e[t],c=e[t+1],u=e[s-4]-l,h=e[s-3]-c,m=Math.hypot(u,h),p=u/m,x=h/m,y=p*c-x*l,v=h/u,w=1/m,A=Math.atan(v),N=Math.cos(A),j=Math.sin(A),_=w*(Math.abs(N)+Math.abs(j)),C=w*(1-_+_**2),k=Math.max(Math.atan(Math.abs(j+N)*C),Math.atan(Math.abs(j-N)*C));let D=0,P=t;for(let F=t+2;F<s-2;F+=2){const U=Math.abs(y-p*e[F+1]+x*e[F]);U>D&&(P=F,D=U)}D>(m*k)**2?(this.#l(e,t,P+2,i),this.#l(e,P,s,i)):i.push(l,c)}static#r(e){const t=[],s=e.length;return this.#l(e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t}static#u(e,t,s,i,l,c){const u=new Float32Array(c**2),h=-2*i**2,m=c>>1;for(let A=0;A<c;A++){const N=(A-m)**2;for(let j=0;j<c;j++)u[A*c+j]=Math.exp((N+(j-m)**2)/h)}const p=new Float32Array(256),x=-2*l**2;for(let A=0;A<256;A++)p[A]=Math.exp(A**2/x);const y=e.length,v=new Uint8Array(y),w=new Uint32Array(256);for(let A=0;A<s;A++)for(let N=0;N<t;N++){const j=A*t+N,_=e[j];let C=0,k=0;for(let P=0;P<c;P++){const F=A+P-m;if(!(F<0||F>=s))for(let U=0;U<c;U++){const I=N+U-m;if(I<0||I>=t)continue;const K=e[F*t+I],H=u[P*c+U]*p[Math.abs(K-_)];C+=K*H,k+=H}}const D=v[j]=Math.round(C/k);w[D]++}return[v,w]}static#o(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t}static#h(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let i=-1/0,l=1/0;for(let u=0,h=s.length;u<h;u++){if(e[(u<<2)+3]===0){i=s[u]=255;continue}const p=s[u]=e[u<<2];p>i&&(i=p),p<l&&(l=p)}const c=255/(i-l);for(let u=0;u<t;u++)s[u]=(s[u]-l)*c;return s}static#d(e){let t,s=-1/0,i=-1/0;const l=e.findIndex(h=>h!==0);let c=l,u=l;for(t=l;t<256;t++){const h=e[t];h>s&&(t-c>i&&(i=t-c,u=t-1),s=h,c=t)}for(t=u-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:s,height:i}=e,{maxDim:l}=this.#e;let c=s,u=i;if(s>l||i>l){let y=s,v=i,w=Math.log2(Math.max(s,i)/l);const A=Math.floor(w);w=w===A?A-1:A;for(let j=0;j<w;j++){c=Math.ceil(y/2),u=Math.ceil(v/2);const _=new OffscreenCanvas(c,u);_.getContext("2d").drawImage(e,0,0,y,v,0,0,c,u),y=c,v=u,e!==t&&e.close(),e=_.transferToImageBitmap()}const N=Math.min(l/c,l/u);c=Math.round(c*N),u=Math.round(u*N)}const m=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});m.filter="grayscale(1)",m.drawImage(e,0,0,e.width,e.height,0,0,c,u);const p=m.getImageData(0,0,c,u).data;return[this.#h(p),c,u]}static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:i},l,c,u,h){let m=new OffscreenCanvas(1,1),p=m.getContext("2d",{alpha:!1});const x=200,y=p.font=`${s} ${i} ${x}px ${t}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:w,actualBoundingBoxAscent:A,actualBoundingBoxDescent:N,fontBoundingBoxAscent:j,fontBoundingBoxDescent:_,width:C}=p.measureText(e),k=1.5,D=Math.ceil(Math.max(Math.abs(v)+Math.abs(w)||0,C)*k),P=Math.ceil(Math.max(Math.abs(A)+Math.abs(N)||x,Math.abs(j)+Math.abs(_)||x)*k);m=new OffscreenCanvas(D,P),p=m.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=y,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,D,P),p.fillStyle="black",p.fillText(e,D*(k-1)/2,P*(3-k)/2);const F=this.#h(p.getImageData(0,0,D,P).data),U=this.#o(F),I=this.#d(U),K=this.#a(F,D,P,I);return this.processDrawnLines({lines:{curves:K,width:D,height:P},pageWidth:l,pageHeight:c,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,s,i,l){const[c,u,h]=this.#f(e),[m,p]=this.#u(c,u,h,Math.hypot(u,h)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),x=this.#d(p),y=this.#a(m,u,h,x);return this.processDrawnLines({lines:{curves:y,width:u,height:h},pageWidth:t,pageHeight:s,rotation:i,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:i,innerMargin:l,mustSmooth:c,areContours:u}){i%180!==0&&([t,s]=[s,t]);const{curves:h,width:m,height:p}=e,x=e.thickness??0,y=[],v=Math.min(t/m,s/p),w=v/t,A=v/s,N=[];for(const{points:_}of h){const C=c?this.#r(_):_;if(!C)continue;N.push(C);const k=C.length,D=new Float32Array(k),P=new Float32Array(3*(k===2?2:k-2));if(y.push({line:P,points:D}),k===2){D[0]=C[0]*w,D[1]=C[1]*A,P.set([NaN,NaN,NaN,NaN,D[0],D[1]],0);continue}let[F,U,I,K]=C;F*=w,U*=A,I*=w,K*=A,D.set([F,U,I,K],0),P.set([NaN,NaN,NaN,NaN,F,U],0);for(let H=4;H<k;H+=2){const X=D[H]=C[H]*w,W=D[H+1]=C[H+1]*A;P.set(Se.createBezierPoints(F,U,I,K,X,W),(H-2)*3),[F,U,I,K]=[I,K,X,W]}}if(y.length===0)return null;const j=u?new ip:new Qo;return j.build(y,t,s,1,i,u?0:x,l),{outline:j,newCurves:N,areContours:u,thickness:x,width:m,height:p}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:i,height:l}){let c=1/0,u=-1/0,h=0;for(const C of e){h+=C.length;for(let k=2,D=C.length;k<D;k++){const P=C[k]-C[k-2];c=Math.min(c,P),u=Math.max(u,P)}}let m;c>=-128&&u<=127?m=Int8Array:c>=-32768&&u<=32767?m=Int16Array:m=Int32Array;const p=e.length,x=yd+co*p,y=new Uint32Array(x);let v=0;y[v++]=x*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*m.BYTES_PER_ELEMENT,y[v++]=0,y[v++]=i,y[v++]=l,y[v++]=t?0:1,y[v++]=Math.max(0,Math.floor(s??0)),y[v++]=p,y[v++]=m.BYTES_PER_ELEMENT;for(const C of e)y[v++]=C.length-2,y[v++]=C[0],y[v++]=C[1];const w=new CompressionStream("deflate-raw"),A=w.writable.getWriter();await A.ready,A.write(y);const N=m.prototype.constructor;for(const C of e){const k=new N(C.length-2);for(let D=2,P=C.length;D<P;D++)k[D-2]=C[D]-C[D-2];A.write(k)}A.close();const j=await new Response(w.readable).arrayBuffer(),_=new Uint8Array(j);return g1(_)}static async decompressSignature(e){try{const t=wT(e),{readable:s,writable:i}=new DecompressionStream("deflate-raw"),l=i.getWriter();await l.ready,l.write(t).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,u=0;for await(const C of s)c||=new Uint8Array(new Uint32Array(C.buffer,0,4)[0]),c.set(C,u),u+=C.length;const h=new Uint32Array(c.buffer,0,c.length>>2),m=h[1];if(m!==0)throw new Error(`Invalid version: ${m}`);const p=h[2],x=h[3],y=h[4]===0,v=h[5],w=h[6],A=h[7],N=[],j=(yd+co*w)*Uint32Array.BYTES_PER_ELEMENT;let _;switch(A){case Int8Array.BYTES_PER_ELEMENT:_=new Int8Array(c.buffer,j);break;case Int16Array.BYTES_PER_ELEMENT:_=new Int16Array(c.buffer,j);break;case Int32Array.BYTES_PER_ELEMENT:_=new Int32Array(c.buffer,j);break}u=0;for(let C=0;C<w;C++){const k=h[co*C+yd],D=new Float32Array(k+2);N.push(D);for(let P=0;P<co-1;P++)D[P]=h[co*C+yd+P+1];for(let P=0;P<k;P++)D[P+2]=D[P]+_[u++]}return{areContours:y,thickness:v,outlines:N,width:p,height:x}}catch(t){return Ue(`decompressSignature: ${t}`),null}}}class Qp extends q1{constructor(){super(),super.updateProperties({fill:ke._defaultLineColor,"stroke-width":0})}clone(){const e=new Qp;return e.updateAll(this),e}}class Zp extends Su{constructor(e){super(e),super.updateProperties({stroke:ke._defaultLineColor,"stroke-width":1})}clone(){const e=new Zp(this._viewParameters);return e.updateAll(this),e}}class Vn extends Pe{#e=!1;#t=null;#s=null;#n=null;static _type="signature";static _editorType=Fe.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#s=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){ke.initialize(e,t),this._defaultDrawingOptions=new Qp,this._defaultDrawnSignatureOptions=new Zp(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return et(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#s){const{lines:i,mustSmooth:l,areContours:c,description:u,uuid:h,heightInPage:m}=this.#s,{rawDims:{pageWidth:p,pageHeight:x},rotation:y}=this.parent.viewport,v=Fr.processDrawnLines({lines:i,pageWidth:p,pageHeight:x,rotation:y,innerMargin:Vn._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(v,m,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return s&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#n=e,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#t}set description(e){this.#t=e,super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)})}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:s,width:i,height:l}=this.#s,c=Math.max(i,l),u=Fr.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:s,width:i,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,s,i){const{x:l,y:c}=this,{outline:u}=this.#s=e;this.#e=u instanceof ip,this.description=s,this.div.setAttribute("data-l10n-args",JSON.stringify({description:s}));let h;this.#e?h=Vn.getDefaultDrawingOptions():(h=Vn._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[m,p]=this.parentDimensions,[,x]=this.pageDimensions;let y=t/x;y=y>=1?.5:y,this.width*=y/this.height,this.width>=1&&(y*=.9/this.width,this.width=.9),this.height=y,this.setDims(m*this.width,p*this.height),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:s},rotation:i}=this.parent.viewport;return Fr.process(e,t,s,i,Vn._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:l}=this.parent.viewport;return Fr.extractContoursFromText(e,t,s,i,l,Vn._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:s},rotation:i}=this.parent.viewport;return Fr.processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:i,innerMargin:Vn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=Vn.getDefaultDrawingOptions():(this._drawingOptions=Vn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:s,rect:i}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":l}}=this,c={annotationType:Fe.SIGNATURE,isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:l,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(c.paths={lines:t,points:s},c.uuid=this.#n,c.isCopy=!0):c.lines=t,this.#t&&(c.accessibilityData={type:"Figure",alt:this.#t}),c}static deserializeDraw(e,t,s,i,l,c){return c.areContours?ip.deserialize(e,t,s,i,l,c):Qo.deserialize(e,t,s,i,l,c)}static async deserialize(e,t,s){const i=await super.deserialize(e,t,s);return i.#e=e.areContours,i.#t=e.accessibilityData?.alt||"",i.#n=e.uuid,i}}class KD extends ke{#e=null;#t=null;#s=null;#n=null;#i=null;#a="";#l=null;#r=!1;#u=null;#o=!1;#h=!1;static _type="stamp";static _editorType=Fe.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#i=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){ke.initialize(e,t)}static isHandlingMimeForPasting(e){return Km.includes(e)}static paste(e,t){t.pasteEditor({mode:Fe.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#d(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#o=e.isSvg),e.file&&(this.#a=e.file.name),this.#p()}#f(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:l,height:c}=e||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:i,width:l,height:c,channels:i.length/(l*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),t&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(s=>this.#d(s,!0)).finally(()=>this.#f());return}if(this.#n){const s=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(s).then(i=>this.#d(i)).finally(()=>this.#f());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(s).then(i=>this.#d(i)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=Km.join(",");const t=this._uiManager._signal;this.#s=new Promise(s=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#d(i)}s()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),s()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#l?.remove(),this.#l=null,this.#u&&(clearTimeout(this.#u),this.#u=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#m();return}super.rebuild(),this.div!==null&&(this.#t&&this.#l===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#s||this.#e||this.#n||this.#i||this.#t||this.#r)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#r||(this.#e?this.#p():this.#m()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:s,bitmap:i}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#t=s,i&&(this.#e=i),this.#r=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#u!==null&&clearTimeout(this.#u);const e=200;this.#u=setTimeout(()=>{this.#u=null,this.#g()},e)}#p(){const{div:e}=this;let{width:t,height:s}=this.#e;const[i,l]=this.pageDimensions,c=.75;if(this.width)t=this.width*i,s=this.height*l;else if(t>c*i||s>c*l){const p=Math.min(c*i/t,c*l/s);t*=p,s*=p}const[u,h]=this.parentDimensions;this.setDims(t*u/i,s*h/l),this._uiManager.enableWaiting(!1);const m=this.#l=document.createElement("canvas");m.setAttribute("role","img"),this.addContainer(m),this.width=t/i,this.height=s/l,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#g(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#a&&this.div.setAttribute("aria-description",this.#a),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,s=!1){e||(e=224);const{width:i,height:l}=this.#e,c=new Wn;let u=this.#e,h=i,m=l,p=null;if(t){if(i>t||l>t){const P=Math.min(t/i,t/l);h=Math.floor(i*P),m=Math.floor(l*P)}p=document.createElement("canvas");const y=p.width=Math.ceil(h*c.sx),v=p.height=Math.ceil(m*c.sy);this.#o||(u=this.#c(y,v));const w=p.getContext("2d");w.filter=this._uiManager.hcmFilter;let A="white",N="#cfcfd8";this._uiManager.hcmFilter!=="none"?N="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(A="#8f8f9d",N="#42414d");const j=15,_=j*c.sx,C=j*c.sy,k=new OffscreenCanvas(_*2,C*2),D=k.getContext("2d");D.fillStyle=A,D.fillRect(0,0,_*2,C*2),D.fillStyle=N,D.fillRect(0,0,_,C),D.fillRect(_,C,_,C),w.fillStyle=w.createPattern(k,"repeat"),w.fillRect(0,0,y,v),w.drawImage(u,0,0,u.width,u.height,0,0,y,v)}let x=null;if(s){let y,v;if(c.symmetric&&u.width<e&&u.height<e)y=u.width,v=u.height;else if(u=this.#e,i>e||l>e){const N=Math.min(e/i,e/l);y=Math.floor(i*N),v=Math.floor(l*N),this.#o||(u=this.#c(y,v))}const A=new OffscreenCanvas(y,v).getContext("2d",{willReadFrequently:!0});A.drawImage(u,0,0,u.width,u.height,0,0,y,v),x={width:y,height:v,data:A.getImageData(0,0,y,v).data}}return{canvas:p,width:h,height:m,imageData:x}}#c(e,t){const{width:s,height:i}=this.#e;let l=s,c=i,u=this.#e;for(;l>2*e||c>2*t;){const h=l,m=c;l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*t&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const p=new OffscreenCanvas(l,c);p.getContext("2d").drawImage(u,0,0,h,m,0,0,l,c),u=p.transferToImageBitmap()}return u}#g(){const[e,t]=this.parentDimensions,{width:s,height:i}=this,l=new Wn,c=Math.ceil(s*e*l.sx),u=Math.ceil(i*t*l.sy),h=this.#l;if(!h||h.width===c&&h.height===u)return;h.width=c,h.height=u;const m=this.#o?this.#e:this.#c(c,u),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(m,0,0,m.width,m.height,0,0,c,u)}#x(e){if(e){if(this.#o){const i=this._uiManager.imageManager.getSvgUrl(this.#t);if(i)return i}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#o){const[t,s]=this.pageDimensions,i=Math.round(this.width*t*Kr.PDF_TO_CSS_UNITS),l=Math.round(this.height*s*Kr.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(i,l);return c.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,i,l),c.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,s){let i=null,l=!1;if(e instanceof $1){const{data:{rect:A,rotation:N,id:j,structParent:_,popupRef:C},container:k,parent:{page:{pageNumber:D}},canvas:P}=e;let F,U;P?(delete e.canvas,{id:F,bitmap:U}=s.imageManager.getFromCanvas(k.id,P),P.remove()):(l=!0,e._hasNoCanvas=!0);const I=(await t._structTree.getAriaAttributes(`${Pp}${j}`))?.get("aria-label")||"";i=e={annotationType:Fe.STAMP,bitmapId:F,bitmap:U,pageIndex:D-1,rect:A.slice(0),rotation:N,annotationElementId:j,id:j,deleted:!1,accessibilityData:{decorative:!1,altText:I},isSvg:!1,structParent:_,popupRef:C}}const c=await super.deserialize(e,t,s),{rect:u,bitmap:h,bitmapUrl:m,bitmapId:p,isSvg:x,accessibilityData:y}=e;l?(s.addMissingCanvas(e.id,c),c.#r=!0):p&&s.imageManager.isValidId(p)?(c.#t=p,h&&(c.#e=h)):c.#n=m,c.#o=x;const[v,w]=c.pageDimensions;return c.width=(u[2]-u[0])/v,c.height=(u[3]-u[1])/w,y&&(c.altTextData=y),c._initialData=i,c.#h=!!i,c}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:Fe.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#o,structTreeParentId:this._structTreeParentId};if(e)return s.bitmapUrl=this.#x(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:i,altText:l}=this.serializeAltText(!1);if(!i&&l&&(s.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#y(s);if(u.isSame)return null;u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,t===null)return s;t.stamps||=new Map;const c=this.#o?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:c,serialized:s}),s.bitmap=this.#x(!1);else if(this.#o){const u=t.stamps.get(this.#t);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#x(!1))}return s}#y(e){const{pageIndex:t,accessibilityData:{altText:s}}=this._initialData,i=e.pageIndex===t,l=(e.accessibilityData?.alt||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&l,isSameAltText:l}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class fa{#e;#t=!1;#s=null;#n=null;#i=null;#a=new Map;#l=!1;#r=!1;#u=!1;#o=null;#h=null;#d=null;#f=null;#m=null;#p=-1;#c;static _initialized=!1;static#g=new Map([Kt,Xp,KD,zt,Vn].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:l,annotationLayer:c,drawLayer:u,textLayer:h,viewport:m,l10n:p}){const x=[...fa.#g.values()];if(!fa._initialized){fa._initialized=!0;for(const y of x)y.initialize(p,e)}e.registerEditorTypes(x),this.#c=e,this.pageIndex=t,this.div=s,this.#e=l,this.#s=c,this.viewport=m,this.#d=h,this.drawLayer=u,this._structTree=i,this.#c.addLayer(this)}get isEmpty(){return this.#a.size===0}get isInvisible(){return this.isEmpty&&this.#c.getMode()===Fe.NONE}updateToolbar(e){this.#c.updateToolbar(e)}updateMode(e=this.#c.getMode()){switch(this.#A(),e){case Fe.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Fe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Fe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of fa.#g.values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#d?.div}setEditingState(e){this.#c.setEditingState(e)}addCommands(e){this.#c.addCommands(e)}cleanUndoStack(e){this.#c.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#s?.div.classList.toggle("disabled",!e)}async enable(){this.#u=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.#m?.abort(),this.#m=null;const e=new Set;for(const s of this.#a.values())s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#c.removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!this.#s){this.#u=!1;return}const t=this.#s.getEditableAnnotations();for(const s of t){if(s.hide(),this.#c.isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}this.#u=!1}disable(){if(this.#r=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.#d&&!this.#m){this.#m=new AbortController;const i=this.#c.combinedSignal(this.#m);this.#d.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:h,timeStamp:m}=l,p=this.#p;if(m-p>500){this.#p=m;return}this.#p=-1;const{classList:x}=this.div;x.toggle("getElements",!0);const y=document.elementsFromPoint(u,h);if(x.toggle("getElements",!1),!this.div.contains(y[0]))return;let v;const w=new RegExp(`^${u1}[0-9]+$`);for(const N of y)if(w.test(N.id)){v=N.id;break}if(!v)return;const A=this.#a.get(v);A?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),A.dblclick())},{signal:i,capture:!0})}const e=new Map,t=new Map;for(const i of this.#a.values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){e.set(i.annotationElementId,i);continue}else t.set(i.annotationElementId,i);this.getEditableAnnotation(i.annotationElementId)?.show(),i.remove()}if(this.#s){const i=this.#s.getEditableAnnotations();for(const l of i){const{id:c}=l.data;if(this.#c.isDeletedAnnotationElement(c))continue;let u=t.get(c);if(u){u.resetAnnotationElement(l),u.show(!1),l.show();continue}u=e.get(c),u&&(this.#c.addChangedExistingAnnotation(u),u.renderAnnotationElement(l)&&u.show(!1)),l.show()}}this.#A(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const i of fa.#g.values())s.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#r=!1}getEditableAnnotation(e){return this.#s?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#c.getActive()!==e&&this.#c.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#d?.div&&!this.#f){this.#f=new AbortController;const e=this.#c.combinedSignal(this.#f);this.#d.div.addEventListener("pointerdown",this.#x.bind(this),{signal:e}),this.#d.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#d?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#d.div.classList.remove("highlighting"))}#x(e){this.#c.unselectAll();const{target:t}=e;if(t===this.#d.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#d.div.contains(t)){const{isMac:s}=fs.platform;if(e.button!==0||e.ctrlKey&&s)return;this.#c.showAllEditors("highlight",!0,!0),this.#d.div.classList.add("free"),this.toggleDrawing(),zt.startHighlighting(this,this.#c.direction==="ltr",{target:this.#d.div,x:e.x,y:e.y}),this.#d.div.addEventListener("pointerup",()=>{this.#d.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#c._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#c.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#a.set(e.id,e);const{annotationElementId:t}=e;t&&this.#c.isDeletedAnnotationElement(t)&&this.#c.removeDeletedAnnotationElement(e)}detach(e){this.#a.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#r&&e.annotationElementId&&this.#c.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#c.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#c.addDeletedAnnotationElement(e.annotationElementId),ke.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#c.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#u),this.#c.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#i&&(e._focusEventsAllowed=!1,this.#i=setTimeout(()=>{this.#i=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#c._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return this.#c.getId()}get#y(){return fa.#g.get(this.#c.getMode())}combinedSignal(e){return this.#c.combinedSignal(e)}#v(e){const t=this.#y;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#c.updateMode(e.mode);const{offsetX:s,offsetY:i}=this.#w(),l=this.getNextId(),c=this.#v({parent:this,id:l,x:s,y:i,uiManager:this.#c,isCentered:!0,...t});c&&this.add(c)}async deserialize(e){return await fa.#g.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#c)||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),l=this.#v({parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:this.#c,isCentered:t,...s});return l&&this.add(l),l}#w(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),l=Math.max(0,e),c=Math.max(0,t),u=Math.min(window.innerWidth,e+s),h=Math.min(window.innerHeight,t+i),m=(l+u)/2-e,p=(c+h)/2-t,[x,y]=this.viewport.rotation%180===0?[m,p]:[p,m];return{offsetX:x,offsetY:y}}addNewEditor(e={}){this.createAndAddNewEditor(this.#w(),!0,e)}setSelected(e){this.#c.setSelected(e)}toggleSelected(e){this.#c.toggleSelected(e)}unselect(e){this.#c.unselect(e)}pointerup(e){const{isMac:t}=fs.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#l||(this.#l=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const s=this.#c.getMode();if(s===Fe.STAMP||s===Fe.SIGNATURE){this.#c.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#c.getMode()===Fe.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:t}=fs.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#l=!0,this.#y?.isDrawer){this.startDrawingSession(e);return}const s=this.#c.getActive();this.#t=!s||s.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#o){this.#y.startDrawing(this,this.#c,!1,e);return}this.#c.setCurrentDrawingSession(this),this.#o=new AbortController;const t=this.#c.combinedSignal(this.#o);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#y.startDrawing(this,this.#c,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#o?(this.#c.setCurrentDrawingSession(null),this.#o.abort(),this.#o=null,this.#h=null,this.#y.endDrawing(e)):null}findNewParent(e,t,s){const i=this.#c.findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return this.#o?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#o&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#c.getActive()?.parent===this&&(this.#c.commitOrRemove(),this.#c.setActiveEditor(null)),this.#i&&(clearTimeout(this.#i),this.#i=null);for(const e of this.#a.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#a.clear(),this.#c.removeLayer(this)}#A(){for(const e of this.#a.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,Ui(this.div,e);for(const t of this.#c.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#c.commitOrRemove(),this.#A();const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,Ui(this.div,{rotation:s}),t!==s)for(const i of this.#a.values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#c.viewParameters.realScale}}class us{#e=null;#t=new Map;#s=new Map;static#n=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return et(this,"_svgFactory",new Wd)}static#i(e,[t,s,i,l]){const{style:c}=e;c.top=`${100*s}%`,c.left=`${100*t}%`,c.width=`${100*i}%`,c.height=`${100*l}%`}#a(){const e=us._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#l(e,t){const s=us._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const l=us._svgFactory.createElement("use");return s.append(l),l.setAttribute("href",`#${t}`),l.classList.add("clip"),i}#r(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)}draw(e,t=!1,s=!1){const i=us.#n++,l=this.#a(),c=us._svgFactory.createElement("defs");l.append(c);const u=us._svgFactory.createElement("path");c.append(u);const h=`path_p${this.pageIndex}_${i}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#s.set(i,u);const m=s?this.#l(c,h):null,p=us._svgFactory.createElement("use");return l.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(l,e),this.#t.set(i,l),{id:i,clipPathId:`url(#${m})`}}drawOutline(e,t){const s=us.#n++,i=this.#a(),l=us._svgFactory.createElement("defs");i.append(l);const c=us._svgFactory.createElement("path");l.append(c);const u=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const x=us._svgFactory.createElement("mask");l.append(x),h=`mask_p${this.pageIndex}_${s}`,x.setAttribute("id",h),x.setAttribute("maskUnits","objectBoundingBox");const y=us._svgFactory.createElement("rect");x.append(y),y.setAttribute("width","1"),y.setAttribute("height","1"),y.setAttribute("fill","white");const v=us._svgFactory.createElement("use");x.append(v),v.setAttribute("href",`#${u}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const m=us._svgFactory.createElement("use");i.append(m),m.setAttribute("href",`#${u}`),h&&m.setAttribute("mask",`url(#${h})`);const p=m.cloneNode();return i.append(p),m.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(i,e),this.#t.set(s,i),s}finalizeDraw(e,t){this.#s.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:s,bbox:i,rootClass:l,path:c}=t,u=typeof e=="number"?this.#t.get(e):e;if(u){if(s&&this.#r(u,s),i&&us.#i(u,i),l){const{classList:h}=u;for(const[m,p]of Object.entries(l))h.toggle(m,p)}if(c){const m=u.firstChild.firstChild;this.#r(m,c)}}}updateParent(e,t){if(t===this)return;const s=this.#t.get(e);s&&(t.#e.append(s),this.#t.delete(e),t.#t.set(e,s))}remove(e){this.#s.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#s.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:np};globalThis.pdfjsLib={AbortException:Ja,AnnotationEditorLayer:fa,AnnotationEditorParamsType:st,AnnotationEditorType:Fe,AnnotationEditorUIManager:ei,AnnotationLayer:Wp,AnnotationMode:Ya,AnnotationType:Gt,build:DD,ColorPicker:mn,createValidAbsoluteUrl:h1,DOMSVGFactory:Wd,DrawLayer:us,FeatureTest:fs,fetchData:Go,getDocument:SD,getFilenameFromUrl:AT,getPdfFilenameFromUrl:NT,getUuid:p1,getXfaPageViewport:ST,GlobalWorkerOptions:Wr,ImageKind:kd,InvalidPDFException:Zm,isDataScheme:Au,isPdfFile:Bp,isValidExplicitDest:PT,MathClamp:Ss,noContextMenu:_n,normalizeUnicode:bT,OPS:Gd,OutputScale:Wn,PasswordResponses:dT,PDFDataRangeTransport:M1,PDFDateString:x1,PDFWorker:Ro,PermissionFlag:cT,PixelsPerInch:Kr,RenderingCancelledException:Ip,ResponseException:Yd,setLayerDimensions:Ui,shadow:et,SignatureExtractor:Fr,stopEvent:Yt,SupportedImageMimeTypes:Km,TextLayer:Ns,TouchManager:Nu,updateUrlHash:f1,Util:Re,VerbosityLevel:bu,version:P1,XfaLayer:I1};Wr.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${P1}/pdf.worker.min.js`;const JD=({employeeId:n,onClose:e})=>{const[t,s]=E.useState(null),[i,l]=E.useState(!0),[c,u]=E.useState({});E.useEffect(()=>{n&&(async()=>{try{l(!0);const[x,y]=await Promise.all([xe.get(`/employee/${n}`),xe.get(`/employee/bank/${n}`).catch(v=>{if(v.response?.status===404)return{data:null};throw v})]);s({...x.data.data,bankDetails:y.data})}catch(x){console.error("Error fetching employee details:",x),alert("Error loading employee details")}finally{l(!1)}})()},[n]);const h=p=>{try{return p.split("/").pop().split("?")[0]}catch{return"document.pdf"}},m=async(p,x,y)=>{u(v=>({...v,[y]:!0}));try{const v=await xe.get(p,{responseType:"blob"}),w=new Blob([v.data],{type:v.data.type}),A=window.URL.createObjectURL(w),N=document.createElement("a");N.href=A,N.download=x||p.split("/").pop(),document.body.appendChild(N),N.click(),N.remove(),window.URL.revokeObjectURL(A)}catch(v){console.error("Download failed:",v),alert("Download failed. Please try again.")}finally{u(v=>({...v,[y]:!1}))}};return i?r.jsx("div",{className:"fixed inset-0 bg-opacity-50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:r.jsx("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full p-6",children:r.jsx("div",{className:"flex justify-center items-center h-40",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#104774]"})})})}):t?r.jsx("div",{className:"fixed inset-0 bg-opacity-50 backdrop-blur-sm z-50 flex items-center justify-center p-2",children:r.jsxs("div",{className:"bg-white rounded-md shadow-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto text-sm",children:[r.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-2 flex justify-between items-center",children:[r.jsxs("h2",{className:"text-sm font-semibold text-gray-800",children:["Employee Details - ",t.firstName," ",t.lastName]}),r.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-base",children:"×"})]}),r.jsxs("div",{className:"p-3 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[r.jsx("h3",{className:"text-xs font-semibold mb-2 text-[#104774]",children:"Personal Information"}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"ID:"}),r.jsx("span",{children:t.employeeId})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"Name:"}),r.jsxs("span",{children:[t.firstName," ",t.lastName]})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"Email:"}),r.jsx("span",{children:t.user?.email})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"Phone:"}),r.jsx("span",{children:t.phone||"N/A"})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"DOB:"}),r.jsx("span",{children:t.dob?new Date(t.dob).toLocaleDateString():"N/A"})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"Gender:"}),r.jsx("span",{className:"capitalize",children:t.gender||"N/A"})]}),r.jsxs("div",{className:"flex items-start",children:[r.jsx("span",{className:"font-medium w-24",children:"Address:"}),r.jsx("span",{children:t.address||"N/A"})]})]})]}),r.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[r.jsx("h3",{className:"text-xs font-semibold mb-2 text-[#104774]",children:"Job Information"}),r.jsxs("div",{className:"space-y-1.5",children:[r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"Dept:"}),r.jsx("span",{children:t.department||"N/A"})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"Designation:"}),r.jsx("span",{children:t.designation||"N/A"})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"Joining:"}),r.jsx("span",{children:t.dateOfJoining?new Date(t.dateOfJoining).toLocaleDateString():"N/A"})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"Type:"}),r.jsx("span",{className:"capitalize",children:t.employmentType||"N/A"})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"Work Mode:"}),r.jsx("span",{className:"capitalize",children:t.workMode||"N/A"})]}),t.shiftTiming?.start&&r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"Shift:"}),r.jsxs("span",{children:[t.shiftTiming.start," - ",t.shiftTiming.end]})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"Role:"}),r.jsx("span",{children:t.user?.role||"N/A"})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"font-medium w-24",children:"Status:"}),r.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${t.user?.isActive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:t.user?.isActive?"Active":"Inactive"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[t.bankDetails&&r.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[r.jsx("h3",{className:"text-xs font-semibold mb-2 text-[#104774]",children:"Bank"}),r.jsxs("div",{className:"space-y-1 text-xs",children:[r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"w-28",children:"Holder:"}),r.jsx("span",{children:t.bankDetails.accountHolderName})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"w-28",children:"Number:"}),r.jsx("span",{children:t.bankDetails.accountNumber})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"w-28",children:"Bank:"}),r.jsx("span",{children:t.bankDetails.bankName})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"w-28",children:"IFSC:"}),r.jsx("span",{children:t.bankDetails.ifscCode})]}),r.jsxs("div",{className:"flex",children:[r.jsx("span",{className:"w-28",children:"Type:"}),r.jsx("span",{children:t.bankDetails.accountType})]})]})]}),t.documents?.length>0&&r.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[r.jsx("h3",{className:"text-xs font-semibold mb-2 text-[#104774]",children:"Documents"}),r.jsx("div",{className:"space-y-1",children:t.documents.map((p,x)=>r.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded border text-xs",children:[r.jsx("span",{className:"truncate",children:p.name||h(p.url)}),r.jsx("button",{onClick:()=>m(p.url,p.name,x),disabled:c?.[x],className:"text-[#104774] hover:underline",children:c?.[x]?"...":"Download"})]},x))})]})]})]}),r.jsx("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 p-2 text-right",children:r.jsx("button",{onClick:e,className:"px-3 py-1 bg-gray-600 text-white rounded text-xs hover:bg-gray-700",children:"Close"})})]})}):r.jsx("div",{className:"fixed inset-0 bg-opacity-50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:r.jsx("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full p-6",children:r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:"text-red-500",children:"Employee not found"}),r.jsx("button",{onClick:e,className:"mt-4 px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Close"})]})})})},rv=()=>{const[n,e]=E.useState(!1),[t,s]=E.useState([]),[i,l]=E.useState(null),[c,u]=E.useState(null),[h,m]=E.useState(!1),p=async()=>{try{const N=await xe.get("/employee/all-employees");s(N.data.data||[])}catch(N){console.error("Error fetching employees:",N)}};E.useEffect(()=>{p()},[]);const x=()=>{l(null),e(!0)},y=async N=>{if(!N?._id){l(N),e(!0);return}m(!0);try{const j=await xe.get(`/employee/${N._id}`),_=j.data?.data||j.data||N;l(_),e(!0)}catch(j){console.warn("Could not fetch full employee, opening with provided object:",j),l(N),e(!0)}finally{m(!1)}},v=()=>{e(!1),l(null),p()},w=N=>{u(N._id)},A=()=>{u(null)};return r.jsxs("div",{className:"min-h-[80vh] p-3 md:p-4 lg:p-6 bg-gray-50",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 mb-4 md:mb-6",children:[r.jsx("h2",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-800 text-center sm:text-left",children:"Manage Employees"}),r.jsx("button",{onClick:x,className:"px-3 py-2 md:px-4 md:py-2.5 text-white font-semibold rounded-lg hover:opacity-90 transition shadow-md hover:shadow-lg w-full sm:w-auto text-xs sm:text-sm",style:{backgroundColor:"#104774"},children:"+ New Employee"})]}),r.jsxs("div",{className:"bg-white rounded-lg md:rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[r.jsx("div",{className:"block md:hidden space-y-3 p-3",children:t.length>0?t.map((N,j)=>r.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200 shadow-sm hover:shadow-md transition-all duration-200",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"inline-flex items-center justify-center w-5 h-5 rounded-full bg-blue-50 text-blue-600 text-xs font-bold mr-2",children:j+1}),r.jsx("span",{className:"text-xs text-slate-500",children:"Employee ID"})]}),r.jsx("p",{className:"text-xs font-mono font-semibold bg-blue-50 px-2 py-1 rounded-md text-blue-700",children:N.employeeId||"N/A"})]}),r.jsxs("div",{className:"mb-3",children:[r.jsxs("h3",{className:"text-sm font-semibold text-slate-900 mb-1",children:[N.firstName," ",N.lastName]}),r.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[r.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:N.department||"N/A"}),r.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:N.designation||"N/A"})]}),r.jsxs("div",{className:"mt-2 flex items-center text-xs text-slate-600",children:[r.jsx("svg",{className:"w-3 h-3 mr-1 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),r.jsx("span",{className:"truncate",children:N.user?.email||"N/A"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:()=>y(N),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-xs font-medium text-white rounded-md hover:opacity-90 transition-all duration-200 shadow-sm",style:{backgroundColor:"#104774"},children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),r.jsxs("button",{onClick:()=>w(N),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-xs font-medium bg-slate-700 text-white rounded-md hover:bg-slate-800 transition-all duration-200 shadow-sm",children:[r.jsxs("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View"]})]})]},N._id)):r.jsx("div",{className:"text-center p-4 bg-gradient-to-br from-slate-50 to-blue-50 rounded-lg border border-slate-200 shadow-sm",children:r.jsxs("div",{className:"flex flex-col items-center justify-center",children:[r.jsxs("div",{className:"relative mb-3",children:[r.jsx("svg",{className:"w-12 h-12 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})]}),r.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-1",children:"No employees found"}),r.jsx("p",{className:"text-xs text-slate-500 max-w-xs mb-3",children:"Get started by adding your first employee to the system"}),r.jsx("button",{className:"px-3 py-1.5 text-xs font-medium text-white rounded-md shadow-sm hover:opacity-90 transition-all duration-200",style:{backgroundColor:"#104774"},children:"+ New Employee"})]})})}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full border-collapse min-w-[600px]",children:[r.jsx("thead",{className:"bg-[#104774] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"#"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Employee ID"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Name"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Department"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Designation"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Email"}),r.jsx("th",{className:"px-2 py-1.5 text-center text-xs font-semibold uppercase",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-200",children:t.length>0?t.map((N,j)=>r.jsxs("tr",{className:"hover:bg-slate-50 transition-colors duration-150 even:bg-slate-50/50",children:[r.jsx("td",{className:"px-2 py-1.5 font-medium text-slate-700 text-xs",children:j+1}),r.jsx("td",{className:"px-2 py-1.5 font-mono text-xs text-blue-700",children:N.employeeId||"N/A"}),r.jsxs("td",{className:"px-2 py-1.5 font-medium text-xs",children:[N.firstName," ",N.lastName]}),r.jsx("td",{className:"px-2 py-1.5",children:r.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:N.department||"N/A"})}),r.jsx("td",{className:"px-2 py-1.5 text-xs text-slate-600",children:N.designation||"N/A"}),r.jsx("td",{className:"px-2 py-1.5 text-blue-600 text-xs",children:N.user?.email||"N/A"}),r.jsxs("td",{className:"px-2 py-1.5 flex justify-center gap-1",children:[r.jsx("button",{onClick:()=>y(N),className:"px-2 py-1 text-xs font-medium text-white rounded-md hover:opacity-90 transition shadow-sm",style:{backgroundColor:"#104774"},children:"Edit"}),r.jsx("button",{onClick:()=>w(N),className:"px-2 py-1 text-xs font-medium bg-slate-600 text-white rounded-md hover:bg-slate-700 transition shadow-sm",children:"View"})]})]},N._id)):r.jsx("tr",{children:r.jsx("td",{colSpan:"7",className:"text-center p-4 text-slate-500",children:r.jsxs("div",{className:"flex flex-col items-center justify-center",children:[r.jsx("svg",{className:"w-12 h-12 text-slate-300 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),r.jsx("p",{className:"text-sm font-medium",children:"No employees found"}),r.jsx("p",{className:"mt-1 text-xs",children:'Click "New Employee" to add your first employee'})]})})})})]})})]}),c&&r.jsx(JD,{employeeId:c,onClose:A}),n&&r.jsx("div",{className:"fixed inset-0  bg-opacity-40 backdrop-blur-sm z-50 flex items-center justify-center p-3 md:p-4",children:h?r.jsxs("div",{className:"bg-white rounded-lg p-4 md:p-6 flex items-center justify-center max-w-xs w-full",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 md:h-6 md:w-6 border-b-2 border-[#104774] mr-2 md:mr-3"}),r.jsx("div",{className:"text-xs md:text-sm",children:"Loading employee details..."})]}):r.jsx(oT,{onClose:v,employee:i,isEditMode:!!i})})]})},ym=({children:n,allowedRoles:e})=>{const{user:t,loading:s}=rs();if(s)return r.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading..."});if(!t)return r.jsx(pa,{to:"/login",replace:!0});if(!e.includes(t.role)){if(t.role==="admin")return r.jsx(pa,{to:"/admin",replace:!0});if(t.role==="hr")return r.jsx(pa,{to:"/hr",replace:!0});if(t.role==="employee")return r.jsx(pa,{to:"/employee",replace:!0})}return n},eR=({isOpen:n,onClose:e,onSave:t,existingData:s})=>{const[i,l]=E.useState({accountHolderName:"",accountNumber:"",bankName:"",ifscCode:"",accountType:"savings"});E.useEffect(()=>{s&&l(s)},[s]);const c=h=>{l({...i,[h.target.name]:h.target.value})},u=async h=>{h.preventDefault(),await t(i)};return n?r.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:s?"Update Bank Details":"Add Bank Details"}),r.jsxs("form",{onSubmit:u,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Account Holder Name"}),r.jsx("input",{type:"text",name:"accountHolderName",value:i.accountHolderName,onChange:c,required:!0,className:"w-full p-2 border rounded"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Account Number"}),r.jsx("input",{type:"text",name:"accountNumber",value:i.accountNumber,onChange:c,required:!0,className:"w-full p-2 border rounded"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bank Name"}),r.jsx("input",{type:"text",name:"bankName",value:i.bankName,onChange:c,required:!0,className:"w-full p-2 border rounded"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"IFSC Code"}),r.jsx("input",{type:"text",name:"ifscCode",value:i.ifscCode,onChange:c,required:!0,className:"w-full p-2 border rounded uppercase"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Account Type"}),r.jsxs("select",{name:"accountType",value:i.accountType,onChange:c,className:"w-full p-2 border rounded",children:[r.jsx("option",{value:"savings",children:"Savings"}),r.jsx("option",{value:"current",children:"Current"}),r.jsx("option",{value:"other",children:"Other"})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-3",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border rounded hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-4 py-2 bg-[#104774] text-white rounded hover:bg-[#0d3a5f]",children:s?"Update":"Save"})]})]})]})}):null},bm=()=>{const[n,e]=E.useState(null),[t,s]=E.useState(null),[i,l]=E.useState(!0),[c,u]=E.useState(!1),[h,m]=E.useState(!1);E.useEffect(()=>{p(),x()},[]);const p=async()=>{try{const j=await xe.get("/employee/profile");e(j.data.data)}catch(j){console.error("Error fetching employee profile:",j)}finally{l(!1)}},x=async()=>{try{const j=await xe.get("/employee/bank/me");s(j.data||null)}catch(j){console.error("Error fetching bank details:",j)}},y=async j=>{try{await xe.post("/employee/bank",j),alert(t?"Bank details updated!":"Bank details added!"),m(!1),x()}catch(_){console.error(_),alert(_.response?.data?.message||"Failed to save bank details")}},v=async j=>{const _=j.target.files[0];if(!_)return;if(!["image/jpeg","image/jpg","image/png","image/gif"].includes(_.type)){alert("Please select a valid image file (JPEG, PNG, GIF)");return}if(_.size>5*1024*1024){alert("Image size should be less than 5MB");return}u(!0);try{const k=new FormData;k.append("image",_);const D=await xe.patch("/employee/profile/image",k,{headers:{"Content-Type":"multipart/form-data"}});e(P=>({...P,avatarUrl:D.data.data.avatarUrl})),alert("Profile image updated successfully!")}catch(k){console.error(k),alert(k.response?.data?.message||"Failed to upload image")}finally{u(!1),j.target.value=""}},w=j=>j?`XXXX-XXXX-${j.slice(-4)}`:"N/A";function A(j){if(j===null||typeof j>"u"||j==="")return"";const _=I=>{if(!I&&I!==0)return null;if(I instanceof Date)return{hour:I.getHours(),minute:I.getMinutes()};if(typeof I=="object"){const K=Number(I.hour??I.h??I.H??I.hours??I.hours24),H=Number(I.minute??I.m??0);return Number.isNaN(K)?null:{hour:K,minute:H}}if(typeof I=="number"){const K=Math.floor(I),H=Math.round((I-K)*60);return{hour:K,minute:H}}if(typeof I=="string"){let K=I.trim();(K.startsWith('"')&&K.endsWith('"')||K.startsWith("'")&&K.endsWith("'"))&&(K=K.slice(1,-1).trim());const H=K.match(/\b(AM|PM)\b/i),X=!!H;X&&(K=K.replace(/\b(AM|PM)\b/i,"").trim());const W=K.split(":").map(L=>L.trim());let ce,me;if(W.length===1){const L=W[0];if(/^\d{3,4}$/.test(L)){const q=L.padStart(4,"0");ce=parseInt(q.slice(0,2),10),me=parseInt(q.slice(2),10)}else ce=parseInt(L,10),me=0}else ce=parseInt(W[0],10),me=parseInt(W[1],10)||0;if(Number.isNaN(ce))return null;if(X){const L=H[0].toUpperCase();L==="PM"&&ce!==12&&(ce+=12),L==="AM"&&ce===12&&(ce=0)}return{hour:ce,minute:me}}return null},C=({hour:I,minute:K})=>{if(I===null||typeof I>"u")return"";const H=I>=12?"PM":"AM",X=I%12===0?12:I%12,W=String(K??0).padStart(2,"0");return`${String(X).padStart(2,"0")}:${W} ${H}`},k=I=>{if(typeof I=="string"){const K=I.split(/–|—|-|\bto\b/i).map(H=>H.trim()).filter(Boolean);if(K.length>=2)return K.slice(0,2);try{const H=JSON.parse(I);if(Array.isArray(H))return H;if(H&&typeof H=="object")return[H.start??H.from??H.startTime,H.end??H.to??H.endTime]}catch{}return[I]}return Array.isArray(I)?I:typeof I=="object"?[I.start??I.from??I.startTime??I[0],I.end??I.to??I.endTime??I[1]]:[String(I)]},[D,P]=k(j),F=_(D),U=_(P);return F&&U?`${C(F)} – ${C(U)}`:F?C(F):typeof j=="string"?j:Array.isArray(j)?j.join(" – "):typeof j=="object"?`${D??""}${P?" – "+P:""}`:String(j)}const N=j=>j?new Date(j).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A";return i?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#104774]"})}):n?r.jsxs("div",{className:"max-w-6xl mx-auto min-h-[75vh]",children:[r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-2",children:r.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6",children:[r.jsxs("div",{className:"flex-shrink-0 relative",children:[r.jsxs("div",{className:"w-32 h-32 rounded-full bg-gray-100 flex items-center justify-center border-2 border-gray-200 relative group",children:[n.avatarUrl?r.jsx("img",{src:n.avatarUrl,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):r.jsxs("span",{className:"text-4xl text-gray-600 font-semibold",children:[n.firstName?.charAt(0),n.lastName?.charAt(0)]}),r.jsxs("label",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",children:[c?r.jsx(PC,{className:"w-6 h-6 text-white animate-spin"}):r.jsx(hC,{className:"w-6 h-6 text-white"}),r.jsx("input",{type:"file",accept:"image/*",onChange:v,className:"hidden",disabled:c})]})]}),r.jsxs("div",{className:"text-center mt-3",children:[r.jsxs("label",{className:"text-sm text-[#104774] cursor-pointer hover:underline",children:["Change Photo",r.jsx("input",{type:"file",accept:"image/*",onChange:v,className:"hidden",disabled:c})]}),c&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Uploading..."})]})]}),r.jsxs("div",{className:"flex-1 text-center md:text-left",children:[r.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:[n.firstName," ",n.lastName]}),r.jsx("p",{className:"text-xl text-[#104774] font-semibold mb-3",children:n.designation||"Software Developer"}),r.jsxs("div",{className:"space-y-1 text-gray-600",children:[r.jsxs("p",{children:["Employee ID:"," ",r.jsx("span",{className:"font-medium text-gray-800",children:n.employeeId})]}),r.jsxs("p",{children:["Date of Joining:"," ",r.jsx("span",{className:"font-medium text-gray-800",children:N(n.dateOfJoining)})]})]})]}),r.jsx("div",{className:"flex-shrink-0",children:r.jsx("span",{className:`px-4 py-2 rounded-md text-sm font-semibold ${n.user?.isActive?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:n.user?.isActive?"Active":"Inactive"})})]})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-100",children:"Personal Information"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Phone:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium",children:n.phone||"+91 12347 65890"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Email:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium break-all",children:n.user?.email||"anthony@gmail.com"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Date of Birth:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium",children:N(n.dob)||"28 December 1992"})]}),r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Address:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium",children:n.address||"Dehradun, Uttarakhand"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Gender:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium capitalize",children:n.gender||"Male"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-100",children:"Job Details"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Designation:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium",children:n.designation||"Software Developer"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Department:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium",children:n.department||"IT & Development"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Employment Type:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium capitalize",children:n.employmentType?n.employmentType.replace("-"," "):"Full Time"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Shift Timing:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium",children:A(n.shiftTiming)||"10:00 AM – 07:00 PM"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Work Mode:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium capitalize",children:n.workMode?n.workMode.replace(/-/g," "):"Work From Home"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-2 ",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 h-60 overflow-y-scroll ",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4 border-b border-gray-100 pb-3",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Bank Details"}),r.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-[#104774] text-white text-sm rounded hover:bg-[#0d3a5f]",children:[t?r.jsx(Xm,{size:16}):r.jsx(Bi,{size:16}),t?"Edit":"Add"]})]}),t?r.jsxs("div",{className:"space-y-3 text-gray-700",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Account Holder:"})," ",t.accountHolderName]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Account Number:"})," ",w(t.accountNumber)]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Bank Name:"})," ",t.bankName]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"IFSC:"})," ",t.ifscCode]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Account Type:"})," ",t.accountType]})]}):r.jsx("div",{className:"text-center py-4 text-gray-500",children:"No bank details added yet."})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 h-60 overflow-y-scroll",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-100",children:"Documents"}),n.documents&&n.documents.length>0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-1 gap-4",children:n.documents.map((j,_)=>r.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:border-gray-300 transition-colors",children:[r.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[r.jsx("div",{className:"w-10 h-10 bg-gray-50 border border-gray-200 rounded-lg flex items-center justify-center mr-3 flex-shrink-0",children:r.jsx("span",{className:"text-gray-500 text-sm",children:"📄"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:j.name}),r.jsxs("p",{className:"text-xs text-gray-500",children:["Uploaded:"," ",j.uploadedAt?N(j.uploadedAt):"N/A"]})]})]}),r.jsx("a",{href:j.url,target:"_blank",rel:"noopener noreferrer",className:"ml-3 text-[#104774] hover:text-[#0d3a5f] text-sm font-medium flex-shrink-0",children:"View"})]},_))}):r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-50 border border-gray-200 rounded-full flex items-center justify-center mx-auto mb-3",children:r.jsx("span",{className:"text-gray-400 text-2xl",children:"📂"})}),r.jsx("p",{className:"text-gray-500 font-medium",children:"No documents available"})]})]})]}),r.jsx(eR,{isOpen:h,onClose:()=>m(!1),onSave:y,existingData:t})]}):r.jsx("div",{className:"text-center py-8",children:r.jsx("p",{className:"text-red-500",children:"Employee profile not found"})})};var Eu,Me,G1,Y1,Jr,Di,lv,W1,X1,Xd={},Q1=[],tR=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Xa(n,e){for(var t in e)n[t]=e[t];return n}function Z1(n){var e=n.parentNode;e&&e.removeChild(n)}function re(n,e,t){var s,i,l,c={};for(l in e)l=="key"?s=e[l]:l=="ref"?i=e[l]:c[l]=e[l];if(arguments.length>2&&(c.children=arguments.length>3?Eu.call(arguments,2):t),typeof n=="function"&&n.defaultProps!=null)for(l in n.defaultProps)c[l]===void 0&&(c[l]=n.defaultProps[l]);return Od(n,c,s,i,null)}function Od(n,e,t,s,i){var l={type:n,props:e,key:t,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++G1};return i==null&&Me.vnode!=null&&Me.vnode(l),l}function ya(){return{current:null}}function It(n){return n.children}function sR(n,e,t,s,i){var l;for(l in t)l==="children"||l==="key"||l in e||Qd(n,l,null,t[l],s);for(l in e)i&&typeof e[l]!="function"||l==="children"||l==="key"||l==="value"||l==="checked"||t[l]===e[l]||Qd(n,l,e[l],t[l],s)}function ov(n,e,t){e[0]==="-"?n.setProperty(e,t??""):n[e]=t==null?"":typeof t!="number"||tR.test(e)?t:t+"px"}function Qd(n,e,t,s,i){var l;e:if(e==="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof s=="string"&&(n.style.cssText=s=""),s)for(e in s)t&&e in t||ov(n.style,e,"");if(t)for(e in t)s&&t[e]===s[e]||ov(n.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")l=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in n?e.toLowerCase().slice(2):e.slice(2),n.l||(n.l={}),n.l[e+l]=t,t?s||n.addEventListener(e,l?dv:cv,l):n.removeEventListener(e,l?dv:cv,l);else if(e!=="dangerouslySetInnerHTML"){if(i)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="width"&&e!=="height"&&e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in n)try{n[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e.indexOf("-")==-1?n.removeAttribute(e):n.setAttribute(e,t))}}function cv(n){Jr=!0;try{return this.l[n.type+!1](Me.event?Me.event(n):n)}finally{Jr=!1}}function dv(n){Jr=!0;try{return this.l[n.type+!0](Me.event?Me.event(n):n)}finally{Jr=!1}}function en(n,e){this.props=n,this.context=e}function ko(n,e){if(e==null)return n.__?ko(n.__,n.__.__k.indexOf(n)+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?ko(n):null}function K1(n){var e,t;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return K1(n)}}function nR(n){Jr?setTimeout(n):W1(n)}function rp(n){(!n.__d&&(n.__d=!0)&&Di.push(n)&&!Zd.__r++||lv!==Me.debounceRendering)&&((lv=Me.debounceRendering)||nR)(Zd)}function Zd(){var n,e,t,s,i,l,c,u;for(Di.sort(function(h,m){return h.__v.__b-m.__v.__b});n=Di.shift();)n.__d&&(e=Di.length,s=void 0,i=void 0,c=(l=(t=n).__v).__e,(u=t.__P)&&(s=[],(i=Xa({},l)).__v=l.__v+1,Kp(u,l,i,t.__n,u.ownerSVGElement!==void 0,l.__h!=null?[c]:null,s,c??ko(l),l.__h),nA(s,l),l.__e!=c&&K1(l)),Di.length>e&&Di.sort(function(h,m){return h.__v.__b-m.__v.__b}));Zd.__r=0}function J1(n,e,t,s,i,l,c,u,h,m){var p,x,y,v,w,A,N,j=s&&s.__k||Q1,_=j.length;for(t.__k=[],p=0;p<e.length;p++)if((v=t.__k[p]=(v=e[p])==null||typeof v=="boolean"?null:typeof v=="string"||typeof v=="number"||typeof v=="bigint"?Od(null,v,null,null,v):Array.isArray(v)?Od(It,{children:v},null,null,null):v.__b>0?Od(v.type,v.props,v.key,v.ref?v.ref:null,v.__v):v)!=null){if(v.__=t,v.__b=t.__b+1,(y=j[p])===null||y&&v.key==y.key&&v.type===y.type)j[p]=void 0;else for(x=0;x<_;x++){if((y=j[x])&&v.key==y.key&&v.type===y.type){j[x]=void 0;break}y=null}Kp(n,v,y=y||Xd,i,l,c,u,h,m),w=v.__e,(x=v.ref)&&y.ref!=x&&(N||(N=[]),y.ref&&N.push(y.ref,null,v),N.push(x,v.__c||w,v)),w!=null?(A==null&&(A=w),typeof v.type=="function"&&v.__k===y.__k?v.__d=h=eA(v,h,n):h=tA(n,v,y,j,w,h),typeof t.type=="function"&&(t.__d=h)):h&&y.__e==h&&h.parentNode!=n&&(h=ko(y))}for(t.__e=A,p=_;p--;)j[p]!=null&&(typeof t.type=="function"&&j[p].__e!=null&&j[p].__e==t.__d&&(t.__d=sA(s).nextSibling),iA(j[p],j[p]));if(N)for(p=0;p<N.length;p++)aA(N[p],N[++p],N[++p])}function eA(n,e,t){for(var s,i=n.__k,l=0;i&&l<i.length;l++)(s=i[l])&&(s.__=n,e=typeof s.type=="function"?eA(s,e,t):tA(t,s,s,i,s.__e,e));return e}function Kd(n,e){return e=e||[],n==null||typeof n=="boolean"||(Array.isArray(n)?n.some(function(t){Kd(t,e)}):e.push(n)),e}function tA(n,e,t,s,i,l){var c,u,h;if(e.__d!==void 0)c=e.__d,e.__d=void 0;else if(t==null||i!=l||i.parentNode==null)e:if(l==null||l.parentNode!==n)n.appendChild(i),c=null;else{for(u=l,h=0;(u=u.nextSibling)&&h<s.length;h+=1)if(u==i)break e;n.insertBefore(i,l),c=l}return c!==void 0?c:i.nextSibling}function sA(n){var e,t,s;if(n.type==null||typeof n.type=="string")return n.__e;if(n.__k){for(e=n.__k.length-1;e>=0;e--)if((t=n.__k[e])&&(s=sA(t)))return s}return null}function Kp(n,e,t,s,i,l,c,u,h){var m,p,x,y,v,w,A,N,j,_,C,k,D,P,F,U=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(h=t.__h,u=e.__e=t.__e,e.__h=null,l=[u]),(m=Me.__b)&&m(e);try{e:if(typeof U=="function"){if(N=e.props,j=(m=U.contextType)&&s[m.__c],_=m?j?j.props.value:m.__:s,t.__c?A=(p=e.__c=t.__c).__=p.__E:("prototype"in U&&U.prototype.render?e.__c=p=new U(N,_):(e.__c=p=new en(N,_),p.constructor=U,p.render=iR),j&&j.sub(p),p.props=N,p.state||(p.state={}),p.context=_,p.__n=s,x=p.__d=!0,p.__h=[],p._sb=[]),p.__s==null&&(p.__s=p.state),U.getDerivedStateFromProps!=null&&(p.__s==p.state&&(p.__s=Xa({},p.__s)),Xa(p.__s,U.getDerivedStateFromProps(N,p.__s))),y=p.props,v=p.state,p.__v=e,x)U.getDerivedStateFromProps==null&&p.componentWillMount!=null&&p.componentWillMount(),p.componentDidMount!=null&&p.__h.push(p.componentDidMount);else{if(U.getDerivedStateFromProps==null&&N!==y&&p.componentWillReceiveProps!=null&&p.componentWillReceiveProps(N,_),!p.__e&&p.shouldComponentUpdate!=null&&p.shouldComponentUpdate(N,p.__s,_)===!1||e.__v===t.__v){for(e.__v!==t.__v&&(p.props=N,p.state=p.__s,p.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(I){I&&(I.__=e)}),C=0;C<p._sb.length;C++)p.__h.push(p._sb[C]);p._sb=[],p.__h.length&&c.push(p);break e}p.componentWillUpdate!=null&&p.componentWillUpdate(N,p.__s,_),p.componentDidUpdate!=null&&p.__h.push(function(){p.componentDidUpdate(y,v,w)})}if(p.context=_,p.props=N,p.__P=n,k=Me.__r,D=0,"prototype"in U&&U.prototype.render){for(p.state=p.__s,p.__d=!1,k&&k(e),m=p.render(p.props,p.state,p.context),P=0;P<p._sb.length;P++)p.__h.push(p._sb[P]);p._sb=[]}else do p.__d=!1,k&&k(e),m=p.render(p.props,p.state,p.context),p.state=p.__s;while(p.__d&&++D<25);p.state=p.__s,p.getChildContext!=null&&(s=Xa(Xa({},s),p.getChildContext())),x||p.getSnapshotBeforeUpdate==null||(w=p.getSnapshotBeforeUpdate(y,v)),F=m!=null&&m.type===It&&m.key==null?m.props.children:m,J1(n,Array.isArray(F)?F:[F],e,t,s,i,l,c,u,h),p.base=e.__e,e.__h=null,p.__h.length&&c.push(p),A&&(p.__E=p.__=null),p.__e=!1}else l==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=aR(t.__e,e,t,s,i,l,c,h);(m=Me.diffed)&&m(e)}catch(I){e.__v=null,(h||l!=null)&&(e.__e=u,e.__h=!!h,l[l.indexOf(u)]=null),Me.__e(I,e,t)}}function nA(n,e){Me.__c&&Me.__c(e,n),n.some(function(t){try{n=t.__h,t.__h=[],n.some(function(s){s.call(t)})}catch(s){Me.__e(s,t.__v)}})}function aR(n,e,t,s,i,l,c,u){var h,m,p,x=t.props,y=e.props,v=e.type,w=0;if(v==="svg"&&(i=!0),l!=null){for(;w<l.length;w++)if((h=l[w])&&"setAttribute"in h==!!v&&(v?h.localName===v:h.nodeType===3)){n=h,l[w]=null;break}}if(n==null){if(v===null)return document.createTextNode(y);n=i?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,y.is&&y),l=null,u=!1}if(v===null)x===y||u&&n.data===y||(n.data=y);else{if(l=l&&Eu.call(n.childNodes),m=(x=t.props||Xd).dangerouslySetInnerHTML,p=y.dangerouslySetInnerHTML,!u){if(l!=null)for(x={},w=0;w<n.attributes.length;w++)x[n.attributes[w].name]=n.attributes[w].value;(p||m)&&(p&&(m&&p.__html==m.__html||p.__html===n.innerHTML)||(n.innerHTML=p&&p.__html||""))}if(sR(n,y,x,i,u),p)e.__k=[];else if(w=e.props.children,J1(n,Array.isArray(w)?w:[w],e,t,s,i&&v!=="foreignObject",l,c,l?l[0]:t.__k&&ko(t,0),u),l!=null)for(w=l.length;w--;)l[w]!=null&&Z1(l[w]);u||("value"in y&&(w=y.value)!==void 0&&(w!==n.value||v==="progress"&&!w||v==="option"&&w!==x.value)&&Qd(n,"value",w,x.value,!1),"checked"in y&&(w=y.checked)!==void 0&&w!==n.checked&&Qd(n,"checked",w,x.checked,!1))}return n}function aA(n,e,t){try{typeof n=="function"?n(e):n.current=e}catch(s){Me.__e(s,t)}}function iA(n,e,t){var s,i;if(Me.unmount&&Me.unmount(n),(s=n.ref)&&(s.current&&s.current!==n.__e||aA(s,null,e)),(s=n.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(l){Me.__e(l,e)}s.base=s.__P=null,n.__c=void 0}if(s=n.__k)for(i=0;i<s.length;i++)s[i]&&iA(s[i],e,t||typeof n.type!="function");t||n.__e==null||Z1(n.__e),n.__=n.__e=n.__d=void 0}function iR(n,e,t){return this.constructor(n,t)}function Mo(n,e,t){var s,i,l;Me.__&&Me.__(n,e),i=(s=!1)?null:e.__k,l=[],Kp(e,n=e.__k=re(It,null,[n]),i||Xd,Xd,e.ownerSVGElement!==void 0,i?null:e.firstChild?Eu.call(e.childNodes):null,l,i?i.__e:e.firstChild,s),nA(l,n)}function rR(n,e){var t={__c:e="__cC"+X1++,__:n,Consumer:function(s,i){return s.children(i)},Provider:function(s){var i,l;return this.getChildContext||(i=[],(l={})[e]=this,this.getChildContext=function(){return l},this.shouldComponentUpdate=function(c){this.props.value!==c.value&&i.some(function(u){u.__e=!0,rp(u)})},this.sub=function(c){i.push(c);var u=c.componentWillUnmount;c.componentWillUnmount=function(){i.splice(i.indexOf(c),1),u&&u.call(c)}}),s.children}};return t.Provider.__=t.Consumer.contextType=t}Eu=Q1.slice,Me={__e:function(n,e,t,s){for(var i,l,c;e=e.__;)if((i=e.__c)&&!i.__)try{if((l=i.constructor)&&l.getDerivedStateFromError!=null&&(i.setState(l.getDerivedStateFromError(n)),c=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(n,s||{}),c=i.__d),c)return i.__E=i}catch(u){n=u}throw n}},G1=0,Y1=function(n){return n!=null&&n.constructor===void 0},Jr=!1,en.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Xa({},this.state),typeof n=="function"&&(n=n(Xa({},t),this.props)),n&&Xa(t,n),n!=null&&this.__v&&(e&&this._sb.push(e),rp(this))},en.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),rp(this))},en.prototype.render=It,Di=[],W1=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Zd.__r=0,X1=0;var Gn,vm,uv,rA=[],wm=[],hv=Me.__b,fv=Me.__r,mv=Me.diffed,pv=Me.__c,gv=Me.unmount;function lR(){for(var n;n=rA.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(Pd),n.__H.__h.forEach(lp),n.__H.__h=[]}catch(e){n.__H.__h=[],Me.__e(e,n.__v)}}Me.__b=function(n){Gn=null,hv&&hv(n)},Me.__r=function(n){fv&&fv(n);var e=(Gn=n.__c).__H;e&&(vm===Gn?(e.__h=[],Gn.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=wm,t.__N=t.i=void 0})):(e.__h.forEach(Pd),e.__h.forEach(lp),e.__h=[])),vm=Gn},Me.diffed=function(n){mv&&mv(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(rA.push(e)!==1&&uv===Me.requestAnimationFrame||((uv=Me.requestAnimationFrame)||oR)(lR)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==wm&&(t.__=t.__V),t.i=void 0,t.__V=wm})),vm=Gn=null},Me.__c=function(n,e){e.some(function(t){try{t.__h.forEach(Pd),t.__h=t.__h.filter(function(s){return!s.__||lp(s)})}catch(s){e.some(function(i){i.__h&&(i.__h=[])}),e=[],Me.__e(s,t.__v)}}),pv&&pv(n,e)},Me.unmount=function(n){gv&&gv(n);var e,t=n.__c;t&&t.__H&&(t.__H.__.forEach(function(s){try{Pd(s)}catch(i){e=i}}),t.__H=void 0,e&&Me.__e(e,t.__v))};var xv=typeof requestAnimationFrame=="function";function oR(n){var e,t=function(){clearTimeout(s),xv&&cancelAnimationFrame(e),setTimeout(n)},s=setTimeout(t,100);xv&&(e=requestAnimationFrame(t))}function Pd(n){var e=Gn,t=n.__c;typeof t=="function"&&(n.__c=void 0,t()),Gn=e}function lp(n){var e=Gn;n.__c=n.__(),Gn=e}function cR(n,e){for(var t in e)n[t]=e[t];return n}function yv(n,e){for(var t in n)if(t!=="__source"&&!(t in e))return!0;for(var s in e)if(s!=="__source"&&n[s]!==e[s])return!0;return!1}function bv(n){this.props=n}(bv.prototype=new en).isPureReactComponent=!0,bv.prototype.shouldComponentUpdate=function(n,e){return yv(this.props,n)||yv(this.state,e)};var vv=Me.__b;Me.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),vv&&vv(n)};var dR=Me.__e;Me.__e=function(n,e,t,s){if(n.then){for(var i,l=e;l=l.__;)if((i=l.__c)&&i.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),i.__c(n,e)}dR(n,e,t,s)};var wv=Me.unmount;function lA(n,e,t){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(s){typeof s.__c=="function"&&s.__c()}),n.__c.__H=null),(n=cR({},n)).__c!=null&&(n.__c.__P===t&&(n.__c.__P=e),n.__c=null),n.__k=n.__k&&n.__k.map(function(s){return lA(s,e,t)})),n}function oA(n,e,t){return n&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(s){return oA(s,e,t)}),n.__c&&n.__c.__P===e&&(n.__e&&t.insertBefore(n.__e,n.__d),n.__c.__e=!0,n.__c.__P=t)),n}function Am(){this.__u=0,this.t=null,this.__b=null}function cA(n){var e=n.__.__c;return e&&e.__a&&e.__a(n)}function bd(){this.u=null,this.o=null}Me.unmount=function(n){var e=n.__c;e&&e.__R&&e.__R(),e&&n.__h===!0&&(n.type=null),wv&&wv(n)},(Am.prototype=new en).__c=function(n,e){var t=e.__c,s=this;s.t==null&&(s.t=[]),s.t.push(t);var i=cA(s.__v),l=!1,c=function(){l||(l=!0,t.__R=null,i?i(u):u())};t.__R=c;var u=function(){if(!--s.__u){if(s.state.__a){var m=s.state.__a;s.__v.__k[0]=oA(m,m.__c.__P,m.__c.__O)}var p;for(s.setState({__a:s.__b=null});p=s.t.pop();)p.forceUpdate()}},h=e.__h===!0;s.__u++||h||s.setState({__a:s.__b=s.__v.__k[0]}),n.then(c,c)},Am.prototype.componentWillUnmount=function(){this.t=[]},Am.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),s=this.__v.__k[0].__c;this.__v.__k[0]=lA(this.__b,t,s.__O=s.__P)}this.__b=null}var i=e.__a&&re(It,null,n.fallback);return i&&(i.__h=null),[re(It,null,e.__a?null:n.children),i]};var Av=function(n,e,t){if(++t[1]===t[0]&&n.o.delete(e),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.o.size))for(t=n.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;n.u=t=t[2]}};function uR(n){return this.getChildContext=function(){return n.context},n.children}function hR(n){var e=this,t=n.i;e.componentWillUnmount=function(){Mo(null,e.l),e.l=null,e.i=null},e.i&&e.i!==t&&e.componentWillUnmount(),n.__v?(e.l||(e.i=t,e.l={nodeType:1,parentNode:t,childNodes:[],appendChild:function(s){this.childNodes.push(s),e.i.appendChild(s)},insertBefore:function(s,i){this.childNodes.push(s),e.i.appendChild(s)},removeChild:function(s){this.childNodes.splice(this.childNodes.indexOf(s)>>>1,1),e.i.removeChild(s)}}),Mo(re(uR,{context:e.context},n.__v),e.l)):e.l&&e.componentWillUnmount()}function fR(n,e){var t=re(hR,{__v:n,i:e});return t.containerInfo=e,t}(bd.prototype=new en).__a=function(n){var e=this,t=cA(e.__v),s=e.o.get(n);return s[0]++,function(i){var l=function(){e.props.revealOrder?(s.push(i),Av(e,n,s)):i()};t?t(l):l()}},bd.prototype.render=function(n){this.u=null,this.o=new Map;var e=Kd(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return n.children},bd.prototype.componentDidUpdate=bd.prototype.componentDidMount=function(){var n=this;this.o.forEach(function(e,t){Av(n,t,e)})};var mR=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,pR=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,gR=typeof document<"u",xR=function(n){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(n)};en.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(n){Object.defineProperty(en.prototype,n,{configurable:!0,get:function(){return this["UNSAFE_"+n]},set:function(e){Object.defineProperty(this,n,{configurable:!0,writable:!0,value:e})}})});var Nv=Me.event;function yR(){}function bR(){return this.cancelBubble}function vR(){return this.defaultPrevented}Me.event=function(n){return Nv&&(n=Nv(n)),n.persist=yR,n.isPropagationStopped=bR,n.isDefaultPrevented=vR,n.nativeEvent=n};var jv={configurable:!0,get:function(){return this.class}},Sv=Me.vnode;Me.vnode=function(n){var e=n.type,t=n.props,s=t;if(typeof e=="string"){var i=e.indexOf("-")===-1;for(var l in s={},t){var c=t[l];gR&&l==="children"&&e==="noscript"||l==="value"&&"defaultValue"in t&&c==null||(l==="defaultValue"&&"value"in t&&t.value==null?l="value":l==="download"&&c===!0?c="":/ondoubleclick/i.test(l)?l="ondblclick":/^onchange(textarea|input)/i.test(l+e)&&!xR(t.type)?l="oninput":/^onfocus$/i.test(l)?l="onfocusin":/^onblur$/i.test(l)?l="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(l)?l=l.toLowerCase():i&&pR.test(l)?l=l.replace(/[A-Z0-9]/g,"-$&").toLowerCase():c===null&&(c=void 0),/^oninput$/i.test(l)&&(l=l.toLowerCase(),s[l]&&(l="oninputCapture")),s[l]=c)}e=="select"&&s.multiple&&Array.isArray(s.value)&&(s.value=Kd(t.children).forEach(function(u){u.props.selected=s.value.indexOf(u.props.value)!=-1})),e=="select"&&s.defaultValue!=null&&(s.value=Kd(t.children).forEach(function(u){u.props.selected=s.multiple?s.defaultValue.indexOf(u.props.value)!=-1:s.defaultValue==u.props.value})),n.props=s,t.class!=t.className&&(jv.enumerable="className"in t,t.className!=null&&(s.class=t.className),Object.defineProperty(s,"className",jv))}n.$$typeof=mR,Sv&&Sv(n)};var Ev=Me.__r;Me.__r=function(n){Ev&&Ev(n),n.__c};const dA=[],op=new Map;function uA(n){dA.push(n),op.forEach(e=>{fA(e,n)})}function wR(n){n.isConnected&&n.getRootNode&&hA(n.getRootNode())}function hA(n){let e=op.get(n);if(!e||!e.isConnected){if(e=n.querySelector("style[data-fullcalendar]"),!e){e=document.createElement("style"),e.setAttribute("data-fullcalendar","");const t=NR();t&&(e.nonce=t);const s=n===document?document.head:n,i=n===document?s.querySelector("script,link[rel=stylesheet],link[as=style],style"):s.firstChild;s.insertBefore(e,i)}op.set(n,e),AR(e)}}function AR(n){for(const e of dA)fA(n,e)}function fA(n,e){const{sheet:t}=n,s=t.cssRules.length;e.split("}").forEach((i,l)=>{i=i.trim(),i&&t.insertRule(i+"}",s+l)})}let Nm;function NR(){return Nm===void 0&&(Nm=jR()),Nm}function jR(){const n=document.querySelector('meta[name="csp-nonce"]');if(n&&n.hasAttribute("content"))return n.getAttribute("content");const e=document.querySelector("script[nonce]");return e&&e.nonce||""}typeof document<"u"&&hA(document);var SR=':root{--fc-small-font-size:.85em;--fc-page-bg-color:#fff;--fc-neutral-bg-color:hsla(0,0%,82%,.3);--fc-neutral-text-color:grey;--fc-border-color:#ddd;--fc-button-text-color:#fff;--fc-button-bg-color:#2c3e50;--fc-button-border-color:#2c3e50;--fc-button-hover-bg-color:#1e2b37;--fc-button-hover-border-color:#1a252f;--fc-button-active-bg-color:#1a252f;--fc-button-active-border-color:#151e27;--fc-event-bg-color:#3788d8;--fc-event-border-color:#3788d8;--fc-event-text-color:#fff;--fc-event-selected-overlay-color:rgba(0,0,0,.25);--fc-more-link-bg-color:#d0d0d0;--fc-more-link-text-color:inherit;--fc-event-resizer-thickness:8px;--fc-event-resizer-dot-total-width:8px;--fc-event-resizer-dot-border-width:1px;--fc-non-business-color:hsla(0,0%,84%,.3);--fc-bg-event-color:#8fdf82;--fc-bg-event-opacity:0.3;--fc-highlight-color:rgba(188,232,241,.3);--fc-today-bg-color:rgba(255,220,40,.15);--fc-now-indicator-color:red}.fc-not-allowed,.fc-not-allowed .fc-event{cursor:not-allowed}.fc{display:flex;flex-direction:column;font-size:1em}.fc,.fc *,.fc :after,.fc :before{box-sizing:border-box}.fc table{border-collapse:collapse;border-spacing:0;font-size:1em}.fc th{text-align:center}.fc td,.fc th{padding:0;vertical-align:top}.fc a[data-navlink]{cursor:pointer}.fc a[data-navlink]:hover{text-decoration:underline}.fc-direction-ltr{direction:ltr;text-align:left}.fc-direction-rtl{direction:rtl;text-align:right}.fc-theme-standard td,.fc-theme-standard th{border:1px solid var(--fc-border-color)}.fc-liquid-hack td,.fc-liquid-hack th{position:relative}@font-face{font-family:fcicons;font-style:normal;font-weight:400;src:url("data:application/x-font-ttf;charset=utf-8;base64,AAEAAAALAIAAAwAwT1MvMg8SBfAAAAC8AAAAYGNtYXAXVtKNAAABHAAAAFRnYXNwAAAAEAAAAXAAAAAIZ2x5ZgYydxIAAAF4AAAFNGhlYWQUJ7cIAAAGrAAAADZoaGVhB20DzAAABuQAAAAkaG10eCIABhQAAAcIAAAALGxvY2ED4AU6AAAHNAAAABhtYXhwAA8AjAAAB0wAAAAgbmFtZXsr690AAAdsAAABhnBvc3QAAwAAAAAI9AAAACAAAwPAAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADpBgPA/8AAQAPAAEAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAOAAAAAoACAACAAIAAQAg6Qb//f//AAAAAAAg6QD//f//AAH/4xcEAAMAAQAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAABAWIAjQKeAskAEwAAJSc3NjQnJiIHAQYUFwEWMjc2NCcCnuLiDQ0MJAz/AA0NAQAMJAwNDcni4gwjDQwM/wANIwz/AA0NDCMNAAAAAQFiAI0CngLJABMAACUBNjQnASYiBwYUHwEHBhQXFjI3AZ4BAA0N/wAMJAwNDeLiDQ0MJAyNAQAMIw0BAAwMDSMM4uINIwwNDQAAAAIA4gC3Ax4CngATACcAACUnNzY0JyYiDwEGFB8BFjI3NjQnISc3NjQnJiIPAQYUHwEWMjc2NCcB87e3DQ0MIw3VDQ3VDSMMDQ0BK7e3DQ0MJAzVDQ3VDCQMDQ3zuLcMJAwNDdUNIwzWDAwNIwy4twwkDA0N1Q0jDNYMDA0jDAAAAgDiALcDHgKeABMAJwAAJTc2NC8BJiIHBhQfAQcGFBcWMjchNzY0LwEmIgcGFB8BBwYUFxYyNwJJ1Q0N1Q0jDA0Nt7cNDQwjDf7V1Q0N1QwkDA0Nt7cNDQwkDLfWDCMN1Q0NDCQMt7gMIw0MDNYMIw3VDQ0MJAy3uAwjDQwMAAADAFUAAAOrA1UAMwBoAHcAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMhMjY1NCYjISIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAAVYRGRkR/qoRGRkRA1UFBAUOCQkVDAsZDf2rDRkLDBUJCA4FBQUFBQUOCQgVDAsZDQJVDRkLDBUJCQ4FBAVVAgECBQMCBwQECAX9qwQJAwQHAwMFAQICAgIBBQMDBwQDCQQCVQUIBAQHAgMFAgEC/oAZEhEZGRESGQAAAAADAFUAAAOrA1UAMwBoAIkAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMzFRQWMzI2PQEzMjY1NCYrATU0JiMiBh0BIyIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAgBkSEhmAERkZEYAZEhIZgBEZGREDVQUEBQ4JCRUMCxkN/asNGQsMFQkIDgUFBQUFBQ4JCBUMCxkNAlUNGQsMFQkJDgUEBVUCAQIFAwIHBAQIBf2rBAkDBAcDAwUBAgICAgEFAwMHBAMJBAJVBQgEBAcCAwUCAQL+gIASGRkSgBkSERmAEhkZEoAZERIZAAABAOIAjQMeAskAIAAAExcHBhQXFjI/ARcWMjc2NC8BNzY0JyYiDwEnJiIHBhQX4uLiDQ0MJAzi4gwkDA0N4uINDQwkDOLiDCQMDQ0CjeLiDSMMDQ3h4Q0NDCMN4uIMIw0MDOLiDAwNIwwAAAABAAAAAQAAa5n0y18PPPUACwQAAAAAANivOVsAAAAA2K85WwAAAAADqwNVAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAOrAAEAAAAAAAAAAAAAAAAAAAALBAAAAAAAAAAAAAAAAgAAAAQAAWIEAAFiBAAA4gQAAOIEAABVBAAAVQQAAOIAAAAAAAoAFAAeAEQAagCqAOoBngJkApoAAQAAAAsAigADAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAcAAAABAAAAAAACAAcAYAABAAAAAAADAAcANgABAAAAAAAEAAcAdQABAAAAAAAFAAsAFQABAAAAAAAGAAcASwABAAAAAAAKABoAigADAAEECQABAA4ABwADAAEECQACAA4AZwADAAEECQADAA4APQADAAEECQAEAA4AfAADAAEECQAFABYAIAADAAEECQAGAA4AUgADAAEECQAKADQApGZjaWNvbnMAZgBjAGkAYwBvAG4Ac1ZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMGZjaWNvbnMAZgBjAGkAYwBvAG4Ac2ZjaWNvbnMAZgBjAGkAYwBvAG4Ac1JlZ3VsYXIAUgBlAGcAdQBsAGEAcmZjaWNvbnMAZgBjAGkAYwBvAG4Ac0ZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=") format("truetype")}.fc-icon{speak:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:inline-block;font-family:fcicons!important;font-style:normal;font-variant:normal;font-weight:400;height:1em;line-height:1;text-align:center;text-transform:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:1em}.fc-icon-chevron-left:before{content:"\\e900"}.fc-icon-chevron-right:before{content:"\\e901"}.fc-icon-chevrons-left:before{content:"\\e902"}.fc-icon-chevrons-right:before{content:"\\e903"}.fc-icon-minus-square:before{content:"\\e904"}.fc-icon-plus-square:before{content:"\\e905"}.fc-icon-x:before{content:"\\e906"}.fc .fc-button{border-radius:0;font-family:inherit;font-size:inherit;line-height:inherit;margin:0;overflow:visible;text-transform:none}.fc .fc-button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}.fc .fc-button{-webkit-appearance:button}.fc .fc-button:not(:disabled){cursor:pointer}.fc .fc-button{background-color:transparent;border:1px solid transparent;border-radius:.25em;display:inline-block;font-size:1em;font-weight:400;line-height:1.5;padding:.4em .65em;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle}.fc .fc-button:hover{text-decoration:none}.fc .fc-button:focus{box-shadow:0 0 0 .2rem rgba(44,62,80,.25);outline:0}.fc .fc-button:disabled{opacity:.65}.fc .fc-button-primary{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:hover{background-color:var(--fc-button-hover-bg-color);border-color:var(--fc-button-hover-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:disabled{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button-primary:not(:disabled).fc-button-active,.fc .fc-button-primary:not(:disabled):active{background-color:var(--fc-button-active-bg-color);border-color:var(--fc-button-active-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:not(:disabled).fc-button-active:focus,.fc .fc-button-primary:not(:disabled):active:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button .fc-icon{font-size:1.5em;vertical-align:middle}.fc .fc-button-group{display:inline-flex;position:relative;vertical-align:middle}.fc .fc-button-group>.fc-button{flex:1 1 auto;position:relative}.fc .fc-button-group>.fc-button.fc-button-active,.fc .fc-button-group>.fc-button:active,.fc .fc-button-group>.fc-button:focus,.fc .fc-button-group>.fc-button:hover{z-index:1}.fc-direction-ltr .fc-button-group>.fc-button:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0;margin-left:-1px}.fc-direction-ltr .fc-button-group>.fc-button:not(:last-child){border-bottom-right-radius:0;border-top-right-radius:0}.fc-direction-rtl .fc-button-group>.fc-button:not(:first-child){border-bottom-right-radius:0;border-top-right-radius:0;margin-right:-1px}.fc-direction-rtl .fc-button-group>.fc-button:not(:last-child){border-bottom-left-radius:0;border-top-left-radius:0}.fc .fc-toolbar{align-items:center;display:flex;justify-content:space-between}.fc .fc-toolbar.fc-header-toolbar{margin-bottom:1.5em}.fc .fc-toolbar.fc-footer-toolbar{margin-top:1.5em}.fc .fc-toolbar-title{font-size:1.75em;margin:0}.fc-direction-ltr .fc-toolbar>*>:not(:first-child){margin-left:.75em}.fc-direction-rtl .fc-toolbar>*>:not(:first-child){margin-right:.75em}.fc-direction-rtl .fc-toolbar-ltr{flex-direction:row-reverse}.fc .fc-scroller{-webkit-overflow-scrolling:touch;position:relative}.fc .fc-scroller-liquid{height:100%}.fc .fc-scroller-liquid-absolute{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-scroller-harness{direction:ltr;overflow:hidden;position:relative}.fc .fc-scroller-harness-liquid{height:100%}.fc-direction-rtl .fc-scroller-harness>.fc-scroller{direction:rtl}.fc-theme-standard .fc-scrollgrid{border:1px solid var(--fc-border-color)}.fc .fc-scrollgrid,.fc .fc-scrollgrid table{table-layout:fixed;width:100%}.fc .fc-scrollgrid table{border-left-style:hidden;border-right-style:hidden;border-top-style:hidden}.fc .fc-scrollgrid{border-bottom-width:0;border-collapse:separate;border-right-width:0}.fc .fc-scrollgrid-liquid{height:100%}.fc .fc-scrollgrid-section,.fc .fc-scrollgrid-section table,.fc .fc-scrollgrid-section>td{height:1px}.fc .fc-scrollgrid-section-liquid>td{height:100%}.fc .fc-scrollgrid-section>*{border-left-width:0;border-top-width:0}.fc .fc-scrollgrid-section-footer>*,.fc .fc-scrollgrid-section-header>*{border-bottom-width:0}.fc .fc-scrollgrid-section-body table,.fc .fc-scrollgrid-section-footer table{border-bottom-style:hidden}.fc .fc-scrollgrid-section-sticky>*{background:var(--fc-page-bg-color);position:sticky;z-index:3}.fc .fc-scrollgrid-section-header.fc-scrollgrid-section-sticky>*{top:0}.fc .fc-scrollgrid-section-footer.fc-scrollgrid-section-sticky>*{bottom:0}.fc .fc-scrollgrid-sticky-shim{height:1px;margin-bottom:-1px}.fc-sticky{position:sticky}.fc .fc-view-harness{flex-grow:1;position:relative}.fc .fc-view-harness-active>.fc-view{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-col-header-cell-cushion{display:inline-block;padding:2px 4px}.fc .fc-bg-event,.fc .fc-highlight,.fc .fc-non-business{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-non-business{background:var(--fc-non-business-color)}.fc .fc-bg-event{background:var(--fc-bg-event-color);opacity:var(--fc-bg-event-opacity)}.fc .fc-bg-event .fc-event-title{font-size:var(--fc-small-font-size);font-style:italic;margin:.5em}.fc .fc-highlight{background:var(--fc-highlight-color)}.fc .fc-cell-shaded,.fc .fc-day-disabled{background:var(--fc-neutral-bg-color)}a.fc-event,a.fc-event:hover{text-decoration:none}.fc-event.fc-event-draggable,.fc-event[href]{cursor:pointer}.fc-event .fc-event-main{position:relative;z-index:2}.fc-event-dragging:not(.fc-event-selected){opacity:.75}.fc-event-dragging.fc-event-selected{box-shadow:0 2px 7px rgba(0,0,0,.3)}.fc-event .fc-event-resizer{display:none;position:absolute;z-index:4}.fc-event-selected .fc-event-resizer,.fc-event:hover .fc-event-resizer{display:block}.fc-event-selected .fc-event-resizer{background:var(--fc-page-bg-color);border-color:inherit;border-radius:calc(var(--fc-event-resizer-dot-total-width)/2);border-style:solid;border-width:var(--fc-event-resizer-dot-border-width);height:var(--fc-event-resizer-dot-total-width);width:var(--fc-event-resizer-dot-total-width)}.fc-event-selected .fc-event-resizer:before{bottom:-20px;content:"";left:-20px;position:absolute;right:-20px;top:-20px}.fc-event-selected,.fc-event:focus{box-shadow:0 2px 5px rgba(0,0,0,.2)}.fc-event-selected:before,.fc-event:focus:before{bottom:0;content:"";left:0;position:absolute;right:0;top:0;z-index:3}.fc-event-selected:after,.fc-event:focus:after{background:var(--fc-event-selected-overlay-color);bottom:-1px;content:"";left:-1px;position:absolute;right:-1px;top:-1px;z-index:1}.fc-h-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-h-event .fc-event-main{color:var(--fc-event-text-color)}.fc-h-event .fc-event-main-frame{display:flex}.fc-h-event .fc-event-time{max-width:100%;overflow:hidden}.fc-h-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-width:0}.fc-h-event .fc-event-title{display:inline-block;left:0;max-width:100%;overflow:hidden;right:0;vertical-align:top}.fc-h-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-start),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-end){border-bottom-left-radius:0;border-left-width:0;border-top-left-radius:0}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-end),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-start){border-bottom-right-radius:0;border-right-width:0;border-top-right-radius:0}.fc-h-event:not(.fc-event-selected) .fc-event-resizer{bottom:0;top:0;width:var(--fc-event-resizer-thickness)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end{cursor:w-resize;left:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start{cursor:e-resize;right:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-h-event.fc-event-selected .fc-event-resizer{margin-top:calc(var(--fc-event-resizer-dot-total-width)*-.5);top:50%}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-start,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-end{left:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-end,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-start{right:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc .fc-popover{box-shadow:0 2px 6px rgba(0,0,0,.15);position:absolute;z-index:9999}.fc .fc-popover-header{align-items:center;display:flex;flex-direction:row;justify-content:space-between;padding:3px 4px}.fc .fc-popover-title{margin:0 2px}.fc .fc-popover-close{cursor:pointer;font-size:1.1em;opacity:.65}.fc-theme-standard .fc-popover{background:var(--fc-page-bg-color);border:1px solid var(--fc-border-color)}.fc-theme-standard .fc-popover-header{background:var(--fc-neutral-bg-color)}';uA(SR);class Jp{constructor(e){this.drainedOption=e,this.isRunning=!1,this.isDirty=!1,this.pauseDepths={},this.timeoutId=0}request(e){this.isDirty=!0,this.isPaused()||(this.clearTimeout(),e==null?this.tryDrain():this.timeoutId=setTimeout(this.tryDrain.bind(this),e))}pause(e=""){let{pauseDepths:t}=this;t[e]=(t[e]||0)+1,this.clearTimeout()}resume(e="",t){let{pauseDepths:s}=this;e in s&&(t?delete s[e]:(s[e]-=1,s[e]<=0&&delete s[e]),this.tryDrain())}isPaused(){return Object.keys(this.pauseDepths).length}tryDrain(){if(!this.isRunning&&!this.isPaused()){for(this.isRunning=!0;this.isDirty;)this.isDirty=!1,this.drained();this.isRunning=!1}}clear(){this.clearTimeout(),this.isDirty=!1,this.pauseDepths={}}clearTimeout(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=0)}drained(){this.drainedOption&&this.drainedOption()}}function eg(n){n.parentNode&&n.parentNode.removeChild(n)}function vs(n,e){if(n.closest)return n.closest(e);if(!document.documentElement.contains(n))return null;do{if(ER(n,e))return n;n=n.parentElement||n.parentNode}while(n!==null&&n.nodeType===1);return null}function ER(n,e){return(n.matches||n.matchesSelector||n.msMatchesSelector).call(n,e)}function _R(n,e){let t=n instanceof HTMLElement?[n]:n,s=[];for(let i=0;i<t.length;i+=1){let l=t[i].querySelectorAll(e);for(let c=0;c<l.length;c+=1)s.push(l[c])}return s}const CR=/(top|left|right|bottom|width|height)$/i;function wo(n,e){for(let t in e)mA(n,t,e[t])}function mA(n,e,t){t==null?n.style[e]="":typeof t=="number"&&CR.test(e)?n.style[e]=`${t}px`:n.style[e]=t}function pA(n){var e,t;return(t=(e=n.composedPath)===null||e===void 0?void 0:e.call(n)[0])!==null&&t!==void 0?t:n.target}let _v=0;function _u(){return _v+=1,"fc-dom-"+_v}function Cu(n){n.preventDefault()}function TR(n,e){return t=>{let s=vs(t.target,n);s&&e.call(s,t,s)}}function gA(n,e,t,s){let i=TR(t,s);return n.addEventListener(e,i),()=>{n.removeEventListener(e,i)}}function DR(n,e,t,s){let i;return gA(n,"mouseover",e,(l,c)=>{if(c!==i){i=c,t(l,c);let u=h=>{i=null,s(h,c),c.removeEventListener("mouseleave",u)};c.addEventListener("mouseleave",u)}})}const Cv=["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"];function RR(n,e){let t=s=>{e(s),Cv.forEach(i=>{n.removeEventListener(i,t)})};Cv.forEach(s=>{n.addEventListener(s,t)})}function xA(n){return Object.assign({onClick:n},yA(n))}function yA(n){return{tabIndex:0,onKeyDown(e){(e.key==="Enter"||e.key===" ")&&(n(e),e.preventDefault())}}}let Tv=0;function Wi(){return Tv+=1,String(Tv)}function tg(){document.body.classList.add("fc-not-allowed")}function sg(){document.body.classList.remove("fc-not-allowed")}function kR(n){n.style.userSelect="none",n.style.webkitUserSelect="none",n.addEventListener("selectstart",Cu)}function MR(n){n.style.userSelect="",n.style.webkitUserSelect="",n.removeEventListener("selectstart",Cu)}function LR(n){n.addEventListener("contextmenu",Cu)}function OR(n){n.removeEventListener("contextmenu",Cu)}function PR(n){let e=[],t=[],s,i;for(typeof n=="string"?t=n.split(/\s*,\s*/):typeof n=="function"?t=[n]:Array.isArray(n)&&(t=n),s=0;s<t.length;s+=1)i=t[s],typeof i=="string"?e.push(i.charAt(0)==="-"?{field:i.substring(1),order:-1}:{field:i,order:1}):typeof i=="function"&&e.push({func:i});return e}function IR(n,e,t){let s,i;for(s=0;s<t.length;s+=1)if(i=BR(n,e,t[s]),i)return i;return 0}function BR(n,e,t){return t.func?t.func(n,e):HR(n[t.field],e[t.field])*(t.order||1)}function HR(n,e){return!n&&!e?0:e==null?-1:n==null?1:typeof n=="string"||typeof e=="string"?String(n).localeCompare(String(e)):n-e}function jm(n,e){let t=String(n);return"000".substr(0,e-t.length)+t}function Ao(n,e,t){return typeof n=="function"?n(...e):typeof n=="string"?e.reduce((s,i,l)=>s.replace("$"+l,i||""),n):t}function zR(n,e){return n-e}function Sm(n){return n%1===0}function FR(n){let e=n.querySelector(".fc-scrollgrid-shrink-frame"),t=n.querySelector(".fc-scrollgrid-shrink-cushion");if(!e)throw new Error("needs fc-scrollgrid-shrink-frame className");if(!t)throw new Error("needs fc-scrollgrid-shrink-cushion className");return n.getBoundingClientRect().width-e.getBoundingClientRect().width+t.getBoundingClientRect().width}const UR=/^(-?)(?:(\d+)\.)?(\d+):(\d\d)(?::(\d\d)(?:\.(\d\d\d))?)?/;function ot(n,e){return typeof n=="string"?$R(n):typeof n=="object"&&n?Dv(n):typeof n=="number"?Dv({[e||"milliseconds"]:n}):null}function $R(n){let e=UR.exec(n);if(e){let t=e[1]?-1:1;return{years:0,months:0,days:t*(e[2]?parseInt(e[2],10):0),milliseconds:t*((e[3]?parseInt(e[3],10):0)*60*60*1e3+(e[4]?parseInt(e[4],10):0)*60*1e3+(e[5]?parseInt(e[5],10):0)*1e3+(e[6]?parseInt(e[6],10):0))}}return null}function Dv(n){let e={years:n.years||n.year||0,months:n.months||n.month||0,days:n.days||n.day||0,milliseconds:(n.hours||n.hour||0)*60*60*1e3+(n.minutes||n.minute||0)*60*1e3+(n.seconds||n.second||0)*1e3+(n.milliseconds||n.millisecond||n.ms||0)},t=n.weeks||n.week;return t&&(e.days+=t*7,e.specifiedWeeks=!0),e}function VR(n,e){return n.years===e.years&&n.months===e.months&&n.days===e.days&&n.milliseconds===e.milliseconds}function qR(n,e){return{years:n.years-e.years,months:n.months-e.months,days:n.days-e.days,milliseconds:n.milliseconds-e.milliseconds}}function GR(n){return Xr(n)/365}function YR(n){return Xr(n)/30}function Xr(n){return Lo(n)/864e5}function Lo(n){return n.years*(365*864e5)+n.months*(30*864e5)+n.days*864e5+n.milliseconds}function cp(n){let e=n.milliseconds;if(e){if(e%1e3!==0)return{unit:"millisecond",value:e};if(e%(1e3*60)!==0)return{unit:"second",value:e/1e3};if(e%(1e3*60*60)!==0)return{unit:"minute",value:e/(1e3*60)};if(e)return{unit:"hour",value:e/(1e3*60*60)}}return n.days?n.specifiedWeeks&&n.days%7===0?{unit:"week",value:n.days/7}:{unit:"day",value:n.days}:n.months?{unit:"month",value:n.months}:n.years?{unit:"year",value:n.years}:{unit:"millisecond",value:0}}function ti(n,e,t){if(n===e)return!0;let s=n.length,i;if(s!==e.length)return!1;for(i=0;i<s;i+=1)if(!(t?t(n[i],e[i]):n[i]===e[i]))return!1;return!0}const WR=["sun","mon","tue","wed","thu","fri","sat"];function Rv(n,e){let t=Qa(n);return t[2]+=e*7,Ps(t)}function is(n,e){let t=Qa(n);return t[2]+=e,Ps(t)}function si(n,e){let t=Qa(n);return t[6]+=e,Ps(t)}function XR(n,e){return ol(n,e)/7}function ol(n,e){return(e.valueOf()-n.valueOf())/(1e3*60*60*24)}function QR(n,e){return(e.valueOf()-n.valueOf())/(1e3*60*60)}function ZR(n,e){return(e.valueOf()-n.valueOf())/(1e3*60)}function KR(n,e){return(e.valueOf()-n.valueOf())/1e3}function JR(n,e){let t=Ct(n),s=Ct(e);return{years:0,months:0,days:Math.round(ol(t,s)),milliseconds:e.valueOf()-s.valueOf()-(n.valueOf()-t.valueOf())}}function ek(n,e){let t=Jd(n,e);return t!==null&&t%7===0?t/7:null}function Jd(n,e){return Za(n)===Za(e)?Math.round(ol(n,e)):null}function Ct(n){return Ps([n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()])}function tk(n){return Ps([n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours()])}function sk(n){return Ps([n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes()])}function nk(n){return Ps([n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds()])}function ak(n,e,t){let s=n.getUTCFullYear(),i=Em(n,s,e,t);if(i<1)return Em(n,s-1,e,t);let l=Em(n,s+1,e,t);return l>=1?Math.min(i,l):i}function Em(n,e,t,s){let i=Ps([e,0,1+ik(e,t,s)]),l=Ct(n),c=Math.round(ol(i,l));return Math.floor(c/7)+1}function ik(n,e,t){let s=7+e-t;return-((7+Ps([n,0,s]).getUTCDay()-e)%7)+s-1}function kv(n){return[n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()]}function Mv(n){return new Date(n[0],n[1]||0,n[2]==null?1:n[2],n[3]||0,n[4]||0,n[5]||0)}function Qa(n){return[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds()]}function Ps(n){return n.length===1&&(n=n.concat([0])),new Date(Date.UTC(...n))}function bA(n){return!isNaN(n.valueOf())}function Za(n){return n.getUTCHours()*1e3*60*60+n.getUTCMinutes()*1e3*60+n.getUTCSeconds()*1e3+n.getUTCMilliseconds()}function rk(n,e,t=!1){let s=n.toISOString();return s=s.replace(".000",""),t&&(s=s.replace("T00:00:00Z","")),s.length>10&&(e==null?s=s.replace("Z",""):e!==0&&(s=s.replace("Z",ag(e,!0)))),s}function ng(n){return n.toISOString().replace(/T.*$/,"")}function lk(n){return n.toISOString().match(/^\d{4}-\d{2}/)[0]}function ag(n,e=!1){let t=n<0?"-":"+",s=Math.abs(n),i=Math.floor(s/60),l=Math.round(s%60);return e?`${t+jm(i,2)}:${jm(l,2)}`:`GMT${t}${i}${l?`:${jm(l,2)}`:""}`}function rt(n,e,t){let s,i;return function(...l){if(!s)i=n.apply(this,l);else if(!ti(s,l)){let c=n.apply(this,l);(!e||!e(c,i))&&(i=c)}return s=l,i}}function Id(n,e,t){let s,i;return l=>(s?Cn(s,l)||(i=n.call(this,l)):i=n.call(this,l),s=l,i)}const _m={week:3,separator:9,omitZeroMinute:9,meridiem:9,omitCommas:9},eu={timeZoneName:7,era:6,year:5,month:4,day:2,weekday:2,hour:1,minute:1,second:1},vd=/\s*([ap])\.?m\.?/i,ok=/,/g,ck=/\s+/g,dk=/\u200e/g,uk=/UTC|GMT/;class hk{constructor(e){let t={},s={},i=9;for(let l in e)l in _m?(s[l]=e[l],_m[l]<9&&(i=Math.min(_m[l],i))):(t[l]=e[l],l in eu&&(i=Math.min(eu[l],i)));this.standardDateProps=t,this.extendedSettings=s,this.smallestUnitNum=i,this.buildFormattingFunc=rt(Lv)}format(e,t){return this.buildFormattingFunc(this.standardDateProps,this.extendedSettings,t)(e)}formatRange(e,t,s,i){let{standardDateProps:l,extendedSettings:c}=this,u=yk(e.marker,t.marker,s.calendarSystem);if(!u)return this.format(e,s);let h=u;h>1&&(l.year==="numeric"||l.year==="2-digit")&&(l.month==="numeric"||l.month==="2-digit")&&(l.day==="numeric"||l.day==="2-digit")&&(h=1);let m=this.format(e,s),p=this.format(t,s);if(m===p)return m;let x=bk(l,h),y=Lv(x,c,s),v=y(e),w=y(t),A=vk(m,v,p,w),N=c.separator||i||s.defaultSeparator||"";return A?A.before+v+N+w+A.after:m+N+p}getSmallestUnit(){switch(this.smallestUnitNum){case 7:case 6:case 5:return"year";case 4:return"month";case 3:return"week";case 2:return"day";default:return"time"}}}function Lv(n,e,t){let s=Object.keys(n).length;return s===1&&n.timeZoneName==="short"?i=>ag(i.timeZoneOffset):s===0&&e.week?i=>xk(t.computeWeekNumber(i.marker),t.weekText,t.weekTextLong,t.locale,e.week):fk(n,e,t)}function fk(n,e,t){n=Object.assign({},n),e=Object.assign({},e),mk(n,e),n.timeZone="UTC";let s=new Intl.DateTimeFormat(t.locale.codes,n),i;if(e.omitZeroMinute){let l=Object.assign({},n);delete l.minute,i=new Intl.DateTimeFormat(t.locale.codes,l)}return l=>{let{marker:c}=l,u;i&&!c.getUTCMinutes()?u=i:u=s;let h=u.format(c);return pk(h,l,n,e,t)}}function mk(n,e){n.timeZoneName&&(n.hour||(n.hour="2-digit"),n.minute||(n.minute="2-digit")),n.timeZoneName==="long"&&(n.timeZoneName="short"),e.omitZeroMinute&&(n.second||n.millisecond)&&delete e.omitZeroMinute}function pk(n,e,t,s,i){return n=n.replace(dk,""),t.timeZoneName==="short"&&(n=gk(n,i.timeZone==="UTC"||e.timeZoneOffset==null?"UTC":ag(e.timeZoneOffset))),s.omitCommas&&(n=n.replace(ok,"").trim()),s.omitZeroMinute&&(n=n.replace(":00","")),s.meridiem===!1?n=n.replace(vd,"").trim():s.meridiem==="narrow"?n=n.replace(vd,(l,c)=>c.toLocaleLowerCase()):s.meridiem==="short"?n=n.replace(vd,(l,c)=>`${c.toLocaleLowerCase()}m`):s.meridiem==="lowercase"&&(n=n.replace(vd,l=>l.toLocaleLowerCase())),n=n.replace(ck," "),n=n.trim(),n}function gk(n,e){let t=!1;return n=n.replace(uk,()=>(t=!0,e)),t||(n+=` ${e}`),n}function xk(n,e,t,s,i){let l=[];return i==="long"?l.push(t):(i==="short"||i==="narrow")&&l.push(e),(i==="long"||i==="short")&&l.push(" "),l.push(s.simpleNumberFormat.format(n)),s.options.direction==="rtl"&&l.reverse(),l.join("")}function yk(n,e,t){return t.getMarkerYear(n)!==t.getMarkerYear(e)?5:t.getMarkerMonth(n)!==t.getMarkerMonth(e)?4:t.getMarkerDay(n)!==t.getMarkerDay(e)?2:Za(n)!==Za(e)?1:0}function bk(n,e){let t={};for(let s in n)(!(s in eu)||eu[s]<=e)&&(t[s]=n[s]);return t}function vk(n,e,t,s){let i=0;for(;i<n.length;){let l=n.indexOf(e,i);if(l===-1)break;let c=n.substr(0,l);i=l+e.length;let u=n.substr(i),h=0;for(;h<t.length;){let m=t.indexOf(s,h);if(m===-1)break;let p=t.substr(0,m);h=m+s.length;let x=t.substr(h);if(c===p&&u===x)return{before:c,after:u}}}return null}function Ov(n,e){let t=e.markerToArray(n.marker);return{marker:n.marker,timeZoneOffset:n.timeZoneOffset,array:t,year:t[0],month:t[1],day:t[2],hour:t[3],minute:t[4],second:t[5],millisecond:t[6]}}function tu(n,e,t,s){let i=Ov(n,t.calendarSystem),l=e?Ov(e,t.calendarSystem):null;return{date:i,start:i,end:l,timeZone:t.timeZone,localeCodes:t.locale.codes,defaultSeparator:s||t.defaultSeparator}}class wk{constructor(e){this.cmdStr=e}format(e,t,s){return t.cmdFormatter(this.cmdStr,tu(e,null,t,s))}formatRange(e,t,s,i){return s.cmdFormatter(this.cmdStr,tu(e,t,s,i))}}class Ak{constructor(e){this.func=e}format(e,t,s){return this.func(tu(e,null,t,s))}formatRange(e,t,s,i){return this.func(tu(e,t,s,i))}}function as(n){return typeof n=="object"&&n?new hk(n):typeof n=="string"?new wk(n):typeof n=="function"?new Ak(n):null}const Pv={navLinkDayClick:ie,navLinkWeekClick:ie,duration:ot,bootstrapFontAwesome:ie,buttonIcons:ie,customButtons:ie,defaultAllDayEventDuration:ot,defaultTimedEventDuration:ot,nextDayThreshold:ot,scrollTime:ot,scrollTimeReset:Boolean,slotMinTime:ot,slotMaxTime:ot,dayPopoverFormat:as,slotDuration:ot,snapDuration:ot,headerToolbar:ie,footerToolbar:ie,defaultRangeSeparator:String,titleRangeSeparator:String,forceEventDuration:Boolean,dayHeaders:Boolean,dayHeaderFormat:as,dayHeaderClassNames:ie,dayHeaderContent:ie,dayHeaderDidMount:ie,dayHeaderWillUnmount:ie,dayCellClassNames:ie,dayCellContent:ie,dayCellDidMount:ie,dayCellWillUnmount:ie,initialView:String,aspectRatio:Number,weekends:Boolean,weekNumberCalculation:ie,weekNumbers:Boolean,weekNumberClassNames:ie,weekNumberContent:ie,weekNumberDidMount:ie,weekNumberWillUnmount:ie,editable:Boolean,viewClassNames:ie,viewDidMount:ie,viewWillUnmount:ie,nowIndicator:Boolean,nowIndicatorSnap:ie,nowIndicatorClassNames:ie,nowIndicatorContent:ie,nowIndicatorDidMount:ie,nowIndicatorWillUnmount:ie,showNonCurrentDates:Boolean,lazyFetching:Boolean,startParam:String,endParam:String,timeZoneParam:String,timeZone:String,locales:ie,locale:ie,themeSystem:String,dragRevertDuration:Number,dragScroll:Boolean,allDayMaintainDuration:Boolean,unselectAuto:Boolean,dropAccept:ie,eventOrder:PR,eventOrderStrict:Boolean,handleWindowResize:Boolean,windowResizeDelay:Number,longPressDelay:Number,eventDragMinDistance:Number,expandRows:Boolean,height:ie,contentHeight:ie,direction:String,weekNumberFormat:as,eventResizableFromStart:Boolean,displayEventTime:Boolean,displayEventEnd:Boolean,weekText:String,weekTextLong:String,progressiveEventRendering:Boolean,businessHours:ie,initialDate:ie,now:ie,eventDataTransform:ie,stickyHeaderDates:ie,stickyFooterScrollbar:ie,viewHeight:ie,defaultAllDay:Boolean,eventSourceFailure:ie,eventSourceSuccess:ie,eventDisplay:String,eventStartEditable:Boolean,eventDurationEditable:Boolean,eventOverlap:ie,eventConstraint:ie,eventAllow:ie,eventBackgroundColor:String,eventBorderColor:String,eventTextColor:String,eventColor:String,eventClassNames:ie,eventContent:ie,eventDidMount:ie,eventWillUnmount:ie,selectConstraint:ie,selectOverlap:ie,selectAllow:ie,droppable:Boolean,unselectCancel:String,slotLabelFormat:ie,slotLaneClassNames:ie,slotLaneContent:ie,slotLaneDidMount:ie,slotLaneWillUnmount:ie,slotLabelClassNames:ie,slotLabelContent:ie,slotLabelDidMount:ie,slotLabelWillUnmount:ie,dayMaxEvents:ie,dayMaxEventRows:ie,dayMinWidth:Number,slotLabelInterval:ot,allDayText:String,allDayClassNames:ie,allDayContent:ie,allDayDidMount:ie,allDayWillUnmount:ie,slotMinWidth:Number,navLinks:Boolean,eventTimeFormat:as,rerenderDelay:Number,moreLinkText:ie,moreLinkHint:ie,selectMinDistance:Number,selectable:Boolean,selectLongPressDelay:Number,eventLongPressDelay:Number,selectMirror:Boolean,eventMaxStack:Number,eventMinHeight:Number,eventMinWidth:Number,eventShortHeight:Number,slotEventOverlap:Boolean,plugins:ie,firstDay:Number,dayCount:Number,dateAlignment:String,dateIncrement:ot,hiddenDays:ie,fixedWeekCount:Boolean,validRange:ie,visibleRange:ie,titleFormat:ie,eventInteractive:Boolean,noEventsText:String,viewHint:ie,navLinkHint:ie,closeHint:String,timeHint:String,eventHint:String,moreLinkClick:ie,moreLinkClassNames:ie,moreLinkContent:ie,moreLinkDidMount:ie,moreLinkWillUnmount:ie,monthStartFormat:as,handleCustomRendering:ie,customRenderingMetaMap:ie,customRenderingReplaces:Boolean},No={eventDisplay:"auto",defaultRangeSeparator:" - ",titleRangeSeparator:" – ",defaultTimedEventDuration:"01:00:00",defaultAllDayEventDuration:{day:1},forceEventDuration:!1,nextDayThreshold:"00:00:00",dayHeaders:!0,initialView:"",aspectRatio:1.35,headerToolbar:{start:"title",center:"",end:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"local",editable:!1,nowIndicator:!1,scrollTime:"06:00:00",scrollTimeReset:!0,slotMinTime:"00:00:00",slotMaxTime:"24:00:00",showNonCurrentDates:!0,lazyFetching:!0,startParam:"start",endParam:"end",timeZoneParam:"timeZone",timeZone:"local",locales:[],locale:"",themeSystem:"standard",dragRevertDuration:500,dragScroll:!0,allDayMaintainDuration:!1,unselectAuto:!0,dropAccept:"*",eventOrder:"start,-duration,allDay,title",dayPopoverFormat:{month:"long",day:"numeric",year:"numeric"},handleWindowResize:!0,windowResizeDelay:100,longPressDelay:1e3,eventDragMinDistance:5,expandRows:!1,navLinks:!1,selectable:!1,eventMinHeight:15,eventMinWidth:30,eventShortHeight:30,monthStartFormat:{month:"long",day:"numeric"},nowIndicatorSnap:"auto"},Iv={datesSet:ie,eventsSet:ie,eventAdd:ie,eventChange:ie,eventRemove:ie,windowResize:ie,eventClick:ie,eventMouseEnter:ie,eventMouseLeave:ie,select:ie,unselect:ie,loading:ie,_unmount:ie,_beforeprint:ie,_afterprint:ie,_noEventDrop:ie,_noEventResize:ie,_resize:ie,_scrollRequest:ie},Bv={buttonText:ie,buttonHints:ie,views:ie,plugins:ie,initialEvents:ie,events:ie,eventSources:ie},_i={headerToolbar:Ci,footerToolbar:Ci,buttonText:Ci,buttonHints:Ci,buttonIcons:Ci,dateIncrement:Ci,plugins:wd,events:wd,eventSources:wd,resources:wd};function Ci(n,e){return typeof n=="object"&&typeof e=="object"&&n&&e?Cn(n,e):n===e}function wd(n,e){return Array.isArray(n)&&Array.isArray(e)?ti(n,e):n===e}const Nk={type:String,component:ie,buttonText:String,buttonTextKey:String,dateProfileGeneratorClass:ie,usesMinMaxTime:Boolean,classNames:ie,content:ie,didMount:ie,willUnmount:ie};function Cm(n){return rg(n,_i)}function ig(n,e){let t={},s={};for(let i in e)i in n&&(t[i]=e[i](n[i]));for(let i in n)i in e||(s[i]=n[i]);return{refined:t,extra:s}}function ie(n){return n}const{hasOwnProperty:su}=Object.prototype;function rg(n,e){let t={};if(e){for(let s in e)if(e[s]===Ci){let i=[];for(let l=n.length-1;l>=0;l-=1){let c=n[l][s];if(typeof c=="object"&&c)i.unshift(c);else if(c!==void 0){t[s]=c;break}}i.length&&(t[s]=rg(i))}}for(let s=n.length-1;s>=0;s-=1){let i=n[s];for(let l in i)l in t||(t[l]=i[l])}return t}function Vi(n,e){let t={};for(let s in n)e(n[s],s)&&(t[s]=n[s]);return t}function Xi(n,e){let t={};for(let s in n)t[s]=e(n[s],s);return t}function vA(n){let e={};for(let t of n)e[t]=!0;return e}function lg(n){let e=[];for(let t in n)e.push(n[t]);return e}function Cn(n,e){if(n===e)return!0;for(let t in n)if(su.call(n,t)&&!(t in e))return!1;for(let t in e)if(su.call(e,t)&&n[t]!==e[t])return!1;return!0}const jk=/^on[A-Z]/;function Sk(n,e){const t=Ek(n,e);for(let s of t)if(!jk.test(s))return!1;return!0}function Ek(n,e){let t=[];for(let s in n)su.call(n,s)&&(s in e||t.push(s));for(let s in e)su.call(e,s)&&n[s]!==e[s]&&t.push(s);return t}function Tm(n,e,t={}){if(n===e)return!0;for(let s in e)if(!(s in n&&_k(n[s],e[s],t[s])))return!1;for(let s in n)if(!(s in e))return!1;return!0}function _k(n,e,t){return n===e||t===!0?!0:t?t(n,e):!1}function Ck(n,e=0,t,s=1){let i=[];t==null&&(t=Object.keys(n).length);for(let l=e;l<t;l+=s){let c=n[l];c!==void 0&&i.push(c)}return i}let wA={};function Tk(n,e){wA[n]=e}function Dk(n){return new wA[n]}class Rk{getMarkerYear(e){return e.getUTCFullYear()}getMarkerMonth(e){return e.getUTCMonth()}getMarkerDay(e){return e.getUTCDate()}arrayToMarker(e){return Ps(e)}markerToArray(e){return Qa(e)}}Tk("gregory",Rk);const kk=/^\s*(\d{4})(-?(\d{2})(-?(\d{2})([T ](\d{2}):?(\d{2})(:?(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/;function Mk(n){let e=kk.exec(n);if(e){let t=new Date(Date.UTC(Number(e[1]),e[3]?Number(e[3])-1:0,Number(e[5]||1),Number(e[7]||0),Number(e[8]||0),Number(e[10]||0),e[12]?+`0.${e[12]}`*1e3:0));if(bA(t)){let s=null;return e[13]&&(s=(e[15]==="-"?-1:1)*(Number(e[16]||0)*60+Number(e[18]||0))),{marker:t,isTimeUnspecified:!e[6],timeZoneOffset:s}}}return null}class Lk{constructor(e){let t=this.timeZone=e.timeZone,s=t!=="local"&&t!=="UTC";e.namedTimeZoneImpl&&s&&(this.namedTimeZoneImpl=new e.namedTimeZoneImpl(t)),this.canComputeOffset=!!(!s||this.namedTimeZoneImpl),this.calendarSystem=Dk(e.calendarSystem),this.locale=e.locale,this.weekDow=e.locale.week.dow,this.weekDoy=e.locale.week.doy,e.weekNumberCalculation==="ISO"&&(this.weekDow=1,this.weekDoy=4),typeof e.firstDay=="number"&&(this.weekDow=e.firstDay),typeof e.weekNumberCalculation=="function"&&(this.weekNumberFunc=e.weekNumberCalculation),this.weekText=e.weekText!=null?e.weekText:e.locale.options.weekText,this.weekTextLong=(e.weekTextLong!=null?e.weekTextLong:e.locale.options.weekTextLong)||this.weekText,this.cmdFormatter=e.cmdFormatter,this.defaultSeparator=e.defaultSeparator}createMarker(e){let t=this.createMarkerMeta(e);return t===null?null:t.marker}createNowMarker(){return this.canComputeOffset?this.timestampToMarker(new Date().valueOf()):Ps(kv(new Date))}createMarkerMeta(e){if(typeof e=="string")return this.parse(e);let t=null;return typeof e=="number"?t=this.timestampToMarker(e):e instanceof Date?(e=e.valueOf(),isNaN(e)||(t=this.timestampToMarker(e))):Array.isArray(e)&&(t=Ps(e)),t===null||!bA(t)?null:{marker:t,isTimeUnspecified:!1,forcedTzo:null}}parse(e){let t=Mk(e);if(t===null)return null;let{marker:s}=t,i=null;return t.timeZoneOffset!==null&&(this.canComputeOffset?s=this.timestampToMarker(s.valueOf()-t.timeZoneOffset*60*1e3):i=t.timeZoneOffset),{marker:s,isTimeUnspecified:t.isTimeUnspecified,forcedTzo:i}}getYear(e){return this.calendarSystem.getMarkerYear(e)}getMonth(e){return this.calendarSystem.getMarkerMonth(e)}getDay(e){return this.calendarSystem.getMarkerDay(e)}add(e,t){let s=this.calendarSystem.markerToArray(e);return s[0]+=t.years,s[1]+=t.months,s[2]+=t.days,s[6]+=t.milliseconds,this.calendarSystem.arrayToMarker(s)}subtract(e,t){let s=this.calendarSystem.markerToArray(e);return s[0]-=t.years,s[1]-=t.months,s[2]-=t.days,s[6]-=t.milliseconds,this.calendarSystem.arrayToMarker(s)}addYears(e,t){let s=this.calendarSystem.markerToArray(e);return s[0]+=t,this.calendarSystem.arrayToMarker(s)}addMonths(e,t){let s=this.calendarSystem.markerToArray(e);return s[1]+=t,this.calendarSystem.arrayToMarker(s)}diffWholeYears(e,t){let{calendarSystem:s}=this;return Za(e)===Za(t)&&s.getMarkerDay(e)===s.getMarkerDay(t)&&s.getMarkerMonth(e)===s.getMarkerMonth(t)?s.getMarkerYear(t)-s.getMarkerYear(e):null}diffWholeMonths(e,t){let{calendarSystem:s}=this;return Za(e)===Za(t)&&s.getMarkerDay(e)===s.getMarkerDay(t)?s.getMarkerMonth(t)-s.getMarkerMonth(e)+(s.getMarkerYear(t)-s.getMarkerYear(e))*12:null}greatestWholeUnit(e,t){let s=this.diffWholeYears(e,t);return s!==null?{unit:"year",value:s}:(s=this.diffWholeMonths(e,t),s!==null?{unit:"month",value:s}:(s=ek(e,t),s!==null?{unit:"week",value:s}:(s=Jd(e,t),s!==null?{unit:"day",value:s}:(s=QR(e,t),Sm(s)?{unit:"hour",value:s}:(s=ZR(e,t),Sm(s)?{unit:"minute",value:s}:(s=KR(e,t),Sm(s)?{unit:"second",value:s}:{unit:"millisecond",value:t.valueOf()-e.valueOf()}))))))}countDurationsBetween(e,t,s){let i;return s.years&&(i=this.diffWholeYears(e,t),i!==null)?i/GR(s):s.months&&(i=this.diffWholeMonths(e,t),i!==null)?i/YR(s):s.days&&(i=Jd(e,t),i!==null)?i/Xr(s):(t.valueOf()-e.valueOf())/Lo(s)}startOf(e,t){return t==="year"?this.startOfYear(e):t==="month"?this.startOfMonth(e):t==="week"?this.startOfWeek(e):t==="day"?Ct(e):t==="hour"?tk(e):t==="minute"?sk(e):t==="second"?nk(e):null}startOfYear(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e)])}startOfMonth(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e)])}startOfWeek(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e),e.getUTCDate()-(e.getUTCDay()-this.weekDow+7)%7])}computeWeekNumber(e){return this.weekNumberFunc?this.weekNumberFunc(this.toDate(e)):ak(e,this.weekDow,this.weekDoy)}format(e,t,s={}){return t.format({marker:e,timeZoneOffset:s.forcedTzo!=null?s.forcedTzo:this.offsetForMarker(e)},this)}formatRange(e,t,s,i={}){return i.isEndExclusive&&(t=si(t,-1)),s.formatRange({marker:e,timeZoneOffset:i.forcedStartTzo!=null?i.forcedStartTzo:this.offsetForMarker(e)},{marker:t,timeZoneOffset:i.forcedEndTzo!=null?i.forcedEndTzo:this.offsetForMarker(t)},this,i.defaultSeparator)}formatIso(e,t={}){let s=null;return t.omitTimeZoneOffset||(t.forcedTzo!=null?s=t.forcedTzo:s=this.offsetForMarker(e)),rk(e,s,t.omitTime)}timestampToMarker(e){return this.timeZone==="local"?Ps(kv(new Date(e))):this.timeZone==="UTC"||!this.namedTimeZoneImpl?new Date(e):Ps(this.namedTimeZoneImpl.timestampToArray(e))}offsetForMarker(e){return this.timeZone==="local"?-Mv(Qa(e)).getTimezoneOffset():this.timeZone==="UTC"?0:this.namedTimeZoneImpl?this.namedTimeZoneImpl.offsetForArray(Qa(e)):null}toDate(e,t){return this.timeZone==="local"?Mv(Qa(e)):this.timeZone==="UTC"?new Date(e.valueOf()):this.namedTimeZoneImpl?new Date(e.valueOf()-this.namedTimeZoneImpl.offsetForArray(Qa(e))*1e3*60):new Date(e.valueOf()-(t||0))}}class Zo{constructor(e){this.iconOverrideOption&&this.setIconOverride(e[this.iconOverrideOption])}setIconOverride(e){let t,s;if(typeof e=="object"&&e){t=Object.assign({},this.iconClasses);for(s in e)t[s]=this.applyIconOverridePrefix(e[s]);this.iconClasses=t}else e===!1&&(this.iconClasses={})}applyIconOverridePrefix(e){let t=this.iconOverridePrefix;return t&&e.indexOf(t)!==0&&(e=t+e),e}getClass(e){return this.classes[e]||""}getIconClass(e,t){let s;return t&&this.rtlIconClasses?s=this.rtlIconClasses[e]||this.iconClasses[e]:s=this.iconClasses[e],s?`${this.baseIconClass} ${s}`:""}getCustomButtonIconClass(e){let t;return this.iconOverrideCustomButtonOption&&(t=e[this.iconOverrideCustomButtonOption],t)?`${this.baseIconClass} ${this.applyIconOverridePrefix(t)}`:""}}Zo.prototype.classes={};Zo.prototype.iconClasses={};Zo.prototype.baseIconClass="";Zo.prototype.iconOverridePrefix="";function nu(n){n();let e=Me.debounceRendering,t=[];function s(i){t.push(i)}for(Me.debounceRendering=s,Mo(re(Ok,{}),document.createElement("div"));t.length;)t.shift()();Me.debounceRendering=e}class Ok extends en{render(){return re("div",{})}componentDidMount(){this.setState({})}}function AA(n){let e=rR(n),t=e.Provider;return e.Provider=function(){let s=!this.getChildContext,i=t.apply(this,arguments);if(s){let l=[];this.shouldComponentUpdate=c=>{this.props.value!==c.value&&l.forEach(u=>{u.context=c.value,u.forceUpdate()})},this.sub=c=>{l.push(c);let u=c.componentWillUnmount;c.componentWillUnmount=()=>{l.splice(l.indexOf(c),1),u&&u.call(c)}}}return i},e}class Pk{constructor(e,t,s,i){this.execFunc=e,this.emitter=t,this.scrollTime=s,this.scrollTimeReset=i,this.handleScrollRequest=l=>{this.queuedRequest=Object.assign({},this.queuedRequest||{},l),this.drain()},t.on("_scrollRequest",this.handleScrollRequest),this.fireInitialScroll()}detach(){this.emitter.off("_scrollRequest",this.handleScrollRequest)}update(e){e&&this.scrollTimeReset?this.fireInitialScroll():this.drain()}fireInitialScroll(){this.handleScrollRequest({time:this.scrollTime})}drain(){this.queuedRequest&&this.execFunc(this.queuedRequest)&&(this.queuedRequest=null)}}const Qi=AA({});function Ik(n,e,t,s,i,l,c,u,h,m,p,x,y,v){return{dateEnv:i,nowManager:l,options:t,pluginHooks:u,emitter:p,dispatch:h,getCurrentData:m,calendarApi:x,viewSpec:n,viewApi:e,dateProfileGenerator:s,theme:c,isRtl:t.direction==="rtl",addResizeHandler(w){p.on("_resize",w)},removeResizeHandler(w){p.off("_resize",w)},createScrollResponder(w){return new Pk(w,p,ot(t.scrollTime),t.scrollTimeReset)},registerInteractiveComponent:y,unregisterInteractiveComponent:v}}class Zi extends en{shouldComponentUpdate(e,t){return!Tm(this.props,e,this.propEquality)||!Tm(this.state,t,this.stateEquality)}safeSetState(e){Tm(this.state,Object.assign(Object.assign({},this.state),e),this.stateEquality)||this.setState(e)}}Zi.addPropsEquality=Bk;Zi.addStateEquality=Hk;Zi.contextType=Qi;Zi.prototype.propEquality={};Zi.prototype.stateEquality={};class Lt extends Zi{}Lt.contextType=Qi;function Bk(n){let e=Object.create(this.prototype.propEquality);Object.assign(e,n),this.prototype.propEquality=e}function Hk(n){let e=Object.create(this.prototype.stateEquality);Object.assign(e,n),this.prototype.stateEquality=e}function Xn(n,e){typeof n=="function"?n(e):n&&(n.current=e)}class og extends Lt{constructor(){super(...arguments),this.id=Wi(),this.queuedDomNodes=[],this.currentDomNodes=[],this.handleEl=e=>{const{options:t}=this.context,{generatorName:s}=this.props;(!t.customRenderingReplaces||!dp(s,t))&&this.updateElRef(e)},this.updateElRef=e=>{this.props.elRef&&Xn(this.props.elRef,e)}}render(){const{props:e,context:t}=this,{options:s}=t,{customGenerator:i,defaultGenerator:l,renderProps:c}=e,u=NA(e,[],this.handleEl);let h=!1,m,p=[],x;if(i!=null){const y=typeof i=="function"?i(c,re):i;if(y===!0)h=!0;else{const v=y&&typeof y=="object";v&&"html"in y?u.dangerouslySetInnerHTML={__html:y.html}:v&&"domNodes"in y?p=Array.prototype.slice.call(y.domNodes):(v?Y1(y):typeof y!="function")?m=y:x=y}}else h=!dp(e.generatorName,s);return h&&l&&(m=l(c)),this.queuedDomNodes=p,this.currentGeneratorMeta=x,re(e.elTag,u,m)}componentDidMount(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentDidUpdate(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentWillUnmount(){this.triggerCustomRendering(!1)}triggerCustomRendering(e){var t;const{props:s,context:i}=this,{handleCustomRendering:l,customRenderingMetaMap:c}=i.options;if(l){const u=(t=this.currentGeneratorMeta)!==null&&t!==void 0?t:c?.[s.generatorName];u&&l(Object.assign(Object.assign({id:this.id,isActive:e,containerEl:this.base,reportNewContainerEl:this.updateElRef,generatorMeta:u},s),{elClasses:(s.elClasses||[]).filter(zk)}))}}applyQueueudDomNodes(){const{queuedDomNodes:e,currentDomNodes:t}=this,s=this.base;if(!ti(e,t)){t.forEach(eg);for(let i of e)s.appendChild(i);this.currentDomNodes=e}}}og.addPropsEquality({elClasses:ti,elStyle:Cn,elAttrs:Sk,renderProps:Cn});function dp(n,e){var t;return!!(e.handleCustomRendering&&n&&(!((t=e.customRenderingMetaMap)===null||t===void 0)&&t[n]))}function NA(n,e,t){const s=Object.assign(Object.assign({},n.elAttrs),{ref:t});return(n.elClasses||e)&&(s.className=(n.elClasses||[]).concat(e||[]).concat(s.className||[]).filter(Boolean).join(" ")),n.elStyle&&(s.style=n.elStyle),s}function zk(n){return!!n}const jA=AA(0);class va extends en{constructor(){super(...arguments),this.InnerContent=Fk.bind(void 0,this),this.handleEl=e=>{this.el=e,this.props.elRef&&(Xn(this.props.elRef,e),e&&this.didMountMisfire&&this.componentDidMount())}}render(){const{props:e}=this,t=Uk(e.classNameGenerator,e.renderProps);if(e.children){const s=NA(e,t,this.handleEl),i=e.children(this.InnerContent,e.renderProps,s);return e.elTag?re(e.elTag,s,i):i}else return re(og,Object.assign(Object.assign({},e),{elRef:this.handleEl,elTag:e.elTag||"div",elClasses:(e.elClasses||[]).concat(t),renderId:this.context}))}componentDidMount(){var e,t;this.el?(t=(e=this.props).didMount)===null||t===void 0||t.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el})):this.didMountMisfire=!0}componentWillUnmount(){var e,t;(t=(e=this.props).willUnmount)===null||t===void 0||t.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el}))}}va.contextType=jA;function Fk(n,e){const t=n.props;return re(og,Object.assign({renderProps:t.renderProps,generatorName:t.generatorName,customGenerator:t.customGenerator,defaultGenerator:t.defaultGenerator,renderId:n.context},e))}function Uk(n,e){const t=typeof n=="function"?n(e):n||[];return typeof t=="string"?[t]:t}class Hv extends Lt{render(){let{props:e,context:t}=this,{options:s}=t,i={view:t.viewApi};return re(va,{elRef:e.elRef,elTag:e.elTag||"div",elAttrs:e.elAttrs,elClasses:[...SA(e.viewSpec),...e.elClasses||[]],elStyle:e.elStyle,renderProps:i,classNameGenerator:s.viewClassNames,generatorName:void 0,didMount:s.viewDidMount,willUnmount:s.viewWillUnmount},()=>e.children)}}function SA(n){return[`fc-${n.type}-view`,"fc-view"]}function $k(n,e){let t=null,s=null;return n.start&&(t=e.createMarker(n.start)),n.end&&(s=e.createMarker(n.end)),!t&&!s||t&&s&&s<t?null:{start:t,end:s}}function zv(n,e){let t=[],{start:s}=e,i,l;for(n.sort(Vk),i=0;i<n.length;i+=1)l=n[i],l.start>s&&t.push({start:s,end:l.start}),l.end>s&&(s=l.end);return s<e.end&&t.push({start:s,end:e.end}),t}function Vk(n,e){return n.start.valueOf()-e.start.valueOf()}function el(n,e){let{start:t,end:s}=n,i=null;return e.start!==null&&(t===null?t=e.start:t=new Date(Math.max(t.valueOf(),e.start.valueOf()))),e.end!=null&&(s===null?s=e.end:s=new Date(Math.min(s.valueOf(),e.end.valueOf()))),(t===null||s===null||t<s)&&(i={start:t,end:s}),i}function qk(n,e){return(n.start===null?null:n.start.valueOf())===(e.start===null?null:e.start.valueOf())&&(n.end===null?null:n.end.valueOf())===(e.end===null?null:e.end.valueOf())}function cg(n,e){return(n.end===null||e.start===null||n.end>e.start)&&(n.start===null||e.end===null||n.start<e.end)}function Tu(n,e){return(n.start===null||e.start!==null&&e.start>=n.start)&&(n.end===null||e.end!==null&&e.end<=n.end)}function Ka(n,e){return(n.start===null||e>=n.start)&&(n.end===null||e<n.end)}function Gk(n,e){return e.start!=null&&n<e.start?e.start:e.end!=null&&n>=e.end?new Date(e.end.valueOf()-1):n}function EA(n){let e=Math.floor(ol(n.start,n.end))||1,t=Ct(n.start),s=is(t,e);return{start:t,end:s}}function _A(n,e=ot(0)){let t=null,s=null;if(n.end){s=Ct(n.end);let i=n.end.valueOf()-s.valueOf();i&&i>=Lo(e)&&(s=is(s,1))}return n.start&&(t=Ct(n.start),s&&s<=t&&(s=is(t,1))),{start:t,end:s}}function Gr(n,e,t,s){return s==="year"?ot(t.diffWholeYears(n,e),"year"):s==="month"?ot(t.diffWholeMonths(n,e),"month"):JR(n,e)}class CA{constructor(e){this.props=e,this.initHiddenDays()}buildPrev(e,t,s){let{dateEnv:i}=this.props,l=i.subtract(i.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(l,-1,s)}buildNext(e,t,s){let{dateEnv:i}=this.props,l=i.add(i.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(l,1,s)}build(e,t,s=!0){let{props:i}=this,l,c,u,h,m,p;return l=this.buildValidRange(),l=this.trimHiddenDays(l),s&&(e=Gk(e,l)),c=this.buildCurrentRangeInfo(e,t),u=/^(year|month|week|day)$/.test(c.unit),h=this.buildRenderRange(this.trimHiddenDays(c.range),c.unit,u),h=this.trimHiddenDays(h),m=h,i.showNonCurrentDates||(m=el(m,c.range)),m=this.adjustActiveRange(m),m=el(m,l),p=cg(c.range,l),Ka(h,e)||(e=h.start),{currentDate:e,validRange:l,currentRange:c.range,currentRangeUnit:c.unit,isRangeAllDay:u,activeRange:m,renderRange:h,slotMinTime:i.slotMinTime,slotMaxTime:i.slotMaxTime,isValid:p,dateIncrement:this.buildDateIncrement(c.duration)}}buildValidRange(){let e=this.props.validRangeInput,t=typeof e=="function"?e.call(this.props.calendarApi,this.props.dateEnv.toDate(this.props.nowManager.getDateMarker())):e;return this.refineRange(t)||{start:null,end:null}}buildCurrentRangeInfo(e,t){let{props:s}=this,i=null,l=null,c=null,u;return s.duration?(i=s.duration,l=s.durationUnit,c=this.buildRangeFromDuration(e,t,i,l)):(u=this.props.dayCount)?(l="day",c=this.buildRangeFromDayCount(e,t,u)):(c=this.buildCustomVisibleRange(e))?l=s.dateEnv.greatestWholeUnit(c.start,c.end).unit:(i=this.getFallbackDuration(),l=cp(i).unit,c=this.buildRangeFromDuration(e,t,i,l)),{duration:i,unit:l,range:c}}getFallbackDuration(){return ot({day:1})}adjustActiveRange(e){let{dateEnv:t,usesMinMaxTime:s,slotMinTime:i,slotMaxTime:l}=this.props,{start:c,end:u}=e;return s&&(Xr(i)<0&&(c=Ct(c),c=t.add(c,i)),Xr(l)>1&&(u=Ct(u),u=is(u,-1),u=t.add(u,l))),{start:c,end:u}}buildRangeFromDuration(e,t,s,i){let{dateEnv:l,dateAlignment:c}=this.props,u,h,m;if(!c){let{dateIncrement:x}=this.props;x&&Lo(x)<Lo(s)?c=cp(x).unit:c=i}Xr(s)<=1&&this.isHiddenDay(u)&&(u=this.skipHiddenDays(u,t),u=Ct(u));function p(){u=l.startOf(e,c),h=l.add(u,s),m={start:u,end:h}}return p(),this.trimHiddenDays(m)||(e=this.skipHiddenDays(e,t),p()),m}buildRangeFromDayCount(e,t,s){let{dateEnv:i,dateAlignment:l}=this.props,c=0,u=e,h;l&&(u=i.startOf(u,l)),u=Ct(u),u=this.skipHiddenDays(u,t),h=u;do h=is(h,1),this.isHiddenDay(h)||(c+=1);while(c<s);return{start:u,end:h}}buildCustomVisibleRange(e){let{props:t}=this,s=t.visibleRangeInput,i=typeof s=="function"?s.call(t.calendarApi,t.dateEnv.toDate(e)):s,l=this.refineRange(i);return l&&(l.start==null||l.end==null)?null:l}buildRenderRange(e,t,s){return e}buildDateIncrement(e){let{dateIncrement:t}=this.props,s;return t||((s=this.props.dateAlignment)?ot(1,s):e||ot({days:1}))}refineRange(e){if(e){let t=$k(e,this.props.dateEnv);return t&&(t=_A(t)),t}return null}initHiddenDays(){let e=this.props.hiddenDays||[],t=[],s=0,i;for(this.props.weekends===!1&&e.push(0,6),i=0;i<7;i+=1)(t[i]=e.indexOf(i)!==-1)||(s+=1);if(!s)throw new Error("invalid hiddenDays");this.isHiddenDayHash=t}trimHiddenDays(e){let{start:t,end:s}=e;return t&&(t=this.skipHiddenDays(t)),s&&(s=this.skipHiddenDays(s,-1,!0)),t==null||s==null||t<s?{start:t,end:s}:null}isHiddenDay(e){return e instanceof Date&&(e=e.getUTCDay()),this.isHiddenDayHash[e]}skipHiddenDays(e,t=1,s=!1){for(;this.isHiddenDayHash[(e.getUTCDay()+(s?t:0)+7)%7];)e=is(e,t);return e}}function dg(n,e,t,s){return{instanceId:Wi(),defId:n,range:e,forcedStartTzo:t??null,forcedEndTzo:s??null}}function Yk(n,e,t,s){for(let i=0;i<s.length;i+=1){let l=s[i].parse(n,t);if(l){let{allDay:c}=n;return c==null&&(c=e,c==null&&(c=l.allDayGuess,c==null&&(c=!1))),{allDay:c,duration:l.duration,typeData:l.typeData,typeId:i}}}return null}function qi(n,e,t){let{dateEnv:s,pluginHooks:i,options:l}=t,{defs:c,instances:u}=n;u=Vi(u,h=>!c[h.defId].recurringDef);for(let h in c){let m=c[h];if(m.recurringDef){let{duration:p}=m.recurringDef;p||(p=m.allDay?l.defaultAllDayEventDuration:l.defaultTimedEventDuration);let x=Wk(m,p,e,s,i.recurringTypes);for(let y of x){let v=dg(h,{start:y,end:s.add(y,p)});u[v.instanceId]=v}}}return{defs:c,instances:u}}function Wk(n,e,t,s,i){let c=i[n.recurringDef.typeId].expand(n.recurringDef.typeData,{start:s.subtract(t.start,e),end:t.end},s);return n.allDay&&(c=c.map(Ct)),c}const Bd={id:String,groupId:String,title:String,url:String,interactive:Boolean},TA={start:ie,end:ie,date:ie,allDay:Boolean},Xk=Object.assign(Object.assign(Object.assign({},Bd),TA),{extendedProps:ie});function DA(n,e,t,s,i=ug(t),l,c){let{refined:u,extra:h}=RA(n,t,i),m=Zk(e,t),p=Yk(u,m,t.dateEnv,t.pluginHooks.recurringTypes);if(p){let y=up(u,h,e?e.sourceId:"",p.allDay,!!p.duration,t,l);return y.recurringDef={typeId:p.typeId,typeData:p.typeData,duration:p.duration},{def:y,instance:null}}let x=Qk(u,m,t,s);if(x){let y=up(u,h,e?e.sourceId:"",x.allDay,x.hasEnd,t,l),v=dg(y.defId,x.range,x.forcedStartTzo,x.forcedEndTzo);return c&&y.publicId&&c[y.publicId]&&(v.instanceId=c[y.publicId]),{def:y,instance:v}}return null}function RA(n,e,t=ug(e)){return ig(n,t)}function ug(n){return Object.assign(Object.assign(Object.assign({},au),Xk),n.pluginHooks.eventRefiners)}function up(n,e,t,s,i,l,c){let u={title:n.title||"",groupId:n.groupId||"",publicId:n.id||"",url:n.url||"",recurringDef:null,defId:(c&&n.id?c[n.id]:"")||Wi(),sourceId:t,allDay:s,hasEnd:i,interactive:n.interactive,ui:iu(n,l),extendedProps:Object.assign(Object.assign({},n.extendedProps||{}),e)};for(let h of l.pluginHooks.eventDefMemberAdders)Object.assign(u,h(n));return Object.freeze(u.ui.classNames),Object.freeze(u.extendedProps),u}function Qk(n,e,t,s){let{allDay:i}=n,l,c=null,u=!1,h,m=null,p=n.start!=null?n.start:n.date;if(l=t.dateEnv.createMarkerMeta(p),l)c=l.marker;else if(!s)return null;return n.end!=null&&(h=t.dateEnv.createMarkerMeta(n.end)),i==null&&(e!=null?i=e:i=(!l||l.isTimeUnspecified)&&(!h||h.isTimeUnspecified)),i&&c&&(c=Ct(c)),h&&(m=h.marker,i&&(m=Ct(m)),c&&m<=c&&(m=null)),m?u=!0:s||(u=t.options.forceEventDuration||!1,m=t.dateEnv.add(c,i?t.options.defaultAllDayEventDuration:t.options.defaultTimedEventDuration)),{allDay:i,hasEnd:u,range:{start:c,end:m},forcedStartTzo:l?l.forcedTzo:null,forcedEndTzo:h?h.forcedTzo:null}}function Zk(n,e){let t=null;return n&&(t=n.defaultAllDay),t==null&&(t=e.options.defaultAllDay),t}function Oo(n,e,t,s,i,l){let c=Sn(),u=ug(t);for(let h of n){let m=DA(h,e,t,s,u,i,l);m&&hp(m,c)}return c}function hp(n,e=Sn()){return e.defs[n.def.defId]=n.def,n.instance&&(e.instances[n.instance.instanceId]=n.instance),e}function hg(n,e){let t=n.instances[e];if(t){let s=n.defs[t.defId],i=Du(n,l=>Kk(s,l));return i.defs[s.defId]=s,i.instances[t.instanceId]=t,i}return Sn()}function Kk(n,e){return!!(n.groupId&&n.groupId===e.groupId)}function Sn(){return{defs:{},instances:{}}}function fg(n,e){return{defs:Object.assign(Object.assign({},n.defs),e.defs),instances:Object.assign(Object.assign({},n.instances),e.instances)}}function Du(n,e){let t=Vi(n.defs,e),s=Vi(n.instances,i=>t[i.defId]);return{defs:t,instances:s}}function Jk(n,e){let{defs:t,instances:s}=n,i={},l={};for(let c in t)e.defs[c]||(i[c]=t[c]);for(let c in s)!e.instances[c]&&i[s[c].defId]&&(l[c]=s[c]);return{defs:i,instances:l}}function eM(n,e){return Array.isArray(n)?Oo(n,null,e,!0):typeof n=="object"&&n?Oo([n],null,e,!0):n!=null?String(n):null}function Fv(n){return Array.isArray(n)?n:typeof n=="string"?n.split(/\s+/):[]}const au={display:String,editable:Boolean,startEditable:Boolean,durationEditable:Boolean,constraint:ie,overlap:ie,allow:ie,className:Fv,classNames:Fv,color:String,backgroundColor:String,borderColor:String,textColor:String},tM={display:null,startEditable:null,durationEditable:null,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]};function iu(n,e){let t=eM(n.constraint,e);return{display:n.display||null,startEditable:n.startEditable!=null?n.startEditable:n.editable,durationEditable:n.durationEditable!=null?n.durationEditable:n.editable,constraints:t!=null?[t]:[],overlap:n.overlap!=null?n.overlap:null,allows:n.allow!=null?[n.allow]:[],backgroundColor:n.backgroundColor||n.color||"",borderColor:n.borderColor||n.color||"",textColor:n.textColor||"",classNames:(n.className||[]).concat(n.classNames||[])}}function sM(n){return n.reduce(nM,tM)}function nM(n,e){return{display:e.display!=null?e.display:n.display,startEditable:e.startEditable!=null?e.startEditable:n.startEditable,durationEditable:e.durationEditable!=null?e.durationEditable:n.durationEditable,constraints:n.constraints.concat(e.constraints),overlap:typeof e.overlap=="boolean"?e.overlap:n.overlap,allows:n.allows.concat(e.allows),backgroundColor:e.backgroundColor||n.backgroundColor,borderColor:e.borderColor||n.borderColor,textColor:e.textColor||n.textColor,classNames:n.classNames.concat(e.classNames)}}const aM={id:String,defaultAllDay:Boolean,url:String,format:String,events:ie,eventDataTransform:ie,success:ie,failure:ie};function kA(n,e,t=MA(e)){let s;if(typeof n=="string"?s={url:n}:typeof n=="function"||Array.isArray(n)?s={events:n}:typeof n=="object"&&n&&(s=n),s){let{refined:i,extra:l}=ig(s,t),c=iM(i,e);if(c)return{_raw:n,isFetching:!1,latestFetchId:"",fetchRange:null,defaultAllDay:i.defaultAllDay,eventDataTransform:i.eventDataTransform,success:i.success,failure:i.failure,publicId:i.id||"",sourceId:Wi(),sourceDefId:c.sourceDefId,meta:c.meta,ui:iu(i,e),extendedProps:l}}return null}function MA(n){return Object.assign(Object.assign(Object.assign({},au),aM),n.pluginHooks.eventSourceRefiners)}function iM(n,e){let t=e.pluginHooks.eventSourceDefs;for(let s=t.length-1;s>=0;s-=1){let l=t[s].parseMeta(n);if(l)return{sourceDefId:s,meta:l}}return null}function rM(n,e,t,s,i){switch(e.type){case"RECEIVE_EVENTS":return lM(n,t[e.sourceId],e.fetchId,e.fetchRange,e.rawEvents,i);case"RESET_RAW_EVENTS":return oM(n,t[e.sourceId],e.rawEvents,s.activeRange,i);case"ADD_EVENTS":return cM(n,e.eventStore,s?s.activeRange:null,i);case"RESET_EVENTS":return e.eventStore;case"MERGE_EVENTS":return fg(n,e.eventStore);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return s?qi(n,s.activeRange,i):n;case"REMOVE_EVENTS":return Jk(n,e.eventStore);case"REMOVE_EVENT_SOURCE":return OA(n,e.sourceId);case"REMOVE_ALL_EVENT_SOURCES":return Du(n,l=>!l.sourceId);case"REMOVE_ALL_EVENTS":return Sn();default:return n}}function lM(n,e,t,s,i,l){if(e&&t===e.latestFetchId){let c=Oo(LA(i,e,l),e,l);return s&&(c=qi(c,s,l)),fg(OA(n,e.sourceId),c)}return n}function oM(n,e,t,s,i){const{defIdMap:l,instanceIdMap:c}=uM(n);let u=Oo(LA(t,e,i),e,i,!1,l,c);return qi(u,s,i)}function LA(n,e,t){let s=t.options.eventDataTransform,i=e?e.eventDataTransform:null;return i&&(n=Uv(n,i)),s&&(n=Uv(n,s)),n}function Uv(n,e){let t;if(!e)t=n;else{t=[];for(let s of n){let i=e(s);i?t.push(i):i==null&&t.push(s)}}return t}function cM(n,e,t,s){return t&&(e=qi(e,t,s)),fg(n,e)}function $v(n,e,t){let{defs:s}=n,i=Xi(n.instances,l=>s[l.defId].allDay?l:Object.assign(Object.assign({},l),{range:{start:t.createMarker(e.toDate(l.range.start,l.forcedStartTzo)),end:t.createMarker(e.toDate(l.range.end,l.forcedEndTzo))},forcedStartTzo:t.canComputeOffset?null:l.forcedStartTzo,forcedEndTzo:t.canComputeOffset?null:l.forcedEndTzo}));return{defs:s,instances:i}}function OA(n,e){return Du(n,t=>t.sourceId!==e)}function dM(n,e){return{defs:n.defs,instances:Vi(n.instances,t=>!e[t.instanceId])}}function uM(n){const{defs:e,instances:t}=n,s={},i={};for(let l in e){const c=e[l],{publicId:u}=c;u&&(s[u]=l)}for(let l in t){const c=t[l],u=e[c.defId],{publicId:h}=u;h&&(i[h]=l)}return{defIdMap:s,instanceIdMap:i}}class Ru{constructor(){this.handlers={},this.thisContext=null}setThisContext(e){this.thisContext=e}setOptions(e){this.options=e}on(e,t){hM(this.handlers,e,t)}off(e,t){fM(this.handlers,e,t)}trigger(e,...t){let s=this.handlers[e]||[],i=this.options&&this.options[e],l=[].concat(i||[],s);for(let c of l)c.apply(this.thisContext,t)}hasHandlers(e){return!!(this.handlers[e]&&this.handlers[e].length||this.options&&this.options[e])}}function hM(n,e,t){(n[e]||(n[e]=[])).push(t)}function fM(n,e,t){t?n[e]&&(n[e]=n[e].filter(s=>s!==t)):delete n[e]}const mM={startTime:"09:00",endTime:"17:00",daysOfWeek:[1,2,3,4,5],display:"inverse-background",classNames:"fc-non-business",groupId:"_businessHours"};function pM(n,e){return Oo(gM(n),null,e)}function gM(n){let e;return n===!0?e=[{}]:Array.isArray(n)?e=n.filter(t=>t.daysOfWeek):typeof n=="object"&&n?e=[n]:e=[],e=e.map(t=>Object.assign(Object.assign({},mM),t)),e}function PA(n,e,t){t.emitter.trigger("select",Object.assign(Object.assign({},mg(n,t)),{jsEvent:e?e.origEvent:null,view:t.viewApi||t.calendarApi.view}))}function xM(n,e){e.emitter.trigger("unselect",{jsEvent:n?n.origEvent:null,view:e.viewApi||e.calendarApi.view})}function mg(n,e){let t={};for(let s of e.pluginHooks.dateSpanTransforms)Object.assign(t,s(n,e));return Object.assign(t,kM(n,e.dateEnv)),t}function Vv(n,e,t){let{dateEnv:s,options:i}=t,l=e;return n?(l=Ct(l),l=s.add(l,i.defaultAllDayEventDuration)):l=s.add(l,i.defaultTimedEventDuration),l}function pg(n,e,t,s){let i=ru(n.defs,e),l=Sn();for(let c in n.defs){let u=n.defs[c];l.defs[c]=yM(u,i[c],t,s)}for(let c in n.instances){let u=n.instances[c],h=l.defs[u.defId];l.instances[c]=bM(u,h,i[u.defId],t,s)}return l}function yM(n,e,t,s){let i=t.standardProps||{};i.hasEnd==null&&e.durationEditable&&(t.startDelta||t.endDelta)&&(i.hasEnd=!0);let l=Object.assign(Object.assign(Object.assign({},n),i),{ui:Object.assign(Object.assign({},n.ui),i.ui)});t.extendedProps&&(l.extendedProps=Object.assign(Object.assign({},l.extendedProps),t.extendedProps));for(let c of s.pluginHooks.eventDefMutationAppliers)c(l,t,s);return!l.hasEnd&&s.options.forceEventDuration&&(l.hasEnd=!0),l}function bM(n,e,t,s,i){let{dateEnv:l}=i,c=s.standardProps&&s.standardProps.allDay===!0,u=s.standardProps&&s.standardProps.hasEnd===!1,h=Object.assign({},n);return c&&(h.range=EA(h.range)),s.datesDelta&&t.startEditable&&(h.range={start:l.add(h.range.start,s.datesDelta),end:l.add(h.range.end,s.datesDelta)}),s.startDelta&&t.durationEditable&&(h.range={start:l.add(h.range.start,s.startDelta),end:h.range.end}),s.endDelta&&t.durationEditable&&(h.range={start:h.range.start,end:l.add(h.range.end,s.endDelta)}),u&&(h.range={start:h.range.start,end:Vv(e.allDay,h.range.start,i)}),e.allDay&&(h.range={start:Ct(h.range.start),end:Ct(h.range.end)}),h.range.end<h.range.start&&(h.range.end=Vv(e.allDay,h.range.start,i)),h}class Ur{constructor(e,t){this.context=e,this.internalEventSource=t}remove(){this.context.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:this.internalEventSource.sourceId})}refetch(){this.context.dispatch({type:"FETCH_EVENT_SOURCES",sourceIds:[this.internalEventSource.sourceId],isRefetch:!0})}get id(){return this.internalEventSource.publicId}get url(){return this.internalEventSource.meta.url}get format(){return this.internalEventSource.meta.format}}class Tt{constructor(e,t,s){this._context=e,this._def=t,this._instance=s||null}setProp(e,t){if(e in TA)console.warn("Could not set date-related prop 'name'. Use one of the date-related methods instead.");else if(e==="id")t=Bd[e](t),this.mutate({standardProps:{publicId:t}});else if(e in Bd)t=Bd[e](t),this.mutate({standardProps:{[e]:t}});else if(e in au){let s=au[e](t);e==="color"?s={backgroundColor:t,borderColor:t}:e==="editable"?s={startEditable:t,durationEditable:t}:s={[e]:t},this.mutate({standardProps:{ui:s}})}else console.warn(`Could not set prop '${e}'. Use setExtendedProp instead.`)}setExtendedProp(e,t){this.mutate({extendedProps:{[e]:t}})}setStart(e,t={}){let{dateEnv:s}=this._context,i=s.createMarker(e);if(i&&this._instance){let l=this._instance.range,c=Gr(l.start,i,s,t.granularity);t.maintainDuration?this.mutate({datesDelta:c}):this.mutate({startDelta:c})}}setEnd(e,t={}){let{dateEnv:s}=this._context,i;if(!(e!=null&&(i=s.createMarker(e),!i))&&this._instance)if(i){let l=Gr(this._instance.range.end,i,s,t.granularity);this.mutate({endDelta:l})}else this.mutate({standardProps:{hasEnd:!1}})}setDates(e,t,s={}){let{dateEnv:i}=this._context,l={allDay:s.allDay},c=i.createMarker(e),u;if(c&&!(t!=null&&(u=i.createMarker(t),!u))&&this._instance){let h=this._instance.range;s.allDay===!0&&(h=EA(h));let m=Gr(h.start,c,i,s.granularity);if(u){let p=Gr(h.end,u,i,s.granularity);VR(m,p)?this.mutate({datesDelta:m,standardProps:l}):this.mutate({startDelta:m,endDelta:p,standardProps:l})}else l.hasEnd=!1,this.mutate({datesDelta:m,standardProps:l})}}moveStart(e){let t=ot(e);t&&this.mutate({startDelta:t})}moveEnd(e){let t=ot(e);t&&this.mutate({endDelta:t})}moveDates(e){let t=ot(e);t&&this.mutate({datesDelta:t})}setAllDay(e,t={}){let s={allDay:e},{maintainDuration:i}=t;i==null&&(i=this._context.options.allDayMaintainDuration),this._def.allDay!==e&&(s.hasEnd=i),this.mutate({standardProps:s})}formatRange(e){let{dateEnv:t}=this._context,s=this._instance,i=as(e);return this._def.hasEnd?t.formatRange(s.range.start,s.range.end,i,{forcedStartTzo:s.forcedStartTzo,forcedEndTzo:s.forcedEndTzo}):t.format(s.range.start,i,{forcedTzo:s.forcedStartTzo})}mutate(e){let t=this._instance;if(t){let s=this._def,i=this._context,{eventStore:l}=i.getCurrentData(),c=hg(l,t.instanceId);c=pg(c,{"":{display:"",startEditable:!0,durationEditable:!0,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]}},e,i);let h=new Tt(i,s,t);this._def=c.defs[s.defId],this._instance=c.instances[t.instanceId],i.dispatch({type:"MERGE_EVENTS",eventStore:c}),i.emitter.trigger("eventChange",{oldEvent:h,event:this,relatedEvents:Hi(c,i,t),revert(){i.dispatch({type:"RESET_EVENTS",eventStore:l})}})}}remove(){let e=this._context,t=IA(this);e.dispatch({type:"REMOVE_EVENTS",eventStore:t}),e.emitter.trigger("eventRemove",{event:this,relatedEvents:[],revert(){e.dispatch({type:"MERGE_EVENTS",eventStore:t})}})}get source(){let{sourceId:e}=this._def;return e?new Ur(this._context,this._context.getCurrentData().eventSources[e]):null}get start(){return this._instance?this._context.dateEnv.toDate(this._instance.range.start):null}get end(){return this._instance&&this._def.hasEnd?this._context.dateEnv.toDate(this._instance.range.end):null}get startStr(){let e=this._instance;return e?this._context.dateEnv.formatIso(e.range.start,{omitTime:this._def.allDay,forcedTzo:e.forcedStartTzo}):""}get endStr(){let e=this._instance;return e&&this._def.hasEnd?this._context.dateEnv.formatIso(e.range.end,{omitTime:this._def.allDay,forcedTzo:e.forcedEndTzo}):""}get id(){return this._def.publicId}get groupId(){return this._def.groupId}get allDay(){return this._def.allDay}get title(){return this._def.title}get url(){return this._def.url}get display(){return this._def.ui.display||"auto"}get startEditable(){return this._def.ui.startEditable}get durationEditable(){return this._def.ui.durationEditable}get constraint(){return this._def.ui.constraints[0]||null}get overlap(){return this._def.ui.overlap}get allow(){return this._def.ui.allows[0]||null}get backgroundColor(){return this._def.ui.backgroundColor}get borderColor(){return this._def.ui.borderColor}get textColor(){return this._def.ui.textColor}get classNames(){return this._def.ui.classNames}get extendedProps(){return this._def.extendedProps}toPlainObject(e={}){let t=this._def,{ui:s}=t,{startStr:i,endStr:l}=this,c={allDay:t.allDay};return t.title&&(c.title=t.title),i&&(c.start=i),l&&(c.end=l),t.publicId&&(c.id=t.publicId),t.groupId&&(c.groupId=t.groupId),t.url&&(c.url=t.url),s.display&&s.display!=="auto"&&(c.display=s.display),e.collapseColor&&s.backgroundColor&&s.backgroundColor===s.borderColor?c.color=s.backgroundColor:(s.backgroundColor&&(c.backgroundColor=s.backgroundColor),s.borderColor&&(c.borderColor=s.borderColor)),s.textColor&&(c.textColor=s.textColor),s.classNames.length&&(c.classNames=s.classNames),Object.keys(t.extendedProps).length&&(e.collapseExtendedProps?Object.assign(c,t.extendedProps):c.extendedProps=t.extendedProps),c}toJSON(){return this.toPlainObject()}}function IA(n){let e=n._def,t=n._instance;return{defs:{[e.defId]:e},instances:t?{[t.instanceId]:t}:{}}}function Hi(n,e,t){let{defs:s,instances:i}=n,l=[],c=t?t.instanceId:"";for(let u in i){let h=i[u],m=s[h.defId];h.instanceId!==c&&l.push(new Tt(e,m,h))}return l}function qv(n,e,t,s){let i={},l={},c={},u=[],h=[],m=ru(n.defs,e);for(let p in n.defs){let x=n.defs[p];m[x.defId].display==="inverse-background"&&(x.groupId?(i[x.groupId]=[],c[x.groupId]||(c[x.groupId]=x)):l[p]=[])}for(let p in n.instances){let x=n.instances[p],y=n.defs[x.defId],v=m[y.defId],w=x.range,A=!y.allDay&&s?_A(w,s):w,N=el(A,t);N&&(v.display==="inverse-background"?y.groupId?i[y.groupId].push(N):l[x.defId].push(N):v.display!=="none"&&(v.display==="background"?u:h).push({def:y,ui:v,instance:x,range:N,isStart:A.start&&A.start.valueOf()===N.start.valueOf(),isEnd:A.end&&A.end.valueOf()===N.end.valueOf()}))}for(let p in i){let x=i[p],y=zv(x,t);for(let v of y){let w=c[p],A=m[w.defId];u.push({def:w,ui:A,instance:null,range:v,isStart:!1,isEnd:!1})}}for(let p in l){let x=l[p],y=zv(x,t);for(let v of y)u.push({def:n.defs[p],ui:m[p],instance:null,range:v,isStart:!1,isEnd:!1})}return{bg:u,fg:h}}function Gv(n,e){n.fcSeg=e}function tl(n){return n.fcSeg||n.parentNode.fcSeg||null}function ru(n,e){return Xi(n,t=>BA(t,e))}function BA(n,e){let t=[];return e[""]&&t.push(e[""]),e[n.defId]&&t.push(e[n.defId]),t.push(n.ui),sM(t)}function vM(n,e){let t=n.map(wM);return t.sort((s,i)=>IR(s,i,e)),t.map(s=>s._seg)}function wM(n){let{eventRange:e}=n,t=e.def,s=e.instance?e.instance.range:e.range,i=s.start?s.start.valueOf():0,l=s.end?s.end.valueOf():0;return Object.assign(Object.assign(Object.assign({},t.extendedProps),t),{id:t.publicId,start:i,end:l,duration:l-i,allDay:Number(t.allDay),_seg:n})}function AM(n,e){let{pluginHooks:t}=e,s=t.isDraggableTransformers,{def:i,ui:l}=n.eventRange,c=l.startEditable;for(let u of s)c=u(c,i,l,e);return c}function NM(n,e){return n.isStart&&n.eventRange.ui.durationEditable&&e.options.eventResizableFromStart}function jM(n,e){return n.isEnd&&n.eventRange.ui.durationEditable}function HA(n,e,t,s,i,l,c){let{dateEnv:u,options:h}=t,{displayEventTime:m,displayEventEnd:p}=h,x=n.eventRange.def,y=n.eventRange.instance;m==null&&(m=s!==!1),p==null&&(p=i!==!1);let v=y.range.start,w=y.range.end,A=n.start||n.eventRange.range.start,N=n.end||n.eventRange.range.end,j=Ct(v).valueOf()===Ct(A).valueOf(),_=Ct(si(w,-1)).valueOf()===Ct(si(N,-1)).valueOf();return m&&!x.allDay&&(j||_)?(A=j?v:A,N=_?w:N,p&&x.hasEnd?u.formatRange(A,N,e,{forcedStartTzo:y.forcedStartTzo,forcedEndTzo:y.forcedEndTzo}):u.format(A,e,{forcedTzo:y.forcedStartTzo})):""}function jo(n,e,t){let s=n.eventRange.range;return{isPast:s.end<=e.start,isFuture:s.start>=e.end,isToday:e&&Ka(e,s.start)}}function SM(n){let e=["fc-event"];return n.isMirror&&e.push("fc-event-mirror"),n.isDraggable&&e.push("fc-event-draggable"),(n.isStartResizable||n.isEndResizable)&&e.push("fc-event-resizable"),n.isDragging&&e.push("fc-event-dragging"),n.isResizing&&e.push("fc-event-resizing"),n.isSelected&&e.push("fc-event-selected"),n.isStart&&e.push("fc-event-start"),n.isEnd&&e.push("fc-event-end"),n.isPast&&e.push("fc-event-past"),n.isToday&&e.push("fc-event-today"),n.isFuture&&e.push("fc-event-future"),e}function EM(n){return n.instance?n.instance.instanceId:`${n.def.defId}:${n.range.start.toISOString()}`}function zA(n,e){let{def:t,instance:s}=n.eventRange,{url:i}=t;if(i)return{href:i};let{emitter:l,options:c}=e,{eventInteractive:u}=c;return u==null&&(u=t.interactive,u==null&&(u=!!l.hasHandlers("eventClick"))),u?yA(h=>{l.trigger("eventClick",{el:h.target,event:new Tt(e,t,s),jsEvent:h,view:e.viewApi})}):{}}const _M={start:ie,end:ie,allDay:Boolean};function CM(n,e,t){let s=TM(n,e),{range:i}=s;if(!i.start)return null;if(!i.end){if(t==null)return null;i.end=e.add(i.start,t)}return s}function TM(n,e){let{refined:t,extra:s}=ig(n,_M),i=t.start?e.createMarkerMeta(t.start):null,l=t.end?e.createMarkerMeta(t.end):null,{allDay:c}=t;return c==null&&(c=i&&i.isTimeUnspecified&&(!l||l.isTimeUnspecified)),Object.assign({range:{start:i?i.marker:null,end:l?l.marker:null},allDay:c},s)}function DM(n,e){return qk(n.range,e.range)&&n.allDay===e.allDay&&RM(n,e)}function RM(n,e){for(let t in e)if(t!=="range"&&t!=="allDay"&&n[t]!==e[t])return!1;for(let t in n)if(!(t in e))return!1;return!0}function kM(n,e){return Object.assign(Object.assign({},UA(n.range,e,n.allDay)),{allDay:n.allDay})}function FA(n,e,t){return Object.assign(Object.assign({},UA(n,e,t)),{timeZone:e.timeZone})}function UA(n,e,t){return{start:e.toDate(n.start),end:e.toDate(n.end),startStr:e.formatIso(n.start,{omitTime:t}),endStr:e.formatIso(n.end,{omitTime:t})}}function MM(n,e,t){let s=RA({editable:!1},t),i=up(s.refined,s.extra,"",n.allDay,!0,t);return{def:i,ui:BA(i,e),instance:dg(i.defId,n.range),range:n.range,isStart:!0,isEnd:!0}}function LM(n,e,t){let s=!1,i=function(u){s||(s=!0,e(u))},l=function(u){s||(s=!0,t(u))},c=n(i,l);c&&typeof c.then=="function"&&c.then(i,l)}class Yv extends Error{constructor(e,t){super(e),this.response=t}}function OM(n,e,t){n=n.toUpperCase();const s={method:n};return n==="GET"?e+=(e.indexOf("?")===-1?"?":"&")+new URLSearchParams(t):(s.body=new URLSearchParams(t),s.headers={"Content-Type":"application/x-www-form-urlencoded"}),fetch(e,s).then(i=>{if(i.ok)return i.json().then(l=>[l,i],()=>{throw new Yv("Failure parsing JSON",i)});throw new Yv("Request failed",i)})}let Dm;function $A(){return Dm==null&&(Dm=PM()),Dm}function PM(){if(typeof document>"u")return!0;let n=document.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.innerHTML="<table><tr><td><div></div></td></tr></table>",n.querySelector("table").style.height="100px",n.querySelector("div").style.height="100%",document.body.appendChild(n);let t=n.querySelector("div").offsetHeight>0;return document.body.removeChild(n),t}class IM extends Lt{constructor(){super(...arguments),this.state={forPrint:!1},this.handleBeforePrint=()=>{nu(()=>{this.setState({forPrint:!0})})},this.handleAfterPrint=()=>{nu(()=>{this.setState({forPrint:!1})})}}render(){let{props:e}=this,{options:t}=e,{forPrint:s}=this.state,i=s||t.height==="auto"||t.contentHeight==="auto",l=!i&&t.height!=null?t.height:"",c=["fc",s?"fc-media-print":"fc-media-screen",`fc-direction-${t.direction}`,e.theme.getClass("root")];return $A()||c.push("fc-liquid-hack"),e.children(c,l,i,s)}componentDidMount(){let{emitter:e}=this.props;e.on("_beforeprint",this.handleBeforePrint),e.on("_afterprint",this.handleAfterPrint)}componentWillUnmount(){let{emitter:e}=this.props;e.off("_beforeprint",this.handleBeforePrint),e.off("_afterprint",this.handleAfterPrint)}}class cl{constructor(e){this.component=e.component,this.isHitComboAllowed=e.isHitComboAllowed||null}destroy(){}}function BM(n,e){return{component:n,el:e.el,useEventCenter:e.useEventCenter!=null?e.useEventCenter:!0,isHitComboAllowed:e.isHitComboAllowed||null}}function gg(n){return{[n.component.uid]:n}}const fp={};class ku extends en{constructor(e,t){super(e,t),this.handleRefresh=()=>{let s=this.computeTiming();s.state.nowDate.valueOf()!==this.state.nowDate.valueOf()&&this.setState(s.state),this.clearTimeout(),this.setTimeout(s.waitMs)},this.handleVisibilityChange=()=>{document.hidden||this.handleRefresh()},this.state=this.computeTiming().state}render(){let{props:e,state:t}=this;return e.children(t.nowDate,t.todayRange)}componentDidMount(){this.setTimeout(),this.context.nowManager.addResetListener(this.handleRefresh),document.addEventListener("visibilitychange",this.handleVisibilityChange)}componentDidUpdate(e){e.unit!==this.props.unit&&(this.clearTimeout(),this.setTimeout())}componentWillUnmount(){this.clearTimeout(),this.context.nowManager.removeResetListener(this.handleRefresh),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}computeTiming(){let{props:e,context:t}=this,s=t.nowManager.getDateMarker(),{nowIndicatorSnap:i}=t.options;i==="auto"&&(i=/year|month|week|day/.test(e.unit)||(e.unitValue||1)===1);let l,c;return i?(l=t.dateEnv.startOf(s,e.unit),c=t.dateEnv.add(l,ot(1,e.unit)).valueOf()-s.valueOf()):(l=s,c=1e3*60),c=Math.min(1e3*60*60*24,c),{state:{nowDate:l,todayRange:HM(l)},waitMs:c}}setTimeout(e=this.computeTiming().waitMs){this.timeoutId=setTimeout(()=>{const t=this.computeTiming();this.setState(t.state,()=>{this.setTimeout(t.waitMs)})},e)}clearTimeout(){this.timeoutId&&clearTimeout(this.timeoutId)}}ku.contextType=Qi;function HM(n){let e=Ct(n),t=is(e,1);return{start:e,end:t}}class zM{getCurrentData(){return this.currentDataManager.getCurrentData()}dispatch(e){this.currentDataManager.dispatch(e)}get view(){return this.getCurrentData().viewApi}batchRendering(e){e()}updateSize(){this.trigger("_resize",!0)}setOption(e,t){this.dispatch({type:"SET_OPTION",optionName:e,rawOptionValue:t})}getOption(e){return this.currentDataManager.currentCalendarOptionsInput[e]}getAvailableLocaleCodes(){return Object.keys(this.getCurrentData().availableRawLocales)}on(e,t){let{currentDataManager:s}=this;s.currentCalendarOptionsRefiners[e]?s.emitter.on(e,t):console.warn(`Unknown listener name '${e}'`)}off(e,t){this.currentDataManager.emitter.off(e,t)}trigger(e,...t){this.currentDataManager.emitter.trigger(e,...t)}changeView(e,t){this.batchRendering(()=>{if(this.unselect(),t)if(t.start&&t.end)this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e}),this.dispatch({type:"SET_OPTION",optionName:"visibleRange",rawOptionValue:t});else{let{dateEnv:s}=this.getCurrentData();this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e,dateMarker:s.createMarker(t)})}else this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e})})}zoomTo(e,t){let s=this.getCurrentData(),i;t=t||"day",i=s.viewSpecs[t]||this.getUnitViewSpec(t),this.unselect(),i?this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:i.type,dateMarker:e}):this.dispatch({type:"CHANGE_DATE",dateMarker:e})}getUnitViewSpec(e){let{viewSpecs:t,toolbarConfig:s}=this.getCurrentData(),i=[].concat(s.header?s.header.viewsWithButtons:[],s.footer?s.footer.viewsWithButtons:[]),l,c;for(let u in t)i.push(u);for(l=0;l<i.length;l+=1)if(c=t[i[l]],c&&c.singleUnit===e)return c;return null}prev(){this.unselect(),this.dispatch({type:"PREV"})}next(){this.unselect(),this.dispatch({type:"NEXT"})}prevYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,-1)})}nextYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,1)})}today(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.nowManager.getDateMarker()})}gotoDate(e){let t=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.createMarker(e)})}incrementDate(e){let t=this.getCurrentData(),s=ot(e);s&&(this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.add(t.currentDate,s)}))}getDate(){let e=this.getCurrentData();return e.dateEnv.toDate(e.currentDate)}formatDate(e,t){let{dateEnv:s}=this.getCurrentData();return s.format(s.createMarker(e),as(t))}formatRange(e,t,s){let{dateEnv:i}=this.getCurrentData();return i.formatRange(i.createMarker(e),i.createMarker(t),as(s),s)}formatIso(e,t){let{dateEnv:s}=this.getCurrentData();return s.formatIso(s.createMarker(e),{omitTime:t})}select(e,t){let s;t==null?e.start!=null?s=e:s={start:e,end:null}:s={start:e,end:t};let i=this.getCurrentData(),l=CM(s,i.dateEnv,ot({days:1}));l&&(this.dispatch({type:"SELECT_DATES",selection:l}),PA(l,null,i))}unselect(e){let t=this.getCurrentData();t.dateSelection&&(this.dispatch({type:"UNSELECT_DATES"}),xM(e,t))}addEvent(e,t){if(e instanceof Tt){let c=e._def,u=e._instance;return this.getCurrentData().eventStore.defs[c.defId]||(this.dispatch({type:"ADD_EVENTS",eventStore:hp({def:c,instance:u})}),this.triggerEventAdd(e)),e}let s=this.getCurrentData(),i;if(t instanceof Ur)i=t.internalEventSource;else if(typeof t=="boolean")t&&([i]=lg(s.eventSources));else if(t!=null){let c=this.getEventSourceById(t);if(!c)return console.warn(`Could not find an event source with ID "${t}"`),null;i=c.internalEventSource}let l=DA(e,i,s,!1);if(l){let c=new Tt(s,l.def,l.def.recurringDef?null:l.instance);return this.dispatch({type:"ADD_EVENTS",eventStore:hp(l)}),this.triggerEventAdd(c),c}return null}triggerEventAdd(e){let{emitter:t}=this.getCurrentData();t.trigger("eventAdd",{event:e,relatedEvents:[],revert:()=>{this.dispatch({type:"REMOVE_EVENTS",eventStore:IA(e)})}})}getEventById(e){let t=this.getCurrentData(),{defs:s,instances:i}=t.eventStore;e=String(e);for(let l in s){let c=s[l];if(c.publicId===e){if(c.recurringDef)return new Tt(t,c,null);for(let u in i){let h=i[u];if(h.defId===c.defId)return new Tt(t,c,h)}}}return null}getEvents(){let e=this.getCurrentData();return Hi(e.eventStore,e)}removeAllEvents(){this.dispatch({type:"REMOVE_ALL_EVENTS"})}getEventSources(){let e=this.getCurrentData(),t=e.eventSources,s=[];for(let i in t)s.push(new Ur(e,t[i]));return s}getEventSourceById(e){let t=this.getCurrentData(),s=t.eventSources;e=String(e);for(let i in s)if(s[i].publicId===e)return new Ur(t,s[i]);return null}addEventSource(e){let t=this.getCurrentData();if(e instanceof Ur)return t.eventSources[e.internalEventSource.sourceId]||this.dispatch({type:"ADD_EVENT_SOURCES",sources:[e.internalEventSource]}),e;let s=kA(e,t);return s?(this.dispatch({type:"ADD_EVENT_SOURCES",sources:[s]}),new Ur(t,s)):null}removeAllEventSources(){this.dispatch({type:"REMOVE_ALL_EVENT_SOURCES"})}refetchEvents(){this.dispatch({type:"FETCH_EVENT_SOURCES",isRefetch:!0})}scrollToTime(e){let t=ot(e);t&&this.trigger("_scrollRequest",{time:t})}}function FM(n,e){return n.left>=e.left&&n.left<e.right&&n.top>=e.top&&n.top<e.bottom}function VA(n,e){let t={left:Math.max(n.left,e.left),right:Math.min(n.right,e.right),top:Math.max(n.top,e.top),bottom:Math.min(n.bottom,e.bottom)};return t.left<t.right&&t.top<t.bottom?t:!1}function UM(n,e){return{left:Math.min(Math.max(n.left,e.left),e.right),top:Math.min(Math.max(n.top,e.top),e.bottom)}}function $M(n){return{left:(n.left+n.right)/2,top:(n.top+n.bottom)/2}}function VM(n,e){return{left:n.left-e.left,top:n.top-e.top}}function qA(n,e,t,s){return{dow:n.getUTCDay(),isDisabled:!!(s&&(!s.activeRange||!Ka(s.activeRange,n))),isOther:!!(s&&!Ka(s.currentRange,n)),isToday:!!(e&&Ka(e,n)),isPast:!!(e&&n<e.start),isFuture:!!(e&&n>=e.end)}}function xg(n,e){let t=["fc-day",`fc-day-${WR[n.dow]}`];return n.isDisabled?t.push("fc-day-disabled"):(n.isToday&&(t.push("fc-day-today"),t.push(e.getClass("today"))),n.isPast&&t.push("fc-day-past"),n.isFuture&&t.push("fc-day-future"),n.isOther&&t.push("fc-day-other")),t}const qM=as({year:"numeric",month:"long",day:"numeric"}),GM=as({week:"long"});function mp(n,e,t="day",s=!0){const{dateEnv:i,options:l,calendarApi:c}=n;let u=i.format(e,t==="week"?GM:qM);if(l.navLinks){let h=i.toDate(e);const m=p=>{let x=t==="day"?l.navLinkDayClick:t==="week"?l.navLinkWeekClick:null;typeof x=="function"?x.call(c,i.toDate(e),p):(typeof x=="string"&&(t=x),c.zoomTo(e,t))};return Object.assign({title:Ao(l.navLinkHint,[u,h],u),"data-navlink":""},s?xA(m):{onClick:m})}return{"aria-label":u}}let Rm=null;function YM(){return Rm===null&&(Rm=WM()),Rm}function WM(){let n=document.createElement("div");wo(n,{position:"absolute",top:-1e3,left:0,border:0,padding:0,overflow:"scroll",direction:"rtl"}),n.innerHTML="<div></div>",document.body.appendChild(n);let t=n.firstChild.getBoundingClientRect().left>n.getBoundingClientRect().left;return eg(n),t}let km;function XM(){return km||(km=QM()),km}function QM(){let n=document.createElement("div");n.style.overflow="scroll",n.style.position="absolute",n.style.top="-9999px",n.style.left="-9999px",document.body.appendChild(n);let e=GA(n);return document.body.removeChild(n),e}function GA(n){return{x:n.offsetHeight-n.clientHeight,y:n.offsetWidth-n.clientWidth}}function ZM(n,e=!1){let t=window.getComputedStyle(n),s=parseInt(t.borderLeftWidth,10)||0,i=parseInt(t.borderRightWidth,10)||0,l=parseInt(t.borderTopWidth,10)||0,c=parseInt(t.borderBottomWidth,10)||0,u=GA(n),h=u.y-s-i,m=u.x-l-c,p={borderLeft:s,borderRight:i,borderTop:l,borderBottom:c,scrollbarBottom:m,scrollbarLeft:0,scrollbarRight:0};return YM()&&t.direction==="rtl"?p.scrollbarLeft=h:p.scrollbarRight=h,e&&(p.paddingLeft=parseInt(t.paddingLeft,10)||0,p.paddingRight=parseInt(t.paddingRight,10)||0,p.paddingTop=parseInt(t.paddingTop,10)||0,p.paddingBottom=parseInt(t.paddingBottom,10)||0),p}function KM(n,e=!1,t){let s=yg(n),i=ZM(n,e),l={left:s.left+i.borderLeft+i.scrollbarLeft,right:s.right-i.borderRight-i.scrollbarRight,top:s.top+i.borderTop,bottom:s.bottom-i.borderBottom-i.scrollbarBottom};return e&&(l.left+=i.paddingLeft,l.right-=i.paddingRight,l.top+=i.paddingTop,l.bottom-=i.paddingBottom),l}function yg(n){let e=n.getBoundingClientRect();return{left:e.left+window.scrollX,top:e.top+window.scrollY,right:e.right+window.scrollX,bottom:e.bottom+window.scrollY}}function JM(n){let e=YA(n),t=n.getBoundingClientRect();for(let s of e){let i=VA(t,s.getBoundingClientRect());if(i)t=i;else return null}return t}function YA(n){let e=[];for(;n instanceof HTMLElement;){let t=window.getComputedStyle(n);if(t.position==="fixed")break;/(auto|scroll)/.test(t.overflow+t.overflowY+t.overflowX)&&e.push(n),n=n.parentNode}return e}class lu{constructor(e,t,s,i){this.els=t;let l=this.originClientRect=e.getBoundingClientRect();s&&this.buildElHorizontals(l.left),i&&this.buildElVerticals(l.top)}buildElHorizontals(e){let t=[],s=[];for(let i of this.els){let l=i.getBoundingClientRect();t.push(l.left-e),s.push(l.right-e)}this.lefts=t,this.rights=s}buildElVerticals(e){let t=[],s=[];for(let i of this.els){let l=i.getBoundingClientRect();t.push(l.top-e),s.push(l.bottom-e)}this.tops=t,this.bottoms=s}leftToIndex(e){let{lefts:t,rights:s}=this,i=t.length,l;for(l=0;l<i;l+=1)if(e>=t[l]&&e<s[l])return l}topToIndex(e){let{tops:t,bottoms:s}=this,i=t.length,l;for(l=0;l<i;l+=1)if(e>=t[l]&&e<s[l])return l}getWidth(e){return this.rights[e]-this.lefts[e]}getHeight(e){return this.bottoms[e]-this.tops[e]}similarTo(e){return Ad(this.tops||[],e.tops||[])&&Ad(this.bottoms||[],e.bottoms||[])&&Ad(this.lefts||[],e.lefts||[])&&Ad(this.rights||[],e.rights||[])}}function Ad(n,e){const t=n.length;if(t!==e.length)return!1;for(let s=0;s<t;s++)if(Math.round(n[s])!==Math.round(e[s]))return!1;return!0}class bg{getMaxScrollTop(){return this.getScrollHeight()-this.getClientHeight()}getMaxScrollLeft(){return this.getScrollWidth()-this.getClientWidth()}canScrollVertically(){return this.getMaxScrollTop()>0}canScrollHorizontally(){return this.getMaxScrollLeft()>0}canScrollUp(){return this.getScrollTop()>0}canScrollDown(){return this.getScrollTop()<this.getMaxScrollTop()}canScrollLeft(){return this.getScrollLeft()>0}canScrollRight(){return this.getScrollLeft()<this.getMaxScrollLeft()}}class e4 extends bg{constructor(e){super(),this.el=e}getScrollTop(){return this.el.scrollTop}getScrollLeft(){return this.el.scrollLeft}setScrollTop(e){this.el.scrollTop=e}setScrollLeft(e){this.el.scrollLeft=e}getScrollWidth(){return this.el.scrollWidth}getScrollHeight(){return this.el.scrollHeight}getClientHeight(){return this.el.clientHeight}getClientWidth(){return this.el.clientWidth}}class t4 extends bg{getScrollTop(){return window.scrollY}getScrollLeft(){return window.scrollX}setScrollTop(e){window.scroll(window.scrollX,e)}setScrollLeft(e){window.scroll(e,window.scrollY)}getScrollWidth(){return document.documentElement.scrollWidth}getScrollHeight(){return document.documentElement.scrollHeight}getClientHeight(){return document.documentElement.clientHeight}getClientWidth(){return document.documentElement.clientWidth}}class Ki extends Lt{constructor(){super(...arguments),this.uid=Wi()}prepareHits(){}queryHit(e,t,s,i){return null}isValidSegDownEl(e){return!this.props.eventDrag&&!this.props.eventResize&&!vs(e,".fc-event-mirror")}isValidDateDownEl(e){return!vs(e,".fc-event:not(.fc-bg-event)")&&!vs(e,".fc-more-link")&&!vs(e,"a[data-navlink]")&&!vs(e,".fc-popover")}}class s4{constructor(e=t=>t.thickness||1){this.getEntryThickness=e,this.strictOrder=!1,this.allowReslicing=!1,this.maxCoord=-1,this.maxStackCnt=-1,this.levelCoords=[],this.entriesByLevel=[],this.stackCnts={}}addSegs(e){let t=[];for(let s of e)this.insertEntry(s,t);return t}insertEntry(e,t){let s=this.findInsertion(e);this.isInsertionValid(s,e)?this.insertEntryAt(e,s):this.handleInvalidInsertion(s,e,t)}isInsertionValid(e,t){return(this.maxCoord===-1||e.levelCoord+this.getEntryThickness(t)<=this.maxCoord)&&(this.maxStackCnt===-1||e.stackCnt<this.maxStackCnt)}handleInvalidInsertion(e,t,s){if(this.allowReslicing&&e.touchingEntry){const i=Object.assign(Object.assign({},t),{span:WA(t.span,e.touchingEntry.span)});s.push(i),this.splitEntry(t,e.touchingEntry,s)}else s.push(t)}splitEntry(e,t,s){let i=e.span,l=t.span;i.start<l.start&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:i.start,end:l.start}},s),i.end>l.end&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:l.end,end:i.end}},s)}insertEntryAt(e,t){let{entriesByLevel:s,levelCoords:i}=this;t.lateral===-1?(Mm(i,t.level,t.levelCoord),Mm(s,t.level,[e])):Mm(s[t.level],t.lateral,e),this.stackCnts[So(e)]=t.stackCnt}findInsertion(e){let{levelCoords:t,entriesByLevel:s,strictOrder:i,stackCnts:l}=this,c=t.length,u=0,h=-1,m=-1,p=null,x=0;for(let w=0;w<c;w+=1){const A=t[w];if(!i&&A>=u+this.getEntryThickness(e))break;let N=s[w],j,_=Xv(N,e.span.start,Wv),C=_[0]+_[1];for(;(j=N[C])&&j.span.start<e.span.end;){let k=A+this.getEntryThickness(j);k>u&&(u=k,p=j,h=w,m=C),k===u&&(x=Math.max(x,l[So(j)]+1)),C+=1}}let y=0;if(p)for(y=h+1;y<c&&t[y]<u;)y+=1;let v=-1;return y<c&&t[y]===u&&(v=Xv(s[y],e.span.end,Wv)[0]),{touchingLevel:h,touchingLateral:m,touchingEntry:p,stackCnt:x,levelCoord:u,level:y,lateral:v}}toRects(){let{entriesByLevel:e,levelCoords:t}=this,s=e.length,i=[];for(let l=0;l<s;l+=1){let c=e[l],u=t[l];for(let h of c)i.push(Object.assign(Object.assign({},h),{thickness:this.getEntryThickness(h),levelCoord:u}))}return i}}function Wv(n){return n.span.end}function So(n){return n.index+":"+n.span.start}function WA(n,e){let t=Math.max(n.start,e.start),s=Math.min(n.end,e.end);return t<s?{start:t,end:s}:null}function Mm(n,e,t){n.splice(e,0,t)}function Xv(n,e,t){let s=0,i=n.length;if(!i||e<t(n[s]))return[0,0];if(e>t(n[i-1]))return[i,0];for(;s<i;){let l=Math.floor(s+(i-s)/2),c=t(n[l]);if(e<c)i=l;else if(e>c)s=l+1;else return[l,1]}return[s,0]}class n4{constructor(e,t){this.emitter=new Ru}destroy(){}setMirrorIsVisible(e){}setMirrorNeedsRevert(e){}setAutoScrollEnabled(e){}}const vg={};function a4(n,e){return!n||e>10?as({weekday:"short"}):e>1?as({weekday:"short",month:"numeric",day:"numeric",omitCommas:!0}):as({weekday:"long"})}const XA="fc-col-header-cell";function QA(n){return n.text}class i4 extends Lt{render(){let{dateEnv:e,options:t,theme:s,viewApi:i}=this.context,{props:l}=this,{date:c,dateProfile:u}=l,h=qA(c,l.todayRange,null,u),m=[XA].concat(xg(h,s)),p=e.format(c,l.dayHeaderFormat),x=!h.isDisabled&&l.colCnt>1?mp(this.context,c):{},y=e.toDate(c);e.namedTimeZoneImpl&&(y=si(y,36e5));let v=Object.assign(Object.assign(Object.assign({date:y,view:i},l.extraRenderProps),{text:p}),h);return re(va,{elTag:"th",elClasses:m,elAttrs:Object.assign({role:"columnheader",colSpan:l.colSpan,"data-date":h.isDisabled?void 0:ng(c)},l.extraDataAttrs),renderProps:v,generatorName:"dayHeaderContent",customGenerator:t.dayHeaderContent,defaultGenerator:QA,classNameGenerator:t.dayHeaderClassNames,didMount:t.dayHeaderDidMount,willUnmount:t.dayHeaderWillUnmount},w=>re("div",{className:"fc-scrollgrid-sync-inner"},!h.isDisabled&&re(w,{elTag:"a",elAttrs:x,elClasses:["fc-col-header-cell-cushion",l.isSticky&&"fc-sticky"]})))}}const r4=as({weekday:"long"});class l4 extends Lt{render(){let{props:e}=this,{dateEnv:t,theme:s,viewApi:i,options:l}=this.context,c=is(new Date(2592e5),e.dow),u={dow:e.dow,isDisabled:!1,isFuture:!1,isPast:!1,isToday:!1,isOther:!1},h=t.format(c,e.dayHeaderFormat),m=Object.assign(Object.assign(Object.assign(Object.assign({date:c},u),{view:i}),e.extraRenderProps),{text:h});return re(va,{elTag:"th",elClasses:[XA,...xg(u,s),...e.extraClassNames||[]],elAttrs:Object.assign({role:"columnheader",colSpan:e.colSpan},e.extraDataAttrs),renderProps:m,generatorName:"dayHeaderContent",customGenerator:l.dayHeaderContent,defaultGenerator:QA,classNameGenerator:l.dayHeaderClassNames,didMount:l.dayHeaderDidMount,willUnmount:l.dayHeaderWillUnmount},p=>re("div",{className:"fc-scrollgrid-sync-inner"},re(p,{elTag:"a",elClasses:["fc-col-header-cell-cushion",e.isSticky&&"fc-sticky"],elAttrs:{"aria-label":t.format(c,r4)}})))}}class o4 extends Lt{constructor(){super(...arguments),this.createDayHeaderFormatter=rt(c4)}render(){let{context:e}=this,{dates:t,dateProfile:s,datesRepDistinctDays:i,renderIntro:l}=this.props,c=this.createDayHeaderFormatter(e.options.dayHeaderFormat,i,t.length);return re(ku,{unit:"day"},(u,h)=>re("tr",{role:"row"},l&&l("day"),t.map(m=>i?re(i4,{key:m.toISOString(),date:m,dateProfile:s,todayRange:h,colCnt:t.length,dayHeaderFormat:c}):re(l4,{key:m.getUTCDay(),dow:m.getUTCDay(),dayHeaderFormat:c}))))}}function c4(n,e,t){return n||a4(e,t)}class d4{constructor(e,t){let s=e.start,{end:i}=e,l=[],c=[],u=-1;for(;s<i;)t.isHiddenDay(s)?l.push(u+.5):(u+=1,l.push(u),c.push(s)),s=is(s,1);this.dates=c,this.indices=l,this.cnt=c.length}sliceRange(e){let t=this.getDateDayIndex(e.start),s=this.getDateDayIndex(is(e.end,-1)),i=Math.max(0,t),l=Math.min(this.cnt-1,s);return i=Math.ceil(i),l=Math.floor(l),i<=l?{firstIndex:i,lastIndex:l,isStart:t===i,isEnd:s===l}:null}getDateDayIndex(e){let{indices:t}=this,s=Math.floor(ol(this.dates[0],e));return s<0?t[0]-1:s>=t.length?t[t.length-1]+1:t[s]}}class u4{constructor(e,t){let{dates:s}=e,i,l,c;if(t){for(l=s[0].getUTCDay(),i=1;i<s.length&&s[i].getUTCDay()!==l;i+=1);c=Math.ceil(s.length/i)}else c=1,i=s.length;this.rowCnt=c,this.colCnt=i,this.daySeries=e,this.cells=this.buildCells(),this.headerDates=this.buildHeaderDates()}buildCells(){let e=[];for(let t=0;t<this.rowCnt;t+=1){let s=[];for(let i=0;i<this.colCnt;i+=1)s.push(this.buildCell(t,i));e.push(s)}return e}buildCell(e,t){let s=this.daySeries.dates[e*this.colCnt+t];return{key:s.toISOString(),date:s}}buildHeaderDates(){let e=[];for(let t=0;t<this.colCnt;t+=1)e.push(this.cells[0][t].date);return e}sliceRange(e){let{colCnt:t}=this,s=this.daySeries.sliceRange(e),i=[];if(s){let{firstIndex:l,lastIndex:c}=s,u=l;for(;u<=c;){let h=Math.floor(u/t),m=Math.min((h+1)*t,c+1);i.push({row:h,firstCol:u%t,lastCol:(m-1)%t,isStart:s.isStart&&u===l,isEnd:s.isEnd&&m-1===c}),u=m}}return i}}class h4{constructor(){this.sliceBusinessHours=rt(this._sliceBusinessHours),this.sliceDateSelection=rt(this._sliceDateSpan),this.sliceEventStore=rt(this._sliceEventStore),this.sliceEventDrag=rt(this._sliceInteraction),this.sliceEventResize=rt(this._sliceInteraction),this.forceDayIfListItem=!1}sliceProps(e,t,s,i,...l){let{eventUiBases:c}=e,u=this.sliceEventStore(e.eventStore,c,t,s,...l);return{dateSelectionSegs:this.sliceDateSelection(e.dateSelection,t,s,c,i,...l),businessHourSegs:this.sliceBusinessHours(e.businessHours,t,s,i,...l),fgEventSegs:u.fg,bgEventSegs:u.bg,eventDrag:this.sliceEventDrag(e.eventDrag,c,t,s,...l),eventResize:this.sliceEventResize(e.eventResize,c,t,s,...l),eventSelection:e.eventSelection}}sliceNowDate(e,t,s,i,...l){return this._sliceDateSpan({range:{start:e,end:si(e,1)},allDay:!1},t,s,{},i,...l)}_sliceBusinessHours(e,t,s,i,...l){return e?this._sliceEventStore(qi(e,Nd(t,!!s),i),{},t,s,...l).bg:[]}_sliceEventStore(e,t,s,i,...l){if(e){let c=qv(e,t,Nd(s,!!i),i);return{bg:this.sliceEventRanges(c.bg,l),fg:this.sliceEventRanges(c.fg,l)}}return{bg:[],fg:[]}}_sliceInteraction(e,t,s,i,...l){if(!e)return null;let c=qv(e.mutatedEvents,t,Nd(s,!!i),i);return{segs:this.sliceEventRanges(c.fg,l),affectedInstances:e.affectedEvents.instances,isEvent:e.isEvent}}_sliceDateSpan(e,t,s,i,l,...c){if(!e)return[];let u=Nd(t,!!s),h=el(e.range,u);if(h){e=Object.assign(Object.assign({},e),{range:h});let m=MM(e,i,l),p=this.sliceRange(e.range,...c);for(let x of p)x.eventRange=m;return p}return[]}sliceEventRanges(e,t){let s=[];for(let i of e)s.push(...this.sliceEventRange(i,t));return s}sliceEventRange(e,t){let s=e.range;this.forceDayIfListItem&&e.ui.display==="list-item"&&(s={start:s.start,end:is(s.start,1)});let i=this.sliceRange(s,...t);for(let l of i)l.eventRange=e,l.isStart=e.isStart&&l.isStart,l.isEnd=e.isEnd&&l.isEnd;return i}}function Nd(n,e){let t=n.activeRange;return e?t:{start:si(t.start,n.slotMinTime.milliseconds),end:si(t.end,n.slotMaxTime.milliseconds-864e5)}}function ZA(n,e,t){let{instances:s}=n.mutatedEvents;for(let i in s)if(!Tu(e.validRange,s[i].range))return!1;return KA({eventDrag:n},t)}function f4(n,e,t){return Tu(e.validRange,n.range)?KA({dateSelection:n},t):!1}function KA(n,e){let t=e.getCurrentData(),s=Object.assign({businessHours:t.businessHours,dateSelection:"",eventStore:t.eventStore,eventUiBases:t.eventUiBases,eventSelection:"",eventDrag:null,eventResize:null},n);return(e.pluginHooks.isPropsValid||m4)(s,e)}function m4(n,e,t={},s){return!(n.eventDrag&&!p4(n,e,t,s)||n.dateSelection&&!g4(n,e,t,s))}function p4(n,e,t,s){let i=e.getCurrentData(),l=n.eventDrag,c=l.mutatedEvents,u=c.defs,h=c.instances,m=ru(u,l.isEvent?n.eventUiBases:{"":i.selectionConfig});s&&(m=Xi(m,s));let p=dM(n.eventStore,l.affectedEvents.instances),x=p.defs,y=p.instances,v=ru(x,n.eventUiBases);for(let w in h){let A=h[w],N=A.range,j=m[A.defId],_=u[A.defId];if(!JA(j.constraints,N,p,n.businessHours,e))return!1;let{eventOverlap:C}=e.options,k=typeof C=="function"?C:null;for(let P in y){let F=y[P];if(cg(N,F.range)&&(v[F.defId].overlap===!1&&l.isEvent||j.overlap===!1||k&&!k(new Tt(e,x[F.defId],F),new Tt(e,_,A))))return!1}let D=i.eventStore;for(let P of j.allows){let F=Object.assign(Object.assign({},t),{range:A.range,allDay:_.allDay}),U=D.defs[_.defId],I=D.instances[w],K;if(U?K=new Tt(e,U,I):K=new Tt(e,_),!P(mg(F,e),K))return!1}}return!0}function g4(n,e,t,s){let i=n.eventStore,l=i.defs,c=i.instances,u=n.dateSelection,h=u.range,{selectionConfig:m}=e.getCurrentData();if(s&&(m=s(m)),!JA(m.constraints,h,i,n.businessHours,e))return!1;let{selectOverlap:p}=e.options,x=typeof p=="function"?p:null;for(let y in c){let v=c[y];if(cg(h,v.range)&&(m.overlap===!1||x&&!x(new Tt(e,l[v.defId],v),null)))return!1}for(let y of m.allows){let v=Object.assign(Object.assign({},t),u);if(!y(mg(v,e),null))return!1}return!0}function JA(n,e,t,s,i){for(let l of n)if(!y4(x4(l,e,t,s,i),e))return!1;return!0}function x4(n,e,t,s,i){return n==="businessHours"?Lm(qi(s,e,i)):typeof n=="string"?Lm(Du(t,l=>l.groupId===n)):typeof n=="object"&&n?Lm(qi(n,e,i)):[]}function Lm(n){let{instances:e}=n,t=[];for(let s in e)t.push(e[s].range);return t}function y4(n,e){for(let t of n)if(Tu(t,e))return!0;return!1}const jd=/^(visible|hidden)$/;class b4 extends Lt{constructor(){super(...arguments),this.handleEl=e=>{this.el=e,Xn(this.props.elRef,e)}}render(){let{props:e}=this,{liquid:t,liquidIsAbsolute:s}=e,i=t&&s,l=["fc-scroller"];return t&&(s?l.push("fc-scroller-liquid-absolute"):l.push("fc-scroller-liquid")),re("div",{ref:this.handleEl,className:l.join(" "),style:{overflowX:e.overflowX,overflowY:e.overflowY,left:i&&-(e.overcomeLeft||0)||"",right:i&&-(e.overcomeRight||0)||"",bottom:i&&-(e.overcomeBottom||0)||"",marginLeft:!i&&-(e.overcomeLeft||0)||"",marginRight:!i&&-(e.overcomeRight||0)||"",marginBottom:!i&&-(e.overcomeBottom||0)||"",maxHeight:e.maxHeight||""}},e.children)}needsXScrolling(){if(jd.test(this.props.overflowX))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().width-this.getYScrollbarWidth(),{children:s}=e;for(let i=0;i<s.length;i+=1)if(s[i].getBoundingClientRect().width>t)return!0;return!1}needsYScrolling(){if(jd.test(this.props.overflowY))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().height-this.getXScrollbarWidth(),{children:s}=e;for(let i=0;i<s.length;i+=1)if(s[i].getBoundingClientRect().height>t)return!0;return!1}getXScrollbarWidth(){return jd.test(this.props.overflowX)?0:this.el.offsetHeight-this.el.clientHeight}getYScrollbarWidth(){return jd.test(this.props.overflowY)?0:this.el.offsetWidth-this.el.clientWidth}}class Mi{constructor(e){this.masterCallback=e,this.currentMap={},this.depths={},this.callbackMap={},this.handleValue=(t,s)=>{let{depths:i,currentMap:l}=this,c=!1,u=!1;t!==null?(c=s in l,l[s]=t,i[s]=(i[s]||0)+1,u=!0):(i[s]-=1,i[s]||(delete l[s],delete this.callbackMap[s],c=!0)),this.masterCallback&&(c&&this.masterCallback(null,String(s)),u&&this.masterCallback(t,String(s)))}}createRef(e){let t=this.callbackMap[e];return t||(t=this.callbackMap[e]=s=>{this.handleValue(s,String(e))}),t}collect(e,t,s){return Ck(this.currentMap,e,t,s)}getAll(){return lg(this.currentMap)}}function v4(n){let e=_R(n,".fc-scrollgrid-shrink"),t=0;for(let s of e)t=Math.max(t,FR(s));return Math.ceil(t)}function eN(n,e){return n.liquid&&e.liquid}function w4(n,e){return e.maxHeight!=null||eN(n,e)}function A4(n,e,t,s){let{expandRows:i}=t;return typeof e.content=="function"?e.content(t):re("table",{role:"presentation",className:[e.tableClassName,n.syncRowHeights?"fc-scrollgrid-sync-table":""].join(" "),style:{minWidth:t.tableMinWidth,width:t.clientWidth,height:i?t.clientHeight:""}},t.tableColGroupNode,re(s?"thead":"tbody",{role:"presentation"},typeof e.rowContent=="function"?e.rowContent(t):e.rowContent))}function N4(n,e){return ti(n,e,Cn)}function j4(n,e){let t=[];for(let s of n){let i=s.span||1;for(let l=0;l<i;l+=1)t.push(re("col",{style:{width:s.width==="shrink"?S4(e):s.width||"",minWidth:s.minWidth||""}}))}return re("colgroup",{},...t)}function S4(n){return n??4}function E4(n){for(let e of n)if(e.width==="shrink")return!0;return!1}function _4(n,e){let t=["fc-scrollgrid",e.theme.getClass("table")];return n&&t.push("fc-scrollgrid-liquid"),t}function C4(n,e){let t=["fc-scrollgrid-section",`fc-scrollgrid-section-${n.type}`,n.className];return e&&n.liquid&&n.maxHeight==null&&t.push("fc-scrollgrid-section-liquid"),n.isSticky&&t.push("fc-scrollgrid-section-sticky"),t}function T4(n){return re("div",{className:"fc-scrollgrid-sticky-shim",style:{width:n.clientWidth,minWidth:n.tableMinWidth}})}function Qv(n){let{stickyHeaderDates:e}=n;return(e==null||e==="auto")&&(e=n.height==="auto"||n.viewHeight==="auto"),e}function D4(n){let{stickyFooterScrollbar:e}=n;return(e==null||e==="auto")&&(e=n.height==="auto"||n.viewHeight==="auto"),e}class tN extends Lt{constructor(){super(...arguments),this.processCols=rt(e=>e,N4),this.renderMicroColGroup=rt(j4),this.scrollerRefs=new Mi,this.scrollerElRefs=new Mi(this._handleScrollerEl.bind(this)),this.state={shrinkWidth:null,forceYScrollbars:!1,scrollerClientWidths:{},scrollerClientHeights:{}},this.handleSizing=()=>{this.safeSetState(Object.assign({shrinkWidth:this.computeShrinkWidth()},this.computeScrollerDims()))}}render(){let{props:e,state:t,context:s}=this,i=e.sections||[],l=this.processCols(e.cols),c=this.renderMicroColGroup(l,t.shrinkWidth),u=_4(e.liquid,s);e.collapsibleWidth&&u.push("fc-scrollgrid-collapsible");let h=i.length,m=0,p,x=[],y=[],v=[];for(;m<h&&(p=i[m]).type==="header";)x.push(this.renderSection(p,c,!0)),m+=1;for(;m<h&&(p=i[m]).type==="body";)y.push(this.renderSection(p,c,!1)),m+=1;for(;m<h&&(p=i[m]).type==="footer";)v.push(this.renderSection(p,c,!0)),m+=1;let w=!$A();const A={role:"rowgroup"};return re("table",{role:"grid",className:u.join(" "),style:{height:e.height}},!!(!w&&x.length)&&re("thead",A,...x),!!(!w&&y.length)&&re("tbody",A,...y),!!(!w&&v.length)&&re("tfoot",A,...v),w&&re("tbody",A,...x,...y,...v))}renderSection(e,t,s){return"outerContent"in e?re(It,{key:e.key},e.outerContent):re("tr",{key:e.key,role:"presentation",className:C4(e,this.props.liquid).join(" ")},this.renderChunkTd(e,t,e.chunk,s))}renderChunkTd(e,t,s,i){if("outerContent"in s)return s.outerContent;let{props:l}=this,{forceYScrollbars:c,scrollerClientWidths:u,scrollerClientHeights:h}=this.state,m=w4(l,e),p=eN(l,e),x=l.liquid?c?"scroll":m?"auto":"hidden":"visible",y=e.key,v=A4(e,s,{tableColGroupNode:t,tableMinWidth:"",clientWidth:!l.collapsibleWidth&&u[y]!==void 0?u[y]:null,clientHeight:h[y]!==void 0?h[y]:null,expandRows:e.expandRows,syncRowHeights:!1,rowSyncHeights:[],reportRowHeightChange:()=>{}},i);return re(i?"th":"td",{ref:s.elRef,role:"presentation"},re("div",{className:`fc-scroller-harness${p?" fc-scroller-harness-liquid":""}`},re(b4,{ref:this.scrollerRefs.createRef(y),elRef:this.scrollerElRefs.createRef(y),overflowY:x,overflowX:l.liquid?"hidden":"visible",maxHeight:e.maxHeight,liquid:p,liquidIsAbsolute:!0},v)))}_handleScrollerEl(e,t){let s=R4(this.props.sections,t);s&&Xn(s.chunk.scrollerElRef,e)}componentDidMount(){this.handleSizing(),this.context.addResizeHandler(this.handleSizing)}componentDidUpdate(){this.handleSizing()}componentWillUnmount(){this.context.removeResizeHandler(this.handleSizing)}computeShrinkWidth(){return E4(this.props.cols)?v4(this.scrollerElRefs.getAll()):0}computeScrollerDims(){let e=XM(),{scrollerRefs:t,scrollerElRefs:s}=this,i=!1,l={},c={};for(let u in t.currentMap){let h=t.currentMap[u];if(h&&h.needsYScrolling()){i=!0;break}}for(let u of this.props.sections){let h=u.key,m=s.currentMap[h];if(m){let p=m.parentNode;l[h]=Math.floor(p.getBoundingClientRect().width-(i?e.y:0)),c[h]=Math.floor(p.getBoundingClientRect().height)}}return{forceYScrollbars:i,scrollerClientWidths:l,scrollerClientHeights:c}}}tN.addStateEquality({scrollerClientWidths:Cn,scrollerClientHeights:Cn});function R4(n,e){for(let t of n)if(t.key===e)return t;return null}class wg extends Lt{constructor(){super(...arguments),this.buildPublicEvent=rt((e,t,s)=>new Tt(e,t,s)),this.handleEl=e=>{this.el=e,Xn(this.props.elRef,e),e&&Gv(e,this.props.seg)}}render(){const{props:e,context:t}=this,{options:s}=t,{seg:i}=e,{eventRange:l}=i,{ui:c}=l,u={event:this.buildPublicEvent(t,l.def,l.instance),view:t.viewApi,timeText:e.timeText,textColor:c.textColor,backgroundColor:c.backgroundColor,borderColor:c.borderColor,isDraggable:!e.disableDragging&&AM(i,t),isStartResizable:!e.disableResizing&&NM(i,t),isEndResizable:!e.disableResizing&&jM(i),isMirror:!!(e.isDragging||e.isResizing||e.isDateSelecting),isStart:!!i.isStart,isEnd:!!i.isEnd,isPast:!!e.isPast,isFuture:!!e.isFuture,isToday:!!e.isToday,isSelected:!!e.isSelected,isDragging:!!e.isDragging,isResizing:!!e.isResizing};return re(va,{elRef:this.handleEl,elTag:e.elTag,elAttrs:e.elAttrs,elClasses:[...SM(u),...i.eventRange.ui.classNames,...e.elClasses||[]],elStyle:e.elStyle,renderProps:u,generatorName:"eventContent",customGenerator:s.eventContent,defaultGenerator:e.defaultGenerator,classNameGenerator:s.eventClassNames,didMount:s.eventDidMount,willUnmount:s.eventWillUnmount},e.children)}componentDidUpdate(e){this.el&&this.props.seg!==e.seg&&Gv(this.el,this.props.seg)}}class sN extends Lt{render(){let{props:e,context:t}=this,{options:s}=t,{seg:i}=e,{ui:l}=i.eventRange,c=s.eventTimeFormat||e.defaultTimeFormat,u=HA(i,c,t,e.defaultDisplayEventTime,e.defaultDisplayEventEnd);return re(wg,Object.assign({},e,{elTag:"a",elStyle:{borderColor:l.borderColor,backgroundColor:l.backgroundColor},elAttrs:zA(i,t),defaultGenerator:k4,timeText:u}),(h,m)=>re(It,null,re(h,{elTag:"div",elClasses:["fc-event-main"],elStyle:{color:m.textColor}}),!!m.isStartResizable&&re("div",{className:"fc-event-resizer fc-event-resizer-start"}),!!m.isEndResizable&&re("div",{className:"fc-event-resizer fc-event-resizer-end"})))}}sN.addPropsEquality({seg:Cn});function k4(n){return re("div",{className:"fc-event-main-frame"},n.timeText&&re("div",{className:"fc-event-time"},n.timeText),re("div",{className:"fc-event-title-container"},re("div",{className:"fc-event-title fc-sticky"},n.event.title||re(It,null," "))))}const M4=as({day:"numeric"});class nN extends Lt{constructor(){super(...arguments),this.refineRenderProps=Id(L4)}render(){let{props:e,context:t}=this,{options:s}=t,i=this.refineRenderProps({date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,isMonthStart:e.isMonthStart||!1,showDayNumber:e.showDayNumber,extraRenderProps:e.extraRenderProps,viewApi:t.viewApi,dateEnv:t.dateEnv,monthStartFormat:s.monthStartFormat});return re(va,{elRef:e.elRef,elTag:e.elTag,elAttrs:Object.assign(Object.assign({},e.elAttrs),i.isDisabled?{}:{"data-date":ng(e.date)}),elClasses:[...xg(i,t.theme),...e.elClasses||[]],elStyle:e.elStyle,renderProps:i,generatorName:"dayCellContent",customGenerator:s.dayCellContent,defaultGenerator:e.defaultGenerator,classNameGenerator:i.isDisabled?void 0:s.dayCellClassNames,didMount:s.dayCellDidMount,willUnmount:s.dayCellWillUnmount},e.children)}}function aN(n){return!!(n.dayCellContent||dp("dayCellContent",n))}function L4(n){let{date:e,dateEnv:t,dateProfile:s,isMonthStart:i}=n,l=qA(e,n.todayRange,null,s),c=n.showDayNumber?t.format(e,i?n.monthStartFormat:M4):"";return Object.assign(Object.assign(Object.assign({date:t.toDate(e),view:n.viewApi},l),{isMonthStart:i,dayNumberText:c}),n.extraRenderProps)}class O4 extends Lt{render(){let{props:e}=this,{seg:t}=e;return re(wg,{elTag:"div",elClasses:["fc-bg-event"],elStyle:{backgroundColor:t.eventRange.ui.backgroundColor},defaultGenerator:P4,seg:t,timeText:"",isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,isPast:e.isPast,isFuture:e.isFuture,isToday:e.isToday,disableDragging:!0,disableResizing:!0})}}function P4(n){let{title:e}=n.event;return e&&re("div",{className:"fc-event-title"},n.event.title)}function I4(n){return re("div",{className:`fc-${n}`})}const B4=n=>re(Qi.Consumer,null,e=>{let{dateEnv:t,options:s}=e,{date:i}=n,l=s.weekNumberFormat||n.defaultFormat,c=t.computeWeekNumber(i),u=t.format(i,l),h={num:c,text:u,date:i};return re(va,{elRef:n.elRef,elTag:n.elTag,elAttrs:n.elAttrs,elClasses:n.elClasses,elStyle:n.elStyle,renderProps:h,generatorName:"weekNumberContent",customGenerator:s.weekNumberContent,defaultGenerator:H4,classNameGenerator:s.weekNumberClassNames,didMount:s.weekNumberDidMount,willUnmount:s.weekNumberWillUnmount},n.children)});function H4(n){return n.text}const Om=10;class z4 extends Lt{constructor(){super(...arguments),this.state={titleId:_u()},this.handleRootEl=e=>{this.rootEl=e,this.props.elRef&&Xn(this.props.elRef,e)},this.handleDocumentMouseDown=e=>{const t=pA(e);this.rootEl.contains(t)||this.handleCloseClick()},this.handleDocumentKeyDown=e=>{e.key==="Escape"&&this.handleCloseClick()},this.handleCloseClick=()=>{let{onClose:e}=this.props;e&&e()}}render(){let{theme:e,options:t}=this.context,{props:s,state:i}=this,l=["fc-popover",e.getClass("popover")].concat(s.extraClassNames||[]);return fR(re("div",Object.assign({},s.extraAttrs,{id:s.id,className:l.join(" "),"aria-labelledby":i.titleId,ref:this.handleRootEl}),re("div",{className:"fc-popover-header "+e.getClass("popoverHeader")},re("span",{className:"fc-popover-title",id:i.titleId},s.title),re("span",{className:"fc-popover-close "+e.getIconClass("close"),title:t.closeHint,onClick:this.handleCloseClick})),re("div",{className:"fc-popover-body "+e.getClass("popoverContent")},s.children)),s.parentEl)}componentDidMount(){document.addEventListener("mousedown",this.handleDocumentMouseDown),document.addEventListener("keydown",this.handleDocumentKeyDown),this.updateSize()}componentWillUnmount(){document.removeEventListener("mousedown",this.handleDocumentMouseDown),document.removeEventListener("keydown",this.handleDocumentKeyDown)}updateSize(){let{isRtl:e}=this.context,{alignmentEl:t,alignGridTop:s}=this.props,{rootEl:i}=this,l=JM(t);if(l){let c=i.getBoundingClientRect(),u=s?vs(t,".fc-scrollgrid").getBoundingClientRect().top:l.top,h=e?l.right-c.width:l.left;u=Math.max(u,Om),h=Math.min(h,document.documentElement.clientWidth-Om-c.width),h=Math.max(h,Om);let m=i.offsetParent.getBoundingClientRect();wo(i,{top:u-m.top,left:h-m.left})}}}class F4 extends Ki{constructor(){super(...arguments),this.handleRootEl=e=>{this.rootEl=e,e?this.context.registerInteractiveComponent(this,{el:e,useEventCenter:!1}):this.context.unregisterInteractiveComponent(this)}}render(){let{options:e,dateEnv:t}=this.context,{props:s}=this,{startDate:i,todayRange:l,dateProfile:c}=s,u=t.format(i,e.dayPopoverFormat);return re(nN,{elRef:this.handleRootEl,date:i,dateProfile:c,todayRange:l},(h,m,p)=>re(z4,{elRef:p.ref,id:s.id,title:u,extraClassNames:["fc-more-popover"].concat(p.className||[]),extraAttrs:p,parentEl:s.parentEl,alignmentEl:s.alignmentEl,alignGridTop:s.alignGridTop,onClose:s.onClose},aN(e)&&re(h,{elTag:"div",elClasses:["fc-more-popover-misc"]}),s.children))}queryHit(e,t,s,i){let{rootEl:l,props:c}=this;return e>=0&&e<s&&t>=0&&t<i?{dateProfile:c.dateProfile,dateSpan:Object.assign({allDay:!c.forceTimed,range:{start:c.startDate,end:c.endDate}},c.extraDateSpan),dayEl:l,rect:{left:0,top:0,right:s,bottom:i},layer:1}:null}}class U4 extends Lt{constructor(){super(...arguments),this.state={isPopoverOpen:!1,popoverId:_u()},this.handleLinkEl=e=>{this.linkEl=e,this.props.elRef&&Xn(this.props.elRef,e)},this.handleClick=e=>{let{props:t,context:s}=this,{moreLinkClick:i}=s.options,l=Zv(t).start;function c(u){let{def:h,instance:m,range:p}=u.eventRange;return{event:new Tt(s,h,m),start:s.dateEnv.toDate(p.start),end:s.dateEnv.toDate(p.end),isStart:u.isStart,isEnd:u.isEnd}}typeof i=="function"&&(i=i({date:l,allDay:!!t.allDayDate,allSegs:t.allSegs.map(c),hiddenSegs:t.hiddenSegs.map(c),jsEvent:e,view:s.viewApi})),!i||i==="popover"?this.setState({isPopoverOpen:!0}):typeof i=="string"&&s.calendarApi.zoomTo(l,i)},this.handlePopoverClose=()=>{this.setState({isPopoverOpen:!1})}}render(){let{props:e,state:t}=this;return re(Qi.Consumer,null,s=>{let{viewApi:i,options:l,calendarApi:c}=s,{moreLinkText:u}=l,{moreCnt:h}=e,m=Zv(e),p=typeof u=="function"?u.call(c,h):`+${h} ${u}`,x=Ao(l.moreLinkHint,[h],p),y={num:h,shortText:`+${h}`,text:p,view:i};return re(It,null,!!e.moreCnt&&re(va,{elTag:e.elTag||"a",elRef:this.handleLinkEl,elClasses:[...e.elClasses||[],"fc-more-link"],elStyle:e.elStyle,elAttrs:Object.assign(Object.assign(Object.assign({},e.elAttrs),xA(this.handleClick)),{title:x,"aria-expanded":t.isPopoverOpen,"aria-controls":t.isPopoverOpen?t.popoverId:""}),renderProps:y,generatorName:"moreLinkContent",customGenerator:l.moreLinkContent,defaultGenerator:e.defaultGenerator||$4,classNameGenerator:l.moreLinkClassNames,didMount:l.moreLinkDidMount,willUnmount:l.moreLinkWillUnmount},e.children),t.isPopoverOpen&&re(F4,{id:t.popoverId,startDate:m.start,endDate:m.end,dateProfile:e.dateProfile,todayRange:e.todayRange,extraDateSpan:e.extraDateSpan,parentEl:this.parentEl,alignmentEl:e.alignmentElRef?e.alignmentElRef.current:this.linkEl,alignGridTop:e.alignGridTop,forceTimed:e.forceTimed,onClose:this.handlePopoverClose},e.popoverContent()))})}componentDidMount(){this.updateParentEl()}componentDidUpdate(){this.updateParentEl()}updateParentEl(){this.linkEl&&(this.parentEl=vs(this.linkEl,".fc-view-harness"))}}function $4(n){return n.text}function Zv(n){if(n.allDayDate)return{start:n.allDayDate,end:is(n.allDayDate,1)};let{hiddenSegs:e}=n;return{start:V4(e),end:G4(e)}}function V4(n){return n.reduce(q4).eventRange.range.start}function q4(n,e){return n.eventRange.range.start<e.eventRange.range.start?n:e}function G4(n){return n.reduce(Y4).eventRange.range.end}function Y4(n,e){return n.eventRange.range.end>e.eventRange.range.end?n:e}class W4{constructor(){this.handlers=[]}set(e){this.currentValue=e;for(let t of this.handlers)t(e)}subscribe(e){this.handlers.push(e),this.currentValue!==void 0&&e(this.currentValue)}}class X4 extends W4{constructor(){super(...arguments),this.map=new Map}handle(e){const{map:t}=this;let s=!1;e.isActive?(t.set(e.id,e),s=!0):t.has(e.id)&&(t.delete(e.id),s=!0),s&&this.set(t)}}const Q4=[],iN={code:"en",week:{dow:0,doy:4},direction:"ltr",buttonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",year:"year",today:"today",month:"month",week:"week",day:"day",list:"list"},weekText:"W",weekTextLong:"Week",closeHint:"Close",timeHint:"Time",eventHint:"Event",allDayText:"all-day",moreLinkText:"more",noEventsText:"No events to display"},rN=Object.assign(Object.assign({},iN),{buttonHints:{prev:"Previous $0",next:"Next $0",today(n,e){return e==="day"?"Today":`This ${n}`}},viewHint:"$0 view",navLinkHint:"Go to $0",moreLinkHint(n){return`Show ${n} more event${n===1?"":"s"}`}});function Z4(n){let e=n.length>0?n[0].code:"en",t=Q4.concat(n),s={en:rN};for(let i of t)s[i.code]=i;return{map:s,defaultCode:e}}function lN(n,e){return typeof n=="object"&&!Array.isArray(n)?oN(n.code,[n.code],n):K4(n,e)}function K4(n,e){let t=[].concat(n||[]),s=J4(t,e)||rN;return oN(n,t,s)}function J4(n,e){for(let t=0;t<n.length;t+=1){let s=n[t].toLocaleLowerCase().split("-");for(let i=s.length;i>0;i-=1){let l=s.slice(0,i).join("-");if(e[l])return e[l]}}return null}function oN(n,e,t){let s=rg([iN,t],["buttonText"]);delete s.code;let{week:i}=s;return delete s.week,{codeArg:n,codes:e,week:i,simpleNumberFormat:new Intl.NumberFormat(n),options:s}}function ai(n){return{id:Wi(),name:n.name,premiumReleaseDate:n.premiumReleaseDate?new Date(n.premiumReleaseDate):void 0,deps:n.deps||[],reducers:n.reducers||[],isLoadingFuncs:n.isLoadingFuncs||[],contextInit:[].concat(n.contextInit||[]),eventRefiners:n.eventRefiners||{},eventDefMemberAdders:n.eventDefMemberAdders||[],eventSourceRefiners:n.eventSourceRefiners||{},isDraggableTransformers:n.isDraggableTransformers||[],eventDragMutationMassagers:n.eventDragMutationMassagers||[],eventDefMutationAppliers:n.eventDefMutationAppliers||[],dateSelectionTransformers:n.dateSelectionTransformers||[],datePointTransforms:n.datePointTransforms||[],dateSpanTransforms:n.dateSpanTransforms||[],views:n.views||{},viewPropsTransformers:n.viewPropsTransformers||[],isPropsValid:n.isPropsValid||null,externalDefTransforms:n.externalDefTransforms||[],viewContainerAppends:n.viewContainerAppends||[],eventDropTransformers:n.eventDropTransformers||[],componentInteractions:n.componentInteractions||[],calendarInteractions:n.calendarInteractions||[],themeClasses:n.themeClasses||{},eventSourceDefs:n.eventSourceDefs||[],cmdFormatter:n.cmdFormatter,recurringTypes:n.recurringTypes||[],namedTimeZonedImpl:n.namedTimeZonedImpl,initialView:n.initialView||"",elementDraggingImpl:n.elementDraggingImpl,optionChangeHandlers:n.optionChangeHandlers||{},scrollGridImpl:n.scrollGridImpl||null,listenerRefiners:n.listenerRefiners||{},optionRefiners:n.optionRefiners||{},propSetHandlers:n.propSetHandlers||{}}}function e3(n,e){let t={},s={premiumReleaseDate:void 0,reducers:[],isLoadingFuncs:[],contextInit:[],eventRefiners:{},eventDefMemberAdders:[],eventSourceRefiners:{},isDraggableTransformers:[],eventDragMutationMassagers:[],eventDefMutationAppliers:[],dateSelectionTransformers:[],datePointTransforms:[],dateSpanTransforms:[],views:{},viewPropsTransformers:[],isPropsValid:null,externalDefTransforms:[],viewContainerAppends:[],eventDropTransformers:[],componentInteractions:[],calendarInteractions:[],themeClasses:{},eventSourceDefs:[],cmdFormatter:null,recurringTypes:[],namedTimeZonedImpl:null,initialView:"",elementDraggingImpl:null,optionChangeHandlers:{},scrollGridImpl:null,listenerRefiners:{},optionRefiners:{},propSetHandlers:{}};function i(l){for(let c of l){const u=c.name,h=t[u];h===void 0?(t[u]=c.id,i(c.deps),s=s3(s,c)):h!==c.id&&console.warn(`Duplicate plugin '${u}'`)}}return n&&i(n),i(e),s}function t3(){let n=[],e=[],t;return(s,i)=>((!t||!ti(s,n)||!ti(i,e))&&(t=e3(s,i)),n=s,e=i,t)}function s3(n,e){return{premiumReleaseDate:n3(n.premiumReleaseDate,e.premiumReleaseDate),reducers:n.reducers.concat(e.reducers),isLoadingFuncs:n.isLoadingFuncs.concat(e.isLoadingFuncs),contextInit:n.contextInit.concat(e.contextInit),eventRefiners:Object.assign(Object.assign({},n.eventRefiners),e.eventRefiners),eventDefMemberAdders:n.eventDefMemberAdders.concat(e.eventDefMemberAdders),eventSourceRefiners:Object.assign(Object.assign({},n.eventSourceRefiners),e.eventSourceRefiners),isDraggableTransformers:n.isDraggableTransformers.concat(e.isDraggableTransformers),eventDragMutationMassagers:n.eventDragMutationMassagers.concat(e.eventDragMutationMassagers),eventDefMutationAppliers:n.eventDefMutationAppliers.concat(e.eventDefMutationAppliers),dateSelectionTransformers:n.dateSelectionTransformers.concat(e.dateSelectionTransformers),datePointTransforms:n.datePointTransforms.concat(e.datePointTransforms),dateSpanTransforms:n.dateSpanTransforms.concat(e.dateSpanTransforms),views:Object.assign(Object.assign({},n.views),e.views),viewPropsTransformers:n.viewPropsTransformers.concat(e.viewPropsTransformers),isPropsValid:e.isPropsValid||n.isPropsValid,externalDefTransforms:n.externalDefTransforms.concat(e.externalDefTransforms),viewContainerAppends:n.viewContainerAppends.concat(e.viewContainerAppends),eventDropTransformers:n.eventDropTransformers.concat(e.eventDropTransformers),calendarInteractions:n.calendarInteractions.concat(e.calendarInteractions),componentInteractions:n.componentInteractions.concat(e.componentInteractions),themeClasses:Object.assign(Object.assign({},n.themeClasses),e.themeClasses),eventSourceDefs:n.eventSourceDefs.concat(e.eventSourceDefs),cmdFormatter:e.cmdFormatter||n.cmdFormatter,recurringTypes:n.recurringTypes.concat(e.recurringTypes),namedTimeZonedImpl:e.namedTimeZonedImpl||n.namedTimeZonedImpl,initialView:n.initialView||e.initialView,elementDraggingImpl:n.elementDraggingImpl||e.elementDraggingImpl,optionChangeHandlers:Object.assign(Object.assign({},n.optionChangeHandlers),e.optionChangeHandlers),scrollGridImpl:e.scrollGridImpl||n.scrollGridImpl,listenerRefiners:Object.assign(Object.assign({},n.listenerRefiners),e.listenerRefiners),optionRefiners:Object.assign(Object.assign({},n.optionRefiners),e.optionRefiners),propSetHandlers:Object.assign(Object.assign({},n.propSetHandlers),e.propSetHandlers)}}function n3(n,e){return n===void 0?e:e===void 0?n:new Date(Math.max(n.valueOf(),e.valueOf()))}class ii extends Zo{}ii.prototype.classes={root:"fc-theme-standard",tableCellShaded:"fc-cell-shaded",buttonGroup:"fc-button-group",button:"fc-button fc-button-primary",buttonActive:"fc-button-active"};ii.prototype.baseIconClass="fc-icon";ii.prototype.iconClasses={close:"fc-icon-x",prev:"fc-icon-chevron-left",next:"fc-icon-chevron-right",prevYear:"fc-icon-chevrons-left",nextYear:"fc-icon-chevrons-right"};ii.prototype.rtlIconClasses={prev:"fc-icon-chevron-right",next:"fc-icon-chevron-left",prevYear:"fc-icon-chevrons-right",nextYear:"fc-icon-chevrons-left"};ii.prototype.iconOverrideOption="buttonIcons";ii.prototype.iconOverrideCustomButtonOption="icon";ii.prototype.iconOverridePrefix="fc-icon-";function a3(n,e){let t={},s;for(s in n)pp(s,t,n,e);for(s in e)pp(s,t,n,e);return t}function pp(n,e,t,s){if(e[n])return e[n];let i=i3(n,e,t,s);return i&&(e[n]=i),i}function i3(n,e,t,s){let i=t[n],l=s[n],c=p=>i&&i[p]!==null?i[p]:l&&l[p]!==null?l[p]:null,u=c("component"),h=c("superType"),m=null;if(h){if(h===n)throw new Error("Can't have a custom view type that references itself");m=pp(h,e,t,s)}return!u&&m&&(u=m.component),u?{type:n,component:u,defaults:Object.assign(Object.assign({},m?m.defaults:{}),i?i.rawOptions:{}),overrides:Object.assign(Object.assign({},m?m.overrides:{}),l?l.rawOptions:{})}:null}function Kv(n){return Xi(n,r3)}function r3(n){let e=typeof n=="function"?{component:n}:n,{component:t}=e;return e.content?t=Jv(e):t&&!(t.prototype instanceof Lt)&&(t=Jv(Object.assign(Object.assign({},e),{content:t}))),{superType:e.type,component:t,rawOptions:e}}function Jv(n){return e=>re(Qi.Consumer,null,t=>re(va,{elTag:"div",elClasses:SA(t.viewSpec),renderProps:Object.assign(Object.assign({},e),{nextDayThreshold:t.options.nextDayThreshold}),generatorName:void 0,customGenerator:n.content,classNameGenerator:n.classNames,didMount:n.didMount,willUnmount:n.willUnmount}))}function l3(n,e,t,s){let i=Kv(n),l=Kv(e.views),c=a3(i,l);return Xi(c,u=>o3(u,l,e,t,s))}function o3(n,e,t,s,i){let l=n.overrides.duration||n.defaults.duration||s.duration||t.duration,c=null,u="",h="",m={};if(l&&(c=c3(l),c)){let y=cp(c);u=y.unit,y.value===1&&(h=u,m=e[u]?e[u].rawOptions:{})}let p=y=>{let v=y.buttonText||{},w=n.defaults.buttonTextKey;return w!=null&&v[w]!=null?v[w]:v[n.type]!=null?v[n.type]:v[h]!=null?v[h]:null},x=y=>{let v=y.buttonHints||{},w=n.defaults.buttonTextKey;return w!=null&&v[w]!=null?v[w]:v[n.type]!=null?v[n.type]:v[h]!=null?v[h]:null};return{type:n.type,component:n.component,duration:c,durationUnit:u,singleUnit:h,optionDefaults:n.defaults,optionOverrides:Object.assign(Object.assign({},m),n.overrides),buttonTextOverride:p(s)||p(t)||n.overrides.buttonText,buttonTextDefault:p(i)||n.defaults.buttonText||p(No)||n.type,buttonTitleOverride:x(s)||x(t)||n.overrides.buttonHint,buttonTitleDefault:x(i)||n.defaults.buttonHint||x(No)}}let ew={};function c3(n){let e=JSON.stringify(n),t=ew[e];return t===void 0&&(t=ot(n),ew[e]=t),t}function d3(n,e){switch(e.type){case"CHANGE_VIEW_TYPE":n=e.viewType}return n}function u3(n,e){switch(e.type){case"CHANGE_DATE":return e.dateMarker;default:return n}}function h3(n,e,t){let s=n.initialDate;return s!=null?e.createMarker(s):t.getDateMarker()}function f3(n,e){switch(e.type){case"SET_OPTION":return Object.assign(Object.assign({},n),{[e.optionName]:e.rawOptionValue});default:return n}}function m3(n,e,t,s){let i;switch(e.type){case"CHANGE_VIEW_TYPE":return s.build(e.dateMarker||t);case"CHANGE_DATE":return s.build(e.dateMarker);case"PREV":if(i=s.buildPrev(n,t),i.isValid)return i;break;case"NEXT":if(i=s.buildNext(n,t),i.isValid)return i;break}return n}function p3(n,e,t){let s=e?e.activeRange:null;return dN({},A3(n,t),s,t)}function g3(n,e,t,s){let i=t?t.activeRange:null;switch(e.type){case"ADD_EVENT_SOURCES":return dN(n,e.sources,i,s);case"REMOVE_EVENT_SOURCE":return y3(n,e.sourceId);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return t?uN(n,i,s):n;case"FETCH_EVENT_SOURCES":return Ag(n,e.sourceIds?vA(e.sourceIds):hN(n,s),i,e.isRefetch||!1,s);case"RECEIVE_EVENTS":case"RECEIVE_EVENT_ERROR":return w3(n,e.sourceId,e.fetchId,e.fetchRange);case"REMOVE_ALL_EVENT_SOURCES":return{};default:return n}}function x3(n,e,t){let s=e?e.activeRange:null;return Ag(n,hN(n,t),s,!0,t)}function cN(n){for(let e in n)if(n[e].isFetching)return!0;return!1}function dN(n,e,t,s){let i={};for(let l of e)i[l.sourceId]=l;return t&&(i=uN(i,t,s)),Object.assign(Object.assign({},n),i)}function y3(n,e){return Vi(n,t=>t.sourceId!==e)}function uN(n,e,t){return Ag(n,Vi(n,s=>b3(s,e,t)),e,!1,t)}function b3(n,e,t){return fN(n,t)?!t.options.lazyFetching||!n.fetchRange||n.isFetching||e.start<n.fetchRange.start||e.end>n.fetchRange.end:!n.latestFetchId}function Ag(n,e,t,s,i){let l={};for(let c in n){let u=n[c];e[c]?l[c]=v3(u,t,s,i):l[c]=u}return l}function v3(n,e,t,s){let{options:i,calendarApi:l}=s,c=s.pluginHooks.eventSourceDefs[n.sourceDefId],u=Wi();return c.fetch({eventSource:n,range:e,isRefetch:t,context:s},h=>{let{rawEvents:m}=h;i.eventSourceSuccess&&(m=i.eventSourceSuccess.call(l,m,h.response)||m),n.success&&(m=n.success.call(l,m,h.response)||m),s.dispatch({type:"RECEIVE_EVENTS",sourceId:n.sourceId,fetchId:u,fetchRange:e,rawEvents:m})},h=>{let m=!1;i.eventSourceFailure&&(i.eventSourceFailure.call(l,h),m=!0),n.failure&&(n.failure(h),m=!0),m||console.warn(h.message,h),s.dispatch({type:"RECEIVE_EVENT_ERROR",sourceId:n.sourceId,fetchId:u,fetchRange:e,error:h})}),Object.assign(Object.assign({},n),{isFetching:!0,latestFetchId:u})}function w3(n,e,t,s){let i=n[e];return i&&t===i.latestFetchId?Object.assign(Object.assign({},n),{[e]:Object.assign(Object.assign({},i),{isFetching:!1,fetchRange:s})}):n}function hN(n,e){return Vi(n,t=>fN(t,e))}function A3(n,e){let t=MA(e),s=[].concat(n.eventSources||[]),i=[];n.initialEvents&&s.unshift(n.initialEvents),n.events&&s.unshift(n.events);for(let l of s){let c=kA(l,e,t);c&&i.push(c)}return i}function fN(n,e){return!e.pluginHooks.eventSourceDefs[n.sourceDefId].ignoreRange}function N3(n,e){switch(e.type){case"UNSELECT_DATES":return null;case"SELECT_DATES":return e.selection;default:return n}}function j3(n,e){switch(e.type){case"UNSELECT_EVENT":return"";case"SELECT_EVENT":return e.eventInstanceId;default:return n}}function S3(n,e){let t;switch(e.type){case"UNSET_EVENT_DRAG":return null;case"SET_EVENT_DRAG":return t=e.state,{affectedEvents:t.affectedEvents,mutatedEvents:t.mutatedEvents,isEvent:t.isEvent};default:return n}}function E3(n,e){let t;switch(e.type){case"UNSET_EVENT_RESIZE":return null;case"SET_EVENT_RESIZE":return t=e.state,{affectedEvents:t.affectedEvents,mutatedEvents:t.mutatedEvents,isEvent:t.isEvent};default:return n}}function _3(n,e,t,s,i){let l=n.headerToolbar?tw(n.headerToolbar,n,e,t,s,i):null,c=n.footerToolbar?tw(n.footerToolbar,n,e,t,s,i):null;return{header:l,footer:c}}function tw(n,e,t,s,i,l){let c={},u=[],h=!1;for(let m in n){let p=n[m],x=C3(p,e,t,s,i,l);c[m]=x.widgets,u.push(...x.viewsWithButtons),h=h||x.hasTitle}return{sectionWidgets:c,viewsWithButtons:u,hasTitle:h}}function C3(n,e,t,s,i,l){let c=e.direction==="rtl",u=e.customButtons||{},h=t.buttonText||{},m=e.buttonText||{},p=t.buttonHints||{},x=e.buttonHints||{},y=n?n.split(" "):[],v=[],w=!1;return{widgets:y.map(N=>N.split(",").map(j=>{if(j==="title")return w=!0,{buttonName:j};let _,C,k,D,P,F;if(_=u[j])k=U=>{_.click&&_.click.call(U.target,U,U.target)},(D=s.getCustomButtonIconClass(_))||(D=s.getIconClass(j,c))||(P=_.text),F=_.hint||_.text;else if(C=i[j]){v.push(j),k=()=>{l.changeView(j)},(P=C.buttonTextOverride)||(D=s.getIconClass(j,c))||(P=C.buttonTextDefault);let U=C.buttonTextOverride||C.buttonTextDefault;F=Ao(C.buttonTitleOverride||C.buttonTitleDefault||e.viewHint,[U,j],U)}else if(l[j])if(k=()=>{l[j]()},(P=h[j])||(D=s.getIconClass(j,c))||(P=m[j]),j==="prevYear"||j==="nextYear"){let U=j==="prevYear"?"prev":"next";F=Ao(p[U]||x[U],[m.year||"year","year"],m[j])}else F=U=>Ao(p[j]||x[j],[m[U]||U,U],m[j]);return{buttonName:j,buttonClick:k,buttonIcon:D,buttonText:P,buttonHint:F}})),viewsWithButtons:v,hasTitle:w}}class T3{constructor(e,t,s){this.type=e,this.getCurrentData=t,this.dateEnv=s}get calendar(){return this.getCurrentData().calendarApi}get title(){return this.getCurrentData().viewTitle}get activeStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start)}get activeEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end)}get currentStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start)}get currentEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end)}getOption(e){return this.getCurrentData().options[e]}}let D3={ignoreRange:!0,parseMeta(n){return Array.isArray(n.events)?n.events:null},fetch(n,e){e({rawEvents:n.eventSource.meta})}};const R3=ai({name:"array-event-source",eventSourceDefs:[D3]});let k3={parseMeta(n){return typeof n.events=="function"?n.events:null},fetch(n,e,t){const{dateEnv:s}=n.context,i=n.eventSource.meta;LM(i.bind(null,FA(n.range,s)),l=>e({rawEvents:l}),t)}};const M3=ai({name:"func-event-source",eventSourceDefs:[k3]}),L3={method:String,extraParams:ie,startParam:String,endParam:String,timeZoneParam:String};let O3={parseMeta(n){return n.url&&(n.format==="json"||!n.format)?{url:n.url,format:"json",method:(n.method||"GET").toUpperCase(),extraParams:n.extraParams,startParam:n.startParam,endParam:n.endParam,timeZoneParam:n.timeZoneParam}:null},fetch(n,e,t){const{meta:s}=n.eventSource,i=I3(s,n.range,n.context);OM(s.method,s.url,i).then(([l,c])=>{e({rawEvents:l,response:c})},t)}};const P3=ai({name:"json-event-source",eventSourceRefiners:L3,eventSourceDefs:[O3]});function I3(n,e,t){let{dateEnv:s,options:i}=t,l,c,u,h,m={};return l=n.startParam,l==null&&(l=i.startParam),c=n.endParam,c==null&&(c=i.endParam),u=n.timeZoneParam,u==null&&(u=i.timeZoneParam),typeof n.extraParams=="function"?h=n.extraParams():h=n.extraParams||{},Object.assign(m,h),m[l]=s.formatIso(e.start),m[c]=s.formatIso(e.end),s.timeZone!=="local"&&(m[u]=s.timeZone),m}const B3={daysOfWeek:ie,startTime:ot,endTime:ot,duration:ot,startRecur:ie,endRecur:ie};let H3={parse(n,e){if(n.daysOfWeek||n.startTime||n.endTime||n.startRecur||n.endRecur){let t={daysOfWeek:n.daysOfWeek||null,startTime:n.startTime||null,endTime:n.endTime||null,startRecur:n.startRecur?e.createMarker(n.startRecur):null,endRecur:n.endRecur?e.createMarker(n.endRecur):null,dateEnv:e},s;return n.duration&&(s=n.duration),!s&&n.startTime&&n.endTime&&(s=qR(n.endTime,n.startTime)),{allDayGuess:!n.startTime&&!n.endTime,duration:s,typeData:t}}return null},expand(n,e,t){let s=el(e,{start:n.startRecur,end:n.endRecur});return s?F3(n.daysOfWeek,n.startTime,n.dateEnv,t,s):[]}};const z3=ai({name:"simple-recurring-event",recurringTypes:[H3],eventRefiners:B3});function F3(n,e,t,s,i){let l=n?vA(n):null,c=Ct(i.start),u=i.end,h=[];for(e&&(e.milliseconds<0?u=is(u,1):e.milliseconds>=1e3*60*60*24&&(c=is(c,-1)));c<u;){let m;(!l||l[c.getUTCDay()])&&(e?m=s.add(c,e):m=c,h.push(s.createMarker(t.toDate(m)))),c=is(c,1)}return h}const U3=ai({name:"change-handler",optionChangeHandlers:{events(n,e){sw([n],e)},eventSources:sw}});function sw(n,e){let t=lg(e.getCurrentData().eventSources);if(t.length===1&&n.length===1&&Array.isArray(t[0]._raw)&&Array.isArray(n[0])){e.dispatch({type:"RESET_RAW_EVENTS",sourceId:t[0].sourceId,rawEvents:n[0]});return}let s=[];for(let i of n){let l=!1;for(let c=0;c<t.length;c+=1)if(t[c]._raw===i){t.splice(c,1),l=!0;break}l||s.push(i)}for(let i of t)e.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:i.sourceId});for(let i of s)e.calendarApi.addEventSource(i)}function $3(n,e){e.emitter.trigger("datesSet",Object.assign(Object.assign({},FA(n.activeRange,e.dateEnv)),{view:e.viewApi}))}function V3(n,e){let{emitter:t}=e;t.hasHandlers("eventsSet")&&t.trigger("eventsSet",Hi(n,e))}const q3=[R3,M3,P3,z3,U3,ai({name:"misc",isLoadingFuncs:[n=>cN(n.eventSources)],propSetHandlers:{dateProfile:$3,eventStore:V3}})];class G3{constructor(e,t){this.runTaskOption=e,this.drainedOption=t,this.queue=[],this.delayedRunner=new Jp(this.drain.bind(this))}request(e,t){this.queue.push(e),this.delayedRunner.request(t)}pause(e){this.delayedRunner.pause(e)}resume(e,t){this.delayedRunner.resume(e,t)}drain(){let{queue:e}=this;for(;e.length;){let t=[],s;for(;s=e.shift();)this.runTask(s),t.push(s);this.drained(t)}}runTask(e){this.runTaskOption&&this.runTaskOption(e)}drained(e){this.drainedOption&&this.drainedOption(e)}}function Y3(n,e,t){let s;return/^(year|month)$/.test(n.currentRangeUnit)?s=n.currentRange:s=n.activeRange,t.formatRange(s.start,s.end,as(e.titleFormat||W3(n)),{isEndExclusive:n.isRangeAllDay,defaultSeparator:e.titleRangeSeparator})}function W3(n){let{currentRangeUnit:e}=n;if(e==="year")return{year:"numeric"};if(e==="month")return{year:"numeric",month:"long"};let t=Jd(n.currentRange.start,n.currentRange.end);return t!==null&&t>1?{year:"numeric",month:"short",day:"numeric"}:{year:"numeric",month:"long",day:"numeric"}}class nw{constructor(){this.resetListeners=new Set}handleInput(e,t){const s=this.dateEnv;if(e!==s&&(typeof t=="function"?this.nowFn=t:s||(this.nowAnchorDate=e.toDate(t?e.createMarker(t):e.createNowMarker()),this.nowAnchorQueried=Date.now()),this.dateEnv=e,s))for(const i of this.resetListeners.values())i()}getDateMarker(){return this.nowAnchorDate?this.dateEnv.timestampToMarker(this.nowAnchorDate.valueOf()+(Date.now()-this.nowAnchorQueried)):this.dateEnv.createMarker(this.nowFn())}addResetListener(e){this.resetListeners.add(e)}removeResetListener(e){this.resetListeners.delete(e)}}class X3{constructor(e){this.computeCurrentViewData=rt(this._computeCurrentViewData),this.organizeRawLocales=rt(Z4),this.buildLocale=rt(lN),this.buildPluginHooks=t3(),this.buildDateEnv=rt(Q3),this.buildTheme=rt(Z3),this.parseToolbars=rt(_3),this.buildViewSpecs=rt(l3),this.buildDateProfileGenerator=Id(K3),this.buildViewApi=rt(J3),this.buildViewUiProps=Id(sL),this.buildEventUiBySource=rt(eL,Cn),this.buildEventUiBases=rt(tL),this.parseContextBusinessHours=Id(nL),this.buildTitle=rt(Y3),this.nowManager=new nw,this.emitter=new Ru,this.actionRunner=new G3(this._handleAction.bind(this),this.updateData.bind(this)),this.currentCalendarOptionsInput={},this.currentCalendarOptionsRefined={},this.currentViewOptionsInput={},this.currentViewOptionsRefined={},this.currentCalendarOptionsRefiners={},this.optionsForRefining=[],this.optionsForHandling=[],this.getCurrentData=()=>this.data,this.dispatch=y=>{this.actionRunner.request(y)},this.props=e,this.actionRunner.pause(),this.nowManager=new nw;let t={},s=this.computeOptionsData(e.optionOverrides,t,e.calendarApi),i=s.calendarOptions.initialView||s.pluginHooks.initialView,l=this.computeCurrentViewData(i,s,e.optionOverrides,t);e.calendarApi.currentDataManager=this,this.emitter.setThisContext(e.calendarApi),this.emitter.setOptions(l.options);let c={nowManager:this.nowManager,dateEnv:s.dateEnv,options:s.calendarOptions,pluginHooks:s.pluginHooks,calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},u=h3(s.calendarOptions,s.dateEnv,this.nowManager),h=l.dateProfileGenerator.build(u);Ka(h.activeRange,u)||(u=h.currentRange.start);for(let y of s.pluginHooks.contextInit)y(c);let m=p3(s.calendarOptions,h,c),p={dynamicOptionOverrides:t,currentViewType:i,currentDate:u,dateProfile:h,businessHours:this.parseContextBusinessHours(c),eventSources:m,eventUiBases:{},eventStore:Sn(),renderableEventStore:Sn(),dateSelection:null,eventSelection:"",eventDrag:null,eventResize:null,selectionConfig:this.buildViewUiProps(c).selectionConfig},x=Object.assign(Object.assign({},c),p);for(let y of s.pluginHooks.reducers)Object.assign(p,y(null,null,x));Pm(p,c)&&this.emitter.trigger("loading",!0),this.state=p,this.updateData(),this.actionRunner.resume()}resetOptions(e,t){let{props:s}=this;t===void 0?s.optionOverrides=e:(s.optionOverrides=Object.assign(Object.assign({},s.optionOverrides||{}),e),this.optionsForRefining.push(...t)),(t===void 0||t.length)&&this.actionRunner.request({type:"NOTHING"})}_handleAction(e){let{props:t,state:s,emitter:i}=this,l=f3(s.dynamicOptionOverrides,e),c=this.computeOptionsData(t.optionOverrides,l,t.calendarApi),u=d3(s.currentViewType,e),h=this.computeCurrentViewData(u,c,t.optionOverrides,l);t.calendarApi.currentDataManager=this,i.setThisContext(t.calendarApi),i.setOptions(h.options);let m={nowManager:this.nowManager,dateEnv:c.dateEnv,options:c.calendarOptions,pluginHooks:c.pluginHooks,calendarApi:t.calendarApi,dispatch:this.dispatch,emitter:i,getCurrentData:this.getCurrentData},{currentDate:p,dateProfile:x}=s;this.data&&this.data.dateProfileGenerator!==h.dateProfileGenerator&&(x=h.dateProfileGenerator.build(p)),p=u3(p,e),x=m3(x,e,p,h.dateProfileGenerator),(e.type==="PREV"||e.type==="NEXT"||!Ka(x.currentRange,p))&&(p=x.currentRange.start);let y=g3(s.eventSources,e,x,m),v=rM(s.eventStore,e,y,x,m),A=cN(y)&&!h.options.progressiveEventRendering&&s.renderableEventStore||v,{eventUiSingleBase:N,selectionConfig:j}=this.buildViewUiProps(m),_=this.buildEventUiBySource(y),C=this.buildEventUiBases(A.defs,N,_),k={dynamicOptionOverrides:l,currentViewType:u,currentDate:p,dateProfile:x,eventSources:y,eventStore:v,renderableEventStore:A,selectionConfig:j,eventUiBases:C,businessHours:this.parseContextBusinessHours(m),dateSelection:N3(s.dateSelection,e),eventSelection:j3(s.eventSelection,e),eventDrag:S3(s.eventDrag,e),eventResize:E3(s.eventResize,e)},D=Object.assign(Object.assign({},m),k);for(let U of c.pluginHooks.reducers)Object.assign(k,U(s,e,D));let P=Pm(s,m),F=Pm(k,m);!P&&F?i.trigger("loading",!0):P&&!F&&i.trigger("loading",!1),this.state=k,t.onAction&&t.onAction(e)}updateData(){let{props:e,state:t}=this,s=this.data,i=this.computeOptionsData(e.optionOverrides,t.dynamicOptionOverrides,e.calendarApi),l=this.computeCurrentViewData(t.currentViewType,i,e.optionOverrides,t.dynamicOptionOverrides),c=this.data=Object.assign(Object.assign(Object.assign({nowManager:this.nowManager,viewTitle:this.buildTitle(t.dateProfile,l.options,i.dateEnv),calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},i),l),t),u=i.pluginHooks.optionChangeHandlers,h=s&&s.calendarOptions,m=i.calendarOptions;if(h&&h!==m){h.timeZone!==m.timeZone&&(t.eventSources=c.eventSources=x3(c.eventSources,t.dateProfile,c),t.eventStore=c.eventStore=$v(c.eventStore,s.dateEnv,c.dateEnv),t.renderableEventStore=c.renderableEventStore=$v(c.renderableEventStore,s.dateEnv,c.dateEnv));for(let p in u)(this.optionsForHandling.indexOf(p)!==-1||h[p]!==m[p])&&u[p](m[p],c)}this.optionsForHandling=[],e.onData&&e.onData(c)}computeOptionsData(e,t,s){if(!this.optionsForRefining.length&&e===this.stableOptionOverrides&&t===this.stableDynamicOptionOverrides)return this.stableCalendarOptionsData;let{refinedOptions:i,pluginHooks:l,localeDefaults:c,availableLocaleData:u,extra:h}=this.processRawCalendarOptions(e,t);aw(h);let m=this.buildDateEnv(i.timeZone,i.locale,i.weekNumberCalculation,i.firstDay,i.weekText,l,u,i.defaultRangeSeparator),p=this.buildViewSpecs(l.views,this.stableOptionOverrides,this.stableDynamicOptionOverrides,c),x=this.buildTheme(i,l),y=this.parseToolbars(i,this.stableOptionOverrides,x,p,s);return this.stableCalendarOptionsData={calendarOptions:i,pluginHooks:l,dateEnv:m,viewSpecs:p,theme:x,toolbarConfig:y,localeDefaults:c,availableRawLocales:u.map}}processRawCalendarOptions(e,t){let{locales:s,locale:i}=Cm([No,e,t]),l=this.organizeRawLocales(s),c=l.map,u=this.buildLocale(i||l.defaultCode,c).options,h=this.buildPluginHooks(e.plugins||[],q3),m=this.currentCalendarOptionsRefiners=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Pv),Iv),Bv),h.listenerRefiners),h.optionRefiners),p={},x=Cm([No,u,e,t]),y={},v=this.currentCalendarOptionsInput,w=this.currentCalendarOptionsRefined,A=!1;for(let N in x)this.optionsForRefining.indexOf(N)===-1&&(x[N]===v[N]||_i[N]&&N in v&&_i[N](v[N],x[N]))?y[N]=w[N]:m[N]?(y[N]=m[N](x[N]),A=!0):p[N]=v[N];return A&&(this.currentCalendarOptionsInput=x,this.currentCalendarOptionsRefined=y,this.stableOptionOverrides=e,this.stableDynamicOptionOverrides=t),this.optionsForHandling.push(...this.optionsForRefining),this.optionsForRefining=[],{rawOptions:this.currentCalendarOptionsInput,refinedOptions:this.currentCalendarOptionsRefined,pluginHooks:h,availableLocaleData:l,localeDefaults:u,extra:p}}_computeCurrentViewData(e,t,s,i){let l=t.viewSpecs[e];if(!l)throw new Error(`viewType "${e}" is not available. Please make sure you've loaded all neccessary plugins`);let{refinedOptions:c,extra:u}=this.processRawViewOptions(l,t.pluginHooks,t.localeDefaults,s,i);aw(u),this.nowManager.handleInput(t.dateEnv,c.now);let h=this.buildDateProfileGenerator({dateProfileGeneratorClass:l.optionDefaults.dateProfileGeneratorClass,nowManager:this.nowManager,duration:l.duration,durationUnit:l.durationUnit,usesMinMaxTime:l.optionDefaults.usesMinMaxTime,dateEnv:t.dateEnv,calendarApi:this.props.calendarApi,slotMinTime:c.slotMinTime,slotMaxTime:c.slotMaxTime,showNonCurrentDates:c.showNonCurrentDates,dayCount:c.dayCount,dateAlignment:c.dateAlignment,dateIncrement:c.dateIncrement,hiddenDays:c.hiddenDays,weekends:c.weekends,validRangeInput:c.validRange,visibleRangeInput:c.visibleRange,fixedWeekCount:c.fixedWeekCount}),m=this.buildViewApi(e,this.getCurrentData,t.dateEnv);return{viewSpec:l,options:c,dateProfileGenerator:h,viewApi:m}}processRawViewOptions(e,t,s,i,l){let c=Cm([No,e.optionDefaults,s,i,e.optionOverrides,l]),u=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Pv),Iv),Bv),Nk),t.listenerRefiners),t.optionRefiners),h={},m=this.currentViewOptionsInput,p=this.currentViewOptionsRefined,x=!1,y={};for(let v in c)c[v]===m[v]||_i[v]&&_i[v](c[v],m[v])?h[v]=p[v]:(c[v]===this.currentCalendarOptionsInput[v]||_i[v]&&_i[v](c[v],this.currentCalendarOptionsInput[v])?v in this.currentCalendarOptionsRefined&&(h[v]=this.currentCalendarOptionsRefined[v]):u[v]?h[v]=u[v](c[v]):y[v]=c[v],x=!0);return x&&(this.currentViewOptionsInput=c,this.currentViewOptionsRefined=h),{rawOptions:this.currentViewOptionsInput,refinedOptions:this.currentViewOptionsRefined,extra:y}}}function Q3(n,e,t,s,i,l,c,u){let h=lN(e||c.defaultCode,c.map);return new Lk({calendarSystem:"gregory",timeZone:n,namedTimeZoneImpl:l.namedTimeZonedImpl,locale:h,weekNumberCalculation:t,firstDay:s,weekText:i,cmdFormatter:l.cmdFormatter,defaultSeparator:u})}function Z3(n,e){let t=e.themeClasses[n.themeSystem]||ii;return new t(n)}function K3(n){let e=n.dateProfileGeneratorClass||CA;return new e(n)}function J3(n,e,t){return new T3(n,e,t)}function eL(n){return Xi(n,e=>e.ui)}function tL(n,e,t){let s={"":e};for(let i in n){let l=n[i];l.sourceId&&t[l.sourceId]&&(s[i]=t[l.sourceId])}return s}function sL(n){let{options:e}=n;return{eventUiSingleBase:iu({display:e.eventDisplay,editable:e.editable,startEditable:e.eventStartEditable,durationEditable:e.eventDurationEditable,constraint:e.eventConstraint,overlap:typeof e.eventOverlap=="boolean"?e.eventOverlap:void 0,allow:e.eventAllow,backgroundColor:e.eventBackgroundColor,borderColor:e.eventBorderColor,textColor:e.eventTextColor,color:e.eventColor},n),selectionConfig:iu({constraint:e.selectConstraint,overlap:typeof e.selectOverlap=="boolean"?e.selectOverlap:void 0,allow:e.selectAllow},n)}}function Pm(n,e){for(let t of e.pluginHooks.isLoadingFuncs)if(t(n))return!0;return!1}function nL(n){return pM(n.options.businessHours,n)}function aw(n,e){for(let t in n)console.warn(`Unknown option '${t}'`)}class aL extends Lt{render(){let e=this.props.widgetGroups.map(t=>this.renderWidgetGroup(t));return re("div",{className:"fc-toolbar-chunk"},...e)}renderWidgetGroup(e){let{props:t}=this,{theme:s}=this.context,i=[],l=!0;for(let c of e){let{buttonName:u,buttonClick:h,buttonText:m,buttonIcon:p,buttonHint:x}=c;if(u==="title")l=!1,i.push(re("h2",{className:"fc-toolbar-title",id:t.titleId},t.title));else{let y=u===t.activeButton,v=!t.isTodayEnabled&&u==="today"||!t.isPrevEnabled&&u==="prev"||!t.isNextEnabled&&u==="next",w=[`fc-${u}-button`,s.getClass("button")];y&&w.push(s.getClass("buttonActive")),i.push(re("button",{type:"button",title:typeof x=="function"?x(t.navUnit):x,disabled:v,"aria-pressed":y,className:w.join(" "),onClick:h},m||(p?re("span",{className:p,role:"img"}):"")))}}if(i.length>1){let c=l&&s.getClass("buttonGroup")||"";return re("div",{className:c},...i)}return i[0]}}class iw extends Lt{render(){let{model:e,extraClassName:t}=this.props,s=!1,i,l,c=e.sectionWidgets,u=c.center;return c.left?(s=!0,i=c.left):i=c.start,c.right?(s=!0,l=c.right):l=c.end,re("div",{className:[t||"","fc-toolbar",s?"fc-toolbar-ltr":""].join(" ")},this.renderSection("start",i||[]),this.renderSection("center",u||[]),this.renderSection("end",l||[]))}renderSection(e,t){let{props:s}=this;return re(aL,{key:e,widgetGroups:t,title:s.title,navUnit:s.navUnit,activeButton:s.activeButton,isTodayEnabled:s.isTodayEnabled,isPrevEnabled:s.isPrevEnabled,isNextEnabled:s.isNextEnabled,titleId:s.titleId})}}class iL extends Lt{constructor(){super(...arguments),this.state={availableWidth:null},this.handleEl=e=>{this.el=e,Xn(this.props.elRef,e),this.updateAvailableWidth()},this.handleResize=()=>{this.updateAvailableWidth()}}render(){let{props:e,state:t}=this,{aspectRatio:s}=e,i=["fc-view-harness",s||e.liquid||e.height?"fc-view-harness-active":"fc-view-harness-passive"],l="",c="";return s?t.availableWidth!==null?l=t.availableWidth/s:c=`${1/s*100}%`:l=e.height||"",re("div",{"aria-labelledby":e.labeledById,ref:this.handleEl,className:i.join(" "),style:{height:l,paddingBottom:c}},e.children)}componentDidMount(){this.context.addResizeHandler(this.handleResize)}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}updateAvailableWidth(){this.el&&this.props.aspectRatio&&this.setState({availableWidth:this.el.offsetWidth})}}class rL extends cl{constructor(e){super(e),this.handleSegClick=(t,s)=>{let{component:i}=this,{context:l}=i,c=tl(s);if(c&&i.isValidSegDownEl(t.target)){let u=vs(t.target,".fc-event-forced-url"),h=u?u.querySelector("a[href]").href:"";l.emitter.trigger("eventClick",{el:s,event:new Tt(i.context,c.eventRange.def,c.eventRange.instance),jsEvent:t,view:l.viewApi}),h&&!t.defaultPrevented&&(window.location.href=h)}},this.destroy=gA(e.el,"click",".fc-event",this.handleSegClick)}}class lL extends cl{constructor(e){super(e),this.handleEventElRemove=t=>{t===this.currentSegEl&&this.handleSegLeave(null,this.currentSegEl)},this.handleSegEnter=(t,s)=>{tl(s)&&(this.currentSegEl=s,this.triggerEvent("eventMouseEnter",t,s))},this.handleSegLeave=(t,s)=>{this.currentSegEl&&(this.currentSegEl=null,this.triggerEvent("eventMouseLeave",t,s))},this.removeHoverListeners=DR(e.el,".fc-event",this.handleSegEnter,this.handleSegLeave)}destroy(){this.removeHoverListeners()}triggerEvent(e,t,s){let{component:i}=this,{context:l}=i,c=tl(s);(!t||i.isValidSegDownEl(t.target))&&l.emitter.trigger(e,{el:s,event:new Tt(l,c.eventRange.def,c.eventRange.instance),jsEvent:t,view:l.viewApi})}}class oL extends Zi{constructor(){super(...arguments),this.buildViewContext=rt(Ik),this.buildViewPropTransformers=rt(dL),this.buildToolbarProps=rt(cL),this.headerRef=ya(),this.footerRef=ya(),this.interactionsStore={},this.state={viewLabelId:_u()},this.registerInteractiveComponent=(e,t)=>{let s=BM(e,t),c=[rL,lL].concat(this.props.pluginHooks.componentInteractions).map(u=>new u(s));this.interactionsStore[e.uid]=c,fp[e.uid]=s},this.unregisterInteractiveComponent=e=>{let t=this.interactionsStore[e.uid];if(t){for(let s of t)s.destroy();delete this.interactionsStore[e.uid]}delete fp[e.uid]},this.resizeRunner=new Jp(()=>{this.props.emitter.trigger("_resize",!0),this.props.emitter.trigger("windowResize",{view:this.props.viewApi})}),this.handleWindowResize=e=>{let{options:t}=this.props;t.handleWindowResize&&e.target===window&&this.resizeRunner.request(t.windowResizeDelay)}}render(){let{props:e}=this,{toolbarConfig:t,options:s}=e,i=!1,l="",c;e.isHeightAuto||e.forPrint?l="":s.height!=null?i=!0:s.contentHeight!=null?l=s.contentHeight:c=Math.max(s.aspectRatio,.5);let u=this.buildViewContext(e.viewSpec,e.viewApi,e.options,e.dateProfileGenerator,e.dateEnv,e.nowManager,e.theme,e.pluginHooks,e.dispatch,e.getCurrentData,e.emitter,e.calendarApi,this.registerInteractiveComponent,this.unregisterInteractiveComponent),h=t.header&&t.header.hasTitle?this.state.viewLabelId:void 0;return re(Qi.Provider,{value:u},re(ku,{unit:"day"},m=>{let p=this.buildToolbarProps(e.viewSpec,e.dateProfile,e.dateProfileGenerator,e.currentDate,m,e.viewTitle);return re(It,null,t.header&&re(iw,Object.assign({ref:this.headerRef,extraClassName:"fc-header-toolbar",model:t.header,titleId:h},p)),re(iL,{liquid:i,height:l,aspectRatio:c,labeledById:h},this.renderView(e),this.buildAppendContent()),t.footer&&re(iw,Object.assign({ref:this.footerRef,extraClassName:"fc-footer-toolbar",model:t.footer,titleId:""},p)))}))}componentDidMount(){let{props:e}=this;this.calendarInteractions=e.pluginHooks.calendarInteractions.map(s=>new s(e)),window.addEventListener("resize",this.handleWindowResize);let{propSetHandlers:t}=e.pluginHooks;for(let s in t)t[s](e[s],e)}componentDidUpdate(e){let{props:t}=this,{propSetHandlers:s}=t.pluginHooks;for(let i in s)t[i]!==e[i]&&s[i](t[i],t)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),this.resizeRunner.clear();for(let e of this.calendarInteractions)e.destroy();this.props.emitter.trigger("_unmount")}buildAppendContent(){let{props:e}=this,t=e.pluginHooks.viewContainerAppends.map(s=>s(e));return re(It,{},...t)}renderView(e){let{pluginHooks:t}=e,{viewSpec:s}=e,i={dateProfile:e.dateProfile,businessHours:e.businessHours,eventStore:e.renderableEventStore,eventUiBases:e.eventUiBases,dateSelection:e.dateSelection,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,isHeightAuto:e.isHeightAuto,forPrint:e.forPrint},l=this.buildViewPropTransformers(t.viewPropsTransformers);for(let u of l)Object.assign(i,u.transform(i,e));let c=s.component;return re(c,Object.assign({},i))}}function cL(n,e,t,s,i,l){let c=t.build(i,void 0,!1),u=t.buildPrev(e,s,!1),h=t.buildNext(e,s,!1);return{title:l,activeButton:n.type,navUnit:n.singleUnit,isTodayEnabled:c.isValid&&!Ka(e.currentRange,i),isPrevEnabled:u.isValid,isNextEnabled:h.isValid}}function dL(n){return n.map(e=>new e)}class uL extends zM{constructor(e,t={}){super(),this.isRendering=!1,this.isRendered=!1,this.currentClassNames=[],this.customContentRenderId=0,this.handleAction=s=>{switch(s.type){case"SET_EVENT_DRAG":case"SET_EVENT_RESIZE":this.renderRunner.tryDrain()}},this.handleData=s=>{this.currentData=s,this.renderRunner.request(s.calendarOptions.rerenderDelay)},this.handleRenderRequest=()=>{if(this.isRendering){this.isRendered=!0;let{currentData:s}=this;nu(()=>{Mo(re(IM,{options:s.calendarOptions,theme:s.theme,emitter:s.emitter},(i,l,c,u)=>(this.setClassNames(i),this.setHeight(l),re(jA.Provider,{value:this.customContentRenderId},re(oL,Object.assign({isHeightAuto:c,forPrint:u},s))))),this.el)})}else this.isRendered&&(this.isRendered=!1,Mo(null,this.el),this.setClassNames([]),this.setHeight(""))},wR(e),this.el=e,this.renderRunner=new Jp(this.handleRenderRequest),new X3({optionOverrides:t,calendarApi:this,onAction:this.handleAction,onData:this.handleData})}render(){let e=this.isRendering;e?this.customContentRenderId+=1:this.isRendering=!0,this.renderRunner.request(),e&&this.updateSize()}destroy(){this.isRendering&&(this.isRendering=!1,this.renderRunner.request())}updateSize(){nu(()=>{super.updateSize()})}batchRendering(e){this.renderRunner.pause("batchRendering"),e(),this.renderRunner.resume("batchRendering")}pauseRendering(){this.renderRunner.pause("pauseRendering")}resumeRendering(){this.renderRunner.resume("pauseRendering",!0)}resetOptions(e,t){this.currentDataManager.resetOptions(e,t)}setClassNames(e){if(!ti(e,this.currentClassNames)){let{classList:t}=this.el;for(let s of this.currentClassNames)t.remove(s);for(let s of e)t.add(s);this.currentClassNames=e}}setHeight(e){mA(this.el,"height",e)}}const hL=parseInt(String(Eo.version).split(".")[0]),fL=hL<18;class mN extends E.Component{constructor(){super(...arguments),this.elRef=E.createRef(),this.isUpdating=!1,this.isUnmounting=!1,this.state={customRenderingMap:new Map},this.requestResize=()=>{this.isUnmounting||(this.cancelResize(),this.resizeId=requestAnimationFrame(()=>{this.doResize()}))}}render(){const e=[];for(const t of this.state.customRenderingMap.values())e.push(Eo.createElement(mL,{key:t.id,customRendering:t}));return Eo.createElement("div",{ref:this.elRef},e)}componentDidMount(){this.isUnmounting=!1;const e=new X4;this.handleCustomRendering=e.handle.bind(e),this.calendar=new uL(this.elRef.current,Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.calendar.render(),this.calendar.on("_beforeprint",()=>{Fm.flushSync(()=>{})});let t;e.subscribe(s=>{const i=Date.now(),l=!t;(fL||l||this.isUpdating||this.isUnmounting||i-t<100?pN:Fm.flushSync)(()=>{this.setState({customRenderingMap:s},()=>{t=i,l?this.doResize():this.requestResize()})})})}componentDidUpdate(){this.isUpdating=!0,this.calendar.resetOptions(Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.isUpdating=!1}componentWillUnmount(){this.isUnmounting=!0,this.cancelResize(),this.calendar.destroy()}doResize(){this.calendar.updateSize()}cancelResize(){this.resizeId!==void 0&&(cancelAnimationFrame(this.resizeId),this.resizeId=void 0)}getApi(){return this.calendar}}mN.act=pN;class mL extends E.PureComponent{render(){const{customRendering:e}=this.props,{generatorMeta:t}=e,s=typeof t=="function"?t(e.renderProps):t;return Fm.createPortal(s,e.containerEl)}}function pN(n){n()}class pL extends Ki{constructor(){super(...arguments),this.headerElRef=ya()}renderSimpleLayout(e,t){let{props:s,context:i}=this,l=[],c=Qv(i.options);return e&&l.push({type:"header",key:"header",isSticky:c,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),l.push({type:"body",key:"body",liquid:!0,chunk:{content:t}}),re(Hv,{elClasses:["fc-daygrid"],viewSpec:i.viewSpec},re(tN,{liquid:!s.isHeightAuto&&!s.forPrint,collapsibleWidth:s.forPrint,cols:[],sections:l}))}renderHScrollLayout(e,t,s,i){let l=this.context.pluginHooks.scrollGridImpl;if(!l)throw new Error("No ScrollGrid implementation");let{props:c,context:u}=this,h=!c.forPrint&&Qv(u.options),m=!c.forPrint&&D4(u.options),p=[];return e&&p.push({type:"header",key:"header",isSticky:h,chunks:[{key:"main",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),p.push({type:"body",key:"body",liquid:!0,chunks:[{key:"main",content:t}]}),m&&p.push({type:"footer",key:"footer",isSticky:!0,chunks:[{key:"main",content:T4}]}),re(Hv,{elClasses:["fc-daygrid"],viewSpec:u.viewSpec},re(l,{liquid:!c.isHeightAuto&&!c.forPrint,forPrint:c.forPrint,collapsibleWidth:c.forPrint,colGroups:[{cols:[{span:s,minWidth:i}]}],sections:p}))}}function Hd(n,e){let t=[];for(let s=0;s<e;s+=1)t[s]=[];for(let s of n)t[s.row].push(s);return t}function Sd(n,e){let t=[];for(let s=0;s<e;s+=1)t[s]=[];for(let s of n)t[s.firstCol].push(s);return t}function rw(n,e){let t=[];if(n){for(let s=0;s<e;s+=1)t[s]={affectedInstances:n.affectedInstances,isEvent:n.isEvent,segs:[]};for(let s of n.segs)t[s.row].segs.push(s)}else for(let s=0;s<e;s+=1)t[s]=null;return t}const gN=as({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"narrow"});function xN(n){let{display:e}=n.eventRange.ui;return e==="list-item"||e==="auto"&&!n.eventRange.def.allDay&&n.firstCol===n.lastCol&&n.isStart&&n.isEnd}class yN extends Lt{render(){let{props:e}=this;return re(sN,Object.assign({},e,{elClasses:["fc-daygrid-event","fc-daygrid-block-event","fc-h-event"],defaultTimeFormat:gN,defaultDisplayEventEnd:e.defaultDisplayEventEnd,disableResizing:!e.seg.eventRange.def.allDay}))}}class bN extends Lt{render(){let{props:e,context:t}=this,{options:s}=t,{seg:i}=e,l=s.eventTimeFormat||gN,c=HA(i,l,t,!0,e.defaultDisplayEventEnd);return re(wg,Object.assign({},e,{elTag:"a",elClasses:["fc-daygrid-event","fc-daygrid-dot-event"],elAttrs:zA(e.seg,t),defaultGenerator:gL,timeText:c,isResizing:!1,isDateSelecting:!1}))}}function gL(n){return re(It,null,re("div",{className:"fc-daygrid-event-dot",style:{borderColor:n.borderColor||n.backgroundColor}}),n.timeText&&re("div",{className:"fc-event-time"},n.timeText),re("div",{className:"fc-event-title"},n.event.title||re(It,null," ")))}class xL extends Lt{constructor(){super(...arguments),this.compileSegs=rt(yL)}render(){let{props:e}=this,{allSegs:t,invisibleSegs:s}=this.compileSegs(e.singlePlacements);return re(U4,{elClasses:["fc-daygrid-more-link"],dateProfile:e.dateProfile,todayRange:e.todayRange,allDayDate:e.allDayDate,moreCnt:e.moreCnt,allSegs:t,hiddenSegs:s,alignmentElRef:e.alignmentElRef,alignGridTop:e.alignGridTop,extraDateSpan:e.extraDateSpan,popoverContent:()=>{let i=(e.eventDrag?e.eventDrag.affectedInstances:null)||(e.eventResize?e.eventResize.affectedInstances:null)||{};return re(It,null,t.map(l=>{let c=l.eventRange.instance.instanceId;return re("div",{className:"fc-daygrid-event-harness",key:c,style:{visibility:i[c]?"hidden":""}},xN(l)?re(bN,Object.assign({seg:l,isDragging:!1,isSelected:c===e.eventSelection,defaultDisplayEventEnd:!1},jo(l,e.todayRange))):re(yN,Object.assign({seg:l,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:c===e.eventSelection,defaultDisplayEventEnd:!1},jo(l,e.todayRange))))}))}})}}function yL(n){let e=[],t=[];for(let s of n)e.push(s.seg),s.isVisible||t.push(s.seg);return{allSegs:e,invisibleSegs:t}}const bL=as({week:"narrow"});class vL extends Ki{constructor(){super(...arguments),this.rootElRef=ya(),this.state={dayNumberId:_u()},this.handleRootEl=e=>{Xn(this.rootElRef,e),Xn(this.props.elRef,e)}}render(){let{context:e,props:t,state:s,rootElRef:i}=this,{options:l,dateEnv:c}=e,{date:u,dateProfile:h}=t;const m=t.showDayNumber&&AL(u,h.currentRange,c);return re(nN,{elTag:"td",elRef:this.handleRootEl,elClasses:["fc-daygrid-day",...t.extraClassNames||[]],elAttrs:Object.assign(Object.assign(Object.assign({},t.extraDataAttrs),t.showDayNumber?{"aria-labelledby":s.dayNumberId}:{}),{role:"gridcell"}),defaultGenerator:wL,date:u,dateProfile:h,todayRange:t.todayRange,showDayNumber:t.showDayNumber,isMonthStart:m,extraRenderProps:t.extraRenderProps},(p,x)=>re("div",{ref:t.innerElRef,className:"fc-daygrid-day-frame fc-scrollgrid-sync-inner",style:{minHeight:t.minHeight}},t.showWeekNumber&&re(B4,{elTag:"a",elClasses:["fc-daygrid-week-number"],elAttrs:mp(e,u,"week"),date:u,defaultFormat:bL}),!x.isDisabled&&(t.showDayNumber||aN(l)||t.forceDayTop)?re("div",{className:"fc-daygrid-day-top"},re(p,{elTag:"a",elClasses:["fc-daygrid-day-number",m&&"fc-daygrid-month-start"],elAttrs:Object.assign(Object.assign({},mp(e,u)),{id:s.dayNumberId})})):t.showDayNumber?re("div",{className:"fc-daygrid-day-top",style:{visibility:"hidden"}},re("a",{className:"fc-daygrid-day-number"}," ")):void 0,re("div",{className:"fc-daygrid-day-events",ref:t.fgContentElRef},t.fgContent,re("div",{className:"fc-daygrid-day-bottom",style:{marginTop:t.moreMarginTop}},re(xL,{allDayDate:u,singlePlacements:t.singlePlacements,moreCnt:t.moreCnt,alignmentElRef:i,alignGridTop:!t.showDayNumber,extraDateSpan:t.extraDateSpan,dateProfile:t.dateProfile,eventSelection:t.eventSelection,eventDrag:t.eventDrag,eventResize:t.eventResize,todayRange:t.todayRange}))),re("div",{className:"fc-daygrid-day-bg"},t.bgContent)))}}function wL(n){return n.dayNumberText||re(It,null," ")}function AL(n,e,t){const{start:s,end:i}=e,l=si(i,-1),c=t.getYear(s),u=t.getMonth(s),h=t.getYear(l),m=t.getMonth(l);return!(c===h&&u===m)&&(n.valueOf()===s.valueOf()||t.getDay(n)===1&&n.valueOf()<i.valueOf())}function vN(n){return n.eventRange.instance.instanceId+":"+n.firstCol}function wN(n){return vN(n)+":"+n.lastCol}function NL(n,e,t,s,i,l,c){let u=new EL(j=>{let _=n[j.index].eventRange.instance.instanceId+":"+j.span.start+":"+(j.span.end-1);return i[_]||1});u.allowReslicing=!0,u.strictOrder=s,e===!0||t===!0?(u.maxCoord=l,u.hiddenConsumes=!0):typeof e=="number"?u.maxStackCnt=e:typeof t=="number"&&(u.maxStackCnt=t,u.hiddenConsumes=!0);let h=[],m=[];for(let j=0;j<n.length;j+=1){let _=n[j],C=wN(_);i[C]!=null?h.push({index:j,span:{start:_.firstCol,end:_.lastCol+1}}):m.push(_)}let p=u.addSegs(h),x=u.toRects(),{singleColPlacements:y,multiColPlacements:v,leftoverMargins:w}=jL(x,n,c),A=[],N=[];for(let j of m){v[j.firstCol].push({seg:j,isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let _=j.firstCol;_<=j.lastCol;_+=1)y[_].push({seg:Qr(j,_,_+1,c),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let j=0;j<c.length;j+=1)A.push(0);for(let j of p){let _=n[j.index],C=j.span;v[C.start].push({seg:Qr(_,C.start,C.end,c),isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let k=C.start;k<C.end;k+=1)A[k]+=1,y[k].push({seg:Qr(_,k,k+1,c),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let j=0;j<c.length;j+=1)N.push(w[j]);return{singleColPlacements:y,multiColPlacements:v,moreCnts:A,moreMarginTops:N}}function jL(n,e,t){let s=SL(n,t.length),i=[],l=[],c=[];for(let u=0;u<t.length;u+=1){let h=s[u],m=[],p=0,x=0;for(let v of h){let w=e[v.index];m.push({seg:Qr(w,u,u+1,t),isVisible:!0,isAbsolute:!1,absoluteTop:v.levelCoord,marginTop:v.levelCoord-p}),p=v.levelCoord+v.thickness}let y=[];p=0,x=0;for(let v of h){let w=e[v.index],A=v.span.end-v.span.start>1,N=v.span.start===u;x+=v.levelCoord-p,p=v.levelCoord+v.thickness,A?(x+=v.thickness,N&&y.push({seg:Qr(w,v.span.start,v.span.end,t),isVisible:!0,isAbsolute:!0,absoluteTop:v.levelCoord,marginTop:0})):N&&(y.push({seg:Qr(w,v.span.start,v.span.end,t),isVisible:!0,isAbsolute:!1,absoluteTop:v.levelCoord,marginTop:x}),x=0)}i.push(m),l.push(y),c.push(x)}return{singleColPlacements:i,multiColPlacements:l,leftoverMargins:c}}function SL(n,e){let t=[];for(let s=0;s<e;s+=1)t.push([]);for(let s of n)for(let i=s.span.start;i<s.span.end;i+=1)t[i].push(s);return t}function Qr(n,e,t,s){if(n.firstCol===e&&n.lastCol===t-1)return n;let i=n.eventRange,l=i.range,c=el(l,{start:s[e].date,end:is(s[t-1].date,1)});return Object.assign(Object.assign({},n),{firstCol:e,lastCol:t-1,eventRange:{def:i.def,ui:Object.assign(Object.assign({},i.ui),{durationEditable:!1}),instance:i.instance,range:c},isStart:n.isStart&&c.start.valueOf()===l.start.valueOf(),isEnd:n.isEnd&&c.end.valueOf()===l.end.valueOf()})}class EL extends s4{constructor(){super(...arguments),this.hiddenConsumes=!1,this.forceHidden={}}addSegs(e){const t=super.addSegs(e),{entriesByLevel:s}=this,i=l=>!this.forceHidden[So(l)];for(let l=0;l<s.length;l+=1)s[l]=s[l].filter(i);return t}handleInvalidInsertion(e,t,s){const{entriesByLevel:i,forceHidden:l}=this,{touchingEntry:c,touchingLevel:u,touchingLateral:h}=e;if(this.hiddenConsumes&&c){const m=So(c);if(!l[m])if(this.allowReslicing){const p=Object.assign(Object.assign({},c),{span:WA(c.span,t.span)}),x=So(p);l[x]=!0,i[u][h]=p,s.push(p),this.splitEntry(c,t,s)}else l[m]=!0,s.push(c)}super.handleInvalidInsertion(e,t,s)}}class AN extends Ki{constructor(){super(...arguments),this.cellElRefs=new Mi,this.frameElRefs=new Mi,this.fgElRefs=new Mi,this.segHarnessRefs=new Mi,this.rootElRef=ya(),this.state={framePositions:null,maxContentHeight:null,segHeights:{}},this.handleResize=e=>{e&&this.updateSizing(!0)}}render(){let{props:e,state:t,context:s}=this,{options:i}=s,l=e.cells.length,c=Sd(e.businessHourSegs,l),u=Sd(e.bgEventSegs,l),h=Sd(this.getHighlightSegs(),l),m=Sd(this.getMirrorSegs(),l),{singleColPlacements:p,multiColPlacements:x,moreCnts:y,moreMarginTops:v}=NL(vM(e.fgEventSegs,i.eventOrder),e.dayMaxEvents,e.dayMaxEventRows,i.eventOrderStrict,t.segHeights,t.maxContentHeight,e.cells),w=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{};return re("tr",{ref:this.rootElRef,role:"row"},e.renderIntro&&e.renderIntro(),e.cells.map((A,N)=>{let j=this.renderFgSegs(N,e.forPrint?p[N]:x[N],e.todayRange,w),_=this.renderFgSegs(N,_L(m[N],x),e.todayRange,{},!!e.eventDrag,!!e.eventResize,!1);return re(vL,{key:A.key,elRef:this.cellElRefs.createRef(A.key),innerElRef:this.frameElRefs.createRef(A.key),dateProfile:e.dateProfile,date:A.date,showDayNumber:e.showDayNumbers,showWeekNumber:e.showWeekNumbers&&N===0,forceDayTop:e.showWeekNumbers,todayRange:e.todayRange,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,extraRenderProps:A.extraRenderProps,extraDataAttrs:A.extraDataAttrs,extraClassNames:A.extraClassNames,extraDateSpan:A.extraDateSpan,moreCnt:y[N],moreMarginTop:v[N],singlePlacements:p[N],fgContentElRef:this.fgElRefs.createRef(A.key),fgContent:re(It,null,re(It,null,j),re(It,null,_)),bgContent:re(It,null,this.renderFillSegs(h[N],"highlight"),this.renderFillSegs(c[N],"non-business"),this.renderFillSegs(u[N],"bg-event")),minHeight:e.cellMinHeight})}))}componentDidMount(){this.updateSizing(!0),this.context.addResizeHandler(this.handleResize)}componentDidUpdate(e,t){let s=this.props;this.updateSizing(!Cn(e,s))}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}getHighlightSegs(){let{props:e}=this;return e.eventDrag&&e.eventDrag.segs.length?e.eventDrag.segs:e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:e.dateSelectionSegs}getMirrorSegs(){let{props:e}=this;return e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:[]}renderFgSegs(e,t,s,i,l,c,u){let{context:h}=this,{eventSelection:m}=this.props,{framePositions:p}=this.state,x=this.props.cells.length===1,y=l||c||u,v=[];if(p)for(let w of t){let{seg:A}=w,{instanceId:N}=A.eventRange.instance,j=w.isVisible&&!i[N],_=w.isAbsolute,C="",k="";_&&(h.isRtl?(k=0,C=p.lefts[A.lastCol]-p.lefts[A.firstCol]):(C=0,k=p.rights[A.firstCol]-p.rights[A.lastCol])),v.push(re("div",{className:"fc-daygrid-event-harness"+(_?" fc-daygrid-event-harness-abs":""),key:vN(A),ref:y?null:this.segHarnessRefs.createRef(wN(A)),style:{visibility:j?"":"hidden",marginTop:_?"":w.marginTop,top:_?w.absoluteTop:"",left:C,right:k}},xN(A)?re(bN,Object.assign({seg:A,isDragging:l,isSelected:N===m,defaultDisplayEventEnd:x},jo(A,s))):re(yN,Object.assign({seg:A,isDragging:l,isResizing:c,isDateSelecting:u,isSelected:N===m,defaultDisplayEventEnd:x},jo(A,s)))))}return v}renderFillSegs(e,t){let{isRtl:s}=this.context,{todayRange:i}=this.props,{framePositions:l}=this.state,c=[];if(l)for(let u of e){let h=s?{right:0,left:l.lefts[u.lastCol]-l.lefts[u.firstCol]}:{left:0,right:l.rights[u.firstCol]-l.rights[u.lastCol]};c.push(re("div",{key:EM(u.eventRange),className:"fc-daygrid-bg-harness",style:h},t==="bg-event"?re(O4,Object.assign({seg:u},jo(u,i))):I4(t)))}return re(It,{},...c)}updateSizing(e){let{props:t,state:s,frameElRefs:i}=this;if(!t.forPrint&&t.clientWidth!==null){if(e){let h=t.cells.map(m=>i.currentMap[m.key]);if(h.length){let m=this.rootElRef.current,p=new lu(m,h,!0,!1);(!s.framePositions||!s.framePositions.similarTo(p))&&this.setState({framePositions:new lu(m,h,!0,!1)})}}const l=this.state.segHeights,c=this.querySegHeights(),u=t.dayMaxEvents===!0||t.dayMaxEventRows===!0;this.safeSetState({segHeights:Object.assign(Object.assign({},l),c),maxContentHeight:u?this.computeMaxContentHeight():null})}}querySegHeights(){let e=this.segHarnessRefs.currentMap,t={};for(let s in e){let i=Math.round(e[s].getBoundingClientRect().height);t[s]=Math.max(t[s]||0,i)}return t}computeMaxContentHeight(){let e=this.props.cells[0].key,t=this.cellElRefs.currentMap[e],s=this.fgElRefs.currentMap[e];return t.getBoundingClientRect().bottom-s.getBoundingClientRect().top}getCellEls(){let e=this.cellElRefs.currentMap;return this.props.cells.map(t=>e[t.key])}}AN.addStateEquality({segHeights:Cn});function _L(n,e){if(!n.length)return[];let t=CL(e);return n.map(s=>({seg:s,isVisible:!0,isAbsolute:!0,absoluteTop:t[s.eventRange.instance.instanceId],marginTop:0}))}function CL(n){let e={};for(let t of n)for(let s of t)e[s.seg.eventRange.instance.instanceId]=s.absoluteTop;return e}class TL extends Ki{constructor(){super(...arguments),this.splitBusinessHourSegs=rt(Hd),this.splitBgEventSegs=rt(DL),this.splitFgEventSegs=rt(Hd),this.splitDateSelectionSegs=rt(Hd),this.splitEventDrag=rt(rw),this.splitEventResize=rt(rw),this.rowRefs=new Mi}render(){let{props:e,context:t}=this,s=e.cells.length,i=this.splitBusinessHourSegs(e.businessHourSegs,s),l=this.splitBgEventSegs(e.bgEventSegs,s),c=this.splitFgEventSegs(e.fgEventSegs,s),u=this.splitDateSelectionSegs(e.dateSelectionSegs,s),h=this.splitEventDrag(e.eventDrag,s),m=this.splitEventResize(e.eventResize,s),p=s>=7&&e.clientWidth?e.clientWidth/t.options.aspectRatio/6:null;return re(ku,{unit:"day"},(x,y)=>re(It,null,e.cells.map((v,w)=>re(AN,{ref:this.rowRefs.createRef(w),key:v.length?v[0].date.toISOString():w,showDayNumbers:s>1,showWeekNumbers:e.showWeekNumbers,todayRange:y,dateProfile:e.dateProfile,cells:v,renderIntro:e.renderRowIntro,businessHourSegs:i[w],eventSelection:e.eventSelection,bgEventSegs:l[w],fgEventSegs:c[w],dateSelectionSegs:u[w],eventDrag:h[w],eventResize:m[w],dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,clientWidth:e.clientWidth,clientHeight:e.clientHeight,cellMinHeight:p,forPrint:e.forPrint}))))}componentDidMount(){this.registerInteractiveComponent()}componentDidUpdate(){this.registerInteractiveComponent()}registerInteractiveComponent(){if(!this.rootEl){const e=this.rowRefs.currentMap[0].getCellEls()[0],t=e?e.closest(".fc-daygrid-body"):null;t&&(this.rootEl=t,this.context.registerInteractiveComponent(this,{el:t,isHitComboAllowed:this.props.isHitComboAllowed}))}}componentWillUnmount(){this.rootEl&&(this.context.unregisterInteractiveComponent(this),this.rootEl=null)}prepareHits(){this.rowPositions=new lu(this.rootEl,this.rowRefs.collect().map(e=>e.getCellEls()[0]),!1,!0),this.colPositions=new lu(this.rootEl,this.rowRefs.currentMap[0].getCellEls(),!0,!1)}queryHit(e,t){let{colPositions:s,rowPositions:i}=this,l=s.leftToIndex(e),c=i.topToIndex(t);if(c!=null&&l!=null){let u=this.props.cells[c][l];return{dateProfile:this.props.dateProfile,dateSpan:Object.assign({range:this.getCellRange(c,l),allDay:!0},u.extraDateSpan),dayEl:this.getCellEl(c,l),rect:{left:s.lefts[l],right:s.rights[l],top:i.tops[c],bottom:i.bottoms[c]},layer:0}}return null}getCellEl(e,t){return this.rowRefs.currentMap[e].getCellEls()[t]}getCellRange(e,t){let s=this.props.cells[e][t].date,i=is(s,1);return{start:s,end:i}}}function DL(n,e){return Hd(n.filter(RL),e)}function RL(n){return n.eventRange.def.allDay}class kL extends Ki{constructor(){super(...arguments),this.elRef=ya(),this.needsScrollReset=!1}render(){let{props:e}=this,{dayMaxEventRows:t,dayMaxEvents:s,expandRows:i}=e,l=s===!0||t===!0;l&&!i&&(l=!1,t=null,s=null);let c=["fc-daygrid-body",l?"fc-daygrid-body-balanced":"fc-daygrid-body-unbalanced",i?"":"fc-daygrid-body-natural"];return re("div",{ref:this.elRef,className:c.join(" "),style:{width:e.clientWidth,minWidth:e.tableMinWidth}},re("table",{role:"presentation",className:"fc-scrollgrid-sync-table",style:{width:e.clientWidth,minWidth:e.tableMinWidth,height:i?e.clientHeight:""}},e.colGroupNode,re("tbody",{role:"presentation"},re(TL,{dateProfile:e.dateProfile,cells:e.cells,renderRowIntro:e.renderRowIntro,showWeekNumbers:e.showWeekNumbers,clientWidth:e.clientWidth,clientHeight:e.clientHeight,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,dayMaxEvents:s,dayMaxEventRows:t,forPrint:e.forPrint,isHitComboAllowed:e.isHitComboAllowed}))))}componentDidMount(){this.requestScrollReset()}componentDidUpdate(e){e.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&this.props.clientWidth){const e=ML(this.elRef.current,this.props.dateProfile);if(e){const t=e.closest(".fc-daygrid-body"),s=t.closest(".fc-scroller"),i=e.getBoundingClientRect().top-t.getBoundingClientRect().top;s.scrollTop=i?i+1:0}this.needsScrollReset=!1}}}function ML(n,e){let t;return e.currentRangeUnit.match(/year|month/)&&(t=n.querySelector(`[data-date="${lk(e.currentDate)}-01"]`)),t||(t=n.querySelector(`[data-date="${ng(e.currentDate)}"]`)),t}class LL extends h4{constructor(){super(...arguments),this.forceDayIfListItem=!0}sliceRange(e,t){return t.sliceRange(e)}}class OL extends Ki{constructor(){super(...arguments),this.slicer=new LL,this.tableRef=ya()}render(){let{props:e,context:t}=this;return re(kL,Object.assign({ref:this.tableRef},this.slicer.sliceProps(e,e.dateProfile,e.nextDayThreshold,t,e.dayTableModel),{dateProfile:e.dateProfile,cells:e.dayTableModel.cells,colGroupNode:e.colGroupNode,tableMinWidth:e.tableMinWidth,renderRowIntro:e.renderRowIntro,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.showWeekNumbers,expandRows:e.expandRows,headerAlignElRef:e.headerAlignElRef,clientWidth:e.clientWidth,clientHeight:e.clientHeight,forPrint:e.forPrint}))}}class PL extends pL{constructor(){super(...arguments),this.buildDayTableModel=rt(IL),this.headerRef=ya(),this.tableRef=ya()}render(){let{options:e,dateProfileGenerator:t}=this.context,{props:s}=this,i=this.buildDayTableModel(s.dateProfile,t),l=e.dayHeaders&&re(o4,{ref:this.headerRef,dateProfile:s.dateProfile,dates:i.headerDates,datesRepDistinctDays:i.rowCnt===1}),c=u=>re(OL,{ref:this.tableRef,dateProfile:s.dateProfile,dayTableModel:i,businessHours:s.businessHours,dateSelection:s.dateSelection,eventStore:s.eventStore,eventUiBases:s.eventUiBases,eventSelection:s.eventSelection,eventDrag:s.eventDrag,eventResize:s.eventResize,nextDayThreshold:e.nextDayThreshold,colGroupNode:u.tableColGroupNode,tableMinWidth:u.tableMinWidth,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.weekNumbers,expandRows:!s.isHeightAuto,headerAlignElRef:this.headerElRef,clientWidth:u.clientWidth,clientHeight:u.clientHeight,forPrint:s.forPrint});return e.dayMinWidth?this.renderHScrollLayout(l,c,i.colCnt,e.dayMinWidth):this.renderSimpleLayout(l,c)}}function IL(n,e){let t=new d4(n.renderRange,e);return new u4(t,/year|month|week/.test(n.currentRangeUnit))}class BL extends CA{buildRenderRange(e,t,s){let i=super.buildRenderRange(e,t,s),{props:l}=this;return HL({currentRange:i,snapToWeek:/^(year|month)$/.test(t),fixedWeekCount:l.fixedWeekCount,dateEnv:l.dateEnv})}}function HL(n){let{dateEnv:e,currentRange:t}=n,{start:s,end:i}=t,l;if(n.snapToWeek&&(s=e.startOfWeek(s),l=e.startOfWeek(i),l.valueOf()!==i.valueOf()&&(i=Rv(l,1))),n.fixedWeekCount){let c=e.startOfWeek(e.startOfMonth(is(t.end,-1))),u=Math.ceil(XR(c,i));i=Rv(i,6-u)}return{start:s,end:i}}var zL=':root{--fc-daygrid-event-dot-width:8px}.fc-daygrid-day-events:after,.fc-daygrid-day-events:before,.fc-daygrid-day-frame:after,.fc-daygrid-day-frame:before,.fc-daygrid-event-harness:after,.fc-daygrid-event-harness:before{clear:both;content:"";display:table}.fc .fc-daygrid-body{position:relative;z-index:1}.fc .fc-daygrid-day.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-daygrid-day-frame{min-height:100%;position:relative}.fc .fc-daygrid-day-top{display:flex;flex-direction:row-reverse}.fc .fc-day-other .fc-daygrid-day-top{opacity:.3}.fc .fc-daygrid-day-number{padding:4px;position:relative;z-index:4}.fc .fc-daygrid-month-start{font-size:1.1em;font-weight:700}.fc .fc-daygrid-day-events{margin-top:1px}.fc .fc-daygrid-body-balanced .fc-daygrid-day-events{left:0;position:absolute;right:0}.fc .fc-daygrid-body-unbalanced .fc-daygrid-day-events{min-height:2em;position:relative}.fc .fc-daygrid-body-natural .fc-daygrid-day-events{margin-bottom:1em}.fc .fc-daygrid-event-harness{position:relative}.fc .fc-daygrid-event-harness-abs{left:0;position:absolute;right:0;top:0}.fc .fc-daygrid-bg-harness{bottom:0;position:absolute;top:0}.fc .fc-daygrid-day-bg .fc-non-business{z-index:1}.fc .fc-daygrid-day-bg .fc-bg-event{z-index:2}.fc .fc-daygrid-day-bg .fc-highlight{z-index:3}.fc .fc-daygrid-event{margin-top:1px;z-index:6}.fc .fc-daygrid-event.fc-event-mirror{z-index:7}.fc .fc-daygrid-day-bottom{font-size:.85em;margin:0 2px}.fc .fc-daygrid-day-bottom:after,.fc .fc-daygrid-day-bottom:before{clear:both;content:"";display:table}.fc .fc-daygrid-more-link{border-radius:3px;cursor:pointer;line-height:1;margin-top:1px;max-width:100%;overflow:hidden;padding:2px;position:relative;white-space:nowrap;z-index:4}.fc .fc-daygrid-more-link:hover{background-color:rgba(0,0,0,.1)}.fc .fc-daygrid-week-number{background-color:var(--fc-neutral-bg-color);color:var(--fc-neutral-text-color);min-width:1.5em;padding:2px;position:absolute;text-align:center;top:0;z-index:5}.fc .fc-more-popover .fc-popover-body{min-width:220px;padding:10px}.fc-direction-ltr .fc-daygrid-event.fc-event-start,.fc-direction-rtl .fc-daygrid-event.fc-event-end{margin-left:2px}.fc-direction-ltr .fc-daygrid-event.fc-event-end,.fc-direction-rtl .fc-daygrid-event.fc-event-start{margin-right:2px}.fc-direction-ltr .fc-daygrid-more-link{float:left}.fc-direction-ltr .fc-daygrid-week-number{border-radius:0 0 3px 0;left:0}.fc-direction-rtl .fc-daygrid-more-link{float:right}.fc-direction-rtl .fc-daygrid-week-number{border-radius:0 0 0 3px;right:0}.fc-liquid-hack .fc-daygrid-day-frame{position:static}.fc-daygrid-event{border-radius:3px;font-size:var(--fc-small-font-size);position:relative;white-space:nowrap}.fc-daygrid-block-event .fc-event-time{font-weight:700}.fc-daygrid-block-event .fc-event-time,.fc-daygrid-block-event .fc-event-title{padding:1px}.fc-daygrid-dot-event{align-items:center;display:flex;padding:2px 0}.fc-daygrid-dot-event .fc-event-title{flex-grow:1;flex-shrink:1;font-weight:700;min-width:0;overflow:hidden}.fc-daygrid-dot-event.fc-event-mirror,.fc-daygrid-dot-event:hover{background:rgba(0,0,0,.1)}.fc-daygrid-dot-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-daygrid-event-dot{border:calc(var(--fc-daygrid-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-daygrid-event-dot-width)/2);box-sizing:content-box;height:0;margin:0 4px;width:0}.fc-direction-ltr .fc-daygrid-event .fc-event-time{margin-right:3px}.fc-direction-rtl .fc-daygrid-event .fc-event-time{margin-left:3px}';uA(zL);var FL=ai({name:"@fullcalendar/daygrid",initialView:"dayGridMonth",views:{dayGrid:{component:PL,dateProfileGeneratorClass:BL},dayGridDay:{type:"dayGrid",duration:{days:1}},dayGridWeek:{type:"dayGrid",duration:{weeks:1}},dayGridMonth:{type:"dayGrid",duration:{months:1},fixedWeekCount:!0},dayGridYear:{type:"dayGrid",duration:{years:1}}}});vg.touchMouseIgnoreWait=500;let gp=0,ou=0,xp=!1;class NN{constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=t=>{if(!this.shouldIgnoreMouse()&&UL(t)&&this.tryStart(t)){let s=this.createEventFromMouse(t,!0);this.emitter.trigger("pointerdown",s),this.initScrollWatch(s),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=t=>{let s=this.createEventFromMouse(t);this.recordCoords(s),this.emitter.trigger("pointermove",s)},this.handleMouseUp=t=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(t)),this.cleanup()},this.handleTouchStart=t=>{if(this.tryStart(t)){this.isTouchDragging=!0;let s=this.createEventFromTouch(t,!0);this.emitter.trigger("pointerdown",s),this.initScrollWatch(s);let i=t.target;this.shouldIgnoreMove||i.addEventListener("touchmove",this.handleTouchMove),i.addEventListener("touchend",this.handleTouchEnd),i.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=t=>{let s=this.createEventFromTouch(t);this.recordCoords(s),this.emitter.trigger("pointermove",s)},this.handleTouchEnd=t=>{if(this.isDragging){let s=t.target;s.removeEventListener("touchmove",this.handleTouchMove),s.removeEventListener("touchend",this.handleTouchEnd),s.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(t)),this.cleanup(),this.isTouchDragging=!1,$L()}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=t=>{if(!this.shouldIgnoreMove){let s=window.scrollX-this.prevScrollX+this.prevPageX,i=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:t,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:s,pageY:i,deltaX:s-this.origPageX,deltaY:i-this.origPageY})}},this.containerEl=e,this.emitter=new Ru,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),VL()}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),qL()}tryStart(e){let t=this.querySubjectEl(e),s=e.target;return t&&(!this.handleSelector||vs(s,this.handleSelector))?(this.subjectEl=t,this.isDragging=!0,this.wasTouchScroll=!1,!0):!1}cleanup(){xp=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?vs(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return gp||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(xp=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,t){let s=0,i=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(s=e.pageX-this.origPageX,i=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:s,deltaY:i}}createEventFromTouch(e,t){let s=e.touches,i,l,c=0,u=0;return s&&s.length?(i=s[0].pageX,l=s[0].pageY):(i=e.pageX,l=e.pageY),t?(this.origPageX=i,this.origPageY=l):(c=i-this.origPageX,u=l-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:i,pageY:l,deltaX:c,deltaY:u}}}function UL(n){return n.button===0&&!n.ctrlKey}function $L(){gp+=1,setTimeout(()=>{gp-=1},vg.touchMouseIgnoreWait)}function VL(){ou+=1,ou===1&&window.addEventListener("touchmove",jN,{passive:!1})}function qL(){ou-=1,ou||window.removeEventListener("touchmove",jN,{passive:!1})}function jN(n){xp&&n.preventDefault()}class GL{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,t,s){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.scrollX,this.origScreenY=s-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,t){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=t-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,t){let s=()=>{this.cleanup(),t()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(s,this.revertDuration):setTimeout(s,0)}doRevertAnimation(e,t){let s=this.mirrorEl,i=this.sourceEl.getBoundingClientRect();s.style.transition="top "+t+"ms,left "+t+"ms",wo(s,{left:i.left,top:i.top}),RR(s,()=>{s.style.transition="",e()})}cleanup(){this.mirrorEl&&(eg(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&wo(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,t=this.mirrorEl;return t||(t=this.mirrorEl=this.sourceEl.cloneNode(!0),t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.pointerEvents="none",t.classList.add("fc-event-dragging"),wo(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t}}class SN extends bg{constructor(e,t){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=t,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}}class EN extends SN{constructor(e,t){super(new e4(e),t)}getEventTarget(){return this.scrollController.el}computeClientRect(){return KM(this.scrollController.el)}}class YL extends SN{constructor(e){super(new t4,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}}const lw=typeof performance=="function"?performance.now:Date.now;class WL{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let t=lw();this.handleSide(e,(t-this.msSinceRequest)/1e3),this.requestAnimation(t)}else this.isAnimating=!1}}}start(e,t,s){this.isEnabled&&(this.scrollCaches=this.buildCaches(s),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))}handleMove(e,t){if(this.isEnabled){let s=e-window.scrollX,i=t-window.scrollY,l=this.pointerScreenY===null?0:i-this.pointerScreenY,c=this.pointerScreenX===null?0:s-this.pointerScreenX;l<0?this.everMovedUp=!0:l>0&&(this.everMovedDown=!0),c<0?this.everMovedLeft=!0:c>0&&(this.everMovedRight=!0),this.pointerScreenX=s,this.pointerScreenY=i,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(lw()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,t){let{scrollCache:s}=e,{edgeThreshold:i}=this,l=i-e.distance,c=l*l/(i*i)*this.maxVelocity*t,u=1;switch(e.name){case"left":u=-1;case"right":s.setScrollLeft(s.getScrollLeft()+c*u);break;case"top":u=-1;case"bottom":s.setScrollTop(s.getScrollTop()+c*u);break}}computeBestEdge(e,t){let{edgeThreshold:s}=this,i=null,l=this.scrollCaches||[];for(let c of l){let u=c.clientRect,h=e-u.left,m=u.right-e,p=t-u.top,x=u.bottom-t;h>=0&&m>=0&&p>=0&&x>=0&&(p<=s&&this.everMovedUp&&c.canScrollUp()&&(!i||i.distance>p)&&(i={scrollCache:c,name:"top",distance:p}),x<=s&&this.everMovedDown&&c.canScrollDown()&&(!i||i.distance>x)&&(i={scrollCache:c,name:"bottom",distance:x}),h<=s&&this.everMovedLeft&&c.canScrollLeft()&&(!i||i.distance>h)&&(i={scrollCache:c,name:"left",distance:h}),m<=s&&this.everMovedRight&&c.canScrollRight()&&(!i||i.distance>m)&&(i={scrollCache:c,name:"right",distance:m}))}return i}buildCaches(e){return this.queryScrollEls(e).map(t=>t===window?new YL(!1):new EN(t,!1))}queryScrollEls(e){let t=[];for(let s of this.scrollQuery)typeof s=="object"?t.push(s):t.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(s)));return t}}class Ko extends n4{constructor(e,t){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=i=>{this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,kR(document.body),LR(document.body),i.isTouch||i.origEvent.preventDefault(),this.emitter.trigger("pointerdown",i),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(i.subjectEl,i.pageX,i.pageY),this.startDelay(i),this.minDistance||this.handleDistanceSurpassed(i)))},this.onPointerMove=i=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",i),!this.isDistanceSurpassed){let l=this.minDistance,c,{deltaX:u,deltaY:h}=i;c=u*u+h*h,c>=l*l&&this.handleDistanceSurpassed(i)}this.isDragging&&(i.origEvent.type!=="scroll"&&(this.mirror.handleMove(i.pageX,i.pageY),this.autoScroller.handleMove(i.pageX,i.pageY)),this.emitter.trigger("dragmove",i))}},this.onPointerUp=i=>{this.isInteracting&&(this.isInteracting=!1,MR(document.body),OR(document.body),this.emitter.trigger("pointerup",i),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(i)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let s=this.pointer=new NN(e);s.emitter.on("pointerdown",this.onPointerDown),s.emitter.on("pointermove",this.onPointerMove),s.emitter.on("pointerup",this.onPointerUp),t&&(s.selector=t),this.mirror=new GL,this.autoScroller=new WL}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){typeof this.delay=="number"?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(!this.pointer.wasTouchScroll||this.touchScrollAllowed)&&(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),this.touchScrollAllowed===!1&&this.pointer.cancelTouchScroll())}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}}class XL{constructor(e){this.el=e,this.origRect=yg(e),this.scrollCaches=YA(e).map(t=>new EN(t,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let t of this.scrollCaches)e+=t.origScrollLeft-t.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let t of this.scrollCaches)e+=t.origScrollTop-t.getScrollTop();return e}isWithinClipping(e,t){let s={left:e,top:t};for(let i of this.scrollCaches)if(!QL(i.getEventTarget())&&!FM(s,i.clientRect))return!1;return!0}}function QL(n){let e=n.tagName;return e==="HTML"||e==="BODY"}class Mu{constructor(e,t){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=s=>{let{dragging:i}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(s),this.initialHit||!this.requireInitial?(i.setIgnoreMove(!1),this.emitter.trigger("pointerdown",s)):i.setIgnoreMove(!0)},this.handleDragStart=s=>{this.emitter.trigger("dragstart",s),this.handleMove(s,!0)},this.handleDragMove=s=>{this.emitter.trigger("dragmove",s),this.handleMove(s)},this.handlePointerUp=s=>{this.releaseHits(),this.emitter.trigger("pointerup",s)},this.handleDragEnd=s=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,s),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",s)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new Ru}processFirstCoord(e){let t={left:e.pageX,top:e.pageY},s=t,i=e.subjectEl,l;i instanceof HTMLElement&&(l=yg(i),s=UM(s,l));let c=this.initialHit=this.queryHitForOffset(s.left,s.top);if(c){if(this.useSubjectCenter&&l){let u=VA(l,c.rect);u&&(s=$M(u))}this.coordAdjust=VM(s,t)}else this.coordAdjust={left:0,top:0}}handleMove(e,t){let s=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);(t||!Lu(this.movingHit,s))&&(this.movingHit=s,this.emitter.trigger("hitupdate",s,!1,e))}prepareHits(){this.offsetTrackers=Xi(this.droppableStore,e=>(e.component.prepareHits(),new XL(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let t in e)e[t].destroy();this.offsetTrackers={}}queryHitForOffset(e,t){let{droppableStore:s,offsetTrackers:i}=this,l=null;for(let c in s){let u=s[c].component,h=i[c];if(h&&h.isWithinClipping(e,t)){let m=h.computeLeft(),p=h.computeTop(),x=e-m,y=t-p,{origRect:v}=h,w=v.right-v.left,A=v.bottom-v.top;if(x>=0&&x<w&&y>=0&&y<A){let N=u.queryHit(x,y,w,A);N&&Tu(N.dateProfile.activeRange,N.dateSpan.range)&&(this.disablePointCheck||h.el.contains(h.el.getRootNode().elementFromPoint(x+m-window.scrollX,y+p-window.scrollY)))&&(!l||N.layer>l.layer)&&(N.componentId=c,N.context=u.context,N.rect.left+=m,N.rect.right+=m,N.rect.top+=p,N.rect.bottom+=p,l=N)}}}return l}}function Lu(n,e){return!n&&!e?!0:!!n!=!!e?!1:DM(n.dateSpan,e.dateSpan)}function _N(n,e){let t={};for(let s of e.pluginHooks.datePointTransforms)Object.assign(t,s(n,e));return Object.assign(t,ZL(n,e.dateEnv)),t}function ZL(n,e){return{date:e.toDate(n.range.start),dateStr:e.formatIso(n.range.start,{omitTime:n.allDay}),allDay:n.allDay}}class KL extends cl{constructor(e){super(e),this.handlePointerDown=s=>{let{dragging:i}=this,l=s.origEvent.target;i.setIgnoreMove(!this.component.isValidDateDownEl(l))},this.handleDragEnd=s=>{let{component:i}=this,{pointer:l}=this.dragging;if(!l.wasTouchScroll){let{initialHit:c,finalHit:u}=this.hitDragging;if(c&&u&&Lu(c,u)){let{context:h}=i,m=Object.assign(Object.assign({},_N(c.dateSpan,h)),{dayEl:c.dayEl,jsEvent:s.origEvent,view:h.viewApi||h.calendarApi.view});h.emitter.trigger("dateClick",m)}}},this.dragging=new Ko(e.el),this.dragging.autoScroller.isEnabled=!1;let t=this.hitDragging=new Mu(this.dragging,gg(e));t.emitter.on("pointerdown",this.handlePointerDown),t.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}}class JL extends cl{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=c=>{let{component:u,dragging:h}=this,{options:m}=u.context,p=m.selectable&&u.isValidDateDownEl(c.origEvent.target);h.setIgnoreMove(!p),h.delay=c.isTouch?eO(u):null},this.handleDragStart=c=>{this.component.context.calendarApi.unselect(c)},this.handleHitUpdate=(c,u)=>{let{context:h}=this.component,m=null,p=!1;if(c){let x=this.hitDragging.initialHit;c.componentId===x.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(x,c)||(m=tO(x,c,h.pluginHooks.dateSelectionTransformers)),(!m||!f4(m,c.dateProfile,h))&&(p=!0,m=null)}m?h.dispatch({type:"SELECT_DATES",selection:m}):u||h.dispatch({type:"UNSELECT_DATES"}),p?tg():sg(),u||(this.dragSelection=m)},this.handlePointerUp=c=>{this.dragSelection&&(PA(this.dragSelection,c,this.component.context),this.dragSelection=null)};let{component:t}=e,{options:s}=t.context,i=this.dragging=new Ko(e.el);i.touchScrollAllowed=!1,i.minDistance=s.selectMinDistance||0,i.autoScroller.isEnabled=s.dragScroll;let l=this.hitDragging=new Mu(this.dragging,gg(e));l.emitter.on("pointerdown",this.handlePointerDown),l.emitter.on("dragstart",this.handleDragStart),l.emitter.on("hitupdate",this.handleHitUpdate),l.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}}function eO(n){let{options:e}=n.context,t=e.selectLongPressDelay;return t==null&&(t=e.longPressDelay),t}function tO(n,e,t){let s=n.dateSpan,i=e.dateSpan,l=[s.range.start,s.range.end,i.range.start,i.range.end];l.sort(zR);let c={};for(let u of t){let h=u(n,e);if(h===!1)return null;h&&Object.assign(c,h)}return c.range={start:l[0],end:l[3]},c.allDay=s.allDay,c}class Jo extends cl{constructor(e){super(e),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=c=>{let u=c.origEvent.target,{component:h,dragging:m}=this,{mirror:p}=m,{options:x}=h.context,y=h.context;this.subjectEl=c.subjectEl;let v=this.subjectSeg=tl(c.subjectEl),A=(this.eventRange=v.eventRange).instance.instanceId;this.relevantEvents=hg(y.getCurrentData().eventStore,A),m.minDistance=c.isTouch?0:x.eventDragMinDistance,m.delay=c.isTouch&&A!==h.props.eventSelection?nO(h):null,x.fixedMirrorParent?p.parentNode=x.fixedMirrorParent:p.parentNode=vs(u,".fc"),p.revertDuration=x.dragRevertDuration;let N=h.isValidSegDownEl(u)&&!vs(u,".fc-event-resizer");m.setIgnoreMove(!N),this.isDragging=N&&c.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=c=>{let u=this.component.context,h=this.eventRange,m=h.instance.instanceId;c.isTouch?m!==this.component.props.eventSelection&&u.dispatch({type:"SELECT_EVENT",eventInstanceId:m}):u.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(u.calendarApi.unselect(c),u.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new Tt(u,h.def,h.instance),jsEvent:c.origEvent,view:u.viewApi}))},this.handleHitUpdate=(c,u)=>{if(!this.isDragging)return;let h=this.relevantEvents,m=this.hitDragging.initialHit,p=this.component.context,x=null,y=null,v=null,w=!1,A={affectedEvents:h,mutatedEvents:Sn(),isEvent:!0};if(c){x=c.context;let N=x.options;p===x||N.editable&&N.droppable?(y=sO(m,c,this.eventRange.instance.range.start,x.getCurrentData().pluginHooks.eventDragMutationMassagers),y&&(v=pg(h,x.getCurrentData().eventUiBases,y,x),A.mutatedEvents=v,ZA(A,c.dateProfile,x)||(w=!0,y=null,v=null,A.mutatedEvents=Sn()))):x=null}this.displayDrag(x,A),w?tg():sg(),u||(p===x&&Lu(m,c)&&(y=null),this.dragging.setMirrorNeedsRevert(!y),this.dragging.setMirrorIsVisible(!c||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=x,this.validMutation=y,this.mutatedRelevantEvents=v)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=c=>{if(this.isDragging){let u=this.component.context,h=u.viewApi,{receivingContext:m,validMutation:p}=this,x=this.eventRange.def,y=this.eventRange.instance,v=new Tt(u,x,y),w=this.relevantEvents,A=this.mutatedRelevantEvents,{finalHit:N}=this.hitDragging;if(this.clearDrag(),u.emitter.trigger("eventDragStop",{el:this.subjectEl,event:v,jsEvent:c.origEvent,view:h}),p){if(m===u){let j=new Tt(u,A.defs[x.defId],y?A.instances[y.instanceId]:null);u.dispatch({type:"MERGE_EVENTS",eventStore:A});let _={oldEvent:v,event:j,relatedEvents:Hi(A,u,y),revert(){u.dispatch({type:"MERGE_EVENTS",eventStore:w})}},C={};for(let k of u.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(C,k(p,u));u.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},_),C),{el:c.subjectEl,delta:p.datesDelta,jsEvent:c.origEvent,view:h})),u.emitter.trigger("eventChange",_)}else if(m){let j={event:v,relatedEvents:Hi(w,u,y),revert(){u.dispatch({type:"MERGE_EVENTS",eventStore:w})}};u.emitter.trigger("eventLeave",Object.assign(Object.assign({},j),{draggedEl:c.subjectEl,view:h})),u.dispatch({type:"REMOVE_EVENTS",eventStore:w}),u.emitter.trigger("eventRemove",j);let _=A.defs[x.defId],C=A.instances[y.instanceId],k=new Tt(m,_,C);m.dispatch({type:"MERGE_EVENTS",eventStore:A});let D={event:k,relatedEvents:Hi(A,m,C),revert(){m.dispatch({type:"REMOVE_EVENTS",eventStore:A})}};m.emitter.trigger("eventAdd",D),c.isTouch&&m.dispatch({type:"SELECT_EVENT",eventInstanceId:y.instanceId}),m.emitter.trigger("drop",Object.assign(Object.assign({},_N(N.dateSpan,m)),{draggedEl:c.subjectEl,jsEvent:c.origEvent,view:N.context.viewApi})),m.emitter.trigger("eventReceive",Object.assign(Object.assign({},D),{draggedEl:c.subjectEl,view:N.context.viewApi}))}}else u.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:t}=this,{options:s}=t.context,i=this.dragging=new Ko(e.el);i.pointer.selector=Jo.SELECTOR,i.touchScrollAllowed=!1,i.autoScroller.isEnabled=s.dragScroll;let l=this.hitDragging=new Mu(this.dragging,fp);l.useSubjectCenter=e.useEventCenter,l.emitter.on("pointerdown",this.handlePointerDown),l.emitter.on("dragstart",this.handleDragStart),l.emitter.on("hitupdate",this.handleHitUpdate),l.emitter.on("pointerup",this.handlePointerUp),l.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(e,t){let s=this.component.context,i=this.receivingContext;i&&i!==e&&(i===s?i.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:t.affectedEvents,mutatedEvents:Sn(),isEvent:!0}}):i.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})}clearDrag(){let e=this.component.context,{receivingContext:t}=this;t&&t.dispatch({type:"UNSET_EVENT_DRAG"}),e!==t&&e.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}}Jo.SELECTOR=".fc-event-draggable, .fc-event-resizable";function sO(n,e,t,s){let i=n.dateSpan,l=e.dateSpan,c=i.range.start,u=l.range.start,h={};i.allDay!==l.allDay&&(h.allDay=l.allDay,h.hasEnd=e.context.options.allDayMaintainDuration,l.allDay?c=Ct(t):c=t);let m=Gr(c,u,n.context.dateEnv,n.componentId===e.componentId?n.largeUnit:null);m.milliseconds&&(h.allDay=!1);let p={datesDelta:m,standardProps:h};for(let x of s)x(p,n,e);return p}function nO(n){let{options:e}=n.context,t=e.eventLongPressDelay;return t==null&&(t=e.longPressDelay),t}class aO extends cl{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=l=>{let{component:c}=this,u=this.querySegEl(l),h=tl(u),m=this.eventRange=h.eventRange;this.dragging.minDistance=c.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(l.origEvent.target)||l.isTouch&&this.component.props.eventSelection!==m.instance.instanceId)},this.handleDragStart=l=>{let{context:c}=this.component,u=this.eventRange;this.relevantEvents=hg(c.getCurrentData().eventStore,this.eventRange.instance.instanceId);let h=this.querySegEl(l);this.draggingSegEl=h,this.draggingSeg=tl(h),c.calendarApi.unselect(),c.emitter.trigger("eventResizeStart",{el:h,event:new Tt(c,u.def,u.instance),jsEvent:l.origEvent,view:c.viewApi})},this.handleHitUpdate=(l,c,u)=>{let{context:h}=this.component,m=this.relevantEvents,p=this.hitDragging.initialHit,x=this.eventRange.instance,y=null,v=null,w=!1,A={affectedEvents:m,mutatedEvents:Sn(),isEvent:!0};l&&(l.componentId===p.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(p,l)||(y=iO(p,l,u.subjectEl.classList.contains("fc-event-resizer-start"),x.range))),y&&(v=pg(m,h.getCurrentData().eventUiBases,y,h),A.mutatedEvents=v,ZA(A,l.dateProfile,h)||(w=!0,y=null,v=null,A.mutatedEvents=null)),v?h.dispatch({type:"SET_EVENT_RESIZE",state:A}):h.dispatch({type:"UNSET_EVENT_RESIZE"}),w?tg():sg(),c||(y&&Lu(p,l)&&(y=null),this.validMutation=y,this.mutatedRelevantEvents=v)},this.handleDragEnd=l=>{let{context:c}=this.component,u=this.eventRange.def,h=this.eventRange.instance,m=new Tt(c,u,h),p=this.relevantEvents,x=this.mutatedRelevantEvents;if(c.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:m,jsEvent:l.origEvent,view:c.viewApi}),this.validMutation){let y=new Tt(c,x.defs[u.defId],h?x.instances[h.instanceId]:null);c.dispatch({type:"MERGE_EVENTS",eventStore:x});let v={oldEvent:m,event:y,relatedEvents:Hi(x,c,h),revert(){c.dispatch({type:"MERGE_EVENTS",eventStore:p})}};c.emitter.trigger("eventResize",Object.assign(Object.assign({},v),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||ot(0),endDelta:this.validMutation.endDelta||ot(0),jsEvent:l.origEvent,view:c.viewApi})),c.emitter.trigger("eventChange",v)}else c.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:t}=e,s=this.dragging=new Ko(e.el);s.pointer.selector=".fc-event-resizer",s.touchScrollAllowed=!1,s.autoScroller.isEnabled=t.context.options.dragScroll;let i=this.hitDragging=new Mu(this.dragging,gg(e));i.emitter.on("pointerdown",this.handlePointerDown),i.emitter.on("dragstart",this.handleDragStart),i.emitter.on("hitupdate",this.handleHitUpdate),i.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return vs(e.subjectEl,".fc-event")}}function iO(n,e,t,s){let i=n.context.dateEnv,l=n.dateSpan.range.start,c=e.dateSpan.range.start,u=Gr(l,c,i,n.largeUnit);if(t){if(i.add(s.start,u)<s.end)return{startDelta:u}}else if(i.add(s.end,u)>s.start)return{endDelta:u};return null}class rO{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=s=>{s.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=s=>{let i=this.context.options.unselectCancel,l=pA(s.origEvent);this.matchesCancel=!!vs(l,i),this.matchesEvent=!!vs(l,Jo.SELECTOR)},this.onDocumentPointerUp=s=>{let{context:i}=this,{documentPointer:l}=this,c=i.getCurrentData();if(!l.wasTouchScroll){if(c.dateSelection&&!this.isRecentPointerDateSelect){let u=i.options.unselectAuto;u&&(!u||!this.matchesCancel)&&i.calendarApi.unselect(s)}c.eventSelection&&!this.matchesEvent&&i.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let t=this.documentPointer=new NN(document);t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerdown",this.onDocumentPointerDown),t.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}}const lO={fixedMirrorParent:ie},oO={dateClick:ie,eventDragStart:ie,eventDragStop:ie,eventDrop:ie,eventResizeStart:ie,eventResizeStop:ie,eventResize:ie,drop:ie,eventReceive:ie,eventLeave:ie};vg.dataAttrPrefix="";var cO=ai({name:"@fullcalendar/interaction",componentInteractions:[KL,JL,Jo,aO],calendarInteractions:[rO],elementDraggingImpl:Ko,optionRefiners:lO,listenerRefiners:oO});const Ed="/events";function Im(){const{user:n,token:e}=rs(),[t,s]=E.useState([]),[i,l]=E.useState([]),[c,u]=E.useState({}),[h,m]=E.useState(!1),[p,x]=E.useState(null),[y,v]=E.useState({title:"",description:"",startDate:"",endDate:"",category:"meeting"}),[w,A]=E.useState(new Date),[N,j]=E.useState(new Date),[_,C]=E.useState([]),[k,D]=E.useState(!1),P=E.useRef(null),F=`:root { --primary-color: #104774; --primary-hover: #0d3a61; --sunday-bg-color: #fff5f5; --sunday-text-color: #e53e3e; --holiday-bg-color: #fff5f5; --holiday-text-color: #e53e3e; }
  .fc .fc-toolbar-title{font-size:1.25rem;font-weight:600;color:#104774}
  .fc .fc-button{background-color:#104774;border-color:#104774}
  .fc .fc-button:hover{background-color:#0d3a61;border-color:#0d3a61}
  .fc .fc-daygrid-day.fc-day-today{background-color:#f0f9ff}
  .fc .fc-day-sun,.fc .fc-day-holiday{background-color:var(--holiday-bg-color)}
  .fc .fc-day-sun .fc-daygrid-day-number,.fc .fc-day-holiday .fc-daygrid-day-number{color:var(--holiday-text-color);font-weight:600}
  .fc-event{border-radius:4px;border:none;padding:2px 4px;font-size:0.8rem;cursor:pointer}
  .fc-daygrid-day-frame{cursor:pointer;max-height:150px!important}
  .fc-event-title{font-weight:500}
  .fc-event-description{font-size:0.7rem;opacity:0.8;margin-top:2px}
  `,U=le=>{const be=new Date(le),ye=be.getFullYear(),Ee=String(be.getMonth()+1).padStart(2,"0"),Xe=String(be.getDate()).padStart(2,"0");return`${ye}-${Ee}-${Xe}`},I=le=>new Date(le).getDay()===0,K=le=>{const be=U(le);return{id:`sunday-${be}`,title:"Sunday Holiday",start:be,extendedProps:{description:"Weekly holiday",category:"holiday",isSundayHoliday:!0},color:H("holiday"),display:"auto",allDay:!0}},H=le=>{switch(le){case"meeting":return"#104774";case"deadline":return"#ef4444";case"event":return"#8b5cf6";case"leave":return"#f97316";case"holiday":return"#10b981";default:return"#6b7280"}},X=le=>{switch(le){case"meeting":return"bg-blue-50 border-blue-200";case"deadline":return"bg-red-50 border-red-200";case"event":return"bg-purple-50 border-purple-200";case"leave":return"bg-orange-50 border-orange-200";case"holiday":return"bg-green-50 border-green-200";default:return"bg-gray-50 border-gray-200"}},W=E.useCallback(le=>(le||[]).map(be=>{let ye=be.endDate;if(be.endDate&&be.endDate!==be.startDate){const Ee=new Date(be.endDate);Ee.setDate(Ee.getDate()+1),ye=U(Ee)}return{id:be._id.toString(),title:be.title,start:U(be.startDate),end:ye||void 0,extendedProps:{description:be.description,category:be.category||"meeting",originalEndDate:be.endDate||null,isSundayHoliday:!1,isHoliday:!!be.isHoliday,source:be.source||"backend",externalId:be.externalId||void 0},color:H(be.category||"meeting"),display:"auto",allDay:!0}}),[]),ce=le=>{const be=le.end.date?le.end.date:le.end.dateTime;return{id:`holiday-${le.id}`,title:le.summary,start:U(le.start.date||le.start.dateTime),end:be?U(be):void 0,extendedProps:{description:le.description||le.summary,category:"holiday",isHoliday:!0,source:"google",externalId:le.id},color:H("holiday"),display:"auto",allDay:!0}},me=()=>{const le=t||[],be=[...le];return i.forEach(ye=>{const Ee=ye.extendedProps?.externalId,Xe=U(ye.start),te=(ye.title||"").toLowerCase();le.some(Ie=>!!(Ee&&Ie.extendedProps?.externalId&&Ie.extendedProps.externalId===Ee||U(Ie.start)===Xe&&(Ie.title||"").toLowerCase()===te))||be.push(ye)}),be},L=E.useCallback(async()=>{D(!0);try{const le=await xe.get(Ed,{headers:{Authorization:`Bearer ${e}`}}),be=W(le.data.events||[]);s(be);const ye=[...be,...i];B(N,ye)}catch(le){console.error(le.response?.data||le.message)}finally{D(!1)}},[e,W,i,N]);E.useEffect(()=>{L(),V(w.getFullYear())},[]),E.useEffect(()=>{B(N)},[t,i,N]);const q=le=>{const be=(le.summary||"").toLowerCase(),ye=["public holiday","national holiday","gazetted holiday","bank holiday","independence day","republic day","gandhi jayanti","guru nanak jayanti","diwali","holi","eid","christmas","good friday","mahatma gandhi","republic","independence","janmashtami","dussehra","ram navami","maha shivratri"],Ee=["observance","observances","festival","festivals","optional holiday","restricted holiday","eve","beginning","ends","monthly","week","daylight saving","season","solstice","equinox","fasting","vrat","puja","parva"],Xe=ye.some(Ne=>be.includes(Ne)),te=Ee.some(Ne=>be.includes(Ne));return Xe&&!te},V=async le=>{if(c[le])return;const be="AIzaSyBG-v7rJFHD3hgzTW802GaGTa-gA_n3J3A",ye="en.indian%23holiday%40group.v.calendar.google.com",Ee=`${le}-01-01T00:00:00Z`,Xe=`${le}-12-31T23:59:59Z`,te=`https://www.googleapis.com/calendar/v3/calendars/${ye}/events?key=${be}&timeMin=${Ee}&timeMax=${Xe}&singleEvents=true`,Ne=new AbortController,Ie=setTimeout(()=>Ne.abort(),1e4);try{const Ze=await fetch(te,{signal:Ne.signal,headers:{Accept:"application/json"}});if(clearTimeout(Ie),!Ze.ok)throw new Error(`HTTP ${Ze.status} - ${Ze.statusText}`);const Nt=await Ze.json(),Ae=(Array.isArray(Nt.items)?Nt.items:[]).filter(q).map(ce);l(je=>{const $e=new Set(je.map(Xt=>Xt.id)),ct=Ae.filter(Xt=>!$e.has(Xt.id));return[...je,...ct]}),u(je=>({...je,[le]:!0}))}catch(Ze){Ze.name==="AbortError"?console.warn("Holiday fetch aborted"):console.error("Holiday fetch error:",Ze.message||Ze)}finally{clearTimeout(Ie)}},B=(le,be=null)=>{const ye=be||me(),Ee=U(le),Xe=I(le),te=ye.filter(Ze=>{const Nt=U(Ze.start);if(Ze.end){const ls=U(Ze.end);return Ee>=Nt&&Ee<ls}return Ee===Nt});Xe&&(te.some(Nt=>Nt.extendedProps?.isSundayHoliday||Nt.extendedProps?.isHoliday)||te.push(K(le)));const Ne=new Set,Ie=[];te.forEach(Ze=>{const Nt=Ze.extendedProps?.externalId||Ze.id||`${(Ze.title||"").toLowerCase()}|${U(Ze.start)}`;Ne.has(Nt)||(Ne.add(Nt),Ie.push(Ze))}),C(Ie)},T=le=>{const be=new Date(le.view.currentStart);A(be),V(be.getFullYear())},G=le=>{const be=new Date(le.dateStr);j(be),B(be)},M=le=>{if(n.role==="employee")return;const be=le.event;if(be.extendedProps?.isSundayHoliday||be.extendedProps?.isHoliday)return;const ye=be.extendedProps?.originalEndDate||be.endStr||be.startStr,Ee=be.startStr?be.startStr.slice(0,10):U(be.start),Xe=ye?ye.slice?ye.slice(0,10):U(ye):Ee;x({id:be.id}),v({title:be.title||"",description:be.extendedProps?.description||"",startDate:Ee,endDate:Xe,category:be.extendedProps?.category||"meeting"}),m(!0)},O=()=>{x(null),v({title:"",description:"",startDate:U(N),endDate:U(N),category:"meeting"}),m(!0)},ae=le=>new Date(le).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),ee=async()=>{D(!0);try{const le={title:y.title,description:y.description,startDate:y.startDate,endDate:y.endDate&&y.endDate!==y.startDate?y.endDate:void 0,category:y.category};if(p){const be=await xe.put(`${Ed}/${p.id}`,le,{headers:{Authorization:`Bearer ${e}`}}),ye=W([be.data.event])[0];s(Ee=>Ee.map(Xe=>Xe.id===ye.id?ye:Xe))}else{const be=await xe.post(Ed,le,{headers:{Authorization:`Bearer ${e}`}}),ye=W([be.data.event])[0];s(Ee=>{if(new Set(Ee.map(Ne=>Ne.id)).has(ye.id))return Ee;const te=[...Ee,ye];return B(N,[...te,...i]),te})}m(!1)}catch(le){console.error(le.response?.data||le.message)}finally{D(!1)}},pe=async()=>{if(p){D(!0);try{await xe.delete(`${Ed}/${p.id}`,{headers:{Authorization:`Bearer ${e}`}}),s(le=>le.filter(be=>be.id!==p.id)),m(!1)}catch(le){console.error(le.response?.data||le.message)}finally{D(!1)}}},we=()=>{if(P.current){const le=P.current.getApi();le.prev(),A(new Date(le.getDate()))}},Te=()=>{if(P.current){const le=P.current.getApi();le.next(),A(new Date(le.getDate()))}},ue=le=>{const be=U(le);return me().some(Ee=>{const Xe=U(Ee.start);if(Ee.end){const te=U(Ee.end);return be>=Xe&&be<te&&!!Ee.extendedProps?.isHoliday}return be===Xe&&!!Ee.extendedProps?.isHoliday})},He=le=>le.event.extendedProps?.isSundayHoliday?null:r.jsxs("div",{className:"fc-event-content",children:[r.jsx("div",{className:"fc-event-title",children:le.event.title}),le.event.extendedProps.description&&r.jsx("div",{className:"fc-event-description",children:le.event.extendedProps.description.length>20?`${le.event.extendedProps.description.substring(0,20)}...`:le.event.extendedProps.description})]}),ze=le=>{const be=new Date(le.date),ye=I(be),Ee=ue(be);return r.jsx("div",{className:"fc-daygrid-day-frame",children:r.jsx("div",{className:"fc-daygrid-day-top",children:r.jsx("div",{className:`fc-daygrid-day-number ${ye||Ee?"text-red-600 font-bold":""}`,children:le.dayNumberText})})})},at=le=>{const be=new Date(le.date),ye=I(be),Ee=ue(be);return ye||Ee?"fc-day-holiday":""},At=me();return r.jsxs("div",{className:"max-h-[80vh] bg-gray-50 space-y-4 md:space-y-6",children:[r.jsx("style",{children:F}),r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-800",children:"Company Calendar"}),r.jsx("p",{className:"text-gray-500 text-xs sm:text-sm mt-1",children:"Manage company events and schedules"})]}),n.role!=="employee"&&r.jsxs("button",{onClick:O,className:"flex items-center justify-center bg-[#104774] text-white px-3 py-2 rounded-md hover:bg-[#0d3a61] transition-all duration-200 text-xs sm:text-sm",children:[r.jsx(Bi,{size:14,className:"mr-2"}),r.jsx("span",{children:"Add Event"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6",children:[r.jsx("div",{className:"lg:col-span-2",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[r.jsx("div",{className:"bg-[#104774] p-3 md:p-4 text-white",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("button",{onClick:we,className:"p-1.5 hover:bg-[#0d3a61] rounded-md transition-colors",children:r.jsx(xC,{size:18})}),r.jsxs("div",{className:"text-center px-2",children:[r.jsx("h2",{className:"text-sm md:text-base font-semibold",children:w.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),r.jsx("p",{className:"text-blue-100 text-xs hidden sm:block",children:"Click on any date to view events"})]}),r.jsx("button",{onClick:Te,className:"p-1.5 hover:bg-[#0d3a61] rounded-md transition-colors",children:r.jsx(bC,{size:18})})]})}),r.jsx("div",{className:"calendar-container",children:r.jsx(mN,{ref:P,plugins:[FL,cO],initialView:"dayGridMonth",events:At,dateClick:G,eventClick:M,height:"auto",headerToolbar:!1,initialDate:w,datesSet:T,eventContent:He,dayCellContent:ze,dayCellClassNames:at,dayMaxEvents:1,fixedWeekCount:!1})})]})}),r.jsx("div",{className:"space-y-4 md:space-y-6",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-3 md:p-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3 gap-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(Js,{size:18,className:"text-[#104774] mr-2"}),r.jsxs("h3",{className:"text-sm md:text-base font-semibold text-gray-800",children:[ae(N),(I(N)||_.some(le=>le.extendedProps?.isHoliday))&&r.jsx("span",{className:"ml-2 text-red-600 text-xs font-normal",children:"(Holiday)"})]})]}),n.role!=="employee"&&_.length>0&&r.jsx("button",{onClick:O,className:"text-[#104774] text-xs hover:text-[#0d3a61] self-start sm:self-center",children:"+ Add Event"})]}),_.length>0?r.jsx("div",{className:"space-y-2",children:_.map((le,be)=>{const ye=new Date(le.start),Ee=le.end?new Date(le.end):null;return r.jsxs("div",{className:`p-3 rounded-md border ${X(le.extendedProps?.category||"meeting")} ${n.role!=="employee"&&!le.extendedProps?.isSundayHoliday&&!le.extendedProps?.isHoliday?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:()=>{n.role!=="employee"&&!le.extendedProps?.isSundayHoliday&&!le.extendedProps?.isHoliday&&(x(le),v({title:le.title,description:le.extendedProps?.description||"",startDate:le.start,endDate:le.extendedProps?.originalEndDate||le.start,category:le.extendedProps?.category||"meeting"}),m(!0))},children:[r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("h4",{className:"font-semibold text-gray-800 text-xs md:text-sm truncate",children:[le.title,(le.extendedProps?.isSundayHoliday||le.extendedProps?.isHoliday)&&r.jsx("span",{className:"ml-2 text-green-600 text-xs font-normal"})]}),le.extendedProps?.description&&r.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:le.extendedProps.description}),r.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[ye.toLocaleDateString(),Ee&&Ee>ye&&` to ${Ee.toLocaleDateString()}`]})]}),r.jsx("div",{className:"w-3 h-3 rounded-full ml-2 flex-shrink-0",style:{backgroundColor:H(le.extendedProps?.category||"meeting")}})]}),n.role!=="employee"&&!le.extendedProps?.isSundayHoliday&&!le.extendedProps?.isHoliday&&r.jsx("div",{className:"text-xs text-[#104774] mt-2 hidden sm:block",children:"Click to edit"})]},be)})}):r.jsxs("div",{className:"text-center py-4",children:[r.jsx(Js,{size:32,className:"text-gray-300 mx-auto mb-2"}),r.jsx("p",{className:"text-gray-500 text-xs",children:"No events scheduled"}),n.role!=="employee"&&r.jsx("button",{onClick:O,className:"text-[#104774] text-xs mt-2 hover:text-[#0d3a61]",children:"+ Add Event"})]})]})})]}),h&&r.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-3",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-sm max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[r.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-800",children:p?"Edit Event":"Add Event"}),r.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 p-1",children:r.jsx(Vo,{size:16})})]}),r.jsxs("div",{className:"p-4 space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-700 mb-1",children:"Event Title"}),r.jsx("input",{type:"text",placeholder:"Enter event title",value:y.title,onChange:le=>v({...y,title:le.target.value}),className:"w-full border border-slate-300 rounded-md p-2 text-xs md:text-sm focus:ring-2 focus:ring-[#104774] focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-700 mb-1",children:"Description"}),r.jsx("textarea",{placeholder:"Enter event description",value:y.description,onChange:le=>v({...y,description:le.target.value}),rows:3,className:"w-full border border-slate-300 rounded-md p-2 text-xs md:text-sm focus:ring-2 focus:ring-[#104774] focus:border-transparent resize-none"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-700 mb-1",children:"Category"}),r.jsxs("select",{value:y.category,onChange:le=>v({...y,category:le.target.value}),className:"w-full border border-slate-300 rounded-md p-2 text-xs md:text-sm focus:ring-2 focus:ring-[#104774] focus:border-transparent",children:[r.jsx("option",{value:"meeting",children:"Meeting"}),r.jsx("option",{value:"deadline",children:"Deadline"}),r.jsx("option",{value:"event",children:"Company Event"}),r.jsx("option",{value:"leave",children:"Leave Day"}),r.jsx("option",{value:"holiday",children:"Holiday"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),r.jsx("input",{type:"date",value:y.startDate?y.startDate.slice(0,10):"",onChange:le=>v({...y,startDate:le.target.value}),className:"w-full border border-slate-300 rounded-md p-2 text-xs md:text-sm focus:ring-2 focus:ring-[#104774] focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-700 mb-1",children:"End Date (optional)"}),r.jsx("input",{type:"date",value:y.endDate?y.endDate.slice(0,10):"",onChange:le=>v({...y,endDate:le.target.value}),className:"w-full border border-slate-300 rounded-md p-2 text-xs md:text-sm focus:ring-2 focus:ring-[#104774] focus:border-transparent"})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 p-4 border-t",children:[r.jsx("button",{onClick:()=>m(!1),className:"px-3 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 text-xs sm:text-sm order-2 sm:order-1",children:"Cancel"}),p&&r.jsx("button",{onClick:pe,className:"px-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 text-xs sm:text-sm order-3 sm:order-2",children:"Delete"}),r.jsx("button",{onClick:ee,className:"px-3 py-2 bg-[#104774] text-white rounded-md hover:bg-[#0d3a61] text-xs sm:text-sm order-1 sm:order-3",children:p?"Update":"Save"})]})]})})]})}function dO(n){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}dO(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Ng=n=>typeof n=="number"&&!isNaN(n),Po=n=>typeof n=="string",CN=n=>typeof n=="function",uO=n=>Po(n)||Ng(n),hO=n=>E.isValidElement(n)||Po(n)||CN(n)||Ng(n),fO=1,TN=()=>`${fO++}`,Yn=new Map,yp=[],ow=new Set,DN=()=>Yn.size>0,mO=(n,{containerId:e})=>{var t;return(t=Yn.get(e||1))==null?void 0:t.toasts.get(n)};function pO(n,e){var t;if(e)return!!((t=Yn.get(e))!=null&&t.isToastActive(n));let s=!1;return Yn.forEach(i=>{i.isToastActive(n)&&(s=!0)}),s}function gO(n){if(!DN()){yp=yp.filter(e=>n!=null&&e.options.toastId!==n);return}if(n==null||uO(n))Yn.forEach(e=>{e.removeToast(n)});else if(n&&("containerId"in n||"id"in n)){let e=Yn.get(n.containerId);e?e.removeToast(n.id):Yn.forEach(t=>{t.removeToast(n.id)})}}var xO=(n={})=>{Yn.forEach(e=>{e.props.limit&&(!n.containerId||e.id===n.containerId)&&e.clearQueue()})};function yO(n,e){hO(n)&&(DN()||yp.push({content:n,options:e}),Yn.forEach(t=>{t.buildToast(n,e)}))}function RN(n,e){Yn.forEach(t=>{(e==null||!(e!=null&&e.containerId)||e?.containerId===t.id)&&t.toggle(n,e?.id)})}function bO(n){return ow.add(n),()=>{ow.delete(n)}}function vO(n){return n&&(Po(n.toastId)||Ng(n.toastId))?n.toastId:TN()}function ec(n,e){return yO(n,e),e.toastId}function Ou(n,e){return{...e,type:e&&e.type||n,toastId:vO(e)}}function Pu(n){return(e,t)=>ec(e,Ou(n,t))}function Ye(n,e){return ec(n,Ou("default",e))}Ye.loading=(n,e)=>ec(n,Ou("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function wO(n,{pending:e,error:t,success:s},i){let l;e&&(l=Po(e)?Ye.loading(e,i):Ye.loading(e.render,{...i,...e}));let c={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},u=(m,p,x)=>{if(p==null){Ye.dismiss(l);return}let y={type:m,...c,...i,data:x},v=Po(p)?{render:p}:p;return l?Ye.update(l,{...y,...v}):Ye(v.render,{...y,...v}),x},h=CN(n)?n():n;return h.then(m=>u("success",s,m)).catch(m=>u("error",t,m)),h}Ye.promise=wO;Ye.success=Pu("success");Ye.info=Pu("info");Ye.error=Pu("error");Ye.warning=Pu("warning");Ye.warn=Ye.warning;Ye.dark=(n,e)=>ec(n,Ou("default",{theme:"dark",...e}));function AO(n){gO(n)}Ye.dismiss=AO;Ye.clearWaitingQueue=xO;Ye.isActive=pO;Ye.update=(n,e={})=>{let t=mO(n,e);if(t){let{props:s,content:i}=t,l={delay:100,...s,...e,toastId:e.toastId||n,updateId:TN()};l.toastId!==n&&(l.staleId=n);let c=l.render||i;delete l.render,ec(c,l)}};Ye.done=n=>{Ye.update(n,{progress:1})};Ye.onChange=bO;Ye.play=n=>RN(!0,n);Ye.pause=n=>RN(!1,n);function NO(){const{user:n,token:e}=rs(),[t,s]=E.useState({}),[i,l]=E.useState([]),[c,u]=E.useState([]),[h,m]=E.useState([]),[p,x]=E.useState(!0),[y,v]=E.useState(!1),[w,A]=E.useState(!1),[N,j]=E.useState(!1),[_,C]=E.useState(!1),[k,D]=E.useState(""),[P,F]=E.useState("all"),[U,I]=E.useState("all"),[K,H]=E.useState(1),[X]=E.useState(5),[W,ce]=E.useState({leaveType:"",fromDate:"",toDate:"",reason:""}),[me,L]=E.useState({}),[q,V]=E.useState([]),B=E.useRef(new Set),T=E.useRef(new Set),[G,M]=E.useState(!1),[O,ae]=E.useState(null),ee=de=>de.toString().padStart(2,"0"),pe=de=>`${de.getFullYear()}-${ee(de.getMonth()+1)}-${ee(de.getDate())}`,we=async de=>{try{const ct=(await(await fetch(`https://www.googleapis.com/calendar/v3/calendars/en.indian%23holiday@group.v.calendar.google.com/events?key=AIzaSyBG-v7rJFHD3hgzTW802GaGTa-gA_n3J3A&timeMin=${de}-01-01T00:00:00Z&timeMax=${de}-12-31T23:59:59Z`)).json()).items||[],Xt=["republic day","independence day","gandhi","mahatma gandhi","gandhi jayanti","diwali","deepavali","dussehra","dashera","holi","christmas","new year's","new year","good friday","eid","bakrid","ramzan","guru nanak","janmashtami","mahavir","pongal","makar sankranti","dussehra","dussehra","mahatma gandhi jayanti","mahatma gandhi","mahatma"];return ct.map(Rt=>{const tn=Rt.start||{};let Hs=null;if(tn.date)Hs=tn.date;else if(tn.dateTime){const xn=new Date(tn.dateTime);Hs=`${xn.getFullYear()}-${ee(xn.getMonth()+1)}-${ee(xn.getDate())}`}const ws=(Rt.summary||"").toString(),gn=(Rt.description||"").toString();let zs=!1;const ri=gn.toLowerCase(),li=ws.toLowerCase();if(ri.includes("public holiday")||ri.includes("public"))zs=!0;else if(ri.includes("observance"))zs=!1;else if(li.includes("holiday"))zs=!0;else for(const xn of Xt)if(li.includes(xn)){zs=!0;break}return{id:Rt.id,title:ws,date:Hs,description:gn,htmlLink:Rt.htmlLink,isOfficial:zs}}).filter(Rt=>Rt.date)}catch(Ae){return console.error("Error fetching holidays:",Ae),[]}},Te=async(de=[])=>{const Ae=de.filter($e=>!T.current.has($e));if(Ae.length===0)return;const je=[];for(const $e of Ae){const Xt=(await we($e)).filter(Qn=>Qn.isOfficial);je.push(...Xt),T.current.add($e)}if(je.length>0){const $e=new Set(B.current),ct=[...q];for(const Xt of je)Xt.date&&!$e.has(Xt.date)&&($e.add(Xt.date),ct.push(Xt));B.current=$e,V(ct)}},ue=async(de,Ae)=>{if(!de||!Ae)return 0;M(!0);try{const je=new Date(de),$e=new Date(Ae);if(isNaN(je)||isNaN($e)||je>$e)return 0;const ct=new Set([je.getFullYear(),$e.getFullYear()]);await Te(Array.from(ct));const Xt=B.current;let Qn=0;const Rt=new Date(je);for(;Rt<=$e;){const Hs=Rt.getDay()===0,ws=pe(Rt),gn=Xt.has(ws);!Hs&&!gn&&Qn++,Rt.setDate(Rt.getDate()+1)}return Qn}catch(je){return console.error("Error calculating working days:",je),0}finally{M(!1)}},He=async()=>{if(n)try{const de=await xe.get("/leave/balance",{headers:{Authorization:`Bearer ${e}`}});s(de.data.balance||{})}catch(de){console.error("Error fetching leave balance:",de),Ye.error("Failed to fetch leave balance")}},ze=async()=>{try{const Ae=((await xe.get("/leave/get-leaveTypes",{headers:{Authorization:`Bearer ${e}`}})).data||[]).filter(je=>je.isActive);m(Ae),Ae.length>0&&!W.leaveType&&ce(je=>({...je,leaveType:Ae[0].name}))}catch(de){console.error("Error fetching leave types:",de),Ye.error("Failed to fetch leave types")}},at=async()=>{if(n)try{const de=await xe.get("/leave/my-requests",{headers:{Authorization:`Bearer ${e}`}});l(de.data||[]),u(de.data||[])}catch(de){console.error("Error fetching leave requests:",de),Ye.error("Failed to fetch leave requests")}finally{x(!1)}};E.useEffect(()=>{if(n){He(),ze(),at();const de=new Date().getFullYear();Te([de]).catch(Ae=>console.error(Ae))}},[n]),E.useEffect(()=>{let de=!1;return(async()=>{if(W.fromDate&&W.toDate){M(!0);const je=await ue(W.fromDate,W.toDate);de||ae(je),M(!1)}else ae(null)})(),()=>{de=!0}},[W.fromDate,W.toDate]),E.useEffect(()=>{let de=i;P!=="all"&&(de=de.filter(Ae=>Ae.status===P)),U!=="all"&&(de=de.filter(Ae=>Ae.leaveType===U)),k&&(de=de.filter(Ae=>(Ae.reason||"").toLowerCase().includes(k.toLowerCase())||(Ae.leaveType||"").toLowerCase().includes(k.toLowerCase())||(Ae.status||"").toLowerCase().includes(k.toLowerCase()))),u(de),H(1)},[k,P,U,i]);const At=K*X,le=At-X,be=c.slice(le,At),ye=Math.ceil(c.length/X),Ee=de=>{const{name:Ae,value:je}=de.target;ce($e=>({...$e,[Ae]:je})),me[Ae]&&L($e=>({...$e,[Ae]:""}))},Xe=async()=>{const de={},Ae=new Date;Ae.setHours(0,0,0,0);const je=new Date(W.fromDate);if(je.setHours(0,0,0,0),W.leaveType||(de.leaveType="Leave type is required"),W.fromDate||(de.fromDate="From date is required"),W.toDate||(de.toDate="To date is required"),W.fromDate&&W.toDate){new Date(W.fromDate)>new Date(W.toDate)&&(de.toDate="To date cannot be before from date"),je<Ae&&(de.fromDate="Cannot apply for backdated leaves");const $e=await ue(W.fromDate,W.toDate),ct=t[W.leaveType]??0;ct<$e&&(de.leaveType=`Insufficient ${W.leaveType} leave balance! You have ${ct} days left.`)}return W.reason.trim()||(de.reason="Reason is required"),W.reason.length>500&&(de.reason="Reason cannot exceed 500 characters"),L(de),Object.keys(de).length===0},te=de=>{const{name:Ae,value:je}=de.target;ce($e=>({...$e,[Ae]:je})),me[Ae]&&L($e=>({...$e,[Ae]:""}))},Ne=async de=>{if(de.preventDefault(),!y&&await Xe()){v(!0);try{const Ae=await ue(W.fromDate,W.toDate),je={...W,totalDays:Ae};await xe.post("/leave/create",je,{headers:{Authorization:`Bearer ${e}`}}),Ye.success("Leave applied successfully!"),j(!1),ce({leaveType:h[0]?.name||"",fromDate:"",toDate:"",reason:""}),He(),at()}catch(Ae){console.error("Error applying leave:",Ae);const je=Ae.response?.data?.message||"Error applying leave. Please try again.";Ye.error(je)}finally{v(!1)}}},Ie=async de=>{if(!w){A(!0);try{await xe.put(`/leave/requests/${de}/cancel`,{},{headers:{Authorization:`Bearer ${e}`}}),Ye.success("Leave cancelled successfully!"),at()}catch(Ae){console.error("Error cancelling leave:",Ae),Ye.error(Ae.response?.data?.message||"Error cancelling leave")}finally{A(!1)}}},Ze=()=>{D(""),F("all"),I("all"),u(i)},Nt=de=>{switch(de){case"sick":return r.jsx(Vd,{size:16,className:"text-red-400 mr-2"});case"casual":return r.jsx($d,{size:16,className:"text-purple-400 mr-2"});case"paid":return r.jsx(bs,{size:16,className:"text-green-400 mr-2"});default:return r.jsx(Js,{size:16,className:"text-blue-400 mr-2"})}},ls=de=>de.replace(/_/g," ").replace(/\b\w/g,Ae=>Ae.toUpperCase());return p?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#104774]"})}):r.jsxs("div",{className:"p-4 md:p-6 space-y-6 bg-gray-50 min-h-[80vh",children:[r.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Leave Management"}),r.jsxs("button",{onClick:()=>j(!0),className:"flex items-center bg-[#104774] text-white px-4 md:px-6 py-2 md:py-3 rounded-lg font-medium hover:bg-[#0d3a61] transition-all duration-200 w-full md:w-auto justify-center",children:[r.jsx(Bi,{size:20,className:"mr-2"}),"Apply For Leave"]})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:Object.entries(t).map(([de,Ae])=>r.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${de==="sick"?"bg-red-300":de==="casual"?"bg-purple-300":"bg-green-400"}`}),r.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:ls(de)})]}),de==="sick"?r.jsx(Vd,{size:18,className:"text-red-300"}):de==="casual"?r.jsx($d,{size:18,className:"text-purple-300"}):r.jsx(bs,{size:18,className:"text-green-400"})]}),r.jsxs("div",{className:"text-2xl font-bold text-gray-800 mb-2",children:[Ae," ",r.jsx("span",{className:"text-sm font-medium text-gray-500",children:"days left"})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:`h-2 rounded-full ${de==="sick"?"bg-red-300":de==="casual"?"bg-purple-300":"bg-green-400"}`,style:{width:`${Math.min(Ae/10*100,100)}%`}})})]},de))}),r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[r.jsxs("div",{className:"p-4 border-b border-gray-100 flex flex-col lg:flex-row justify-between items-start lg:items-center gap-3",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(Js,{size:24,className:"text-[#104774] mr-3"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Leave Application History"})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full lg:w-auto",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(kp,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search leaves...",value:k,onChange:de=>D(de.target.value),className:"pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] w-full"})]}),r.jsxs("button",{onClick:()=>C(!_),className:"flex items-center px-3 py-2 border rounded-lg hover:bg-gray-50 text-sm",children:[r.jsx(l1,{size:16,className:"mr-2"}),"Filters",_?r.jsx(mo,{size:14,className:"ml-1"}):r.jsx(fo,{size:14,className:"ml-1"})]})]})]}),_&&r.jsx("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),r.jsxs("select",{value:P,onChange:de=>F(de.target.value),className:"w-full border rounded-lg p-2 text-sm",children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"rejected",children:"Rejected"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Leave Type"}),r.jsxs("select",{value:U,onChange:de=>I(de.target.value),className:"w-full border rounded-lg p-2 text-sm",children:[r.jsx("option",{value:"all",children:"All Types"}),h.map(de=>r.jsxs("option",{value:de.name,children:[ls(de.name)," (",t[de.name]??0," left)"]},de._id))]})]}),r.jsx("div",{className:"flex items-end",children:r.jsx("button",{onClick:Ze,className:"px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 text-sm",children:"Reset Filters"})})]})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsx("div",{className:"max-h-[400px] overflow-y-auto border border-gray-200 rounded-lg shadow-md",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Date Range"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Type"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Days"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm hidden md:table-cell",children:"Reason"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Status"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm hidden lg:table-cell",children:"Applied On"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Actions"})]})}),r.jsx("tbody",{children:be.length>0?be.map((de,Ae)=>{const je=$e=>new Date($e).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"});return r.jsxs("tr",{className:`transition-colors ${Ae%2===0?"bg-white hover:bg-gray-50":"bg-gray-100 hover:bg-gray-200"}`,children:[r.jsx("td",{className:"p-3 font-medium text-gray-800 text-sm",children:`${je(de.fromDate)} – ${je(de.toDate)}`}),r.jsx("td",{className:"p-3",children:r.jsxs("div",{className:"flex items-center gap-1",children:[Nt(de.leaveType),r.jsx("span",{className:"text-gray-700 capitalize text-sm",children:ls(de.leaveType)})]})}),r.jsxs("td",{className:"p-3 text-sm",children:[de.totalDays," ",de.totalDays===1?"day":"days"]}),r.jsx("td",{className:"p-3 text-gray-600 text-sm hidden md:table-cell max-w-xs",children:r.jsxs("div",{className:"relative group w-fit",children:[r.jsx("span",{className:"truncate block max-w-[150px] cursor-help",children:de.reason||"-"}),de.reason&&r.jsxs("div",{className:"absolute left-0 bottom-full mb-2 hidden group-hover:flex bg-gray-900 text-white text-xs px-3 py-2 rounded-lg shadow-lg whitespace-normal max-w-xs z-50",children:[r.jsx("span",{className:"leading-snug",children:de.reason}),r.jsx("div",{className:"absolute left-3 top-full w-2 h-2 bg-gray-900 rotate-45"})]})]})}),r.jsx("td",{className:"p-3",children:r.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${de.status==="approved"?"bg-green-100 text-green-700 border border-green-200":de.status==="pending"?"bg-yellow-100 text-yellow-700 border border-yellow-200":de.status==="rejected"?"bg-red-100 text-red-700 border border-red-200":"bg-gray-100 text-gray-700 border border-gray-200"}`,children:[de.status==="approved"&&r.jsx(bs,{size:12,className:"mr-1"}),de.status==="pending"&&r.jsx(pn,{size:12,className:"mr-1"}),de.status==="rejected"&&r.jsx(Ks,{size:12,className:"mr-1"}),de.status.charAt(0).toUpperCase()+de.status.slice(1)]})}),r.jsx("td",{className:"p-3 text-gray-600 text-sm hidden lg:table-cell",children:je(de.appliedAt)}),r.jsx("td",{className:"p-3",children:de.status==="pending"&&r.jsxs("button",{onClick:()=>Ie(de._id),disabled:w,className:"flex items-center text-red-600 hover:text-red-800 text-xs font-medium disabled:opacity-50",children:[r.jsx(Mp,{size:12,className:"mr-1"}),w?"...":"Cancel"]})})]},Ae)}):r.jsx("tr",{children:r.jsx("td",{colSpan:"7",className:"p-6 text-center text-gray-500 text-sm",children:i.length===0?"No leave applications found. Apply for your first leave!":"No leaves match your filters."})})})]})})}),ye>1&&r.jsxs("div",{className:"p-4 border-t border-gray-100 flex flex-col sm:flex-row justify-between items-center gap-3",children:[r.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",le+1," to"," ",Math.min(At,c.length)," of"," ",c.length," entries"]}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("button",{onClick:()=>H(de=>Math.max(de-1,1)),disabled:K===1,className:"px-2 py-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Prev"}),Array.from({length:Math.min(5,ye)},(de,Ae)=>{let je;return ye<=5||K<=3?je=Ae+1:K>=ye-2?je=ye-4+Ae:je=K-2+Ae,r.jsx("button",{onClick:()=>H(je),className:`px-2 py-1 rounded border text-sm ${K===je?"bg-[#104774] text-white border-[#104774]":"border-gray-300"}`,children:je},je)}),r.jsx("button",{onClick:()=>H(de=>Math.min(de+1,ye)),disabled:K===ye,className:"px-2 py-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Next"})]})]})]}),N&&r.jsx("div",{className:"fixed inset-0 backdrop-blur-md bg-opacity-40 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-xl p-4 w-full max-w-md relative max-h-[90vh] overflow-y-auto",children:[r.jsx("button",{onClick:()=>j(!1),className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600",children:r.jsx(Vo,{size:20})}),r.jsx("h2",{className:"text-xl font-bold mb-4",children:"Apply for Leave"}),W.leaveType&&t[W.leaveType]!==void 0&&r.jsx("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:r.jsxs("p",{className:"text-blue-800 font-medium text-sm",children:["Available ",ls(W.leaveType)," leave:"," ",t[W.leaveType]," days"]})}),r.jsxs("form",{onSubmit:Ne,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"Leave Type"}),r.jsxs("select",{name:"leaveType",value:W.leaveType,onChange:Ee,className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",required:!0,children:[r.jsx("option",{value:"",children:"Select Leave Type"}),h.map(de=>r.jsxs("option",{value:de.name,children:[ls(de.name)," (",t[de.name]??0," left)"]},de._id))]}),me.leaveType&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(ns,{size:12,className:"mr-1"})," ",me.leaveType]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"From Date"}),r.jsx("input",{type:"date",name:"fromDate",value:W.fromDate,onChange:te,min:new Date().toISOString().split("T")[0],className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",required:!0}),me.fromDate&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(ns,{size:12,className:"mr-1"})," ",me.fromDate]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"To Date"}),r.jsx("input",{type:"date",name:"toDate",value:W.toDate,onChange:te,min:W.fromDate||new Date().toISOString().split("T")[0],className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",required:!0}),me.toDate&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(ns,{size:12,className:"mr-1"})," ",me.toDate]})]}),W.fromDate&&W.toDate&&r.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[r.jsx("p",{className:"text-gray-700 font-medium text-sm",children:G?"Calculating...":`Working Days: ${O??0}`}),r.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"(Excludes Sundays and Indian public holidays)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"Reason"}),r.jsx("textarea",{name:"reason",value:W.reason,onChange:Ee,rows:3,className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",placeholder:"Please provide a reason for your leave",required:!0}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[W.reason.length,"/500 characters"]}),me.reason&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(ns,{size:12,className:"mr-1"})," ",me.reason]})]}),r.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[r.jsx("button",{type:"button",onClick:()=>j(!1),className:"px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 text-sm",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:y,className:"px-4 py-2 rounded-lg bg-[#104774] text-white hover:bg-[#0d3a61] disabled:opacity-50 text-sm",children:y?"Submitting...":"Submit"})]})]})]})})]})}const jO=()=>{const{token:n,user:e}=rs(),[t,s]=E.useState("employeeLeaves"),[i,l]=E.useState([]),[c,u]=E.useState([]),[h,m]=E.useState([]),[p,x]=E.useState({}),[y,v]=E.useState([]),[w,A]=E.useState(null),[N,j]=E.useState(""),[_,C]=E.useState(!1),[k,D]=E.useState(!1),[P,F]=E.useState(""),[U,I]=E.useState(!1),[K,H]=E.useState(!1),[X,W]=E.useState(!1),[ce,me]=E.useState(""),[L,q]=E.useState("pending"),[V,B]=E.useState("all"),[T,G]=E.useState(null),[M,O]=E.useState(1),[ae]=E.useState(10),[ee,pe]=E.useState({key:null,direction:"ascending"}),[we,Te]=E.useState({}),[ue,He]=E.useState(!1),[ze,at]=E.useState(!1),[At,le]=E.useState(null),be=E.useRef(0),[ye,Ee]=E.useState({leaveType:"",fromDate:"",toDate:"",reason:""}),[Xe,te]=E.useState({}),Ne=Q=>(Q instanceof Date||(Q=new Date(Q)),Number.isNaN(Q.getTime())?null:Q.toISOString().slice(0,10)),Ie=Q=>{if(!Q||!Q.start)return null;const ve=Q.start,Ce=ve.date||ve.dateTime||ve?.dateTime;if(!Ce)return null;const Ge=new Date(Ce);return Number.isNaN(Ge.getTime())?null:Ne(Ge)},Ze=async Q=>{if(we[Q])return we[Q];try{const ve="AIzaSyBG-v7rJFHD3hgzTW802GaGTa-gA_n3J3A",Ce=`${Q}-01-01T00:00:00Z`,Ge=`${Q}-12-31T23:59:59Z`,vt=`https://www.googleapis.com/calendar/v3/calendars/en.indian%23holiday%40group.v.calendar.google.com/events?key=${ve}&timeMin=${Ce}&timeMax=${Ge}&maxResults=500`,_s=((await(await fetch(vt)).json()).items||[]).filter(Us=>{const Cs=(Us.summary||"").toLowerCase(),bn=(Us.description||"").toLowerCase(),ms=(Us.visibility||"").toLowerCase();return!!(bn.includes("public holiday")||Cs.includes("holiday")||ms==="public"&&!bn.includes("observance"))}),yn=new Set;return _s.forEach(Us=>{const Cs=Ie(Us);Cs&&yn.add(Cs)}),Te(Us=>({...Us,[Q]:yn})),yn}catch(ve){return console.error("Error fetching Indian holidays for year",Q,ve),Te(Ce=>({...Ce,[Q]:new Set})),new Set}},Nt=async(Q,ve)=>{He(!0);const Ce=++be.current;try{const Ge=new Date(Q),vt=new Date(ve);if(Number.isNaN(Ge.getTime())||Number.isNaN(vt.getTime())||Ge>vt)return 0;const yt=new Set,jt=Ge.getFullYear(),sn=vt.getFullYear();for(let ms=jt;ms<=sn;ms++)yt.add(ms);const _s={};for(const ms of yt)_s[ms]=await Ze(ms);const yn=ms=>{const vn=Ne(ms);if(!vn)return!1;const Mn=new Date(ms).getFullYear(),wa=_s[Mn];return wa?wa.has(vn):!1};let Us=0;const Cs=new Date(Ge);Cs.setHours(0,0,0,0);const bn=new Date(vt);for(bn.setHours(0,0,0,0);Cs<=bn;){const vn=Cs.getDay()===0,Mn=yn(Cs);!vn&&!Mn&&Us++,Cs.setDate(Cs.getDate()+1)}return Ce===be.current&&le(Us),Us}catch(Ge){return console.error("Error calculating working days:",Ge),Ce===be.current&&le(null),0}finally{He(!1)}},ls=async()=>{try{const ve=(await xe.get("/leave/get-leaveTypes",{headers:{Authorization:`Bearer ${n}`}})).data.filter(Ce=>Ce.isActive);v(ve),ve.length>0&&!ye.leaveType&&Ee(Ce=>({...Ce,leaveType:ve[0].name}))}catch(Q){console.error("Error fetching leave types:",Q),Ye.error("Failed to fetch leave types")}},de=async()=>{I(!0);try{const ve=(await xe.get("/leave/requests",{headers:{Authorization:`Bearer ${n}`}})).data.filter(Ce=>Ce.employee?.role==="employee");l(ve),m(ve)}catch(Q){console.error("Error fetching employee leave requests:",Q),Ye.error("Failed to fetch employee leave requests")}finally{I(!1)}},Ae=async()=>{try{const Q=await xe.get("/leave/my-requests",{headers:{Authorization:`Bearer ${n}`}});u(Q.data)}catch(Q){console.error("Error fetching my leave requests:",Q),Ye.error("Failed to fetch your leave requests")}},je=async()=>{try{const Q=await xe.get("/leave/balance",{headers:{Authorization:`Bearer ${n}`}});x(Q.data.balance||{})}catch(Q){console.error("Error fetching leave balance:",Q),Ye.error("Failed to fetch leave balance")}};E.useEffect(()=>{n&&(ls(),je(),t==="employeeLeaves"?de():Ae(),Ze(new Date().getFullYear()).then(()=>{}))},[n,t]),E.useEffect(()=>{if(t!=="employeeLeaves")return;let Q=i;if(ce){const ve=ce.toLowerCase();Q=Q.filter(Ce=>Ce.employee?.email?.toLowerCase().includes(ve)||Ce.leaveType?.toLowerCase().includes(ve)||Ce.reason?.toLowerCase().includes(ve))}L!=="all"&&(Q=Q.filter(ve=>ve.status===L)),V!=="all"&&(Q=Q.filter(ve=>ve.leaveType===V)),m(Q),O(1)},[ce,L,V,i,t]);const $e=Q=>{let ve="ascending";ee.key===Q&&ee.direction==="ascending"&&(ve="descending"),pe({key:Q,direction:ve});const Ce=[...h].sort((Ge,vt)=>{let yt,jt;if(Q.includes(".")){const sn=Q.split(".");yt=sn.reduce((_s,yn)=>_s&&_s[yn],Ge),jt=sn.reduce((_s,yn)=>_s&&_s[yn],vt)}else yt=Ge[Q],jt=vt[Q];return yt==null?1:jt==null?-1:yt<jt?ve==="ascending"?-1:1:yt>jt?ve==="ascending"?1:-1:0});m(Ce)},ct=M*ae,Xt=ct-ae,Qn=h.slice(Xt,ct),Rt=Math.ceil(h.length/ae),tn=async()=>{const Q={},ve=new Date().setHours(0,0,0,0),Ce=new Date(ye.fromDate).setHours(0,0,0,0);if(ye.leaveType||(Q.leaveType="Leave type is required"),ye.fromDate||(Q.fromDate="From date is required"),ye.toDate||(Q.toDate="To date is required"),ye.fromDate&&ye.toDate){new Date(ye.fromDate)>new Date(ye.toDate)&&(Q.toDate="To date cannot be before from date"),Ce<ve&&(Q.fromDate="Cannot apply for backdated leaves");const Ge=await Nt(ye.fromDate,ye.toDate),vt=p[ye.leaveType]??0;vt<Ge&&(Q.leaveType=`Insufficient ${ye.leaveType} leave balance! You have ${vt} days left.`)}return ye.reason?.trim()||(Q.reason="Reason is required"),ye.reason?.length>500&&(Q.reason="Reason cannot exceed 500 characters"),te(Q),Object.keys(Q).length===0},Hs=Q=>{const{name:ve,value:Ce}=Q.target;Ee(Ge=>({...Ge,[ve]:Ce})),Xe[ve]&&te(Ge=>({...Ge,[ve]:""}))};E.useEffect(()=>((async()=>{ye.fromDate&&ye.toDate?(le(null),await Nt(ye.fromDate,ye.toDate)):le(null)})(),()=>{}),[ye.fromDate,ye.toDate]);const ws=Q=>{const{name:ve,value:Ce}=Q.target;Ee(Ge=>({...Ge,[ve]:Ce})),Xe[ve]&&te(Ge=>({...Ge,[ve]:""}))},gn=async Q=>{if(Q.preventDefault(),!K&&await tn()){H(!0);try{const ve=await Nt(ye.fromDate,ye.toDate),Ce={...ye,totalDays:ve};await xe.post("/leave/create",Ce,{headers:{Authorization:`Bearer ${n}`}}),Ye.success("Leave applied successfully!"),C(!1),Ee({leaveType:y[0]?.name||"",fromDate:"",toDate:"",reason:""}),te({}),je(),Ae()}catch(ve){console.error("Error applying for leave:",ve);const Ce=ve.response?.data?.message||"Error applying leave. Please try again.";Ye.error(Ce)}finally{H(!1)}}},zs=async(Q,ve)=>{try{await xe.post(`/leave/${Q}/review`,{action:ve,reason:N||`${ve}ed by HR`},{headers:{Authorization:`Bearer ${n}`}}),A(null),j(""),D(!1),de(),je(),Ye.success(`Leave ${ve}ed successfully!`)}catch(Ce){console.error("Error updating leave:",Ce);const Ge=Ce.response?.data?.message||"Error processing leave request.";Ye.error(Ge)}},ri=async Q=>{if(!X){W(!0);try{await xe.put(`/leave/requests/${Q}/cancel`,{},{headers:{Authorization:`Bearer ${n}`}}),Ye.success("Leave cancelled successfully!"),Ae(),je()}catch(ve){console.error("Error cancelling leave:",ve),Ye.error(ve.response?.data?.message||"Error cancelling leave")}finally{W(!1)}}},li=()=>{me(""),q("all"),B("all"),m(i)},xn=({status:Q})=>{const ve={approved:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",icon:bs},pending:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",icon:pn},rejected:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",icon:Ks},cancelled:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-200",icon:Ks}},Ce=ve[Q]||ve.pending,Ge=Ce.icon;return r.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${Ce.bg} ${Ce.text} ${Ce.border}`,children:[r.jsx(Ge,{size:12,className:"mr-1"}),Q]})},er=Q=>{switch(Q){case"sick":return r.jsx(Vd,{size:16,className:"text-red-400 mr-2"});case"casual":return r.jsx($d,{size:16,className:"text-purple-400 mr-2"});case"paid":return r.jsx(bs,{size:16,className:"text-green-400 mr-2"});default:return r.jsx(Js,{size:16,className:"text-blue-400 mr-2"})}},Fs=Q=>Q.replace(/_/g," ").replace(/\b\w/g,ve=>ve.toUpperCase()),tr=({title:Q,value:ve,subtitle:Ce,icon:Ge,color:vt})=>r.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-2xl font-bold text-gray-800",children:ve}),r.jsx("p",{className:"text-sm font-medium text-gray-600",children:Q}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Ce})]}),r.jsx("div",{className:`p-3 rounded-full ${vt}`,children:r.jsx(Ge,{size:24,className:"text-white"})})]})}),oi=(()=>{const Q=new Date().getMonth(),ve=new Date().getFullYear(),Ce=i.filter(Ge=>{const vt=new Date(Ge.fromDate);return vt.getMonth()===Q&&vt.getFullYear()===ve});return{total:Ce.length,pending:Ce.filter(Ge=>Ge.status==="pending").length,approved:Ce.filter(Ge=>Ge.status==="approved").length,rejected:Ce.filter(Ge=>Ge.status==="rejected").length}})();return r.jsxs("div",{className:"p-4 md:p-6 space-y-6 bg-gray-50 min-h-[80vh]",children:[r.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"HR Leave Management"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:r.jsxs("button",{className:"flex items-center bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-all duration-200 text-sm md:text-base",onClick:()=>{je(),t==="employeeLeaves"?de():Ae()},children:[r.jsx(Fi,{size:18,className:"mr-2"})," Refresh"]})})]}),r.jsx("div",{className:"bg-white rounded-xl p-1 shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex",children:[r.jsx("button",{className:`flex-1 py-3 px-4 text-center font-medium rounded-lg transition-all duration-200 text-sm md:text-base ${t==="employeeLeaves"?"bg-[#104774] text-white shadow":"text-gray-600 hover:text-[#104774]"}`,onClick:()=>s("employeeLeaves"),children:r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx(qd,{size:18,className:"mr-2"}),"Employee Leaves"]})}),r.jsx("button",{className:`flex-1 py-3 px-4 text-center font-medium rounded-lg transition-all duration-200 text-sm md:text-base ${t==="myLeaves"?"bg-[#104774] text-white shadow":"text-gray-600 hover:text-[#104774]"}`,onClick:()=>s("myLeaves"),children:r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx(bo,{size:18,className:"mr-2"}),"My Leaves"]})})]})}),t==="employeeLeaves"&&r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[r.jsx(tr,{title:"Total Requests",value:oi.total,subtitle:"This Month",icon:Js,color:"bg-blue-500"}),r.jsx(tr,{title:"Pending",value:oi.pending,subtitle:"Require Action",icon:pn,color:"bg-yellow-500"}),r.jsx(tr,{title:"Approved",value:oi.approved,subtitle:"This month",icon:bs,color:"bg-green-500"}),r.jsx(tr,{title:"Rejected",value:oi.rejected,subtitle:"Leaves",icon:Ks,color:"bg-red-500"})]}),t==="myLeaves"&&r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-4",children:Object.entries(p).map(([Q,ve])=>r.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${Q==="sick"?"bg-red-300":Q==="casual"?"bg-purple-300":"bg-green-400"}`}),r.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:Fs(Q)})]}),Q==="sick"?r.jsx(Vd,{size:18,className:"text-red-300"}):Q==="casual"?r.jsx($d,{size:18,className:"text-purple-300"}):r.jsx(bs,{size:18,className:"text-green-400"})]}),r.jsxs("div",{className:"text-2xl font-bold text-gray-800 mb-2",children:[ve," ",r.jsx("span",{className:"text-sm font-medium text-gray-500",children:"days left"})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:r.jsx("div",{className:`h-2 rounded-full ${Q==="sick"?"bg-red-300":Q==="casual"?"bg-purple-300":"bg-green-400"}`,style:{width:`${Math.min(ve/10*100,100)}%`}})}),r.jsxs("div",{className:"text-xs text-gray-500",children:["As of ",new Date().toLocaleDateString()]})]},Q))}),t==="employeeLeaves"&&r.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(kp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),r.jsx("input",{type:"text",placeholder:"Search by employee, type, or reason...",value:ce,onChange:Q=>me(Q.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm md:text-base"})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs("button",{onClick:()=>at(!ze),className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 md:hidden text-sm",children:[r.jsx(l1,{size:16,className:"mr-2"}),"Filters"]}),r.jsxs("div",{className:`${ze?"flex":"hidden"} md:flex flex-col md:flex-row gap-2 w-full md:w-auto`,children:[r.jsxs("select",{value:L,onChange:Q=>q(Q.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm md:text-base",children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"rejected",children:"Rejected"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]}),r.jsxs("select",{value:V,onChange:Q=>B(Q.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm md:text-base",children:[r.jsx("option",{value:"all",children:"All Types"}),y.map(Q=>r.jsx("option",{value:Q.name,children:Fs(Q.name)},Q._id))]}),r.jsx("button",{onClick:li,className:"px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm md:text-base",children:"Reset"})]})]})]}),r.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Showing ",h.length," of ",i.length," ","requests"]})]}),t==="employeeLeaves"?r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center space-x-3",children:[r.jsx(qd,{size:24,className:"text-[#104774]"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Employee Leave Requests"})]}),U?r.jsxs("div",{className:"p-8 text-center",children:[r.jsx(Fi,{className:"animate-spin mx-auto text-[#104774]",size:32}),r.jsx("p",{className:"mt-2 text-gray-500",children:"Loading employee leave requests..."})]}):h.length===0?r.jsx("div",{className:"p-8 text-center",children:r.jsx("p",{className:"text-gray-500",children:"No employee leave requests found"})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsx("div",{className:"max-h-[350px] overflow-y-auto border border-gray-200 rounded-lg shadow-sm",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase cursor-pointer select-none",onClick:()=>$e("employee.email"),children:["Employee"," ",ee.key==="employee.email"&&(ee.direction==="ascending"?r.jsx(mo,{size:14,className:"inline"}):r.jsx(fo,{size:14,className:"inline"}))]}),r.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase cursor-pointer select-none",onClick:()=>$e("leaveType"),children:["Type"," ",ee.key==="leaveType"&&(ee.direction==="ascending"?r.jsx(mo,{size:14,className:"inline"}):r.jsx(fo,{size:14,className:"inline"}))]}),r.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase cursor-pointer select-none",onClick:()=>$e("fromDate"),children:["From"," ",ee.key==="fromDate"&&(ee.direction==="ascending"?r.jsx(mo,{size:14,className:"inline"}):r.jsx(fo,{size:14,className:"inline"}))]}),r.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase cursor-pointer select-none",onClick:()=>$e("toDate"),children:["To"," ",ee.key==="toDate"&&(ee.direction==="ascending"?r.jsx(mo,{size:14,className:"inline"}):r.jsx(fo,{size:14,className:"inline"}))]}),r.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase",children:"Days"}),r.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase",children:"Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Qn.map((Q,ve)=>{const Ce=Q.currentRemaining?.[Q.leaveType]>=Q.totalDays;return r.jsxs(Eo.Fragment,{children:[r.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[r.jsx("td",{className:"px-4 py-3 text-sm",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"bg-gray-200 rounded-full p-1 mr-2",children:r.jsx(d1,{size:14,className:"text-gray-600"})}),Q.employee?.email||"N/A"]})}),r.jsx("td",{className:"px-4 py-3 text-sm",children:r.jsxs("div",{className:"flex items-center gap-1",children:[er(Q.leaveType),r.jsx("span",{className:"capitalize",children:Fs(Q.leaveType)})]})}),r.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(Q.fromDate).toLocaleDateString()}),r.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(Q.toDate).toLocaleDateString()}),r.jsx("td",{className:"px-4 py-3 text-sm",children:Q.totalDays}),r.jsx("td",{className:"px-4 py-3",children:r.jsx(xn,{status:Q.status})}),r.jsx("td",{className:"px-4 py-3",children:r.jsxs("div",{className:"flex space-x-2 items-center",children:[r.jsx("button",{className:"text-[#104774] hover:text-[#0d3a61] p-1 rounded",onClick:()=>G(T===Q._id?null:Q._id),title:"View Details",children:r.jsx(To,{size:16})}),Q.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"text-green-600 hover:text-green-800 p-1 rounded",onClick:()=>{A(Q),F("approve"),D(!0)},title:"Approve",children:r.jsx(bs,{size:16})}),r.jsx("button",{className:"text-red-600 hover:text-red-800 p-1 rounded",onClick:()=>{A(Q),F("reject"),D(!0)},title:"Reject",children:r.jsx(Ks,{size:16})})]})]})})]}),T===Q._id&&r.jsx("tr",{className:"bg-gray-50",children:r.jsx("td",{colSpan:7,className:"p-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium mb-2",children:"Request Details"}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Reason:"})," ",Q.reason||"-"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Applied On:"})," ",new Date(Q.appliedAt).toLocaleString()]}),Q.processedBy&&r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Processed By:"})," ",Q.processedBy?.email||"Admin"]}),Q.processedAt&&r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Processed At:"})," ",new Date(Q.processedAt).toLocaleString()]}),Q.remarks&&r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Remarks:"})," ",Q.remarks]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium mb-2",children:"Balance Information"}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Remaining at request:"})," ",Q.balanceSnapshot?.remaining?.[Q.leaveType]??"-"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Current remaining:"})," ",Q.currentRemaining?.[Q.leaveType]??"-"]}),!Ce&&r.jsxs("p",{className:"text-red-600 font-medium mt-2 flex items-center",children:[r.jsx(ns,{size:14,className:"inline mr-1"}),"Insufficient balance for this request"]})]})]})})})]},Q._id)})})]})})}),Rt>1&&r.jsxs("div",{className:"p-4 border-t border-gray-200 flex flex-col sm:flex-row justify-between items-center gap-3",children:[r.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",Xt+1," to"," ",Math.min(ct,h.length)," of"," ",h.length," entries"]}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("button",{onClick:()=>O(Q=>Math.max(Q-1,1)),disabled:M===1,className:"px-2 py-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Prev"}),Array.from({length:Math.min(5,Rt)},(Q,ve)=>{let Ce;return Rt<=5||M<=3?Ce=ve+1:M>=Rt-2?Ce=Rt-4+ve:Ce=M-2+ve,r.jsx("button",{onClick:()=>O(Ce),className:`px-2 py-1 rounded border text-sm ${M===Ce?"bg-[#104774] text-white border-[#104774]":"border-gray-300"}`,children:Ce},Ce)}),r.jsx("button",{onClick:()=>O(Q=>Math.min(Q+1,Rt)),disabled:M===Rt,className:"px-2 py-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Next"})]})]})]})]}):r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(bo,{size:24,className:"text-[#104774]"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"My Leave Requests"})]}),r.jsxs("button",{className:"flex items-center bg-[#104774] text-white px-4 py-2 rounded-lg font-medium hover:bg-[#0d3a61] transition-all duration-200 text-sm md:text-base",onClick:()=>C(!0),children:[r.jsx(Bi,{size:18,className:"mr-2"})," Apply For Leave"]})]}),c.length===0?r.jsx("div",{className:"p-8 text-center",children:r.jsx("p",{className:"text-gray-500",children:"No leave requests found. Apply for your first leave!"})}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{className:"bg-[#104774] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Date Range"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Type"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Days"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm hidden md:table-cell",children:"Reason"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Status"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm hidden lg:table-cell",children:"Applied On"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Actions"})]})}),r.jsx("tbody",{children:c.map(Q=>{Q.currentRemaining&&Q.currentRemaining[Q.leaveType]>=Q.totalDays;const ve=Ce=>Ce?new Date(Ce).toLocaleDateString("en-GB",{day:"numeric",month:"short"}):"-";return r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50 transition-colors",children:[r.jsx("td",{className:"p-3 font-medium text-gray-800 text-sm",children:`${ve(Q.fromDate)} to ${ve(Q.toDate)}`}),r.jsx("td",{className:"p-3 text-sm",children:r.jsxs("div",{className:"flex items-center gap-1",children:[er(Q.leaveType),r.jsx("span",{className:"capitalize",children:Fs(Q.leaveType)})]})}),r.jsx("td",{className:"p-3 text-sm",children:Q.totalDays}),r.jsxs("td",{className:"p-3 text-gray-600 text-sm hidden md:table-cell max-w-xs truncate cursor-pointer relative group",title:Q.reason,children:[Q.reason||"-",Q.reason&&r.jsx("div",{className:"absolute hidden group-hover:block bg-gray-800 text-white text-xs rounded-md px-3 py-2 w-64 z-20 -top-1 left-1/2 -translate-x-1/2 shadow-lg",children:Q.reason})]}),r.jsx("td",{className:"p-3",children:r.jsx(xn,{status:Q.status})}),r.jsx("td",{className:"p-3 text-gray-600 text-sm hidden lg:table-cell",children:new Date(Q.appliedAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),r.jsx("td",{className:"p-3",children:Q.status==="pending"&&r.jsxs("button",{onClick:()=>ri(Q._id),disabled:X,className:"flex items-center text-red-600 hover:text-red-800 text-xs font-medium disabled:opacity-50",children:[r.jsx(Mp,{size:12,className:"mr-1"}),X?"...":"Cancel"]})})]},Q._id)})})]})})]}),_&&r.jsx("div",{className:"fixed inset-0  bg-opacity-40 backdrop-blur-xs flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-xl p-4 w-full max-w-md relative max-h-[90vh] overflow-y-auto",children:[r.jsx("button",{onClick:()=>{C(!1),te({})},className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600",children:r.jsx(Vo,{size:20})}),r.jsx("h2",{className:"text-xl font-bold mb-4",children:"Apply for Leave"}),ye.leaveType&&p[ye.leaveType]!==void 0&&r.jsx("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:r.jsxs("p",{className:"text-blue-800 font-medium text-sm",children:["Available ",Fs(ye.leaveType)," leave:"," ",p[ye.leaveType]," days"]})}),r.jsxs("form",{onSubmit:gn,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"Leave Type"}),r.jsxs("select",{name:"leaveType",value:ye.leaveType,onChange:Hs,className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",required:!0,children:[r.jsx("option",{value:"",children:"Select Leave Type"}),y.map(Q=>r.jsx("option",{value:Q.name,children:Fs(Q.name)},Q._id))]}),Xe.leaveType&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(ns,{size:12,className:"mr-1"})," ",Xe.leaveType]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"From Date"}),r.jsx("input",{type:"date",name:"fromDate",value:ye.fromDate,onChange:ws,min:new Date().toISOString().split("T")[0],className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",required:!0}),Xe.fromDate&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(ns,{size:12,className:"mr-1"})," ",Xe.fromDate]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"To Date"}),r.jsx("input",{type:"date",name:"toDate",value:ye.toDate,onChange:ws,min:ye.fromDate||new Date().toISOString().split("T")[0],className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",required:!0}),Xe.toDate&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(ns,{size:12,className:"mr-1"})," ",Xe.toDate]})]})]}),ye.fromDate&&ye.toDate&&r.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[r.jsx("p",{className:"text-gray-700 font-medium text-sm",children:ue?"Calculating...":`Working Days: ${At??0}`}),r.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"(Excludes Sundays and Indian public holidays)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"Reason"}),r.jsx("textarea",{name:"reason",value:ye.reason,onChange:Hs,rows:3,className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",placeholder:"Please provide a reason for your leave",required:!0}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[ye.reason.length,"/500 characters"]}),Xe.reason&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(ns,{size:12,className:"mr-1"})," ",Xe.reason]})]}),r.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[r.jsx("button",{type:"button",onClick:()=>{C(!1),te({})},className:"px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 text-sm",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:K,className:"px-3 py-2 rounded-lg bg-[#104774] text-white hover:bg-[#0d3a61] disabled:opacity-50 text-sm",children:K?"Submitting...":"Submit"})]})]})]})}),k&&w&&r.jsx("div",{className:"fixed inset-0 backdrop-blur-xs bg-opacity-40 flex items-center justify-center z-50 p-4 shadow-2xl",children:r.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl w-full max-w-md",children:[r.jsxs("h3",{className:"text-lg font-semibold mb-4",children:[P==="approve"?"Approve":"Reject"," Leave Request"]}),r.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[r.jsxs("p",{className:"text-sm",children:[r.jsx("strong",{children:"Employee:"})," ",w.employee?.email]}),r.jsxs("p",{className:"text-sm",children:[r.jsx("strong",{children:"Type:"})," ",Fs(w.leaveType)]}),r.jsxs("p",{className:"text-sm",children:[r.jsx("strong",{children:"Duration:"})," ",w.totalDays," days"]}),r.jsxs("p",{className:"text-sm",children:[r.jsx("strong",{children:"Reason:"})," ",w.reason||"-"]}),w.currentRemaining&&r.jsxs("p",{className:`text-sm mt-2 ${w.currentRemaining[w.leaveType]<w.totalDays?"text-red-600 font-medium":""}`,children:[r.jsx("strong",{children:"Remaining Balance:"})," ",w.currentRemaining[w.leaveType],"/",w.balanceSnapshot?.remaining[w.leaveType],w.currentRemaining[w.leaveType]<w.totalDays&&r.jsx("span",{className:"ml-1",children:"(Insufficient balance)"})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Remarks (Optional)"}),r.jsx("textarea",{value:N,onChange:Q=>j(Q.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",rows:"3",placeholder:"Add remarks for this action..."})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-300 hover:bg-gray-400 transition-colors text-sm",onClick:()=>{D(!1),j("")},children:"Cancel"}),r.jsx("button",{className:`px-3 py-2 rounded-lg text-white transition-colors text-sm ${P==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,onClick:()=>zs(w._id,P),children:P==="approve"?"Approve":"Reject"})]})]})})]})},kN=6048e5,SO=864e5,cw=Symbol.for("constructDateFrom");function ni(n,e){return typeof n=="function"?n(e):n&&typeof n=="object"&&cw in n?n[cw](e):n instanceof Date?new n.constructor(e):new Date(e)}function kn(n,e){return ni(e||n,n)}let EO={};function Iu(){return EO}function Io(n,e){const t=Iu(),s=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,i=kn(n,e?.in),l=i.getDay(),c=(l<s?7:0)+l-s;return i.setDate(i.getDate()-c),i.setHours(0,0,0,0),i}function cu(n,e){return Io(n,{...e,weekStartsOn:1})}function MN(n,e){const t=kn(n,e?.in),s=t.getFullYear(),i=ni(t,0);i.setFullYear(s+1,0,4),i.setHours(0,0,0,0);const l=cu(i),c=ni(t,0);c.setFullYear(s,0,4),c.setHours(0,0,0,0);const u=cu(c);return t.getTime()>=l.getTime()?s+1:t.getTime()>=u.getTime()?s:s-1}function dw(n){const e=kn(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function _O(n,...e){const t=ni.bind(null,e.find(s=>typeof s=="object"));return e.map(t)}function uw(n,e){const t=kn(n,e?.in);return t.setHours(0,0,0,0),t}function CO(n,e,t){const[s,i]=_O(t?.in,n,e),l=uw(s),c=uw(i),u=+l-dw(l),h=+c-dw(c);return Math.round((u-h)/SO)}function TO(n,e){const t=MN(n,e),s=ni(n,0);return s.setFullYear(t,0,4),s.setHours(0,0,0,0),cu(s)}function DO(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function RO(n){return!(!DO(n)&&typeof n!="number"||isNaN(+kn(n)))}function kO(n,e){const t=kn(n,e?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const MO={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},LO=(n,e,t)=>{let s;const i=MO[n];return typeof i=="string"?s=i:e===1?s=i.one:s=i.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+s:s+" ago":s};function Bm(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const OO={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},PO={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},IO={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},BO={date:Bm({formats:OO,defaultWidth:"full"}),time:Bm({formats:PO,defaultWidth:"full"}),dateTime:Bm({formats:IO,defaultWidth:"full"})},HO={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},zO=(n,e,t,s)=>HO[n];function uo(n){return(e,t)=>{const s=t?.context?String(t.context):"standalone";let i;if(s==="formatting"&&n.formattingValues){const c=n.defaultFormattingWidth||n.defaultWidth,u=t?.width?String(t.width):c;i=n.formattingValues[u]||n.formattingValues[c]}else{const c=n.defaultWidth,u=t?.width?String(t.width):n.defaultWidth;i=n.values[u]||n.values[c]}const l=n.argumentCallback?n.argumentCallback(e):e;return i[l]}}const FO={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},UO={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},$O={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},VO={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},qO={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},GO={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},YO=(n,e)=>{const t=Number(n),s=t%100;if(s>20||s<10)switch(s%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},WO={ordinalNumber:YO,era:uo({values:FO,defaultWidth:"wide"}),quarter:uo({values:UO,defaultWidth:"wide",argumentCallback:n=>n-1}),month:uo({values:$O,defaultWidth:"wide"}),day:uo({values:VO,defaultWidth:"wide"}),dayPeriod:uo({values:qO,defaultWidth:"wide",formattingValues:GO,defaultFormattingWidth:"wide"})};function ho(n){return(e,t={})=>{const s=t.width,i=s&&n.matchPatterns[s]||n.matchPatterns[n.defaultMatchWidth],l=e.match(i);if(!l)return null;const c=l[0],u=s&&n.parsePatterns[s]||n.parsePatterns[n.defaultParseWidth],h=Array.isArray(u)?QO(u,x=>x.test(c)):XO(u,x=>x.test(c));let m;m=n.valueCallback?n.valueCallback(h):h,m=t.valueCallback?t.valueCallback(m):m;const p=e.slice(c.length);return{value:m,rest:p}}}function XO(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function QO(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function ZO(n){return(e,t={})=>{const s=e.match(n.matchPattern);if(!s)return null;const i=s[0],l=e.match(n.parsePattern);if(!l)return null;let c=n.valueCallback?n.valueCallback(l[0]):l[0];c=t.valueCallback?t.valueCallback(c):c;const u=e.slice(i.length);return{value:c,rest:u}}}const KO=/^(\d+)(th|st|nd|rd)?/i,JO=/\d+/i,eP={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},tP={any:[/^b/i,/^(a|c)/i]},sP={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},nP={any:[/1/i,/2/i,/3/i,/4/i]},aP={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},iP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},rP={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},lP={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},oP={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},cP={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},dP={ordinalNumber:ZO({matchPattern:KO,parsePattern:JO,valueCallback:n=>parseInt(n,10)}),era:ho({matchPatterns:eP,defaultMatchWidth:"wide",parsePatterns:tP,defaultParseWidth:"any"}),quarter:ho({matchPatterns:sP,defaultMatchWidth:"wide",parsePatterns:nP,defaultParseWidth:"any",valueCallback:n=>n+1}),month:ho({matchPatterns:aP,defaultMatchWidth:"wide",parsePatterns:iP,defaultParseWidth:"any"}),day:ho({matchPatterns:rP,defaultMatchWidth:"wide",parsePatterns:lP,defaultParseWidth:"any"}),dayPeriod:ho({matchPatterns:oP,defaultMatchWidth:"any",parsePatterns:cP,defaultParseWidth:"any"})},uP={code:"en-US",formatDistance:LO,formatLong:BO,formatRelative:zO,localize:WO,match:dP,options:{weekStartsOn:0,firstWeekContainsDate:1}};function hP(n,e){const t=kn(n,e?.in);return CO(t,kO(t))+1}function fP(n,e){const t=kn(n,e?.in),s=+cu(t)-+TO(t);return Math.round(s/kN)+1}function LN(n,e){const t=kn(n,e?.in),s=t.getFullYear(),i=Iu(),l=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,c=ni(e?.in||n,0);c.setFullYear(s+1,0,l),c.setHours(0,0,0,0);const u=Io(c,e),h=ni(e?.in||n,0);h.setFullYear(s,0,l),h.setHours(0,0,0,0);const m=Io(h,e);return+t>=+u?s+1:+t>=+m?s:s-1}function mP(n,e){const t=Iu(),s=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,i=LN(n,e),l=ni(e?.in||n,0);return l.setFullYear(i,0,s),l.setHours(0,0,0,0),Io(l,e)}function pP(n,e){const t=kn(n,e?.in),s=+Io(t,e)-+mP(t,e);return Math.round(s/kN)+1}function ht(n,e){const t=n<0?"-":"",s=Math.abs(n).toString().padStart(e,"0");return t+s}const Va={y(n,e){const t=n.getFullYear(),s=t>0?t:1-t;return ht(e==="yy"?s%100:s,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):ht(t+1,2)},d(n,e){return ht(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return ht(n.getHours()%12||12,e.length)},H(n,e){return ht(n.getHours(),e.length)},m(n,e){return ht(n.getMinutes(),e.length)},s(n,e){return ht(n.getSeconds(),e.length)},S(n,e){const t=e.length,s=n.getMilliseconds(),i=Math.trunc(s*Math.pow(10,t-3));return ht(i,e.length)}},Br={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},hw={G:function(n,e,t){const s=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(s,{width:"abbreviated"});case"GGGGG":return t.era(s,{width:"narrow"});case"GGGG":default:return t.era(s,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const s=n.getFullYear(),i=s>0?s:1-s;return t.ordinalNumber(i,{unit:"year"})}return Va.y(n,e)},Y:function(n,e,t,s){const i=LN(n,s),l=i>0?i:1-i;if(e==="YY"){const c=l%100;return ht(c,2)}return e==="Yo"?t.ordinalNumber(l,{unit:"year"}):ht(l,e.length)},R:function(n,e){const t=MN(n);return ht(t,e.length)},u:function(n,e){const t=n.getFullYear();return ht(t,e.length)},Q:function(n,e,t){const s=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return ht(s,2);case"Qo":return t.ordinalNumber(s,{unit:"quarter"});case"QQQ":return t.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(s,{width:"wide",context:"formatting"})}},q:function(n,e,t){const s=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return ht(s,2);case"qo":return t.ordinalNumber(s,{unit:"quarter"});case"qqq":return t.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(s,{width:"wide",context:"standalone"})}},M:function(n,e,t){const s=n.getMonth();switch(e){case"M":case"MM":return Va.M(n,e);case"Mo":return t.ordinalNumber(s+1,{unit:"month"});case"MMM":return t.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(s,{width:"wide",context:"formatting"})}},L:function(n,e,t){const s=n.getMonth();switch(e){case"L":return String(s+1);case"LL":return ht(s+1,2);case"Lo":return t.ordinalNumber(s+1,{unit:"month"});case"LLL":return t.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(s,{width:"wide",context:"standalone"})}},w:function(n,e,t,s){const i=pP(n,s);return e==="wo"?t.ordinalNumber(i,{unit:"week"}):ht(i,e.length)},I:function(n,e,t){const s=fP(n);return e==="Io"?t.ordinalNumber(s,{unit:"week"}):ht(s,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Va.d(n,e)},D:function(n,e,t){const s=hP(n);return e==="Do"?t.ordinalNumber(s,{unit:"dayOfYear"}):ht(s,e.length)},E:function(n,e,t){const s=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(s,{width:"short",context:"formatting"});case"EEEE":default:return t.day(s,{width:"wide",context:"formatting"})}},e:function(n,e,t,s){const i=n.getDay(),l=(i-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(l);case"ee":return ht(l,2);case"eo":return t.ordinalNumber(l,{unit:"day"});case"eee":return t.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(i,{width:"short",context:"formatting"});case"eeee":default:return t.day(i,{width:"wide",context:"formatting"})}},c:function(n,e,t,s){const i=n.getDay(),l=(i-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(l);case"cc":return ht(l,e.length);case"co":return t.ordinalNumber(l,{unit:"day"});case"ccc":return t.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(i,{width:"narrow",context:"standalone"});case"cccccc":return t.day(i,{width:"short",context:"standalone"});case"cccc":default:return t.day(i,{width:"wide",context:"standalone"})}},i:function(n,e,t){const s=n.getDay(),i=s===0?7:s;switch(e){case"i":return String(i);case"ii":return ht(i,e.length);case"io":return t.ordinalNumber(i,{unit:"day"});case"iii":return t.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(s,{width:"short",context:"formatting"});case"iiii":default:return t.day(s,{width:"wide",context:"formatting"})}},a:function(n,e,t){const i=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(n,e,t){const s=n.getHours();let i;switch(s===12?i=Br.noon:s===0?i=Br.midnight:i=s/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(n,e,t){const s=n.getHours();let i;switch(s>=17?i=Br.evening:s>=12?i=Br.afternoon:s>=4?i=Br.morning:i=Br.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let s=n.getHours()%12;return s===0&&(s=12),t.ordinalNumber(s,{unit:"hour"})}return Va.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Va.H(n,e)},K:function(n,e,t){const s=n.getHours()%12;return e==="Ko"?t.ordinalNumber(s,{unit:"hour"}):ht(s,e.length)},k:function(n,e,t){let s=n.getHours();return s===0&&(s=24),e==="ko"?t.ordinalNumber(s,{unit:"hour"}):ht(s,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Va.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Va.s(n,e)},S:function(n,e){return Va.S(n,e)},X:function(n,e,t){const s=n.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return mw(s);case"XXXX":case"XX":return Ti(s);case"XXXXX":case"XXX":default:return Ti(s,":")}},x:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"x":return mw(s);case"xxxx":case"xx":return Ti(s);case"xxxxx":case"xxx":default:return Ti(s,":")}},O:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+fw(s,":");case"OOOO":default:return"GMT"+Ti(s,":")}},z:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+fw(s,":");case"zzzz":default:return"GMT"+Ti(s,":")}},t:function(n,e,t){const s=Math.trunc(+n/1e3);return ht(s,e.length)},T:function(n,e,t){return ht(+n,e.length)}};function fw(n,e=""){const t=n>0?"-":"+",s=Math.abs(n),i=Math.trunc(s/60),l=s%60;return l===0?t+String(i):t+String(i)+e+ht(l,2)}function mw(n,e){return n%60===0?(n>0?"-":"+")+ht(Math.abs(n)/60,2):Ti(n,e)}function Ti(n,e=""){const t=n>0?"-":"+",s=Math.abs(n),i=ht(Math.trunc(s/60),2),l=ht(s%60,2);return t+i+e+l}const pw=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},ON=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},gP=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],s=t[1],i=t[2];if(!i)return pw(n,e);let l;switch(s){case"P":l=e.dateTime({width:"short"});break;case"PP":l=e.dateTime({width:"medium"});break;case"PPP":l=e.dateTime({width:"long"});break;case"PPPP":default:l=e.dateTime({width:"full"});break}return l.replace("{{date}}",pw(s,e)).replace("{{time}}",ON(i,e))},xP={p:ON,P:gP},yP=/^D+$/,bP=/^Y+$/,vP=["D","DD","YY","YYYY"];function wP(n){return yP.test(n)}function AP(n){return bP.test(n)}function NP(n,e,t){const s=jP(n,e,t);if(console.warn(s),vP.includes(n))throw new RangeError(s)}function jP(n,e,t){const s=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${s} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const SP=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,EP=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,_P=/^'([^]*?)'?$/,CP=/''/g,TP=/[a-zA-Z]/;function yo(n,e,t){const s=Iu(),i=s.locale??uP,l=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,c=s.weekStartsOn??s.locale?.options?.weekStartsOn??0,u=kn(n,t?.in);if(!RO(u))throw new RangeError("Invalid time value");let h=e.match(EP).map(p=>{const x=p[0];if(x==="p"||x==="P"){const y=xP[x];return y(p,i.formatLong)}return p}).join("").match(SP).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const x=p[0];if(x==="'")return{isToken:!1,value:DP(p)};if(hw[x])return{isToken:!0,value:p};if(x.match(TP))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:p}});i.localize.preprocessor&&(h=i.localize.preprocessor(u,h));const m={firstWeekContainsDate:l,weekStartsOn:c,locale:i};return h.map(p=>{if(!p.isToken)return p.value;const x=p.value;(AP(x)||wP(x))&&NP(x,e,String(n));const y=hw[x[0]];return y(u,x,i.localize,m)}).join("")}function DP(n){const e=n.match(_P);return e?e[1].replace(CP,"'"):n}const RP=()=>{const{token:n}=rs(),[e,t]=E.useState([]),[s,i]=E.useState([]),[l,c]=E.useState([]),[u,h]=E.useState([]),[m,p]=E.useState({total:0,pending:0,approved:0,rejected:0}),[x,y]=E.useState({role:"employee",year:new Date().getFullYear(),leaves:{}}),[v,w]=E.useState({name:"",isActive:!0}),[A,N]=E.useState(null),[j,_]=E.useState(null),[C,k]=E.useState(null),[D,P]=E.useState(""),[F,U]=E.useState(!1),[I,K]=E.useState(""),[H,X]=E.useState("pending"),[W,ce]=E.useState("all"),[me,L]=E.useState(null),[q,V]=E.useState(1),[B]=E.useState(10),[T,G]=E.useState({key:null,direction:"ascending"}),[M,O]=E.useState(!1),ae=async()=>{U(!0);try{const[te,Ne,Ie]=await Promise.all([xe.get("/leave/requests",{headers:{Authorization:`Bearer ${n}`}}),xe.get("/leave/policies",{headers:{Authorization:`Bearer ${n}`}}),xe.get("/leave/get-leaveTypes",{headers:{Authorization:`Bearer ${n}`}})]);t(te.data),i(te.data),c(Ne.data),h(Ie.data);const Ze=new Date().getMonth(),Nt=new Date().getFullYear(),ls=te.data.filter(de=>{const Ae=new Date(de.fromDate);return Ae.getMonth()===Ze&&Ae.getFullYear()===Nt});p({total:ls.length,pending:ls.filter(de=>de.status==="pending").length,approved:ls.filter(de=>de.status==="approved").length,rejected:ls.filter(de=>de.status==="rejected").length})}catch(te){console.error("Error fetching data:",te)}finally{U(!1)}};E.useEffect(()=>{n&&ae()},[n]),E.useEffect(()=>{let te=e;I&&(te=te.filter(Ne=>Ne.employee?.email?.toLowerCase().includes(I.toLowerCase())||Ne.leaveType?.toLowerCase().includes(I.toLowerCase())||Ne.reason?.toLowerCase().includes(I.toLowerCase()))),H!=="all"&&(te=te.filter(Ne=>Ne.status===H)),W!=="all"&&(te=te.filter(Ne=>Ne.leaveType===W)),i(te),V(1)},[I,H,W,e]);const ee=q*B,pe=ee-B,we=s.slice(pe,ee),Te=Math.ceil(s.length/B),ue=async(te,Ne)=>{try{await xe.post(`/leave/${te}/review`,{action:Ne,reason:D||`${Ne}ed by admin`},{headers:{Authorization:`Bearer ${n}`}}),N(null),P(""),ae(),document.getElementById("actionModal").classList.add("hidden")}catch(Ie){console.error("Error updating leave:",Ie)}},He=async te=>{te.preventDefault();try{await xe.post("/leave/create-leave-policy",x,{headers:{Authorization:`Bearer ${n}`}}),ae(),y({role:"employee",year:new Date().getFullYear(),leaves:{}}),document.getElementById("policyModal").classList.add("hidden")}catch(Ne){console.error("Error setting leave policy:",Ne)}},ze=te=>{_(te);const Ne={};te.leaves instanceof Map?te.leaves.forEach((Ie,Ze)=>{Ne[Ze]=Ie}):Object.assign(Ne,te.leaves),y({role:te.role,year:te.year,leaves:Ne}),document.getElementById("policyModal").classList.remove("hidden")},at=async te=>{te.preventDefault();try{C?await xe.put(`/leave/update-leaveType/${C._id}`,{name:v.name},{headers:{Authorization:`Bearer ${n}`}}):await xe.post("/leave/create-leaveType",{name:v.name},{headers:{Authorization:`Bearer ${n}`}}),w({name:"",isActive:!0}),k(null),ae(),document.getElementById("leaveTypeModal").classList.add("hidden")}catch(Ne){console.error("Error creating/updating leave type:",Ne)}},At=async te=>{try{await xe.delete(`/leave/delete-leaveType/${te}`,{headers:{Authorization:`Bearer ${n}`}}),ae()}catch(Ne){console.error("Error deleting leave type:",Ne)}},le=async te=>{try{await xe.patch(`/leave/toggle-leaveType-status/${te}`,{},{headers:{Authorization:`Bearer ${n}`}}),ae()}catch(Ne){console.error("Error toggling leave type status:",Ne)}},be=te=>{k(te),w({name:te.name,isActive:te.isActive}),document.getElementById("leaveTypeModal").classList.remove("hidden")},ye=({status:te})=>{const Ne={approved:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",icon:bs},pending:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",icon:pn},rejected:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",icon:Ks},cancelled:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-200",icon:Ks}},Ie=Ne[te]||Ne.pending,Ze=Ie.icon;return r.jsxs("span",{className:`flex items-center px-3 py-1 rounded-full text-xs font-medium ${Ie.bg} ${Ie.text} ${Ie.border}`,children:[r.jsx(Ze,{size:12,className:"mr-1"}),te]})},Ee=({title:te,value:Ne,subtitle:Ie,icon:Ze,color:Nt})=>r.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-2xl font-bold text-gray-800",children:Ne}),r.jsx("p",{className:"text-sm font-medium text-gray-600",children:te}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Ie})]}),r.jsx("div",{className:`p-3 rounded-full ${Nt}`,children:r.jsx(Ze,{size:24,className:"text-white"})})]})}),Xe=u.filter(te=>te.isActive);return r.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:gap-4 p-2 bg-gray-50 max-h-[80vh] text-[13px]",children:[r.jsxs("div",{className:"md:hidden flex justify-between items-center p-2 bg-white rounded shadow-sm mb-2",children:[r.jsx("h1",{className:"text-sm font-semibold text-gray-800",children:"Admin Leave Management"}),r.jsx("button",{onClick:()=>O(!M),className:"p-1 rounded bg-[#104774] text-white",children:M?r.jsx(Vo,{size:16}):r.jsx(c1,{size:16})})]}),r.jsxs("div",{className:"flex-1 space-y-3",children:[r.jsxs("div",{className:"hidden md:flex items-center justify-between bg-white p-3 rounded shadow-sm",children:[r.jsx("h1",{className:"text-base font-semibold text-gray-800",children:"Admin Leave Management"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{className:"flex items-center bg-[#104774] text-white px-3 py-1.5 rounded text-xs hover:bg-[#0d3a61]",onClick:()=>{_(null),document.getElementById("policyModal").classList.remove("hidden")},children:[r.jsx(Bi,{size:13,className:"mr-1"})," Set Policy"]}),r.jsxs("button",{className:"flex items-center bg-green-600 text-white px-3 py-1.5 rounded text-xs hover:bg-green-700",onClick:ae,children:[r.jsx(Fi,{size:13,className:"mr-1"})," Refresh"]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2",children:[r.jsx(Ee,{title:"Total Requests",value:m.total,subtitle:"This Month",icon:Js,color:"bg-blue-500"}),r.jsx(Ee,{title:"Pending",value:m.pending,subtitle:"Require Action",icon:pn,color:"bg-yellow-500"}),r.jsx(Ee,{title:"Approved",value:m.approved,subtitle:"This Month",icon:bs,color:"bg-green-500"}),r.jsx(Ee,{title:"Rejected",value:m.rejected,subtitle:"Leaves",icon:Ks,color:"bg-red-500"})]}),r.jsxs("div",{className:"bg-white rounded p-2.5 shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(kp,{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400",size:13}),r.jsx("input",{type:"text",placeholder:"Search by employee, type, or reason...",value:I,onChange:te=>K(te.target.value),className:"w-full pl-7 pr-2 py-1.5 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-[#104774]"})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs("select",{value:H,onChange:te=>X(te.target.value),className:"px-2 py-1.5 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-[#104774]",children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"rejected",children:"Rejected"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]}),r.jsxs("select",{value:W,onChange:te=>ce(te.target.value),className:"px-2 py-1.5 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-[#104774]",children:[r.jsx("option",{value:"all",children:"All Types"}),Xe.map(te=>r.jsx("option",{value:te.name,children:te.name.replace(/_/g," ").replace(/\b\w/g,Ne=>Ne.toUpperCase())},te._id))]})]})]}),r.jsxs("p",{className:"mt-1 text-[11px] text-gray-500",children:["Showing ",s.length," of ",e.length," requests"]})]}),r.jsxs("div",{className:"bg-white rounded shadow-sm border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center space-x-2",children:[r.jsx(Js,{size:16,className:"text-[#104774]"}),r.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"All Leave Requests"})]}),F?r.jsxs("div",{className:"p-4 text-center",children:[r.jsx(Fi,{className:"animate-spin mx-auto text-[#104774]",size:20}),r.jsx("p",{className:"mt-1 text-gray-500 text-xs",children:"Loading leave requests..."})]}):s.length===0?r.jsx("div",{className:"p-4 text-center",children:r.jsx("p",{className:"text-gray-500 text-xs",children:"No leave requests found"})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsx("div",{className:"min-w-[700px] md:min-w-full max-h-[350px] md:max-h-[400px] overflow-y-auto",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-1.5 text-left text-xs font-medium whitespace-nowrap",children:"Employee"}),r.jsx("th",{className:"p-1.5 text-left text-xs font-medium whitespace-nowrap",children:"Type"}),r.jsx("th",{className:"p-1.5 text-left text-xs font-medium whitespace-nowrap",children:"From"}),r.jsx("th",{className:"p-1.5 text-left text-xs font-medium whitespace-nowrap",children:"To"}),r.jsx("th",{className:"p-1.5 text-left text-xs font-medium whitespace-nowrap",children:"Days"}),r.jsx("th",{className:"p-1.5 text-left text-xs font-medium whitespace-nowrap",children:"Balance"}),r.jsx("th",{className:"p-1.5 text-left text-xs font-medium whitespace-nowrap",children:"Status"}),r.jsx("th",{className:"p-1.5 text-left text-xs font-medium whitespace-nowrap",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:we.sort((te,Ne)=>new Date(Ne.appliedAt)-new Date(te.appliedAt)).map((te,Ne)=>{const Ie=te.currentRemaining&&te.currentRemaining[te.leaveType]>=te.totalDays;return r.jsxs(Eo.Fragment,{children:[r.jsxs("tr",{className:`${Ne%2===0?"bg-white":"bg-gray-50"} hover:bg-gray-100 transition-colors`,children:[r.jsx("td",{className:"p-1.5 text-xs whitespace-nowrap",children:r.jsx("div",{className:"truncate max-w-[100px] md:max-w-none",children:te.employee?.email||"N/A"})}),r.jsx("td",{className:"p-1.5 text-xs capitalize whitespace-nowrap",children:te.leaveType.replace(/_/g," ")}),r.jsx("td",{className:"p-1.5 text-xs whitespace-nowrap",children:yo(new Date(te.fromDate),"dd MMM yyyy")}),r.jsx("td",{className:"p-1.5 text-xs whitespace-nowrap",children:yo(new Date(te.toDate),"dd MMM yyyy")}),r.jsx("td",{className:"p-1.5 text-xs whitespace-nowrap",children:te.totalDays}),r.jsx("td",{className:"p-1.5 text-xs whitespace-nowrap",children:r.jsx("div",{className:"flex items-center",children:te.currentRemaining?r.jsxs(r.Fragment,{children:[r.jsxs("span",{className:Ie?"text-green-600 font-medium":"text-red-600 font-medium",children:[te.currentRemaining[te.leaveType],"/",te.balanceSnapshot?.remaining[te.leaveType]]}),!Ie&&r.jsx(ns,{size:12,className:"text-red-500 ml-1"})]}):r.jsx("span",{className:"text-gray-400",children:"N/A"})})}),r.jsx("td",{className:"p-1.5",children:r.jsx(ye,{status:te.status})}),r.jsx("td",{className:"p-1.5",children:r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("button",{className:"p-1 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200",onClick:()=>L(me===te._id?null:te._id),title:"View Details",children:r.jsx(To,{size:12})}),te.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"p-1 rounded-full bg-green-100 text-green-600 hover:bg-green-200",onClick:()=>{N(te),document.getElementById("actionModal").classList.remove("hidden")},title:"Approve",children:r.jsx(bs,{size:12})}),r.jsx("button",{className:"p-1 rounded-full bg-red-100 text-red-600 hover:bg-red-200",onClick:()=>{N(te),document.getElementById("actionModal").classList.remove("hidden")},title:"Reject",children:r.jsx(Ks,{size:12})})]})]})})]}),me===te._id&&r.jsx("tr",{children:r.jsx("td",{colSpan:"8",className:"p-2 bg-gray-50",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[r.jsxs("div",{className:"bg-white p-2 rounded shadow-sm border",children:[r.jsx("h4",{className:"text-[#104774] font-semibold text-xs mb-1",children:"Request Details"}),r.jsxs("div",{className:"space-y-1 text-xs",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Reason:"})," ",te.reason||"-"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Applied On:"})," ",yo(new Date(te.appliedAt),"dd MMM yyyy, hh:mm a")]}),te.processedBy&&r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Processed By:"})," ",te.processedBy?.email||"Admin"]}),te.processedAt&&r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Processed At:"})," ",yo(new Date(te.processedAt),"dd MMM yyyy, hh:mm a")]}),te.remarks&&r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Remarks:"})," ",te.remarks]})]})]}),r.jsxs("div",{className:"bg-white p-2 rounded shadow-sm border",children:[r.jsx("h4",{className:"text-[#104774] font-semibold text-xs mb-1",children:"Balance Information"}),r.jsxs("div",{className:"space-y-1 text-xs",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Remaining at request:"})," ",te.balanceSnapshot?.remaining?.[te.leaveType]??"-"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Current remaining:"})," ",te.currentRemaining?.[te.leaveType]??"-"]}),!Ie&&r.jsxs("p",{className:"text-red-600 font-medium flex items-center mt-1",children:[r.jsx(ns,{size:12,className:"mr-1"}),"Insufficient balance"]})]})]})]})})})]},te._id)})})]})})}),Te>1&&r.jsxs("div",{className:"p-2 border-t border-gray-200 flex flex-col sm:flex-row justify-between items-center gap-2",children:[r.jsxs("div",{className:"text-xs text-gray-500",children:["Showing ",pe+1," to"," ",Math.min(ee,s.length)," of"," ",s.length," entries"]}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("button",{onClick:()=>V(te=>Math.max(te-1,1)),disabled:q===1,className:"px-2 py-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-xs hover:bg-gray-100",children:"Previous"}),Array.from({length:Math.min(5,Te)},(te,Ne)=>{let Ie;return Te<=5||q<=3?Ie=Ne+1:q>=Te-2?Ie=Te-4+Ne:Ie=q-2+Ne,r.jsx("button",{onClick:()=>V(Ie),className:`px-2 py-1 rounded border text-xs transition ${q===Ie?"bg-[#104774] text-white border-[#104774]":"hover:bg-gray-100 border-gray-300"}`,children:Ie},Ie)}),r.jsx("button",{onClick:()=>V(te=>Math.min(te+1,Te)),disabled:q===Te,className:"px-2 py-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-xs hover:bg-gray-100",children:"Next"})]})]})]})]})]}),r.jsxs("div",{className:`w-full md:w-56 space-y-3 ${M?"block":"hidden"} md:block`,children:[r.jsxs("div",{className:"bg-white rounded p-2.5 shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h3",{className:"text-sm font-semibold",children:"Leave Policies"}),r.jsx("button",{className:"text-[#104774] hover:text-[#0d3a61]",onClick:()=>{_(null),document.getElementById("policyModal").classList.remove("hidden")},children:r.jsx(Bi,{size:14})})]}),l.length===0?r.jsx("p",{className:"text-gray-500 text-center py-2 text-xs",children:"No policies set yet"}):r.jsx("div",{className:"space-y-1.5 max-h-70 overflow-y-auto",children:l.map(te=>{const Ne=te.leaves instanceof Map?Object.fromEntries(te.leaves):te.leaves;return r.jsxs("div",{className:"border border-gray-200 rounded p-1.5 hover:shadow-md transition-shadow",children:[r.jsxs("div",{className:"flex justify-between items-start mb-1",children:[r.jsxs("h4",{className:"font-medium text-[#104774] text-xs",children:[te.role.charAt(0).toUpperCase()+te.role.slice(1)," - ",te.year]}),r.jsx("button",{onClick:()=>ze(te),className:"text-gray-500 hover:text-[#104774]",children:r.jsx(Xm,{size:12})})]}),r.jsx("div",{className:"space-y-0.5 text-xs",children:Object.entries(Ne).map(([Ie,Ze])=>r.jsxs("p",{className:"flex justify-between",children:[r.jsxs("span",{className:"capitalize",children:[Ie.replace(/_/g," "),":"]})," ",r.jsx("span",{className:"font-medium",children:Ze})]},Ie))})]},te._id)})})]}),r.jsxs("div",{className:"bg-white rounded p-2.5 shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h3",{className:"text-sm font-semibold",children:"Leave Types"}),r.jsx("button",{className:"text-[#104774] hover:text-[#0d3a61]",onClick:()=>{k(null),w({name:"",isActive:!0}),document.getElementById("leaveTypeModal").classList.remove("hidden")},children:r.jsx(Bi,{size:14})})]}),u.length===0?r.jsx("p",{className:"text-gray-500 text-center py-2 text-xs",children:"No leave types set yet"}):r.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:u.map(te=>r.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-gray-100 last:border-0",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:`text-xs ${te.isActive?"text-gray-800":"text-gray-400 line-through"}`,children:te.name.replace(/_/g," ").replace(/\b\w/g,Ne=>Ne.toUpperCase())}),!te.isActive&&r.jsx("span",{className:"ml-1 text-xs text-gray-400",children:"(Inactive)"})]}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("button",{onClick:()=>be(te),className:"text-gray-500 hover:text-[#104774] p-0.5",children:r.jsx(Xm,{size:10})}),r.jsx("button",{onClick:()=>le(te._id),className:`p-0.5 text-xs ${te.isActive?"text-yellow-500 hover:text-yellow-700":"text-green-500 hover:text-green-700"}`,children:te.isActive?"Disable":"Enable"}),r.jsx("button",{onClick:()=>At(te._id),className:"text-gray-500 hover:text-red-600 p-0.5",children:r.jsx(Mp,{size:10})})]})]},te._id))})]})]}),r.jsx("div",{id:"policyModal",className:"fixed inset-0 backdrop-blur-sm  bg-opacity-40 flex items-center justify-center hidden z-50 p-2",children:r.jsxs("div",{className:"bg-white p-3 rounded w-full max-w-md max-h-[90vh] overflow-y-auto shadow-2xl",children:[r.jsx("h3",{className:"text-sm font-semibold mb-2",children:j?"Edit Leave Policy":"Create Leave Policy"}),r.jsxs("form",{onSubmit:He,className:"space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium mb-0.5",children:"Role"}),r.jsxs("select",{value:x.role,onChange:te=>y({...x,role:te.target.value}),className:"w-full border border-gray-300 rounded px-2 py-1.5 focus:outline-none focus:ring-1 focus:ring-[#104774] text-xs",children:[r.jsx("option",{value:"employee",children:"Employee"}),r.jsx("option",{value:"hr",children:"HR"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium mb-0.5",children:"Year"}),r.jsx("input",{type:"number",min:"2000",max:"2100",value:x.year,onChange:te=>y({...x,year:parseInt(te.target.value)||new Date().getFullYear()}),className:"w-full border border-gray-300 rounded px-2 py-1.5 focus:outline-none focus:ring-1 focus:ring-[#104774] text-xs"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium mb-0.5",children:"Leave Types"}),r.jsx("div",{className:"space-y-1.5",children:u.filter(te=>te.isActive).map(te=>r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium mb-0.5 capitalize",children:[te.name.replace(/_/g," ")," Leaves"]}),r.jsx("input",{type:"number",min:"0",value:x.leaves[te.name]||0,onChange:Ne=>y({...x,leaves:{...x.leaves,[te.name]:parseInt(Ne.target.value)||0}}),className:"w-full border border-gray-300 rounded px-2 py-1.5 focus:outline-none focus:ring-1 focus:ring-[#104774] text-xs"})]},te._id))})]}),r.jsxs("div",{className:"flex justify-end space-x-1 pt-2",children:[r.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-300 hover:bg-gray-400 transition-colors text-xs",onClick:()=>document.getElementById("policyModal").classList.add("hidden"),children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-2 py-1 rounded bg-[#104774] text-white hover:bg-[#0d3a61] transition-colors text-xs",children:j?"Update Policy":"Save Policy"})]})]})]})}),r.jsx("div",{id:"leaveTypeModal",className:"fixed inset-0 backdrop-blur-sm  bg-opacity-40 flex items-center justify-center hidden z-50 p-2",children:r.jsxs("div",{className:"bg-white p-3 rounded w-full max-w-md border border-gray-200 shadow-2xl",children:[r.jsx("h3",{className:"text-sm font-semibold mb-2",children:C?"Edit Leave Type":"Add Leave Type"}),r.jsxs("form",{onSubmit:at,className:"space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium mb-0.5",children:"Leave Type Name"}),r.jsx("input",{type:"text",value:v.name,onChange:te=>w({...v,name:te.target.value}),className:"w-full border border-gray-300 rounded px-2 py-1.5 focus:outline-none focus:ring-1 focus:ring-[#104774] text-xs",placeholder:"e.g., Work From Home",required:!0}),r.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:'Use underscores for spaces (e.g., "work_from_home")'})]}),r.jsxs("div",{className:"flex justify-end space-x-1 pt-1",children:[r.jsx("button",{type:"button",className:"px-2 py-1 rounded bg-gray-300 hover:bg-gray-400 transition-colors text-xs",onClick:()=>{document.getElementById("leaveTypeModal").classList.add("hidden"),k(null)},children:"Cancel"}),r.jsxs("button",{type:"submit",className:"px-2 py-1 rounded bg-[#104774] text-white hover:bg-[#0d3a61] transition-colors text-xs",children:[C?"Update":"Add"," Leave Type"]})]})]})]})}),r.jsx("div",{id:"actionModal",className:"fixed inset-0 backdrop-blur-sm  bg-opacity-40 flex items-center justify-center hidden z-50 p-2",children:r.jsxs("div",{className:"bg-white p-3 rounded w-full max-w-md mx-2 border border-gray-200 shadow-2xl max-h-[90vh] overflow-y-auto",children:[r.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Process Leave Request"}),A&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-2 p-2 bg-gray-50 rounded",children:[r.jsxs("p",{className:"text-xs break-words",children:[r.jsx("strong",{children:"Employee:"})," ",A.employee?.email]}),r.jsxs("p",{className:"text-xs",children:[r.jsx("strong",{children:"Type:"})," ",A.leaveType]}),r.jsxs("p",{className:"text-xs",children:[r.jsx("strong",{children:"Duration:"})," ",A.totalDays," days"]}),r.jsxs("p",{className:"text-xs break-words",children:[r.jsx("strong",{children:"Reason:"})," ",A.reason||"-"]}),A.currentRemaining&&r.jsxs("p",{className:`mt-1 text-xs break-words ${A.currentRemaining[A.leaveType]<A.totalDays?"text-red-600 font-medium":""}`,children:[r.jsx("strong",{children:"Remaining Balance:"})," ",A.currentRemaining[A.leaveType],"/",A.balanceSnapshot?.remaining[A.leaveType],A.currentRemaining[A.leaveType]<A.totalDays&&r.jsx("span",{className:"ml-0.5",children:"(Insufficient balance)"})]})]}),r.jsxs("div",{className:"mb-2",children:[r.jsx("label",{className:"block text-xs font-medium mb-0.5",children:"Remarks (Optional)"}),r.jsx("textarea",{value:D,onChange:te=>P(te.target.value),className:"w-full border border-gray-300 rounded px-2 py-1.5 focus:outline-none focus:ring-1 focus:ring-[#104774] text-xs",rows:"3",placeholder:"Add remarks for this action..."})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-1",children:[r.jsx("button",{className:"px-2 py-1 rounded bg-gray-300 hover:bg-gray-400 transition-colors text-xs order-2 sm:order-1",onClick:()=>{document.getElementById("actionModal").classList.add("hidden"),P("")},children:"Cancel"}),r.jsxs("div",{className:"flex space-x-1 order-1 sm:order-2",children:[r.jsx("button",{className:"px-2 py-1 rounded bg-red-600 text-white hover:bg-red-700 transition-colors text-xs flex-1",onClick:()=>ue(A._id,"reject"),children:"Reject"}),r.jsx("button",{className:"px-2 py-1 rounded bg-green-600 text-white hover:bg-green-700 transition-colors text-xs flex-1",onClick:()=>ue(A._id,"approve"),children:"Approve"})]})]})]})]})})]})},Bu=({isOpen:n,onClose:e,onSuccess:t,token:s,addNotification:i,basePath:l="/attendance"})=>{const[c,u]=E.useState(""),[h,m]=E.useState("Planned"),[p,x]=E.useState(""),[y,v]=E.useState(""),[w,A]=E.useState(!1),[N,j]=E.useState(!1),[_,C]=E.useState(!1),[k,D]=E.useState(null),[P,F]=E.useState(null);E.useEffect(()=>{n||(u(""),m("Planned"),x(""),v(""),A(!1),j(!1),D(null))},[n]),E.useEffect(()=>{n&&s&&U()},[n,s]);const U=async()=>{try{const H=await xe.get("/profile/my-profile",{headers:{Authorization:`Bearer ${s}`}});H.data?.shiftTiming&&(F(H.data.shiftTiming),I(H.data.shiftTiming))}catch(H){console.error("Error fetching shift timing:",H),i("Error fetching shift information","error")}},I=H=>{if(!H?.start)return;const X=new Date,W=X.getHours()*60+X.getMinutes(),[ce,me]=H.start.split(" "),[L,q]=ce.split(":").map(Number);let V=L*60+q;me==="PM"&&L!==12&&(V+=720),me==="AM"&&L===12&&(V-=720),W<V?(A(!0),D(`You are logging in before your shift start time (${H.start}). Please provide a reason for early login.`)):W>V+60&&(j(!0),D(`You are logging in after 1 hour from your shift start time (${H.start}). Please provide a reason for late login.`))},K=async H=>{if(H.preventDefault(),!c.trim()){D("Task description is required");return}if(w&&!p.trim()){D("Early login reason is required");return}if(N&&!y.trim()){D("Late login reason is required");return}C(!0),D(null);try{const X={taskDescription:c,workProgress:h,...w&&{earlyLoginReason:p},...N&&{lateLoginReason:y}},W=await xe.post(`${l}/login`,X,{headers:{Authorization:`Bearer ${s}`}});W.data?.message&&i(W.data.message,"success");const ce=W.data?.attendance||W.data;ce&&t(ce),e()}catch(X){console.error("Error submitting attendance:",X);const W=X?.response?.data?.message||"Error submitting attendance";D(W),i(W,"error")}finally{C(!1)}};return n?r.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Mark Attendance"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),P&&r.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-md",children:r.jsxs("p",{className:"text-sm text-blue-800",children:["Your shift timing: ",r.jsxs("strong",{children:[P.start," - ",P.end]})]})}),k&&r.jsx("div",{className:`mb-4 p-3 rounded text-sm ${k.includes("Error")||k.includes("required")?"bg-red-50 text-red-800 border border-red-100":"bg-blue-50 text-blue-800 border border-blue-100"}`,children:k}),r.jsxs("form",{onSubmit:K,children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Task Description *"}),r.jsx("textarea",{value:c,onChange:H=>u(H.target.value),rows:4,required:!0,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe what you'll be working on today..."})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Work Progress"}),r.jsxs("select",{value:h,onChange:H=>m(H.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"Planned",children:"Planned"}),r.jsx("option",{value:"In Progress",children:"In Progress"}),r.jsx("option",{value:"Completed",children:"Completed"})]})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:w,onChange:H=>{A(H.target.checked),H.target.checked&&j(!1)},className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),r.jsx("span",{className:"text-sm text-gray-700",children:"Logging in early"})]})}),w&&r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for early login *"}),r.jsx("textarea",{value:p,onChange:H=>x(H.target.value),rows:3,required:w,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Please provide reason for logging in early..."})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:N,onChange:H=>{j(H.target.checked),H.target.checked&&A(!1)},className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),r.jsx("span",{className:"text-sm text-gray-700",children:"Logging in late"})]})}),N&&r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for late login *"}),r.jsx("textarea",{value:y,onChange:H=>v(H.target.value),rows:3,required:N,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Please provide reason for logging in late..."})]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:_,children:"Cancel"}),r.jsx("button",{type:"submit",disabled:_,className:"px-4 py-2 rounded-md text-white disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#104774"},onMouseEnter:H=>H.currentTarget.style.backgroundColor="#0d3a61",onMouseLeave:H=>H.currentTarget.style.backgroundColor="#104774",children:_?"Submitting...":"Submit Attendance"})]})]})]})}):null},Hu=({isOpen:n,onClose:e,onSuccess:t,attendanceData:s,token:i,addNotification:l,basePath:c="/attendance"})=>{const[u,h]=E.useState(""),[m,p]=E.useState(""),[x,y]=E.useState(!1),[v,w]=E.useState(!1),[A,N]=E.useState(null),j=async _=>{if(_.preventDefault(),!u.trim()){N("Logout description is required");return}if(x&&!m.trim()){N("Early logout reason is required");return}w(!0),N(null);try{if(!s||!s._id)throw new Error("Attendance record id is missing.");const C=await xe.post(`${c}/logout/${s._id}`,{logoutDescription:u,earlyLogoutReason:x?m:void 0},{headers:{Authorization:`Bearer ${i}`}});C.data?.message?(l(C.data.message,"success"),N(C.data.message)):l("Logout recorded successfully","success");const k=C.data?.attendance||C.data;k&&k._id?t(k):t({...s,checkOut:new Date().toISOString(),logoutDescription:u,earlyLogoutReason:x?m:void 0}),h(""),p(""),y(!1)}catch(C){console.error("Error recording logout:",C);const k=C?.response?.data?.message||C.message||"Error recording logout";N(k),l(k,"error")}finally{w(!1)}};return n?r.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Log Out"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),A&&r.jsx("div",{className:`mb-4 p-3 rounded text-sm ${A.includes("Error")||A.includes("required")?"bg-red-50 text-red-800 border border-red-100":"bg-green-50 text-green-800 border border-green-100"}`,children:A}),r.jsxs("form",{onSubmit:j,children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logout Description *"}),r.jsx("textarea",{value:u,onChange:_=>h(_.target.value),rows:4,required:!0,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe what you completed today..."})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:x,onChange:_=>y(_.target.checked),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),r.jsx("span",{className:"text-sm text-gray-700",children:"Logging out early"})]})}),x&&r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for early logout *"}),r.jsx("textarea",{value:m,onChange:_=>p(_.target.value),rows:3,required:x,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Please provide reason for early logout..."})]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:v,children:"Cancel"}),r.jsx("button",{type:"submit",disabled:v,className:"px-4 py-2 rounded-md text-white disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#104774"},onMouseEnter:_=>_.currentTarget.style.backgroundColor="#0d3a61",onMouseLeave:_=>_.currentTarget.style.backgroundColor="#104774",children:v?"Logging Out...":"Confirm Logout"})]})]})]})}):null},kP=({isOpen:n,onClose:e,onSuccess:t,token:s,addNotification:i,employeeId:l})=>{const[c,u]=E.useState(""),[h,m]=E.useState(""),[p,x]=E.useState(""),[y,v]=E.useState(""),[w,A]=E.useState(!1),[N,j]=E.useState(null),_=async C=>{if(C.preventDefault(),!c||!y.trim()){j("Date and reason are required");return}A(!0),j(null);try{const k=await xe.post("/attendance/regularization",{date:c,checkIn:h||void 0,checkOut:p||void 0,reason:y},{headers:{Authorization:`Bearer ${s}`}});k.data?.message?(i(k.data.message,"success"),j(k.data.message)):i("Regularization request submitted","success"),t(),u(""),m(""),x(""),v("")}catch(k){console.error("Error submitting regularization:",k);const D=k?.response?.data?.message||"Error submitting regularization request";j(D),i(D,"error")}finally{A(!1)}};return n?r.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Request Regularization"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),N&&r.jsx("div",{className:`mb-4 p-3 rounded text-sm ${N.includes("Error")||N.includes("required")?"bg-red-50 text-red-800 border border-red-100":"bg-green-50 text-green-800 border border-green-100"}`,children:N}),r.jsxs("form",{onSubmit:_,children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),r.jsx("input",{type:"date",value:c,onChange:C=>u(C.target.value),required:!0,max:new Date().toISOString().split("T")[0],className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Check-in Time"}),r.jsx("input",{type:"time",value:h,onChange:C=>m(C.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Check-out Time"}),r.jsx("input",{type:"time",value:p,onChange:C=>x(C.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for Regularization *"}),r.jsx("textarea",{value:y,onChange:C=>v(C.target.value),rows:4,required:!0,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Explain why you need regularization for this date..."})]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:w,children:"Cancel"}),r.jsx("button",{type:"submit",disabled:w,className:"px-4 py-2 rounded-md text-white disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#104774"},onMouseEnter:C=>C.currentTarget.style.backgroundColor="#0d3a61",onMouseLeave:C=>C.currentTarget.style.backgroundColor="#104774",children:w?"Submitting...":"Submit Request"})]})]})]})}):null},Ji=({notifications:n})=>{const e=s=>{switch(s){case"success":return"bg-green-50 text-green-800 border border-green-100";case"error":return"bg-red-50 text-red-800 border border-red-100";case"warning":return"bg-yellow-50 text-yellow-800 border border-yellow-100";default:return"bg-white text-gray-800 border border-gray-200"}},t=s=>{switch(s){case"success":return r.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case"error":return r.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})});case"warning":return r.jsx("svg",{className:"w-5 h-5 text-yellow-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})});default:return r.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}};return r.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2",children:n.map(s=>r.jsxs("div",{className:`max-w-sm w-full px-4 py-3 rounded-lg shadow-lg flex items-start gap-3 transform transition-all duration-300 animate-in slide-in-from-right-10 ${e(s.type)}`,children:[r.jsx("div",{className:"flex-shrink-0",children:t(s.type)}),r.jsx("div",{className:"flex-1",children:r.jsx("p",{className:"text-sm font-medium",children:s.message})})]},s.id))})},MP="#0d3a61",LP=()=>{const{token:n,user:e}=rs(),[t,s]=E.useState(null),[i,l]=E.useState(!1),[c,u]=E.useState(!1),[h,m]=E.useState(!1),[p,x]=E.useState([]),[y,v]=E.useState([]),[w,A]=E.useState(!1);E.useEffect(()=>{n&&(j(),_())},[n]);const N=(X,W="info",ce=4e3)=>{const me=Date.now()+Math.random();v(L=>[...L,{id:me,message:X,type:W}]),setTimeout(()=>v(L=>L.filter(q=>q.id!==me)),ce)},j=async()=>{try{const X=await xe.get("/attendance/today",{headers:{Authorization:`Bearer ${n}`}});s(X.data||null)}catch(X){console.error("Error fetching today attendance:",X),s(null),N(X?.response?.data?.message||"Could not fetch today attendance","error")}},_=async()=>{try{const X=await xe.get("/attendance/history",{headers:{Authorization:`Bearer ${n}`}});x(X.data||[])}catch(X){console.error("Error fetching attendance history:",X),x([]),N(X?.response?.data?.message||"Could not fetch attendance history","error")}},C=async X=>{try{return(await xe.get(`/attendance/check-holiday/${X}`,{headers:{Authorization:`Bearer ${n}`}})).data.isHoliday}catch(W){return console.error("Error checking holiday:",W),!1}},k=X=>{s(X),l(!1),N("Attendance submitted successfully","success"),j(),_()},D=X=>{s(X),u(!1),N("Logout recorded successfully","success"),j(),_()},P=()=>{m(!1),N("Regularization request submitted","success"),_()},F=X=>{if(!X)return"-";try{return new Date(X).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"-"}},U=X=>{if(!X)return"-";try{return new Date(X).toLocaleDateString()}catch{return"-"}},I=X=>{const W={pending:"bg-yellow-100 text-yellow-800",accepted:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${W[X]||"bg-gray-100 text-gray-800"}`,children:X})},K=!t,H=t&&t.status==="accepted"&&!t.checkOut;return r.jsxs("div",{className:"min-h-[80vh] p-4",children:[r.jsx("style",{children:`
        .primary-btn:hover { background: ${MP} !important }
      `}),r.jsx(Ji,{notifications:y}),r.jsxs("header",{className:"p-4 mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"My Attendance"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Manage your daily attendance and view history"})]}),r.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 flex flex-col h-[275px] w-[350px] mb-5",children:[r.jsx("div",{className:"flex items-center justify-between mb-4",children:r.jsxs("h3",{className:"font-semibold text-slate-800 text-lg",children:["Today's Attendance",r.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",new Date().toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),")"]})]})}),r.jsxs("div",{className:"flex-grow space-y-3 overflow-y-auto pr-1 scrollbar-hide mb-4",children:[r.jsxs("div",{className:"text-sm text-slate-600",children:["Status:"," ",r.jsx("span",{className:`font-medium ${t?.status==="accepted"?"text-green-500":t?.status==="pending"?"text-yellow-400":t?.status==="rejected"?"text-red-500":"text-gray-400"}`,children:t?.status||"Not Logged In"})]}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Login Time:"," ",r.jsx("span",{className:"font-medium text-slate-900",children:t?.checkIn?F(t.checkIn):"-"})]}),t?.taskDescription&&r.jsxs("div",{className:"text-sm text-slate-600",children:["Task:"," ",r.jsx("span",{className:"font-medium text-slate-900",title:t.taskDescription,children:t.taskDescription})]}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Logout Time:"," ",r.jsx("span",{className:"font-medium text-slate-900",children:t?.checkOut?F(t.checkOut):"Pending"})]}),t?.logoutDescription&&r.jsxs("div",{className:"text-sm text-slate-600",children:["Logout Note:"," ",r.jsx("span",{className:"font-medium text-slate-900",title:t.logoutDescription,children:t.logoutDescription})]}),t?.earlyLogoutReason&&r.jsxs("div",{className:"text-sm text-red-600",children:["Early Logout:"," ",r.jsx("span",{className:"font-medium",title:t.earlyLogoutReason,children:t.earlyLogoutReason})]})]}),r.jsxs("div",{className:"flex gap-2 mt-auto",children:[K&&r.jsx("button",{onClick:async()=>{const X=new Date().toISOString().split("T")[0];if(await C(X)){N("Today is a holiday. Cannot mark attendance.","warning");return}l(!0)},className:"flex-1 bg-[#104774] hover:bg-[#0d3a61] text-white py-2 rounded-xl font-medium transition-all duration-300 shadow-md hover:shadow-lg",children:"Mark Attendance"}),H&&r.jsx("button",{onClick:()=>u(!0),className:"flex-1 bg-[#104774] hover:bg-[#0d3a61] text-white py-2 rounded-xl font-medium transition-all duration-300 shadow-md hover:shadow-lg",children:"Log Out"})]})]}),r.jsxs("section",{className:"bg-white shadow rounded-lg p-6  ",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Attendance History"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Last 30 days"}),r.jsx("button",{onClick:_,className:"p-2 text-gray-500 hover:text-gray-700",title:"Refresh",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:`M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 \r
            0a8.003 8.003 0 01-15.357-2m15.357 2H15`})})})]})]}),r.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:r.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Login"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Logout"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Work Progress"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Task"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:p.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:"No attendance records found"})}):p.map(X=>r.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:U(X.date)}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:X.checkIn?F(X.checkIn):"-"}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:X.checkOut?F(X.checkOut):"-"}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:I(X.status)}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:X.workProgress||"-"}),r.jsxs("td",{className:"px-4 py-3 text-sm text-gray-700 relative group",children:[r.jsx("div",{className:"max-w-xs truncate cursor-pointer",children:X.taskDescription||"-"}),X.taskDescription&&r.jsx("div",{className:"absolute left-1/2 top-full mt-2 hidden group-hover:flex -translate-x-1/2 z-20",children:r.jsxs("div",{className:"bg-gray-800 text-white text-xs rounded-lg shadow-lg px-3 py-2 max-w-sm whitespace-normal relative animate-fadeIn",children:[X.taskDescription,r.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-800 rotate-45"})]})})]})]},X._id))})]})})})]}),r.jsx(Bu,{isOpen:i,onClose:()=>l(!1),onSuccess:k,token:n,addNotification:N}),r.jsx(Hu,{isOpen:c,onClose:()=>u(!1),onSuccess:D,attendanceData:t,token:n,addNotification:N}),r.jsx(kP,{isOpen:h,onClose:()=>m(!1),onSuccess:P,token:n,addNotification:N,employeeId:e?._id})]})},PN=({isOpen:n,onClose:e,onReject:t,remarks:s,setRemarks:i})=>n?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Reject Attendance"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for Rejection *"}),r.jsx("textarea",{value:s,onChange:l=>i(l.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"4",placeholder:"Please provide specific reason for rejecting this attendance...",required:!0})]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:()=>t(s),disabled:!s.trim(),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirm Reject"})]})]})}):null,OP=({token:n,addNotification:e,user:t})=>{const[s,i]=E.useState(null),[l,c]=E.useState(!1),[u,h]=E.useState(!1),[m,p]=E.useState([]),[x,y]=E.useState(!1);E.useEffect(()=>{v()},[n]);const v=async()=>{try{y(!0);const[D,P]=await Promise.all([xe.get("/attendance/hr/today",{headers:{Authorization:`Bearer ${n}`}}),xe.get("/attendance/hr/history",{headers:{Authorization:`Bearer ${n}`}})]);i(D.data),p(P.data||[])}catch(D){console.error("Error fetching HR attendance data:",D),e("Error loading attendance data","error")}finally{y(!1)}},w=D=>{i(D),c(!1),e("Attendance submitted successfully","success"),v()},A=D=>{i(D),h(!1),e("Logout recorded successfully","success"),v()},N=D=>{if(!D)return"-";try{return new Date(D).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"-"}},j=D=>{if(!D)return"-";try{return new Date(D).toLocaleDateString()}catch{return"-"}},_=D=>{const P={pending:"bg-yellow-100 text-yellow-800",accepted:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${P[D]||"bg-gray-100 text-gray-800"}`,children:D})},C=!s,k=s?.status==="accepted"&&!s.checkOut;return r.jsxs("div",{children:[r.jsxs("div",{className:"h-[300px] overflow-y-auto border border-gray-200 rounded-lg shadow-sm p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"My Attendance"}),r.jsx("button",{onClick:v,className:"p-2 text-gray-500 hover:text-gray-700",title:"Refresh",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),r.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Today's Attendance"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[r.jsxs("div",{className:"p-3 bg-white rounded-lg shadow flex flex-col",children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Status"}),r.jsx("span",{className:`text-lg font-semibold mt-1 capitalize ${s?.status==="accepted"?"text-green-600":s?.status==="pending"?"text-yellow-600":"text-red-600"}`,children:s?.status||"Not Logged In"})]}),r.jsxs("div",{className:"p-3 bg-white rounded-lg shadow flex flex-col",children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Login Time"}),r.jsx("span",{className:"text-lg font-semibold mt-1",children:s?.checkIn?N(s.checkIn):"-"})]}),r.jsxs("div",{className:"p-3 bg-white rounded-lg shadow flex flex-col",children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Logout Time"}),r.jsx("span",{className:"text-lg font-semibold mt-1",children:s?.checkOut?N(s.checkOut):"Pending"})]})]}),r.jsxs("div",{className:"flex gap-3 mt-3",children:[C&&r.jsx("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-[#104774] text-white rounded-md hover:bg-[#0d3a61]",children:"Mark Attendance"}),k&&r.jsx("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-[#104774] text-white rounded-md hover:bg-[#0d3a61]",children:"Log Out"})]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Login"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Logout"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Task"})]})}),r.jsx("tbody",{children:m.map((D,P)=>r.jsxs("tr",{className:`${P%2===0?"bg-white":"bg-gray-50"} hover:bg-gray-100 transition`,children:[r.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 whitespace-nowrap",children:j(D.date)}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 whitespace-nowrap",children:D.checkIn?N(D.checkIn):"-"}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 whitespace-nowrap",children:D.checkOut?N(D.checkOut):"-"}),r.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:_(D.status)}),r.jsxs("td",{className:"px-4 py-2 text-sm text-gray-700 relative group max-w-xs truncate cursor-pointer",children:[D.taskDescription||"-",D.taskDescription&&r.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-1 w-64 bg-gray-800 text-white text-xs rounded-md p-2 shadow-lg z-[999] invisible opacity-0 group-hover:visible group-hover:opacity-100 break-words",children:D.taskDescription})]})]},D._id))})]})})]}),r.jsx(Bu,{isOpen:l,onClose:()=>c(!1),onSuccess:w,token:n,addNotification:e,basePath:"/attendance/hr"}),r.jsx(Hu,{isOpen:u,onClose:()=>h(!1),onSuccess:A,attendanceData:s,token:n,addNotification:e,basePath:"/attendance/hr"})]})},qa="#104774",PP="#0d3a61",IP=()=>{const{token:n,user:e}=rs(),[t,s]=E.useState([]),[i,l]=E.useState([]),[c,u]=E.useState(null),[h,m]=E.useState(!1),[p,x]=E.useState(""),[y,v]=E.useState("pending"),[w,A]=E.useState({totalEmployees:0,present:0,absent:0,pending:0}),[N,j]=E.useState([]),[_,C]=E.useState(!1),k=new Date().toISOString().split("T")[0],[D,P]=E.useState({employee:"",date:k,status:""});E.useEffect(()=>{n&&(U(),I(),K())},[n]);const F=(M,O="info",ae=3500)=>{const ee=Date.now()+Math.random();j(pe=>[...pe,{id:ee,message:M,type:O}]),setTimeout(()=>j(pe=>pe.filter(we=>we.id!==ee)),ae)},U=async()=>{try{C(!0);const M=await xe.get("/attendance/pending",{headers:{Authorization:`Bearer ${n}`}});s(M.data||[])}catch(M){console.error("Error fetching pending attendances:",M),F(M.response?.data?.message||"Could not load pending requests","error")}finally{C(!1)}},I=async()=>{try{C(!0);const M=await xe.get("/attendance/all",{headers:{Authorization:`Bearer ${n}`}});l(M.data||[])}catch(M){console.error("Error fetching all attendances:",M),F(M.response?.data?.message||"Could not load records","error")}finally{C(!1)}},K=async()=>{try{const M=await xe.get("/attendance/stats",{headers:{Authorization:`Bearer ${n}`}});A(M.data||{})}catch(M){console.error("Error fetching stats:",M),F("Error loading statistics","error")}},H=M=>{!M||!M._id||(l(O=>{const ae=O.findIndex(pe=>pe._id===M._id);if(ae===-1)return[M,...O];const ee=[...O];return ee[ae]={...ee[ae],...M},ee}),s(O=>O.filter(ae=>ae._id!==M._id)))},X=async M=>{try{const O=await xe.patch(`/attendance/${M}/approve`,{},{headers:{Authorization:`Bearer ${n}`}}),ae=O.data?.attendance||O.data;ae&&ae._id?H(ae):(s(ee=>ee.filter(pe=>pe._id!==M)),I()),O.data?.stats?A(O.data.stats):K(),F(O.data?.message||"Attendance approved","success")}catch(O){console.error("Error approving attendance:",O),F(O.response?.data?.message||"Error approving attendance","error")}},W=async M=>{if(c)try{const O=await xe.patch(`/attendance/${c}/reject`,{remarks:M},{headers:{Authorization:`Bearer ${n}`}}),ae=O.data?.attendance||O.data;ae&&ae._id?H(ae):(s(ee=>ee.filter(pe=>pe._id!==c)),I()),O.data?.stats?A(O.data.stats):K(),F(O.data?.message||"Attendance rejected","success"),m(!1),x(""),u(null)}catch(O){console.error("Error rejecting attendance:",O),F(O.response?.data?.message||"Error rejecting attendance","error")}},ce=M=>{u(M),m(!0)},me=M=>{const{name:O,value:ae}=M.target;P(ee=>({...ee,[O]:ae}))},L=()=>{P({employee:"",date:"",status:""})},q=M=>{if(!M)return"-";try{return new Date(M).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"-"}},V=M=>{if(!M)return"-";try{return new Date(M).toLocaleDateString()}catch{return"-"}},B=M=>{const O={pending:"bg-yellow-100 text-yellow-800",accepted:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${O[M]||"bg-gray-100 text-gray-800"}`,children:M})},T=i.filter(M=>{const O=D.employee?`${M.employee?.profileRef?.firstName} ${M.employee?.profileRef?.lastName}`.toLowerCase().includes(D.employee.toLowerCase())||M.employee?.email?.toLowerCase().includes(D.employee.toLowerCase()):!0,ae=D.date?V(M.date)===V(D.date):!0,ee=D.status?M.status===D.status:!0;return O&&ae&&ee}),G=t.filter(M=>{const O=D.employee?`${M.employee?.profileRef?.firstName} ${M.employee?.profileRef?.lastName}`.toLowerCase().includes(D.employee.toLowerCase())||M.employee?.email?.toLowerCase().includes(D.employee.toLowerCase()):!0,ae=D.date?V(M.date)===V(D.date):!0;return O&&ae});return r.jsxs("div",{className:"min-h-[70vh] p-4 sm:p-6",children:[r.jsx("style",{children:`
        .primary-btn:hover { background: ${PP} !important }
        .primary-border-active { border-bottom-color: ${qa} !important; color: ${qa} !important }
      `}),r.jsx(Ji,{notifications:N}),r.jsxs("header",{className:"mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Attendance Management"}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage employee attendance approvals and records"})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 mb-6",children:[r.jsxs("div",{className:"bg-gradient-to-r from-blue-100 via-blue-100 to-blue-200 rounded-2xl p-6 shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-sm text-blue-700 font-semibold mb-2",children:"Total Employees"}),r.jsx("p",{className:"text-2xl font-bold text-blue-900",children:w.totalEmployees??0})]}),r.jsxs("div",{className:"bg-gradient-to-r from-green-100 via-green-100 to-green-200 rounded-2xl p-6 shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-sm text-green-700 font-semibold mb-2",children:"Present Today"}),r.jsx("p",{className:"text-2xl font-bold text-green-900",children:w.present??0})]}),r.jsxs("div",{className:"bg-gradient-to-r from-red-100 via-red-100 to-red-200 rounded-2xl p-6 shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-sm text-red-700 font-semibold mb-2",children:"Absent Today"}),r.jsx("p",{className:"text-2xl font-bold text-red-900",children:Math.max(0,w?.absent??0)})]}),r.jsxs("div",{className:"bg-gradient-to-r from-yellow-100 via-yellow-100 to-yellow-200 rounded-2xl p-6 shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-sm text-yellow-700 font-semibold mb-2",children:"Pending Approval"}),r.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:w.pending??0})]})]}),r.jsxs("div",{className:"bg-white shadow rounded-lg mb-6",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("nav",{className:"flex -mb-px overflow-auto",children:[r.jsxs("button",{onClick:()=>v("pending"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${y==="pending"?"primary-border-active":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,style:y==="pending"?{borderBottomColor:qa,color:qa}:{},children:["Pending Approvals",t.length>0&&r.jsx("span",{className:"ml-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:t.length})]}),r.jsx("button",{onClick:()=>v("all"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${y==="all"?"primary-border-active":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,style:y==="all"?{borderBottomColor:qa,color:qa}:{},children:"All Records"}),r.jsx("button",{onClick:()=>v("hr"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${y==="hr"?"primary-border-active":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,style:y==="hr"?{borderBottomColor:qa,color:qa}:{},children:"My Attendance"})]})}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Employee"}),r.jsx("input",{type:"text",name:"employee",value:D.employee,onChange:me,placeholder:"Name or email",className:"w-full p-2 border border-gray-300 rounded-md"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),r.jsx("input",{type:"date",name:"date",value:D.date,onChange:me,className:"w-full p-2 border border-gray-300 rounded-md"})]}),y==="all"&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),r.jsxs("select",{name:"status",value:D.status,onChange:me,className:"w-full p-2 border border-gray-300 rounded-md",children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"accepted",children:"Accepted"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsx("div",{className:"flex items-end",children:r.jsx("button",{onClick:L,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Clear Filters"})})]}),y==="pending"&&r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Pending Attendance Approvals"}),r.jsx("button",{onClick:U,className:"p-2 text-gray-500 hover:text-gray-700",title:"Refresh",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),_?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),r.jsx("p",{className:"text-gray-500 mt-2",children:"Loading pending requests..."})]}):G.length===0?r.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[r.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{className:"text-gray-500",children:"No pending approvals"})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsx("div",{className:"max-h-[290px] overflow-y-auto border border-gray-200 rounded-xl shadow-sm",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Employee"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Login Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Task Description"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Work Progress"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Actions"})]})}),r.jsxs("tbody",{className:"divide-y divide-gray-200",children:[G.map((M,O)=>r.jsxs("tr",{className:`${O%2===0?"bg-white":"bg-gray-50"} hover:bg-gray-100 transition`,children:[r.jsxs("td",{className:"px-6 py-4",children:[r.jsxs("div",{className:"font-medium text-gray-800",children:[M.employee?.profileRef?.firstName," ",M.employee?.profileRef?.lastName]}),r.jsx("div",{className:"text-sm text-gray-500",children:M.employee?.email}),r.jsx("div",{className:"text-xs text-gray-400",children:M.employee?.profileRef?.employeeId})]}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:V(M.date)}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:M.checkIn?q(M.checkIn):"-"}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"font-medium text-gray-800 mb-1",children:"Task:"}),r.jsx("div",{className:"max-w-xs truncate cursor-pointer",children:M.taskDescription||"-"}),M.taskDescription&&r.jsx("div",{className:"absolute hidden group-hover:block bg-gray-800 text-white text-xs rounded-md px-3 py-2 w-60 z-20 -top-1 left-1/2 -translate-x-1/2 shadow-lg",children:M.taskDescription})]}),M.earlyLoginReason&&r.jsxs("div",{className:"relative group mt-2 pt-2 border-t border-gray-100",children:[r.jsx("div",{className:"font-medium text-orange-600 mb-1",children:"Early Login Reason:"}),r.jsx("div",{className:"max-w-xs truncate cursor-pointer",children:M.earlyLoginReason}),r.jsx("div",{className:"absolute hidden group-hover:block bg-gray-800 text-white text-xs rounded-md px-3 py-2 w-60 z-20 -top-1 left-1/2 -translate-x-1/2 shadow-lg",children:M.earlyLoginReason})]}),M.lateLoginReason&&r.jsxs("div",{className:"relative group mt-2 pt-2 border-t border-gray-100",children:[r.jsx("div",{className:"font-medium text-red-600 mb-1",children:"Late Login Reason:"}),r.jsx("div",{className:"max-w-xs truncate cursor-pointer",children:M.lateLoginReason}),r.jsx("div",{className:"absolute hidden group-hover:block bg-gray-800 text-white text-xs rounded-md px-3 py-2 w-60 z-20 -top-1 left-1/2 -translate-x-1/2 shadow-lg",children:M.lateLoginReason})]})]})}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:M.workProgress||"-"}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx("button",{onClick:()=>X(M._id),className:"px-3 py-1.5 rounded-md text-white bg-[#104774] hover:bg-[#0d3a61] text-sm font-medium shadow-sm transition",children:"Approve"}),r.jsx("button",{onClick:()=>ce(M._id),className:"px-3 py-1.5 rounded-md text-white bg-red-600 hover:bg-red-700 text-sm font-medium shadow-sm transition",children:"Reject"})]})})]},M._id)),G.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-6 py-10 text-center text-sm text-gray-500",children:"No pending attendances found"})})]})]})})})]}),y==="all"&&r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"All Attendance Records"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-sm text-gray-500",children:["Showing ",T.length," of"," ",i.length," records"]}),r.jsx("button",{onClick:I,className:"p-2 text-gray-500 hover:text-gray-700",title:"Refresh",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]}),_?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),r.jsx("p",{className:"text-gray-500 mt-2",children:"Loading records..."})]}):T.length===0?r.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[r.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{className:"text-gray-500",children:"No records found"})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsx("div",{className:"max-h-[250px] overflow-y-auto border border-gray-200 rounded-xl shadow-sm",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10 rounded-t-lg",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Employee"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Login Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Logout Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Work Progress"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Task"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Logout Note"})]})}),r.jsx("tbody",{children:T.map((M,O)=>r.jsxs("tr",{className:`${O%2===0?"bg-white":"bg-gray-100"} transition`,children:[r.jsxs("td",{className:"px-6 py-3 whitespace-nowrap",children:[r.jsxs("div",{className:"font-medium text-gray-800",children:[M.employee?.profileRef?.firstName," ",M.employee?.profileRef?.lastName]}),r.jsx("div",{className:"text-sm text-gray-500",children:M.employee?.email}),r.jsx("div",{className:"text-xs text-gray-400 mt-1",children:M.employee?.profileRef?.employeeId})]}),r.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm text-gray-700",children:V(M.date)}),r.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm text-gray-700",children:q(M.checkIn)}),r.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm text-gray-700",children:q(M.checkOut)||"-"}),r.jsx("td",{className:"px-6 py-3 whitespace-nowrap",children:B(M.status)}),r.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm text-gray-700",children:M.workProgress||"-"}),r.jsx("td",{className:"px-6 py-3 text-sm text-gray-700 max-w-xs",children:r.jsxs("div",{className:"space-y-1",children:[M.taskDescription?r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"truncate cursor-pointer font-medium hover:text-blue-600",children:M.taskDescription}),r.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-64 bg-gray-900 text-white text-xs rounded-lg p-2 shadow-lg z-50 invisible opacity-0 group-hover:visible group-hover:opacity-100 transition-all duration-200 break-words",children:[M.taskDescription,r.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -mt-1 w-2 h-2 bg-gray-900 rotate-45"})]})]}):r.jsx("span",{className:"text-gray-400 italic",children:"-"}),M.earlyLoginReason&&r.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Early Login:"})," ",M.earlyLoginReason]}),M.lateLoginReason&&r.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Late Login:"})," ",M.lateLoginReason]})]})}),r.jsx("td",{className:"px-6 py-3 text-sm",children:M.logoutDescription?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"font-medium",children:M.logoutDescription}),M.earlyLogoutReason&&r.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Early Logout:"})," ",M.earlyLogoutReason]})]}):"-"})]},M._id))})]})})})]}),y==="hr"&&r.jsx(OP,{token:n,addNotification:F,user:e})]})]}),r.jsx(PN,{isOpen:h,onClose:()=>{m(!1),x(""),u(null)},onReject:W,remarks:p,setRemarks:x})]})},BP=({token:n,addNotification:e})=>{const[t,s]=E.useState([]),[i,l]=E.useState(!1),[c,u]=E.useState({month:new Date().getMonth()+1,year:new Date().getFullYear(),department:""}),[h,m]=E.useState([]);E.useEffect(()=>{p(),x()},[c]);const p=async()=>{try{const A=await xe.get("/attendance/departments",{headers:{Authorization:`Bearer ${n}`}});m(A.data||[])}catch(A){console.error("Error fetching departments:",A),m(["HR","IT","Finance","Operations","Sales","Marketing"])}},x=async()=>{l(!0);try{const A=new URLSearchParams;c.month&&A.append("month",c.month),c.year&&A.append("year",c.year),c.department&&A.append("department",c.department);const N=await xe.get(`/attendance/reports/monthly?${A}`,{headers:{Authorization:`Bearer ${n}`}});s(N.data||[])}catch(A){console.error("Error generating reports:",A),e(A.response?.data?.message||"Error generating reports","error"),s([])}finally{l(!1)}},y=A=>{const{name:N,value:j}=A.target;u(_=>({..._,[N]:j}))},v=new Date().getFullYear(),w=Array.from({length:5},(A,N)=>v-N);return r.jsxs("div",{className:"",children:[r.jsx("div",{className:"flex flex-col mb-4 md:mb-6 gap-3",children:r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg sm:text-xl  font-bold text-gray-800",children:"Monthly Attendance Reports"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:"Track and analyze employee attendance patterns"})]})}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-3 md:p-4 mb-4 md:mb-6",children:[r.jsx("h3",{className:"text-sm md:text-base font-semibold text-gray-800 mb-3",children:"Filter Reports"}),r.jsx("div",{className:"grid grid-cols-1 gap-3",children:r.jsxs("div",{className:"space-y-3 md:space-y-0 md:grid md:grid-cols-4 md:gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-700 mb-1",children:"Month"}),r.jsxs("select",{name:"month",value:c.month,onChange:y,className:"w-full p-2 text-xs border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"All Months"}),Array.from({length:12},(A,N)=>r.jsx("option",{value:N+1,children:new Date(2023,N).toLocaleString("default",{month:"long"})},N+1))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-700 mb-1",children:"Year"}),r.jsxs("select",{name:"year",value:c.year,onChange:y,className:"w-full p-2 text-xs border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"All Years"}),w.map(A=>r.jsx("option",{value:A,children:A},A))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-700 mb-1",children:"Department"}),r.jsxs("select",{name:"department",value:c.department,onChange:y,className:"w-full p-2 text-xs border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"All Departments"}),h.map(A=>r.jsx("option",{value:A,children:A},A))]})]}),r.jsx("div",{className:"flex items-end pt-1",children:r.jsx("button",{onClick:x,className:"w-full px-3 py-2 text-white font-medium text-xs rounded-md transition-all duration-200 shadow-sm",style:{backgroundColor:"#104774"},children:i?r.jsxs("span",{className:"flex items-center justify-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Refreshing..."]}):r.jsxs("span",{className:"flex items-center justify-center gap-1",children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Report"]})})})]})})]}),i?r.jsxs("div",{className:"text-center py-6 bg-white rounded-lg shadow-sm border border-slate-200",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-2"}),r.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Generating reports..."}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Please wait while we process your data"})]}):t.length===0?r.jsxs("div",{className:"text-center py-8 bg-white rounded-lg shadow-sm border border-slate-200",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-2",children:r.jsx("svg",{className:"w-6 h-6 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-1",children:"No report data available"}),r.jsx("p",{className:"text-xs text-gray-500 max-w-md mx-auto px-2",children:"Try adjusting your filters or select a different date range to generate attendance reports."})]}):r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[r.jsx("div",{className:"block lg:hidden space-y-3 p-3",children:t.map((A,N)=>r.jsxs("div",{className:"border border-slate-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-shadow",children:[r.jsx("div",{className:"flex items-start justify-between mb-2",children:r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"font-semibold text-gray-900 text-xs truncate",children:A.employeeName||"N/A"}),r.jsx("p",{className:"text-xs text-gray-500 truncate",children:A.employeeEmail||"N/A"}),r.jsxs("div",{className:"flex items-center gap-1 mt-1 flex-wrap",children:[r.jsxs("span",{className:"text-xs text-gray-500",children:["ID: ",A.employeeId||"N/A"]}),r.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs",children:A.department||"N/A"})]})]})}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[r.jsxs("div",{className:"text-center p-1.5 bg-green-50 rounded",children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Present"}),r.jsx("p",{className:"font-semibold text-green-600 text-xs",children:A.present||0})]}),r.jsxs("div",{className:"text-center p-1.5 bg-red-50 rounded",children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Absent"}),r.jsx("p",{className:"font-semibold text-red-600 text-xs",children:A.absent||0})]}),r.jsxs("div",{className:"text-center p-1.5 bg-yellow-50 rounded",children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Pending"}),r.jsx("p",{className:"font-semibold text-yellow-600 text-xs",children:A.pending||0})]}),r.jsxs("div",{className:"text-center p-1.5 bg-red-50 rounded",children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Rejected"}),r.jsx("p",{className:"font-semibold text-red-600 text-xs",children:A.rejected||0})]})]}),r.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-slate-100",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Total Days"}),r.jsx("p",{className:"font-semibold text-gray-800 text-xs",children:A.totalDays||0})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Attendance"}),r.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${(A.attendancePercentage||0)>=90?"bg-green-100 text-green-800":(A.attendancePercentage||0)>=75?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[A.attendancePercentage?Math.round(A.attendancePercentage):0,"%"]})]})]})]},N))}),r.jsx("div",{className:"hidden lg:block overflow-x-auto",children:r.jsx("div",{className:"max-h-[180px] overflow-y-auto",children:r.jsxs("table",{className:"w-full border-collapse min-w-[800px]",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Employee"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Employee ID"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Department"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Present"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Absent"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Pending"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Rejected"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Total Days"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Attendance %"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-200",children:t.map((A,N)=>r.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[r.jsxs("td",{className:"px-3 py-2",children:[r.jsx("div",{className:"font-medium text-gray-900 text-xs",children:A.employeeName||"N/A"}),r.jsx("div",{className:"text-xs text-gray-500",children:A.employeeEmail||"N/A"})]}),r.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:A.employeeId||"N/A"}),r.jsx("td",{className:"px-3 py-2",children:r.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:A.department||"N/A"})}),r.jsx("td",{className:"px-3 py-2 text-green-600 font-semibold text-xs",children:A.present||0}),r.jsx("td",{className:"px-3 py-2 text-red-600 font-semibold text-xs",children:A.absent||0}),r.jsx("td",{className:"px-3 py-2 text-yellow-600 font-semibold text-xs",children:A.pending||0}),r.jsx("td",{className:"px-3 py-2 text-red-600 font-semibold text-xs",children:A.rejected||0}),r.jsx("td",{className:"px-3 py-2 font-semibold text-gray-700 text-xs",children:A.totalDays||0}),r.jsx("td",{className:"px-3 py-2",children:r.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${(A.attendancePercentage||0)>=90?"bg-green-100 text-green-800":(A.attendancePercentage||0)>=75?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[A.attendancePercentage?Math.round(A.attendancePercentage):0,"%"]})})]},N))})]})})}),r.jsx("div",{className:"border-t border-slate-200 px-3 py-2 bg-slate-50",children:r.jsxs("p",{className:"text-xs text-gray-600",children:["Showing ",r.jsx("span",{className:"font-semibold",children:t.length})," employee records"]})})]})]})},Ei="#104774",HP="#0d3a61",zP=()=>{const{token:n}=rs(),[e,t]=E.useState([]),[s,i]=E.useState([]),[l,c]=E.useState(!0),u=new Date().toISOString().split("T")[0],[h,m]=E.useState({employee:"",date:u,status:"pending",department:"",role:""}),[p,x]=E.useState({totalEmployees:0,present:0,absent:0,pending:0}),[y,v]=E.useState([]),[w,A]=E.useState(null),[N,j]=E.useState(!1),[_,C]=E.useState(""),[k,D]=E.useState("records"),[P,F]=E.useState([]);E.useEffect(()=>{n&&(I(),K(),H())},[n]),E.useEffect(()=>{X()},[h,e]);const U=(B,T="info",G=3500)=>{const M=Date.now()+Math.random();v(O=>[...O,{id:M,message:B,type:T}]),setTimeout(()=>v(O=>O.filter(ae=>ae.id!==M)),G)},I=async()=>{c(!0);try{const B=await xe.get("/attendance/all",{headers:{Authorization:`Bearer ${n}`}});t(B.data||[])}catch(B){console.error("Error fetching all attendances:",B),U(B.response?.data?.message||"Could not fetch attendance records","error"),t([])}finally{c(!1)}},K=async()=>{try{const B=await xe.get("/attendance/stats",{headers:{Authorization:`Bearer ${n}`}});x(B.data||{})}catch(B){console.error("Error fetching stats:",B),U("Error loading statistics","error")}},H=async()=>{try{const B=await xe.get("/departments");B.data.success&&F(B.data.data)}catch(B){console.error("Error fetching departments:",B)}},X=()=>{let B=[...e];h.employee&&(B=B.filter(T=>`${T.employee?.profileRef?.firstName||""} ${T.employee?.profileRef?.lastName||""}`.trim().toLowerCase().includes(h.employee.toLowerCase())||(T.employee?.email||"").toLowerCase().includes(h.employee.toLowerCase()))),h.date&&(B=B.filter(T=>T.date?new Date(T.date).toLocaleDateString()===new Date(h.date).toLocaleDateString():!1)),h.status&&(B=B.filter(T=>T.status===h.status)),h.department&&(B=B.filter(T=>T.employee?.profileRef?.department===h.department)),h.role&&(B=B.filter(T=>T.employee?.role===h.role)),i(B)},W=B=>{const{name:T,value:G}=B.target;m(M=>({...M,[T]:G}))},ce=()=>{m({employee:"",date:"",status:"",department:"",role:""})},me=async B=>{if(w)try{const T=await xe.patch(`/attendance/${w}/admin-reject`,{remarks:B},{headers:{Authorization:`Bearer ${n}`}});T.data?.attendance?t(G=>G.map(M=>M._id===w?T.data.attendance:M)):I(),K(),U(T.data?.message||"Attendance rejected","success"),j(!1),C(""),A(null)}catch(T){console.error("Error rejecting attendance:",T),U(T.response?.data?.message||"Error rejecting attendance","error")}},L=B=>{if(!B)return"-";try{return new Date(B).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"-"}},q=B=>{if(!B)return"-";try{return new Date(B).toLocaleDateString()}catch{return"-"}},V=B=>{const T={pending:"bg-yellow-100 text-yellow-800",accepted:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${T[B]||"bg-gray-100 text-gray-800"}`,children:B})};return l&&e.length===0?r.jsx("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin inline-block w-8 h-8 border-4 rounded-full",style:{borderColor:Ei,borderLeftColor:"transparent"},role:"status"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Loading attendance records..."})]})}):r.jsxs("div",{className:"max-h-[80vh] bg-gray-50",children:[r.jsx("style",{children:`
      .primary-btn:hover { background: ${HP} !important }
      .primary-border-active { border-bottom-color: ${Ei} !important; color: ${Ei} !important }
    `}),r.jsx(Ji,{notifications:y}),r.jsxs("header",{className:"p-3 mb-4 md:mb-6",children:[r.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-800 text-center sm:text-left",children:"Admin Attendance Management"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1 text-center sm:text-left",children:"Manage all employee and HR attendance records"})]}),r.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4 mb-4 md:mb-6",children:[r.jsxs("div",{className:"bg-gradient-to-r from-blue-100 to-blue-200 rounded-lg p-3 md:p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-xs md:text-sm text-blue-700 font-semibold mb-1",children:"Total Employees"}),r.jsx("p",{className:"text-base md:text-lg font-bold text-blue-900",children:p.totalEmployees??0})]}),r.jsxs("div",{className:"bg-gradient-to-r from-green-100 to-green-200 rounded-lg p-3 md:p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-xs md:text-sm text-green-700 font-semibold mb-1",children:"Present Today"}),r.jsx("p",{className:"text-base md:text-lg font-bold text-green-900",children:p.present??0})]}),r.jsxs("div",{className:"bg-gradient-to-r from-red-100 to-red-200 rounded-lg p-3 md:p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-xs md:text-sm text-red-700 font-semibold mb-1",children:"Absent Today"}),r.jsx("p",{className:"text-base md:text-lg font-bold text-red-900",children:Math.max(0,p?.absent??0)})]}),r.jsxs("div",{className:"bg-gradient-to-r from-yellow-100 to-yellow-200 rounded-lg p-3 md:p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-xs md:text-sm text-yellow-700 font-semibold mb-1",children:"Pending Approval"}),r.jsx("p",{className:"text-base md:text-lg font-bold text-yellow-900",children:p.pending??0})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 mb-6",children:[r.jsx("div",{className:"border-b border-slate-200",children:r.jsxs("nav",{className:"flex overflow-x-auto",children:[r.jsx("button",{onClick:()=>D("records"),className:`py-2 md:py-3 px-3 md:px-4 text-center border-b-2 font-medium text-xs md:text-sm min-w-max ${k==="records"?"primary-border-active":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,style:k==="records"?{borderBottomColor:Ei,color:Ei}:{},children:"Attendance Records"}),r.jsx("button",{onClick:()=>D("reports"),className:`py-2 md:py-3 px-3 md:px-4 text-center border-b-2 font-medium text-xs md:text-sm min-w-max ${k==="reports"?"primary-border-active":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,style:k==="reports"?{borderBottomColor:Ei,color:Ei}:{},children:"Reports & Analytics"})]})}),r.jsxs("div",{className:"p-3 md:p-4",children:[k==="records"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 md:gap-4 mb-4 md:mb-6",children:[r.jsxs("div",{className:"sm:col-span-2 lg:col-span-1",children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-slate-700 mb-1",children:"Employee Name/Email"}),r.jsx("input",{type:"text",name:"employee",value:h.employee,onChange:W,className:"w-full p-2 text-xs border border-slate-300 rounded-md",placeholder:"Search employee..."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-slate-700 mb-1",children:"Date"}),r.jsx("input",{type:"date",name:"date",value:h.date,onChange:W,className:"w-full p-2 text-xs border border-slate-300 rounded-md"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-slate-700 mb-1",children:"Status"}),r.jsxs("select",{name:"status",value:h.status,onChange:W,className:"w-full p-2 text-xs border border-slate-300 rounded-md",children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"accepted",children:"Accepted"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsx("div",{className:"flex items-end gap-2",children:r.jsx("button",{onClick:ce,className:"px-3 py-2 text-xs bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 w-full",children:"Clear Filters"})})]}),r.jsxs("div",{className:"bg-white rounded-lg",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3 md:mb-4 gap-2",children:[r.jsx("h2",{className:"text-base sm:text-lg font-semibold text-center sm:text-left",children:"Attendance Records"}),r.jsx("div",{className:"flex gap-2 justify-center sm:justify-start",children:r.jsx("button",{onClick:I,className:"p-2 text-slate-500 hover:text-slate-700 border rounded-md",title:"Refresh",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})})]}),r.jsxs("div",{className:"block md:hidden space-y-3",children:[s.map((B,T)=>r.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200 shadow-sm hover:shadow-md transition-all duration-200",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("h3",{className:"text-sm font-semibold text-slate-900 truncate",children:[B.employee?.profileRef?.firstName," ",B.employee?.profileRef?.lastName]}),r.jsx("p",{className:"text-xs text-slate-500 truncate mt-0.5",children:B.employee?.email})]}),r.jsx("div",{className:"text-right ml-2 flex-shrink-0",children:r.jsx("span",{className:"inline-block py-1 bg-blue-50 text-blue-700 text-xs font-medium rounded-full whitespace-nowrap",children:q(B.date)})})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[r.jsxs("div",{className:"bg-slate-50 p-2 rounded",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[r.jsx("svg",{className:"w-3 h-3 text-green-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{className:"text-xs font-medium text-slate-500 truncate",children:"Login"})]}),r.jsx("p",{className:"text-xs font-semibold text-slate-800 truncate",children:L(B.checkIn)})]}),r.jsxs("div",{className:"bg-slate-50 p-2 rounded",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[r.jsx("svg",{className:"w-3 h-3 text-red-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{className:"text-xs font-medium text-slate-500 truncate",children:"Logout"})]}),r.jsx("p",{className:"text-xs font-semibold text-slate-800 truncate",children:L(B.checkOut)||"-"})]})]}),r.jsxs("div",{className:"mb-2",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 mb-1",children:"Status"}),r.jsx("div",{className:"transform scale-90 origin-left",children:V(B.status)})]}),r.jsxs("div",{className:"space-y-2 mb-2",children:[r.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-slate-100",children:[r.jsx("span",{className:"text-xs font-medium text-slate-500 truncate",children:"Work Progress"}),r.jsx("span",{className:"text-xs text-slate-800 font-medium truncate ml-1",children:B.workProgress||"-"})]}),r.jsxs("div",{className:"py-1 border-b border-slate-100",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 mb-0.5",children:"Task"}),r.jsx("p",{className:"text-xs text-slate-800 line-clamp-2 break-words",children:B.taskDescription||"No task description"})]}),r.jsxs("div",{className:"py-1",children:[r.jsx("p",{className:"text-xs font-medium text-slate-500 mb-0.5",children:"Logout Note"}),r.jsx("p",{className:"text-xs text-slate-800 line-clamp-2 break-words",children:B.logoutDescription||"No logout note"})]})]}),(B.earlyLoginReason||B.lateLoginReason||B.earlyLogoutReason)&&r.jsxs("div",{className:"bg-amber-50 border border-amber-200 p-2 rounded mb-1",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-1.5",children:[r.jsx("svg",{className:"w-3 h-3 text-amber-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),r.jsx("p",{className:"text-xs font-semibold text-amber-800 truncate",children:"Attendance Notes"})]}),r.jsxs("div",{className:"space-y-1",children:[B.earlyLoginReason&&r.jsxs("div",{className:"flex items-start gap-1.5",children:[r.jsx("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-[10px] font-medium bg-amber-100 text-amber-800 mt-0.5 flex-shrink-0",children:"Early"}),r.jsx("p",{className:"text-[10px] text-amber-700 flex-1 break-words",children:B.earlyLoginReason})]}),B.lateLoginReason&&r.jsxs("div",{className:"flex items-start gap-1.5",children:[r.jsx("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-[10px] font-medium bg-amber-100 text-amber-800 mt-0.5 flex-shrink-0",children:"Late"}),r.jsx("p",{className:"text-[10px] text-amber-700 flex-1 break-words",children:B.lateLoginReason})]}),B.earlyLogoutReason&&r.jsxs("div",{className:"flex items-start gap-1.5",children:[r.jsx("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-[10px] font-medium bg-amber-100 text-amber-800 mt-0.5 flex-shrink-0",children:"Early Out"}),r.jsx("p",{className:"text-[10px] text-amber-700 flex-1 break-words",children:B.earlyLogoutReason})]})]})]})]},B._id)),s.length===0&&r.jsx("div",{className:"text-center p-4 bg-gradient-to-br from-slate-50 to-blue-50 rounded-lg border border-slate-200 shadow-sm",children:r.jsxs("div",{className:"flex flex-col items-center justify-center",children:[r.jsx("svg",{className:"w-10 h-10 text-slate-300 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-1",children:"No attendance records found"}),r.jsx("p",{className:"text-xs text-slate-500 px-2",children:"Try adjusting your filters or date range"})]})})]}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsx("div",{className:"max-h-[280px] overflow-y-auto border border-slate-200 rounded-lg shadow-sm",children:r.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Employee"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Date"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Login Time"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Logout Time"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Status"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Work Progress"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Task"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold uppercase",children:"Logout Note"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-200",children:s.map((B,T)=>r.jsxs("tr",{className:`${T%2===0?"bg-white":"bg-slate-50"} transition`,children:[r.jsxs("td",{className:"px-3 py-2 whitespace-nowrap",children:[r.jsxs("div",{className:"font-medium text-slate-800 text-xs",children:[B.employee?.profileRef?.firstName," ",B.employee?.profileRef?.lastName]}),r.jsx("div",{className:"text-xs text-slate-500",children:B.employee?.email}),r.jsx("div",{className:"text-xs text-slate-400 mt-1",children:B.employee?.profileRef?.employeeId})]}),r.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-slate-700",children:q(B.date)}),r.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-slate-700",children:L(B.checkIn)}),r.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-slate-700",children:L(B.checkOut)||"-"}),r.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:V(B.status)}),r.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-slate-700 max-w-[120px] truncate",children:B.workProgress||"-"}),r.jsx("td",{className:"px-3 py-2 text-xs text-slate-700 max-w-[150px]",children:r.jsxs("div",{className:"space-y-1",children:[B.taskDescription?r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"truncate cursor-pointer font-medium hover:text-blue-600",children:B.taskDescription}),r.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-64 bg-slate-900 text-white text-xs rounded-lg p-2 shadow-lg z-50 invisible opacity-0 group-hover:visible group-hover:opacity-100 transition-all duration-200 break-words",children:[B.taskDescription,r.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -mt-1 w-2 h-2 bg-slate-900 rotate-45"})]})]}):r.jsx("span",{className:"text-slate-400 italic",children:"-"}),B.earlyLoginReason&&r.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Early Login:"})," ",B.earlyLoginReason]}),B.lateLoginReason&&r.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Late Login:"})," ",B.lateLoginReason]})]})}),r.jsx("td",{className:"px-3 py-2 text-xs max-w-[120px]",children:B.logoutDescription?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"font-medium truncate",children:B.logoutDescription}),B.earlyLogoutReason&&r.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Early Logout:"})," ",B.earlyLogoutReason]})]}):"-"})]},B._id))})]})})})]})]}),k==="reports"&&r.jsx(BP,{token:n,addNotification:U,attendanceRecords:e})]})]}),r.jsx(PN,{isOpen:N,onClose:()=>{j(!1),C(""),A(null)},onReject:me,remarks:_,setRemarks:C})]})},gw="#104774",FP="#0d3a61",UP=()=>{const{token:n,user:e}=rs(),[t,s]=E.useState([]),[i,l]=E.useState(!0),[c,u]=E.useState(new Date().getFullYear()),[h,m]=E.useState(new Date().getMonth()+1),[p,x]=E.useState([]),[y,v]=E.useState(null),[w,A]=E.useState(!1);E.useEffect(()=>{j()},[c,h]);const N=(I,K="info",H=3500)=>{const X=Date.now()+Math.random();x(W=>[...W,{id:X,message:I,type:K}]),setTimeout(()=>x(W=>W.filter(ce=>ce.id!==X)),H)},j=async()=>{try{l(!0);const I=await xe.get(`/payroll/employee/my-payrolls?year=${c}&month=${h}`,{headers:{Authorization:`Bearer ${n}`}});s(I.data.data||[])}catch(I){console.error("Error fetching payrolls:",I),N(I.response?.data?.message||"Could not fetch payroll records","error"),s([])}finally{l(!1)}},_=async I=>{try{const K=await xe.get(`/payroll/payslip/${I}`,{headers:{Authorization:`Bearer ${n}`},responseType:"blob"}),H=new Blob([K.data],{type:"application/pdf"}),X=window.URL.createObjectURL(H),W=document.createElement("a");W.href=X,W.download=`payslip-${I}.pdf`,document.body.appendChild(W),W.click(),document.body.removeChild(W),window.URL.revokeObjectURL(X),N("Payslip downloaded successfully","success")}catch(K){console.error("Error downloading payslip:",K),K.response?.status===404?K.response?.data?.message==="Payslip not generated yet"?N("Payslip not ready yet. Please try again later.","error"):N("Payslip file missing. Contact HR.","error"):N(K.response?.data?.message||"Error downloading payslip","error")}},C=I=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(I),k=I=>new Date(I).toLocaleDateString("en-IN",{day:"numeric",month:"long",year:"numeric"}),D=I=>{const K={draft:"bg-gray-100 text-gray-800",pending_approval:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${K[I]||"bg-gray-100 text-gray-800"}`,children:I.replace("_"," ").toUpperCase()})},P=["January","February","March","April","May","June","July","August","September","October","November","December"],F=new Date().getFullYear(),U=Array.from({length:5},(I,K)=>F-K);return i?r.jsx("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin inline-block w-8 h-8 border-4 rounded-full",style:{borderColor:gw,borderLeftColor:"transparent"},role:"status"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Loading payroll records..."})]})}):r.jsxs("div",{className:"min-h-[80vh] p-4",children:[r.jsx("style",{children:`
        .primary-btn:hover { background: ${FP} !important }
      `}),r.jsx(Ji,{notifications:p}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"My Payroll & Payslips"}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and download your salary slips"})]}),r.jsxs("div",{className:"mt-4 md:mt-0 flex items-center gap-4 bg-white shadow rounded-lg p-3",children:[r.jsxs("div",{className:"w-28",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Year"}),r.jsx("select",{value:c,onChange:I=>u(parseInt(I.target.value)),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:U.map(I=>r.jsx("option",{value:I,children:I},I))})]}),r.jsxs("div",{className:"w-32",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Month"}),r.jsxs("select",{value:h,onChange:I=>m(parseInt(I.target.value)),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[r.jsx("option",{value:"",children:"All"}),P.map((I,K)=>r.jsx("option",{value:K+1,children:I},K+1))]})]})]})]}),r.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:t.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{className:"text-gray-500",children:"No payroll records found"}),r.jsx("p",{className:"text-sm text-gray-400 mt-1",children:h?"Try selecting a different month or year":"No records available for your account"})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full border-collapse",children:[r.jsx("thead",{className:"bg-[#104774] ",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-white",children:"Month"}),r.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-white",children:"Generated On"}),r.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-white",children:"Net Salary"}),r.jsx("th",{className:"px-6 py-3 text-center text-sm font-semibold text-white",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-center text-sm font-semibold text-white",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:t.sort((I,K)=>{const H=new Date(`${I.year}-${I.month}-01`);return new Date(`${K.year}-${K.month}-01`)-H}).map(I=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsxs("td",{className:"px-6 py-4 text-sm text-gray-800 font-medium",children:[P[parseInt(I.month.split("-")[1])-1]," ",I.year]}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:k(I.approvedAt)}),r.jsx("td",{className:"px-6 py-4 text-right text-sm font-semibold text-green-600",children:C(I.netPay)}),r.jsx("td",{className:"px-6 py-4 text-center",children:D(I.status)}),r.jsxs("td",{className:"px-6 py-4 text-center space-x-2",children:[r.jsx("button",{onClick:()=>{v(I),A(!0)},className:"px-3 py-1 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 text-sm",children:"View"}),I.status==="approved"&&r.jsx("button",{onClick:()=>_(I._id),className:"px-3 py-1 rounded-md text-white text-sm primary-btn",style:{backgroundColor:gw},children:"Download"}),I.status==="rejected"&&I.rejectionReason&&r.jsxs("p",{className:"mt-2 text-xs text-red-600",children:["Reason: ",I.rejectionReason]})]})]},I._id))})]})})}),w&&y&&r.jsx($P,{payroll:y,onClose:()=>A(!1),formatCurrency:C})]})},$P=({payroll:n,onClose:e,formatCurrency:t})=>r.jsx("div",{className:"fixed inset-0 backdrop-blur-xs bg-opacity-40 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-gray-200 shadow-2xl",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Salary Details - ",n.month]}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-green-700 mb-4",children:"Earnings"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Basic Salary:"}),r.jsx("span",{className:"font-semibold",children:t(n.basic)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"House Rent Allowance (HRA):"}),r.jsx("span",{className:"font-semibold",children:t(n.hra)})]}),n.allowances&&n.allowances.map((s,i)=>r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{children:[s.title,":"]}),r.jsx("span",{className:"font-semibold",children:t(s.amount)})]},i)),r.jsx("div",{className:"border-t pt-2 mt-2",children:r.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[r.jsx("span",{children:"Total Earnings:"}),r.jsx("span",{className:"text-green-600",children:t(n.totalEarnings)})]})})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-red-700 mb-4",children:"Deductions"}),r.jsxs("div",{className:"space-y-3",children:[n.absentDeduction>0&&r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{children:["Absent Days Deduction (",n.absentDays," days):"]}),r.jsxs("span",{className:"font-semibold text-red-600",children:["-",t(n.absentDeduction)]})]}),n.deductions&&n.deductions.map((s,i)=>r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{children:[s.title,":"]}),r.jsxs("span",{className:"font-semibold text-red-600",children:["-",t(s.amount)]})]},i)),n.tax>0&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Tax:"}),r.jsxs("span",{className:"font-semibold text-red-600",children:["-",t(n.tax)]})]}),r.jsx("div",{className:"border-t pt-2 mt-2",children:r.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[r.jsx("span",{children:"Total Deductions:"}),r.jsxs("span",{className:"text-red-600",children:["-",t(n.totalDeductions)]})]})})]})]})]}),r.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-blue-50 to-green-50 rounded-lg",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Net Salary"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:t(n.netPay)})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${n.status==="approved"?"bg-green-100 text-green-800":n.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:n.status.replace("_"," ").toUpperCase()})]})]})}),r.jsx("div",{className:"mt-6 flex justify-end",children:r.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Close"})})]})}),Ga="#104774",VP=({isOpen:n,onClose:e,onCreate:t,token:s,addNotification:i})=>{const[l,c]=E.useState(!1),[u,h]=E.useState([]),[m,p]=E.useState([]),[x,y]=E.useState([]),[v,w]=E.useState(""),[A,N]=E.useState(!1),[j,_]=E.useState({employeeId:"",month:new Date().getMonth()+1,year:new Date().getFullYear(),basic:0,hra:0,allowances:[],deductions:[],tax:0,taxPercentage:0}),[C,k]=E.useState({title:"",amount:0}),[D,P]=E.useState({title:"",amount:0}),[F,U]=E.useState(null),[I,K]=E.useState(null),[H,X]=E.useState(null);E.useEffect(()=>{n&&(W(),_(O=>({...O,month:new Date().getMonth()+1,year:new Date().getFullYear()})),U(null),K(null),X(null),w(""),p([]),y([]))},[n]),E.useEffect(()=>{v?ce(v):(p([]),y([]))},[v]),E.useEffect(()=>{x.length>0&&me()},[j.month,j.year,x]),E.useEffect(()=>{j.employeeId?(L(j.employeeId),q(j.employeeId,j.month,j.year)):(U(null),K(null),X(null))},[j.employeeId,j.month,j.year]),E.useEffect(()=>{if(j.taxPercentage>0&&j.basic>0){const O=Math.round(j.basic*j.taxPercentage/100);_(ae=>({...ae,tax:O}))}else j.taxPercentage===0&&_(O=>({...O,tax:0}))},[j.taxPercentage,j.basic]);const W=async()=>{try{const O=await xe.get("/departments",{headers:{Authorization:`Bearer ${s}`}});h(O.data.data||[])}catch(O){console.error(O),i("Failed to fetch departments","error")}},ce=async O=>{try{const ae=await xe.get(`/departments/${O}/employees`,{headers:{Authorization:`Bearer ${s}`}});y(ae.data.data||[])}catch(ae){console.error(ae),i("Failed to fetch employees","error")}},me=async()=>{N(!0);try{const ae=(await Promise.all(x.map(async ee=>{try{const pe=await xe.get(`/payroll/employee/${ee._id}/exists?month=${j.month}&year=${j.year}`,{headers:{Authorization:`Bearer ${s}`}});return{emp:ee,hasPayroll:!!pe.data.exists}}catch{return{emp:ee,hasPayroll:!1}}}))).filter(ee=>!ee.hasPayroll).map(ee=>ee.emp);p(ae),j.employeeId&&!ae.some(ee=>ee._id===j.employeeId)&&_(ee=>({...ee,employeeId:""}))}catch(O){console.error(O),p(x)}finally{N(!1)}},L=async O=>{try{const ee=(await xe.get(`/payroll/employee/${O}/latest`,{headers:{Authorization:`Bearer ${s}`}})).data?.data||null;if(K(ee),ee&&typeof ee.basic=="number")_(pe=>({...pe,basic:ee.basic,hra:ee.hra??pe.hra}));else try{const we=(await xe.get(`/profiles/${O}`,{headers:{Authorization:`Bearer ${s}`}})).data?.data?.basicSalary??prev.basic;_(Te=>({...Te,basic:we}))}catch{}}catch(ae){console.error("Error fetching latest payroll:",ae)}},q=async(O,ae,ee)=>{try{const pe=await xe.get(`/payroll/preview?employeeId=${O}&month=${ae}&year=${ee}&basic=${j.basic||0}&hra=${j.hra||0}&allowances=${JSON.stringify(j.allowances)}&deductions=${JSON.stringify(j.deductions)}&taxPercentage=${j.taxPercentage||0}`,{headers:{Authorization:`Bearer ${s}`}});X(pe.data)}catch(pe){console.error("Error fetching payroll preview:",pe),X(null),B()}},V=O=>Array.isArray(O)?O.reduce((ae,ee)=>ae+(Number(ee.amount)||0),0):0,B=()=>{if(!j.employeeId){i("Select employee to preview","error");return}const O=Number(j.basic||0),ae=Number(j.hra||0),ee=V(j.allowances),pe=V(j.deductions),we=Number(j.tax||0),Te=O/31;let ue=0,He=0,ze=0,at=0;if(H)ue=H.absent||0,He=H.workingDays||0,ze=H.approvedLeaves||0,at=H.absentDeduction||0;else if(F){const Ee=Number(F.present||0),Xe=Number(F.leave||0),te=Number(F.holidays||0),Ne=Number(F.sundays||0);He=Number(F.totalWorkingDays||31-(te+Ne)),ue=Number(F.absent??He-(Ee+Xe)),ue<0&&(ue=0),at=Math.round(Te*ue),ze=Xe}const At=Math.round(O+ae+ee),le=Math.round(pe+we+at),be=Math.round(At-le),ye={basic:O,hra:ae,allowancesSum:ee,deductionsSum:pe,tax:we,dailyRate:+Te.toFixed(2),workingDays:He,presentDays:He-ue-ze,leaveDays:ze,absent:ue,absentDeduction:at,totalEarnings:At,totalDeductions:le,netPay:be};return X(ye),ye};if(!n)return null;const T=V(j.allowances),G=V(j.deductions)+Number(j.tax||0),M=Math.round(Number(j.basic||0)+Number(j.hra||0)+T);return H?H.netPay:Math.round(M-G),new Date().getFullYear(),r.jsxs("div",{className:"min-h-[70vh] p-4 sm:p-6 bg-gray-50",children:[r.jsx("style",{children:`
      .primary-btn:hover { background: ${PRIMARY_HOVER} !important }
      .primary-border-active { border-bottom-color: ${Ga} !important; color: ${Ga} !important }
    `}),r.jsx(NotificationToast,{notifications}),r.jsxs("header",{className:"mb-6",children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"Attendance Management"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:"Manage employee attendance approvals and records"})]}),r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 md:gap-6 mb-6",children:[r.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-blue-200",children:[r.jsx("h3",{className:"text-xs sm:text-sm text-blue-700 font-medium mb-1 sm:mb-2 truncate",children:"Total Employees"}),r.jsx("p",{className:"text-lg sm:text-xl md:text-2xl font-bold text-blue-900",children:stats.totalEmployees??0})]}),r.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-green-200",children:[r.jsx("h3",{className:"text-xs sm:text-sm text-green-700 font-medium mb-1 sm:mb-2 truncate",children:"Present Today"}),r.jsx("p",{className:"text-lg sm:text-xl md:text-2xl font-bold text-green-900",children:stats.present??0})]}),r.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-red-100 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-red-200",children:[r.jsx("h3",{className:"text-xs sm:text-sm text-red-700 font-medium mb-1 sm:mb-2 truncate",children:"Absent Today"}),r.jsx("p",{className:"text-lg sm:text-xl md:text-2xl font-bold text-red-900",children:Math.max(0,stats?.absent??0)})]}),r.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-yellow-100 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-yellow-200",children:[r.jsx("h3",{className:"text-xs sm:text-sm text-yellow-700 font-medium mb-1 sm:mb-2 truncate",children:"Pending Approval"}),r.jsx("p",{className:"text-lg sm:text-xl md:text-2xl font-bold text-yellow-900",children:stats.pending??0})]})]}),r.jsxs("div",{className:"bg-white shadow-sm rounded-lg sm:rounded-xl border border-gray-200 mb-6",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("nav",{className:"flex overflow-x-auto scrollbar-hide",children:[r.jsxs("button",{onClick:()=>setActiveTab("pending"),className:`flex items-center py-3 px-4 text-center border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap min-w-max ${activeTab==="pending"?"primary-border-active":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,style:activeTab==="pending"?{borderBottomColor:Ga,color:Ga}:{},children:["Pending Approvals",pendingAttendances.length>0&&r.jsx("span",{className:"ml-2 bg-red-500 text-white text-xs px-1.5 py-0.5 rounded-full min-w-[20px]",children:pendingAttendances.length})]}),r.jsx("button",{onClick:()=>setActiveTab("all"),className:`py-3 px-4 text-center border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap min-w-max ${activeTab==="all"?"primary-border-active":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,style:activeTab==="all"?{borderBottomColor:Ga,color:Ga}:{},children:"All Records"}),r.jsx("button",{onClick:()=>setActiveTab("hr"),className:`py-3 px-4 text-center border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap min-w-max ${activeTab==="hr"?"primary-border-active":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,style:activeTab==="hr"?{borderBottomColor:Ga,color:Ga}:{},children:"My Attendance"})]})}),r.jsxs("div",{className:"p-4 sm:p-6",children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Search Employee"}),r.jsx("input",{type:"text",name:"employee",value:filters.employee,onChange:handleFilterChange,placeholder:"Name or email",className:"w-full p-2 text-xs sm:text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Date"}),r.jsx("input",{type:"date",name:"date",value:filters.date,onChange:handleFilterChange,className:"w-full p-2 text-xs sm:text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),activeTab==="all"&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Status"}),r.jsxs("select",{name:"status",value:filters.status,onChange:handleFilterChange,className:"w-full p-2 text-xs sm:text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"accepted",children:"Accepted"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsx("div",{className:"flex items-end",children:r.jsx("button",{onClick:clearFilters,className:"w-full px-3 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs sm:text-sm font-medium transition-colors",children:"Clear Filters"})})]}),activeTab==="pending"&&r.jsxs("div",{children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4",children:[r.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800",children:"Pending Attendance Approvals"}),r.jsxs("button",{onClick:fetchPendingAttendances,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs sm:text-sm transition-colors",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),l?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),r.jsx("p",{className:"text-gray-500 mt-2 text-sm",children:"Loading pending requests..."})]}):filteredPendingAttendances.length===0?r.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[r.jsx("svg",{className:"w-12 h-12 text-gray-300 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{className:"text-gray-500 text-sm",children:"No pending approvals"})]}):r.jsxs("div",{className:"overflow-hidden",children:[r.jsx("div",{className:"block lg:hidden space-y-3",children:filteredPendingAttendances.map(O=>r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Employee"}),r.jsxs("p",{className:"text-sm font-medium text-gray-800 truncate",children:[O.employee?.profileRef?.firstName," ",O.employee?.profileRef?.lastName]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Date"}),r.jsx("p",{className:"text-sm text-gray-700",children:formatDate(O.date)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Login Time"}),r.jsx("p",{className:"text-sm text-gray-700",children:O.checkIn?formatTime(O.checkIn):"-"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Status"}),r.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full",children:"Pending"})]})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Task Description"}),r.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:O.taskDescription||"-"})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Work Progress"}),r.jsx("p",{className:"text-sm text-gray-700",children:O.workProgress||"-"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>handleApprove(O._id),className:"flex-1 px-3 py-2 bg-green-600 text-white rounded text-xs font-medium hover:bg-green-700 transition-colors",children:"Approve"}),r.jsx("button",{onClick:()=>openRejectModal(O._id),className:"flex-1 px-3 py-2 bg-red-600 text-white rounded text-xs font-medium hover:bg-red-700 transition-colors",children:"Reject"})]})]},O._id))}),r.jsx("div",{className:"hidden lg:block overflow-x-auto border border-gray-200 rounded-lg",children:r.jsxs("table",{className:"w-full min-w-[800px]",children:[r.jsx("thead",{className:"bg-[#104774] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Employee"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Date"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Login Time"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Task Description"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Work Progress"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:filteredPendingAttendances.map((O,ae)=>r.jsxs("tr",{className:ae%2===0?"bg-white":"bg-gray-50",children:[r.jsxs("td",{className:"px-4 py-3",children:[r.jsxs("div",{className:"font-medium text-sm text-gray-800",children:[O.employee?.profileRef?.firstName," ",O.employee?.profileRef?.lastName]}),r.jsx("div",{className:"text-xs text-gray-500",children:O.employee?.email})]}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:formatDate(O.date)}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:O.checkIn?formatTime(O.checkIn):"-"}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 max-w-[200px]",children:r.jsx("div",{className:"truncate",title:O.taskDescription,children:O.taskDescription||"-"})}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:O.workProgress||"-"}),r.jsx("td",{className:"px-4 py-3",children:r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>handleApprove(O._id),className:"px-3 py-1.5 bg-green-600 text-white rounded text-xs font-medium hover:bg-green-700 transition-colors",children:"Approve"}),r.jsx("button",{onClick:()=>openRejectModal(O._id),className:"px-3 py-1.5 bg-red-600 text-white rounded text-xs font-medium hover:bg-red-700 transition-colors",children:"Reject"})]})})]},O._id))})]})})]})]}),activeTab==="all"&&r.jsxs("div",{children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4",children:[r.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-800",children:"All Attendance Records"}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("span",{className:"text-xs sm:text-sm text-gray-500",children:["Showing ",filteredAttendances.length," of ",allAttendances.length," records"]}),r.jsxs("button",{onClick:fetchAllAttendances,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 text-xs sm:text-sm transition-colors",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]})]}),l?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),r.jsx("p",{className:"text-gray-500 mt-2 text-sm",children:"Loading records..."})]}):filteredAttendances.length===0?r.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[r.jsx("svg",{className:"w-12 h-12 text-gray-300 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{className:"text-gray-500 text-sm",children:"No records found"})]}):r.jsxs("div",{className:"overflow-hidden",children:[r.jsx("div",{className:"block lg:hidden space-y-3",children:filteredAttendances.map(O=>r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Employee"}),r.jsxs("p",{className:"text-sm font-medium text-gray-800",children:[O.employee?.profileRef?.firstName," ",O.employee?.profileRef?.lastName]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Date"}),r.jsx("p",{className:"text-sm text-gray-700",children:formatDate(O.date)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Login"}),r.jsx("p",{className:"text-sm text-gray-700",children:formatTime(O.checkIn)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Logout"}),r.jsx("p",{className:"text-sm text-gray-700",children:formatTime(O.checkOut)||"-"})]})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Status"}),r.jsx("div",{className:"mt-1",children:getStatusBadge(O.status)})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Task"}),r.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:O.taskDescription||"-"})]})]},O._id))}),r.jsx("div",{className:"hidden lg:block overflow-x-auto border border-gray-200 rounded-lg",children:r.jsxs("table",{className:"w-full min-w-[1000px]",children:[r.jsx("thead",{className:"bg-[#104774] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Employee"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Date"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Login Time"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Logout Time"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Task"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:filteredAttendances.map((O,ae)=>r.jsxs("tr",{className:ae%2===0?"bg-white":"bg-gray-50",children:[r.jsxs("td",{className:"px-4 py-3",children:[r.jsxs("div",{className:"font-medium text-sm text-gray-800",children:[O.employee?.profileRef?.firstName," ",O.employee?.profileRef?.lastName]}),r.jsx("div",{className:"text-xs text-gray-500",children:O.employee?.email})]}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:formatDate(O.date)}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:formatTime(O.checkIn)}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:formatTime(O.checkOut)||"-"}),r.jsx("td",{className:"px-4 py-3",children:getStatusBadge(O.status)}),r.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 max-w-[200px]",children:r.jsx("div",{className:"truncate",title:O.taskDescription,children:O.taskDescription||"-"})})]},O._id))})]})})]})]}),activeTab==="hr"&&r.jsx(HRAttendanceTab,{token:s,addNotification:i,user})]})]}),r.jsx(RejectModal,{isOpen:showRejectModal,onClose:()=>{setShowRejectModal(!1),setRejectRemarks(""),setSelectedAttendance(null)},onReject:handleReject,remarks:rejectRemarks,setRemarks:setRejectRemarks})]})},IN=({isOpen:n,onClose:e,payroll:t,onUpdate:s,onApproveReject:i,actionLoading:l,formatCurrency:c,isHR:u=!1})=>{const[h,m]=E.useState(!1),[p,x]=E.useState({...t}),[y,v]=E.useState(""),[w,A]=E.useState("summary"),N=ce=>{const{name:me,value:L}=ce.target;x(q=>({...q,[me]:me==="basic"||me==="hra"||me==="tax"?Number(L):L}))},j=(ce,me,L)=>{const q=[...p.allowances||[]];q[ce][me]=me==="amount"?Number(L):L,x(V=>({...V,allowances:q}))},_=(ce,me,L)=>{const q=[...p.deductions||[]];q[ce][me]=me==="amount"?Number(L):L,x(V=>({...V,deductions:q}))},C=()=>{x(ce=>({...ce,allowances:[...ce.allowances||[],{title:"",amount:0}]}))},k=ce=>{x(me=>({...me,allowances:(me.allowances||[]).filter((L,q)=>q!==ce)}))},D=()=>{x(ce=>({...ce,deductions:[...ce.deductions||[],{title:"",amount:0}]}))},P=ce=>{x(me=>({...me,deductions:(me.deductions||[]).filter((L,q)=>q!==ce)}))},F=ce=>(ce||[]).reduce((me,L)=>me+(L.amount||0),0),U=F(p.allowances),I=F(p.deductions)+(p.tax||0),K=(p.basic||0)+(p.hra||0)+U,H=K-I,X=t.basic/(t.workingDays||22),W=t.absentDeduction/(t.absentDays||1);return n?r.jsx("div",{className:"fixed inset-0 backdrop-blur-xs bg-opacity-40 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-5xl max-h-[90vh] overflow-y-auto shadow-2xl",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Payroll Details - ",t.employeeProfile?.firstName," ",t.employeeProfile?.lastName]}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx("div",{className:"flex border-b border-gray-200 mb-6",children:r.jsx("button",{className:`py-2 px-4 font-medium ${w==="summary"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500"}`,onClick:()=>A("summary"),children:"Summary"})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Employee ID"}),r.jsx("p",{className:"font-semibold",children:t.employeeProfile?.employeeId})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Period"}),r.jsxs("p",{className:"font-semibold",children:[t.month," ",t.year]})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${t.status==="approved"?"bg-green-100 text-green-800":t.status==="rejected"?"bg-red-100 text-red-800":t.status==="pending_approval"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.status.replace("_"," ").toUpperCase()})]})]}),w==="summary"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-green-700 mb-4",children:"Earnings"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Basic Salary:"}),h?r.jsx("input",{type:"number",name:"basic",value:p.basic||0,onChange:N,className:"w-32 p-2 border border-gray-300 rounded-md"}):r.jsx("span",{className:"font-semibold",children:c(t.basic||0)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"House Rent Allowance (HRA):"}),h?r.jsx("input",{type:"number",name:"hra",value:p.hra||0,onChange:N,className:"w-32 p-2 border border-gray-300 rounded-md"}):r.jsx("span",{className:"font-semibold",children:c(t.hra||0)})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("span",{className:"font-semibold",children:"Allowances:"}),h&&r.jsx("button",{onClick:C,className:"px-2 py-1 bg-green-600 text-white rounded-md text-sm",children:"+ Add"})]}),r.jsx("div",{className:"space-y-2",children:(p.allowances||[]).map((ce,me)=>r.jsx("div",{className:"flex justify-between items-center",children:h?r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"text",value:ce.title||"",onChange:L=>j(me,"title",L.target.value),placeholder:"Allowance title",className:"flex-1 p-2 border border-gray-300 rounded-md mr-2"}),r.jsx("input",{type:"number",value:ce.amount||0,onChange:L=>j(me,"amount",L.target.value),className:"w-24 p-2 border border-gray-300 rounded-md mr-2"}),r.jsx("button",{onClick:()=>k(me),className:"text-red-600 hover:text-red-800",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):r.jsxs(r.Fragment,{children:[r.jsxs("span",{children:[ce.title||"Allowance",":"]}),r.jsx("span",{className:"font-semibold",children:c(ce.amount||0)})]})},me))})]}),r.jsx("div",{className:"border-t pt-2 mt-2",children:r.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[r.jsx("span",{children:"Total Earnings:"}),r.jsx("span",{className:"text-green-600",children:c(K)})]})})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-700 mb-4",children:"Deductions"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Tax:"}),h?r.jsx("input",{type:"number",name:"tax",value:p.tax||0,onChange:N,className:"w-32 p-2 border border-gray-300 rounded-md"}):r.jsxs("span",{className:"font-semibold text-red-600",children:["-",c(t.tax||0)]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("span",{className:"font-semibold",children:"Other Deductions:"}),h&&r.jsx("button",{onClick:D,className:"px-2 py-1 bg-green-600 text-white rounded-md text-sm",children:"+ Add"})]}),r.jsx("div",{className:"space-y-2",children:(p.deductions||[]).map((ce,me)=>r.jsx("div",{className:"flex justify-between items-center",children:h?r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"text",value:ce.title||"",onChange:L=>_(me,"title",L.target.value),placeholder:"Deduction title",className:"flex-1 p-2 border border-gray-300 rounded-md mr-2"}),r.jsx("input",{type:"number",value:ce.amount||0,onChange:L=>_(me,"amount",L.target.value),className:"w-24 p-2 border border-gray-300 rounded-md mr-2"}),r.jsx("button",{onClick:()=>P(me),className:"text-red-600 hover:text-red-800",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):r.jsxs(r.Fragment,{children:[r.jsxs("span",{children:[ce.title||"Deduction",":"]}),r.jsxs("span",{className:"font-semibold text-red-600",children:["-",c(ce.amount||0)]})]})},me))})]}),r.jsx("div",{className:"border-t pt-2 mt-2",children:r.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[r.jsx("span",{children:"Total Deductions:"}),r.jsxs("span",{className:"text-red-600",children:["-",c(I)]})]})})]})]}),r.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-4 rounded-lg mb-6",children:r.jsx("div",{className:"flex justify-between items-center",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Net Salary"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:c(H)})]})})})]}),w==="breakdown"&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Attendance Calculation"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Total Working Days"}),r.jsx("p",{className:"text-lg font-semibold",children:t.workingDays||22}),r.jsx("p",{className:"text-xs text-gray-500",children:"Total days excluding Sundays and holidays"})]}),r.jsxs("div",{className:"bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Present Days"}),r.jsx("p",{className:"text-lg font-semibold text-green-600",children:t.presentDays||0}),r.jsx("p",{className:"text-xs text-gray-500",children:"Days employee was marked present"})]}),r.jsxs("div",{className:"bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Leave Days"}),r.jsx("p",{className:"text-lg font-semibold text-blue-600",children:t.leaveDays||0}),r.jsx("p",{className:"text-xs text-gray-500",children:"Approved paid leaves"})]}),r.jsxs("div",{className:"bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Absent Days"}),r.jsx("p",{className:"text-lg font-semibold text-red-600",children:t.absentDays||0}),r.jsx("p",{className:"text-xs text-gray-500",children:"Days absent without approved leave"})]})]}),r.jsxs("div",{className:"mt-4 bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Daily Rate Calculation"}),r.jsxs("p",{className:"text-sm",children:["₹",t.basic?.toLocaleString()," ÷ ",t.workingDays||22," days = ₹",X.toFixed(2)," per day"]}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Basic salary divided by working days"})]}),t.absentDays>0&&r.jsxs("div",{className:"mt-4 bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Absent Deduction Calculation"}),r.jsxs("p",{className:"text-sm",children:[t.absentDays," days × ₹",W.toFixed(2)," = ₹",t.absentDeduction?.toLocaleString()]}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Absent days multiplied by daily rate"})]})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Tax Calculation"}),r.jsxs("div",{className:"bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Taxable Income"}),r.jsxs("p",{className:"text-lg font-semibold",children:["₹",t.basic?.toLocaleString()]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Basic salary used for tax calculation"})]}),t.tax>0&&r.jsxs("div",{className:"mt-4 bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Tax Percentage"}),r.jsxs("p",{className:"text-lg font-semibold",children:[(t.tax/t.basic*100).toFixed(2),"%"]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Applicable tax rate on basic salary"})]})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Net Pay Calculation"}),r.jsxs("div",{className:"space-y-2 bg-white p-4 rounded shadow-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Basic Salary:"}),r.jsxs("span",{children:["+₹",t.basic?.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"HRA:"}),r.jsxs("span",{children:["+₹",t.hra?.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Total Allowances:"}),r.jsxs("span",{children:["+₹",U.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between font-semibold border-t pt-2",children:[r.jsx("span",{children:"Gross Earnings:"}),r.jsxs("span",{children:["₹",t.totalEarnings?.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between text-red-600",children:[r.jsx("span",{children:"Tax Deduction:"}),r.jsxs("span",{children:["-₹",t.tax?.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between text-red-600",children:[r.jsx("span",{children:"Absent Deduction:"}),r.jsxs("span",{children:["-₹",t.absentDeduction?.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between text-red-600",children:[r.jsx("span",{children:"Other Deductions:"}),r.jsxs("span",{children:["-₹",F(t.deductions).toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between font-semibold text-red-600 border-t pt-2",children:[r.jsx("span",{children:"Total Deductions:"}),r.jsxs("span",{children:["-₹",t.totalDeductions?.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between font-bold text-green-600 text-lg border-t pt-2",children:[r.jsx("span",{children:"Net Pay:"}),r.jsxs("span",{children:["₹",t.netPay?.toLocaleString()]})]})]})]})]}),t.status==="rejected"&&t.rejectionReason&&r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg mb-6",children:[r.jsx("h4",{className:"text-sm font-semibold text-red-800 mb-2",children:"Rejection Reason:"}),r.jsx("p",{className:"text-sm text-red-700",children:t.rejectionReason})]}),r.jsxs("div",{className:"flex flex-wrap gap-3",children:[u&&t.status==="draft"&&r.jsx(r.Fragment,{children:h?r.jsx(r.Fragment,{children:r.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"})}):r.jsx(r.Fragment,{})}),r.jsx("button",{onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Close"})]})]})}):null},xw="#104774",qP="#0d3a61",GP=()=>{const{token:n,user:e}=rs(),[t,s]=E.useState([]),[i,l]=E.useState([]),[c,u]=E.useState(!0),[h,m]=E.useState({year:new Date().getFullYear(),month:new Date().getMonth()+1,status:"",employee:""}),[p,x]=E.useState([]),[y,v]=E.useState(!1),[w,A]=E.useState(null),[N,j]=E.useState(!1),[_,C]=E.useState(null);E.useEffect(()=>{D(),P()},[h]);const k=(V,B="info",T=3500)=>{const G=Date.now()+Math.random();x(M=>[...M,{id:G,message:V,type:B}]),setTimeout(()=>x(M=>M.filter(O=>O.id!==G)),T)},D=async()=>{try{u(!0);const V=new URLSearchParams;h.year&&V.append("year",h.year),h.month&&V.append("month",h.month),h.status&&V.append("status",h.status),h.employee&&V.append("employee",h.employee);const B=await xe.get(`/payroll?${V}`,{headers:{Authorization:`Bearer ${n}`}});s(B.data.data||[])}catch(V){console.error("Error fetching payrolls:",V),k(V.response?.data?.message||"Could not fetch payroll records","error"),s([])}finally{u(!1)}},P=async()=>{try{const V=await xe.get("/employee/all-employees",{headers:{Authorization:`Bearer ${n}`}});l(V.data.data||[])}catch(V){console.error("Error fetching employees:",V),k("Error fetching employees","error")}},F=async V=>{try{const B=await xe.post("/payroll/monthly",V,{headers:{Authorization:`Bearer ${n}`}});k("Payroll created successfully","success"),v(!1),window.location.reload(),D()}catch(B){console.error("Error creating payroll:",B)}},U=async(V,B)=>{try{C(V);const T=await xe.put(`/payroll/${V}`,B,{headers:{Authorization:`Bearer ${n}`}});k("Payroll updated successfully","success"),j(!1),D()}catch(T){console.error("Error updating payroll:",T),k(T.response?.data?.message||"Error updating payroll","error")}finally{C(null)}},I=async V=>{try{C(V);const B=await xe.patch(`/payroll/${V}/submit`,{},{headers:{Authorization:`Bearer ${n}`}});k("Payroll submitted for approval","success"),D()}catch(B){console.error("Error submitting payroll:",B),k(B.response?.data?.message||"Error submitting payroll","error")}finally{C(null)}},K=V=>{const{name:B,value:T}=V.target;m(G=>({...G,[B]:T}))},H=()=>{m({year:new Date().getFullYear(),month:new Date().getMonth()+1,status:"",employee:""})},X=V=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(V),W=V=>new Date(V).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),ce=V=>{const B={draft:"bg-gray-100 text-gray-800",pending_approval:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${B[V]||"bg-gray-100 text-gray-800"}`,children:V.replace("_"," ").toUpperCase()})},me=["January","February","March","April","May","June","July","August","September","October","November","December"],L=new Date().getFullYear(),q=Array.from({length:3},(V,B)=>L+B);return c&&t.length===0?r.jsx("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin inline-block w-8 h-8 border-4 rounded-full",style:{borderColor:xw,borderLeftColor:"transparent"},role:"status"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Loading payroll records..."})]})}):r.jsxs("div",{className:"min-h-[80vh] p-2 sm:p-4",children:[r.jsx("style",{children:`
      .primary-btn:hover { background: ${qP} !important }
      
      /* Mobile table styles */
      @media (max-width: 768px) {
        .mobile-table-card {
          display: block;
          background: white;
          border: 1px solid #e5e7eb;
          border-radius: 0.5rem;
          margin-bottom: 1rem;
          padding: 1rem;
          box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        
        .mobile-table-card .mobile-row {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 0.75rem;
          padding-bottom: 0.75rem;
          border-bottom: 1px solid #f3f4f6;
        }
        
        .mobile-table-card .mobile-row:last-child {
          margin-bottom: 0;
          padding-bottom: 0;
          border-bottom: none;
        }
        
        .mobile-label {
          font-weight: 500;
          color: #6b7280;
          font-size: 0.875rem;
        }
        
        .mobile-value {
          font-weight: 600;
          color: #111827;
          font-size: 0.875rem;
          text-align: right;
          max-width: 60%;
          word-wrap: break-word;
        }
      }
      
      /* Stats cards responsive */
      @media (max-width: 640px) {
        .stats-grid {
          grid-template-columns: 1fr 1fr;
          gap: 0.75rem;
        }
        
        .stat-card {
          min-width: auto !important;
          padding: 0.75rem !important;
        }
        
        .stat-card h3 {
          font-size: 0.75rem !important;
        }
        
        .stat-card p {
          font-size: 1.25rem !important;
        }
      }
      
      /* Filter panel responsive */
      @media (max-width: 1024px) {
        .filters-grid {
          grid-template-columns: 1fr 1fr;
          gap: 0.75rem;
        }
      }
      
      @media (max-width: 640px) {
        .filters-grid {
          grid-template-columns: 1fr;
          gap: 1rem;
        }
        
        .filter-buttons {
          grid-column: 1;
          justify-content: flex-start !important;
          margin-top: 0 !important;
        }
      }
    `}),r.jsx(Ji,{notifications:p}),r.jsx("header",{className:"mb-4 sm:mb-6",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"Payroll Management"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:"Create and manage employee payrolls"})]}),r.jsxs("button",{onClick:()=>v(!0),className:"px-4 sm:px-6 py-2 sm:py-3 rounded-md text-white primary-btn text-sm sm:text-base",style:{backgroundColor:xw},children:[r.jsx("span",{className:"hidden sm:inline",children:"Create New Payroll"}),r.jsx("span",{className:"sm:hidden",children:"New Payroll"})]})]})}),r.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 sm:gap-6 mb-4 sm:mb-6",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsxs("div",{className:"stats-grid grid grid-cols-2 xl:grid-cols-4 gap-3 sm:gap-4",id:"stats-cards",children:[r.jsxs("div",{className:"stat-card bg-white p-3 sm:p-4 rounded-lg shadow border-l-4 border-blue-500 text-center min-w-[12.5rem]",children:[r.jsx("h3",{className:"text-xs sm:text-sm text-gray-500",children:"Total Payrolls"}),r.jsx("p",{className:"text-lg sm:text-2xl font-bold",children:t.length})]}),r.jsxs("div",{className:"stat-card bg-white p-3 sm:p-4 rounded-lg shadow border-l-4 border-yellow-500 text-center min-w-[12.5rem]",children:[r.jsx("h3",{className:"text-xs sm:text-sm text-gray-500",children:"Draft"}),r.jsx("p",{className:"text-lg sm:text-2xl font-bold text-yellow-600",children:t.filter(V=>V.status==="draft").length})]}),r.jsxs("div",{className:"stat-card bg-white p-3 sm:p-4 rounded-lg shadow border-l-4 border-blue-500 text-center min-w-[12.5rem]",children:[r.jsx("h3",{className:"text-xs sm:text-sm text-gray-500",children:"Pending Approval"}),r.jsx("p",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:t.filter(V=>V.status==="pending_approval").length})]}),r.jsxs("div",{className:"stat-card bg-white p-3 sm:p-4 rounded-lg shadow border-l-4 border-green-500 text-center min-w-[12.5rem]",children:[r.jsx("h3",{className:"text-xs sm:text-sm text-gray-500",children:"Approved"}),r.jsx("p",{className:"text-lg sm:text-2xl font-bold text-green-600",children:t.filter(V=>V.status==="approved").length})]})]})}),r.jsx("div",{className:"flex-1 bg-white shadow rounded-lg border-l-4 border-blue-500 flex flex-col",style:{minHeight:"85px"},children:r.jsx("div",{className:"flex-1 p-3 sm:p-4",children:r.jsxs("div",{className:"filters-grid grid grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 gap-2 sm:gap-3 h-full items-center",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Year"}),r.jsx("select",{name:"year",value:h.year,onChange:K,className:"w-full p-1.5 sm:p-2 text-xs sm:text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:q.map(V=>r.jsx("option",{value:V,children:V},V))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Month"}),r.jsxs("select",{name:"month",value:h.month,onChange:K,className:"w-full p-1.5 sm:p-2 text-xs sm:text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Months"}),me.map((V,B)=>r.jsx("option",{value:B+1,children:V},B+1))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Status"}),r.jsxs("select",{name:"status",value:h.status,onChange:K,className:"w-full p-1.5 sm:p-2 text-xs sm:text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"draft",children:"Draft"}),r.jsx("option",{value:"pending_approval",children:"Pending Approval"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Employee"}),r.jsxs("select",{name:"employee",value:h.employee,onChange:K,className:"w-full p-1.5 sm:p-2 text-xs sm:text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Employees"}),i.map(V=>r.jsxs("option",{value:V._id,children:[V.firstName," ",V.lastName," (",V.employeeId,")"]},V._id))]})]}),r.jsx("div",{className:"filter-buttons flex gap-2 justify-center mt-2 sm:mt-4",children:r.jsxs("button",{onClick:H,className:"px-2 sm:px-3 py-1.5 sm:py-2 text-xs bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 transition-colors flex items-center gap-1 border",title:"Clear Filters",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear"]})})]})})})]}),r.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[r.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200",children:r.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-800",children:"Payroll Records"})}),t.length===0?r.jsxs("div",{className:"text-center py-8 sm:py-12",children:[r.jsx("svg",{className:"w-12 sm:w-16 h-12 sm:h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"No payroll records found"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400 mt-1",children:"Try adjusting your filters or create a new payroll"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Period"}),r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Basic Salary"}),r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(V=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-8 w-8 sm:h-10 sm:w-10",children:r.jsx("img",{className:"h-8 w-8 sm:h-10 sm:w-10 rounded-full object-cover",src:V.employee?.avatarUrl||"/default-avatar.png",alt:""})}),r.jsxs("div",{className:"ml-3 sm:ml-4",children:[r.jsxs("div",{className:"text-xs sm:text-sm font-medium text-gray-900",children:[V.employeeProfile?.firstName," ",V.employeeProfile?.lastName]}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:V.employeeProfile?.employeeId})]})]})}),r.jsxs("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:[r.jsxs("div",{className:"text-xs sm:text-sm text-gray-900",children:[me[parseInt(V.month.split("-")[1])-1]," ",V.year]}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:W(V.generatedAt)})]}),r.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-xs sm:text-sm text-gray-900",children:X(V.basic)}),r.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:ce(V.status)}),r.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-xs sm:text-sm font-medium",children:r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>{A(V),j(!0)},className:"text-blue-600 hover:text-blue-900",children:"View"}),V.status==="draft"&&r.jsx("button",{onClick:()=>I(V._id),disabled:_===V._id,className:"text-green-600 hover:text-green-900 disabled:opacity-50",children:_===V._id?"Processing...":"Submit"}),V.status==="rejected"&&r.jsx("button",{onClick:()=>{A(V),j(!0)},className:"text-yellow-600 hover:text-yellow-900",children:"Edit & Resubmit"})]})})]},V._id))})]})}),r.jsx("div",{className:"md:hidden p-4",children:t.map(V=>r.jsxs("div",{className:"mobile-table-card",children:[r.jsxs("div",{className:"mobile-row",children:[r.jsx("span",{className:"mobile-label",children:"Employee"}),r.jsxs("div",{className:"mobile-value flex items-center gap-2",children:[r.jsx("img",{className:"h-6 w-6 rounded-full object-cover",src:V.employee?.avatarUrl||"/default-avatar.png",alt:""}),r.jsxs("div",{className:"text-right",children:[r.jsxs("div",{className:"font-medium text-gray-900 text-xs",children:[V.employeeProfile?.firstName," ",V.employeeProfile?.lastName]}),r.jsx("div",{className:"text-gray-500 text-xs",children:V.employeeProfile?.employeeId})]})]})]}),r.jsxs("div",{className:"mobile-row",children:[r.jsx("span",{className:"mobile-label",children:"Period"}),r.jsxs("div",{className:"mobile-value",children:[r.jsxs("div",{className:"text-gray-900",children:[me[parseInt(V.month.split("-")[1])-1]," ",V.year]}),r.jsx("div",{className:"text-gray-500 text-xs",children:W(V.generatedAt)})]})]}),r.jsxs("div",{className:"mobile-row",children:[r.jsx("span",{className:"mobile-label",children:"Basic Salary"}),r.jsx("span",{className:"mobile-value text-gray-900",children:X(V.basic)})]}),r.jsxs("div",{className:"mobile-row",children:[r.jsx("span",{className:"mobile-label",children:"Status"}),r.jsx("div",{className:"mobile-value",children:ce(V.status)})]}),r.jsxs("div",{className:"mobile-row",children:[r.jsx("span",{className:"mobile-label",children:"Actions"}),r.jsxs("div",{className:"mobile-value flex gap-2 text-xs",children:[r.jsx("button",{onClick:()=>{A(V),j(!0)},className:"text-blue-600 hover:text-blue-900 px-2 py-1 bg-blue-50 rounded",children:"View"}),V.status==="draft"&&r.jsx("button",{onClick:()=>I(V._id),disabled:_===V._id,className:"text-green-600 hover:text-green-900 disabled:opacity-50 px-2 py-1 bg-green-50 rounded",children:_===V._id?"Processing...":"Submit"}),V.status==="rejected"&&r.jsx("button",{onClick:()=>{A(V),j(!0)},className:"text-yellow-600 hover:text-yellow-900 px-2 py-1 bg-yellow-50 rounded text-xs",children:"Edit"})]})]})]},V._id))})]})]}),y&&r.jsx(VP,{isOpen:y,onClose:()=>v(!1),onCreate:F,token:n,addNotification:k}),N&&w&&r.jsx(IN,{isOpen:N,onClose:()=>j(!1),payroll:w,onUpdate:U,onSubmitForApproval:I,actionLoading:_,formatCurrency:X,isHR:!0})]})},yw="#104774",YP="#0d3a61",WP=()=>{const{token:n}=rs(),[e,t]=E.useState([]),[s,i]=E.useState(!0),[l,c]=E.useState({year:new Date().getFullYear(),month:new Date().getMonth()+1,status:"",employee:""}),[u,h]=E.useState([]),[m,p]=E.useState([]),[x,y]=E.useState(null),[v,w]=E.useState(!1),[A,N]=E.useState(null),[j,_]=E.useState({total:0,pending:0,approved:0,rejected:0}),[C,k]=E.useState(new Set),[D,P]=E.useState(""),[F,U]=E.useState(""),[I,K]=E.useState(!1),H=e.filter(ue=>ue.status!=="approved").map(ue=>ue._id),X=H.length;E.useEffect(()=>{ce(),me()},[l]);const W=(ue,He="info",ze=3500)=>{const at=Date.now()+Math.random();p(At=>[...At,{id:at,message:ue,type:He}]),setTimeout(()=>p(At=>At.filter(le=>le.id!==at)),ze)},ce=async()=>{try{i(!0);const ue=new URLSearchParams;l.year&&ue.append("year",l.year),l.month&&ue.append("month",l.month),l.status&&ue.append("status",l.status),l.employee&&ue.append("employee",l.employee),ue.append("fullData","true");const He=await xe.get(`/payroll?${ue}`,{headers:{Authorization:`Bearer ${n}`}});t(He.data.data||[]),L(He.data.data||[])}catch(ue){console.error("Error fetching payrolls:",ue),W(ue.response?.data?.message||"Could not fetch payroll records","error"),t([])}finally{i(!1)}},me=async()=>{try{const ue=await xe.get("/employee/all-employees",{headers:{Authorization:`Bearer ${n}`}});h(ue.data.data||[])}catch(ue){console.error("Error fetching employees:",ue),W("Error fetching employees","error")}},L=ue=>{const He={total:ue.length,pending:ue.filter(ze=>ze.status==="pending_approval").length,approved:ue.filter(ze=>ze.status==="approved").length,rejected:ue.filter(ze=>ze.status==="rejected").length};_(He)},q=async(ue,He,ze="")=>{try{N(ue);const at=await xe.patch(`/payroll/${ue}/approve`,{action:He,rejectionReason:ze},{headers:{Authorization:`Bearer ${n}`}}),At=He==="approve"?"Payroll rolled out successfully":He==="reject"?"Payroll rejected successfully":`Payroll ${He}ed successfully`;W(At,"success"),w(!1),ce()}catch(at){console.error("Error processing payroll:",at),W(at.response?.data?.message||`Error ${He}ing payroll`,"error")}finally{N(null)}},V=async()=>{if(!D){W("Please select an action first","error");return}if(D==="reject"&&!F.trim()){W("Please provide a rejection reason","error");return}if(C.size===0){W("Please select at least one payroll","error");return}try{N("bulk");const ue=Array.from(C).map(ze=>xe.patch(`/payroll/${ze}/approve`,{action:D,rejectionReason:D==="reject"?F:""},{headers:{Authorization:`Bearer ${n}`}}));await Promise.all(ue);const He=D==="approve"?"rolled out":D==="reject"?"rejected":`${D}ed`;W(`${C.size} payrolls ${He} successfully`,"success"),k(new Set),P(""),U(""),K(!1),ce()}catch(ue){console.error("Error processing bulk action:",ue),W(ue.response?.data?.message||"Error processing bulk action","error")}finally{N(null)}},B=ue=>{if(e.find(at=>at._id===ue)?.status==="approved")return;const ze=new Set(C);ze.has(ue)?ze.delete(ue):ze.add(ue),k(ze)},T=()=>{C.size===X?k(new Set):k(new Set(H))},G=ue=>{const{name:He,value:ze}=ue.target;c(at=>({...at,[He]:ze}))},M=()=>{c({year:new Date().getFullYear(),month:new Date().getMonth()+1,status:"",employee:""})},O=ue=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(ue),ae=ue=>new Date(ue).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),ee=ue=>{const He={draft:"bg-gray-100 text-gray-800",pending_approval:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},ze=ue==="approved"?"ROLLED OUT":ue==="pending_approval"?"PENDING ROLLED OUT":ue.replace("_"," ").toUpperCase();return r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${He[ue]||"bg-gray-100 text-gray-800"}`,children:ze})},pe=["January","February","March","April","May","June","July","August","September","October","November","December"],we=new Date().getFullYear(),Te=[we-1,we,we+1];return s&&e.length===0?r.jsx("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin inline-block w-8 h-8 border-4 rounded-full",style:{borderColor:yw,borderLeftColor:"transparent"},role:"status"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Loading payroll records..."})]})}):r.jsxs("div",{className:"max-h-screen  bg-gray-50",children:[r.jsx("style",{children:`
      .primary-btn:hover { background: ${YP} !important }
    `}),r.jsx(Ji,{notifications:m}),r.jsx("header",{className:"mb-4 md:mb-6",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-800",children:"Payroll Approval"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:"Review and approve employee payrolls"})]}),r.jsxs("button",{onClick:ce,className:"px-3 py-2 text-xs sm:text-sm rounded-md text-white primary-btn flex items-center gap-2 justify-center",style:{backgroundColor:yw},children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),r.jsx("span",{children:"Refresh"})]})]})}),r.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 md:gap-6 mb-4 md:mb-6",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsxs("div",{className:"grid grid-cols-2 xl:grid-cols-4 gap-3 md:gap-4",id:"stats-cards",children:[r.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow border-l-4 border-blue-500 text-center min-w-[120px]",children:[r.jsx("h3",{className:"text-xs md:text-sm text-gray-500",children:"Total Payrolls"}),r.jsx("p",{className:"text-base md:text-lg font-bold",children:j.total})]}),r.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow border-l-4 border-yellow-500 text-center min-w-[120px]",children:[r.jsx("h3",{className:"text-xs md:text-sm text-gray-500",children:"Pending Approval"}),r.jsx("p",{className:"text-base md:text-lg font-bold text-yellow-600",children:j.pending})]}),r.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow border-l-4 border-green-500 text-center min-w-[120px]",children:[r.jsx("h3",{className:"text-xs md:text-sm text-gray-500",children:"Approved"}),r.jsx("p",{className:"text-base md:text-lg font-bold text-green-600",children:j.approved})]}),r.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow border-l-4 border-red-500 text-center min-w-[120px]",children:[r.jsx("h3",{className:"text-xs md:text-sm text-gray-500",children:"Rejected"}),r.jsx("p",{className:"text-base md:text-lg font-bold text-red-600",children:j.rejected})]})]})}),r.jsx("div",{className:"flex-1 bg-white shadow rounded-lg border-l-4 border-blue-500",children:r.jsx("div",{className:"p-3 md:p-4",children:r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 gap-3 items-end",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Year"}),r.jsx("select",{name:"year",value:l.year,onChange:G,className:"w-full p-2 text-xs border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Te.map(ue=>r.jsx("option",{value:ue,children:ue},ue))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Month"}),r.jsxs("select",{name:"month",value:l.month,onChange:G,className:"w-full p-2 text-xs border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Months"}),pe.map((ue,He)=>r.jsx("option",{value:He+1,children:ue},He+1))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Status"}),r.jsxs("select",{name:"status",value:l.status,onChange:G,className:"w-full p-2 text-xs border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"pending_approval",children:"Pending Approval"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Employee"}),r.jsxs("select",{name:"employee",value:l.employee,onChange:G,className:"w-full p-2 text-xs border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Employees"}),u.map(ue=>r.jsxs("option",{value:ue._id,children:[ue.firstName," ",ue.lastName]},ue._id))]})]}),r.jsx("div",{className:"flex justify-center sm:justify-start",children:r.jsxs("button",{onClick:M,className:"px-3 py-2 text-xs bg-slate-100 text-slate-600 rounded-md hover:bg-slate-200 transition-colors flex items-center gap-1 border",title:"Clear Filters",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear"]})})]})})})]}),e.length>0&&r.jsxs("div",{className:"mb-4 md:mb-6 bg-blue-50 p-3 md:p-4 rounded-lg border border-blue-200",children:[r.jsx("h3",{className:"text-sm md:text-base font-semibold text-blue-800 mb-3",children:"Bulk Actions"}),r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",checked:C.size===X,onChange:T,className:"h-4 w-4 text-blue-600 rounded"}),r.jsxs("span",{className:"text-xs md:text-sm text-slate-700",children:["Select all (",C.size," selected)"]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[r.jsxs("select",{value:D,onChange:ue=>{P(ue.target.value),K(ue.target.value==="reject")},className:"p-2 border border-slate-300 rounded-md text-xs",children:[r.jsx("option",{value:"",children:"Select Action"}),r.jsx("option",{value:"approve",children:"Roll Out Selected"}),r.jsx("option",{value:"reject",children:"Reject Selected"})]}),I&&r.jsx("input",{type:"text",value:F,onChange:ue=>U(ue.target.value),placeholder:"Reason for rejection",className:"p-2 border border-slate-300 rounded-md flex-1 text-xs"}),r.jsx("button",{onClick:V,disabled:A==="bulk"||!D,className:"px-3 py-2 bg-[#104774] text-white rounded-md hover:bg-[#002442] disabled:opacity-50 flex items-center justify-center gap-2 text-xs",children:A==="bulk"?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),r.jsx("span",{children:"Processing..."})]}):"Apply to Selected"})]})]})]}),r.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[r.jsxs("div",{className:"px-3 md:px-4 py-3 border-b border-slate-200 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2",children:[r.jsxs("h2",{className:"text-sm md:text-base font-semibold text-gray-800",children:["Payroll Records (",e.length,")"]}),r.jsx("span",{className:"text-xs text-slate-500",children:l.status==="pending_approval"?"Pending Approval":l.status==="approved"?"Approved":l.status==="rejected"?"Rejected":"All Records"})]}),e.length===0?r.jsxs("div",{className:"text-center py-6 px-4",children:[r.jsx("svg",{className:"w-12 h-12 text-slate-300 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{className:"text-slate-500 text-sm",children:"No payroll records found"}),r.jsx("p",{className:"text-xs text-slate-400 mt-1",children:l.status==="pending_approval"?"No payrolls pending approval":"Try adjusting your filters"})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[r.jsx("thead",{className:"bg-slate-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-slate-500 uppercase",children:r.jsx("input",{type:"checkbox",checked:C.size===X,onChange:T,className:"h-4 w-4 text-blue-600 rounded"})}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-slate-500 uppercase min-w-[150px]",children:"Employee"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-slate-500 uppercase min-w-[100px]",children:"Period"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-slate-500 uppercase min-w-[80px]",children:"Net Pay"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-slate-500 uppercase min-w-[100px]",children:"Status"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-slate-500 uppercase min-w-[100px]",children:"Generated By"}),r.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-slate-500 uppercase min-w-[150px]",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:e.map(ue=>r.jsxs("tr",{className:"hover:bg-slate-50",children:[r.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:r.jsx("input",{type:"checkbox",checked:C.has(ue._id),onChange:()=>B(ue._id),className:"h-4 w-4 text-blue-600 rounded",disabled:ue.status==="approved",title:ue.status==="approved"?"Already Rolled Out":void 0})}),r.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-6 w-6 md:h-8 md:w-8",children:r.jsx("img",{className:"h-6 w-6 md:h-8 md:w-8 rounded-full object-cover",src:ue.employee?.avatarUrl||"/default-avatar.png",alt:ue.employee?.firstName})}),r.jsxs("div",{className:"ml-2",children:[r.jsxs("div",{className:"text-xs md:text-sm font-medium text-slate-900",children:[ue.employee?.firstName," ",ue.employee?.lastName]}),r.jsx("div",{className:"text-xs text-slate-400",children:ue.employee?.email||"—"}),r.jsx("div",{className:"text-xs text-slate-500",children:ue.employee?.employeeId})]})]})}),r.jsxs("td",{className:"px-3 py-2 whitespace-nowrap",children:[r.jsxs("div",{className:"text-xs md:text-sm text-slate-900",children:[pe[parseInt(ue.month.split("-")[1],10)-1]," ",ue.year]}),ue.generatedAt&&r.jsx("div",{className:"text-xs text-slate-500",children:ae(ue.generatedAt)})]}),r.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:r.jsx("div",{className:"text-xs md:text-sm font-semibold text-green-600",children:O(ue.basic)})}),r.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:ee(ue.status)}),r.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-slate-500",children:ue.generatedBy||"—"}),r.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs font-medium",children:r.jsxs("div",{className:"flex flex-col sm:flex-row gap-1",children:[r.jsxs("button",{onClick:()=>{y(ue),w(!0)},className:"text-blue-600 hover:text-blue-900 flex items-center gap-1 justify-center sm:justify-start p-1",children:[r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),r.jsx("span",{className:"text-xs",children:"Review"})]}),ue.status==="pending_approval"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>q(ue._id,"approve"),disabled:A===ue._id,className:"text-green-600 hover:text-green-900 disabled:opacity-50 flex items-center gap-1 justify-center sm:justify-start p-1",children:A===ue._id?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-green-600"}),r.jsx("span",{className:"text-xs",children:"Processing..."})]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),r.jsx("span",{className:"text-xs",children:"Roll Out"})]})}),r.jsxs("button",{onClick:()=>{y(ue),w(!0)},className:"text-red-600 hover:text-red-900 flex items-center gap-1 justify-center sm:justify-start p-1",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),r.jsx("span",{className:"text-xs",children:"Reject"})]})]})]})})]},ue._id))})]})})]}),v&&x&&r.jsx(IN,{isOpen:v,onClose:()=>w(!1),payroll:x,onApproveReject:q,actionLoading:A,formatCurrency:O,isHR:!1,actionLabel:"Roll Out"})]})},XP=({isOpen:n,onClose:e,onSuccess:t,token:s,leaveBalance:i})=>{const[l,c]=E.useState([]),[u,h]=E.useState({leaveType:"",fromDate:"",toDate:"",reason:"",totalDays:0}),[m,p]=E.useState({}),[x,y]=E.useState(!1),[v,w]=E.useState(!1);E.useEffect(()=>{n&&A()},[n]),E.useEffect(()=>{n||(h({leaveType:"",fromDate:"",toDate:"",reason:"",totalDays:0}),p({}))},[n]);const A=async()=>{try{const D=((await xe.get("/leave/get-leaveTypes",{headers:{Authorization:`Bearer ${s}`}})).data||[]).filter(P=>P.isActive);c(D),D.length>0&&!u.leaveType&&h(P=>({...P,leaveType:D[0].name}))}catch(k){console.error("Error fetching leave types:",k)}},N=(k,D)=>{if(!k||!D)return 0;const P=new Date(k),F=new Date(D);if(P>F)return 0;let U=0;const I=new Date(P);for(;I<=F;){const K=I.getDay();K!==0&&K!==6&&U++,I.setDate(I.getDate()+1)}return U};E.useEffect(()=>{if(u.fromDate&&u.toDate){w(!0);const k=N(u.fromDate,u.toDate);h(D=>({...D,totalDays:k})),w(!1)}else h(k=>({...k,totalDays:0}))},[u.fromDate,u.toDate]);const j=k=>{const{name:D,value:P}=k.target;h(F=>({...F,[D]:P})),m[D]&&p(F=>({...F,[D]:""}))},_=()=>{const k={},D=new Date;if(D.setHours(0,0,0,0),u.leaveType||(k.leaveType="Leave type is required"),u.fromDate?new Date(u.fromDate)<D&&(k.fromDate="Cannot apply for backdated leaves"):k.fromDate="From date is required",u.toDate?u.fromDate&&new Date(u.toDate)<new Date(u.fromDate)&&(k.toDate="To date cannot be before from date"):k.toDate="To date is required",u.reason.trim()?u.reason.length>500&&(k.reason="Reason cannot exceed 500 characters"):k.reason="Reason is required",u.leaveType&&u.totalDays>0){const P=i[u.leaveType]||0;P<u.totalDays&&(k.leaveType=`Insufficient ${u.leaveType} leave balance! You have ${P} days left.`)}return p(k),Object.keys(k).length===0},C=async k=>{if(k.preventDefault(),!!_()){y(!0);try{await xe.post("/leave/create",u,{headers:{Authorization:`Bearer ${s}`}}),t()}catch(D){console.error("Error applying leave:",D);const P=D.response?.data?.message||"Error applying leave. Please try again.";p({submit:P})}finally{y(!1)}}};return n?r.jsx("div",{className:"fixed inset-0  bg-opacity-50 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:r.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md relative max-h-[90vh] overflow-y-auto shadow-xl border border-gray-200",children:[r.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(Vo,{size:24})}),r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Apply for Leave"}),r.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Fill in the details to apply for leave"}),m.submit&&r.jsxs("div",{className:"mb-4 p-3 bg-red-50 text-red-700 rounded-lg text-sm flex items-center",children:[r.jsx(ns,{size:16,className:"mr-2"}),m.submit]}),r.jsxs("form",{onSubmit:C,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block mb-2 font-medium text-sm text-gray-700",children:"Leave Type"}),r.jsxs("select",{name:"leaveType",value:u.leaveType,onChange:j,className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",children:[r.jsx("option",{value:"",children:"Select Leave Type"}),l.map(k=>r.jsxs("option",{value:k.name,children:[k.name.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase()),i[k.name]!==void 0&&` (${i[k.name]} days available)`]},k._id))]}),m.leaveType&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(ns,{size:12,className:"mr-1"}),m.leaveType]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block mb-2 font-medium text-sm text-gray-700",children:"From Date"}),r.jsx("input",{type:"date",name:"fromDate",value:u.fromDate,onChange:j,min:new Date().toISOString().split("T")[0],className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm"}),m.fromDate&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(ns,{size:12,className:"mr-1"}),m.fromDate]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-2 font-medium text-sm text-gray-700",children:"To Date"}),r.jsx("input",{type:"date",name:"toDate",value:u.toDate,onChange:j,min:u.fromDate||new Date().toISOString().split("T")[0],className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm"}),m.toDate&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(ns,{size:12,className:"mr-1"}),m.toDate]})]})]}),u.fromDate&&u.toDate&&r.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-100",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-blue-700 font-medium",children:"Working Days:"}),r.jsx("span",{className:"text-blue-800 font-semibold",children:v?r.jsxs("span",{className:"flex items-center",children:[r.jsx(pn,{size:14,className:"mr-1 animate-pulse"}),"Calculating..."]}):`${u.totalDays} day${u.totalDays!==1?"s":""}`})]}),r.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"(Excludes weekends)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-2 font-medium text-sm text-gray-700",children:"Reason"}),r.jsx("textarea",{name:"reason",value:u.reason,onChange:j,rows:4,className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",placeholder:"Please provide a reason for your leave"}),r.jsxs("div",{className:"flex justify-between mt-1",children:[r.jsxs("div",{className:"text-xs text-gray-500",children:[u.reason.length,"/500 characters"]}),m.reason&&r.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[r.jsx(ns,{size:12,className:"mr-1"}),m.reason]})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 text-sm font-medium transition-colors",disabled:x,children:"Cancel"}),r.jsx("button",{type:"submit",disabled:x,className:"px-4 py-2 rounded-lg bg-[#104774] text-white hover:bg-[#0d3a61] text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:x?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Applying..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Js,{size:16,className:"mr-2"}),"Apply for Leave"]})})]})]})]})}):null},QP=()=>{const{token:n,user:e}=rs(),[t,s]=E.useState({attendance:{},leaveBalance:{},attendanceSummary:{},leaveApplications:[]}),[i,l]=E.useState(!0),[c,u]=E.useState(!1),[h,m]=E.useState(!1),[p,x]=E.useState(!1),[y,v]=E.useState(!1),[w,A]=E.useState([]),[N,j]=E.useState([]),_=il(),C=(W,ce="info",me=4e3)=>{const L=Date.now()+Math.random();j(q=>[...q,{id:L,message:W,type:ce}]),setTimeout(()=>j(q=>q.filter(V=>V.id!==L)),me)},k=async()=>{try{u(!0);const ce=(await xe.get("/attendance/today",{headers:{Authorization:`Bearer ${n}`}})).data||{},L=(await xe.get("/leave/balance",{headers:{Authorization:`Bearer ${n}`}})).data?.balance||{},V=(await xe.get("/attendance/history",{headers:{Authorization:`Bearer ${n}`}})).data||[],B=new Date,T=new Date;T.setDate(B.getDate()-30);const G={present:V.filter(ae=>ae.status==="accepted"&&new Date(ae.date)>=T).length,absent:0,leave:V.filter(ae=>ae.status==="on_leave"&&new Date(ae.date)>=T).length,holidays:0},O=(await xe.get("/leave/my-requests",{headers:{Authorization:`Bearer ${n}`}})).data||[];s({attendance:ce,leaveBalance:L,attendanceSummary:G,leaveApplications:O})}catch(W){console.error("Error fetching dashboard data:",W)}finally{l(!1),u(!1)}},D=async()=>{try{const ce=((await xe.get("/leave/get-leaveTypes",{headers:{Authorization:`Bearer ${n}`}})).data||[]).filter(me=>me.isActive);A(ce)}catch(W){console.error("Error fetching leave types:",W)}};E.useEffect(()=>{k(),D()},[]);const P=()=>{m(!1),k()},F=()=>{x(!1),k()},U=()=>{v(!1),k()},I=W=>W?yo(new Date(W),"dd MMM yy"):"",K=W=>W.replace(/_/g," ").replace(/\b\w/g,ce=>ce.toUpperCase());if(i)return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#104774]"})});const X=Math.round(t.attendanceSummary.present/26*100);return r.jsxs("div",{className:"min-h-[80vh] p-6 bg-gray-50",children:[r.jsx(Ji,{notifications:N}),r.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Employee Dashboard"}),r.jsxs("p",{className:"text-gray-600",children:["Welcome back, ",e?.name,"! Here's your overview for today."]})]}),r.jsxs("button",{onClick:k,disabled:c,className:"bg-[#104774] text-white px-4 py-2 rounded-lg flex items-center disabled:opacity-50",children:[r.jsx(Fi,{className:`w-4 h-4 mr-2 ${c?"animate-spin":""}`}),c?"Refreshing...":"Refresh Data"]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 flex flex-col h-[280px]",children:[r.jsx("div",{className:"flex items-center mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"Today's Attendance"})}),r.jsx("div",{className:"mb-4",children:r.jsx("span",{className:`px-3 py-1.5 rounded-full text-sm font-medium ${t.attendance.status==="accepted"?"bg-green-100 text-green-700":t.attendance.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:t.attendance.status?t.attendance.status.charAt(0).toUpperCase()+t.attendance.status.slice(1):"Not marked"})}),r.jsxs("div",{className:"space-y-2 mb-6 flex-grow overflow-y-auto pr-1 scrollbar-hide",children:[r.jsxs("div",{className:"text-sm text-slate-600 flex items-center",children:["Log In:"," ",r.jsx("span",{className:"font-medium text-slate-900 ml-1",children:t.attendance.checkIn?new Date(t.attendance.checkIn).toLocaleTimeString():"Not logged in"})]}),r.jsxs("div",{className:"text-sm text-slate-600 flex items-center",children:["Log Out:"," ",r.jsx("span",{className:"font-medium text-slate-900 ml-1",children:t.attendance.checkOut?new Date(t.attendance.checkOut).toLocaleTimeString():"Pending"})]})]}),t.attendance.checkOut?r.jsx("div",{className:"w-full text-center py-3 px-4 bg-gray-100 text-gray-700 rounded-xl font-medium",children:"Today's Session Ended"}):t.attendance.checkIn?r.jsx("button",{onClick:()=>x(!0),className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-3 px-4 rounded-xl font-medium transition-all duration-300 transform hover:scale-[1.02] shadow-md hover:shadow-lg mt-auto",children:"Log Out"}):r.jsx("button",{onClick:()=>m(!0),className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-3 px-4 rounded-xl font-medium transition-all duration-300 transform hover:scale-[1.02] shadow-md hover:shadow-lg mt-auto",children:"Mark Attendance"})]}),r.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 flex flex-col h-[280px]",children:[r.jsx("div",{className:"flex items-center mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"Leaves Summary"})}),r.jsxs("div",{className:"space-y-2 mb-6 flex-grow overflow-y-auto pr-1 scrollbar-hide",children:[r.jsxs("div",{className:"text-sm text-slate-600",children:["Total Leaves:"," ",r.jsx("span",{className:"font-medium text-slate-900",children:(t.leaveBalance.sick||0)+(t.leaveBalance.casual||0)+(t.leaveBalance.paid||0)})]}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Sick:"," ",r.jsx("span",{className:"font-medium text-red-500 ml-1",children:t.leaveBalance.sick||0})]}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Casual:"," ",r.jsx("span",{className:"font-medium text-blue-500 ml-1",children:t.leaveBalance.casual||0})]}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Paid:"," ",r.jsx("span",{className:"font-medium text-green-500 ml-1",children:t.leaveBalance.paid||0})]})]}),r.jsx("button",{onClick:()=>v(!0),className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-3 px-4 rounded-xl font-medium transition-all duration-300 transform hover:scale-[1.02] shadow-md hover:shadow-lg mt-auto",children:"Apply for Leave"})]}),r.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 flex flex-col h-[280px]",children:[r.jsx("div",{className:"flex items-center mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"Recent Leaves"})}),r.jsxs("div",{className:"space-y-3 mb-6 flex-grow max-h-[200px] overflow-y-auto pr-1 scrollbar-hide",children:[t.leaveApplications.slice(0,5).map((W,ce)=>r.jsxs("div",{className:"text-sm pb-2 last:border-0",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-medium text-slate-800",children:K(W.leaveType)}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${W.status==="approved"?"bg-green-100 text-green-700":W.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:W.status})]}),r.jsxs("div",{className:"text-slate-600",children:[I(W.fromDate)," - ",I(W.toDate)]})]},ce)),t.leaveApplications.length===0&&r.jsx("div",{className:"text-sm text-slate-500 text-center py-4 mt-9",children:"No leave applications yet"})]}),r.jsx("button",{onClick:()=>_("/employee/leaves"),className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-3 px-4 rounded-xl font-medium transition-all duration-300 transform hover:scale-[1.02] shadow-md hover:shadow-lg mt-auto",children:"View All Leaves"})]}),r.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 flex flex-col h-[280px]",children:[r.jsx("div",{className:"flex items-center mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"Performance"})}),r.jsxs("div",{className:"space-y-2 mb-6 flex-grow overflow-y-auto pr-1 scrollbar-hide",children:[r.jsxs("div",{className:"text-sm text-slate-600",children:["Attendance Rate:"," ",r.jsxs("span",{className:"font-medium text-slate-900",children:[X,"%"]})]}),r.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${X}%`}})}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Present Days:"," ",r.jsx("span",{className:"font-medium text-slate-900",children:t.attendanceSummary.present||0})]}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Leaves Taken:"," ",r.jsx("span",{className:"font-medium text-slate-900",children:t.attendanceSummary.leave||0})]})]}),r.jsx("button",{onClick:()=>_("/employee/attendance"),className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-3 px-4 rounded-xl font-medium transition-all duration-300 transform hover:scale-[1.02] shadow-md hover:shadow-lg mt-auto",children:"View Attendance"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-md hover:shadow-lg transition-all duration-300 border border-slate-200 flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"text-xl font-semibold text-slate-800 flex items-center",children:[r.jsx(WC,{className:"w-5 h-5 mr-2 text-blue-500"}),"Attendance Summary"]}),r.jsx("span",{className:"text-sm text-gray-500",children:"Last 30 Days"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4 flex-grow",children:[r.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg border border-green-100",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:t.attendanceSummary.present||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Present days"})]}),r.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg border border-blue-100",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:t.attendanceSummary.leave||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"On leave days"})]}),r.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg border border-yellow-100",children:[r.jsx("div",{className:"text-2xl font-bold text-yellow-600 mb-1",children:"25"}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Working days"})]}),r.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg border border-purple-100",children:[r.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:t.attendanceSummary.holidays||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Holidays"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-5 shadow-md hover:shadow-lg transition-all duration-300 border border-blue-100",children:[r.jsxs("div",{className:"flex items-center justify-between mb-5",children:[r.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"Leave Balance"}),r.jsx("span",{className:"text-sm text-gray-500",children:"Remaining"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-5",children:[r.jsxs("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm border border-slate-100",children:[r.jsx("div",{className:"text-2xl font-bold text-red-500 mb-1",children:t.leaveBalance.sick||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Sick Leave"})]}),r.jsxs("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm border border-slate-100",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-500 mb-1",children:t.leaveBalance.casual||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Casual Leave"})]}),r.jsxs("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm border border-slate-100",children:[r.jsx("div",{className:"text-2xl font-bold text-green-500 mb-1",children:t.leaveBalance.paid||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Paid Leave"})]}),r.jsxs("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm border border-slate-100",children:[r.jsx("div",{className:"text-2xl font-bold text-purple-500 mb-1",children:t.leaveBalance.other||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Other Leave"})]})]})]})]}),r.jsx(Bu,{isOpen:h,onClose:()=>m(!1),onSuccess:P,token:n,addNotification:C}),r.jsx(Hu,{isOpen:p,onClose:()=>x(!1),onSuccess:F,attendanceData:t.attendance,token:n,addNotification:C}),r.jsx(XP,{isOpen:y,onClose:()=>v(!1),onSuccess:U,token:n,leaveBalance:t.leaveBalance,leaveTypes:w,addNotification:C})]})},ZP=()=>{const{token:n,user:e}=rs(),t=il(),[s,i]=E.useState(null),[l,c]=E.useState([]),[u,h]=E.useState(null),[m,p]=E.useState({}),[x,y]=E.useState(!0),[v,w]=E.useState(!1),[A,N]=E.useState(!1),[j,_]=E.useState(!1);E.useEffect(()=>{C(),k()},[]);const C=async()=>{try{w(!0);const[H,X,W]=await Promise.all([xe.get("/dashboard/hr/stats"),xe.get("/dashboard/hr/attendance-log"),xe.get("/dashboard/hr/pending-approvals")]);i(H.data.data),c(X.data.data),h(W.data.data)}catch(H){console.error("Error fetching HR dashboard data:",H),alert("Error loading dashboard data")}finally{y(!1),w(!1)}},k=async()=>{try{const H=await xe.get("/attendance/hr/today",{headers:{Authorization:`Bearer ${n}`}});p(H.data||{})}catch(H){console.error("Error fetching HR attendance:",H)}},D=H=>{p(H),N(!1)},P=H=>{p(H),_(!1)},F=async H=>{try{await xe.patch(`/dashboard/hr/approve-attendance/${H}`,{status:"approved"}),alert("Attendance approved!"),C(),k()}catch(X){alert(X.response?.data?.message||"Error approving attendance")}},U=async H=>{try{await xe.patch(`/dashboard/hr/approve-attendance/${H}`,{status:"rejected"}),alert("Attendance rejected!"),C(),k()}catch(X){alert(X.response?.data?.message||"Error rejecting attendance")}},I=()=>N(!0),K=()=>_(!0);return x?r.jsx("div",{className:"max-h-[80vh] bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#104774]"})}):r.jsxs("div",{className:"max-h-[80vh] bg-gray-50 p-4 sm:p-6",children:[r.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"HR Dashboard"}),r.jsxs("p",{className:"text-sm sm:text-base text-gray-600",children:["Welcome back, ",e?.name,"! Here's your overview for today."]})]}),r.jsxs("button",{onClick:()=>{C(),k()},disabled:v,className:"bg-[#104774] text-white px-4 py-2 rounded-lg flex items-center justify-center disabled:opacity-50 w-full sm:w-auto",children:[r.jsx(Fi,{className:`w-4 h-4 mr-2 ${v?"animate-spin":""}`}),v?"Refreshing...":"Refresh Data"]})]}),r.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 sm:gap-6 mb-8",children:[r.jsxs("div",{onClick:()=>{m.checkIn?m.checkIn&&!m.checkOut&&K():I()},className:"bg-gradient-to-r from-yellow-100 to-yellow-200 rounded-2xl p-4 sm:p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 cursor-pointer flex flex-col min-h-[160px] sm:min-h-[180px]",children:[r.jsxs("div",{className:"mb-3 sm:mb-4 flex items-center justify-between",children:[r.jsx("h3",{className:"font-semibold text-slate-800 text-base sm:text-lg",children:"Your Attendance"}),r.jsx("span",{className:`px-2 py-1 sm:px-3 sm:py-1.5 rounded-full text-xs font-medium ${m.status==="accepted"?"bg-green-100 text-green-700":m.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-700 text-yellow-200"}`,children:m.status?m.status.charAt(0).toUpperCase()+m.status.slice(1):"Not marked"})]}),r.jsxs("div",{className:"space-y-1 sm:space-y-2 flex-grow overflow-y-auto pr-1 scrollbar-hide",children:[r.jsxs("div",{className:"text-xs sm:text-sm text-slate-600 flex items-center",children:["Log In:"," ",r.jsx("span",{className:"font-medium text-slate-900 ml-1 truncate",children:m.checkIn?new Date(m.checkIn).toLocaleTimeString():"Not logged in"})]}),r.jsxs("div",{className:"text-xs sm:text-sm text-slate-600 flex items-center",children:["Log Out:"," ",r.jsx("span",{className:"font-medium text-slate-900 ml-1 truncate",children:m.checkOut?new Date(m.checkOut).toLocaleTimeString():"Pending"})]})]}),r.jsx("div",{className:"text-center text-xs sm:text-sm text-slate-700 mt-2",children:m.checkOut?"Today's Session Ended":m.checkIn?"Click to Log Out":"Click to Mark Attendance"})]}),r.jsxs("div",{onClick:()=>t("/manage-employees"),className:"bg-gradient-to-r from-blue-100 to-blue-200 rounded-2xl p-4 sm:p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 cursor-pointer",children:[r.jsx("div",{className:"mb-3 sm:mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-base sm:text-lg",children:"Total Employees"})}),r.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-slate-800 mb-1 sm:mb-2",children:s?.totalEmployees||0}),r.jsx("p",{className:"text-xs sm:text-sm text-green-600 font-medium",children:"Active"})]}),r.jsxs("div",{onClick:()=>t("/hr/leaves"),className:"bg-gradient-to-r from-orange-100 to-orange-200 rounded-2xl p-4 sm:p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 cursor-pointer",children:[r.jsx("div",{className:"mb-3 sm:mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-base sm:text-lg",children:"Pending Approvals"})}),r.jsxs("div",{className:"flex items-baseline mb-1 sm:mb-2",children:[r.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-slate-800 mr-2",children:u?.leaveRequests||0}),r.jsx("span",{className:"text-sm sm:text-lg text-slate-600 truncate",children:"Leave Requests"})]}),r.jsxs("div",{className:"flex items-baseline",children:[r.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-slate-800 mr-2",children:u?.attendance||0}),r.jsx("span",{className:"text-sm sm:text-lg text-slate-600 truncate",children:"Attendance"})]})]}),r.jsxs("div",{onClick:()=>t("/hr/payroll"),className:"bg-gradient-to-r from-green-100 to-green-200 rounded-2xl p-4 sm:p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 cursor-pointer",children:[r.jsx("div",{className:"mb-3 sm:mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-base sm:text-lg",children:"Payroll Processed"})}),r.jsxs("div",{className:"text-2xl sm:text-3xl font-bold text-slate-800 mb-1 sm:mb-2",children:[s?.processedPayroll||0,"/",s?.totalEmployees||0]}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-600",children:"This Month"})]}),r.jsxs("div",{className:"bg-gradient-to-r from-purple-100 to-purple-200 rounded-2xl p-4 sm:p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 cursor-pointer",children:[r.jsx("div",{className:"mb-3 sm:mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-base sm:text-lg",children:"New Joiners"})}),r.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-slate-800 mb-1 sm:mb-2",children:s?.newJoiners||0}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-600",children:"This Week"})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl p-4 sm:p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 mb-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[r.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-slate-800",children:"Log in/Out"}),r.jsx(pn,{className:"w-4 h-4 sm:w-5 sm:h-5 text-slate-400"})]}),r.jsx("div",{className:"block lg:hidden space-y-4",children:l.map((H,X)=>r.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200 shadow-sm",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Name"}),r.jsx("p",{className:"text-sm font-medium text-slate-800 truncate",children:H.name})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Team"}),r.jsx("p",{className:"text-sm text-slate-600 truncate",children:H.team})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Log In"}),r.jsx("p",{className:"text-sm text-slate-600",children:H.checkIn?new Date(H.checkIn).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Log Out"}),r.jsx("p",{className:"text-sm text-slate-600",children:H.checkOut?new Date(H.checkOut).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-"})]})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Task"}),r.jsx("p",{className:"text-sm text-slate-600 truncate",children:H.task||"-"})]}),r.jsxs("div",{className:"mb-3",children:[r.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Notes"}),r.jsx("p",{className:"text-sm text-slate-600 truncate",children:H.notes||"-"})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${H.status==="Logged in"?"bg-green-100 text-green-700":H.status==="Pending"?"bg-yellow-100 text-yellow-700":H.status==="Rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:H.status}),H.status==="Pending"&&r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:()=>F(H._id),className:"bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded text-xs font-medium flex items-center gap-1 transition-colors",children:[r.jsx(bs,{className:"w-3 h-3"}),"Approve"]}),r.jsxs("button",{onClick:()=>U(H._id),className:"bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-xs font-medium flex items-center gap-1 transition-colors",children:[r.jsx(Ks,{className:"w-3 h-3"}),"Reject"]})]})]})]},H._id||X))}),r.jsx("div",{className:"hidden lg:block overflow-x-auto rounded-lg border border-slate-200 shadow-sm",children:r.jsxs("table",{className:"w-full border-collapse min-w-[800px]",children:[r.jsx("thead",{className:"bg-[#104774] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Name"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Team"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Log in"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Log out"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Task"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Notes"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Action"})]})}),r.jsx("tbody",{children:l.map((H,X)=>r.jsxs("tr",{className:`${X%2===0?"bg-white":"bg-slate-50"} hover:bg-slate-100 transition-colors`,children:[r.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-800 max-w-[120px] truncate",children:H.name}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 max-w-[100px] truncate",children:H.team}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 whitespace-nowrap",children:H.checkIn?new Date(H.checkIn).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-"}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 whitespace-nowrap",children:H.checkOut?new Date(H.checkOut).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-"}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 max-w-[150px] truncate",children:H.task||"-"}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 max-w-[150px] truncate",children:H.notes||"-"}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${H.status==="Logged in"?"bg-green-100 text-green-700":H.status==="Pending"?"bg-yellow-100 text-yellow-700":H.status==="Rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:H.status})}),r.jsx("td",{className:"px-4 py-3 flex gap-2",children:H.status==="Pending"&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>F(H._id),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1.5 rounded-md text-sm font-medium flex items-center gap-1 transition-colors",children:[r.jsx(bs,{className:"w-4 h-4"}),"Approve"]}),r.jsxs("button",{onClick:()=>U(H._id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded-md text-sm font-medium flex items-center gap-1 transition-colors",children:[r.jsx(Ks,{className:"w-4 h-4"}),"Reject"]})]})})]},H._id||X))})]})})]}),A&&r.jsx(Bu,{isOpen:A,onClose:()=>N(!1),onSuccess:D,token:n,addNotification:H=>alert(H),basePath:"/attendance/hr"}),j&&r.jsx(Hu,{isOpen:j,onClose:()=>_(!1),onSuccess:P,attendanceData:m,token:n,addNotification:H=>alert(H),basePath:"/attendance/hr"})]})},KP=()=>{const[n,e]=E.useState(null),[t,s]=E.useState([]),[i,l]=E.useState(!0),[c,u]=E.useState(!1),h=il();E.useEffect(()=>{m()},[]);const m=async()=>{try{u(!0);const[N,j]=await Promise.all([xe.get("/dashboard/admin/stats"),xe.get("/dashboard/admin/attendance-log")]);e(N.data.data),s(j.data.data)}catch(N){console.error("Error fetching admin dashboard data:",N),alert("Error loading dashboard data")}finally{l(!1),u(!1)}},p=async N=>{try{await xe.patch(`/dashboard/admin/approve-attendance/${N}`),m()}catch{alert("Error approving attendance")}},x=async N=>{try{await xe.patch(`/dashboard/admin/reject-attendance/${N}`),m()}catch{alert("Error rejecting attendance")}},y=()=>h("/admin/attendance"),v=()=>h("/admin/leaves"),w=()=>h("/admin/payroll-approval"),A=N=>N?new Date(N).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-";return i?r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#104774]"})}):r.jsxs("div",{className:"max-h-screen  bg-gray-50",children:[r.jsxs("div",{className:"mb-4 md:mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-800",children:"Admin Dashboard"}),r.jsx("p",{className:"text-gray-600 mt-1 text-xs sm:text-sm",children:"System overview and management"})]}),r.jsxs("button",{onClick:m,disabled:c,className:"bg-[#104774] text-white px-3 py-2 rounded-md flex items-center justify-center disabled:opacity-50 w-full sm:w-auto text-xs sm:text-sm",children:[r.jsx(Fi,{className:`w-3 h-3 sm:w-4 sm:h-4 mr-2 ${c?"animate-spin":""}`}),c?"Refreshing...":"Refresh Data"]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-3 md:gap-4 mb-6",children:[r.jsxs("div",{className:"bg-white rounded-lg p-3 md:p-4 shadow-sm border border-slate-200",children:[r.jsxs("div",{className:"flex items-center mb-3",children:[r.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 bg-gradient-to-r from-blue-100 to-blue-200 rounded-md flex items-center justify-center mr-2",children:r.jsx(pn,{className:"w-3 h-3 md:w-4 md:h-4 text-blue-600"})}),r.jsx("h3",{className:"font-semibold text-slate-800 text-sm md:text-base",children:"Today's Attendance"})]}),r.jsxs("div",{className:"space-y-1 mb-3",children:[r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-slate-600",children:"Present Today:"}),r.jsx("span",{className:"font-bold text-green-600",children:n?.attendance?.present||0})]}),r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-slate-600",children:"Absent Today:"}),r.jsx("span",{className:"font-bold text-red-600",children:n?.attendance?.absent||0})]}),r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-slate-600",children:"On Leave:"}),r.jsx("span",{className:"font-bold text-orange-600",children:n?.attendance?.onLeave||0})]})]}),r.jsxs("button",{onClick:y,className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-1.5 px-3 rounded-md font-medium flex items-center justify-center transition-all duration-300 text-xs",children:["Go to Attendance",r.jsx(rm,{className:"w-3 h-3 ml-1"})]})]}),r.jsxs("div",{className:"bg-white rounded-lg p-3 md:p-4 shadow-sm border border-slate-200",children:[r.jsxs("div",{className:"flex items-center mb-3",children:[r.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 bg-gradient-to-r from-green-100 to-green-200 rounded-md flex items-center justify-center mr-2",children:r.jsx(Js,{className:"w-3 h-3 md:w-4 md:h-4 text-green-600"})}),r.jsx("h3",{className:"font-semibold text-slate-800 text-sm md:text-base",children:"Leaves Summary"})]}),r.jsxs("div",{className:"space-y-1 mb-3",children:[r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-slate-600",children:"Pending Leaves:"}),r.jsx("span",{className:"font-bold text-yellow-600",children:n?.leaves?.pending||0})]}),r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-slate-600",children:"Approved:"}),r.jsx("span",{className:"font-bold text-green-600",children:n?.leaves?.approved||0})]}),r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-slate-600",children:"Rejected:"}),r.jsx("span",{className:"font-bold text-red-600",children:n?.leaves?.rejected||0})]})]}),r.jsxs("button",{onClick:v,className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-1.5 px-3 rounded-md font-medium flex items-center justify-center transition-all duration-300 text-xs",children:["Go to Leaves",r.jsx(rm,{className:"w-3 h-3 ml-1"})]})]}),r.jsxs("div",{className:"bg-white rounded-lg p-3 md:p-4 shadow-sm border border-slate-200",children:[r.jsxs("div",{className:"flex items-center mb-3",children:[r.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 bg-gradient-to-r from-purple-100 to-purple-200 rounded-md flex items-center justify-center mr-2",children:r.jsx(TC,{className:"w-3 h-3 md:w-4 md:h-4 text-purple-600"})}),r.jsx("h3",{className:"font-semibold text-slate-800 text-sm md:text-base",children:"Payroll Summary"})]}),r.jsxs("div",{className:"space-y-1 mb-3",children:[r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-slate-600",children:"Employees:"}),r.jsx("span",{className:"font-bold text-slate-800",children:n?.payroll?.employees||0})]}),r.jsxs("div",{className:"flex justify-between text-xs",children:[r.jsx("span",{className:"text-slate-600",children:"Status:"}),r.jsx("span",{className:"font-bold text-blue-600",children:n?.payroll?.status||"Not available"})]})]}),r.jsxs("button",{onClick:w,className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-1.5 px-3 rounded-md font-medium flex items-center justify-center transition-all duration-300 text-xs",children:["Go to Payroll",r.jsx(rm,{className:"w-3 h-3 ml-1"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-lg p-3 md:p-4 shadow-sm border border-slate-200 mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h2",{className:"text-sm md:text-base font-semibold text-slate-800",children:"Log in/Out"}),r.jsx(pn,{className:"w-4 h-4 text-slate-400"})]}),r.jsx("div",{className:"block md:hidden space-y-4",children:t.map((N,j)=>r.jsxs("div",{className:"bg-white rounded-lg p-4 border border-slate-200 shadow-sm hover:shadow-md transition-shadow duration-200",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Name"}),r.jsx("p",{className:"text-sm font-medium text-slate-900",children:N.name})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Team"}),r.jsx("p",{className:"text-sm text-slate-700",children:N.team})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Login"}),r.jsx("p",{className:"text-sm text-slate-700",children:A(N.checkIn)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Logout"}),r.jsx("p",{className:"text-sm text-slate-700",children:A(N.checkOut)})]})]}),r.jsxs("div",{className:"space-y-2 mb-3 bg-slate-50 p-3 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Task"}),r.jsx("p",{className:"text-sm text-slate-700",children:N.task||"-"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Work Progress"}),r.jsx("p",{className:"text-sm text-slate-700",children:N.workProgress||"-"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Logout Notes"}),r.jsx("p",{className:"text-sm text-slate-700",children:N.notes||"-"})]})]}),r.jsx("div",{className:"flex justify-start items-center mb-3",children:r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${N.status==="Logged in"?"bg-green-100 text-green-800":N.status==="Pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:N.status})}),N.action==="Approve"&&r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:()=>p(N._id),className:"flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg text-sm font-medium flex items-center justify-center gap-2",children:[r.jsx(bs,{className:"w-4 h-4"})," Approve"]}),r.jsxs("button",{onClick:()=>x(N._id),className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg text-sm font-medium flex items-center justify-center gap-2",children:[r.jsx(Ks,{className:"w-4 h-4"})," Reject"]})]})]},j))}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full border-collapse min-w-[600px]",children:[r.jsx("thead",{className:"bg-[#104774] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Name"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Team"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Login"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Logout"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Task"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Work Progress"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Logout Notes"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Status"}),r.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-semibold uppercase",children:"Action"})]})}),r.jsx("tbody",{children:t.map((N,j)=>r.jsxs("tr",{className:`${j%2===0?"bg-white":"bg-slate-50"} hover:bg-slate-100`,children:[r.jsx("td",{className:"px-2 py-1.5 text-xs font-medium text-slate-800 max-w-[100px] truncate",children:N.name}),r.jsx("td",{className:"px-2 py-1.5 text-xs text-slate-600 max-w-[80px] truncate",children:N.team}),r.jsx("td",{className:"px-2 py-1.5 text-xs text-slate-600",children:A(N.checkIn)}),r.jsx("td",{className:"px-2 py-1.5 text-xs text-slate-600",children:A(N.checkOut)}),r.jsx("td",{className:"px-2 py-1.5 text-xs text-slate-600 max-w-[120px] truncate",children:N.task||"-"}),r.jsx("td",{className:"px-2 py-1.5 text-xs text-slate-600 max-w-[120px] truncate",children:N.workProgress||"-"}),r.jsx("td",{className:"px-2 py-1.5 text-xs text-slate-600 max-w-[120px] truncate",children:N.notes||"-"}),r.jsx("td",{className:"px-2 py-1.5",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N.status==="Logged in"?"bg-green-100 text-green-700":N.status==="Pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:N.status})}),r.jsx("td",{className:"px-2 py-1.5",children:N.action==="Approve"&&r.jsxs("div",{className:"flex gap-1",children:[r.jsxs("button",{onClick:()=>p(N._id),className:"bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded text-xs font-medium flex items-center gap-1",children:[r.jsx(bs,{className:"w-3 h-3"})," Approve"]}),r.jsxs("button",{onClick:()=>x(N._id),className:"bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-xs font-medium flex items-center gap-1",children:[r.jsx(Ks,{className:"w-3 h-3"})," Reject"]})]})})]},j))})]})})]})]})},JP=()=>{const[n,e]=E.useState(""),[t,s]=E.useState(""),[i,l]=E.useState(""),[c,u]=E.useState(""),[h,m]=E.useState(!1),[p,x]=E.useState(!1),[y,v]=E.useState(!1),[w,A]=E.useState(""),[N,j]=E.useState(""),[_,C]=E.useState(1),{requestPasswordReset:k,verifyOtp:D,resetPassword:P}=rs(),F=async H=>{if(H.preventDefault(),A(""),j(""),v(!0),!n){A("Please enter your email address"),v(!1);return}if(!n.includes("@")){A("Please enter a valid email address"),v(!1);return}try{await k(n),j("OTP has been sent to your email"),C(2)}catch(X){A(X.response?.data?.message||"Failed to send OTP")}finally{v(!1)}},U=async H=>{if(H.preventDefault(),A(""),j(""),v(!0),!t||t.length!==6){A("Please enter a valid 6-digit OTP"),v(!1);return}try{await D(n,t),j("OTP verified successfully"),C(3)}catch(X){A(X.response?.data?.message||"Invalid OTP")}finally{v(!1)}},I=async H=>{if(H.preventDefault(),A(""),j(""),v(!0),!i||!c){A("Please fill in all fields"),v(!1);return}if(i!==c){A("Passwords do not match"),v(!1);return}if(i.length<6){A("Password must be at least 6 characters long"),v(!1);return}try{await P(n,t,i),j("Password has been reset successfully"),setTimeout(()=>{window.location.href="/login"},2e3)}catch(X){A(X.response?.data?.message||"Failed to reset password")}finally{v(!1)}},K=()=>{_===1?window.location.href="/login":(C(_-1),A(""),j(""))};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 flex items-center justify-center px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"max-w-md w-full space-y-8",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto h-16 w-16 bg-[#104774] rounded-full flex items-center justify-center mb-4",children:r.jsx($r,{className:"h-8 w-8 text-white"})}),r.jsxs("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:[_===1&&"Reset Your Password",_===2&&"Enter OTP",_===3&&"Create New Password"]}),r.jsxs("p",{className:"text-gray-600",children:[_===1&&"Enter your email to receive a verification code",_===2&&"Enter the 6-digit code sent to your email",_===3&&"Enter your new password"]})]}),r.jsxs("button",{onClick:K,className:"flex items-center text-sm text-[#104774] hover:text-[#0d385d] font-medium transition-colors duration-200",children:[r.jsx(cC,{className:"h-4 w-4 mr-1"}),"Back"]}),r.jsx("div",{className:"bg-white py-8 px-6 shadow-xl rounded-xl border border-gray-100",children:r.jsxs("form",{onSubmit:_===1?F:_===2?U:I,className:"space-y-6",children:[w&&r.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[r.jsx(ns,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),r.jsx("span",{className:"text-sm text-red-700",children:w})]}),N&&r.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[r.jsx(bs,{className:"h-5 w-5 text-green-500 flex-shrink-0"}),r.jsx("span",{className:"text-sm text-green-700",children:N})]}),_===1&&r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email address"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(o1,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] focus:border-[#104774] focus:z-10 sm:text-sm transition-colors duration-200",placeholder:"Enter your email",value:n,onChange:H=>e(H.target.value),disabled:y})]})]}),_===2&&r.jsxs("div",{children:[r.jsx("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700 mb-2",children:"Verification Code"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx($r,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"otp",name:"otp",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:"6",autoComplete:"one-time-code",required:!0,className:"appearance-none relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] focus:border-[#104774] focus:z-10 sm:text-sm transition-colors duration-200 tracking-widest",placeholder:"Enter 6-digit code",value:t,onChange:H=>{const X=H.target.value.replace(/\D/g,"");s(X.slice(0,6))},disabled:y})]}),r.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Enter the 6-digit code sent to ",n]})]}),_===3&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx($r,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"password",name:"password",type:h?"text":"password",autoComplete:"new-password",required:!0,className:"appearance-none relative block w-full pl-10 pr-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] focus:border-[#104774] focus:z-10 sm:text-sm transition-colors duration-200",placeholder:"Enter new password",value:i,onChange:H=>l(H.target.value),disabled:y}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>m(!h),disabled:y,children:h?r.jsx(Wm,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):r.jsx(To,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx($r,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:p?"text":"password",autoComplete:"new-password",required:!0,className:"appearance-none relative block w-full pl-10 pr-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] focus:border-[#104774] focus:z-10 sm:text-sm transition-colors duration-200",placeholder:"Confirm new password",value:c,onChange:H=>u(H.target.value),disabled:y}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>x(!p),disabled:y,children:p?r.jsx(Wm,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):r.jsx(To,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]})]}),r.jsx("div",{children:r.jsx("button",{type:"submit",disabled:y,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-[#104774] hover:bg-[#0d385d] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#104774] disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105 active:scale-95",children:y?r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),r.jsx("span",{children:_===1?"Sending OTP...":_===2?"Verifying...":"Resetting..."})]}):r.jsxs(r.Fragment,{children:[_===1&&"Send OTP",_===2&&"Verify OTP",_===3&&"Reset Password"]})})})]})}),r.jsx("div",{className:"text-center",children:r.jsxs("p",{className:"text-sm text-gray-600",children:["Remember your password?"," ",r.jsx("a",{href:"/login",className:"font-medium text-[#104774] hover:text-[#0d385d] transition-colors duration-200",children:"Sign in"})]})})]})})};function eI(){const{user:n,loading:e}=rs();return r.jsx(g_,{children:r.jsxs(YE,{children:[r.jsx(gt,{path:"/login",element:r.jsx(KC,{})}),r.jsx(gt,{path:"/forgot-password",element:r.jsx(JP,{})}),r.jsxs(gt,{path:"/admin",element:r.jsx(ym,{allowedRoles:["admin"],children:r.jsx(eT,{})}),children:[r.jsx(gt,{index:!0,element:r.jsx(r.Fragment,{children:r.jsx(KP,{})})}),r.jsx(gt,{path:"manage-employees",element:r.jsx(rv,{})}),r.jsx(gt,{path:"profile",element:r.jsx(bm,{})}),r.jsx(gt,{path:"calendar",element:r.jsx(Im,{})}),r.jsx(gt,{path:"leaves",element:r.jsx(RP,{})}),r.jsx(gt,{path:"attendance",element:r.jsx(zP,{})}),r.jsx(gt,{path:"payroll-approval",element:r.jsx(WP,{})})]}),r.jsxs(gt,{path:"/hr",element:r.jsx(ym,{allowedRoles:["hr"],children:r.jsx(tT,{})}),children:[r.jsx(gt,{index:!0,element:r.jsx(r.Fragment,{children:r.jsx(ZP,{})})}),r.jsx(gt,{path:"manage-employees",element:r.jsx(rv,{})}),r.jsx(gt,{path:"profile",element:r.jsx(bm,{})}),r.jsx(gt,{path:"calendar",element:r.jsx(Im,{})}),r.jsx(gt,{path:"leaves",element:r.jsx(jO,{})}),r.jsx(gt,{path:"attendance",element:r.jsx(IP,{})}),r.jsx(gt,{path:"payroll",element:r.jsx(GP,{})})]}),r.jsxs(gt,{path:"/employee",element:r.jsx(ym,{allowedRoles:["employee"],children:r.jsx(sT,{})}),children:[r.jsx(gt,{index:!0,element:r.jsx(r.Fragment,{children:r.jsx(QP,{})})}),r.jsx(gt,{path:"profile",element:r.jsx(bm,{})}),r.jsx(gt,{path:"calendar",element:r.jsx(Im,{})}),r.jsx(gt,{path:"leaves",element:r.jsx(NO,{})}),r.jsx(gt,{path:"attendance",element:r.jsx(LP,{})}),r.jsx(gt,{path:"payslip",element:r.jsx(UP,{})})]}),r.jsx(gt,{path:"/",element:n===null&&e?r.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading..."}):n?n.role==="admin"?r.jsx(pa,{to:"/admin",replace:!0}):n.role==="hr"?r.jsx(pa,{to:"/hr",replace:!0}):r.jsx(pa,{to:"/employee",replace:!0}):r.jsx(pa,{to:"/login",replace:!0})}),r.jsx(gt,{path:"*",element:r.jsx(pa,{to:"/"})})]})})}tE.createRoot(document.getElementById("root")).render(r.jsx(E.StrictMode,{children:r.jsx(sC,{children:r.jsx(eI,{})})}));
