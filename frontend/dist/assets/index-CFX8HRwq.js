var rb=n=>{throw TypeError(n)};var Yf=(n,e,t)=>e.has(n)||rb("Cannot "+t);var Et=(n,e,t)=>(Yf(n,e,"read from private field"),t?t.call(n):e.get(n)),Hn=(n,e,t)=>e.has(n)?rb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Ls=(n,e,t,s)=>(Yf(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),zn=(n,e,t)=>(Yf(n,e,"access private method"),t);var lb=(n,e,t,s)=>({set _(i){Ls(n,e,i,t)},get _(){return Et(n,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(i){if(i.ep)return;i.ep=!0;const l=t(i);fetch(i.href,l)}})();function Yj(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Wf={exports:{}},so={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ob;function Wj(){if(ob)return so;ob=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,i,l){var c=null;if(l!==void 0&&(c=""+l),i.key!==void 0&&(c=""+i.key),"key"in i){l={};for(var u in i)u!=="key"&&(l[u]=i[u])}else l=i;return i=l.ref,{$$typeof:n,type:s,key:c,ref:i!==void 0?i:null,props:l}}return so.Fragment=e,so.jsx=t,so.jsxs=t,so}var cb;function Xj(){return cb||(cb=1,Wf.exports=Wj()),Wf.exports}var r=Xj(),Xf={exports:{}},We={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var db;function Qj(){if(db)return We;db=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),x=Symbol.iterator;function y(T){return T===null||typeof T!="object"?null:(T=x&&T[x]||T["@@iterator"],typeof T=="function"?T:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,A={};function N(T,V,M){this.props=T,this.context=V,this.refs=A,this.updater=M||v}N.prototype.isReactComponent={},N.prototype.setState=function(T,V){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,V,"setState")},N.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function S(){}S.prototype=N.prototype;function E(T,V,M){this.props=T,this.context=V,this.refs=A,this.updater=M||v}var C=E.prototype=new S;C.constructor=E,w(C,N.prototype),C.isPureReactComponent=!0;var R=Array.isArray,D={H:null,A:null,T:null,S:null,V:null},O=Object.prototype.hasOwnProperty;function H(T,V,M,G,de,re){return M=re.ref,{$$typeof:n,type:T,key:V,ref:M!==void 0?M:null,props:re}}function F(T,V){return H(T.type,V,void 0,void 0,void 0,T.props)}function P(T){return typeof T=="object"&&T!==null&&T.$$typeof===n}function Z(T){var V={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(M){return V[M]})}var z=/\/+/g;function K(T,V){return typeof T=="object"&&T!==null&&T.key!=null?Z(""+T.key):V.toString(36)}function W(){}function ce(T){switch(T.status){case"fulfilled":return T.value;case"rejected":throw T.reason;default:switch(typeof T.status=="string"?T.then(W,W):(T.status="pending",T.then(function(V){T.status==="pending"&&(T.status="fulfilled",T.value=V)},function(V){T.status==="pending"&&(T.status="rejected",T.reason=V)})),T.status){case"fulfilled":return T.value;case"rejected":throw T.reason}}throw T}function me(T,V,M,G,de){var re=typeof T;(re==="undefined"||re==="boolean")&&(T=null);var ye=!1;if(T===null)ye=!0;else switch(re){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(T.$$typeof){case n:case e:ye=!0;break;case p:return ye=T._init,me(ye(T._payload),V,M,G,de)}}if(ye)return de=de(T),ye=G===""?"."+K(T,0):G,R(de)?(M="",ye!=null&&(M=ye.replace(z,"$&/")+"/"),me(de,V,M,"",function(he){return he})):de!=null&&(P(de)&&(de=F(de,M+(de.key==null||T&&T.key===de.key?"":(""+de.key).replace(z,"$&/")+"/")+ye)),V.push(de)),1;ye=0;var je=G===""?".":G+":";if(R(T))for(var Le=0;Le<T.length;Le++)G=T[Le],re=je+K(G,Le),ye+=me(G,V,M,re,de);else if(Le=y(T),typeof Le=="function")for(T=Le.call(T),Le=0;!(G=T.next()).done;)G=G.value,re=je+K(G,Le++),ye+=me(G,V,M,re,de);else if(re==="object"){if(typeof T.then=="function")return me(ce(T),V,M,G,de);throw V=String(T),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return ye}function L(T,V,M){if(T==null)return T;var G=[],de=0;return me(T,G,"","",function(re){return V.call(M,re,de++)}),G}function q(T){if(T._status===-1){var V=T._result;V=V(),V.then(function(M){(T._status===0||T._status===-1)&&(T._status=1,T._result=M)},function(M){(T._status===0||T._status===-1)&&(T._status=2,T._result=M)}),T._status===-1&&(T._status=0,T._result=V)}if(T._status===1)return T._result.default;throw T._result}var $=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",T);return}console.error(T)};function I(){}return We.Children={map:L,forEach:function(T,V,M){L(T,function(){V.apply(this,arguments)},M)},count:function(T){var V=0;return L(T,function(){V++}),V},toArray:function(T){return L(T,function(V){return V})||[]},only:function(T){if(!P(T))throw Error("React.Children.only expected to receive a single React element child.");return T}},We.Component=N,We.Fragment=t,We.Profiler=i,We.PureComponent=E,We.StrictMode=s,We.Suspense=h,We.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,We.__COMPILER_RUNTIME={__proto__:null,c:function(T){return D.H.useMemoCache(T)}},We.cache=function(T){return function(){return T.apply(null,arguments)}},We.cloneElement=function(T,V,M){if(T==null)throw Error("The argument must be a React element, but you passed "+T+".");var G=w({},T.props),de=T.key,re=void 0;if(V!=null)for(ye in V.ref!==void 0&&(re=void 0),V.key!==void 0&&(de=""+V.key),V)!O.call(V,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&V.ref===void 0||(G[ye]=V[ye]);var ye=arguments.length-2;if(ye===1)G.children=M;else if(1<ye){for(var je=Array(ye),Le=0;Le<ye;Le++)je[Le]=arguments[Le+2];G.children=je}return H(T.type,de,void 0,void 0,re,G)},We.createContext=function(T){return T={$$typeof:c,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null},T.Provider=T,T.Consumer={$$typeof:l,_context:T},T},We.createElement=function(T,V,M){var G,de={},re=null;if(V!=null)for(G in V.key!==void 0&&(re=""+V.key),V)O.call(V,G)&&G!=="key"&&G!=="__self"&&G!=="__source"&&(de[G]=V[G]);var ye=arguments.length-2;if(ye===1)de.children=M;else if(1<ye){for(var je=Array(ye),Le=0;Le<ye;Le++)je[Le]=arguments[Le+2];de.children=je}if(T&&T.defaultProps)for(G in ye=T.defaultProps,ye)de[G]===void 0&&(de[G]=ye[G]);return H(T,re,void 0,void 0,null,de)},We.createRef=function(){return{current:null}},We.forwardRef=function(T){return{$$typeof:u,render:T}},We.isValidElement=P,We.lazy=function(T){return{$$typeof:p,_payload:{_status:-1,_result:T},_init:q}},We.memo=function(T,V){return{$$typeof:m,type:T,compare:V===void 0?null:V}},We.startTransition=function(T){var V=D.T,M={};D.T=M;try{var G=T(),de=D.S;de!==null&&de(M,G),typeof G=="object"&&G!==null&&typeof G.then=="function"&&G.then(I,$)}catch(re){$(re)}finally{D.T=V}},We.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},We.use=function(T){return D.H.use(T)},We.useActionState=function(T,V,M){return D.H.useActionState(T,V,M)},We.useCallback=function(T,V){return D.H.useCallback(T,V)},We.useContext=function(T){return D.H.useContext(T)},We.useDebugValue=function(){},We.useDeferredValue=function(T,V){return D.H.useDeferredValue(T,V)},We.useEffect=function(T,V,M){var G=D.H;if(typeof M=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return G.useEffect(T,V)},We.useId=function(){return D.H.useId()},We.useImperativeHandle=function(T,V,M){return D.H.useImperativeHandle(T,V,M)},We.useInsertionEffect=function(T,V){return D.H.useInsertionEffect(T,V)},We.useLayoutEffect=function(T,V){return D.H.useLayoutEffect(T,V)},We.useMemo=function(T,V){return D.H.useMemo(T,V)},We.useOptimistic=function(T,V){return D.H.useOptimistic(T,V)},We.useReducer=function(T,V,M){return D.H.useReducer(T,V,M)},We.useRef=function(T){return D.H.useRef(T)},We.useState=function(T){return D.H.useState(T)},We.useSyncExternalStore=function(T,V,M){return D.H.useSyncExternalStore(T,V,M)},We.useTransition=function(){return D.H.useTransition()},We.version="19.1.1",We}var ub;function yp(){return ub||(ub=1,Xf.exports=Qj()),Xf.exports}var _=yp();const Eo=Yj(_);var Qf={exports:{}},no={},Zf={exports:{}},Kf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hb;function Zj(){return hb||(hb=1,(function(n){function e(L,q){var $=L.length;L.push(q);e:for(;0<$;){var I=$-1>>>1,T=L[I];if(0<i(T,q))L[I]=q,L[$]=T,$=I;else break e}}function t(L){return L.length===0?null:L[0]}function s(L){if(L.length===0)return null;var q=L[0],$=L.pop();if($!==q){L[0]=$;e:for(var I=0,T=L.length,V=T>>>1;I<V;){var M=2*(I+1)-1,G=L[M],de=M+1,re=L[de];if(0>i(G,$))de<T&&0>i(re,G)?(L[I]=re,L[de]=$,I=de):(L[I]=G,L[M]=$,I=M);else if(de<T&&0>i(re,$))L[I]=re,L[de]=$,I=de;else break e}}return q}function i(L,q){var $=L.sortIndex-q.sortIndex;return $!==0?$:L.id-q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();n.unstable_now=function(){return c.now()-u}}var h=[],m=[],p=1,x=null,y=3,v=!1,w=!1,A=!1,N=!1,S=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function R(L){for(var q=t(m);q!==null;){if(q.callback===null)s(m);else if(q.startTime<=L)s(m),q.sortIndex=q.expirationTime,e(h,q);else break;q=t(m)}}function D(L){if(A=!1,R(L),!w)if(t(h)!==null)w=!0,O||(O=!0,K());else{var q=t(m);q!==null&&me(D,q.startTime-L)}}var O=!1,H=-1,F=5,P=-1;function Z(){return N?!0:!(n.unstable_now()-P<F)}function z(){if(N=!1,O){var L=n.unstable_now();P=L;var q=!0;try{e:{w=!1,A&&(A=!1,E(H),H=-1),v=!0;var $=y;try{t:{for(R(L),x=t(h);x!==null&&!(x.expirationTime>L&&Z());){var I=x.callback;if(typeof I=="function"){x.callback=null,y=x.priorityLevel;var T=I(x.expirationTime<=L);if(L=n.unstable_now(),typeof T=="function"){x.callback=T,R(L),q=!0;break t}x===t(h)&&s(h),R(L)}else s(h);x=t(h)}if(x!==null)q=!0;else{var V=t(m);V!==null&&me(D,V.startTime-L),q=!1}}break e}finally{x=null,y=$,v=!1}q=void 0}}finally{q?K():O=!1}}}var K;if(typeof C=="function")K=function(){C(z)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,ce=W.port2;W.port1.onmessage=z,K=function(){ce.postMessage(null)}}else K=function(){S(z,0)};function me(L,q){H=S(function(){L(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(L){L.callback=null},n.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<L?Math.floor(1e3/L):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_next=function(L){switch(y){case 1:case 2:case 3:var q=3;break;default:q=y}var $=y;y=q;try{return L()}finally{y=$}},n.unstable_requestPaint=function(){N=!0},n.unstable_runWithPriority=function(L,q){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var $=y;y=L;try{return q()}finally{y=$}},n.unstable_scheduleCallback=function(L,q,$){var I=n.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?I+$:I):$=I,L){case 1:var T=-1;break;case 2:T=250;break;case 5:T=1073741823;break;case 4:T=1e4;break;default:T=5e3}return T=$+T,L={id:p++,callback:q,priorityLevel:L,startTime:$,expirationTime:T,sortIndex:-1},$>I?(L.sortIndex=$,e(m,L),t(h)===null&&L===t(m)&&(A?(E(H),H=-1):A=!0,me(D,$-I))):(L.sortIndex=T,e(h,L),w||v||(w=!0,O||(O=!0,K()))),L},n.unstable_shouldYield=Z,n.unstable_wrapCallback=function(L){var q=y;return function(){var $=y;y=q;try{return L.apply(this,arguments)}finally{y=$}}}})(Kf)),Kf}var fb;function Kj(){return fb||(fb=1,Zf.exports=Zj()),Zf.exports}var Jf={exports:{}},gs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mb;function Jj(){if(mb)return gs;mb=1;var n=yp();function e(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)m+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function l(h,m,p){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:x==null?null:""+x,children:h,containerInfo:m,implementation:p}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return gs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,gs.createPortal=function(h,m){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(h,m,null,p)},gs.flushSync=function(h){var m=c.T,p=s.p;try{if(c.T=null,s.p=2,h)return h()}finally{c.T=m,s.p=p,s.d.f()}},gs.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(h,m))},gs.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},gs.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var p=m.as,x=u(p,m.crossOrigin),y=typeof m.integrity=="string"?m.integrity:void 0,v=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;p==="style"?s.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:v}):p==="script"&&s.d.X(h,{crossOrigin:x,integrity:y,fetchPriority:v,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},gs.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var p=u(m.as,m.crossOrigin);s.d.M(h,{crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(h)},gs.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var p=m.as,x=u(p,m.crossOrigin);s.d.L(h,p,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},gs.preloadModule=function(h,m){if(typeof h=="string")if(m){var p=u(m.as,m.crossOrigin);s.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(h)},gs.requestFormReset=function(h){s.d.r(h)},gs.unstable_batchedUpdates=function(h,m){return h(m)},gs.useFormState=function(h,m,p){return c.H.useFormState(h,m,p)},gs.useFormStatus=function(){return c.H.useHostTransitionStatus()},gs.version="19.1.1",gs}var pb;function vw(){if(pb)return Jf.exports;pb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Jf.exports=Jj(),Jf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gb;function eE(){if(gb)return no;gb=1;var n=Kj(),e=yp(),t=vw();function s(a){var o="https://react.dev/errors/"+a;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+a+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var o=a,d=a;if(a.alternate)for(;o.return;)o=o.return;else{a=o;do o=a,(o.flags&4098)!==0&&(d=o.return),a=o.return;while(a)}return o.tag===3?d:null}function c(a){if(a.tag===13){var o=a.memoizedState;if(o===null&&(a=a.alternate,a!==null&&(o=a.memoizedState)),o!==null)return o.dehydrated}return null}function u(a){if(l(a)!==a)throw Error(s(188))}function h(a){var o=a.alternate;if(!o){if(o=l(a),o===null)throw Error(s(188));return o!==a?null:a}for(var d=a,f=o;;){var g=d.return;if(g===null)break;var b=g.alternate;if(b===null){if(f=g.return,f!==null){d=f;continue}break}if(g.child===b.child){for(b=g.child;b;){if(b===d)return u(g),a;if(b===f)return u(g),o;b=b.sibling}throw Error(s(188))}if(d.return!==f.return)d=g,f=b;else{for(var j=!1,k=g.child;k;){if(k===d){j=!0,d=g,f=b;break}if(k===f){j=!0,f=g,d=b;break}k=k.sibling}if(!j){for(k=b.child;k;){if(k===d){j=!0,d=b,f=g;break}if(k===f){j=!0,f=b,d=g;break}k=k.sibling}if(!j)throw Error(s(189))}}if(d.alternate!==f)throw Error(s(190))}if(d.tag!==3)throw Error(s(188));return d.stateNode.current===d?a:o}function m(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a;for(a=a.child;a!==null;){if(o=m(a),o!==null)return o;a=a.sibling}return null}var p=Object.assign,x=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),E=Symbol.for("react.consumer"),C=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function K(a){return a===null||typeof a!="object"?null:(a=z&&a[z]||a["@@iterator"],typeof a=="function"?a:null)}var W=Symbol.for("react.client.reference");function ce(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===W?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case w:return"Fragment";case N:return"Profiler";case A:return"StrictMode";case D:return"Suspense";case O:return"SuspenseList";case P:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case v:return"Portal";case C:return(a.displayName||"Context")+".Provider";case E:return(a._context.displayName||"Context")+".Consumer";case R:var o=a.render;return a=a.displayName,a||(a=o.displayName||o.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case H:return o=a.displayName||null,o!==null?o:ce(a.type)||"Memo";case F:o=a._payload,a=a._init;try{return ce(a(o))}catch{}}return null}var me=Array.isArray,L=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},I=[],T=-1;function V(a){return{current:a}}function M(a){0>T||(a.current=I[T],I[T]=null,T--)}function G(a,o){T++,I[T]=a.current,a.current=o}var de=V(null),re=V(null),ye=V(null),je=V(null);function Le(a,o){switch(G(ye,o),G(re,a),G(de,null),o.nodeType){case 9:case 11:a=(a=o.documentElement)&&(a=a.namespaceURI)?Ly(a):0;break;default:if(a=o.tagName,o=o.namespaceURI)o=Ly(o),a=Oy(o,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}M(de),G(de,a)}function he(){M(de),M(re),M(ye)}function $e(a){a.memoizedState!==null&&G(je,a);var o=de.current,d=Oy(o,a.type);o!==d&&(G(re,a),G(de,d))}function ge(a){re.current===a&&(M(de),M(re)),je.current===a&&(M(je),Zl._currentValue=$)}var we=Object.prototype.hasOwnProperty,ke=n.unstable_scheduleCallback,te=n.unstable_cancelCallback,be=n.unstable_shouldYield,ve=n.unstable_requestPaint,Ee=n.unstable_now,Ye=n.unstable_getCurrentPriorityLevel,J=n.unstable_ImmediatePriority,Se=n.unstable_UserBlockingPriority,Ie=n.unstable_NormalPriority,Xe=n.unstable_LowPriority,wt=n.unstable_IdlePriority,qt=n.log,oe=n.unstable_setDisableYieldValue,Ne=null,_e=null;function Ue(a){if(typeof qt=="function"&&oe(a),_e&&typeof _e.setStrictMode=="function")try{_e.setStrictMode(Ne,a)}catch{}}var dt=Math.clz32?Math.clz32:Rt,Qt=Math.log,Qn=Math.LN2;function Rt(a){return a>>>=0,a===0?32:31-(Qt(a)/Qn|0)|0}var en=256,zs=4194304;function vs(a){var o=a&42;if(o!==0)return o;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function gn(a,o,d){var f=a.pendingLanes;if(f===0)return 0;var g=0,b=a.suspendedLanes,j=a.pingedLanes;a=a.warmLanes;var k=f&134217727;return k!==0?(f=k&~b,f!==0?g=vs(f):(j&=k,j!==0?g=vs(j):d||(d=k&~a,d!==0&&(g=vs(d))))):(k=f&~b,k!==0?g=vs(k):j!==0?g=vs(j):d||(d=f&~a,d!==0&&(g=vs(d)))),g===0?0:o!==0&&o!==g&&(o&b)===0&&(b=g&-g,d=o&-o,b>=d||b===32&&(d&4194048)!==0)?o:g}function Fs(a,o){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&o)===0}function ii(a,o){switch(a){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ri(){var a=en;return en<<=1,(en&4194048)===0&&(en=256),a}function xn(){var a=zs;return zs<<=1,(zs&62914560)===0&&(zs=4194304),a}function Ji(a){for(var o=[],d=0;31>d;d++)o.push(a);return o}function Us(a,o){a.pendingLanes|=o,o!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function er(a,o,d,f,g,b){var j=a.pendingLanes;a.pendingLanes=d,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=d,a.entangledLanes&=d,a.errorRecoveryDisabledLanes&=d,a.shellSuspendCounter=0;var k=a.entanglements,B=a.expirationTimes,ee=a.hiddenUpdates;for(d=j&~d;0<d;){var ue=31-dt(d),pe=1<<ue;k[ue]=0,B[ue]=-1;var se=ee[ue];if(se!==null)for(ee[ue]=null,ue=0;ue<se.length;ue++){var ne=se[ue];ne!==null&&(ne.lane&=-536870913)}d&=~pe}f!==0&&Hu(a,f,0),b!==0&&g===0&&a.tag!==0&&(a.suspendedLanes|=b&~(j&~o))}function Hu(a,o,d){a.pendingLanes|=o,a.suspendedLanes&=~o;var f=31-dt(o);a.entangledLanes|=o,a.entanglements[f]=a.entanglements[f]|1073741824|d&4194090}function li(a,o){var d=a.entangledLanes|=o;for(a=a.entanglements;d;){var f=31-dt(d),g=1<<f;g&o|a[f]&o&&(a[f]|=o),d&=~g}}function X(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Ae(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function De(){var a=q.p;return a!==0?a:(a=window.event,a===void 0?32:eb(a.type))}function Qe(a,o){var d=q.p;try{return q.p=a,o()}finally{q.p=d}}var At=Math.random().toString(36).slice(2),bt="__reactFiber$"+At,St="__reactProps$"+At,tn="__reactContainer$"+At,Cs="__reactEvents$"+At,yn="__reactListeners$"+At,qs="__reactHandles$"+At,Ts="__reactResources$"+At,bn="__reactMarker$"+At;function ms(a){delete a[bt],delete a[St],delete a[Cs],delete a[yn],delete a[qs]}function vn(a){var o=a[bt];if(o)return o;for(var d=a.parentNode;d;){if(o=d[tn]||d[bt]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(a=Hy(a);a!==null;){if(d=a[bt])return d;a=Hy(a)}return o}a=d,d=a.parentNode}return null}function Mn(a){if(a=a[bt]||a[tn]){var o=a.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return a}return null}function wa(a){var o=a.tag;if(o===5||o===26||o===27||o===6)return a.stateNode;throw Error(s(33))}function tr(a){var o=a[Ts];return o||(o=a[Ts]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function es(a){a[bn]=!0}var Ng=new Set,Sg={};function oi(a,o){sr(a,o),sr(a+"Capture",o)}function sr(a,o){for(Sg[a]=o,a=0;a<o.length;a++)Ng.add(o[a])}var HN=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),jg={},Eg={};function zN(a){return we.call(Eg,a)?!0:we.call(jg,a)?!1:HN.test(a)?Eg[a]=!0:(jg[a]=!0,!1)}function ec(a,o,d){if(zN(o))if(d===null)a.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":a.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(o);return}}a.setAttribute(o,""+d)}}function tc(a,o,d){if(d===null)a.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttribute(o,""+d)}}function Zn(a,o,d,f){if(f===null)a.removeAttribute(d);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(d);return}a.setAttributeNS(o,d,""+f)}}var zu,_g;function nr(a){if(zu===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);zu=o&&o[1]||"",_g=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zu+a+_g}var Fu=!1;function Uu(a,o){if(!a||Fu)return"";Fu=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var pe=function(){throw Error()};if(Object.defineProperty(pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pe,[])}catch(ne){var se=ne}Reflect.construct(a,[],pe)}else{try{pe.call()}catch(ne){se=ne}a.call(pe.prototype)}}else{try{throw Error()}catch(ne){se=ne}(pe=a())&&typeof pe.catch=="function"&&pe.catch(function(){})}}catch(ne){if(ne&&se&&typeof ne.stack=="string")return[ne.stack,se.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=f.DetermineComponentFrameRoot(),j=b[0],k=b[1];if(j&&k){var B=j.split(`
`),ee=k.split(`
`);for(g=f=0;f<B.length&&!B[f].includes("DetermineComponentFrameRoot");)f++;for(;g<ee.length&&!ee[g].includes("DetermineComponentFrameRoot");)g++;if(f===B.length||g===ee.length)for(f=B.length-1,g=ee.length-1;1<=f&&0<=g&&B[f]!==ee[g];)g--;for(;1<=f&&0<=g;f--,g--)if(B[f]!==ee[g]){if(f!==1||g!==1)do if(f--,g--,0>g||B[f]!==ee[g]){var ue=`
`+B[f].replace(" at new "," at ");return a.displayName&&ue.includes("<anonymous>")&&(ue=ue.replace("<anonymous>",a.displayName)),ue}while(1<=f&&0<=g);break}}}finally{Fu=!1,Error.prepareStackTrace=d}return(d=a?a.displayName||a.name:"")?nr(d):""}function FN(a){switch(a.tag){case 26:case 27:case 5:return nr(a.type);case 16:return nr("Lazy");case 13:return nr("Suspense");case 19:return nr("SuspenseList");case 0:case 15:return Uu(a.type,!1);case 11:return Uu(a.type.render,!1);case 1:return Uu(a.type,!0);case 31:return nr("Activity");default:return""}}function Cg(a){try{var o="";do o+=FN(a),a=a.return;while(a);return o}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function sn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Tg(a){var o=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function UN(a){var o=Tg(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,o),f=""+a[o];if(!a.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var g=d.get,b=d.set;return Object.defineProperty(a,o,{configurable:!0,get:function(){return g.call(this)},set:function(j){f=""+j,b.call(this,j)}}),Object.defineProperty(a,o,{enumerable:d.enumerable}),{getValue:function(){return f},setValue:function(j){f=""+j},stopTracking:function(){a._valueTracker=null,delete a[o]}}}}function sc(a){a._valueTracker||(a._valueTracker=UN(a))}function Dg(a){if(!a)return!1;var o=a._valueTracker;if(!o)return!0;var d=o.getValue(),f="";return a&&(f=Tg(a)?a.checked?"true":"false":a.value),a=f,a!==d?(o.setValue(a),!0):!1}function nc(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var qN=/[\n"\\]/g;function nn(a){return a.replace(qN,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function qu(a,o,d,f,g,b,j,k){a.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?a.type=j:a.removeAttribute("type"),o!=null?j==="number"?(o===0&&a.value===""||a.value!=o)&&(a.value=""+sn(o)):a.value!==""+sn(o)&&(a.value=""+sn(o)):j!=="submit"&&j!=="reset"||a.removeAttribute("value"),o!=null?Vu(a,j,sn(o)):d!=null?Vu(a,j,sn(d)):f!=null&&a.removeAttribute("value"),g==null&&b!=null&&(a.defaultChecked=!!b),g!=null&&(a.checked=g&&typeof g!="function"&&typeof g!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?a.name=""+sn(k):a.removeAttribute("name")}function Rg(a,o,d,f,g,b,j,k){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(a.type=b),o!=null||d!=null){if(!(b!=="submit"&&b!=="reset"||o!=null))return;d=d!=null?""+sn(d):"",o=o!=null?""+sn(o):d,k||o===a.value||(a.value=o),a.defaultValue=o}f=f??g,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=k?a.checked:!!f,a.defaultChecked=!!f,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(a.name=j)}function Vu(a,o,d){o==="number"&&nc(a.ownerDocument)===a||a.defaultValue===""+d||(a.defaultValue=""+d)}function ar(a,o,d,f){if(a=a.options,o){o={};for(var g=0;g<d.length;g++)o["$"+d[g]]=!0;for(d=0;d<a.length;d++)g=o.hasOwnProperty("$"+a[d].value),a[d].selected!==g&&(a[d].selected=g),g&&f&&(a[d].defaultSelected=!0)}else{for(d=""+sn(d),o=null,g=0;g<a.length;g++){if(a[g].value===d){a[g].selected=!0,f&&(a[g].defaultSelected=!0);return}o!==null||a[g].disabled||(o=a[g])}o!==null&&(o.selected=!0)}}function kg(a,o,d){if(o!=null&&(o=""+sn(o),o!==a.value&&(a.value=o),d==null)){a.defaultValue!==o&&(a.defaultValue=o);return}a.defaultValue=d!=null?""+sn(d):""}function Mg(a,o,d,f){if(o==null){if(f!=null){if(d!=null)throw Error(s(92));if(me(f)){if(1<f.length)throw Error(s(93));f=f[0]}d=f}d==null&&(d=""),o=d}d=sn(o),a.defaultValue=d,f=a.textContent,f===d&&f!==""&&f!==null&&(a.value=f)}function ir(a,o){if(o){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=o;return}}a.textContent=o}var VN=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Lg(a,o,d){var f=o.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?f?a.setProperty(o,""):o==="float"?a.cssFloat="":a[o]="":f?a.setProperty(o,d):typeof d!="number"||d===0||VN.has(o)?o==="float"?a.cssFloat=d:a[o]=(""+d).trim():a[o]=d+"px"}function Og(a,o,d){if(o!=null&&typeof o!="object")throw Error(s(62));if(a=a.style,d!=null){for(var f in d)!d.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var g in o)f=o[g],o.hasOwnProperty(g)&&d[g]!==f&&Lg(a,g,f)}else for(var b in o)o.hasOwnProperty(b)&&Lg(a,b,o[b])}function $u(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $N=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),GN=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ac(a){return GN.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var Gu=null;function Yu(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var rr=null,lr=null;function Pg(a){var o=Mn(a);if(o&&(a=o.stateNode)){var d=a[St]||null;e:switch(a=o.stateNode,o.type){case"input":if(qu(a,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),o=d.name,d.type==="radio"&&o!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+nn(""+o)+'"][type="radio"]'),o=0;o<d.length;o++){var f=d[o];if(f!==a&&f.form===a.form){var g=f[St]||null;if(!g)throw Error(s(90));qu(f,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<d.length;o++)f=d[o],f.form===a.form&&Dg(f)}break e;case"textarea":kg(a,d.value,d.defaultValue);break e;case"select":o=d.value,o!=null&&ar(a,!!d.multiple,o,!1)}}}var Wu=!1;function Ig(a,o,d){if(Wu)return a(o,d);Wu=!0;try{var f=a(o);return f}finally{if(Wu=!1,(rr!==null||lr!==null)&&(qc(),rr&&(o=rr,a=lr,lr=rr=null,Pg(o),a)))for(o=0;o<a.length;o++)Pg(a[o])}}function dl(a,o){var d=a.stateNode;if(d===null)return null;var f=d[St]||null;if(f===null)return null;d=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(s(231,o,typeof d));return d}var Kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xu=!1;if(Kn)try{var ul={};Object.defineProperty(ul,"passive",{get:function(){Xu=!0}}),window.addEventListener("test",ul,ul),window.removeEventListener("test",ul,ul)}catch{Xu=!1}var Aa=null,Qu=null,ic=null;function Bg(){if(ic)return ic;var a,o=Qu,d=o.length,f,g="value"in Aa?Aa.value:Aa.textContent,b=g.length;for(a=0;a<d&&o[a]===g[a];a++);var j=d-a;for(f=1;f<=j&&o[d-f]===g[b-f];f++);return ic=g.slice(a,1<f?1-f:void 0)}function rc(a){var o=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&o===13&&(a=13)):a=o,a===10&&(a=13),32<=a||a===13?a:0}function lc(){return!0}function Hg(){return!1}function Ds(a){function o(d,f,g,b,j){this._reactName=d,this._targetInst=g,this.type=f,this.nativeEvent=b,this.target=j,this.currentTarget=null;for(var k in a)a.hasOwnProperty(k)&&(d=a[k],this[k]=d?d(b):b[k]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?lc:Hg,this.isPropagationStopped=Hg,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=lc)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=lc)},persist:function(){},isPersistent:lc}),o}var ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oc=Ds(ci),hl=p({},ci,{view:0,detail:0}),YN=Ds(hl),Zu,Ku,fl,cc=p({},hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eh,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==fl&&(fl&&a.type==="mousemove"?(Zu=a.screenX-fl.screenX,Ku=a.screenY-fl.screenY):Ku=Zu=0,fl=a),Zu)},movementY:function(a){return"movementY"in a?a.movementY:Ku}}),zg=Ds(cc),WN=p({},cc,{dataTransfer:0}),XN=Ds(WN),QN=p({},hl,{relatedTarget:0}),Ju=Ds(QN),ZN=p({},ci,{animationName:0,elapsedTime:0,pseudoElement:0}),KN=Ds(ZN),JN=p({},ci,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),eS=Ds(JN),tS=p({},ci,{data:0}),Fg=Ds(tS),sS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iS(a){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(a):(a=aS[a])?!!o[a]:!1}function eh(){return iS}var rS=p({},hl,{key:function(a){if(a.key){var o=sS[a.key]||a.key;if(o!=="Unidentified")return o}return a.type==="keypress"?(a=rc(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?nS[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eh,charCode:function(a){return a.type==="keypress"?rc(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?rc(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),lS=Ds(rS),oS=p({},cc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ug=Ds(oS),cS=p({},hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eh}),dS=Ds(cS),uS=p({},ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),hS=Ds(uS),fS=p({},cc,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),mS=Ds(fS),pS=p({},ci,{newState:0,oldState:0}),gS=Ds(pS),xS=[9,13,27,32],th=Kn&&"CompositionEvent"in window,ml=null;Kn&&"documentMode"in document&&(ml=document.documentMode);var yS=Kn&&"TextEvent"in window&&!ml,qg=Kn&&(!th||ml&&8<ml&&11>=ml),Vg=" ",$g=!1;function Gg(a,o){switch(a){case"keyup":return xS.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yg(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var or=!1;function bS(a,o){switch(a){case"compositionend":return Yg(o);case"keypress":return o.which!==32?null:($g=!0,Vg);case"textInput":return a=o.data,a===Vg&&$g?null:a;default:return null}}function vS(a,o){if(or)return a==="compositionend"||!th&&Gg(a,o)?(a=Bg(),ic=Qu=Aa=null,or=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return qg&&o.locale!=="ko"?null:o.data;default:return null}}var wS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wg(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o==="input"?!!wS[a.type]:o==="textarea"}function Xg(a,o,d,f){rr?lr?lr.push(f):lr=[f]:rr=f,o=Xc(o,"onChange"),0<o.length&&(d=new oc("onChange","change",null,d,f),a.push({event:d,listeners:o}))}var pl=null,gl=null;function AS(a){Ty(a,0)}function dc(a){var o=wa(a);if(Dg(o))return a}function Qg(a,o){if(a==="change")return o}var Zg=!1;if(Kn){var sh;if(Kn){var nh="oninput"in document;if(!nh){var Kg=document.createElement("div");Kg.setAttribute("oninput","return;"),nh=typeof Kg.oninput=="function"}sh=nh}else sh=!1;Zg=sh&&(!document.documentMode||9<document.documentMode)}function Jg(){pl&&(pl.detachEvent("onpropertychange",ex),gl=pl=null)}function ex(a){if(a.propertyName==="value"&&dc(gl)){var o=[];Xg(o,gl,a,Yu(a)),Ig(AS,o)}}function NS(a,o,d){a==="focusin"?(Jg(),pl=o,gl=d,pl.attachEvent("onpropertychange",ex)):a==="focusout"&&Jg()}function SS(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return dc(gl)}function jS(a,o){if(a==="click")return dc(o)}function ES(a,o){if(a==="input"||a==="change")return dc(o)}function _S(a,o){return a===o&&(a!==0||1/a===1/o)||a!==a&&o!==o}var Vs=typeof Object.is=="function"?Object.is:_S;function xl(a,o){if(Vs(a,o))return!0;if(typeof a!="object"||a===null||typeof o!="object"||o===null)return!1;var d=Object.keys(a),f=Object.keys(o);if(d.length!==f.length)return!1;for(f=0;f<d.length;f++){var g=d[f];if(!we.call(o,g)||!Vs(a[g],o[g]))return!1}return!0}function tx(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function sx(a,o){var d=tx(a);a=0;for(var f;d;){if(d.nodeType===3){if(f=a+d.textContent.length,a<=o&&f>=o)return{node:d,offset:o-a};a=f}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=tx(d)}}function nx(a,o){return a&&o?a===o?!0:a&&a.nodeType===3?!1:o&&o.nodeType===3?nx(a,o.parentNode):"contains"in a?a.contains(o):a.compareDocumentPosition?!!(a.compareDocumentPosition(o)&16):!1:!1}function ax(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var o=nc(a.document);o instanceof a.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)a=o.contentWindow;else break;o=nc(a.document)}return o}function ah(a){var o=a&&a.nodeName&&a.nodeName.toLowerCase();return o&&(o==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||o==="textarea"||a.contentEditable==="true")}var CS=Kn&&"documentMode"in document&&11>=document.documentMode,cr=null,ih=null,yl=null,rh=!1;function ix(a,o,d){var f=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;rh||cr==null||cr!==nc(f)||(f=cr,"selectionStart"in f&&ah(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),yl&&xl(yl,f)||(yl=f,f=Xc(ih,"onSelect"),0<f.length&&(o=new oc("onSelect","select",null,o,d),a.push({event:o,listeners:f}),o.target=cr)))}function di(a,o){var d={};return d[a.toLowerCase()]=o.toLowerCase(),d["Webkit"+a]="webkit"+o,d["Moz"+a]="moz"+o,d}var dr={animationend:di("Animation","AnimationEnd"),animationiteration:di("Animation","AnimationIteration"),animationstart:di("Animation","AnimationStart"),transitionrun:di("Transition","TransitionRun"),transitionstart:di("Transition","TransitionStart"),transitioncancel:di("Transition","TransitionCancel"),transitionend:di("Transition","TransitionEnd")},lh={},rx={};Kn&&(rx=document.createElement("div").style,"AnimationEvent"in window||(delete dr.animationend.animation,delete dr.animationiteration.animation,delete dr.animationstart.animation),"TransitionEvent"in window||delete dr.transitionend.transition);function ui(a){if(lh[a])return lh[a];if(!dr[a])return a;var o=dr[a],d;for(d in o)if(o.hasOwnProperty(d)&&d in rx)return lh[a]=o[d];return a}var lx=ui("animationend"),ox=ui("animationiteration"),cx=ui("animationstart"),TS=ui("transitionrun"),DS=ui("transitionstart"),RS=ui("transitioncancel"),dx=ui("transitionend"),ux=new Map,oh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");oh.push("scrollEnd");function wn(a,o){ux.set(a,o),oi(o,[a])}var hx=new WeakMap;function an(a,o){if(typeof a=="object"&&a!==null){var d=hx.get(a);return d!==void 0?d:(o={value:a,source:o,stack:Cg(o)},hx.set(a,o),o)}return{value:a,source:o,stack:Cg(o)}}var rn=[],ur=0,ch=0;function uc(){for(var a=ur,o=ch=ur=0;o<a;){var d=rn[o];rn[o++]=null;var f=rn[o];rn[o++]=null;var g=rn[o];rn[o++]=null;var b=rn[o];if(rn[o++]=null,f!==null&&g!==null){var j=f.pending;j===null?g.next=g:(g.next=j.next,j.next=g),f.pending=g}b!==0&&fx(d,g,b)}}function hc(a,o,d,f){rn[ur++]=a,rn[ur++]=o,rn[ur++]=d,rn[ur++]=f,ch|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function dh(a,o,d,f){return hc(a,o,d,f),fc(a)}function hr(a,o){return hc(a,null,null,o),fc(a)}function fx(a,o,d){a.lanes|=d;var f=a.alternate;f!==null&&(f.lanes|=d);for(var g=!1,b=a.return;b!==null;)b.childLanes|=d,f=b.alternate,f!==null&&(f.childLanes|=d),b.tag===22&&(a=b.stateNode,a===null||a._visibility&1||(g=!0)),a=b,b=b.return;return a.tag===3?(b=a.stateNode,g&&o!==null&&(g=31-dt(d),a=b.hiddenUpdates,f=a[g],f===null?a[g]=[o]:f.push(o),o.lane=d|536870912),b):null}function fc(a){if(50<ql)throw ql=0,xf=null,Error(s(185));for(var o=a.return;o!==null;)a=o,o=a.return;return a.tag===3?a.stateNode:null}var fr={};function kS(a,o,d,f){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $s(a,o,d,f){return new kS(a,o,d,f)}function uh(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Jn(a,o){var d=a.alternate;return d===null?(d=$s(a.tag,o,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=o,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&65011712,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,o=a.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d.refCleanup=a.refCleanup,d}function mx(a,o){a.flags&=65011714;var d=a.alternate;return d===null?(a.childLanes=0,a.lanes=o,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=d.childLanes,a.lanes=d.lanes,a.child=d.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=d.memoizedProps,a.memoizedState=d.memoizedState,a.updateQueue=d.updateQueue,a.type=d.type,o=d.dependencies,a.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),a}function mc(a,o,d,f,g,b){var j=0;if(f=a,typeof a=="function")uh(a)&&(j=1);else if(typeof a=="string")j=Lj(a,d,de.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case P:return a=$s(31,d,o,g),a.elementType=P,a.lanes=b,a;case w:return hi(d.children,g,b,o);case A:j=8,g|=24;break;case N:return a=$s(12,d,o,g|2),a.elementType=N,a.lanes=b,a;case D:return a=$s(13,d,o,g),a.elementType=D,a.lanes=b,a;case O:return a=$s(19,d,o,g),a.elementType=O,a.lanes=b,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case S:case C:j=10;break e;case E:j=9;break e;case R:j=11;break e;case H:j=14;break e;case F:j=16,f=null;break e}j=29,d=Error(s(130,a===null?"null":typeof a,"")),f=null}return o=$s(j,d,o,g),o.elementType=a,o.type=f,o.lanes=b,o}function hi(a,o,d,f){return a=$s(7,a,f,o),a.lanes=d,a}function hh(a,o,d){return a=$s(6,a,null,o),a.lanes=d,a}function fh(a,o,d){return o=$s(4,a.children!==null?a.children:[],a.key,o),o.lanes=d,o.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},o}var mr=[],pr=0,pc=null,gc=0,ln=[],on=0,fi=null,ea=1,ta="";function mi(a,o){mr[pr++]=gc,mr[pr++]=pc,pc=a,gc=o}function px(a,o,d){ln[on++]=ea,ln[on++]=ta,ln[on++]=fi,fi=a;var f=ea;a=ta;var g=32-dt(f)-1;f&=~(1<<g),d+=1;var b=32-dt(o)+g;if(30<b){var j=g-g%5;b=(f&(1<<j)-1).toString(32),f>>=j,g-=j,ea=1<<32-dt(o)+g|d<<g|f,ta=b+a}else ea=1<<b|d<<g|f,ta=a}function mh(a){a.return!==null&&(mi(a,1),px(a,1,0))}function ph(a){for(;a===pc;)pc=mr[--pr],mr[pr]=null,gc=mr[--pr],mr[pr]=null;for(;a===fi;)fi=ln[--on],ln[on]=null,ta=ln[--on],ln[on]=null,ea=ln[--on],ln[on]=null}var ws=null,Ot=null,ot=!1,pi=null,Ln=!1,gh=Error(s(519));function gi(a){var o=Error(s(418,""));throw wl(an(o,a)),gh}function gx(a){var o=a.stateNode,d=a.type,f=a.memoizedProps;switch(o[bt]=a,o[St]=f,d){case"dialog":tt("cancel",o),tt("close",o);break;case"iframe":case"object":case"embed":tt("load",o);break;case"video":case"audio":for(d=0;d<$l.length;d++)tt($l[d],o);break;case"source":tt("error",o);break;case"img":case"image":case"link":tt("error",o),tt("load",o);break;case"details":tt("toggle",o);break;case"input":tt("invalid",o),Rg(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),sc(o);break;case"select":tt("invalid",o);break;case"textarea":tt("invalid",o),Mg(o,f.value,f.defaultValue,f.children),sc(o)}d=f.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||o.textContent===""+d||f.suppressHydrationWarning===!0||My(o.textContent,d)?(f.popover!=null&&(tt("beforetoggle",o),tt("toggle",o)),f.onScroll!=null&&tt("scroll",o),f.onScrollEnd!=null&&tt("scrollend",o),f.onClick!=null&&(o.onclick=Qc),o=!0):o=!1,o||gi(a)}function xx(a){for(ws=a.return;ws;)switch(ws.tag){case 5:case 13:Ln=!1;return;case 27:case 3:Ln=!0;return;default:ws=ws.return}}function bl(a){if(a!==ws)return!1;if(!ot)return xx(a),ot=!0,!1;var o=a.tag,d;if((d=o!==3&&o!==27)&&((d=o===5)&&(d=a.type,d=!(d!=="form"&&d!=="button")||Mf(a.type,a.memoizedProps)),d=!d),d&&Ot&&gi(a),xx(a),o===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(s(317));e:{for(a=a.nextSibling,o=0;a;){if(a.nodeType===8)if(d=a.data,d==="/$"){if(o===0){Ot=Nn(a.nextSibling);break e}o--}else d!=="$"&&d!=="$!"&&d!=="$?"||o++;a=a.nextSibling}Ot=null}}else o===27?(o=Ot,Ba(a.type)?(a=If,If=null,Ot=a):Ot=o):Ot=ws?Nn(a.stateNode.nextSibling):null;return!0}function vl(){Ot=ws=null,ot=!1}function yx(){var a=pi;return a!==null&&(Ms===null?Ms=a:Ms.push.apply(Ms,a),pi=null),a}function wl(a){pi===null?pi=[a]:pi.push(a)}var xh=V(null),xi=null,sa=null;function Na(a,o,d){G(xh,o._currentValue),o._currentValue=d}function na(a){a._currentValue=xh.current,M(xh)}function yh(a,o,d){for(;a!==null;){var f=a.alternate;if((a.childLanes&o)!==o?(a.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),a===d)break;a=a.return}}function bh(a,o,d,f){var g=a.child;for(g!==null&&(g.return=a);g!==null;){var b=g.dependencies;if(b!==null){var j=g.child;b=b.firstContext;e:for(;b!==null;){var k=b;b=g;for(var B=0;B<o.length;B++)if(k.context===o[B]){b.lanes|=d,k=b.alternate,k!==null&&(k.lanes|=d),yh(b.return,d,a),f||(j=null);break e}b=k.next}}else if(g.tag===18){if(j=g.return,j===null)throw Error(s(341));j.lanes|=d,b=j.alternate,b!==null&&(b.lanes|=d),yh(j,d,a),j=null}else j=g.child;if(j!==null)j.return=g;else for(j=g;j!==null;){if(j===a){j=null;break}if(g=j.sibling,g!==null){g.return=j.return,j=g;break}j=j.return}g=j}}function Al(a,o,d,f){a=null;for(var g=o,b=!1;g!==null;){if(!b){if((g.flags&524288)!==0)b=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var j=g.alternate;if(j===null)throw Error(s(387));if(j=j.memoizedProps,j!==null){var k=g.type;Vs(g.pendingProps.value,j.value)||(a!==null?a.push(k):a=[k])}}else if(g===je.current){if(j=g.alternate,j===null)throw Error(s(387));j.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(a!==null?a.push(Zl):a=[Zl])}g=g.return}a!==null&&bh(o,a,d,f),o.flags|=262144}function xc(a){for(a=a.firstContext;a!==null;){if(!Vs(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function yi(a){xi=a,sa=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function ps(a){return bx(xi,a)}function yc(a,o){return xi===null&&yi(a),bx(a,o)}function bx(a,o){var d=o._currentValue;if(o={context:o,memoizedValue:d,next:null},sa===null){if(a===null)throw Error(s(308));sa=o,a.dependencies={lanes:0,firstContext:o},a.flags|=524288}else sa=sa.next=o;return d}var MS=typeof AbortController<"u"?AbortController:function(){var a=[],o=this.signal={aborted:!1,addEventListener:function(d,f){a.push(f)}};this.abort=function(){o.aborted=!0,a.forEach(function(d){return d()})}},LS=n.unstable_scheduleCallback,OS=n.unstable_NormalPriority,Zt={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function vh(){return{controller:new MS,data:new Map,refCount:0}}function Nl(a){a.refCount--,a.refCount===0&&LS(OS,function(){a.controller.abort()})}var Sl=null,wh=0,gr=0,xr=null;function PS(a,o){if(Sl===null){var d=Sl=[];wh=0,gr=Sf(),xr={status:"pending",value:void 0,then:function(f){d.push(f)}}}return wh++,o.then(vx,vx),o}function vx(){if(--wh===0&&Sl!==null){xr!==null&&(xr.status="fulfilled");var a=Sl;Sl=null,gr=0,xr=null;for(var o=0;o<a.length;o++)(0,a[o])()}}function IS(a,o){var d=[],f={status:"pending",value:null,reason:null,then:function(g){d.push(g)}};return a.then(function(){f.status="fulfilled",f.value=o;for(var g=0;g<d.length;g++)(0,d[g])(o)},function(g){for(f.status="rejected",f.reason=g,g=0;g<d.length;g++)(0,d[g])(void 0)}),f}var wx=L.S;L.S=function(a,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&PS(a,o),wx!==null&&wx(a,o)};var bi=V(null);function Ah(){var a=bi.current;return a!==null?a:Nt.pooledCache}function bc(a,o){o===null?G(bi,bi.current):G(bi,o.pool)}function Ax(){var a=Ah();return a===null?null:{parent:Zt._currentValue,pool:a}}var jl=Error(s(460)),Nx=Error(s(474)),vc=Error(s(542)),Nh={then:function(){}};function Sx(a){return a=a.status,a==="fulfilled"||a==="rejected"}function wc(){}function jx(a,o,d){switch(d=a[d],d===void 0?a.push(o):d!==o&&(o.then(wc,wc),o=d),o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,_x(a),a;default:if(typeof o.status=="string")o.then(wc,wc);else{if(a=Nt,a!==null&&100<a.shellSuspendCounter)throw Error(s(482));a=o,a.status="pending",a.then(function(f){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=f}},function(f){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw a=o.reason,_x(a),a}throw El=o,jl}}var El=null;function Ex(){if(El===null)throw Error(s(459));var a=El;return El=null,a}function _x(a){if(a===jl||a===vc)throw Error(s(483))}var Sa=!1;function Sh(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jh(a,o){a=a.updateQueue,o.updateQueue===a&&(o.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function ja(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Ea(a,o,d){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(ut&2)!==0){var g=f.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),f.pending=o,o=fc(a),fx(a,null,d),o}return hc(a,f,o,d),fc(a)}function _l(a,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194048)!==0)){var f=o.lanes;f&=a.pendingLanes,d|=f,o.lanes=d,li(a,d)}}function Eh(a,o){var d=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,d===f)){var g=null,b=null;if(d=d.firstBaseUpdate,d!==null){do{var j={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};b===null?g=b=j:b=b.next=j,d=d.next}while(d!==null);b===null?g=b=o:b=b.next=o}else g=b=o;d={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:b,shared:f.shared,callbacks:f.callbacks},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=o:a.next=o,d.lastBaseUpdate=o}var _h=!1;function Cl(){if(_h){var a=xr;if(a!==null)throw a}}function Tl(a,o,d,f){_h=!1;var g=a.updateQueue;Sa=!1;var b=g.firstBaseUpdate,j=g.lastBaseUpdate,k=g.shared.pending;if(k!==null){g.shared.pending=null;var B=k,ee=B.next;B.next=null,j===null?b=ee:j.next=ee,j=B;var ue=a.alternate;ue!==null&&(ue=ue.updateQueue,k=ue.lastBaseUpdate,k!==j&&(k===null?ue.firstBaseUpdate=ee:k.next=ee,ue.lastBaseUpdate=B))}if(b!==null){var pe=g.baseState;j=0,ue=ee=B=null,k=b;do{var se=k.lane&-536870913,ne=se!==k.lane;if(ne?(it&se)===se:(f&se)===se){se!==0&&se===gr&&(_h=!0),ue!==null&&(ue=ue.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Fe=a,Be=k;se=o;var gt=d;switch(Be.tag){case 1:if(Fe=Be.payload,typeof Fe=="function"){pe=Fe.call(gt,pe,se);break e}pe=Fe;break e;case 3:Fe.flags=Fe.flags&-65537|128;case 0:if(Fe=Be.payload,se=typeof Fe=="function"?Fe.call(gt,pe,se):Fe,se==null)break e;pe=p({},pe,se);break e;case 2:Sa=!0}}se=k.callback,se!==null&&(a.flags|=64,ne&&(a.flags|=8192),ne=g.callbacks,ne===null?g.callbacks=[se]:ne.push(se))}else ne={lane:se,tag:k.tag,payload:k.payload,callback:k.callback,next:null},ue===null?(ee=ue=ne,B=pe):ue=ue.next=ne,j|=se;if(k=k.next,k===null){if(k=g.shared.pending,k===null)break;ne=k,k=ne.next,ne.next=null,g.lastBaseUpdate=ne,g.shared.pending=null}}while(!0);ue===null&&(B=pe),g.baseState=B,g.firstBaseUpdate=ee,g.lastBaseUpdate=ue,b===null&&(g.shared.lanes=0),La|=j,a.lanes=j,a.memoizedState=pe}}function Cx(a,o){if(typeof a!="function")throw Error(s(191,a));a.call(o)}function Tx(a,o){var d=a.callbacks;if(d!==null)for(a.callbacks=null,a=0;a<d.length;a++)Cx(d[a],o)}var yr=V(null),Ac=V(0);function Dx(a,o){a=da,G(Ac,a),G(yr,o),da=a|o.baseLanes}function Ch(){G(Ac,da),G(yr,yr.current)}function Th(){da=Ac.current,M(yr),M(Ac)}var _a=0,Ke=null,mt=null,Vt=null,Nc=!1,br=!1,vi=!1,Sc=0,Dl=0,vr=null,BS=0;function Bt(){throw Error(s(321))}function Dh(a,o){if(o===null)return!1;for(var d=0;d<o.length&&d<a.length;d++)if(!Vs(a[d],o[d]))return!1;return!0}function Rh(a,o,d,f,g,b){return _a=b,Ke=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,L.H=a===null||a.memoizedState===null?f0:m0,vi=!1,b=d(f,g),vi=!1,br&&(b=kx(o,d,f,g)),Rx(a),b}function Rx(a){L.H=Dc;var o=mt!==null&&mt.next!==null;if(_a=0,Vt=mt=Ke=null,Nc=!1,Dl=0,vr=null,o)throw Error(s(300));a===null||ts||(a=a.dependencies,a!==null&&xc(a)&&(ts=!0))}function kx(a,o,d,f){Ke=a;var g=0;do{if(br&&(vr=null),Dl=0,br=!1,25<=g)throw Error(s(301));if(g+=1,Vt=mt=null,a.updateQueue!=null){var b=a.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}L.H=$S,b=o(d,f)}while(br);return b}function HS(){var a=L.H,o=a.useState()[0];return o=typeof o.then=="function"?Rl(o):o,a=a.useState()[0],(mt!==null?mt.memoizedState:null)!==a&&(Ke.flags|=1024),o}function kh(){var a=Sc!==0;return Sc=0,a}function Mh(a,o,d){o.updateQueue=a.updateQueue,o.flags&=-2053,a.lanes&=~d}function Lh(a){if(Nc){for(a=a.memoizedState;a!==null;){var o=a.queue;o!==null&&(o.pending=null),a=a.next}Nc=!1}_a=0,Vt=mt=Ke=null,br=!1,Dl=Sc=0,vr=null}function Rs(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vt===null?Ke.memoizedState=Vt=a:Vt=Vt.next=a,Vt}function $t(){if(mt===null){var a=Ke.alternate;a=a!==null?a.memoizedState:null}else a=mt.next;var o=Vt===null?Ke.memoizedState:Vt.next;if(o!==null)Vt=o,mt=a;else{if(a===null)throw Ke.alternate===null?Error(s(467)):Error(s(310));mt=a,a={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},Vt===null?Ke.memoizedState=Vt=a:Vt=Vt.next=a}return Vt}function Oh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Rl(a){var o=Dl;return Dl+=1,vr===null&&(vr=[]),a=jx(vr,a,o),o=Ke,(Vt===null?o.memoizedState:Vt.next)===null&&(o=o.alternate,L.H=o===null||o.memoizedState===null?f0:m0),a}function jc(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Rl(a);if(a.$$typeof===C)return ps(a)}throw Error(s(438,String(a)))}function Ph(a){var o=null,d=Ke.updateQueue;if(d!==null&&(o=d.memoCache),o==null){var f=Ke.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),d===null&&(d=Oh(),Ke.updateQueue=d),d.memoCache=o,d=o.data[o.index],d===void 0)for(d=o.data[o.index]=Array(a),f=0;f<a;f++)d[f]=Z;return o.index++,d}function aa(a,o){return typeof o=="function"?o(a):o}function Ec(a){var o=$t();return Ih(o,mt,a)}function Ih(a,o,d){var f=a.queue;if(f===null)throw Error(s(311));f.lastRenderedReducer=d;var g=a.baseQueue,b=f.pending;if(b!==null){if(g!==null){var j=g.next;g.next=b.next,b.next=j}o.baseQueue=g=b,f.pending=null}if(b=a.baseState,g===null)a.memoizedState=b;else{o=g.next;var k=j=null,B=null,ee=o,ue=!1;do{var pe=ee.lane&-536870913;if(pe!==ee.lane?(it&pe)===pe:(_a&pe)===pe){var se=ee.revertLane;if(se===0)B!==null&&(B=B.next={lane:0,revertLane:0,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),pe===gr&&(ue=!0);else if((_a&se)===se){ee=ee.next,se===gr&&(ue=!0);continue}else pe={lane:0,revertLane:ee.revertLane,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null},B===null?(k=B=pe,j=b):B=B.next=pe,Ke.lanes|=se,La|=se;pe=ee.action,vi&&d(b,pe),b=ee.hasEagerState?ee.eagerState:d(b,pe)}else se={lane:pe,revertLane:ee.revertLane,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null},B===null?(k=B=se,j=b):B=B.next=se,Ke.lanes|=pe,La|=pe;ee=ee.next}while(ee!==null&&ee!==o);if(B===null?j=b:B.next=k,!Vs(b,a.memoizedState)&&(ts=!0,ue&&(d=xr,d!==null)))throw d;a.memoizedState=b,a.baseState=j,a.baseQueue=B,f.lastRenderedState=b}return g===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function Bh(a){var o=$t(),d=o.queue;if(d===null)throw Error(s(311));d.lastRenderedReducer=a;var f=d.dispatch,g=d.pending,b=o.memoizedState;if(g!==null){d.pending=null;var j=g=g.next;do b=a(b,j.action),j=j.next;while(j!==g);Vs(b,o.memoizedState)||(ts=!0),o.memoizedState=b,o.baseQueue===null&&(o.baseState=b),d.lastRenderedState=b}return[b,f]}function Mx(a,o,d){var f=Ke,g=$t(),b=ot;if(b){if(d===void 0)throw Error(s(407));d=d()}else d=o();var j=!Vs((mt||g).memoizedState,d);j&&(g.memoizedState=d,ts=!0),g=g.queue;var k=Px.bind(null,f,g,a);if(kl(2048,8,k,[a]),g.getSnapshot!==o||j||Vt!==null&&Vt.memoizedState.tag&1){if(f.flags|=2048,wr(9,_c(),Ox.bind(null,f,g,d,o),null),Nt===null)throw Error(s(349));b||(_a&124)!==0||Lx(f,o,d)}return d}function Lx(a,o,d){a.flags|=16384,a={getSnapshot:o,value:d},o=Ke.updateQueue,o===null?(o=Oh(),Ke.updateQueue=o,o.stores=[a]):(d=o.stores,d===null?o.stores=[a]:d.push(a))}function Ox(a,o,d,f){o.value=d,o.getSnapshot=f,Ix(o)&&Bx(a)}function Px(a,o,d){return d(function(){Ix(o)&&Bx(a)})}function Ix(a){var o=a.getSnapshot;a=a.value;try{var d=o();return!Vs(a,d)}catch{return!0}}function Bx(a){var o=hr(a,2);o!==null&&Qs(o,a,2)}function Hh(a){var o=Rs();if(typeof a=="function"){var d=a;if(a=d(),vi){Ue(!0);try{d()}finally{Ue(!1)}}}return o.memoizedState=o.baseState=a,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:aa,lastRenderedState:a},o}function Hx(a,o,d,f){return a.baseState=d,Ih(a,mt,typeof f=="function"?f:aa)}function zS(a,o,d,f,g){if(Tc(a))throw Error(s(485));if(a=o.action,a!==null){var b={payload:g,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){b.listeners.push(j)}};L.T!==null?d(!0):b.isTransition=!1,f(b),d=o.pending,d===null?(b.next=o.pending=b,zx(o,b)):(b.next=d.next,o.pending=d.next=b)}}function zx(a,o){var d=o.action,f=o.payload,g=a.state;if(o.isTransition){var b=L.T,j={};L.T=j;try{var k=d(g,f),B=L.S;B!==null&&B(j,k),Fx(a,o,k)}catch(ee){zh(a,o,ee)}finally{L.T=b}}else try{b=d(g,f),Fx(a,o,b)}catch(ee){zh(a,o,ee)}}function Fx(a,o,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(f){Ux(a,o,f)},function(f){return zh(a,o,f)}):Ux(a,o,d)}function Ux(a,o,d){o.status="fulfilled",o.value=d,qx(o),a.state=d,o=a.pending,o!==null&&(d=o.next,d===o?a.pending=null:(d=d.next,o.next=d,zx(a,d)))}function zh(a,o,d){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=d,qx(o),o=o.next;while(o!==f)}a.action=null}function qx(a){a=a.listeners;for(var o=0;o<a.length;o++)(0,a[o])()}function Vx(a,o){return o}function $x(a,o){if(ot){var d=Nt.formState;if(d!==null){e:{var f=Ke;if(ot){if(Ot){t:{for(var g=Ot,b=Ln;g.nodeType!==8;){if(!b){g=null;break t}if(g=Nn(g.nextSibling),g===null){g=null;break t}}b=g.data,g=b==="F!"||b==="F"?g:null}if(g){Ot=Nn(g.nextSibling),f=g.data==="F!";break e}}gi(f)}f=!1}f&&(o=d[0])}}return d=Rs(),d.memoizedState=d.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vx,lastRenderedState:o},d.queue=f,d=d0.bind(null,Ke,f),f.dispatch=d,f=Hh(!1),b=$h.bind(null,Ke,!1,f.queue),f=Rs(),g={state:o,dispatch:null,action:a,pending:null},f.queue=g,d=zS.bind(null,Ke,g,b,d),g.dispatch=d,f.memoizedState=a,[o,d,!1]}function Gx(a){var o=$t();return Yx(o,mt,a)}function Yx(a,o,d){if(o=Ih(a,o,Vx)[0],a=Ec(aa)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=Rl(o)}catch(j){throw j===jl?vc:j}else f=o;o=$t();var g=o.queue,b=g.dispatch;return d!==o.memoizedState&&(Ke.flags|=2048,wr(9,_c(),FS.bind(null,g,d),null)),[f,b,a]}function FS(a,o){a.action=o}function Wx(a){var o=$t(),d=mt;if(d!==null)return Yx(o,d,a);$t(),o=o.memoizedState,d=$t();var f=d.queue.dispatch;return d.memoizedState=a,[o,f,!1]}function wr(a,o,d,f){return a={tag:a,create:d,deps:f,inst:o,next:null},o=Ke.updateQueue,o===null&&(o=Oh(),Ke.updateQueue=o),d=o.lastEffect,d===null?o.lastEffect=a.next=a:(f=d.next,d.next=a,a.next=f,o.lastEffect=a),a}function _c(){return{destroy:void 0,resource:void 0}}function Xx(){return $t().memoizedState}function Cc(a,o,d,f){var g=Rs();f=f===void 0?null:f,Ke.flags|=a,g.memoizedState=wr(1|o,_c(),d,f)}function kl(a,o,d,f){var g=$t();f=f===void 0?null:f;var b=g.memoizedState.inst;mt!==null&&f!==null&&Dh(f,mt.memoizedState.deps)?g.memoizedState=wr(o,b,d,f):(Ke.flags|=a,g.memoizedState=wr(1|o,b,d,f))}function Qx(a,o){Cc(8390656,8,a,o)}function Zx(a,o){kl(2048,8,a,o)}function Kx(a,o){return kl(4,2,a,o)}function Jx(a,o){return kl(4,4,a,o)}function e0(a,o){if(typeof o=="function"){a=a();var d=o(a);return function(){typeof d=="function"?d():o(null)}}if(o!=null)return a=a(),o.current=a,function(){o.current=null}}function t0(a,o,d){d=d!=null?d.concat([a]):null,kl(4,4,e0.bind(null,o,a),d)}function Fh(){}function s0(a,o){var d=$t();o=o===void 0?null:o;var f=d.memoizedState;return o!==null&&Dh(o,f[1])?f[0]:(d.memoizedState=[a,o],a)}function n0(a,o){var d=$t();o=o===void 0?null:o;var f=d.memoizedState;if(o!==null&&Dh(o,f[1]))return f[0];if(f=a(),vi){Ue(!0);try{a()}finally{Ue(!1)}}return d.memoizedState=[f,o],f}function Uh(a,o,d){return d===void 0||(_a&1073741824)!==0?a.memoizedState=o:(a.memoizedState=d,a=ry(),Ke.lanes|=a,La|=a,d)}function a0(a,o,d,f){return Vs(d,o)?d:yr.current!==null?(a=Uh(a,d,f),Vs(a,o)||(ts=!0),a):(_a&42)===0?(ts=!0,a.memoizedState=d):(a=ry(),Ke.lanes|=a,La|=a,o)}function i0(a,o,d,f,g){var b=q.p;q.p=b!==0&&8>b?b:8;var j=L.T,k={};L.T=k,$h(a,!1,o,d);try{var B=g(),ee=L.S;if(ee!==null&&ee(k,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var ue=IS(B,f);Ml(a,o,ue,Xs(a))}else Ml(a,o,f,Xs(a))}catch(pe){Ml(a,o,{then:function(){},status:"rejected",reason:pe},Xs())}finally{q.p=b,L.T=j}}function US(){}function qh(a,o,d,f){if(a.tag!==5)throw Error(s(476));var g=r0(a).queue;i0(a,g,o,$,d===null?US:function(){return l0(a),d(f)})}function r0(a){var o=a.memoizedState;if(o!==null)return o;o={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:aa,lastRenderedState:$},next:null};var d={};return o.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:aa,lastRenderedState:d},next:null},a.memoizedState=o,a=a.alternate,a!==null&&(a.memoizedState=o),o}function l0(a){var o=r0(a).next.queue;Ml(a,o,{},Xs())}function Vh(){return ps(Zl)}function o0(){return $t().memoizedState}function c0(){return $t().memoizedState}function qS(a){for(var o=a.return;o!==null;){switch(o.tag){case 24:case 3:var d=Xs();a=ja(d);var f=Ea(o,a,d);f!==null&&(Qs(f,o,d),_l(f,o,d)),o={cache:vh()},a.payload=o;return}o=o.return}}function VS(a,o,d){var f=Xs();d={lane:f,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},Tc(a)?u0(o,d):(d=dh(a,o,d,f),d!==null&&(Qs(d,a,f),h0(d,o,f)))}function d0(a,o,d){var f=Xs();Ml(a,o,d,f)}function Ml(a,o,d,f){var g={lane:f,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(Tc(a))u0(o,g);else{var b=a.alternate;if(a.lanes===0&&(b===null||b.lanes===0)&&(b=o.lastRenderedReducer,b!==null))try{var j=o.lastRenderedState,k=b(j,d);if(g.hasEagerState=!0,g.eagerState=k,Vs(k,j))return hc(a,o,g,0),Nt===null&&uc(),!1}catch{}finally{}if(d=dh(a,o,g,f),d!==null)return Qs(d,a,f),h0(d,o,f),!0}return!1}function $h(a,o,d,f){if(f={lane:2,revertLane:Sf(),action:f,hasEagerState:!1,eagerState:null,next:null},Tc(a)){if(o)throw Error(s(479))}else o=dh(a,d,f,2),o!==null&&Qs(o,a,2)}function Tc(a){var o=a.alternate;return a===Ke||o!==null&&o===Ke}function u0(a,o){br=Nc=!0;var d=a.pending;d===null?o.next=o:(o.next=d.next,d.next=o),a.pending=o}function h0(a,o,d){if((d&4194048)!==0){var f=o.lanes;f&=a.pendingLanes,d|=f,o.lanes=d,li(a,d)}}var Dc={readContext:ps,use:jc,useCallback:Bt,useContext:Bt,useEffect:Bt,useImperativeHandle:Bt,useLayoutEffect:Bt,useInsertionEffect:Bt,useMemo:Bt,useReducer:Bt,useRef:Bt,useState:Bt,useDebugValue:Bt,useDeferredValue:Bt,useTransition:Bt,useSyncExternalStore:Bt,useId:Bt,useHostTransitionStatus:Bt,useFormState:Bt,useActionState:Bt,useOptimistic:Bt,useMemoCache:Bt,useCacheRefresh:Bt},f0={readContext:ps,use:jc,useCallback:function(a,o){return Rs().memoizedState=[a,o===void 0?null:o],a},useContext:ps,useEffect:Qx,useImperativeHandle:function(a,o,d){d=d!=null?d.concat([a]):null,Cc(4194308,4,e0.bind(null,o,a),d)},useLayoutEffect:function(a,o){return Cc(4194308,4,a,o)},useInsertionEffect:function(a,o){Cc(4,2,a,o)},useMemo:function(a,o){var d=Rs();o=o===void 0?null:o;var f=a();if(vi){Ue(!0);try{a()}finally{Ue(!1)}}return d.memoizedState=[f,o],f},useReducer:function(a,o,d){var f=Rs();if(d!==void 0){var g=d(o);if(vi){Ue(!0);try{d(o)}finally{Ue(!1)}}}else g=o;return f.memoizedState=f.baseState=g,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:g},f.queue=a,a=a.dispatch=VS.bind(null,Ke,a),[f.memoizedState,a]},useRef:function(a){var o=Rs();return a={current:a},o.memoizedState=a},useState:function(a){a=Hh(a);var o=a.queue,d=d0.bind(null,Ke,o);return o.dispatch=d,[a.memoizedState,d]},useDebugValue:Fh,useDeferredValue:function(a,o){var d=Rs();return Uh(d,a,o)},useTransition:function(){var a=Hh(!1);return a=i0.bind(null,Ke,a.queue,!0,!1),Rs().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,o,d){var f=Ke,g=Rs();if(ot){if(d===void 0)throw Error(s(407));d=d()}else{if(d=o(),Nt===null)throw Error(s(349));(it&124)!==0||Lx(f,o,d)}g.memoizedState=d;var b={value:d,getSnapshot:o};return g.queue=b,Qx(Px.bind(null,f,b,a),[a]),f.flags|=2048,wr(9,_c(),Ox.bind(null,f,b,d,o),null),d},useId:function(){var a=Rs(),o=Nt.identifierPrefix;if(ot){var d=ta,f=ea;d=(f&~(1<<32-dt(f)-1)).toString(32)+d,o="«"+o+"R"+d,d=Sc++,0<d&&(o+="H"+d.toString(32)),o+="»"}else d=BS++,o="«"+o+"r"+d.toString(32)+"»";return a.memoizedState=o},useHostTransitionStatus:Vh,useFormState:$x,useActionState:$x,useOptimistic:function(a){var o=Rs();o.memoizedState=o.baseState=a;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=d,o=$h.bind(null,Ke,!0,d),d.dispatch=o,[a,o]},useMemoCache:Ph,useCacheRefresh:function(){return Rs().memoizedState=qS.bind(null,Ke)}},m0={readContext:ps,use:jc,useCallback:s0,useContext:ps,useEffect:Zx,useImperativeHandle:t0,useInsertionEffect:Kx,useLayoutEffect:Jx,useMemo:n0,useReducer:Ec,useRef:Xx,useState:function(){return Ec(aa)},useDebugValue:Fh,useDeferredValue:function(a,o){var d=$t();return a0(d,mt.memoizedState,a,o)},useTransition:function(){var a=Ec(aa)[0],o=$t().memoizedState;return[typeof a=="boolean"?a:Rl(a),o]},useSyncExternalStore:Mx,useId:o0,useHostTransitionStatus:Vh,useFormState:Gx,useActionState:Gx,useOptimistic:function(a,o){var d=$t();return Hx(d,mt,a,o)},useMemoCache:Ph,useCacheRefresh:c0},$S={readContext:ps,use:jc,useCallback:s0,useContext:ps,useEffect:Zx,useImperativeHandle:t0,useInsertionEffect:Kx,useLayoutEffect:Jx,useMemo:n0,useReducer:Bh,useRef:Xx,useState:function(){return Bh(aa)},useDebugValue:Fh,useDeferredValue:function(a,o){var d=$t();return mt===null?Uh(d,a,o):a0(d,mt.memoizedState,a,o)},useTransition:function(){var a=Bh(aa)[0],o=$t().memoizedState;return[typeof a=="boolean"?a:Rl(a),o]},useSyncExternalStore:Mx,useId:o0,useHostTransitionStatus:Vh,useFormState:Wx,useActionState:Wx,useOptimistic:function(a,o){var d=$t();return mt!==null?Hx(d,mt,a,o):(d.baseState=a,[a,d.queue.dispatch])},useMemoCache:Ph,useCacheRefresh:c0},Ar=null,Ll=0;function Rc(a){var o=Ll;return Ll+=1,Ar===null&&(Ar=[]),jx(Ar,a,o)}function Ol(a,o){o=o.props.ref,a.ref=o!==void 0?o:null}function kc(a,o){throw o.$$typeof===x?Error(s(525)):(a=Object.prototype.toString.call(o),Error(s(31,a==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":a)))}function p0(a){var o=a._init;return o(a._payload)}function g0(a){function o(Y,U){if(a){var Q=Y.deletions;Q===null?(Y.deletions=[U],Y.flags|=16):Q.push(U)}}function d(Y,U){if(!a)return null;for(;U!==null;)o(Y,U),U=U.sibling;return null}function f(Y){for(var U=new Map;Y!==null;)Y.key!==null?U.set(Y.key,Y):U.set(Y.index,Y),Y=Y.sibling;return U}function g(Y,U){return Y=Jn(Y,U),Y.index=0,Y.sibling=null,Y}function b(Y,U,Q){return Y.index=Q,a?(Q=Y.alternate,Q!==null?(Q=Q.index,Q<U?(Y.flags|=67108866,U):Q):(Y.flags|=67108866,U)):(Y.flags|=1048576,U)}function j(Y){return a&&Y.alternate===null&&(Y.flags|=67108866),Y}function k(Y,U,Q,fe){return U===null||U.tag!==6?(U=hh(Q,Y.mode,fe),U.return=Y,U):(U=g(U,Q),U.return=Y,U)}function B(Y,U,Q,fe){var Te=Q.type;return Te===w?ue(Y,U,Q.props.children,fe,Q.key):U!==null&&(U.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===F&&p0(Te)===U.type)?(U=g(U,Q.props),Ol(U,Q),U.return=Y,U):(U=mc(Q.type,Q.key,Q.props,null,Y.mode,fe),Ol(U,Q),U.return=Y,U)}function ee(Y,U,Q,fe){return U===null||U.tag!==4||U.stateNode.containerInfo!==Q.containerInfo||U.stateNode.implementation!==Q.implementation?(U=fh(Q,Y.mode,fe),U.return=Y,U):(U=g(U,Q.children||[]),U.return=Y,U)}function ue(Y,U,Q,fe,Te){return U===null||U.tag!==7?(U=hi(Q,Y.mode,fe,Te),U.return=Y,U):(U=g(U,Q),U.return=Y,U)}function pe(Y,U,Q){if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return U=hh(""+U,Y.mode,Q),U.return=Y,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case y:return Q=mc(U.type,U.key,U.props,null,Y.mode,Q),Ol(Q,U),Q.return=Y,Q;case v:return U=fh(U,Y.mode,Q),U.return=Y,U;case F:var fe=U._init;return U=fe(U._payload),pe(Y,U,Q)}if(me(U)||K(U))return U=hi(U,Y.mode,Q,null),U.return=Y,U;if(typeof U.then=="function")return pe(Y,Rc(U),Q);if(U.$$typeof===C)return pe(Y,yc(Y,U),Q);kc(Y,U)}return null}function se(Y,U,Q,fe){var Te=U!==null?U.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Te!==null?null:k(Y,U,""+Q,fe);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case y:return Q.key===Te?B(Y,U,Q,fe):null;case v:return Q.key===Te?ee(Y,U,Q,fe):null;case F:return Te=Q._init,Q=Te(Q._payload),se(Y,U,Q,fe)}if(me(Q)||K(Q))return Te!==null?null:ue(Y,U,Q,fe,null);if(typeof Q.then=="function")return se(Y,U,Rc(Q),fe);if(Q.$$typeof===C)return se(Y,U,yc(Y,Q),fe);kc(Y,Q)}return null}function ne(Y,U,Q,fe,Te){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return Y=Y.get(Q)||null,k(U,Y,""+fe,Te);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case y:return Y=Y.get(fe.key===null?Q:fe.key)||null,B(U,Y,fe,Te);case v:return Y=Y.get(fe.key===null?Q:fe.key)||null,ee(U,Y,fe,Te);case F:var Je=fe._init;return fe=Je(fe._payload),ne(Y,U,Q,fe,Te)}if(me(fe)||K(fe))return Y=Y.get(Q)||null,ue(U,Y,fe,Te,null);if(typeof fe.then=="function")return ne(Y,U,Q,Rc(fe),Te);if(fe.$$typeof===C)return ne(Y,U,Q,yc(U,fe),Te);kc(U,fe)}return null}function Fe(Y,U,Q,fe){for(var Te=null,Je=null,Re=U,He=U=0,ns=null;Re!==null&&He<Q.length;He++){Re.index>He?(ns=Re,Re=null):ns=Re.sibling;var rt=se(Y,Re,Q[He],fe);if(rt===null){Re===null&&(Re=ns);break}a&&Re&&rt.alternate===null&&o(Y,Re),U=b(rt,U,He),Je===null?Te=rt:Je.sibling=rt,Je=rt,Re=ns}if(He===Q.length)return d(Y,Re),ot&&mi(Y,He),Te;if(Re===null){for(;He<Q.length;He++)Re=pe(Y,Q[He],fe),Re!==null&&(U=b(Re,U,He),Je===null?Te=Re:Je.sibling=Re,Je=Re);return ot&&mi(Y,He),Te}for(Re=f(Re);He<Q.length;He++)ns=ne(Re,Y,He,Q[He],fe),ns!==null&&(a&&ns.alternate!==null&&Re.delete(ns.key===null?He:ns.key),U=b(ns,U,He),Je===null?Te=ns:Je.sibling=ns,Je=ns);return a&&Re.forEach(function(qa){return o(Y,qa)}),ot&&mi(Y,He),Te}function Be(Y,U,Q,fe){if(Q==null)throw Error(s(151));for(var Te=null,Je=null,Re=U,He=U=0,ns=null,rt=Q.next();Re!==null&&!rt.done;He++,rt=Q.next()){Re.index>He?(ns=Re,Re=null):ns=Re.sibling;var qa=se(Y,Re,rt.value,fe);if(qa===null){Re===null&&(Re=ns);break}a&&Re&&qa.alternate===null&&o(Y,Re),U=b(qa,U,He),Je===null?Te=qa:Je.sibling=qa,Je=qa,Re=ns}if(rt.done)return d(Y,Re),ot&&mi(Y,He),Te;if(Re===null){for(;!rt.done;He++,rt=Q.next())rt=pe(Y,rt.value,fe),rt!==null&&(U=b(rt,U,He),Je===null?Te=rt:Je.sibling=rt,Je=rt);return ot&&mi(Y,He),Te}for(Re=f(Re);!rt.done;He++,rt=Q.next())rt=ne(Re,Y,He,rt.value,fe),rt!==null&&(a&&rt.alternate!==null&&Re.delete(rt.key===null?He:rt.key),U=b(rt,U,He),Je===null?Te=rt:Je.sibling=rt,Je=rt);return a&&Re.forEach(function(Gj){return o(Y,Gj)}),ot&&mi(Y,He),Te}function gt(Y,U,Q,fe){if(typeof Q=="object"&&Q!==null&&Q.type===w&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case y:e:{for(var Te=Q.key;U!==null;){if(U.key===Te){if(Te=Q.type,Te===w){if(U.tag===7){d(Y,U.sibling),fe=g(U,Q.props.children),fe.return=Y,Y=fe;break e}}else if(U.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===F&&p0(Te)===U.type){d(Y,U.sibling),fe=g(U,Q.props),Ol(fe,Q),fe.return=Y,Y=fe;break e}d(Y,U);break}else o(Y,U);U=U.sibling}Q.type===w?(fe=hi(Q.props.children,Y.mode,fe,Q.key),fe.return=Y,Y=fe):(fe=mc(Q.type,Q.key,Q.props,null,Y.mode,fe),Ol(fe,Q),fe.return=Y,Y=fe)}return j(Y);case v:e:{for(Te=Q.key;U!==null;){if(U.key===Te)if(U.tag===4&&U.stateNode.containerInfo===Q.containerInfo&&U.stateNode.implementation===Q.implementation){d(Y,U.sibling),fe=g(U,Q.children||[]),fe.return=Y,Y=fe;break e}else{d(Y,U);break}else o(Y,U);U=U.sibling}fe=fh(Q,Y.mode,fe),fe.return=Y,Y=fe}return j(Y);case F:return Te=Q._init,Q=Te(Q._payload),gt(Y,U,Q,fe)}if(me(Q))return Fe(Y,U,Q,fe);if(K(Q)){if(Te=K(Q),typeof Te!="function")throw Error(s(150));return Q=Te.call(Q),Be(Y,U,Q,fe)}if(typeof Q.then=="function")return gt(Y,U,Rc(Q),fe);if(Q.$$typeof===C)return gt(Y,U,yc(Y,Q),fe);kc(Y,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,U!==null&&U.tag===6?(d(Y,U.sibling),fe=g(U,Q),fe.return=Y,Y=fe):(d(Y,U),fe=hh(Q,Y.mode,fe),fe.return=Y,Y=fe),j(Y)):d(Y,U)}return function(Y,U,Q,fe){try{Ll=0;var Te=gt(Y,U,Q,fe);return Ar=null,Te}catch(Re){if(Re===jl||Re===vc)throw Re;var Je=$s(29,Re,null,Y.mode);return Je.lanes=fe,Je.return=Y,Je}finally{}}}var Nr=g0(!0),x0=g0(!1),cn=V(null),On=null;function Ca(a){var o=a.alternate;G(Kt,Kt.current&1),G(cn,a),On===null&&(o===null||yr.current!==null||o.memoizedState!==null)&&(On=a)}function y0(a){if(a.tag===22){if(G(Kt,Kt.current),G(cn,a),On===null){var o=a.alternate;o!==null&&o.memoizedState!==null&&(On=a)}}else Ta()}function Ta(){G(Kt,Kt.current),G(cn,cn.current)}function ia(a){M(cn),On===a&&(On=null),M(Kt)}var Kt=V(0);function Mc(a){for(var o=a;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||Pf(d)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Gh(a,o,d,f){o=a.memoizedState,d=d(f,o),d=d==null?o:p({},o,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var Yh={enqueueSetState:function(a,o,d){a=a._reactInternals;var f=Xs(),g=ja(f);g.payload=o,d!=null&&(g.callback=d),o=Ea(a,g,f),o!==null&&(Qs(o,a,f),_l(o,a,f))},enqueueReplaceState:function(a,o,d){a=a._reactInternals;var f=Xs(),g=ja(f);g.tag=1,g.payload=o,d!=null&&(g.callback=d),o=Ea(a,g,f),o!==null&&(Qs(o,a,f),_l(o,a,f))},enqueueForceUpdate:function(a,o){a=a._reactInternals;var d=Xs(),f=ja(d);f.tag=2,o!=null&&(f.callback=o),o=Ea(a,f,d),o!==null&&(Qs(o,a,d),_l(o,a,d))}};function b0(a,o,d,f,g,b,j){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,b,j):o.prototype&&o.prototype.isPureReactComponent?!xl(d,f)||!xl(g,b):!0}function v0(a,o,d,f){a=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,f),o.state!==a&&Yh.enqueueReplaceState(o,o.state,null)}function wi(a,o){var d=o;if("ref"in o){d={};for(var f in o)f!=="ref"&&(d[f]=o[f])}if(a=a.defaultProps){d===o&&(d=p({},d));for(var g in a)d[g]===void 0&&(d[g]=a[g])}return d}var Lc=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function w0(a){Lc(a)}function A0(a){console.error(a)}function N0(a){Lc(a)}function Oc(a,o){try{var d=a.onUncaughtError;d(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function S0(a,o,d){try{var f=a.onCaughtError;f(d.value,{componentStack:d.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Wh(a,o,d){return d=ja(d),d.tag=3,d.payload={element:null},d.callback=function(){Oc(a,o)},d}function j0(a){return a=ja(a),a.tag=3,a}function E0(a,o,d,f){var g=d.type.getDerivedStateFromError;if(typeof g=="function"){var b=f.value;a.payload=function(){return g(b)},a.callback=function(){S0(o,d,f)}}var j=d.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(a.callback=function(){S0(o,d,f),typeof g!="function"&&(Oa===null?Oa=new Set([this]):Oa.add(this));var k=f.stack;this.componentDidCatch(f.value,{componentStack:k!==null?k:""})})}function GS(a,o,d,f,g){if(d.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=d.alternate,o!==null&&Al(o,d,g,!0),d=cn.current,d!==null){switch(d.tag){case 13:return On===null?bf():d.alternate===null&&Pt===0&&(Pt=3),d.flags&=-257,d.flags|=65536,d.lanes=g,f===Nh?d.flags|=16384:(o=d.updateQueue,o===null?d.updateQueue=new Set([f]):o.add(f),wf(a,f,g)),!1;case 22:return d.flags|=65536,f===Nh?d.flags|=16384:(o=d.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},d.updateQueue=o):(d=o.retryQueue,d===null?o.retryQueue=new Set([f]):d.add(f)),wf(a,f,g)),!1}throw Error(s(435,d.tag))}return wf(a,f,g),bf(),!1}if(ot)return o=cn.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,f!==gh&&(a=Error(s(422),{cause:f}),wl(an(a,d)))):(f!==gh&&(o=Error(s(423),{cause:f}),wl(an(o,d))),a=a.current.alternate,a.flags|=65536,g&=-g,a.lanes|=g,f=an(f,d),g=Wh(a.stateNode,f,g),Eh(a,g),Pt!==4&&(Pt=2)),!1;var b=Error(s(520),{cause:f});if(b=an(b,d),Ul===null?Ul=[b]:Ul.push(b),Pt!==4&&(Pt=2),o===null)return!0;f=an(f,d),d=o;do{switch(d.tag){case 3:return d.flags|=65536,a=g&-g,d.lanes|=a,a=Wh(d.stateNode,f,a),Eh(d,a),!1;case 1:if(o=d.type,b=d.stateNode,(d.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Oa===null||!Oa.has(b))))return d.flags|=65536,g&=-g,d.lanes|=g,g=j0(g),E0(g,a,d,f),Eh(d,g),!1}d=d.return}while(d!==null);return!1}var _0=Error(s(461)),ts=!1;function os(a,o,d,f){o.child=a===null?x0(o,null,d,f):Nr(o,a.child,d,f)}function C0(a,o,d,f,g){d=d.render;var b=o.ref;if("ref"in f){var j={};for(var k in f)k!=="ref"&&(j[k]=f[k])}else j=f;return yi(o),f=Rh(a,o,d,j,b,g),k=kh(),a!==null&&!ts?(Mh(a,o,g),ra(a,o,g)):(ot&&k&&mh(o),o.flags|=1,os(a,o,f,g),o.child)}function T0(a,o,d,f,g){if(a===null){var b=d.type;return typeof b=="function"&&!uh(b)&&b.defaultProps===void 0&&d.compare===null?(o.tag=15,o.type=b,D0(a,o,b,f,g)):(a=mc(d.type,null,f,o,o.mode,g),a.ref=o.ref,a.return=o,o.child=a)}if(b=a.child,!sf(a,g)){var j=b.memoizedProps;if(d=d.compare,d=d!==null?d:xl,d(j,f)&&a.ref===o.ref)return ra(a,o,g)}return o.flags|=1,a=Jn(b,f),a.ref=o.ref,a.return=o,o.child=a}function D0(a,o,d,f,g){if(a!==null){var b=a.memoizedProps;if(xl(b,f)&&a.ref===o.ref)if(ts=!1,o.pendingProps=f=b,sf(a,g))(a.flags&131072)!==0&&(ts=!0);else return o.lanes=a.lanes,ra(a,o,g)}return Xh(a,o,d,f,g)}function R0(a,o,d){var f=o.pendingProps,g=f.children,b=a!==null?a.memoizedState:null;if(f.mode==="hidden"){if((o.flags&128)!==0){if(f=b!==null?b.baseLanes|d:d,a!==null){for(g=o.child=a.child,b=0;g!==null;)b=b|g.lanes|g.childLanes,g=g.sibling;o.childLanes=b&~f}else o.childLanes=0,o.child=null;return k0(a,o,f,d)}if((d&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},a!==null&&bc(o,b!==null?b.cachePool:null),b!==null?Dx(o,b):Ch(),y0(o);else return o.lanes=o.childLanes=536870912,k0(a,o,b!==null?b.baseLanes|d:d,d)}else b!==null?(bc(o,b.cachePool),Dx(o,b),Ta(),o.memoizedState=null):(a!==null&&bc(o,null),Ch(),Ta());return os(a,o,g,d),o.child}function k0(a,o,d,f){var g=Ah();return g=g===null?null:{parent:Zt._currentValue,pool:g},o.memoizedState={baseLanes:d,cachePool:g},a!==null&&bc(o,null),Ch(),y0(o),a!==null&&Al(a,o,f,!0),null}function Pc(a,o){var d=o.ref;if(d===null)a!==null&&a.ref!==null&&(o.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(s(284));(a===null||a.ref!==d)&&(o.flags|=4194816)}}function Xh(a,o,d,f,g){return yi(o),d=Rh(a,o,d,f,void 0,g),f=kh(),a!==null&&!ts?(Mh(a,o,g),ra(a,o,g)):(ot&&f&&mh(o),o.flags|=1,os(a,o,d,g),o.child)}function M0(a,o,d,f,g,b){return yi(o),o.updateQueue=null,d=kx(o,f,d,g),Rx(a),f=kh(),a!==null&&!ts?(Mh(a,o,b),ra(a,o,b)):(ot&&f&&mh(o),o.flags|=1,os(a,o,d,b),o.child)}function L0(a,o,d,f,g){if(yi(o),o.stateNode===null){var b=fr,j=d.contextType;typeof j=="object"&&j!==null&&(b=ps(j)),b=new d(f,b),o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=Yh,o.stateNode=b,b._reactInternals=o,b=o.stateNode,b.props=f,b.state=o.memoizedState,b.refs={},Sh(o),j=d.contextType,b.context=typeof j=="object"&&j!==null?ps(j):fr,b.state=o.memoizedState,j=d.getDerivedStateFromProps,typeof j=="function"&&(Gh(o,d,j,f),b.state=o.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(j=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),j!==b.state&&Yh.enqueueReplaceState(b,b.state,null),Tl(o,f,b,g),Cl(),b.state=o.memoizedState),typeof b.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(a===null){b=o.stateNode;var k=o.memoizedProps,B=wi(d,k);b.props=B;var ee=b.context,ue=d.contextType;j=fr,typeof ue=="object"&&ue!==null&&(j=ps(ue));var pe=d.getDerivedStateFromProps;ue=typeof pe=="function"||typeof b.getSnapshotBeforeUpdate=="function",k=o.pendingProps!==k,ue||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(k||ee!==j)&&v0(o,b,f,j),Sa=!1;var se=o.memoizedState;b.state=se,Tl(o,f,b,g),Cl(),ee=o.memoizedState,k||se!==ee||Sa?(typeof pe=="function"&&(Gh(o,d,pe,f),ee=o.memoizedState),(B=Sa||b0(o,d,B,f,se,ee,j))?(ue||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(o.flags|=4194308)):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=ee),b.props=f,b.state=ee,b.context=j,f=B):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{b=o.stateNode,jh(a,o),j=o.memoizedProps,ue=wi(d,j),b.props=ue,pe=o.pendingProps,se=b.context,ee=d.contextType,B=fr,typeof ee=="object"&&ee!==null&&(B=ps(ee)),k=d.getDerivedStateFromProps,(ee=typeof k=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(j!==pe||se!==B)&&v0(o,b,f,B),Sa=!1,se=o.memoizedState,b.state=se,Tl(o,f,b,g),Cl();var ne=o.memoizedState;j!==pe||se!==ne||Sa||a!==null&&a.dependencies!==null&&xc(a.dependencies)?(typeof k=="function"&&(Gh(o,d,k,f),ne=o.memoizedState),(ue=Sa||b0(o,d,ue,f,se,ne,B)||a!==null&&a.dependencies!==null&&xc(a.dependencies))?(ee||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(f,ne,B),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(f,ne,B)),typeof b.componentDidUpdate=="function"&&(o.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof b.componentDidUpdate!="function"||j===a.memoizedProps&&se===a.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&se===a.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=ne),b.props=f,b.state=ne,b.context=B,f=ue):(typeof b.componentDidUpdate!="function"||j===a.memoizedProps&&se===a.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&se===a.memoizedState||(o.flags|=1024),f=!1)}return b=f,Pc(a,o),f=(o.flags&128)!==0,b||f?(b=o.stateNode,d=f&&typeof d.getDerivedStateFromError!="function"?null:b.render(),o.flags|=1,a!==null&&f?(o.child=Nr(o,a.child,null,g),o.child=Nr(o,null,d,g)):os(a,o,d,g),o.memoizedState=b.state,a=o.child):a=ra(a,o,g),a}function O0(a,o,d,f){return vl(),o.flags|=256,os(a,o,d,f),o.child}var Qh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zh(a){return{baseLanes:a,cachePool:Ax()}}function Kh(a,o,d){return a=a!==null?a.childLanes&~d:0,o&&(a|=dn),a}function P0(a,o,d){var f=o.pendingProps,g=!1,b=(o.flags&128)!==0,j;if((j=b)||(j=a!==null&&a.memoizedState===null?!1:(Kt.current&2)!==0),j&&(g=!0,o.flags&=-129),j=(o.flags&32)!==0,o.flags&=-33,a===null){if(ot){if(g?Ca(o):Ta(),ot){var k=Ot,B;if(B=k){e:{for(B=k,k=Ln;B.nodeType!==8;){if(!k){k=null;break e}if(B=Nn(B.nextSibling),B===null){k=null;break e}}k=B}k!==null?(o.memoizedState={dehydrated:k,treeContext:fi!==null?{id:ea,overflow:ta}:null,retryLane:536870912,hydrationErrors:null},B=$s(18,null,null,0),B.stateNode=k,B.return=o,o.child=B,ws=o,Ot=null,B=!0):B=!1}B||gi(o)}if(k=o.memoizedState,k!==null&&(k=k.dehydrated,k!==null))return Pf(k)?o.lanes=32:o.lanes=536870912,null;ia(o)}return k=f.children,f=f.fallback,g?(Ta(),g=o.mode,k=Ic({mode:"hidden",children:k},g),f=hi(f,g,d,null),k.return=o,f.return=o,k.sibling=f,o.child=k,g=o.child,g.memoizedState=Zh(d),g.childLanes=Kh(a,j,d),o.memoizedState=Qh,f):(Ca(o),Jh(o,k))}if(B=a.memoizedState,B!==null&&(k=B.dehydrated,k!==null)){if(b)o.flags&256?(Ca(o),o.flags&=-257,o=ef(a,o,d)):o.memoizedState!==null?(Ta(),o.child=a.child,o.flags|=128,o=null):(Ta(),g=f.fallback,k=o.mode,f=Ic({mode:"visible",children:f.children},k),g=hi(g,k,d,null),g.flags|=2,f.return=o,g.return=o,f.sibling=g,o.child=f,Nr(o,a.child,null,d),f=o.child,f.memoizedState=Zh(d),f.childLanes=Kh(a,j,d),o.memoizedState=Qh,o=g);else if(Ca(o),Pf(k)){if(j=k.nextSibling&&k.nextSibling.dataset,j)var ee=j.dgst;j=ee,f=Error(s(419)),f.stack="",f.digest=j,wl({value:f,source:null,stack:null}),o=ef(a,o,d)}else if(ts||Al(a,o,d,!1),j=(d&a.childLanes)!==0,ts||j){if(j=Nt,j!==null&&(f=d&-d,f=(f&42)!==0?1:X(f),f=(f&(j.suspendedLanes|d))!==0?0:f,f!==0&&f!==B.retryLane))throw B.retryLane=f,hr(a,f),Qs(j,a,f),_0;k.data==="$?"||bf(),o=ef(a,o,d)}else k.data==="$?"?(o.flags|=192,o.child=a.child,o=null):(a=B.treeContext,Ot=Nn(k.nextSibling),ws=o,ot=!0,pi=null,Ln=!1,a!==null&&(ln[on++]=ea,ln[on++]=ta,ln[on++]=fi,ea=a.id,ta=a.overflow,fi=o),o=Jh(o,f.children),o.flags|=4096);return o}return g?(Ta(),g=f.fallback,k=o.mode,B=a.child,ee=B.sibling,f=Jn(B,{mode:"hidden",children:f.children}),f.subtreeFlags=B.subtreeFlags&65011712,ee!==null?g=Jn(ee,g):(g=hi(g,k,d,null),g.flags|=2),g.return=o,f.return=o,f.sibling=g,o.child=f,f=g,g=o.child,k=a.child.memoizedState,k===null?k=Zh(d):(B=k.cachePool,B!==null?(ee=Zt._currentValue,B=B.parent!==ee?{parent:ee,pool:ee}:B):B=Ax(),k={baseLanes:k.baseLanes|d,cachePool:B}),g.memoizedState=k,g.childLanes=Kh(a,j,d),o.memoizedState=Qh,f):(Ca(o),d=a.child,a=d.sibling,d=Jn(d,{mode:"visible",children:f.children}),d.return=o,d.sibling=null,a!==null&&(j=o.deletions,j===null?(o.deletions=[a],o.flags|=16):j.push(a)),o.child=d,o.memoizedState=null,d)}function Jh(a,o){return o=Ic({mode:"visible",children:o},a.mode),o.return=a,a.child=o}function Ic(a,o){return a=$s(22,a,null,o),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function ef(a,o,d){return Nr(o,a.child,null,d),a=Jh(o,o.pendingProps.children),a.flags|=2,o.memoizedState=null,a}function I0(a,o,d){a.lanes|=o;var f=a.alternate;f!==null&&(f.lanes|=o),yh(a.return,o,d)}function tf(a,o,d,f,g){var b=a.memoizedState;b===null?a.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:d,tailMode:g}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=f,b.tail=d,b.tailMode=g)}function B0(a,o,d){var f=o.pendingProps,g=f.revealOrder,b=f.tail;if(os(a,o,f.children,d),f=Kt.current,(f&2)!==0)f=f&1|2,o.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=o.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&I0(a,d,o);else if(a.tag===19)I0(a,d,o);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break e;for(;a.sibling===null;){if(a.return===null||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}f&=1}switch(G(Kt,f),g){case"forwards":for(d=o.child,g=null;d!==null;)a=d.alternate,a!==null&&Mc(a)===null&&(g=d),d=d.sibling;d=g,d===null?(g=o.child,o.child=null):(g=d.sibling,d.sibling=null),tf(o,!1,g,d,b);break;case"backwards":for(d=null,g=o.child,o.child=null;g!==null;){if(a=g.alternate,a!==null&&Mc(a)===null){o.child=g;break}a=g.sibling,g.sibling=d,d=g,g=a}tf(o,!0,d,null,b);break;case"together":tf(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function ra(a,o,d){if(a!==null&&(o.dependencies=a.dependencies),La|=o.lanes,(d&o.childLanes)===0)if(a!==null){if(Al(a,o,d,!1),(d&o.childLanes)===0)return null}else return null;if(a!==null&&o.child!==a.child)throw Error(s(153));if(o.child!==null){for(a=o.child,d=Jn(a,a.pendingProps),o.child=d,d.return=o;a.sibling!==null;)a=a.sibling,d=d.sibling=Jn(a,a.pendingProps),d.return=o;d.sibling=null}return o.child}function sf(a,o){return(a.lanes&o)!==0?!0:(a=a.dependencies,!!(a!==null&&xc(a)))}function YS(a,o,d){switch(o.tag){case 3:Le(o,o.stateNode.containerInfo),Na(o,Zt,a.memoizedState.cache),vl();break;case 27:case 5:$e(o);break;case 4:Le(o,o.stateNode.containerInfo);break;case 10:Na(o,o.type,o.memoizedProps.value);break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(Ca(o),o.flags|=128,null):(d&o.child.childLanes)!==0?P0(a,o,d):(Ca(o),a=ra(a,o,d),a!==null?a.sibling:null);Ca(o);break;case 19:var g=(a.flags&128)!==0;if(f=(d&o.childLanes)!==0,f||(Al(a,o,d,!1),f=(d&o.childLanes)!==0),g){if(f)return B0(a,o,d);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),G(Kt,Kt.current),f)break;return null;case 22:case 23:return o.lanes=0,R0(a,o,d);case 24:Na(o,Zt,a.memoizedState.cache)}return ra(a,o,d)}function H0(a,o,d){if(a!==null)if(a.memoizedProps!==o.pendingProps)ts=!0;else{if(!sf(a,d)&&(o.flags&128)===0)return ts=!1,YS(a,o,d);ts=(a.flags&131072)!==0}else ts=!1,ot&&(o.flags&1048576)!==0&&px(o,gc,o.index);switch(o.lanes=0,o.tag){case 16:e:{a=o.pendingProps;var f=o.elementType,g=f._init;if(f=g(f._payload),o.type=f,typeof f=="function")uh(f)?(a=wi(f,a),o.tag=1,o=L0(null,o,f,a,d)):(o.tag=0,o=Xh(null,o,f,a,d));else{if(f!=null){if(g=f.$$typeof,g===R){o.tag=11,o=C0(null,o,f,a,d);break e}else if(g===H){o.tag=14,o=T0(null,o,f,a,d);break e}}throw o=ce(f)||f,Error(s(306,o,""))}}return o;case 0:return Xh(a,o,o.type,o.pendingProps,d);case 1:return f=o.type,g=wi(f,o.pendingProps),L0(a,o,f,g,d);case 3:e:{if(Le(o,o.stateNode.containerInfo),a===null)throw Error(s(387));f=o.pendingProps;var b=o.memoizedState;g=b.element,jh(a,o),Tl(o,f,null,d);var j=o.memoizedState;if(f=j.cache,Na(o,Zt,f),f!==b.cache&&bh(o,[Zt],d,!0),Cl(),f=j.element,b.isDehydrated)if(b={element:f,isDehydrated:!1,cache:j.cache},o.updateQueue.baseState=b,o.memoizedState=b,o.flags&256){o=O0(a,o,f,d);break e}else if(f!==g){g=an(Error(s(424)),o),wl(g),o=O0(a,o,f,d);break e}else{switch(a=o.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Ot=Nn(a.firstChild),ws=o,ot=!0,pi=null,Ln=!0,d=x0(o,null,f,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(vl(),f===g){o=ra(a,o,d);break e}os(a,o,f,d)}o=o.child}return o;case 26:return Pc(a,o),a===null?(d=qy(o.type,null,o.pendingProps,null))?o.memoizedState=d:ot||(d=o.type,a=o.pendingProps,f=Zc(ye.current).createElement(d),f[bt]=o,f[St]=a,ds(f,d,a),es(f),o.stateNode=f):o.memoizedState=qy(o.type,a.memoizedProps,o.pendingProps,a.memoizedState),null;case 27:return $e(o),a===null&&ot&&(f=o.stateNode=zy(o.type,o.pendingProps,ye.current),ws=o,Ln=!0,g=Ot,Ba(o.type)?(If=g,Ot=Nn(f.firstChild)):Ot=g),os(a,o,o.pendingProps.children,d),Pc(a,o),a===null&&(o.flags|=4194304),o.child;case 5:return a===null&&ot&&((g=f=Ot)&&(f=wj(f,o.type,o.pendingProps,Ln),f!==null?(o.stateNode=f,ws=o,Ot=Nn(f.firstChild),Ln=!1,g=!0):g=!1),g||gi(o)),$e(o),g=o.type,b=o.pendingProps,j=a!==null?a.memoizedProps:null,f=b.children,Mf(g,b)?f=null:j!==null&&Mf(g,j)&&(o.flags|=32),o.memoizedState!==null&&(g=Rh(a,o,HS,null,null,d),Zl._currentValue=g),Pc(a,o),os(a,o,f,d),o.child;case 6:return a===null&&ot&&((a=d=Ot)&&(d=Aj(d,o.pendingProps,Ln),d!==null?(o.stateNode=d,ws=o,Ot=null,a=!0):a=!1),a||gi(o)),null;case 13:return P0(a,o,d);case 4:return Le(o,o.stateNode.containerInfo),f=o.pendingProps,a===null?o.child=Nr(o,null,f,d):os(a,o,f,d),o.child;case 11:return C0(a,o,o.type,o.pendingProps,d);case 7:return os(a,o,o.pendingProps,d),o.child;case 8:return os(a,o,o.pendingProps.children,d),o.child;case 12:return os(a,o,o.pendingProps.children,d),o.child;case 10:return f=o.pendingProps,Na(o,o.type,f.value),os(a,o,f.children,d),o.child;case 9:return g=o.type._context,f=o.pendingProps.children,yi(o),g=ps(g),f=f(g),o.flags|=1,os(a,o,f,d),o.child;case 14:return T0(a,o,o.type,o.pendingProps,d);case 15:return D0(a,o,o.type,o.pendingProps,d);case 19:return B0(a,o,d);case 31:return f=o.pendingProps,d=o.mode,f={mode:f.mode,children:f.children},a===null?(d=Ic(f,d),d.ref=o.ref,o.child=d,d.return=o,o=d):(d=Jn(a.child,f),d.ref=o.ref,o.child=d,d.return=o,o=d),o;case 22:return R0(a,o,d);case 24:return yi(o),f=ps(Zt),a===null?(g=Ah(),g===null&&(g=Nt,b=vh(),g.pooledCache=b,b.refCount++,b!==null&&(g.pooledCacheLanes|=d),g=b),o.memoizedState={parent:f,cache:g},Sh(o),Na(o,Zt,g)):((a.lanes&d)!==0&&(jh(a,o),Tl(o,null,null,d),Cl()),g=a.memoizedState,b=o.memoizedState,g.parent!==f?(g={parent:f,cache:f},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),Na(o,Zt,f)):(f=b.cache,Na(o,Zt,f),f!==g.cache&&bh(o,[Zt],d,!0))),os(a,o,o.pendingProps.children,d),o.child;case 29:throw o.pendingProps}throw Error(s(156,o.tag))}function la(a){a.flags|=4}function z0(a,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!Wy(o)){if(o=cn.current,o!==null&&((it&4194048)===it?On!==null:(it&62914560)!==it&&(it&536870912)===0||o!==On))throw El=Nh,Nx;a.flags|=8192}}function Bc(a,o){o!==null&&(a.flags|=4),a.flags&16384&&(o=a.tag!==22?xn():536870912,a.lanes|=o,_r|=o)}function Pl(a,o){if(!ot)switch(a.tailMode){case"hidden":o=a.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var f=null;d!==null;)d.alternate!==null&&(f=d),d=d.sibling;f===null?o||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function kt(a){var o=a.alternate!==null&&a.alternate.child===a.child,d=0,f=0;if(o)for(var g=a.child;g!==null;)d|=g.lanes|g.childLanes,f|=g.subtreeFlags&65011712,f|=g.flags&65011712,g.return=a,g=g.sibling;else for(g=a.child;g!==null;)d|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=a,g=g.sibling;return a.subtreeFlags|=f,a.childLanes=d,o}function WS(a,o,d){var f=o.pendingProps;switch(ph(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kt(o),null;case 1:return kt(o),null;case 3:return d=o.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),na(Zt),he(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(a===null||a.child===null)&&(bl(o)?la(o):a===null||a.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,yx())),kt(o),null;case 26:return d=o.memoizedState,a===null?(la(o),d!==null?(kt(o),z0(o,d)):(kt(o),o.flags&=-16777217)):d?d!==a.memoizedState?(la(o),kt(o),z0(o,d)):(kt(o),o.flags&=-16777217):(a.memoizedProps!==f&&la(o),kt(o),o.flags&=-16777217),null;case 27:ge(o),d=ye.current;var g=o.type;if(a!==null&&o.stateNode!=null)a.memoizedProps!==f&&la(o);else{if(!f){if(o.stateNode===null)throw Error(s(166));return kt(o),null}a=de.current,bl(o)?gx(o):(a=zy(g,f,d),o.stateNode=a,la(o))}return kt(o),null;case 5:if(ge(o),d=o.type,a!==null&&o.stateNode!=null)a.memoizedProps!==f&&la(o);else{if(!f){if(o.stateNode===null)throw Error(s(166));return kt(o),null}if(a=de.current,bl(o))gx(o);else{switch(g=Zc(ye.current),a){case 1:a=g.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:a=g.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":a=g.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":a=g.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":a=g.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof f.is=="string"?g.createElement("select",{is:f.is}):g.createElement("select"),f.multiple?a.multiple=!0:f.size&&(a.size=f.size);break;default:a=typeof f.is=="string"?g.createElement(d,{is:f.is}):g.createElement(d)}}a[bt]=o,a[St]=f;e:for(g=o.child;g!==null;){if(g.tag===5||g.tag===6)a.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===o)break e;for(;g.sibling===null;){if(g.return===null||g.return===o)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}o.stateNode=a;e:switch(ds(a,d,f),d){case"button":case"input":case"select":case"textarea":a=!!f.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&la(o)}}return kt(o),o.flags&=-16777217,null;case 6:if(a&&o.stateNode!=null)a.memoizedProps!==f&&la(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(s(166));if(a=ye.current,bl(o)){if(a=o.stateNode,d=o.memoizedProps,f=null,g=ws,g!==null)switch(g.tag){case 27:case 5:f=g.memoizedProps}a[bt]=o,a=!!(a.nodeValue===d||f!==null&&f.suppressHydrationWarning===!0||My(a.nodeValue,d)),a||gi(o)}else a=Zc(a).createTextNode(f),a[bt]=o,o.stateNode=a}return kt(o),null;case 13:if(f=o.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(g=bl(o),f!==null&&f.dehydrated!==null){if(a===null){if(!g)throw Error(s(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(s(317));g[bt]=o}else vl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;kt(o),g=!1}else g=yx(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(ia(o),o):(ia(o),null)}if(ia(o),(o.flags&128)!==0)return o.lanes=d,o;if(d=f!==null,a=a!==null&&a.memoizedState!==null,d){f=o.child,g=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(g=f.alternate.memoizedState.cachePool.pool);var b=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(b=f.memoizedState.cachePool.pool),b!==g&&(f.flags|=2048)}return d!==a&&d&&(o.child.flags|=8192),Bc(o,o.updateQueue),kt(o),null;case 4:return he(),a===null&&Cf(o.stateNode.containerInfo),kt(o),null;case 10:return na(o.type),kt(o),null;case 19:if(M(Kt),g=o.memoizedState,g===null)return kt(o),null;if(f=(o.flags&128)!==0,b=g.rendering,b===null)if(f)Pl(g,!1);else{if(Pt!==0||a!==null&&(a.flags&128)!==0)for(a=o.child;a!==null;){if(b=Mc(a),b!==null){for(o.flags|=128,Pl(g,!1),a=b.updateQueue,o.updateQueue=a,Bc(o,a),o.subtreeFlags=0,a=d,d=o.child;d!==null;)mx(d,a),d=d.sibling;return G(Kt,Kt.current&1|2),o.child}a=a.sibling}g.tail!==null&&Ee()>Fc&&(o.flags|=128,f=!0,Pl(g,!1),o.lanes=4194304)}else{if(!f)if(a=Mc(b),a!==null){if(o.flags|=128,f=!0,a=a.updateQueue,o.updateQueue=a,Bc(o,a),Pl(g,!0),g.tail===null&&g.tailMode==="hidden"&&!b.alternate&&!ot)return kt(o),null}else 2*Ee()-g.renderingStartTime>Fc&&d!==536870912&&(o.flags|=128,f=!0,Pl(g,!1),o.lanes=4194304);g.isBackwards?(b.sibling=o.child,o.child=b):(a=g.last,a!==null?a.sibling=b:o.child=b,g.last=b)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=Ee(),o.sibling=null,a=Kt.current,G(Kt,f?a&1|2:a&1),o):(kt(o),null);case 22:case 23:return ia(o),Th(),f=o.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(d&536870912)!==0&&(o.flags&128)===0&&(kt(o),o.subtreeFlags&6&&(o.flags|=8192)):kt(o),d=o.updateQueue,d!==null&&Bc(o,d.retryQueue),d=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==d&&(o.flags|=2048),a!==null&&M(bi),null;case 24:return d=null,a!==null&&(d=a.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),na(Zt),kt(o),null;case 25:return null;case 30:return null}throw Error(s(156,o.tag))}function XS(a,o){switch(ph(o),o.tag){case 1:return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 3:return na(Zt),he(),a=o.flags,(a&65536)!==0&&(a&128)===0?(o.flags=a&-65537|128,o):null;case 26:case 27:case 5:return ge(o),null;case 13:if(ia(o),a=o.memoizedState,a!==null&&a.dehydrated!==null){if(o.alternate===null)throw Error(s(340));vl()}return a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 19:return M(Kt),null;case 4:return he(),null;case 10:return na(o.type),null;case 22:case 23:return ia(o),Th(),a!==null&&M(bi),a=o.flags,a&65536?(o.flags=a&-65537|128,o):null;case 24:return na(Zt),null;case 25:return null;default:return null}}function F0(a,o){switch(ph(o),o.tag){case 3:na(Zt),he();break;case 26:case 27:case 5:ge(o);break;case 4:he();break;case 13:ia(o);break;case 19:M(Kt);break;case 10:na(o.type);break;case 22:case 23:ia(o),Th(),a!==null&&M(bi);break;case 24:na(Zt)}}function Il(a,o){try{var d=o.updateQueue,f=d!==null?d.lastEffect:null;if(f!==null){var g=f.next;d=g;do{if((d.tag&a)===a){f=void 0;var b=d.create,j=d.inst;f=b(),j.destroy=f}d=d.next}while(d!==g)}}catch(k){vt(o,o.return,k)}}function Da(a,o,d){try{var f=o.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var b=g.next;f=b;do{if((f.tag&a)===a){var j=f.inst,k=j.destroy;if(k!==void 0){j.destroy=void 0,g=o;var B=d,ee=k;try{ee()}catch(ue){vt(g,B,ue)}}}f=f.next}while(f!==b)}}catch(ue){vt(o,o.return,ue)}}function U0(a){var o=a.updateQueue;if(o!==null){var d=a.stateNode;try{Tx(o,d)}catch(f){vt(a,a.return,f)}}}function q0(a,o,d){d.props=wi(a.type,a.memoizedProps),d.state=a.memoizedState;try{d.componentWillUnmount()}catch(f){vt(a,o,f)}}function Bl(a,o){try{var d=a.ref;if(d!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof d=="function"?a.refCleanup=d(f):d.current=f}}catch(g){vt(a,o,g)}}function Pn(a,o){var d=a.ref,f=a.refCleanup;if(d!==null)if(typeof f=="function")try{f()}catch(g){vt(a,o,g)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(g){vt(a,o,g)}else d.current=null}function V0(a){var o=a.type,d=a.memoizedProps,f=a.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":d.autoFocus&&f.focus();break e;case"img":d.src?f.src=d.src:d.srcSet&&(f.srcset=d.srcSet)}}catch(g){vt(a,a.return,g)}}function nf(a,o,d){try{var f=a.stateNode;gj(f,a.type,d,o),f[St]=o}catch(g){vt(a,a.return,g)}}function $0(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Ba(a.type)||a.tag===4}function af(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||$0(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Ba(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function rf(a,o,d){var f=a.tag;if(f===5||f===6)a=a.stateNode,o?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(a,o):(o=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,o.appendChild(a),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=Qc));else if(f!==4&&(f===27&&Ba(a.type)&&(d=a.stateNode,o=null),a=a.child,a!==null))for(rf(a,o,d),a=a.sibling;a!==null;)rf(a,o,d),a=a.sibling}function Hc(a,o,d){var f=a.tag;if(f===5||f===6)a=a.stateNode,o?d.insertBefore(a,o):d.appendChild(a);else if(f!==4&&(f===27&&Ba(a.type)&&(d=a.stateNode),a=a.child,a!==null))for(Hc(a,o,d),a=a.sibling;a!==null;)Hc(a,o,d),a=a.sibling}function G0(a){var o=a.stateNode,d=a.memoizedProps;try{for(var f=a.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);ds(o,f,d),o[bt]=a,o[St]=d}catch(b){vt(a,a.return,b)}}var oa=!1,Ht=!1,lf=!1,Y0=typeof WeakSet=="function"?WeakSet:Set,ss=null;function QS(a,o){if(a=a.containerInfo,Rf=nd,a=ax(a),ah(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var f=d.getSelection&&d.getSelection();if(f&&f.rangeCount!==0){d=f.anchorNode;var g=f.anchorOffset,b=f.focusNode;f=f.focusOffset;try{d.nodeType,b.nodeType}catch{d=null;break e}var j=0,k=-1,B=-1,ee=0,ue=0,pe=a,se=null;t:for(;;){for(var ne;pe!==d||g!==0&&pe.nodeType!==3||(k=j+g),pe!==b||f!==0&&pe.nodeType!==3||(B=j+f),pe.nodeType===3&&(j+=pe.nodeValue.length),(ne=pe.firstChild)!==null;)se=pe,pe=ne;for(;;){if(pe===a)break t;if(se===d&&++ee===g&&(k=j),se===b&&++ue===f&&(B=j),(ne=pe.nextSibling)!==null)break;pe=se,se=pe.parentNode}pe=ne}d=k===-1||B===-1?null:{start:k,end:B}}else d=null}d=d||{start:0,end:0}}else d=null;for(kf={focusedElem:a,selectionRange:d},nd=!1,ss=o;ss!==null;)if(o=ss,a=o.child,(o.subtreeFlags&1024)!==0&&a!==null)a.return=o,ss=a;else for(;ss!==null;){switch(o=ss,b=o.alternate,a=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&b!==null){a=void 0,d=o,g=b.memoizedProps,b=b.memoizedState,f=d.stateNode;try{var Fe=wi(d.type,g,d.elementType===d.type);a=f.getSnapshotBeforeUpdate(Fe,b),f.__reactInternalSnapshotBeforeUpdate=a}catch(Be){vt(d,d.return,Be)}}break;case 3:if((a&1024)!==0){if(a=o.stateNode.containerInfo,d=a.nodeType,d===9)Of(a);else if(d===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Of(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(s(163))}if(a=o.sibling,a!==null){a.return=o.return,ss=a;break}ss=o.return}}function W0(a,o,d){var f=d.flags;switch(d.tag){case 0:case 11:case 15:Ra(a,d),f&4&&Il(5,d);break;case 1:if(Ra(a,d),f&4)if(a=d.stateNode,o===null)try{a.componentDidMount()}catch(j){vt(d,d.return,j)}else{var g=wi(d.type,o.memoizedProps);o=o.memoizedState;try{a.componentDidUpdate(g,o,a.__reactInternalSnapshotBeforeUpdate)}catch(j){vt(d,d.return,j)}}f&64&&U0(d),f&512&&Bl(d,d.return);break;case 3:if(Ra(a,d),f&64&&(a=d.updateQueue,a!==null)){if(o=null,d.child!==null)switch(d.child.tag){case 27:case 5:o=d.child.stateNode;break;case 1:o=d.child.stateNode}try{Tx(a,o)}catch(j){vt(d,d.return,j)}}break;case 27:o===null&&f&4&&G0(d);case 26:case 5:Ra(a,d),o===null&&f&4&&V0(d),f&512&&Bl(d,d.return);break;case 12:Ra(a,d);break;case 13:Ra(a,d),f&4&&Z0(a,d),f&64&&(a=d.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(d=ij.bind(null,d),Nj(a,d))));break;case 22:if(f=d.memoizedState!==null||oa,!f){o=o!==null&&o.memoizedState!==null||Ht,g=oa;var b=Ht;oa=f,(Ht=o)&&!b?ka(a,d,(d.subtreeFlags&8772)!==0):Ra(a,d),oa=g,Ht=b}break;case 30:break;default:Ra(a,d)}}function X0(a){var o=a.alternate;o!==null&&(a.alternate=null,X0(o)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(o=a.stateNode,o!==null&&ms(o)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var jt=null,ks=!1;function ca(a,o,d){for(d=d.child;d!==null;)Q0(a,o,d),d=d.sibling}function Q0(a,o,d){if(_e&&typeof _e.onCommitFiberUnmount=="function")try{_e.onCommitFiberUnmount(Ne,d)}catch{}switch(d.tag){case 26:Ht||Pn(d,o),ca(a,o,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Ht||Pn(d,o);var f=jt,g=ks;Ba(d.type)&&(jt=d.stateNode,ks=!1),ca(a,o,d),Yl(d.stateNode),jt=f,ks=g;break;case 5:Ht||Pn(d,o);case 6:if(f=jt,g=ks,jt=null,ca(a,o,d),jt=f,ks=g,jt!==null)if(ks)try{(jt.nodeType===9?jt.body:jt.nodeName==="HTML"?jt.ownerDocument.body:jt).removeChild(d.stateNode)}catch(b){vt(d,o,b)}else try{jt.removeChild(d.stateNode)}catch(b){vt(d,o,b)}break;case 18:jt!==null&&(ks?(a=jt,By(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,d.stateNode),to(a)):By(jt,d.stateNode));break;case 4:f=jt,g=ks,jt=d.stateNode.containerInfo,ks=!0,ca(a,o,d),jt=f,ks=g;break;case 0:case 11:case 14:case 15:Ht||Da(2,d,o),Ht||Da(4,d,o),ca(a,o,d);break;case 1:Ht||(Pn(d,o),f=d.stateNode,typeof f.componentWillUnmount=="function"&&q0(d,o,f)),ca(a,o,d);break;case 21:ca(a,o,d);break;case 22:Ht=(f=Ht)||d.memoizedState!==null,ca(a,o,d),Ht=f;break;default:ca(a,o,d)}}function Z0(a,o){if(o.memoizedState===null&&(a=o.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{to(a)}catch(d){vt(o,o.return,d)}}function ZS(a){switch(a.tag){case 13:case 19:var o=a.stateNode;return o===null&&(o=a.stateNode=new Y0),o;case 22:return a=a.stateNode,o=a._retryCache,o===null&&(o=a._retryCache=new Y0),o;default:throw Error(s(435,a.tag))}}function of(a,o){var d=ZS(a);o.forEach(function(f){var g=rj.bind(null,a,f);d.has(f)||(d.add(f),f.then(g,g))})}function Gs(a,o){var d=o.deletions;if(d!==null)for(var f=0;f<d.length;f++){var g=d[f],b=a,j=o,k=j;e:for(;k!==null;){switch(k.tag){case 27:if(Ba(k.type)){jt=k.stateNode,ks=!1;break e}break;case 5:jt=k.stateNode,ks=!1;break e;case 3:case 4:jt=k.stateNode.containerInfo,ks=!0;break e}k=k.return}if(jt===null)throw Error(s(160));Q0(b,j,g),jt=null,ks=!1,b=g.alternate,b!==null&&(b.return=null),g.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)K0(o,a),o=o.sibling}var An=null;function K0(a,o){var d=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Gs(o,a),Ys(a),f&4&&(Da(3,a,a.return),Il(3,a),Da(5,a,a.return));break;case 1:Gs(o,a),Ys(a),f&512&&(Ht||d===null||Pn(d,d.return)),f&64&&oa&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(d=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=d===null?f:d.concat(f))));break;case 26:var g=An;if(Gs(o,a),Ys(a),f&512&&(Ht||d===null||Pn(d,d.return)),f&4){var b=d!==null?d.memoizedState:null;if(f=a.memoizedState,d===null)if(f===null)if(a.stateNode===null){e:{f=a.type,d=a.memoizedProps,g=g.ownerDocument||g;t:switch(f){case"title":b=g.getElementsByTagName("title")[0],(!b||b[bn]||b[bt]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=g.createElement(f),g.head.insertBefore(b,g.querySelector("head > title"))),ds(b,f,d),b[bt]=a,es(b),f=b;break e;case"link":var j=Gy("link","href",g).get(f+(d.href||""));if(j){for(var k=0;k<j.length;k++)if(b=j[k],b.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&b.getAttribute("rel")===(d.rel==null?null:d.rel)&&b.getAttribute("title")===(d.title==null?null:d.title)&&b.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){j.splice(k,1);break t}}b=g.createElement(f),ds(b,f,d),g.head.appendChild(b);break;case"meta":if(j=Gy("meta","content",g).get(f+(d.content||""))){for(k=0;k<j.length;k++)if(b=j[k],b.getAttribute("content")===(d.content==null?null:""+d.content)&&b.getAttribute("name")===(d.name==null?null:d.name)&&b.getAttribute("property")===(d.property==null?null:d.property)&&b.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&b.getAttribute("charset")===(d.charSet==null?null:d.charSet)){j.splice(k,1);break t}}b=g.createElement(f),ds(b,f,d),g.head.appendChild(b);break;default:throw Error(s(468,f))}b[bt]=a,es(b),f=b}a.stateNode=f}else Yy(g,a.type,a.stateNode);else a.stateNode=$y(g,f,a.memoizedProps);else b!==f?(b===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):b.count--,f===null?Yy(g,a.type,a.stateNode):$y(g,f,a.memoizedProps)):f===null&&a.stateNode!==null&&nf(a,a.memoizedProps,d.memoizedProps)}break;case 27:Gs(o,a),Ys(a),f&512&&(Ht||d===null||Pn(d,d.return)),d!==null&&f&4&&nf(a,a.memoizedProps,d.memoizedProps);break;case 5:if(Gs(o,a),Ys(a),f&512&&(Ht||d===null||Pn(d,d.return)),a.flags&32){g=a.stateNode;try{ir(g,"")}catch(ne){vt(a,a.return,ne)}}f&4&&a.stateNode!=null&&(g=a.memoizedProps,nf(a,g,d!==null?d.memoizedProps:g)),f&1024&&(lf=!0);break;case 6:if(Gs(o,a),Ys(a),f&4){if(a.stateNode===null)throw Error(s(162));f=a.memoizedProps,d=a.stateNode;try{d.nodeValue=f}catch(ne){vt(a,a.return,ne)}}break;case 3:if(ed=null,g=An,An=Kc(o.containerInfo),Gs(o,a),An=g,Ys(a),f&4&&d!==null&&d.memoizedState.isDehydrated)try{to(o.containerInfo)}catch(ne){vt(a,a.return,ne)}lf&&(lf=!1,J0(a));break;case 4:f=An,An=Kc(a.stateNode.containerInfo),Gs(o,a),Ys(a),An=f;break;case 12:Gs(o,a),Ys(a);break;case 13:Gs(o,a),Ys(a),a.child.flags&8192&&a.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(mf=Ee()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,of(a,f)));break;case 22:g=a.memoizedState!==null;var B=d!==null&&d.memoizedState!==null,ee=oa,ue=Ht;if(oa=ee||g,Ht=ue||B,Gs(o,a),Ht=ue,oa=ee,Ys(a),f&8192)e:for(o=a.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(d===null||B||oa||Ht||Ai(a)),d=null,o=a;;){if(o.tag===5||o.tag===26){if(d===null){B=d=o;try{if(b=B.stateNode,g)j=b.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none";else{k=B.stateNode;var pe=B.memoizedProps.style,se=pe!=null&&pe.hasOwnProperty("display")?pe.display:null;k.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(ne){vt(B,B.return,ne)}}}else if(o.tag===6){if(d===null){B=o;try{B.stateNode.nodeValue=g?"":B.memoizedProps}catch(ne){vt(B,B.return,ne)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===a)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;d===o&&(d=null),o=o.return}d===o&&(d=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=a.updateQueue,f!==null&&(d=f.retryQueue,d!==null&&(f.retryQueue=null,of(a,d))));break;case 19:Gs(o,a),Ys(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,of(a,f)));break;case 30:break;case 21:break;default:Gs(o,a),Ys(a)}}function Ys(a){var o=a.flags;if(o&2){try{for(var d,f=a.return;f!==null;){if($0(f)){d=f;break}f=f.return}if(d==null)throw Error(s(160));switch(d.tag){case 27:var g=d.stateNode,b=af(a);Hc(a,b,g);break;case 5:var j=d.stateNode;d.flags&32&&(ir(j,""),d.flags&=-33);var k=af(a);Hc(a,k,j);break;case 3:case 4:var B=d.stateNode.containerInfo,ee=af(a);rf(a,ee,B);break;default:throw Error(s(161))}}catch(ue){vt(a,a.return,ue)}a.flags&=-3}o&4096&&(a.flags&=-4097)}function J0(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var o=a;J0(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),a=a.sibling}}function Ra(a,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)W0(a,o.alternate,o),o=o.sibling}function Ai(a){for(a=a.child;a!==null;){var o=a;switch(o.tag){case 0:case 11:case 14:case 15:Da(4,o,o.return),Ai(o);break;case 1:Pn(o,o.return);var d=o.stateNode;typeof d.componentWillUnmount=="function"&&q0(o,o.return,d),Ai(o);break;case 27:Yl(o.stateNode);case 26:case 5:Pn(o,o.return),Ai(o);break;case 22:o.memoizedState===null&&Ai(o);break;case 30:Ai(o);break;default:Ai(o)}a=a.sibling}}function ka(a,o,d){for(d=d&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,g=a,b=o,j=b.flags;switch(b.tag){case 0:case 11:case 15:ka(g,b,d),Il(4,b);break;case 1:if(ka(g,b,d),f=b,g=f.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(ee){vt(f,f.return,ee)}if(f=b,g=f.updateQueue,g!==null){var k=f.stateNode;try{var B=g.shared.hiddenCallbacks;if(B!==null)for(g.shared.hiddenCallbacks=null,g=0;g<B.length;g++)Cx(B[g],k)}catch(ee){vt(f,f.return,ee)}}d&&j&64&&U0(b),Bl(b,b.return);break;case 27:G0(b);case 26:case 5:ka(g,b,d),d&&f===null&&j&4&&V0(b),Bl(b,b.return);break;case 12:ka(g,b,d);break;case 13:ka(g,b,d),d&&j&4&&Z0(g,b);break;case 22:b.memoizedState===null&&ka(g,b,d),Bl(b,b.return);break;case 30:break;default:ka(g,b,d)}o=o.sibling}}function cf(a,o){var d=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),a=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(a=o.memoizedState.cachePool.pool),a!==d&&(a!=null&&a.refCount++,d!=null&&Nl(d))}function df(a,o){a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Nl(a))}function In(a,o,d,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)ey(a,o,d,f),o=o.sibling}function ey(a,o,d,f){var g=o.flags;switch(o.tag){case 0:case 11:case 15:In(a,o,d,f),g&2048&&Il(9,o);break;case 1:In(a,o,d,f);break;case 3:In(a,o,d,f),g&2048&&(a=null,o.alternate!==null&&(a=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==a&&(o.refCount++,a!=null&&Nl(a)));break;case 12:if(g&2048){In(a,o,d,f),a=o.stateNode;try{var b=o.memoizedProps,j=b.id,k=b.onPostCommit;typeof k=="function"&&k(j,o.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(B){vt(o,o.return,B)}}else In(a,o,d,f);break;case 13:In(a,o,d,f);break;case 23:break;case 22:b=o.stateNode,j=o.alternate,o.memoizedState!==null?b._visibility&2?In(a,o,d,f):Hl(a,o):b._visibility&2?In(a,o,d,f):(b._visibility|=2,Sr(a,o,d,f,(o.subtreeFlags&10256)!==0)),g&2048&&cf(j,o);break;case 24:In(a,o,d,f),g&2048&&df(o.alternate,o);break;default:In(a,o,d,f)}}function Sr(a,o,d,f,g){for(g=g&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var b=a,j=o,k=d,B=f,ee=j.flags;switch(j.tag){case 0:case 11:case 15:Sr(b,j,k,B,g),Il(8,j);break;case 23:break;case 22:var ue=j.stateNode;j.memoizedState!==null?ue._visibility&2?Sr(b,j,k,B,g):Hl(b,j):(ue._visibility|=2,Sr(b,j,k,B,g)),g&&ee&2048&&cf(j.alternate,j);break;case 24:Sr(b,j,k,B,g),g&&ee&2048&&df(j.alternate,j);break;default:Sr(b,j,k,B,g)}o=o.sibling}}function Hl(a,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var d=a,f=o,g=f.flags;switch(f.tag){case 22:Hl(d,f),g&2048&&cf(f.alternate,f);break;case 24:Hl(d,f),g&2048&&df(f.alternate,f);break;default:Hl(d,f)}o=o.sibling}}var zl=8192;function jr(a){if(a.subtreeFlags&zl)for(a=a.child;a!==null;)ty(a),a=a.sibling}function ty(a){switch(a.tag){case 26:jr(a),a.flags&zl&&a.memoizedState!==null&&Pj(An,a.memoizedState,a.memoizedProps);break;case 5:jr(a);break;case 3:case 4:var o=An;An=Kc(a.stateNode.containerInfo),jr(a),An=o;break;case 22:a.memoizedState===null&&(o=a.alternate,o!==null&&o.memoizedState!==null?(o=zl,zl=16777216,jr(a),zl=o):jr(a));break;default:jr(a)}}function sy(a){var o=a.alternate;if(o!==null&&(a=o.child,a!==null)){o.child=null;do o=a.sibling,a.sibling=null,a=o;while(a!==null)}}function Fl(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var d=0;d<o.length;d++){var f=o[d];ss=f,ay(f,a)}sy(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)ny(a),a=a.sibling}function ny(a){switch(a.tag){case 0:case 11:case 15:Fl(a),a.flags&2048&&Da(9,a,a.return);break;case 3:Fl(a);break;case 12:Fl(a);break;case 22:var o=a.stateNode;a.memoizedState!==null&&o._visibility&2&&(a.return===null||a.return.tag!==13)?(o._visibility&=-3,zc(a)):Fl(a);break;default:Fl(a)}}function zc(a){var o=a.deletions;if((a.flags&16)!==0){if(o!==null)for(var d=0;d<o.length;d++){var f=o[d];ss=f,ay(f,a)}sy(a)}for(a=a.child;a!==null;){switch(o=a,o.tag){case 0:case 11:case 15:Da(8,o,o.return),zc(o);break;case 22:d=o.stateNode,d._visibility&2&&(d._visibility&=-3,zc(o));break;default:zc(o)}a=a.sibling}}function ay(a,o){for(;ss!==null;){var d=ss;switch(d.tag){case 0:case 11:case 15:Da(8,d,o);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var f=d.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Nl(d.memoizedState.cache)}if(f=d.child,f!==null)f.return=d,ss=f;else e:for(d=a;ss!==null;){f=ss;var g=f.sibling,b=f.return;if(X0(f),f===d){ss=null;break e}if(g!==null){g.return=b,ss=g;break e}ss=b}}}var KS={getCacheForType:function(a){var o=ps(Zt),d=o.data.get(a);return d===void 0&&(d=a(),o.data.set(a,d)),d}},JS=typeof WeakMap=="function"?WeakMap:Map,ut=0,Nt=null,et=null,it=0,ht=0,Ws=null,Ma=!1,Er=!1,uf=!1,da=0,Pt=0,La=0,Ni=0,hf=0,dn=0,_r=0,Ul=null,Ms=null,ff=!1,mf=0,Fc=1/0,Uc=null,Oa=null,cs=0,Pa=null,Cr=null,Tr=0,pf=0,gf=null,iy=null,ql=0,xf=null;function Xs(){if((ut&2)!==0&&it!==0)return it&-it;if(L.T!==null){var a=gr;return a!==0?a:Sf()}return De()}function ry(){dn===0&&(dn=(it&536870912)===0||ot?ri():536870912);var a=cn.current;return a!==null&&(a.flags|=32),dn}function Qs(a,o,d){(a===Nt&&(ht===2||ht===9)||a.cancelPendingCommit!==null)&&(Dr(a,0),Ia(a,it,dn,!1)),Us(a,d),((ut&2)===0||a!==Nt)&&(a===Nt&&((ut&2)===0&&(Ni|=d),Pt===4&&Ia(a,it,dn,!1)),Bn(a))}function ly(a,o,d){if((ut&6)!==0)throw Error(s(327));var f=!d&&(o&124)===0&&(o&a.expiredLanes)===0||Fs(a,o),g=f?sj(a,o):vf(a,o,!0),b=f;do{if(g===0){Er&&!f&&Ia(a,o,0,!1);break}else{if(d=a.current.alternate,b&&!ej(d)){g=vf(a,o,!1),b=!1;continue}if(g===2){if(b=o,a.errorRecoveryDisabledLanes&b)var j=0;else j=a.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){o=j;e:{var k=a;g=Ul;var B=k.current.memoizedState.isDehydrated;if(B&&(Dr(k,j).flags|=256),j=vf(k,j,!1),j!==2){if(uf&&!B){k.errorRecoveryDisabledLanes|=b,Ni|=b,g=4;break e}b=Ms,Ms=g,b!==null&&(Ms===null?Ms=b:Ms.push.apply(Ms,b))}g=j}if(b=!1,g!==2)continue}}if(g===1){Dr(a,0),Ia(a,o,0,!0);break}e:{switch(f=a,b=g,b){case 0:case 1:throw Error(s(345));case 4:if((o&4194048)!==o)break;case 6:Ia(f,o,dn,!Ma);break e;case 2:Ms=null;break;case 3:case 5:break;default:throw Error(s(329))}if((o&62914560)===o&&(g=mf+300-Ee(),10<g)){if(Ia(f,o,dn,!Ma),gn(f,0,!0)!==0)break e;f.timeoutHandle=Py(oy.bind(null,f,d,Ms,Uc,ff,o,dn,Ni,_r,Ma,b,2,-0,0),g);break e}oy(f,d,Ms,Uc,ff,o,dn,Ni,_r,Ma,b,0,-0,0)}}break}while(!0);Bn(a)}function oy(a,o,d,f,g,b,j,k,B,ee,ue,pe,se,ne){if(a.timeoutHandle=-1,pe=o.subtreeFlags,(pe&8192||(pe&16785408)===16785408)&&(Ql={stylesheets:null,count:0,unsuspend:Oj},ty(o),pe=Ij(),pe!==null)){a.cancelPendingCommit=pe(py.bind(null,a,o,b,d,f,g,j,k,B,ue,1,se,ne)),Ia(a,b,j,!ee);return}py(a,o,b,d,f,g,j,k,B)}function ej(a){for(var o=a;;){var d=o.tag;if((d===0||d===11||d===15)&&o.flags&16384&&(d=o.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var f=0;f<d.length;f++){var g=d[f],b=g.getSnapshot;g=g.value;try{if(!Vs(b(),g))return!1}catch{return!1}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ia(a,o,d,f){o&=~hf,o&=~Ni,a.suspendedLanes|=o,a.pingedLanes&=~o,f&&(a.warmLanes|=o),f=a.expirationTimes;for(var g=o;0<g;){var b=31-dt(g),j=1<<b;f[b]=-1,g&=~j}d!==0&&Hu(a,d,o)}function qc(){return(ut&6)===0?(Vl(0),!1):!0}function yf(){if(et!==null){if(ht===0)var a=et.return;else a=et,sa=xi=null,Lh(a),Ar=null,Ll=0,a=et;for(;a!==null;)F0(a.alternate,a),a=a.return;et=null}}function Dr(a,o){var d=a.timeoutHandle;d!==-1&&(a.timeoutHandle=-1,yj(d)),d=a.cancelPendingCommit,d!==null&&(a.cancelPendingCommit=null,d()),yf(),Nt=a,et=d=Jn(a.current,null),it=o,ht=0,Ws=null,Ma=!1,Er=Fs(a,o),uf=!1,_r=dn=hf=Ni=La=Pt=0,Ms=Ul=null,ff=!1,(o&8)!==0&&(o|=o&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=o;0<f;){var g=31-dt(f),b=1<<g;o|=a[g],f&=~b}return da=o,uc(),d}function cy(a,o){Ke=null,L.H=Dc,o===jl||o===vc?(o=Ex(),ht=3):o===Nx?(o=Ex(),ht=4):ht=o===_0?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ws=o,et===null&&(Pt=1,Oc(a,an(o,a.current)))}function dy(){var a=L.H;return L.H=Dc,a===null?Dc:a}function uy(){var a=L.A;return L.A=KS,a}function bf(){Pt=4,Ma||(it&4194048)!==it&&cn.current!==null||(Er=!0),(La&134217727)===0&&(Ni&134217727)===0||Nt===null||Ia(Nt,it,dn,!1)}function vf(a,o,d){var f=ut;ut|=2;var g=dy(),b=uy();(Nt!==a||it!==o)&&(Uc=null,Dr(a,o)),o=!1;var j=Pt;e:do try{if(ht!==0&&et!==null){var k=et,B=Ws;switch(ht){case 8:yf(),j=6;break e;case 3:case 2:case 9:case 6:cn.current===null&&(o=!0);var ee=ht;if(ht=0,Ws=null,Rr(a,k,B,ee),d&&Er){j=0;break e}break;default:ee=ht,ht=0,Ws=null,Rr(a,k,B,ee)}}tj(),j=Pt;break}catch(ue){cy(a,ue)}while(!0);return o&&a.shellSuspendCounter++,sa=xi=null,ut=f,L.H=g,L.A=b,et===null&&(Nt=null,it=0,uc()),j}function tj(){for(;et!==null;)hy(et)}function sj(a,o){var d=ut;ut|=2;var f=dy(),g=uy();Nt!==a||it!==o?(Uc=null,Fc=Ee()+500,Dr(a,o)):Er=Fs(a,o);e:do try{if(ht!==0&&et!==null){o=et;var b=Ws;t:switch(ht){case 1:ht=0,Ws=null,Rr(a,o,b,1);break;case 2:case 9:if(Sx(b)){ht=0,Ws=null,fy(o);break}o=function(){ht!==2&&ht!==9||Nt!==a||(ht=7),Bn(a)},b.then(o,o);break e;case 3:ht=7;break e;case 4:ht=5;break e;case 7:Sx(b)?(ht=0,Ws=null,fy(o)):(ht=0,Ws=null,Rr(a,o,b,7));break;case 5:var j=null;switch(et.tag){case 26:j=et.memoizedState;case 5:case 27:var k=et;if(!j||Wy(j)){ht=0,Ws=null;var B=k.sibling;if(B!==null)et=B;else{var ee=k.return;ee!==null?(et=ee,Vc(ee)):et=null}break t}}ht=0,Ws=null,Rr(a,o,b,5);break;case 6:ht=0,Ws=null,Rr(a,o,b,6);break;case 8:yf(),Pt=6;break e;default:throw Error(s(462))}}nj();break}catch(ue){cy(a,ue)}while(!0);return sa=xi=null,L.H=f,L.A=g,ut=d,et!==null?0:(Nt=null,it=0,uc(),Pt)}function nj(){for(;et!==null&&!be();)hy(et)}function hy(a){var o=H0(a.alternate,a,da);a.memoizedProps=a.pendingProps,o===null?Vc(a):et=o}function fy(a){var o=a,d=o.alternate;switch(o.tag){case 15:case 0:o=M0(d,o,o.pendingProps,o.type,void 0,it);break;case 11:o=M0(d,o,o.pendingProps,o.type.render,o.ref,it);break;case 5:Lh(o);default:F0(d,o),o=et=mx(o,da),o=H0(d,o,da)}a.memoizedProps=a.pendingProps,o===null?Vc(a):et=o}function Rr(a,o,d,f){sa=xi=null,Lh(o),Ar=null,Ll=0;var g=o.return;try{if(GS(a,g,o,d,it)){Pt=1,Oc(a,an(d,a.current)),et=null;return}}catch(b){if(g!==null)throw et=g,b;Pt=1,Oc(a,an(d,a.current)),et=null;return}o.flags&32768?(ot||f===1?a=!0:Er||(it&536870912)!==0?a=!1:(Ma=a=!0,(f===2||f===9||f===3||f===6)&&(f=cn.current,f!==null&&f.tag===13&&(f.flags|=16384))),my(o,a)):Vc(o)}function Vc(a){var o=a;do{if((o.flags&32768)!==0){my(o,Ma);return}a=o.return;var d=WS(o.alternate,o,da);if(d!==null){et=d;return}if(o=o.sibling,o!==null){et=o;return}et=o=a}while(o!==null);Pt===0&&(Pt=5)}function my(a,o){do{var d=XS(a.alternate,a);if(d!==null){d.flags&=32767,et=d;return}if(d=a.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!o&&(a=a.sibling,a!==null)){et=a;return}et=a=d}while(a!==null);Pt=6,et=null}function py(a,o,d,f,g,b,j,k,B){a.cancelPendingCommit=null;do $c();while(cs!==0);if((ut&6)!==0)throw Error(s(327));if(o!==null){if(o===a.current)throw Error(s(177));if(b=o.lanes|o.childLanes,b|=ch,er(a,d,b,j,k,B),a===Nt&&(et=Nt=null,it=0),Cr=o,Pa=a,Tr=d,pf=b,gf=g,iy=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,lj(Ie,function(){return vy(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=L.T,L.T=null,g=q.p,q.p=2,j=ut,ut|=4;try{QS(a,o,d)}finally{ut=j,q.p=g,L.T=f}}cs=1,gy(),xy(),yy()}}function gy(){if(cs===1){cs=0;var a=Pa,o=Cr,d=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||d){d=L.T,L.T=null;var f=q.p;q.p=2;var g=ut;ut|=4;try{K0(o,a);var b=kf,j=ax(a.containerInfo),k=b.focusedElem,B=b.selectionRange;if(j!==k&&k&&k.ownerDocument&&nx(k.ownerDocument.documentElement,k)){if(B!==null&&ah(k)){var ee=B.start,ue=B.end;if(ue===void 0&&(ue=ee),"selectionStart"in k)k.selectionStart=ee,k.selectionEnd=Math.min(ue,k.value.length);else{var pe=k.ownerDocument||document,se=pe&&pe.defaultView||window;if(se.getSelection){var ne=se.getSelection(),Fe=k.textContent.length,Be=Math.min(B.start,Fe),gt=B.end===void 0?Be:Math.min(B.end,Fe);!ne.extend&&Be>gt&&(j=gt,gt=Be,Be=j);var Y=sx(k,Be),U=sx(k,gt);if(Y&&U&&(ne.rangeCount!==1||ne.anchorNode!==Y.node||ne.anchorOffset!==Y.offset||ne.focusNode!==U.node||ne.focusOffset!==U.offset)){var Q=pe.createRange();Q.setStart(Y.node,Y.offset),ne.removeAllRanges(),Be>gt?(ne.addRange(Q),ne.extend(U.node,U.offset)):(Q.setEnd(U.node,U.offset),ne.addRange(Q))}}}}for(pe=[],ne=k;ne=ne.parentNode;)ne.nodeType===1&&pe.push({element:ne,left:ne.scrollLeft,top:ne.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<pe.length;k++){var fe=pe[k];fe.element.scrollLeft=fe.left,fe.element.scrollTop=fe.top}}nd=!!Rf,kf=Rf=null}finally{ut=g,q.p=f,L.T=d}}a.current=o,cs=2}}function xy(){if(cs===2){cs=0;var a=Pa,o=Cr,d=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||d){d=L.T,L.T=null;var f=q.p;q.p=2;var g=ut;ut|=4;try{W0(a,o.alternate,o)}finally{ut=g,q.p=f,L.T=d}}cs=3}}function yy(){if(cs===4||cs===3){cs=0,ve();var a=Pa,o=Cr,d=Tr,f=iy;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?cs=5:(cs=0,Cr=Pa=null,by(a,a.pendingLanes));var g=a.pendingLanes;if(g===0&&(Oa=null),Ae(d),o=o.stateNode,_e&&typeof _e.onCommitFiberRoot=="function")try{_e.onCommitFiberRoot(Ne,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=L.T,g=q.p,q.p=2,L.T=null;try{for(var b=a.onRecoverableError,j=0;j<f.length;j++){var k=f[j];b(k.value,{componentStack:k.stack})}}finally{L.T=o,q.p=g}}(Tr&3)!==0&&$c(),Bn(a),g=a.pendingLanes,(d&4194090)!==0&&(g&42)!==0?a===xf?ql++:(ql=0,xf=a):ql=0,Vl(0)}}function by(a,o){(a.pooledCacheLanes&=o)===0&&(o=a.pooledCache,o!=null&&(a.pooledCache=null,Nl(o)))}function $c(a){return gy(),xy(),yy(),vy()}function vy(){if(cs!==5)return!1;var a=Pa,o=pf;pf=0;var d=Ae(Tr),f=L.T,g=q.p;try{q.p=32>d?32:d,L.T=null,d=gf,gf=null;var b=Pa,j=Tr;if(cs=0,Cr=Pa=null,Tr=0,(ut&6)!==0)throw Error(s(331));var k=ut;if(ut|=4,ny(b.current),ey(b,b.current,j,d),ut=k,Vl(0,!1),_e&&typeof _e.onPostCommitFiberRoot=="function")try{_e.onPostCommitFiberRoot(Ne,b)}catch{}return!0}finally{q.p=g,L.T=f,by(a,o)}}function wy(a,o,d){o=an(d,o),o=Wh(a.stateNode,o,2),a=Ea(a,o,2),a!==null&&(Us(a,2),Bn(a))}function vt(a,o,d){if(a.tag===3)wy(a,a,d);else for(;o!==null;){if(o.tag===3){wy(o,a,d);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Oa===null||!Oa.has(f))){a=an(d,a),d=j0(2),f=Ea(o,d,2),f!==null&&(E0(d,f,o,a),Us(f,2),Bn(f));break}}o=o.return}}function wf(a,o,d){var f=a.pingCache;if(f===null){f=a.pingCache=new JS;var g=new Set;f.set(o,g)}else g=f.get(o),g===void 0&&(g=new Set,f.set(o,g));g.has(d)||(uf=!0,g.add(d),a=aj.bind(null,a,o,d),o.then(a,a))}function aj(a,o,d){var f=a.pingCache;f!==null&&f.delete(o),a.pingedLanes|=a.suspendedLanes&d,a.warmLanes&=~d,Nt===a&&(it&d)===d&&(Pt===4||Pt===3&&(it&62914560)===it&&300>Ee()-mf?(ut&2)===0&&Dr(a,0):hf|=d,_r===it&&(_r=0)),Bn(a)}function Ay(a,o){o===0&&(o=xn()),a=hr(a,o),a!==null&&(Us(a,o),Bn(a))}function ij(a){var o=a.memoizedState,d=0;o!==null&&(d=o.retryLane),Ay(a,d)}function rj(a,o){var d=0;switch(a.tag){case 13:var f=a.stateNode,g=a.memoizedState;g!==null&&(d=g.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(s(314))}f!==null&&f.delete(o),Ay(a,d)}function lj(a,o){return ke(a,o)}var Gc=null,kr=null,Af=!1,Yc=!1,Nf=!1,Si=0;function Bn(a){a!==kr&&a.next===null&&(kr===null?Gc=kr=a:kr=kr.next=a),Yc=!0,Af||(Af=!0,cj())}function Vl(a,o){if(!Nf&&Yc){Nf=!0;do for(var d=!1,f=Gc;f!==null;){if(a!==0){var g=f.pendingLanes;if(g===0)var b=0;else{var j=f.suspendedLanes,k=f.pingedLanes;b=(1<<31-dt(42|a)+1)-1,b&=g&~(j&~k),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(d=!0,Ey(f,b))}else b=it,b=gn(f,f===Nt?b:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(b&3)===0||Fs(f,b)||(d=!0,Ey(f,b));f=f.next}while(d);Nf=!1}}function oj(){Ny()}function Ny(){Yc=Af=!1;var a=0;Si!==0&&(xj()&&(a=Si),Si=0);for(var o=Ee(),d=null,f=Gc;f!==null;){var g=f.next,b=Sy(f,o);b===0?(f.next=null,d===null?Gc=g:d.next=g,g===null&&(kr=d)):(d=f,(a!==0||(b&3)!==0)&&(Yc=!0)),f=g}Vl(a)}function Sy(a,o){for(var d=a.suspendedLanes,f=a.pingedLanes,g=a.expirationTimes,b=a.pendingLanes&-62914561;0<b;){var j=31-dt(b),k=1<<j,B=g[j];B===-1?((k&d)===0||(k&f)!==0)&&(g[j]=ii(k,o)):B<=o&&(a.expiredLanes|=k),b&=~k}if(o=Nt,d=it,d=gn(a,a===o?d:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,d===0||a===o&&(ht===2||ht===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&te(f),a.callbackNode=null,a.callbackPriority=0;if((d&3)===0||Fs(a,d)){if(o=d&-d,o===a.callbackPriority)return o;switch(f!==null&&te(f),Ae(d)){case 2:case 8:d=Se;break;case 32:d=Ie;break;case 268435456:d=wt;break;default:d=Ie}return f=jy.bind(null,a),d=ke(d,f),a.callbackPriority=o,a.callbackNode=d,o}return f!==null&&f!==null&&te(f),a.callbackPriority=2,a.callbackNode=null,2}function jy(a,o){if(cs!==0&&cs!==5)return a.callbackNode=null,a.callbackPriority=0,null;var d=a.callbackNode;if($c()&&a.callbackNode!==d)return null;var f=it;return f=gn(a,a===Nt?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(ly(a,f,o),Sy(a,Ee()),a.callbackNode!=null&&a.callbackNode===d?jy.bind(null,a):null)}function Ey(a,o){if($c())return null;ly(a,o,!0)}function cj(){bj(function(){(ut&6)!==0?ke(J,oj):Ny()})}function Sf(){return Si===0&&(Si=ri()),Si}function _y(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:ac(""+a)}function Cy(a,o){var d=o.ownerDocument.createElement("input");return d.name=o.name,d.value=o.value,a.id&&d.setAttribute("form",a.id),o.parentNode.insertBefore(d,o),a=new FormData(a),d.parentNode.removeChild(d),a}function dj(a,o,d,f,g){if(o==="submit"&&d&&d.stateNode===g){var b=_y((g[St]||null).action),j=f.submitter;j&&(o=(o=j[St]||null)?_y(o.formAction):j.getAttribute("formAction"),o!==null&&(b=o,j=null));var k=new oc("action","action",null,f,g);a.push({event:k,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Si!==0){var B=j?Cy(g,j):new FormData(g);qh(d,{pending:!0,data:B,method:g.method,action:b},null,B)}}else typeof b=="function"&&(k.preventDefault(),B=j?Cy(g,j):new FormData(g),qh(d,{pending:!0,data:B,method:g.method,action:b},b,B))},currentTarget:g}]})}}for(var jf=0;jf<oh.length;jf++){var Ef=oh[jf],uj=Ef.toLowerCase(),hj=Ef[0].toUpperCase()+Ef.slice(1);wn(uj,"on"+hj)}wn(lx,"onAnimationEnd"),wn(ox,"onAnimationIteration"),wn(cx,"onAnimationStart"),wn("dblclick","onDoubleClick"),wn("focusin","onFocus"),wn("focusout","onBlur"),wn(TS,"onTransitionRun"),wn(DS,"onTransitionStart"),wn(RS,"onTransitionCancel"),wn(dx,"onTransitionEnd"),sr("onMouseEnter",["mouseout","mouseover"]),sr("onMouseLeave",["mouseout","mouseover"]),sr("onPointerEnter",["pointerout","pointerover"]),sr("onPointerLeave",["pointerout","pointerover"]),oi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),oi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),oi("onBeforeInput",["compositionend","keypress","textInput","paste"]),oi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),oi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),oi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $l="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($l));function Ty(a,o){o=(o&4)!==0;for(var d=0;d<a.length;d++){var f=a[d],g=f.event;f=f.listeners;e:{var b=void 0;if(o)for(var j=f.length-1;0<=j;j--){var k=f[j],B=k.instance,ee=k.currentTarget;if(k=k.listener,B!==b&&g.isPropagationStopped())break e;b=k,g.currentTarget=ee;try{b(g)}catch(ue){Lc(ue)}g.currentTarget=null,b=B}else for(j=0;j<f.length;j++){if(k=f[j],B=k.instance,ee=k.currentTarget,k=k.listener,B!==b&&g.isPropagationStopped())break e;b=k,g.currentTarget=ee;try{b(g)}catch(ue){Lc(ue)}g.currentTarget=null,b=B}}}}function tt(a,o){var d=o[Cs];d===void 0&&(d=o[Cs]=new Set);var f=a+"__bubble";d.has(f)||(Dy(o,a,2,!1),d.add(f))}function _f(a,o,d){var f=0;o&&(f|=4),Dy(d,a,f,o)}var Wc="_reactListening"+Math.random().toString(36).slice(2);function Cf(a){if(!a[Wc]){a[Wc]=!0,Ng.forEach(function(d){d!=="selectionchange"&&(fj.has(d)||_f(d,!1,a),_f(d,!0,a))});var o=a.nodeType===9?a:a.ownerDocument;o===null||o[Wc]||(o[Wc]=!0,_f("selectionchange",!1,o))}}function Dy(a,o,d,f){switch(eb(o)){case 2:var g=zj;break;case 8:g=Fj;break;default:g=Uf}d=g.bind(null,o,d,a),g=void 0,!Xu||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),f?g!==void 0?a.addEventListener(o,d,{capture:!0,passive:g}):a.addEventListener(o,d,!0):g!==void 0?a.addEventListener(o,d,{passive:g}):a.addEventListener(o,d,!1)}function Tf(a,o,d,f,g){var b=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var j=f.tag;if(j===3||j===4){var k=f.stateNode.containerInfo;if(k===g)break;if(j===4)for(j=f.return;j!==null;){var B=j.tag;if((B===3||B===4)&&j.stateNode.containerInfo===g)return;j=j.return}for(;k!==null;){if(j=vn(k),j===null)return;if(B=j.tag,B===5||B===6||B===26||B===27){f=b=j;continue e}k=k.parentNode}}f=f.return}Ig(function(){var ee=b,ue=Yu(d),pe=[];e:{var se=ux.get(a);if(se!==void 0){var ne=oc,Fe=a;switch(a){case"keypress":if(rc(d)===0)break e;case"keydown":case"keyup":ne=lS;break;case"focusin":Fe="focus",ne=Ju;break;case"focusout":Fe="blur",ne=Ju;break;case"beforeblur":case"afterblur":ne=Ju;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=zg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=XN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=dS;break;case lx:case ox:case cx:ne=KN;break;case dx:ne=hS;break;case"scroll":case"scrollend":ne=YN;break;case"wheel":ne=mS;break;case"copy":case"cut":case"paste":ne=eS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=Ug;break;case"toggle":case"beforetoggle":ne=gS}var Be=(o&4)!==0,gt=!Be&&(a==="scroll"||a==="scrollend"),Y=Be?se!==null?se+"Capture":null:se;Be=[];for(var U=ee,Q;U!==null;){var fe=U;if(Q=fe.stateNode,fe=fe.tag,fe!==5&&fe!==26&&fe!==27||Q===null||Y===null||(fe=dl(U,Y),fe!=null&&Be.push(Gl(U,fe,Q))),gt)break;U=U.return}0<Be.length&&(se=new ne(se,Fe,null,d,ue),pe.push({event:se,listeners:Be}))}}if((o&7)===0){e:{if(se=a==="mouseover"||a==="pointerover",ne=a==="mouseout"||a==="pointerout",se&&d!==Gu&&(Fe=d.relatedTarget||d.fromElement)&&(vn(Fe)||Fe[tn]))break e;if((ne||se)&&(se=ue.window===ue?ue:(se=ue.ownerDocument)?se.defaultView||se.parentWindow:window,ne?(Fe=d.relatedTarget||d.toElement,ne=ee,Fe=Fe?vn(Fe):null,Fe!==null&&(gt=l(Fe),Be=Fe.tag,Fe!==gt||Be!==5&&Be!==27&&Be!==6)&&(Fe=null)):(ne=null,Fe=ee),ne!==Fe)){if(Be=zg,fe="onMouseLeave",Y="onMouseEnter",U="mouse",(a==="pointerout"||a==="pointerover")&&(Be=Ug,fe="onPointerLeave",Y="onPointerEnter",U="pointer"),gt=ne==null?se:wa(ne),Q=Fe==null?se:wa(Fe),se=new Be(fe,U+"leave",ne,d,ue),se.target=gt,se.relatedTarget=Q,fe=null,vn(ue)===ee&&(Be=new Be(Y,U+"enter",Fe,d,ue),Be.target=Q,Be.relatedTarget=gt,fe=Be),gt=fe,ne&&Fe)t:{for(Be=ne,Y=Fe,U=0,Q=Be;Q;Q=Mr(Q))U++;for(Q=0,fe=Y;fe;fe=Mr(fe))Q++;for(;0<U-Q;)Be=Mr(Be),U--;for(;0<Q-U;)Y=Mr(Y),Q--;for(;U--;){if(Be===Y||Y!==null&&Be===Y.alternate)break t;Be=Mr(Be),Y=Mr(Y)}Be=null}else Be=null;ne!==null&&Ry(pe,se,ne,Be,!1),Fe!==null&&gt!==null&&Ry(pe,gt,Fe,Be,!0)}}e:{if(se=ee?wa(ee):window,ne=se.nodeName&&se.nodeName.toLowerCase(),ne==="select"||ne==="input"&&se.type==="file")var Te=Qg;else if(Wg(se))if(Zg)Te=ES;else{Te=SS;var Je=NS}else ne=se.nodeName,!ne||ne.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?ee&&$u(ee.elementType)&&(Te=Qg):Te=jS;if(Te&&(Te=Te(a,ee))){Xg(pe,Te,d,ue);break e}Je&&Je(a,se,ee),a==="focusout"&&ee&&se.type==="number"&&ee.memoizedProps.value!=null&&Vu(se,"number",se.value)}switch(Je=ee?wa(ee):window,a){case"focusin":(Wg(Je)||Je.contentEditable==="true")&&(cr=Je,ih=ee,yl=null);break;case"focusout":yl=ih=cr=null;break;case"mousedown":rh=!0;break;case"contextmenu":case"mouseup":case"dragend":rh=!1,ix(pe,d,ue);break;case"selectionchange":if(CS)break;case"keydown":case"keyup":ix(pe,d,ue)}var Re;if(th)e:{switch(a){case"compositionstart":var He="onCompositionStart";break e;case"compositionend":He="onCompositionEnd";break e;case"compositionupdate":He="onCompositionUpdate";break e}He=void 0}else or?Gg(a,d)&&(He="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(He="onCompositionStart");He&&(qg&&d.locale!=="ko"&&(or||He!=="onCompositionStart"?He==="onCompositionEnd"&&or&&(Re=Bg()):(Aa=ue,Qu="value"in Aa?Aa.value:Aa.textContent,or=!0)),Je=Xc(ee,He),0<Je.length&&(He=new Fg(He,a,null,d,ue),pe.push({event:He,listeners:Je}),Re?He.data=Re:(Re=Yg(d),Re!==null&&(He.data=Re)))),(Re=yS?bS(a,d):vS(a,d))&&(He=Xc(ee,"onBeforeInput"),0<He.length&&(Je=new Fg("onBeforeInput","beforeinput",null,d,ue),pe.push({event:Je,listeners:He}),Je.data=Re)),dj(pe,a,ee,d,ue)}Ty(pe,o)})}function Gl(a,o,d){return{instance:a,listener:o,currentTarget:d}}function Xc(a,o){for(var d=o+"Capture",f=[];a!==null;){var g=a,b=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||b===null||(g=dl(a,d),g!=null&&f.unshift(Gl(a,g,b)),g=dl(a,o),g!=null&&f.push(Gl(a,g,b))),a.tag===3)return f;a=a.return}return[]}function Mr(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Ry(a,o,d,f,g){for(var b=o._reactName,j=[];d!==null&&d!==f;){var k=d,B=k.alternate,ee=k.stateNode;if(k=k.tag,B!==null&&B===f)break;k!==5&&k!==26&&k!==27||ee===null||(B=ee,g?(ee=dl(d,b),ee!=null&&j.unshift(Gl(d,ee,B))):g||(ee=dl(d,b),ee!=null&&j.push(Gl(d,ee,B)))),d=d.return}j.length!==0&&a.push({event:o,listeners:j})}var mj=/\r\n?/g,pj=/\u0000|\uFFFD/g;function ky(a){return(typeof a=="string"?a:""+a).replace(mj,`
`).replace(pj,"")}function My(a,o){return o=ky(o),ky(a)===o}function Qc(){}function pt(a,o,d,f,g,b){switch(d){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||ir(a,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&ir(a,""+f);break;case"className":tc(a,"class",f);break;case"tabIndex":tc(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":tc(a,d,f);break;case"style":Og(a,f,b);break;case"data":if(o!=="object"){tc(a,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||d!=="href")){a.removeAttribute(d);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(d);break}f=ac(""+f),a.setAttribute(d,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(d==="formAction"?(o!=="input"&&pt(a,o,"name",g.name,g,null),pt(a,o,"formEncType",g.formEncType,g,null),pt(a,o,"formMethod",g.formMethod,g,null),pt(a,o,"formTarget",g.formTarget,g,null)):(pt(a,o,"encType",g.encType,g,null),pt(a,o,"method",g.method,g,null),pt(a,o,"target",g.target,g,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(d);break}f=ac(""+f),a.setAttribute(d,f);break;case"onClick":f!=null&&(a.onclick=Qc);break;case"onScroll":f!=null&&tt("scroll",a);break;case"onScrollEnd":f!=null&&tt("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(s(61));if(d=f.__html,d!=null){if(g.children!=null)throw Error(s(60));a.innerHTML=d}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}d=ac(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(d,""+f):a.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(d,""):a.removeAttribute(d);break;case"capture":case"download":f===!0?a.setAttribute(d,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(d,f):a.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(d,f):a.removeAttribute(d);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(d):a.setAttribute(d,f);break;case"popover":tt("beforetoggle",a),tt("toggle",a),ec(a,"popover",f);break;case"xlinkActuate":Zn(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Zn(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Zn(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Zn(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Zn(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Zn(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Zn(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Zn(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Zn(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":ec(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=$N.get(d)||d,ec(a,d,f))}}function Df(a,o,d,f,g,b){switch(d){case"style":Og(a,f,b);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(s(61));if(d=f.__html,d!=null){if(g.children!=null)throw Error(s(60));a.innerHTML=d}}break;case"children":typeof f=="string"?ir(a,f):(typeof f=="number"||typeof f=="bigint")&&ir(a,""+f);break;case"onScroll":f!=null&&tt("scroll",a);break;case"onScrollEnd":f!=null&&tt("scrollend",a);break;case"onClick":f!=null&&(a.onclick=Qc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Sg.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(g=d.endsWith("Capture"),o=d.slice(2,g?d.length-7:void 0),b=a[St]||null,b=b!=null?b[d]:null,typeof b=="function"&&a.removeEventListener(o,b,g),typeof f=="function")){typeof b!="function"&&b!==null&&(d in a?a[d]=null:a.hasAttribute(d)&&a.removeAttribute(d)),a.addEventListener(o,f,g);break e}d in a?a[d]=f:f===!0?a.setAttribute(d,""):ec(a,d,f)}}}function ds(a,o,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":tt("error",a),tt("load",a);var f=!1,g=!1,b;for(b in d)if(d.hasOwnProperty(b)){var j=d[b];if(j!=null)switch(b){case"src":f=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,o));default:pt(a,o,b,j,d,null)}}g&&pt(a,o,"srcSet",d.srcSet,d,null),f&&pt(a,o,"src",d.src,d,null);return;case"input":tt("invalid",a);var k=b=j=g=null,B=null,ee=null;for(f in d)if(d.hasOwnProperty(f)){var ue=d[f];if(ue!=null)switch(f){case"name":g=ue;break;case"type":j=ue;break;case"checked":B=ue;break;case"defaultChecked":ee=ue;break;case"value":b=ue;break;case"defaultValue":k=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(s(137,o));break;default:pt(a,o,f,ue,d,null)}}Rg(a,b,k,B,ee,j,g,!1),sc(a);return;case"select":tt("invalid",a),f=j=b=null;for(g in d)if(d.hasOwnProperty(g)&&(k=d[g],k!=null))switch(g){case"value":b=k;break;case"defaultValue":j=k;break;case"multiple":f=k;default:pt(a,o,g,k,d,null)}o=b,d=j,a.multiple=!!f,o!=null?ar(a,!!f,o,!1):d!=null&&ar(a,!!f,d,!0);return;case"textarea":tt("invalid",a),b=g=f=null;for(j in d)if(d.hasOwnProperty(j)&&(k=d[j],k!=null))switch(j){case"value":f=k;break;case"defaultValue":g=k;break;case"children":b=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(s(91));break;default:pt(a,o,j,k,d,null)}Mg(a,f,g,b),sc(a);return;case"option":for(B in d)if(d.hasOwnProperty(B)&&(f=d[B],f!=null))switch(B){case"selected":a.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:pt(a,o,B,f,d,null)}return;case"dialog":tt("beforetoggle",a),tt("toggle",a),tt("cancel",a),tt("close",a);break;case"iframe":case"object":tt("load",a);break;case"video":case"audio":for(f=0;f<$l.length;f++)tt($l[f],a);break;case"image":tt("error",a),tt("load",a);break;case"details":tt("toggle",a);break;case"embed":case"source":case"link":tt("error",a),tt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ee in d)if(d.hasOwnProperty(ee)&&(f=d[ee],f!=null))switch(ee){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,o));default:pt(a,o,ee,f,d,null)}return;default:if($u(o)){for(ue in d)d.hasOwnProperty(ue)&&(f=d[ue],f!==void 0&&Df(a,o,ue,f,d,void 0));return}}for(k in d)d.hasOwnProperty(k)&&(f=d[k],f!=null&&pt(a,o,k,f,d,null))}function gj(a,o,d,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,b=null,j=null,k=null,B=null,ee=null,ue=null;for(ne in d){var pe=d[ne];if(d.hasOwnProperty(ne)&&pe!=null)switch(ne){case"checked":break;case"value":break;case"defaultValue":B=pe;default:f.hasOwnProperty(ne)||pt(a,o,ne,null,f,pe)}}for(var se in f){var ne=f[se];if(pe=d[se],f.hasOwnProperty(se)&&(ne!=null||pe!=null))switch(se){case"type":b=ne;break;case"name":g=ne;break;case"checked":ee=ne;break;case"defaultChecked":ue=ne;break;case"value":j=ne;break;case"defaultValue":k=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(s(137,o));break;default:ne!==pe&&pt(a,o,se,ne,f,pe)}}qu(a,j,k,B,ee,ue,b,g);return;case"select":ne=j=k=se=null;for(b in d)if(B=d[b],d.hasOwnProperty(b)&&B!=null)switch(b){case"value":break;case"multiple":ne=B;default:f.hasOwnProperty(b)||pt(a,o,b,null,f,B)}for(g in f)if(b=f[g],B=d[g],f.hasOwnProperty(g)&&(b!=null||B!=null))switch(g){case"value":se=b;break;case"defaultValue":k=b;break;case"multiple":j=b;default:b!==B&&pt(a,o,g,b,f,B)}o=k,d=j,f=ne,se!=null?ar(a,!!d,se,!1):!!f!=!!d&&(o!=null?ar(a,!!d,o,!0):ar(a,!!d,d?[]:"",!1));return;case"textarea":ne=se=null;for(k in d)if(g=d[k],d.hasOwnProperty(k)&&g!=null&&!f.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:pt(a,o,k,null,f,g)}for(j in f)if(g=f[j],b=d[j],f.hasOwnProperty(j)&&(g!=null||b!=null))switch(j){case"value":se=g;break;case"defaultValue":ne=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(s(91));break;default:g!==b&&pt(a,o,j,g,f,b)}kg(a,se,ne);return;case"option":for(var Fe in d)if(se=d[Fe],d.hasOwnProperty(Fe)&&se!=null&&!f.hasOwnProperty(Fe))switch(Fe){case"selected":a.selected=!1;break;default:pt(a,o,Fe,null,f,se)}for(B in f)if(se=f[B],ne=d[B],f.hasOwnProperty(B)&&se!==ne&&(se!=null||ne!=null))switch(B){case"selected":a.selected=se&&typeof se!="function"&&typeof se!="symbol";break;default:pt(a,o,B,se,f,ne)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Be in d)se=d[Be],d.hasOwnProperty(Be)&&se!=null&&!f.hasOwnProperty(Be)&&pt(a,o,Be,null,f,se);for(ee in f)if(se=f[ee],ne=d[ee],f.hasOwnProperty(ee)&&se!==ne&&(se!=null||ne!=null))switch(ee){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(s(137,o));break;default:pt(a,o,ee,se,f,ne)}return;default:if($u(o)){for(var gt in d)se=d[gt],d.hasOwnProperty(gt)&&se!==void 0&&!f.hasOwnProperty(gt)&&Df(a,o,gt,void 0,f,se);for(ue in f)se=f[ue],ne=d[ue],!f.hasOwnProperty(ue)||se===ne||se===void 0&&ne===void 0||Df(a,o,ue,se,f,ne);return}}for(var Y in d)se=d[Y],d.hasOwnProperty(Y)&&se!=null&&!f.hasOwnProperty(Y)&&pt(a,o,Y,null,f,se);for(pe in f)se=f[pe],ne=d[pe],!f.hasOwnProperty(pe)||se===ne||se==null&&ne==null||pt(a,o,pe,se,f,ne)}var Rf=null,kf=null;function Zc(a){return a.nodeType===9?a:a.ownerDocument}function Ly(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Oy(a,o){if(a===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&o==="foreignObject"?0:a}function Mf(a,o){return a==="textarea"||a==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Lf=null;function xj(){var a=window.event;return a&&a.type==="popstate"?a===Lf?!1:(Lf=a,!0):(Lf=null,!1)}var Py=typeof setTimeout=="function"?setTimeout:void 0,yj=typeof clearTimeout=="function"?clearTimeout:void 0,Iy=typeof Promise=="function"?Promise:void 0,bj=typeof queueMicrotask=="function"?queueMicrotask:typeof Iy<"u"?function(a){return Iy.resolve(null).then(a).catch(vj)}:Py;function vj(a){setTimeout(function(){throw a})}function Ba(a){return a==="head"}function By(a,o){var d=o,f=0,g=0;do{var b=d.nextSibling;if(a.removeChild(d),b&&b.nodeType===8)if(d=b.data,d==="/$"){if(0<f&&8>f){d=f;var j=a.ownerDocument;if(d&1&&Yl(j.documentElement),d&2&&Yl(j.body),d&4)for(d=j.head,Yl(d),j=d.firstChild;j;){var k=j.nextSibling,B=j.nodeName;j[bn]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&j.rel.toLowerCase()==="stylesheet"||d.removeChild(j),j=k}}if(g===0){a.removeChild(b),to(o);return}g--}else d==="$"||d==="$?"||d==="$!"?g++:f=d.charCodeAt(0)-48;else f=0;d=b}while(d);to(o)}function Of(a){var o=a.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var d=o;switch(o=o.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":Of(d),ms(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}a.removeChild(d)}}function wj(a,o,d,f){for(;a.nodeType===1;){var g=d;if(a.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[bn])switch(o){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(b=a.getAttribute("rel"),b==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(b!==g.rel||a.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||a.getAttribute("title")!==(g.title==null?null:g.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(b=a.getAttribute("src"),(b!==(g.src==null?null:g.src)||a.getAttribute("type")!==(g.type==null?null:g.type)||a.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&b&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(o==="input"&&a.type==="hidden"){var b=g.name==null?null:""+g.name;if(g.type==="hidden"&&a.getAttribute("name")===b)return a}else return a;if(a=Nn(a.nextSibling),a===null)break}return null}function Aj(a,o,d){if(o==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!d||(a=Nn(a.nextSibling),a===null))return null;return a}function Pf(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function Nj(a,o){var d=a.ownerDocument;if(a.data!=="$?"||d.readyState==="complete")o();else{var f=function(){o(),d.removeEventListener("DOMContentLoaded",f)};d.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function Nn(a){for(;a!=null;a=a.nextSibling){var o=a.nodeType;if(o===1||o===3)break;if(o===8){if(o=a.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return a}var If=null;function Hy(a){a=a.previousSibling;for(var o=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(o===0)return a;o--}else d==="/$"&&o++}a=a.previousSibling}return null}function zy(a,o,d){switch(o=Zc(d),a){case"html":if(a=o.documentElement,!a)throw Error(s(452));return a;case"head":if(a=o.head,!a)throw Error(s(453));return a;case"body":if(a=o.body,!a)throw Error(s(454));return a;default:throw Error(s(451))}}function Yl(a){for(var o=a.attributes;o.length;)a.removeAttributeNode(o[0]);ms(a)}var un=new Map,Fy=new Set;function Kc(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var ua=q.d;q.d={f:Sj,r:jj,D:Ej,C:_j,L:Cj,m:Tj,X:Rj,S:Dj,M:kj};function Sj(){var a=ua.f(),o=qc();return a||o}function jj(a){var o=Mn(a);o!==null&&o.tag===5&&o.type==="form"?l0(o):ua.r(a)}var Lr=typeof document>"u"?null:document;function Uy(a,o,d){var f=Lr;if(f&&typeof o=="string"&&o){var g=nn(o);g='link[rel="'+a+'"][href="'+g+'"]',typeof d=="string"&&(g+='[crossorigin="'+d+'"]'),Fy.has(g)||(Fy.add(g),a={rel:a,crossOrigin:d,href:o},f.querySelector(g)===null&&(o=f.createElement("link"),ds(o,"link",a),es(o),f.head.appendChild(o)))}}function Ej(a){ua.D(a),Uy("dns-prefetch",a,null)}function _j(a,o){ua.C(a,o),Uy("preconnect",a,o)}function Cj(a,o,d){ua.L(a,o,d);var f=Lr;if(f&&a&&o){var g='link[rel="preload"][as="'+nn(o)+'"]';o==="image"&&d&&d.imageSrcSet?(g+='[imagesrcset="'+nn(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(g+='[imagesizes="'+nn(d.imageSizes)+'"]')):g+='[href="'+nn(a)+'"]';var b=g;switch(o){case"style":b=Or(a);break;case"script":b=Pr(a)}un.has(b)||(a=p({rel:"preload",href:o==="image"&&d&&d.imageSrcSet?void 0:a,as:o},d),un.set(b,a),f.querySelector(g)!==null||o==="style"&&f.querySelector(Wl(b))||o==="script"&&f.querySelector(Xl(b))||(o=f.createElement("link"),ds(o,"link",a),es(o),f.head.appendChild(o)))}}function Tj(a,o){ua.m(a,o);var d=Lr;if(d&&a){var f=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+nn(f)+'"][href="'+nn(a)+'"]',b=g;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Pr(a)}if(!un.has(b)&&(a=p({rel:"modulepreload",href:a},o),un.set(b,a),d.querySelector(g)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(Xl(b)))return}f=d.createElement("link"),ds(f,"link",a),es(f),d.head.appendChild(f)}}}function Dj(a,o,d){ua.S(a,o,d);var f=Lr;if(f&&a){var g=tr(f).hoistableStyles,b=Or(a);o=o||"default";var j=g.get(b);if(!j){var k={loading:0,preload:null};if(j=f.querySelector(Wl(b)))k.loading=5;else{a=p({rel:"stylesheet",href:a,"data-precedence":o},d),(d=un.get(b))&&Bf(a,d);var B=j=f.createElement("link");es(B),ds(B,"link",a),B._p=new Promise(function(ee,ue){B.onload=ee,B.onerror=ue}),B.addEventListener("load",function(){k.loading|=1}),B.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Jc(j,o,f)}j={type:"stylesheet",instance:j,count:1,state:k},g.set(b,j)}}}function Rj(a,o){ua.X(a,o);var d=Lr;if(d&&a){var f=tr(d).hoistableScripts,g=Pr(a),b=f.get(g);b||(b=d.querySelector(Xl(g)),b||(a=p({src:a,async:!0},o),(o=un.get(g))&&Hf(a,o),b=d.createElement("script"),es(b),ds(b,"link",a),d.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(g,b))}}function kj(a,o){ua.M(a,o);var d=Lr;if(d&&a){var f=tr(d).hoistableScripts,g=Pr(a),b=f.get(g);b||(b=d.querySelector(Xl(g)),b||(a=p({src:a,async:!0,type:"module"},o),(o=un.get(g))&&Hf(a,o),b=d.createElement("script"),es(b),ds(b,"link",a),d.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(g,b))}}function qy(a,o,d,f){var g=(g=ye.current)?Kc(g):null;if(!g)throw Error(s(446));switch(a){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(o=Or(d.href),d=tr(g).hoistableStyles,f=d.get(o),f||(f={type:"style",instance:null,count:0,state:null},d.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){a=Or(d.href);var b=tr(g).hoistableStyles,j=b.get(a);if(j||(g=g.ownerDocument||g,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(a,j),(b=g.querySelector(Wl(a)))&&!b._p&&(j.instance=b,j.state.loading=5),un.has(a)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},un.set(a,d),b||Mj(g,a,d,j.state))),o&&f===null)throw Error(s(528,""));return j}if(o&&f!==null)throw Error(s(529,""));return null;case"script":return o=d.async,d=d.src,typeof d=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Pr(d),d=tr(g).hoistableScripts,f=d.get(o),f||(f={type:"script",instance:null,count:0,state:null},d.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,a))}}function Or(a){return'href="'+nn(a)+'"'}function Wl(a){return'link[rel="stylesheet"]['+a+"]"}function Vy(a){return p({},a,{"data-precedence":a.precedence,precedence:null})}function Mj(a,o,d,f){a.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=a.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),ds(o,"link",d),es(o),a.head.appendChild(o))}function Pr(a){return'[src="'+nn(a)+'"]'}function Xl(a){return"script[async]"+a}function $y(a,o,d){if(o.count++,o.instance===null)switch(o.type){case"style":var f=a.querySelector('style[data-href~="'+nn(d.href)+'"]');if(f)return o.instance=f,es(f),f;var g=p({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),es(f),ds(f,"style",g),Jc(f,d.precedence,a),o.instance=f;case"stylesheet":g=Or(d.href);var b=a.querySelector(Wl(g));if(b)return o.state.loading|=4,o.instance=b,es(b),b;f=Vy(d),(g=un.get(g))&&Bf(f,g),b=(a.ownerDocument||a).createElement("link"),es(b);var j=b;return j._p=new Promise(function(k,B){j.onload=k,j.onerror=B}),ds(b,"link",f),o.state.loading|=4,Jc(b,d.precedence,a),o.instance=b;case"script":return b=Pr(d.src),(g=a.querySelector(Xl(b)))?(o.instance=g,es(g),g):(f=d,(g=un.get(b))&&(f=p({},d),Hf(f,g)),a=a.ownerDocument||a,g=a.createElement("script"),es(g),ds(g,"link",f),a.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(s(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,Jc(f,d.precedence,a));return o.instance}function Jc(a,o,d){for(var f=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=f.length?f[f.length-1]:null,b=g,j=0;j<f.length;j++){var k=f[j];if(k.dataset.precedence===o)b=k;else if(b!==g)break}b?b.parentNode.insertBefore(a,b.nextSibling):(o=d.nodeType===9?d.head:d,o.insertBefore(a,o.firstChild))}function Bf(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.title==null&&(a.title=o.title)}function Hf(a,o){a.crossOrigin==null&&(a.crossOrigin=o.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=o.referrerPolicy),a.integrity==null&&(a.integrity=o.integrity)}var ed=null;function Gy(a,o,d){if(ed===null){var f=new Map,g=ed=new Map;g.set(d,f)}else g=ed,f=g.get(d),f||(f=new Map,g.set(d,f));if(f.has(a))return f;for(f.set(a,null),d=d.getElementsByTagName(a),g=0;g<d.length;g++){var b=d[g];if(!(b[bn]||b[bt]||a==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var j=b.getAttribute(o)||"";j=a+j;var k=f.get(j);k?k.push(b):f.set(j,[b])}}return f}function Yy(a,o,d){a=a.ownerDocument||a,a.head.insertBefore(d,o==="title"?a.querySelector("head > title"):null)}function Lj(a,o,d){if(d===1||o.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return a=o.disabled,typeof o.precedence=="string"&&a==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Wy(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var Ql=null;function Oj(){}function Pj(a,o,d){if(Ql===null)throw Error(s(475));var f=Ql;if(o.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Or(d.href),b=a.querySelector(Wl(g));if(b){a=b._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(f.count++,f=td.bind(f),a.then(f,f)),o.state.loading|=4,o.instance=b,es(b);return}b=a.ownerDocument||a,d=Vy(d),(g=un.get(g))&&Bf(d,g),b=b.createElement("link"),es(b);var j=b;j._p=new Promise(function(k,B){j.onload=k,j.onerror=B}),ds(b,"link",d),o.instance=b}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(f.count++,o=td.bind(f),a.addEventListener("load",o),a.addEventListener("error",o))}}function Ij(){if(Ql===null)throw Error(s(475));var a=Ql;return a.stylesheets&&a.count===0&&zf(a,a.stylesheets),0<a.count?function(o){var d=setTimeout(function(){if(a.stylesheets&&zf(a,a.stylesheets),a.unsuspend){var f=a.unsuspend;a.unsuspend=null,f()}},6e4);return a.unsuspend=o,function(){a.unsuspend=null,clearTimeout(d)}}:null}function td(){if(this.count--,this.count===0){if(this.stylesheets)zf(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var sd=null;function zf(a,o){a.stylesheets=null,a.unsuspend!==null&&(a.count++,sd=new Map,o.forEach(Bj,a),sd=null,td.call(a))}function Bj(a,o){if(!(o.state.loading&4)){var d=sd.get(a);if(d)var f=d.get(null);else{d=new Map,sd.set(a,d);for(var g=a.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<g.length;b++){var j=g[b];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(d.set(j.dataset.precedence,j),f=j)}f&&d.set(null,f)}g=o.instance,j=g.getAttribute("data-precedence"),b=d.get(j)||f,b===f&&d.set(null,g),d.set(j,g),this.count++,f=td.bind(this),g.addEventListener("load",f),g.addEventListener("error",f),b?b.parentNode.insertBefore(g,b.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(g,a.firstChild)),o.state.loading|=4}}var Zl={$$typeof:C,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function Hj(a,o,d,f,g,b,j,k){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ji(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ji(0),this.hiddenUpdates=Ji(null),this.identifierPrefix=f,this.onUncaughtError=g,this.onCaughtError=b,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=k,this.incompleteTransitions=new Map}function Xy(a,o,d,f,g,b,j,k,B,ee,ue,pe){return a=new Hj(a,o,d,j,k,B,ee,pe),o=1,b===!0&&(o|=24),b=$s(3,null,null,o),a.current=b,b.stateNode=a,o=vh(),o.refCount++,a.pooledCache=o,o.refCount++,b.memoizedState={element:f,isDehydrated:d,cache:o},Sh(b),a}function Qy(a){return a?(a=fr,a):fr}function Zy(a,o,d,f,g,b){g=Qy(g),f.context===null?f.context=g:f.pendingContext=g,f=ja(o),f.payload={element:d},b=b===void 0?null:b,b!==null&&(f.callback=b),d=Ea(a,f,o),d!==null&&(Qs(d,a,o),_l(d,a,o))}function Ky(a,o){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<o?d:o}}function Ff(a,o){Ky(a,o),(a=a.alternate)&&Ky(a,o)}function Jy(a){if(a.tag===13){var o=hr(a,67108864);o!==null&&Qs(o,a,67108864),Ff(a,67108864)}}var nd=!0;function zj(a,o,d,f){var g=L.T;L.T=null;var b=q.p;try{q.p=2,Uf(a,o,d,f)}finally{q.p=b,L.T=g}}function Fj(a,o,d,f){var g=L.T;L.T=null;var b=q.p;try{q.p=8,Uf(a,o,d,f)}finally{q.p=b,L.T=g}}function Uf(a,o,d,f){if(nd){var g=qf(f);if(g===null)Tf(a,o,f,ad,d),tb(a,f);else if(qj(g,a,o,d,f))f.stopPropagation();else if(tb(a,f),o&4&&-1<Uj.indexOf(a)){for(;g!==null;){var b=Mn(g);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var j=vs(b.pendingLanes);if(j!==0){var k=b;for(k.pendingLanes|=2,k.entangledLanes|=2;j;){var B=1<<31-dt(j);k.entanglements[1]|=B,j&=~B}Bn(b),(ut&6)===0&&(Fc=Ee()+500,Vl(0))}}break;case 13:k=hr(b,2),k!==null&&Qs(k,b,2),qc(),Ff(b,2)}if(b=qf(f),b===null&&Tf(a,o,f,ad,d),b===g)break;g=b}g!==null&&f.stopPropagation()}else Tf(a,o,f,null,d)}}function qf(a){return a=Yu(a),Vf(a)}var ad=null;function Vf(a){if(ad=null,a=vn(a),a!==null){var o=l(a);if(o===null)a=null;else{var d=o.tag;if(d===13){if(a=c(o),a!==null)return a;a=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return ad=a,null}function eb(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ye()){case J:return 2;case Se:return 8;case Ie:case Xe:return 32;case wt:return 268435456;default:return 32}default:return 32}}var $f=!1,Ha=null,za=null,Fa=null,Kl=new Map,Jl=new Map,Ua=[],Uj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function tb(a,o){switch(a){case"focusin":case"focusout":Ha=null;break;case"dragenter":case"dragleave":za=null;break;case"mouseover":case"mouseout":Fa=null;break;case"pointerover":case"pointerout":Kl.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jl.delete(o.pointerId)}}function eo(a,o,d,f,g,b){return a===null||a.nativeEvent!==b?(a={blockedOn:o,domEventName:d,eventSystemFlags:f,nativeEvent:b,targetContainers:[g]},o!==null&&(o=Mn(o),o!==null&&Jy(o)),a):(a.eventSystemFlags|=f,o=a.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),a)}function qj(a,o,d,f,g){switch(o){case"focusin":return Ha=eo(Ha,a,o,d,f,g),!0;case"dragenter":return za=eo(za,a,o,d,f,g),!0;case"mouseover":return Fa=eo(Fa,a,o,d,f,g),!0;case"pointerover":var b=g.pointerId;return Kl.set(b,eo(Kl.get(b)||null,a,o,d,f,g)),!0;case"gotpointercapture":return b=g.pointerId,Jl.set(b,eo(Jl.get(b)||null,a,o,d,f,g)),!0}return!1}function sb(a){var o=vn(a.target);if(o!==null){var d=l(o);if(d!==null){if(o=d.tag,o===13){if(o=c(d),o!==null){a.blockedOn=o,Qe(a.priority,function(){if(d.tag===13){var f=Xs();f=X(f);var g=hr(d,f);g!==null&&Qs(g,d,f),Ff(d,f)}});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function id(a){if(a.blockedOn!==null)return!1;for(var o=a.targetContainers;0<o.length;){var d=qf(a.nativeEvent);if(d===null){d=a.nativeEvent;var f=new d.constructor(d.type,d);Gu=f,d.target.dispatchEvent(f),Gu=null}else return o=Mn(d),o!==null&&Jy(o),a.blockedOn=d,!1;o.shift()}return!0}function nb(a,o,d){id(a)&&d.delete(o)}function Vj(){$f=!1,Ha!==null&&id(Ha)&&(Ha=null),za!==null&&id(za)&&(za=null),Fa!==null&&id(Fa)&&(Fa=null),Kl.forEach(nb),Jl.forEach(nb)}function rd(a,o){a.blockedOn===o&&(a.blockedOn=null,$f||($f=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Vj)))}var ld=null;function ab(a){ld!==a&&(ld=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ld===a&&(ld=null);for(var o=0;o<a.length;o+=3){var d=a[o],f=a[o+1],g=a[o+2];if(typeof f!="function"){if(Vf(f||d)===null)continue;break}var b=Mn(d);b!==null&&(a.splice(o,3),o-=3,qh(b,{pending:!0,data:g,method:d.method,action:f},f,g))}}))}function to(a){function o(B){return rd(B,a)}Ha!==null&&rd(Ha,a),za!==null&&rd(za,a),Fa!==null&&rd(Fa,a),Kl.forEach(o),Jl.forEach(o);for(var d=0;d<Ua.length;d++){var f=Ua[d];f.blockedOn===a&&(f.blockedOn=null)}for(;0<Ua.length&&(d=Ua[0],d.blockedOn===null);)sb(d),d.blockedOn===null&&Ua.shift();if(d=(a.ownerDocument||a).$$reactFormReplay,d!=null)for(f=0;f<d.length;f+=3){var g=d[f],b=d[f+1],j=g[St]||null;if(typeof b=="function")j||ab(d);else if(j){var k=null;if(b&&b.hasAttribute("formAction")){if(g=b,j=b[St]||null)k=j.formAction;else if(Vf(g)!==null)continue}else k=j.action;typeof k=="function"?d[f+1]=k:(d.splice(f,3),f-=3),ab(d)}}}function Gf(a){this._internalRoot=a}od.prototype.render=Gf.prototype.render=function(a){var o=this._internalRoot;if(o===null)throw Error(s(409));var d=o.current,f=Xs();Zy(d,f,a,o,null,null)},od.prototype.unmount=Gf.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var o=a.containerInfo;Zy(a.current,2,null,a,null,null),qc(),o[tn]=null}};function od(a){this._internalRoot=a}od.prototype.unstable_scheduleHydration=function(a){if(a){var o=De();a={blockedOn:null,target:a,priority:o};for(var d=0;d<Ua.length&&o!==0&&o<Ua[d].priority;d++);Ua.splice(d,0,a),d===0&&sb(a)}};var ib=e.version;if(ib!=="19.1.1")throw Error(s(527,ib,"19.1.1"));q.findDOMNode=function(a){var o=a._reactInternals;if(o===void 0)throw typeof a.render=="function"?Error(s(188)):(a=Object.keys(a).join(","),Error(s(268,a)));return a=h(o),a=a!==null?m(a):null,a=a===null?null:a.stateNode,a};var $j={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cd.isDisabled&&cd.supportsFiber)try{Ne=cd.inject($j),_e=cd}catch{}}return no.createRoot=function(a,o){if(!i(a))throw Error(s(299));var d=!1,f="",g=w0,b=A0,j=N0,k=null;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(j=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(k=o.unstable_transitionCallbacks)),o=Xy(a,1,!1,null,null,d,f,g,b,j,k,null),a[tn]=o.current,Cf(a),new Gf(o)},no.hydrateRoot=function(a,o,d){if(!i(a))throw Error(s(299));var f=!1,g="",b=w0,j=A0,k=N0,B=null,ee=null;return d!=null&&(d.unstable_strictMode===!0&&(f=!0),d.identifierPrefix!==void 0&&(g=d.identifierPrefix),d.onUncaughtError!==void 0&&(b=d.onUncaughtError),d.onCaughtError!==void 0&&(j=d.onCaughtError),d.onRecoverableError!==void 0&&(k=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(B=d.unstable_transitionCallbacks),d.formState!==void 0&&(ee=d.formState)),o=Xy(a,1,!0,o,d??null,f,g,b,j,k,B,ee),o.context=Qy(null),d=o.current,f=Xs(),f=X(f),g=ja(f),g.callback=null,Ea(d,g,f),d=f,o.current.lanes=d,Us(o,d),Bn(o),a[tn]=o.current,Cf(a),new od(o)},no.version="19.1.1",no}var xb;function tE(){if(xb)return Qf.exports;xb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Qf.exports=eE(),Qf.exports}var sE=tE();/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var yb="popstate";function nE(n={}){function e(s,i){let{pathname:l,search:c,hash:u}=s.location;return Bm("",{pathname:l,search:c,hash:u},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(s,i){return typeof i=="string"?i:_o(i)}return iE(e,t,null,n)}function Dt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function En(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function aE(){return Math.random().toString(36).substring(2,10)}function bb(n,e){return{usr:n.state,key:n.key,idx:e}}function Bm(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?sl(e):e,state:t,key:e&&e.key||s||aE()}}function _o({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function sl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function iE(n,e,t,s={}){let{window:i=document.defaultView,v5Compat:l=!1}=s,c=i.history,u="POP",h=null,m=p();m==null&&(m=0,c.replaceState({...c.state,idx:m},""));function p(){return(c.state||{idx:null}).idx}function x(){u="POP";let N=p(),S=N==null?null:N-m;m=N,h&&h({action:u,location:A.location,delta:S})}function y(N,S){u="PUSH";let E=Bm(A.location,N,S);m=p()+1;let C=bb(E,m),R=A.createHref(E);try{c.pushState(C,"",R)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;i.location.assign(R)}l&&h&&h({action:u,location:A.location,delta:1})}function v(N,S){u="REPLACE";let E=Bm(A.location,N,S);m=p();let C=bb(E,m),R=A.createHref(E);c.replaceState(C,"",R),l&&h&&h({action:u,location:A.location,delta:0})}function w(N){return rE(N)}let A={get action(){return u},get location(){return n(i,c)},listen(N){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(yb,x),h=N,()=>{i.removeEventListener(yb,x),h=null}},createHref(N){return e(i,N)},createURL:w,encodeLocation(N){let S=w(N);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:y,replace:v,go(N){return c.go(N)}};return A}function rE(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Dt(t,"No window.location.(origin|href) available to create URL");let s=typeof n=="string"?n:_o(n);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function ww(n,e,t="/"){return lE(n,e,t,!1)}function lE(n,e,t,s){let i=typeof e=="string"?sl(e):e,l=xa(i.pathname||"/",t);if(l==null)return null;let c=Aw(n);oE(c);let u=null;for(let h=0;u==null&&h<c.length;++h){let m=bE(l);u=xE(c[h],m,s)}return u}function Aw(n,e=[],t=[],s="",i=!1){let l=(c,u,h=i,m)=>{let p={relativePath:m===void 0?c.path||"":m,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(s)&&h)return;Dt(p.relativePath.startsWith(s),`Absolute route path "${p.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(s.length)}let x=ga([s,p.relativePath]),y=t.concat(p);c.children&&c.children.length>0&&(Dt(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),Aw(c.children,e,y,x,h)),!(c.path==null&&!c.index)&&e.push({path:x,score:pE(x,c.index),routesMeta:y})};return n.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))l(c,u);else for(let h of Nw(c.path))l(c,u,!0,h)}),e}function Nw(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,i=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return i?[l,""]:[l];let c=Nw(s.join("/")),u=[];return u.push(...c.map(h=>h===""?l:[l,h].join("/"))),i&&u.push(...c),u.map(h=>n.startsWith("/")&&h===""?"/":h)}function oE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:gE(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var cE=/^:[\w-]+$/,dE=3,uE=2,hE=1,fE=10,mE=-2,vb=n=>n==="*";function pE(n,e){let t=n.split("/"),s=t.length;return t.some(vb)&&(s+=mE),e&&(s+=uE),t.filter(i=>!vb(i)).reduce((i,l)=>i+(cE.test(l)?dE:l===""?hE:fE),s)}function gE(n,e){return n.length===e.length&&n.slice(0,-1).every((s,i)=>s===e[i])?n[n.length-1]-e[e.length-1]:0}function xE(n,e,t=!1){let{routesMeta:s}=n,i={},l="/",c=[];for(let u=0;u<s.length;++u){let h=s[u],m=u===s.length-1,p=l==="/"?e:e.slice(l.length)||"/",x=Hd({path:h.relativePath,caseSensitive:h.caseSensitive,end:m},p),y=h.route;if(!x&&m&&t&&!s[s.length-1].route.index&&(x=Hd({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!x)return null;Object.assign(i,x.params),c.push({params:i,pathname:ga([l,x.pathname]),pathnameBase:NE(ga([l,x.pathnameBase])),route:y}),x.pathnameBase!=="/"&&(l=ga([l,x.pathnameBase]))}return c}function Hd(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=yE(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let l=i[0],c=l.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:s.reduce((m,{paramName:p,isOptional:x},y)=>{if(p==="*"){let w=u[y]||"";c=l.slice(0,l.length-w.length).replace(/(.)\/+$/,"$1")}const v=u[y];return x&&!v?m[p]=void 0:m[p]=(v||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:c,pattern:n}}function yE(n,e=!1,t=!0){En(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,h)=>(s.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(s.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function bE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return En(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function xa(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}function vE(n,e="/"){let{pathname:t,search:s="",hash:i=""}=typeof n=="string"?sl(n):n;return{pathname:t?t.startsWith("/")?t:wE(t,e):e,search:SE(s),hash:jE(i)}}function wE(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function em(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function AE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function bp(n){let e=AE(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function vp(n,e,t,s=!1){let i;typeof n=="string"?i=sl(n):(i={...n},Dt(!i.pathname||!i.pathname.includes("?"),em("?","pathname","search",i)),Dt(!i.pathname||!i.pathname.includes("#"),em("#","pathname","hash",i)),Dt(!i.search||!i.search.includes("#"),em("#","search","hash",i)));let l=n===""||i.pathname==="",c=l?"/":i.pathname,u;if(c==null)u=t;else{let x=e.length-1;if(!s&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),x-=1;i.pathname=y.join("/")}u=x>=0?e[x]:"/"}let h=vE(i,u),m=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(m||p)&&(h.pathname+="/"),h}var ga=n=>n.join("/").replace(/\/\/+/g,"/"),NE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),SE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,jE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function EE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var Sw=["POST","PUT","PATCH","DELETE"];new Set(Sw);var _E=["GET",...Sw];new Set(_E);var nl=_.createContext(null);nl.displayName="DataRouter";var du=_.createContext(null);du.displayName="DataRouterState";_.createContext(!1);var jw=_.createContext({isTransitioning:!1});jw.displayName="ViewTransition";var CE=_.createContext(new Map);CE.displayName="Fetchers";var TE=_.createContext(null);TE.displayName="Await";var Tn=_.createContext(null);Tn.displayName="Navigation";var Bo=_.createContext(null);Bo.displayName="Location";var Dn=_.createContext({outlet:null,matches:[],isDataRoute:!1});Dn.displayName="Route";var wp=_.createContext(null);wp.displayName="RouteError";function DE(n,{relative:e}={}){Dt(al(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=_.useContext(Tn),{hash:i,pathname:l,search:c}=Ho(n,{relative:e}),u=l;return t!=="/"&&(u=l==="/"?t:ga([t,l])),s.createHref({pathname:u,search:c,hash:i})}function al(){return _.useContext(Bo)!=null}function ba(){return Dt(al(),"useLocation() may be used only in the context of a <Router> component."),_.useContext(Bo).location}var Ew="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function _w(n){_.useContext(Tn).static||_.useLayoutEffect(n)}function il(){let{isDataRoute:n}=_.useContext(Dn);return n?$E():RE()}function RE(){Dt(al(),"useNavigate() may be used only in the context of a <Router> component.");let n=_.useContext(nl),{basename:e,navigator:t}=_.useContext(Tn),{matches:s}=_.useContext(Dn),{pathname:i}=ba(),l=JSON.stringify(bp(s)),c=_.useRef(!1);return _w(()=>{c.current=!0}),_.useCallback((h,m={})=>{if(En(c.current,Ew),!c.current)return;if(typeof h=="number"){t.go(h);return}let p=vp(h,JSON.parse(l),i,m.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:ga([e,p.pathname])),(m.replace?t.replace:t.push)(p,m.state,m)},[e,t,l,i,n])}var kE=_.createContext(null);function ME(n){let e=_.useContext(Dn).outlet;return e&&_.createElement(kE.Provider,{value:n},e)}function Ho(n,{relative:e}={}){let{matches:t}=_.useContext(Dn),{pathname:s}=ba(),i=JSON.stringify(bp(t));return _.useMemo(()=>vp(n,JSON.parse(i),s,e==="path"),[n,i,s,e])}function LE(n,e){return Cw(n,e)}function Cw(n,e,t,s,i){Dt(al(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=_.useContext(Tn),{matches:c}=_.useContext(Dn),u=c[c.length-1],h=u?u.params:{},m=u?u.pathname:"/",p=u?u.pathnameBase:"/",x=u&&u.route;{let E=x&&x.path||"";Tw(m,!x||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let y=ba(),v;if(e){let E=typeof e=="string"?sl(e):e;Dt(p==="/"||E.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${E.pathname}" was given in the \`location\` prop.`),v=E}else v=y;let w=v.pathname||"/",A=w;if(p!=="/"){let E=p.replace(/^\//,"").split("/");A="/"+w.replace(/^\//,"").split("/").slice(E.length).join("/")}let N=ww(n,{pathname:A});En(x||N!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),En(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let S=HE(N&&N.map(E=>Object.assign({},E,{params:Object.assign({},h,E.params),pathname:ga([p,l.encodeLocation?l.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?p:ga([p,l.encodeLocation?l.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),c,t,s,i);return e&&S?_.createElement(Bo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},S):S}function OE(){let n=VE(),e=EE(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},c=null;return console.error("Error handled by React Router default ErrorBoundary:",n),c=_.createElement(_.Fragment,null,_.createElement("p",null,"💿 Hey developer 👋"),_.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",_.createElement("code",{style:l},"ErrorBoundary")," or"," ",_.createElement("code",{style:l},"errorElement")," prop on your route.")),_.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),t?_.createElement("pre",{style:i},t):null,c)}var PE=_.createElement(OE,null),IE=class extends _.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.unstable_onError?this.props.unstable_onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?_.createElement(Dn.Provider,{value:this.props.routeContext},_.createElement(wp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function BE({routeContext:n,match:e,children:t}){let s=_.useContext(nl);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),_.createElement(Dn.Provider,{value:n},t)}function HE(n,e=[],t=null,s=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let l=n,c=t?.errors;if(c!=null){let m=l.findIndex(p=>p.route.id&&c?.[p.route.id]!==void 0);Dt(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,m+1))}let u=!1,h=-1;if(t)for(let m=0;m<l.length;m++){let p=l[m];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=m),p.route.id){let{loaderData:x,errors:y}=t,v=p.route.loader&&!x.hasOwnProperty(p.route.id)&&(!y||y[p.route.id]===void 0);if(p.route.lazy||v){u=!0,h>=0?l=l.slice(0,h+1):l=[l[0]];break}}}return l.reduceRight((m,p,x)=>{let y,v=!1,w=null,A=null;t&&(y=c&&p.route.id?c[p.route.id]:void 0,w=p.route.errorElement||PE,u&&(h<0&&x===0?(Tw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,A=null):h===x&&(v=!0,A=p.route.hydrateFallbackElement||null)));let N=e.concat(l.slice(0,x+1)),S=()=>{let E;return y?E=w:v?E=A:p.route.Component?E=_.createElement(p.route.Component,null):p.route.element?E=p.route.element:E=m,_.createElement(BE,{match:p,routeContext:{outlet:m,matches:N,isDataRoute:t!=null},children:E})};return t&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?_.createElement(IE,{location:t.location,revalidation:t.revalidation,component:w,error:y,children:S(),routeContext:{outlet:null,matches:N,isDataRoute:!0},unstable_onError:s}):S()},null)}function Ap(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zE(n){let e=_.useContext(nl);return Dt(e,Ap(n)),e}function FE(n){let e=_.useContext(du);return Dt(e,Ap(n)),e}function UE(n){let e=_.useContext(Dn);return Dt(e,Ap(n)),e}function Np(n){let e=UE(n),t=e.matches[e.matches.length-1];return Dt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function qE(){return Np("useRouteId")}function VE(){let n=_.useContext(wp),e=FE("useRouteError"),t=Np("useRouteError");return n!==void 0?n:e.errors?.[t]}function $E(){let{router:n}=zE("useNavigate"),e=Np("useNavigate"),t=_.useRef(!1);return _w(()=>{t.current=!0}),_.useCallback(async(i,l={})=>{En(t.current,Ew),t.current&&(typeof i=="number"?n.navigate(i):await n.navigate(i,{fromRouteId:e,...l}))},[n,e])}var wb={};function Tw(n,e,t){!e&&!wb[n]&&(wb[n]=!0,En(!1,t))}_.memo(GE);function GE({routes:n,future:e,state:t,unstable_onError:s}){return Cw(n,void 0,t,s,e)}function pa({to:n,replace:e,state:t,relative:s}){Dt(al(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=_.useContext(Tn);En(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=_.useContext(Dn),{pathname:c}=ba(),u=il(),h=vp(n,bp(l),c,s==="path"),m=JSON.stringify(h);return _.useEffect(()=>{u(JSON.parse(m),{replace:e,state:t,relative:s})},[u,m,s,e,t]),null}function Sp(n){return ME(n.context)}function xt(n){Dt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function YE({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:i,static:l=!1}){Dt(!al(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=n.replace(/^\/*/,"/"),u=_.useMemo(()=>({basename:c,navigator:i,static:l,future:{}}),[c,i,l]);typeof t=="string"&&(t=sl(t));let{pathname:h="/",search:m="",hash:p="",state:x=null,key:y="default"}=t,v=_.useMemo(()=>{let w=xa(h,c);return w==null?null:{location:{pathname:w,search:m,hash:p,state:x,key:y},navigationType:s}},[c,h,m,p,x,y,s]);return En(v!=null,`<Router basename="${c}"> is not able to match the URL "${h}${m}${p}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:_.createElement(Tn.Provider,{value:u},_.createElement(Bo.Provider,{children:e,value:v}))}function WE({children:n,location:e}){return LE(Hm(n),e)}function Hm(n,e=[]){let t=[];return _.Children.forEach(n,(s,i)=>{if(!_.isValidElement(s))return;let l=[...e,i];if(s.type===_.Fragment){t.push.apply(t,Hm(s.props.children,l));return}Dt(s.type===xt,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Dt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let c={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=Hm(s.props.children,l)),t.push(c)}),t}var Ed="get",_d="application/x-www-form-urlencoded";function uu(n){return n!=null&&typeof n.tagName=="string"}function XE(n){return uu(n)&&n.tagName.toLowerCase()==="button"}function QE(n){return uu(n)&&n.tagName.toLowerCase()==="form"}function ZE(n){return uu(n)&&n.tagName.toLowerCase()==="input"}function KE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function JE(n,e){return n.button===0&&(!e||e==="_self")&&!KE(n)}var dd=null;function e_(){if(dd===null)try{new FormData(document.createElement("form"),0),dd=!1}catch{dd=!0}return dd}var t_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function tm(n){return n!=null&&!t_.has(n)?(En(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${_d}"`),null):n}function s_(n,e){let t,s,i,l,c;if(QE(n)){let u=n.getAttribute("action");s=u?xa(u,e):null,t=n.getAttribute("method")||Ed,i=tm(n.getAttribute("enctype"))||_d,l=new FormData(n)}else if(XE(n)||ZE(n)&&(n.type==="submit"||n.type==="image")){let u=n.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=n.getAttribute("formaction")||u.getAttribute("action");if(s=h?xa(h,e):null,t=n.getAttribute("formmethod")||u.getAttribute("method")||Ed,i=tm(n.getAttribute("formenctype"))||tm(u.getAttribute("enctype"))||_d,l=new FormData(u,n),!e_()){let{name:m,type:p,value:x}=n;if(p==="image"){let y=m?`${m}.`:"";l.append(`${y}x`,"0"),l.append(`${y}y`,"0")}else m&&l.append(m,x)}}else{if(uu(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Ed,s=null,i=_d,c=n}return l&&i==="text/plain"&&(c=l,l=void 0),{action:s,method:t.toLowerCase(),encType:i,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function jp(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function n_(n,e,t){let s=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return s.pathname==="/"?s.pathname=`_root.${t}`:e&&xa(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${t}`,s}async function a_(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function i_(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function r_(n,e,t){let s=await Promise.all(n.map(async i=>{let l=e.routes[i.route.id];if(l){let c=await a_(l,t);return c.links?c.links():[]}return[]}));return d_(s.flat(1).filter(i_).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function Ab(n,e,t,s,i,l){let c=(h,m)=>t[m]?h.route.id!==t[m].route.id:!0,u=(h,m)=>t[m].pathname!==h.pathname||t[m].route.path?.endsWith("*")&&t[m].params["*"]!==h.params["*"];return l==="assets"?e.filter((h,m)=>c(h,m)||u(h,m)):l==="data"?e.filter((h,m)=>{let p=s.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(c(h,m)||u(h,m))return!0;if(h.route.shouldRevalidate){let x=h.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function l_(n,e,{includeHydrateFallback:t}={}){return o_(n.map(s=>{let i=e.routes[s.route.id];if(!i)return[];let l=[i.module];return i.clientActionModule&&(l=l.concat(i.clientActionModule)),i.clientLoaderModule&&(l=l.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(l=l.concat(i.hydrateFallbackModule)),i.imports&&(l=l.concat(i.imports)),l}).flat(1))}function o_(n){return[...new Set(n)]}function c_(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function d_(n,e){let t=new Set;return new Set(e),n.reduce((s,i)=>{let l=JSON.stringify(c_(i));return t.has(l)||(t.add(l),s.push({key:l,link:i})),s},[])}function Dw(){let n=_.useContext(nl);return jp(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function u_(){let n=_.useContext(du);return jp(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Ep=_.createContext(void 0);Ep.displayName="FrameworkContext";function Rw(){let n=_.useContext(Ep);return jp(n,"You must render this element inside a <HydratedRouter> element"),n}function h_(n,e){let t=_.useContext(Ep),[s,i]=_.useState(!1),[l,c]=_.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:m,onMouseLeave:p,onTouchStart:x}=e,y=_.useRef(null);_.useEffect(()=>{if(n==="render"&&c(!0),n==="viewport"){let A=S=>{S.forEach(E=>{c(E.isIntersecting)})},N=new IntersectionObserver(A,{threshold:.5});return y.current&&N.observe(y.current),()=>{N.disconnect()}}},[n]),_.useEffect(()=>{if(s){let A=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(A)}}},[s]);let v=()=>{i(!0)},w=()=>{i(!1),c(!1)};return t?n!=="intent"?[l,y,{}]:[l,y,{onFocus:ao(u,v),onBlur:ao(h,w),onMouseEnter:ao(m,v),onMouseLeave:ao(p,w),onTouchStart:ao(x,v)}]:[!1,y,{}]}function ao(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function f_({page:n,...e}){let{router:t}=Dw(),s=_.useMemo(()=>ww(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?_.createElement(p_,{page:n,matches:s,...e}):null}function m_(n){let{manifest:e,routeModules:t}=Rw(),[s,i]=_.useState([]);return _.useEffect(()=>{let l=!1;return r_(n,e,t).then(c=>{l||i(c)}),()=>{l=!0}},[n,e,t]),s}function p_({page:n,matches:e,...t}){let s=ba(),{manifest:i,routeModules:l}=Rw(),{basename:c}=Dw(),{loaderData:u,matches:h}=u_(),m=_.useMemo(()=>Ab(n,e,h,i,s,"data"),[n,e,h,i,s]),p=_.useMemo(()=>Ab(n,e,h,i,s,"assets"),[n,e,h,i,s]),x=_.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let w=new Set,A=!1;if(e.forEach(S=>{let E=i.routes[S.route.id];!E||!E.hasLoader||(!m.some(C=>C.route.id===S.route.id)&&S.route.id in u&&l[S.route.id]?.shouldRevalidate||E.hasClientLoader?A=!0:w.add(S.route.id))}),w.size===0)return[];let N=n_(n,c,"data");return A&&w.size>0&&N.searchParams.set("_routes",e.filter(S=>w.has(S.route.id)).map(S=>S.route.id).join(",")),[N.pathname+N.search]},[c,u,s,i,m,e,n,l]),y=_.useMemo(()=>l_(p,i),[p,i]),v=m_(p);return _.createElement(_.Fragment,null,x.map(w=>_.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),y.map(w=>_.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),v.map(({key:w,link:A})=>_.createElement("link",{key:w,nonce:t.nonce,...A})))}function g_(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var kw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{kw&&(window.__reactRouterVersion="7.8.2")}catch{}function x_({basename:n,children:e,window:t}){let s=_.useRef();s.current==null&&(s.current=nE({window:t,v5Compat:!0}));let i=s.current,[l,c]=_.useState({action:i.action,location:i.location}),u=_.useCallback(h=>{_.startTransition(()=>c(h))},[c]);return _.useLayoutEffect(()=>i.listen(u),[i,u]),_.createElement(YE,{basename:n,children:e,location:l.location,navigationType:l.action,navigator:i})}var Mw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_p=_.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:i,reloadDocument:l,replace:c,state:u,target:h,to:m,preventScrollReset:p,viewTransition:x,...y},v){let{basename:w}=_.useContext(Tn),A=typeof m=="string"&&Mw.test(m),N,S=!1;if(typeof m=="string"&&A&&(N=m,kw))try{let P=new URL(window.location.href),Z=m.startsWith("//")?new URL(P.protocol+m):new URL(m),z=xa(Z.pathname,w);Z.origin===P.origin&&z!=null?m=z+Z.search+Z.hash:S=!0}catch{En(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=DE(m,{relative:i}),[C,R,D]=h_(s,y),O=w_(m,{replace:c,state:u,target:h,preventScrollReset:p,relative:i,viewTransition:x});function H(P){e&&e(P),P.defaultPrevented||O(P)}let F=_.createElement("a",{...y,...D,href:N||E,onClick:S||l?e:H,ref:g_(v,R),target:h,"data-discover":!A&&t==="render"?"true":void 0});return C&&!A?_.createElement(_.Fragment,null,F,_.createElement(f_,{page:E})):F});_p.displayName="Link";var y_=_.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:i=!1,style:l,to:c,viewTransition:u,children:h,...m},p){let x=Ho(c,{relative:m.relative}),y=ba(),v=_.useContext(du),{navigator:w,basename:A}=_.useContext(Tn),N=v!=null&&E_(x)&&u===!0,S=w.encodeLocation?w.encodeLocation(x).pathname:x.pathname,E=y.pathname,C=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(E=E.toLowerCase(),C=C?C.toLowerCase():null,S=S.toLowerCase()),C&&A&&(C=xa(C,A)||C);const R=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let D=E===S||!i&&E.startsWith(S)&&E.charAt(R)==="/",O=C!=null&&(C===S||!i&&C.startsWith(S)&&C.charAt(S.length)==="/"),H={isActive:D,isPending:O,isTransitioning:N},F=D?e:void 0,P;typeof s=="function"?P=s(H):P=[s,D?"active":null,O?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let Z=typeof l=="function"?l(H):l;return _.createElement(_p,{...m,"aria-current":F,className:P,ref:p,style:Z,to:c,viewTransition:u},typeof h=="function"?h(H):h)});y_.displayName="NavLink";var b_=_.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:i,state:l,method:c=Ed,action:u,onSubmit:h,relative:m,preventScrollReset:p,viewTransition:x,...y},v)=>{let w=S_(),A=j_(u,{relative:m}),N=c.toLowerCase()==="get"?"get":"post",S=typeof u=="string"&&Mw.test(u),E=C=>{if(h&&h(C),C.defaultPrevented)return;C.preventDefault();let R=C.nativeEvent.submitter,D=R?.getAttribute("formmethod")||c;w(R||C.currentTarget,{fetcherKey:e,method:D,navigate:t,replace:i,state:l,relative:m,preventScrollReset:p,viewTransition:x})};return _.createElement("form",{ref:v,method:N,action:A,onSubmit:s?h:E,...y,"data-discover":!S&&n==="render"?"true":void 0})});b_.displayName="Form";function v_(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Lw(n){let e=_.useContext(nl);return Dt(e,v_(n)),e}function w_(n,{target:e,replace:t,state:s,preventScrollReset:i,relative:l,viewTransition:c}={}){let u=il(),h=ba(),m=Ho(n,{relative:l});return _.useCallback(p=>{if(JE(p,e)){p.preventDefault();let x=t!==void 0?t:_o(h)===_o(m);u(n,{replace:x,state:s,preventScrollReset:i,relative:l,viewTransition:c})}},[h,u,m,t,s,e,n,i,l,c])}var A_=0,N_=()=>`__${String(++A_)}__`;function S_(){let{router:n}=Lw("useSubmit"),{basename:e}=_.useContext(Tn),t=qE();return _.useCallback(async(s,i={})=>{let{action:l,method:c,encType:u,formData:h,body:m}=s_(s,e);if(i.navigate===!1){let p=i.fetcherKey||N_();await n.fetch(p,t,i.action||l,{preventScrollReset:i.preventScrollReset,formData:h,body:m,formMethod:i.method||c,formEncType:i.encType||u,flushSync:i.flushSync})}else await n.navigate(i.action||l,{preventScrollReset:i.preventScrollReset,formData:h,body:m,formMethod:i.method||c,formEncType:i.encType||u,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[n,e,t])}function j_(n,{relative:e}={}){let{basename:t}=_.useContext(Tn),s=_.useContext(Dn);Dt(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),l={...Ho(n||".",{relative:e})},c=ba();if(n==null){l.search=c.search;let u=new URLSearchParams(l.search),h=u.getAll("index");if(h.some(p=>p==="")){u.delete("index"),h.filter(x=>x).forEach(x=>u.append("index",x));let p=u.toString();l.search=p?`?${p}`:""}}return(!n||n===".")&&i.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(l.pathname=l.pathname==="/"?t:ga([t,l.pathname])),_o(l)}function E_(n,{relative:e}={}){let t=_.useContext(jw);Dt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Lw("useViewTransitionState"),i=Ho(n,{relative:e});if(!t.isTransitioning)return!1;let l=xa(t.currentLocation.pathname,s)||t.currentLocation.pathname,c=xa(t.nextLocation.pathname,s)||t.nextLocation.pathname;return Hd(i.pathname,c)!=null||Hd(i.pathname,l)!=null}var zm=vw();function Ow(n,e){return function(){return n.apply(e,arguments)}}const{toString:__}=Object.prototype,{getPrototypeOf:Cp}=Object,{iterator:hu,toStringTag:Pw}=Symbol,fu=(n=>e=>{const t=__.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Rn=n=>(n=n.toLowerCase(),e=>fu(e)===n),mu=n=>e=>typeof e===n,{isArray:rl}=Array,Co=mu("undefined");function zo(n){return n!==null&&!Co(n)&&n.constructor!==null&&!Co(n.constructor)&&Bs(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Iw=Rn("ArrayBuffer");function C_(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Iw(n.buffer),e}const T_=mu("string"),Bs=mu("function"),Bw=mu("number"),Fo=n=>n!==null&&typeof n=="object",D_=n=>n===!0||n===!1,Cd=n=>{if(fu(n)!=="object")return!1;const e=Cp(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Pw in n)&&!(hu in n)},R_=n=>{if(!Fo(n)||zo(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},k_=Rn("Date"),M_=Rn("File"),L_=Rn("Blob"),O_=Rn("FileList"),P_=n=>Fo(n)&&Bs(n.pipe),I_=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Bs(n.append)&&((e=fu(n))==="formdata"||e==="object"&&Bs(n.toString)&&n.toString()==="[object FormData]"))},B_=Rn("URLSearchParams"),[H_,z_,F_,U_]=["ReadableStream","Request","Response","Headers"].map(Rn),q_=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Uo(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let s,i;if(typeof n!="object"&&(n=[n]),rl(n))for(s=0,i=n.length;s<i;s++)e.call(null,n[s],s,n);else{if(zo(n))return;const l=t?Object.getOwnPropertyNames(n):Object.keys(n),c=l.length;let u;for(s=0;s<c;s++)u=l[s],e.call(null,n[u],u,n)}}function Hw(n,e){if(zo(n))return null;e=e.toLowerCase();const t=Object.keys(n);let s=t.length,i;for(;s-- >0;)if(i=t[s],e===i.toLowerCase())return i;return null}const Di=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,zw=n=>!Co(n)&&n!==Di;function Fm(){const{caseless:n}=zw(this)&&this||{},e={},t=(s,i)=>{const l=n&&Hw(e,i)||i;Cd(e[l])&&Cd(s)?e[l]=Fm(e[l],s):Cd(s)?e[l]=Fm({},s):rl(s)?e[l]=s.slice():e[l]=s};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Uo(arguments[s],t);return e}const V_=(n,e,t,{allOwnKeys:s}={})=>(Uo(e,(i,l)=>{t&&Bs(i)?n[l]=Ow(i,t):n[l]=i},{allOwnKeys:s}),n),$_=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),G_=(n,e,t,s)=>{n.prototype=Object.create(e.prototype,s),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},Y_=(n,e,t,s)=>{let i,l,c;const u={};if(e=e||{},n==null)return e;do{for(i=Object.getOwnPropertyNames(n),l=i.length;l-- >0;)c=i[l],(!s||s(c,n,e))&&!u[c]&&(e[c]=n[c],u[c]=!0);n=t!==!1&&Cp(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},W_=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const s=n.indexOf(e,t);return s!==-1&&s===t},X_=n=>{if(!n)return null;if(rl(n))return n;let e=n.length;if(!Bw(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},Q_=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&Cp(Uint8Array)),Z_=(n,e)=>{const s=(n&&n[hu]).call(n);let i;for(;(i=s.next())&&!i.done;){const l=i.value;e.call(n,l[0],l[1])}},K_=(n,e)=>{let t;const s=[];for(;(t=n.exec(e))!==null;)s.push(t);return s},J_=Rn("HTMLFormElement"),e2=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,s,i){return s.toUpperCase()+i}),Nb=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),t2=Rn("RegExp"),Fw=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),s={};Uo(t,(i,l)=>{let c;(c=e(i,l,n))!==!1&&(s[l]=c||i)}),Object.defineProperties(n,s)},s2=n=>{Fw(n,(e,t)=>{if(Bs(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const s=n[t];if(Bs(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},n2=(n,e)=>{const t={},s=i=>{i.forEach(l=>{t[l]=!0})};return rl(n)?s(n):s(String(n).split(e)),t},a2=()=>{},i2=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function r2(n){return!!(n&&Bs(n.append)&&n[Pw]==="FormData"&&n[hu])}const l2=n=>{const e=new Array(10),t=(s,i)=>{if(Fo(s)){if(e.indexOf(s)>=0)return;if(zo(s))return s;if(!("toJSON"in s)){e[i]=s;const l=rl(s)?[]:{};return Uo(s,(c,u)=>{const h=t(c,i+1);!Co(h)&&(l[u]=h)}),e[i]=void 0,l}}return s};return t(n,0)},o2=Rn("AsyncFunction"),c2=n=>n&&(Fo(n)||Bs(n))&&Bs(n.then)&&Bs(n.catch),Uw=((n,e)=>n?setImmediate:e?((t,s)=>(Di.addEventListener("message",({source:i,data:l})=>{i===Di&&l===t&&s.length&&s.shift()()},!1),i=>{s.push(i),Di.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Bs(Di.postMessage)),d2=typeof queueMicrotask<"u"?queueMicrotask.bind(Di):typeof process<"u"&&process.nextTick||Uw,u2=n=>n!=null&&Bs(n[hu]),le={isArray:rl,isArrayBuffer:Iw,isBuffer:zo,isFormData:I_,isArrayBufferView:C_,isString:T_,isNumber:Bw,isBoolean:D_,isObject:Fo,isPlainObject:Cd,isEmptyObject:R_,isReadableStream:H_,isRequest:z_,isResponse:F_,isHeaders:U_,isUndefined:Co,isDate:k_,isFile:M_,isBlob:L_,isRegExp:t2,isFunction:Bs,isStream:P_,isURLSearchParams:B_,isTypedArray:Q_,isFileList:O_,forEach:Uo,merge:Fm,extend:V_,trim:q_,stripBOM:$_,inherits:G_,toFlatObject:Y_,kindOf:fu,kindOfTest:Rn,endsWith:W_,toArray:X_,forEachEntry:Z_,matchAll:K_,isHTMLForm:J_,hasOwnProperty:Nb,hasOwnProp:Nb,reduceDescriptors:Fw,freezeMethods:s2,toObjectSet:n2,toCamelCase:e2,noop:a2,toFiniteNumber:i2,findKey:Hw,global:Di,isContextDefined:zw,isSpecCompliantForm:r2,toJSONObject:l2,isAsyncFn:o2,isThenable:c2,setImmediate:Uw,asap:d2,isIterable:u2};function Ge(n,e,t,s,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),s&&(this.request=s),i&&(this.response=i,this.status=i.status?i.status:null)}le.inherits(Ge,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:le.toJSONObject(this.config),code:this.code,status:this.status}}});const qw=Ge.prototype,Vw={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{Vw[n]={value:n}});Object.defineProperties(Ge,Vw);Object.defineProperty(qw,"isAxiosError",{value:!0});Ge.from=(n,e,t,s,i,l)=>{const c=Object.create(qw);return le.toFlatObject(n,c,function(h){return h!==Error.prototype},u=>u!=="isAxiosError"),Ge.call(c,n.message,e,t,s,i),c.cause=n,c.name=n.name,l&&Object.assign(c,l),c};const h2=null;function Um(n){return le.isPlainObject(n)||le.isArray(n)}function $w(n){return le.endsWith(n,"[]")?n.slice(0,-2):n}function Sb(n,e,t){return n?n.concat(e).map(function(i,l){return i=$w(i),!t&&l?"["+i+"]":i}).join(t?".":""):e}function f2(n){return le.isArray(n)&&!n.some(Um)}const m2=le.toFlatObject(le,{},null,function(e){return/^is[A-Z]/.test(e)});function pu(n,e,t){if(!le.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=le.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(A,N){return!le.isUndefined(N[A])});const s=t.metaTokens,i=t.visitor||p,l=t.dots,c=t.indexes,h=(t.Blob||typeof Blob<"u"&&Blob)&&le.isSpecCompliantForm(e);if(!le.isFunction(i))throw new TypeError("visitor must be a function");function m(w){if(w===null)return"";if(le.isDate(w))return w.toISOString();if(le.isBoolean(w))return w.toString();if(!h&&le.isBlob(w))throw new Ge("Blob is not supported. Use a Buffer instead.");return le.isArrayBuffer(w)||le.isTypedArray(w)?h&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function p(w,A,N){let S=w;if(w&&!N&&typeof w=="object"){if(le.endsWith(A,"{}"))A=s?A:A.slice(0,-2),w=JSON.stringify(w);else if(le.isArray(w)&&f2(w)||(le.isFileList(w)||le.endsWith(A,"[]"))&&(S=le.toArray(w)))return A=$w(A),S.forEach(function(C,R){!(le.isUndefined(C)||C===null)&&e.append(c===!0?Sb([A],R,l):c===null?A:A+"[]",m(C))}),!1}return Um(w)?!0:(e.append(Sb(N,A,l),m(w)),!1)}const x=[],y=Object.assign(m2,{defaultVisitor:p,convertValue:m,isVisitable:Um});function v(w,A){if(!le.isUndefined(w)){if(x.indexOf(w)!==-1)throw Error("Circular reference detected in "+A.join("."));x.push(w),le.forEach(w,function(S,E){(!(le.isUndefined(S)||S===null)&&i.call(e,S,le.isString(E)?E.trim():E,A,y))===!0&&v(S,A?A.concat(E):[E])}),x.pop()}}if(!le.isObject(n))throw new TypeError("data must be an object");return v(n),e}function jb(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function Tp(n,e){this._pairs=[],n&&pu(n,this,e)}const Gw=Tp.prototype;Gw.append=function(e,t){this._pairs.push([e,t])};Gw.toString=function(e){const t=e?function(s){return e.call(this,s,jb)}:jb;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function p2(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Yw(n,e,t){if(!e)return n;const s=t&&t.encode||p2;le.isFunction(t)&&(t={serialize:t});const i=t&&t.serialize;let l;if(i?l=i(e,t):l=le.isURLSearchParams(e)?e.toString():new Tp(e,t).toString(s),l){const c=n.indexOf("#");c!==-1&&(n=n.slice(0,c)),n+=(n.indexOf("?")===-1?"?":"&")+l}return n}class Eb{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){le.forEach(this.handlers,function(s){s!==null&&e(s)})}}const Ww={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},g2=typeof URLSearchParams<"u"?URLSearchParams:Tp,x2=typeof FormData<"u"?FormData:null,y2=typeof Blob<"u"?Blob:null,b2={isBrowser:!0,classes:{URLSearchParams:g2,FormData:x2,Blob:y2},protocols:["http","https","file","blob","url","data"]},Dp=typeof window<"u"&&typeof document<"u",qm=typeof navigator=="object"&&navigator||void 0,v2=Dp&&(!qm||["ReactNative","NativeScript","NS"].indexOf(qm.product)<0),w2=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",A2=Dp&&window.location.href||"http://localhost",N2=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Dp,hasStandardBrowserEnv:v2,hasStandardBrowserWebWorkerEnv:w2,navigator:qm,origin:A2},Symbol.toStringTag,{value:"Module"})),ys={...N2,...b2};function S2(n,e){return pu(n,new ys.classes.URLSearchParams,{visitor:function(t,s,i,l){return ys.isNode&&le.isBuffer(t)?(this.append(s,t.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...e})}function j2(n){return le.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function E2(n){const e={},t=Object.keys(n);let s;const i=t.length;let l;for(s=0;s<i;s++)l=t[s],e[l]=n[l];return e}function Xw(n){function e(t,s,i,l){let c=t[l++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),h=l>=t.length;return c=!c&&le.isArray(i)?i.length:c,h?(le.hasOwnProp(i,c)?i[c]=[i[c],s]:i[c]=s,!u):((!i[c]||!le.isObject(i[c]))&&(i[c]=[]),e(t,s,i[c],l)&&le.isArray(i[c])&&(i[c]=E2(i[c])),!u)}if(le.isFormData(n)&&le.isFunction(n.entries)){const t={};return le.forEachEntry(n,(s,i)=>{e(j2(s),i,t,0)}),t}return null}function _2(n,e,t){if(le.isString(n))try{return(e||JSON.parse)(n),le.trim(n)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(n)}const qo={transitional:Ww,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",i=s.indexOf("application/json")>-1,l=le.isObject(e);if(l&&le.isHTMLForm(e)&&(e=new FormData(e)),le.isFormData(e))return i?JSON.stringify(Xw(e)):e;if(le.isArrayBuffer(e)||le.isBuffer(e)||le.isStream(e)||le.isFile(e)||le.isBlob(e)||le.isReadableStream(e))return e;if(le.isArrayBufferView(e))return e.buffer;if(le.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let u;if(l){if(s.indexOf("application/x-www-form-urlencoded")>-1)return S2(e,this.formSerializer).toString();if((u=le.isFileList(e))||s.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return pu(u?{"files[]":e}:e,h&&new h,this.formSerializer)}}return l||i?(t.setContentType("application/json",!1),_2(e)):e}],transformResponse:[function(e){const t=this.transitional||qo.transitional,s=t&&t.forcedJSONParsing,i=this.responseType==="json";if(le.isResponse(e)||le.isReadableStream(e))return e;if(e&&le.isString(e)&&(s&&!this.responseType||i)){const c=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(u){if(c)throw u.name==="SyntaxError"?Ge.from(u,Ge.ERR_BAD_RESPONSE,this,null,this.response):u}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ys.classes.FormData,Blob:ys.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};le.forEach(["delete","get","head","post","put","patch"],n=>{qo.headers[n]={}});const C2=le.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),T2=n=>{const e={};let t,s,i;return n&&n.split(`
`).forEach(function(c){i=c.indexOf(":"),t=c.substring(0,i).trim().toLowerCase(),s=c.substring(i+1).trim(),!(!t||e[t]&&C2[t])&&(t==="set-cookie"?e[t]?e[t].push(s):e[t]=[s]:e[t]=e[t]?e[t]+", "+s:s)}),e},_b=Symbol("internals");function io(n){return n&&String(n).trim().toLowerCase()}function Td(n){return n===!1||n==null?n:le.isArray(n)?n.map(Td):String(n)}function D2(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=t.exec(n);)e[s[1]]=s[2];return e}const R2=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function sm(n,e,t,s,i){if(le.isFunction(s))return s.call(this,e,t);if(i&&(e=t),!!le.isString(e)){if(le.isString(s))return e.indexOf(s)!==-1;if(le.isRegExp(s))return s.test(e)}}function k2(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}function M2(n,e){const t=le.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(n,s+t,{value:function(i,l,c){return this[s].call(this,e,i,l,c)},configurable:!0})})}let Hs=class{constructor(e){e&&this.set(e)}set(e,t,s){const i=this;function l(u,h,m){const p=io(h);if(!p)throw new Error("header name must be a non-empty string");const x=le.findKey(i,p);(!x||i[x]===void 0||m===!0||m===void 0&&i[x]!==!1)&&(i[x||h]=Td(u))}const c=(u,h)=>le.forEach(u,(m,p)=>l(m,p,h));if(le.isPlainObject(e)||e instanceof this.constructor)c(e,t);else if(le.isString(e)&&(e=e.trim())&&!R2(e))c(T2(e),t);else if(le.isObject(e)&&le.isIterable(e)){let u={},h,m;for(const p of e){if(!le.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[m=p[0]]=(h=u[m])?le.isArray(h)?[...h,p[1]]:[h,p[1]]:p[1]}c(u,t)}else e!=null&&l(t,e,s);return this}get(e,t){if(e=io(e),e){const s=le.findKey(this,e);if(s){const i=this[s];if(!t)return i;if(t===!0)return D2(i);if(le.isFunction(t))return t.call(this,i,s);if(le.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=io(e),e){const s=le.findKey(this,e);return!!(s&&this[s]!==void 0&&(!t||sm(this,this[s],s,t)))}return!1}delete(e,t){const s=this;let i=!1;function l(c){if(c=io(c),c){const u=le.findKey(s,c);u&&(!t||sm(s,s[u],u,t))&&(delete s[u],i=!0)}}return le.isArray(e)?e.forEach(l):l(e),i}clear(e){const t=Object.keys(this);let s=t.length,i=!1;for(;s--;){const l=t[s];(!e||sm(this,this[l],l,e,!0))&&(delete this[l],i=!0)}return i}normalize(e){const t=this,s={};return le.forEach(this,(i,l)=>{const c=le.findKey(s,l);if(c){t[c]=Td(i),delete t[l];return}const u=e?k2(l):String(l).trim();u!==l&&delete t[l],t[u]=Td(i),s[u]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return le.forEach(this,(s,i)=>{s!=null&&s!==!1&&(t[i]=e&&le.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach(i=>s.set(i)),s}static accessor(e){const s=(this[_b]=this[_b]={accessors:{}}).accessors,i=this.prototype;function l(c){const u=io(c);s[u]||(M2(i,c),s[u]=!0)}return le.isArray(e)?e.forEach(l):l(e),this}};Hs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);le.reduceDescriptors(Hs.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(s){this[t]=s}}});le.freezeMethods(Hs);function nm(n,e){const t=this||qo,s=e||t,i=Hs.from(s.headers);let l=s.data;return le.forEach(n,function(u){l=u.call(t,l,i.normalize(),e?e.status:void 0)}),i.normalize(),l}function Qw(n){return!!(n&&n.__CANCEL__)}function ll(n,e,t){Ge.call(this,n??"canceled",Ge.ERR_CANCELED,e,t),this.name="CanceledError"}le.inherits(ll,Ge,{__CANCEL__:!0});function Zw(n,e,t){const s=t.config.validateStatus;!t.status||!s||s(t.status)?n(t):e(new Ge("Request failed with status code "+t.status,[Ge.ERR_BAD_REQUEST,Ge.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function L2(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function O2(n,e){n=n||10;const t=new Array(n),s=new Array(n);let i=0,l=0,c;return e=e!==void 0?e:1e3,function(h){const m=Date.now(),p=s[l];c||(c=m),t[i]=h,s[i]=m;let x=l,y=0;for(;x!==i;)y+=t[x++],x=x%n;if(i=(i+1)%n,i===l&&(l=(l+1)%n),m-c<e)return;const v=p&&m-p;return v?Math.round(y*1e3/v):void 0}}function P2(n,e){let t=0,s=1e3/e,i,l;const c=(m,p=Date.now())=>{t=p,i=null,l&&(clearTimeout(l),l=null),n(...m)};return[(...m)=>{const p=Date.now(),x=p-t;x>=s?c(m,p):(i=m,l||(l=setTimeout(()=>{l=null,c(i)},s-x)))},()=>i&&c(i)]}const zd=(n,e,t=3)=>{let s=0;const i=O2(50,250);return P2(l=>{const c=l.loaded,u=l.lengthComputable?l.total:void 0,h=c-s,m=i(h),p=c<=u;s=c;const x={loaded:c,total:u,progress:u?c/u:void 0,bytes:h,rate:m||void 0,estimated:m&&u&&p?(u-c)/m:void 0,event:l,lengthComputable:u!=null,[e?"download":"upload"]:!0};n(x)},t)},Cb=(n,e)=>{const t=n!=null;return[s=>e[0]({lengthComputable:t,total:n,loaded:s}),e[1]]},Tb=n=>(...e)=>le.asap(()=>n(...e)),I2=ys.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,ys.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(ys.origin),ys.navigator&&/(msie|trident)/i.test(ys.navigator.userAgent)):()=>!0,B2=ys.hasStandardBrowserEnv?{write(n,e,t,s,i,l){const c=[n+"="+encodeURIComponent(e)];le.isNumber(t)&&c.push("expires="+new Date(t).toGMTString()),le.isString(s)&&c.push("path="+s),le.isString(i)&&c.push("domain="+i),l===!0&&c.push("secure"),document.cookie=c.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function H2(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function z2(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function Kw(n,e,t){let s=!H2(e);return n&&(s||t==!1)?z2(n,e):e}const Db=n=>n instanceof Hs?{...n}:n;function Hi(n,e){e=e||{};const t={};function s(m,p,x,y){return le.isPlainObject(m)&&le.isPlainObject(p)?le.merge.call({caseless:y},m,p):le.isPlainObject(p)?le.merge({},p):le.isArray(p)?p.slice():p}function i(m,p,x,y){if(le.isUndefined(p)){if(!le.isUndefined(m))return s(void 0,m,x,y)}else return s(m,p,x,y)}function l(m,p){if(!le.isUndefined(p))return s(void 0,p)}function c(m,p){if(le.isUndefined(p)){if(!le.isUndefined(m))return s(void 0,m)}else return s(void 0,p)}function u(m,p,x){if(x in e)return s(m,p);if(x in n)return s(void 0,m)}const h={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(m,p,x)=>i(Db(m),Db(p),x,!0)};return le.forEach(Object.keys({...n,...e}),function(p){const x=h[p]||i,y=x(n[p],e[p],p);le.isUndefined(y)&&x!==u||(t[p]=y)}),t}const Jw=n=>{const e=Hi({},n);let{data:t,withXSRFToken:s,xsrfHeaderName:i,xsrfCookieName:l,headers:c,auth:u}=e;e.headers=c=Hs.from(c),e.url=Yw(Kw(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let h;if(le.isFormData(t)){if(ys.hasStandardBrowserEnv||ys.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if((h=c.getContentType())!==!1){const[m,...p]=h?h.split(";").map(x=>x.trim()).filter(Boolean):[];c.setContentType([m||"multipart/form-data",...p].join("; "))}}if(ys.hasStandardBrowserEnv&&(s&&le.isFunction(s)&&(s=s(e)),s||s!==!1&&I2(e.url))){const m=i&&l&&B2.read(l);m&&c.set(i,m)}return e},F2=typeof XMLHttpRequest<"u",U2=F2&&function(n){return new Promise(function(t,s){const i=Jw(n);let l=i.data;const c=Hs.from(i.headers).normalize();let{responseType:u,onUploadProgress:h,onDownloadProgress:m}=i,p,x,y,v,w;function A(){v&&v(),w&&w(),i.cancelToken&&i.cancelToken.unsubscribe(p),i.signal&&i.signal.removeEventListener("abort",p)}let N=new XMLHttpRequest;N.open(i.method.toUpperCase(),i.url,!0),N.timeout=i.timeout;function S(){if(!N)return;const C=Hs.from("getAllResponseHeaders"in N&&N.getAllResponseHeaders()),D={data:!u||u==="text"||u==="json"?N.responseText:N.response,status:N.status,statusText:N.statusText,headers:C,config:n,request:N};Zw(function(H){t(H),A()},function(H){s(H),A()},D),N=null}"onloadend"in N?N.onloadend=S:N.onreadystatechange=function(){!N||N.readyState!==4||N.status===0&&!(N.responseURL&&N.responseURL.indexOf("file:")===0)||setTimeout(S)},N.onabort=function(){N&&(s(new Ge("Request aborted",Ge.ECONNABORTED,n,N)),N=null)},N.onerror=function(){s(new Ge("Network Error",Ge.ERR_NETWORK,n,N)),N=null},N.ontimeout=function(){let R=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const D=i.transitional||Ww;i.timeoutErrorMessage&&(R=i.timeoutErrorMessage),s(new Ge(R,D.clarifyTimeoutError?Ge.ETIMEDOUT:Ge.ECONNABORTED,n,N)),N=null},l===void 0&&c.setContentType(null),"setRequestHeader"in N&&le.forEach(c.toJSON(),function(R,D){N.setRequestHeader(D,R)}),le.isUndefined(i.withCredentials)||(N.withCredentials=!!i.withCredentials),u&&u!=="json"&&(N.responseType=i.responseType),m&&([y,w]=zd(m,!0),N.addEventListener("progress",y)),h&&N.upload&&([x,v]=zd(h),N.upload.addEventListener("progress",x),N.upload.addEventListener("loadend",v)),(i.cancelToken||i.signal)&&(p=C=>{N&&(s(!C||C.type?new ll(null,n,N):C),N.abort(),N=null)},i.cancelToken&&i.cancelToken.subscribe(p),i.signal&&(i.signal.aborted?p():i.signal.addEventListener("abort",p)));const E=L2(i.url);if(E&&ys.protocols.indexOf(E)===-1){s(new Ge("Unsupported protocol "+E+":",Ge.ERR_BAD_REQUEST,n));return}N.send(l||null)})},q2=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let s=new AbortController,i;const l=function(m){if(!i){i=!0,u();const p=m instanceof Error?m:this.reason;s.abort(p instanceof Ge?p:new ll(p instanceof Error?p.message:p))}};let c=e&&setTimeout(()=>{c=null,l(new Ge(`timeout ${e} of ms exceeded`,Ge.ETIMEDOUT))},e);const u=()=>{n&&(c&&clearTimeout(c),c=null,n.forEach(m=>{m.unsubscribe?m.unsubscribe(l):m.removeEventListener("abort",l)}),n=null)};n.forEach(m=>m.addEventListener("abort",l));const{signal:h}=s;return h.unsubscribe=()=>le.asap(u),h}},V2=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let s=0,i;for(;s<t;)i=s+e,yield n.slice(s,i),s=i},$2=async function*(n,e){for await(const t of G2(n))yield*V2(t,e)},G2=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:s}=await e.read();if(t)break;yield s}}finally{await e.cancel()}},Rb=(n,e,t,s)=>{const i=$2(n,e);let l=0,c,u=h=>{c||(c=!0,s&&s(h))};return new ReadableStream({async pull(h){try{const{done:m,value:p}=await i.next();if(m){u(),h.close();return}let x=p.byteLength;if(t){let y=l+=x;t(y)}h.enqueue(new Uint8Array(p))}catch(m){throw u(m),m}},cancel(h){return u(h),i.return()}},{highWaterMark:2})},gu=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",e1=gu&&typeof ReadableStream=="function",Y2=gu&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),t1=(n,...e)=>{try{return!!n(...e)}catch{return!1}},W2=e1&&t1(()=>{let n=!1;const e=new Request(ys.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),kb=64*1024,Vm=e1&&t1(()=>le.isReadableStream(new Response("").body)),Fd={stream:Vm&&(n=>n.body)};gu&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Fd[e]&&(Fd[e]=le.isFunction(n[e])?t=>t[e]():(t,s)=>{throw new Ge(`Response type '${e}' is not supported`,Ge.ERR_NOT_SUPPORT,s)})})})(new Response);const X2=async n=>{if(n==null)return 0;if(le.isBlob(n))return n.size;if(le.isSpecCompliantForm(n))return(await new Request(ys.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(le.isArrayBufferView(n)||le.isArrayBuffer(n))return n.byteLength;if(le.isURLSearchParams(n)&&(n=n+""),le.isString(n))return(await Y2(n)).byteLength},Q2=async(n,e)=>{const t=le.toFiniteNumber(n.getContentLength());return t??X2(e)},Z2=gu&&(async n=>{let{url:e,method:t,data:s,signal:i,cancelToken:l,timeout:c,onDownloadProgress:u,onUploadProgress:h,responseType:m,headers:p,withCredentials:x="same-origin",fetchOptions:y}=Jw(n);m=m?(m+"").toLowerCase():"text";let v=q2([i,l&&l.toAbortSignal()],c),w;const A=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let N;try{if(h&&W2&&t!=="get"&&t!=="head"&&(N=await Q2(p,s))!==0){let D=new Request(e,{method:"POST",body:s,duplex:"half"}),O;if(le.isFormData(s)&&(O=D.headers.get("content-type"))&&p.setContentType(O),D.body){const[H,F]=Cb(N,zd(Tb(h)));s=Rb(D.body,kb,H,F)}}le.isString(x)||(x=x?"include":"omit");const S="credentials"in Request.prototype;w=new Request(e,{...y,signal:v,method:t.toUpperCase(),headers:p.normalize().toJSON(),body:s,duplex:"half",credentials:S?x:void 0});let E=await fetch(w,y);const C=Vm&&(m==="stream"||m==="response");if(Vm&&(u||C&&A)){const D={};["status","statusText","headers"].forEach(P=>{D[P]=E[P]});const O=le.toFiniteNumber(E.headers.get("content-length")),[H,F]=u&&Cb(O,zd(Tb(u),!0))||[];E=new Response(Rb(E.body,kb,H,()=>{F&&F(),A&&A()}),D)}m=m||"text";let R=await Fd[le.findKey(Fd,m)||"text"](E,n);return!C&&A&&A(),await new Promise((D,O)=>{Zw(D,O,{data:R,headers:Hs.from(E.headers),status:E.status,statusText:E.statusText,config:n,request:w})})}catch(S){throw A&&A(),S&&S.name==="TypeError"&&/Load failed|fetch/i.test(S.message)?Object.assign(new Ge("Network Error",Ge.ERR_NETWORK,n,w),{cause:S.cause||S}):Ge.from(S,S&&S.code,n,w)}}),$m={http:h2,xhr:U2,fetch:Z2};le.forEach($m,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const Mb=n=>`- ${n}`,K2=n=>le.isFunction(n)||n===null||n===!1,s1={getAdapter:n=>{n=le.isArray(n)?n:[n];const{length:e}=n;let t,s;const i={};for(let l=0;l<e;l++){t=n[l];let c;if(s=t,!K2(t)&&(s=$m[(c=String(t)).toLowerCase()],s===void 0))throw new Ge(`Unknown adapter '${c}'`);if(s)break;i[c||"#"+l]=s}if(!s){const l=Object.entries(i).map(([u,h])=>`adapter ${u} `+(h===!1?"is not supported by the environment":"is not available in the build"));let c=e?l.length>1?`since :
`+l.map(Mb).join(`
`):" "+Mb(l[0]):"as no adapter specified";throw new Ge("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return s},adapters:$m};function am(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new ll(null,n)}function Lb(n){return am(n),n.headers=Hs.from(n.headers),n.data=nm.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),s1.getAdapter(n.adapter||qo.adapter)(n).then(function(s){return am(n),s.data=nm.call(n,n.transformResponse,s),s.headers=Hs.from(s.headers),s},function(s){return Qw(s)||(am(n),s&&s.response&&(s.response.data=nm.call(n,n.transformResponse,s.response),s.response.headers=Hs.from(s.response.headers))),Promise.reject(s)})}const n1="1.11.0",xu={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{xu[n]=function(s){return typeof s===n||"a"+(e<1?"n ":" ")+n}});const Ob={};xu.transitional=function(e,t,s){function i(l,c){return"[Axios v"+n1+"] Transitional option '"+l+"'"+c+(s?". "+s:"")}return(l,c,u)=>{if(e===!1)throw new Ge(i(c," has been removed"+(t?" in "+t:"")),Ge.ERR_DEPRECATED);return t&&!Ob[c]&&(Ob[c]=!0,console.warn(i(c," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(l,c,u):!0}};xu.spelling=function(e){return(t,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function J2(n,e,t){if(typeof n!="object")throw new Ge("options must be an object",Ge.ERR_BAD_OPTION_VALUE);const s=Object.keys(n);let i=s.length;for(;i-- >0;){const l=s[i],c=e[l];if(c){const u=n[l],h=u===void 0||c(u,l,n);if(h!==!0)throw new Ge("option "+l+" must be "+h,Ge.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Ge("Unknown option "+l,Ge.ERR_BAD_OPTION)}}const Dd={assertOptions:J2,validators:xu},Fn=Dd.validators;let Pi=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Eb,response:new Eb}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const l=i.stack?i.stack.replace(/^.+\n/,""):"";try{s.stack?l&&!String(s.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+l):s.stack=l}catch{}}throw s}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Hi(this.defaults,t);const{transitional:s,paramsSerializer:i,headers:l}=t;s!==void 0&&Dd.assertOptions(s,{silentJSONParsing:Fn.transitional(Fn.boolean),forcedJSONParsing:Fn.transitional(Fn.boolean),clarifyTimeoutError:Fn.transitional(Fn.boolean)},!1),i!=null&&(le.isFunction(i)?t.paramsSerializer={serialize:i}:Dd.assertOptions(i,{encode:Fn.function,serialize:Fn.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Dd.assertOptions(t,{baseUrl:Fn.spelling("baseURL"),withXsrfToken:Fn.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let c=l&&le.merge(l.common,l[t.method]);l&&le.forEach(["delete","get","head","post","put","patch","common"],w=>{delete l[w]}),t.headers=Hs.concat(c,l);const u=[];let h=!0;this.interceptors.request.forEach(function(A){typeof A.runWhen=="function"&&A.runWhen(t)===!1||(h=h&&A.synchronous,u.unshift(A.fulfilled,A.rejected))});const m=[];this.interceptors.response.forEach(function(A){m.push(A.fulfilled,A.rejected)});let p,x=0,y;if(!h){const w=[Lb.bind(this),void 0];for(w.unshift(...u),w.push(...m),y=w.length,p=Promise.resolve(t);x<y;)p=p.then(w[x++],w[x++]);return p}y=u.length;let v=t;for(x=0;x<y;){const w=u[x++],A=u[x++];try{v=w(v)}catch(N){A.call(this,N);break}}try{p=Lb.call(this,v)}catch(w){return Promise.reject(w)}for(x=0,y=m.length;x<y;)p=p.then(m[x++],m[x++]);return p}getUri(e){e=Hi(this.defaults,e);const t=Kw(e.baseURL,e.url,e.allowAbsoluteUrls);return Yw(t,e.params,e.paramsSerializer)}};le.forEach(["delete","get","head","options"],function(e){Pi.prototype[e]=function(t,s){return this.request(Hi(s||{},{method:e,url:t,data:(s||{}).data}))}});le.forEach(["post","put","patch"],function(e){function t(s){return function(l,c,u){return this.request(Hi(u||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:l,data:c}))}}Pi.prototype[e]=t(),Pi.prototype[e+"Form"]=t(!0)});let eC=class a1{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(l){t=l});const s=this;this.promise.then(i=>{if(!s._listeners)return;let l=s._listeners.length;for(;l-- >0;)s._listeners[l](i);s._listeners=null}),this.promise.then=i=>{let l;const c=new Promise(u=>{s.subscribe(u),l=u}).then(i);return c.cancel=function(){s.unsubscribe(l)},c},e(function(l,c,u){s.reason||(s.reason=new ll(l,c,u),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=s=>{e.abort(s)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new a1(function(i){e=i}),cancel:e}}};function tC(n){return function(t){return n.apply(null,t)}}function sC(n){return le.isObject(n)&&n.isAxiosError===!0}const Gm={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Gm).forEach(([n,e])=>{Gm[e]=n});function i1(n){const e=new Pi(n),t=Ow(Pi.prototype.request,e);return le.extend(t,Pi.prototype,e,{allOwnKeys:!0}),le.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return i1(Hi(n,i))},t}const Ft=i1(qo);Ft.Axios=Pi;Ft.CanceledError=ll;Ft.CancelToken=eC;Ft.isCancel=Qw;Ft.VERSION=n1;Ft.toFormData=pu;Ft.AxiosError=Ge;Ft.Cancel=Ft.CanceledError;Ft.all=function(e){return Promise.all(e)};Ft.spread=tC;Ft.isAxiosError=sC;Ft.mergeConfig=Hi;Ft.AxiosHeaders=Hs;Ft.formToJSON=n=>Xw(le.isHTMLForm(n)?new FormData(n):n);Ft.getAdapter=s1.getAdapter;Ft.HttpStatusCode=Gm;Ft.default=Ft;const{Axios:aI,AxiosError:iI,CanceledError:rI,isCancel:lI,CancelToken:oI,VERSION:cI,all:dI,Cancel:uI,isAxiosError:hI,spread:fI,toFormData:mI,AxiosHeaders:pI,HttpStatusCode:gI,formToJSON:xI,getAdapter:yI,mergeConfig:bI}=Ft,xe=Ft.create({baseURL:"https://gys-hrms.vercel.app/api",headers:{"Content-Type":"application/json"}});xe.interceptors.request.use(n=>{const e=localStorage.getItem("token");return e&&(n.headers.Authorization=`Bearer ${e}`),n},n=>Promise.reject(n));const r1=_.createContext(),nC=({children:n})=>{const[e,t]=_.useState(null),[s,i]=_.useState(localStorage.getItem("token")||null),[l,c]=_.useState(!0),u=async(y,v)=>{const w=await xe.post("/auth/login",{email:y,password:v});i(w.data.token),localStorage.setItem("token",w.data.token),t(w.data.user)},h=()=>{t(null),i(null),localStorage.removeItem("token")},m=async y=>(await xe.post("/auth/forgot-password",{email:y})).data,p=async(y,v)=>(await xe.post("/auth/verify-otp",{email:y,otp:v})).data,x=async(y,v,w)=>(await xe.post("/auth/reset-password",{email:y,otp:v,password:w})).data;return _.useEffect(()=>{(async()=>{if(s)try{const v=await xe.get("/auth/me",{headers:{Authorization:`Bearer ${s}`}});t(v.data)}catch{h()}c(!1)})()},[s]),r.jsx(r1.Provider,{value:{user:e,token:s,loading:l,login:u,logout:h,requestPasswordReset:m,verifyOtp:p,resetPassword:x},children:n})},ls=()=>_.useContext(r1);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aC=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),iC=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),Pb=n=>{const e=iC(n);return e.charAt(0).toUpperCase()+e.slice(1)},l1=(...n)=>n.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim(),rC=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oC=_.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:i="",children:l,iconNode:c,...u},h)=>_.createElement("svg",{ref:h,...lC,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:l1("lucide",i),...!l&&!rC(u)&&{"aria-hidden":"true"},...u},[...c.map(([m,p])=>_.createElement(m,p)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=(n,e)=>{const t=_.forwardRef(({className:s,...i},l)=>_.createElement(oC,{ref:l,iconNode:e,className:l1(`lucide-${aC(Pb(n))}`,`lucide-${n}`,s),...i}));return t.displayName=Pb(n),t};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cC=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],dC=nt("arrow-left",cC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],im=nt("arrow-right",uC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hC=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],fC=nt("camera",hC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mC=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Es=nt("calendar",mC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pC=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],rm=nt("chart-column",pC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gC=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],fo=nt("chevron-down",gC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xC=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ib=nt("chevron-left",xC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yC=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Bb=nt("chevron-right",yC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bC=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],mo=nt("chevron-up",bC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],as=nt("circle-alert",vC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wC=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],js=nt("circle-check-big",wC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],Hb=nt("circle-user",AC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],mn=nt("circle-x",NC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SC=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],pn=nt("clock",SC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jC=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],Ud=nt("coffee",jC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EC=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],lm=nt("credit-card",EC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _C=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],CC=nt("dollar-sign",_C);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TC=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Ym=nt("eye-off",TC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DC=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],To=nt("eye",DC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RC=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],bo=nt("file-text",RC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kC=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],o1=nt("funnel",kC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MC=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],qd=nt("heart",MC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LC=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],OC=nt("loader",LC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PC=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Ur=nt("lock",PC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IC=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],BC=nt("log-out",IC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HC=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],c1=nt("mail",HC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zC=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],d1=nt("menu",zC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ii=nt("plus",FC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UC=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],zi=nt("refresh-cw",UC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Rp=nt("search",qC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VC=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Wm=nt("square-pen",VC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $C=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],kp=nt("trash-2",$C);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GC=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],YC=nt("user-check",GC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],u1=nt("user",WC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XC=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Vd=nt("users",XC);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Zr=nt("x",QC),ZC=()=>{const[n,e]=_.useState(""),[t,s]=_.useState(""),[i,l]=_.useState(!1),[c,u]=_.useState(!1),[h,m]=_.useState(""),{login:p}=ls(),x=il(),y=async v=>{if(v.preventDefault(),m(""),u(!0),!n||!t){m("Please fill in all fields"),u(!1);return}if(!n.includes("@")){m("Please enter a valid email address"),u(!1);return}try{await p(n,t);const w=JSON.parse(localStorage.getItem("user"))?.role;x(w==="admin"?"/admin":w==="hr"?"/hr":"/employee")}catch(w){m(w.response?.data?.message||"Invalid credentials")}finally{u(!1)}};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 flex items-center justify-center px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"max-w-md w-full space-y-8",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto h-16 w-16 bg-[#104774] rounded-full flex items-center justify-center mb-4",children:r.jsx(Ur,{className:"h-8 w-8 text-white"})}),r.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome back"}),r.jsx("p",{className:"text-gray-600",children:"Please sign in to your account"})]}),r.jsx("div",{className:"bg-white py-8 px-6 shadow-xl rounded-xl border border-gray-100",children:r.jsxs("form",{onSubmit:y,className:"space-y-6",children:[h&&r.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[r.jsx(as,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),r.jsx("span",{className:"text-sm text-red-700",children:h})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email address"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(c1,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] focus:border-[#104774] focus:z-10 sm:text-sm transition-colors duration-200",placeholder:"Enter your email",value:n,onChange:v=>e(v.target.value),disabled:c})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(Ur,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"password",name:"password",type:i?"text":"password",autoComplete:"current-password",required:!0,className:"appearance-none relative block w-full pl-10 pr-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] focus:border-[#104774] focus:z-10 sm:text-sm transition-colors duration-200",placeholder:"Enter your password",value:t,onChange:v=>s(v.target.value),disabled:c}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>l(!i),disabled:c,children:i?r.jsx(Ym,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):r.jsx(To,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),r.jsx("div",{className:"flex items-center justify-end",children:r.jsx("button",{onClick:()=>x("/forgot-password"),type:"button",className:"text-sm text-[#104774] hover:text-[#0d385d] font-medium transition-colors duration-200",children:"Forgot your password?"})}),r.jsx("div",{children:r.jsx("button",{type:"submit",disabled:c,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-[#104774] hover:bg-[#0d385d] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#104774] disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105 active:scale-95",children:c?r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),r.jsx("span",{children:"Signing in..."})]}):"Sign in"})})]})})]})})},KC="/assets/gys_logo-Blem-OFh.png",Mp=({closeSidebar:n})=>{const{user:e,logout:t}=ls(),s=ba();if(!e)return null;const i={admin:[{label:"Dashboard",path:"/admin",icon:rm},{label:"Manage Employees",path:"/admin/manage-employees",icon:Vd},{label:"Attendance Management",path:"/admin/attendance",icon:pn},{label:"Payroll Approval",path:"/admin/payroll-approval",icon:lm},{label:"Calendar",path:"/admin/calendar",icon:Es},{label:"Leaves Management",path:"/admin/leaves",icon:bo}],hr:[{label:"Dashboard",path:"/hr",icon:rm},{label:"Manage Employees",path:"/hr/manage-employees",icon:Vd},{label:"Attendance Management",path:"/hr/attendance",icon:pn},{label:"Payroll",path:"/hr/payroll",icon:lm},{label:"Leaves Management",path:"/hr/leaves",icon:bo},{label:"My Profile",path:"/hr/profile",icon:Hb},{label:"Calendar",path:"/hr/calendar",icon:Es}],employee:[{label:"Dashboard",path:"/employee",icon:rm},{label:"My Attendance",path:"/employee/attendance",icon:pn},{label:"My Leaves",path:"/employee/leaves",icon:bo},{label:"Payslip",path:"/employee/payslip",icon:lm},{label:"My Profile",path:"/employee/profile",icon:Hb},{label:"Calendar",path:"/employee/calendar",icon:Es}]};return r.jsxs("div",{className:"bg-white shadow-lg w-80 min-h-screen flex flex-col relative",children:[r.jsxs("div",{className:" px-5  border-b border-gray-100 flex items-center justify-between",children:[r.jsx("div",{className:"flex items-center",children:r.jsx("img",{src:KC,alt:"GYS Logo",className:"h-21 w-auto object-contain "})}),r.jsx("button",{onClick:n,className:"lg:hidden text-gray-600 hover:text-gray-900",children:"✕"})]}),r.jsx("div",{className:"p-6 border-b border-gray-100",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[e?.avatarUrl?r.jsx("img",{src:e?.avatarUrl,alt:e.firstName,className:"w-20 h-20 rounded-full object-cover border border-gray-200"}):r.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-300 to-gray-400 rounded-full flex items-center justify-center",children:r.jsx(u1,{size:20,className:"text-gray-600"})}),r.jsx("div",{className:"flex-1",children:e?.firstName||e?.lastName||e?.designation?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"font-semibold text-gray-800 px-1",children:`${e?.firstName||""} ${e?.lastName||""}`}),r.jsx("div",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full inline-block mt-1",children:e?.designation?.toUpperCase()})]}):r.jsx("div",{className:"font-semibold text-gray-500 bg-gray-100 px-5 py-1 rounded-full inline-block",children:e?.role?.toUpperCase()})})]})}),r.jsx("nav",{className:"flex-1 p-4 space-y-3",children:i[e.role]?.map((l,c)=>{const u=l.icon,h=s.pathname===l.path;return r.jsxs(_p,{to:l.path,onClick:n,className:`w-full flex items-center px-4 py-4 rounded-xl transition-all duration-200 group ${h?"bg-gradient-to-r from-[#104774] to-[#0d3a61] text-white shadow-lg transform scale-105":"text-gray-600 hover:bg-gray-50 hover:text-[#104774]"}`,children:[r.jsx(u,{size:20,className:`mr-4 transition-transform duration-200 ${h?"scale-110":"group-hover:scale-110"}`}),r.jsx("span",{className:"font-medium text-sm",children:l.label}),h&&r.jsx("div",{className:"ml-auto w-2 h-2 bg-white rounded-full opacity-80"})]},c)})}),r.jsx("div",{className:"p-4 border-t border-gray-100 mt-8",children:r.jsxs("button",{onClick:t,className:"w-full flex items-center px-4 py-4 text-red-600 hover:bg-red-50 rounded-xl transition-all duration-200 group",children:[r.jsx(BC,{size:20,className:"mr-4 transition-transform duration-200 group-hover:scale-110"}),r.jsx("span",{className:"font-medium text-sm",children:"Log Out"})]})})]})},Lp=({onMenuClick:n})=>{const{user:e}=ls();if(!e)return null;const t=new Date().toLocaleDateString("en-US",{weekday:"long",day:"numeric",month:"short"}),s=new Date().getHours();let i="Hello";return s<12?i="Good Morning":s<18?i="Good Afternoon":i="Good Evening",r.jsxs("div",{className:"sticky top-0 z-50 bg-gradient-to-r from-white to-gray-50 px-6 py-3 flex justify-between items-center border-b border-gray-200 shadow-sm",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("button",{onClick:n,className:"lg:hidden p-2 rounded-md text-gray-700 hover:bg-gray-100",children:r.jsx(d1,{size:24})}),r.jsxs("div",{children:[r.jsxs("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-1",children:[i,", ",e.firstName]}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-500 font-medium",children:t})]})]}),r.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-[#104774] to-[#0d3a61] text-white rounded-full text-xs sm:text-sm font-medium shadow",children:e.role.toUpperCase()})]})},JC=()=>{const[n,e]=_.useState(!1);return r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:`fixed inset-0 z-40 lg:static lg:translate-x-0 transition-transform duration-300 ${n?"translate-x-0":"-translate-x-full"}`,children:r.jsx(Mp,{closeSidebar:()=>e(!1)})}),r.jsxs("div",{className:"flex-1 flex flex-col min-h-screen",children:[r.jsx(Lp,{onMenuClick:()=>e(!0)}),r.jsx("div",{className:"p-6 flex-1 bg-gray-50 overflow-y-auto",children:r.jsx(Sp,{})})]})]})},eT=()=>{const[n,e]=_.useState(!1);return r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:`fixed inset-0 z-40 lg:static lg:translate-x-0 transition-transform duration-300 ${n?"translate-x-0":"-translate-x-full"}`,children:r.jsx(Mp,{closeSidebar:()=>e(!1)})}),r.jsxs("div",{className:"flex-1 flex flex-col min-h-screen",children:[r.jsx(Lp,{onMenuClick:()=>e(!0)}),r.jsx("div",{className:"p-6 flex-1 bg-gray-50 overflow-y-auto",children:r.jsx(Sp,{})})]})]})},tT=()=>{const[n,e]=_.useState(!1);return r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:`fixed inset-0 z-40 lg:static lg:translate-x-0 transition-transform duration-300 ${n?"translate-x-0":"-translate-x-full"}`,children:r.jsx(Mp,{closeSidebar:()=>e(!1)})}),r.jsxs("div",{className:"flex-1 flex flex-col min-h-screen",children:[r.jsx(Lp,{onMenuClick:()=>e(!0)}),r.jsx("div",{className:"p-6 flex-1 bg-gray-50 overflow-y-auto",children:r.jsx(Sp,{})})]})]})},sT=({formData:n,errors:e,handleInputChange:t,isEditMode:s=!1})=>{const i=l=>{if(!l)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(l))return l;const c=new Date(l);return isNaN(c.getTime())?"":c.toISOString().split("T")[0]};return r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Job Information"}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enter the employee's job details"}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Designation *"}),r.jsx("input",{type:"text",value:n.jobInfo.designation,onChange:l=>t("jobInfo","designation",l.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.designation?"border-red-500":"border-gray-300"}`,placeholder:"e.g., Software Developer"}),e.designation&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.designation})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department *"}),r.jsxs("select",{value:n.jobInfo.department,onChange:l=>t("jobInfo","department",l.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.department?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select Department"}),r.jsx("option",{value:"Software Developer",children:"Software Developer"}),r.jsx("option",{value:"UI",children:"UI/UX Designer"}),r.jsx("option",{value:"HR",children:"Human Resources"}),r.jsx("option",{value:"Finance",children:"Finance"}),r.jsx("option",{value:"Marketing",children:"Marketing"}),r.jsx("option",{value:"Sales",children:"Sales"}),r.jsx("option",{value:"Operations",children:"Operations"})]}),e.department&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.department})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Joining *"}),r.jsx("input",{type:"date",value:i(n.jobInfo.dateOfJoining),onChange:l=>t("jobInfo","dateOfJoining",l.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.dateOfJoining?"border-red-500":"border-gray-300"}`,disabled:s}),e.dateOfJoining&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.dateOfJoining}),s&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Joining date cannot be changed"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment Type"}),r.jsxs("select",{value:n.jobInfo.employmentType||"full-time",onChange:l=>t("jobInfo","employmentType",l.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",children:[r.jsx("option",{value:"full-time",children:"Full Time"}),r.jsx("option",{value:"intern",children:"Intern"}),r.jsx("option",{value:"part-time",children:"Part Time"}),r.jsx("option",{value:"contract",children:"Contract"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Work Mode"}),r.jsxs("select",{value:n.jobInfo.workMode||"work-from-home",onChange:l=>t("jobInfo","workMode",l.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",children:[r.jsx("option",{value:"work-from-home",children:"Work From Home"}),r.jsx("option",{value:"work-from-office",children:"Work From Office"}),r.jsx("option",{value:"hybrid",children:"Hybrid"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shift Start Time"}),r.jsx("input",{type:"time",value:n.jobInfo.shiftTiming?.start||"",onChange:l=>{const c={...n.jobInfo.shiftTiming,start:l.target.value};t("jobInfo","shiftTiming",c)},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shift End Time"}),r.jsx("input",{type:"time",value:n.jobInfo.shiftTiming?.end||"",onChange:l=>{const c={...n.jobInfo.shiftTiming,end:l.target.value};t("jobInfo","shiftTiming",c)},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent"})]})]})]})},nT=({formData:n,errors:e,handlePasswordChange:t,handleRoleChange:s,isEditMode:i=!1})=>r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Account Credentials"}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:i?"Update employee's login credentials":"Set up login credentials for the employee"}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),r.jsx("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-300",children:r.jsx("span",{className:"text-gray-800",children:n.basicInfo.email})}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"This will be the username for login"})]}),!i&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Create Password *"}),r.jsx("input",{type:"password",value:n.password,onChange:t,className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.password?"border-red-500":"border-gray-300"}`,placeholder:"Enter secure password"}),e.password&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.password}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Minimum 6 characters required"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Role"}),r.jsxs("select",{value:n.role,onChange:s,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",children:[r.jsx("option",{value:"employee",children:"Employee"}),r.jsx("option",{value:"hr",children:"HR Manager"})]}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:n.role==="hr"?"HR managers can manage employees and leave requests":"Employees can view their profile and submit leave requests"})]}),!i&&r.jsxs("div",{className:"bg-[#104774]/10 p-4 rounded-lg border border-[#104774]/40",children:[r.jsx("h4",{className:"font-semibold text-[#104774] mb-2",children:"📧 Login Instructions"}),r.jsx("p",{className:"text-sm text-[#104774]",children:"The employee will receive an email with these credentials to access their account on their joining date."})]})]}),aT=({formData:n,handleDocumentUpload:e,removeDocument:t,isEditMode:s=!1,uploadProgress:i={},uploadingDocs:l={}})=>{const[c,u]=_.useState(!0),[h,m]=_.useState(""),[p,x]=_.useState([]),y=[{id:"aadhar",label:"Aadhar Card",required:!0},{id:"pan",label:"PAN Card",required:!0},{id:"tenth",label:"10th Marksheet",required:!0},{id:"twelfth",label:"12th Marksheet",required:!0},{id:"bank",label:"Bank Passbook",required:!0}],v=[{id:"provisional",label:"Provisional Certificate",required:!0},{id:"graduation",label:"Graduation Marksheet",required:!0}],w=S=>{u(S)},A=()=>{const S=(h||"").trim();if(!S)return alert("Enter a document name");const E=`custom_${Date.now()}`;x(C=>[...C,{id:E,label:S,required:!1}]),m("")},N=(S,E)=>{const C=n.basicInfo.documents||[];let R=C.find(O=>O.type===S);if(R)return R;const D=(E||"").toLowerCase().split(" ")[0];return R=C.find(O=>O.name&&O.name.toLowerCase().includes(D)||O.originalName&&O.originalName.toLowerCase().includes(D))||null,R};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Student Status"}),r.jsxs("div",{className:"flex space-x-4",children:[r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",checked:c,onChange:()=>w(!0),className:"form-radio text-[#104774]"}),r.jsx("span",{className:"ml-2",children:"Student"})]}),r.jsxs("label",{className:"inline-flex items-center",children:[r.jsx("input",{type:"radio",checked:!c,onChange:()=>w(!1),className:"form-radio text-[#104774]"}),r.jsx("span",{className:"ml-2",children:"Graduated"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Required Documents"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.map(S=>r.jsx(om,{doc:S,uploadedFile:N(S.id,S.label),handleDocumentUpload:e,removeDocument:t,isEditMode:s,uploadProgress:i[S.id]||0,isUploading:l[S.id]||!1},S.id)),!c&&v.map(S=>r.jsx(om,{doc:S,uploadedFile:N(S.id,S.label),handleDocumentUpload:e,removeDocument:t,isEditMode:s,uploadProgress:i[S.id]||0,isUploading:l[S.id]||!1},S.id)),p.map(S=>r.jsx(om,{doc:S,uploadedFile:N(S.id,S.label),handleDocumentUpload:e,removeDocument:t,isEditMode:s,uploadProgress:i[S.id]||0,isUploading:l[S.id]||!1},S.id))]}),r.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[r.jsx("input",{type:"text",value:h,onChange:S=>m(S.target.value),placeholder:"New document name (e.g. Driving Licence)",className:"w-[80%] p-2 border border-gray-300 rounded-lg"}),r.jsx("button",{type:"button",onClick:A,className:"px-4 py-2 bg-[#104774] text-white rounded-lg",children:"+ Add Document"})]})]})]})},om=({doc:n,uploadedFile:e,handleDocumentUpload:t,removeDocument:s,isEditMode:i=!1,uploadProgress:l=0,isUploading:c=!1})=>{const u=`document-${n.id}`,h=e&&(e.displayName||e.name)||n.label||"Document";return r.jsxs("div",{className:"border border-gray-300 rounded-lg p-4",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[n.label," ",n.required&&r.jsx("span",{className:"text-red-500",children:"*"})]}),e?r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-2 bg-gray-100 rounded-lg mr-2",children:r.jsx("i",{className:"far fa-file text-gray-600"})}),r.jsx("span",{className:"text-sm text-gray-700 truncate",children:h})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("a",{href:e.url,target:"_blank",rel:"noreferrer",className:"text-sm text-[#104774] underline",children:"View"}),r.jsx("button",{type:"button",onClick:()=>s(e),className:"text-red-500 hover:text-red-700 text-sm",children:"remove"})]})]}):r.jsxs("div",{children:[r.jsx("input",{type:"file",id:u,onChange:m=>t(m,n),className:"hidden",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",disabled:c}),r.jsx("label",{htmlFor:u,className:`cursor-pointer flex items-center justify-center p-3 border border-dashed border-gray-300 rounded-lg text-center transition-colors ${c?"opacity-50":"hover:border-[#104774]"}`,children:c?r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-8 h-8 border-2 border-[#104774] border-t-transparent rounded-full animate-spin mx-auto mb-2"}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Uploading... ",l,"%"]})]}):r.jsxs("div",{children:[r.jsx("i",{className:"far fa-cloud-upload text-gray-400 text-xl mb-1"}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Upload ",n.label]}),r.jsx("p",{className:"text-xs text-gray-400",children:"PDF, JPG, PNG (Max 5MB)"})]})})]})]})},iT=({formData:n,errors:e,handleInputChange:t,handleDocumentUpload:s,removeDocument:i,profileImage:l,handleProfileImageUpload:c,removeProfileImage:u,isEditMode:h=!1,uploadProgress:m,uploadingDocs:p})=>{const x=y=>{if(!y)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(y))return y;const v=new Date(y);return isNaN(v.getTime())?"":v.toISOString().split("T")[0]};return r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Basic Information"}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enter the employee's personal details"}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Profile Photo"}),r.jsxs("div",{className:"flex items-center space-x-4",children:[l?r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:l.url||l,alt:"Profile preview",className:"w-20 h-20 rounded-full object-cover border-2 border-gray-300"}),!h&&r.jsx("button",{type:"button",onClick:u,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 text-xs",children:"✕"})]}):r.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-200 flex items-center justify-center",children:r.jsx("span",{className:"text-gray-500 text-sm",children:"No image"})}),!h&&r.jsxs("div",{children:[r.jsx("input",{type:"file",accept:"image/*",onChange:c,className:"hidden",id:"profile-image-upload",disabled:p.profile}),r.jsx("label",{htmlFor:"profile-image-upload",className:`cursor-pointer text-white px-4 py-2 rounded-lg text-sm transition-colors ${p.profile?"bg-gray-400":"bg-[#104774] hover:bg-[#104774]"}`,children:p.profile?`Uploading... ${m.profile||0}%`:l?"Change Photo":"Upload Photo"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG (Max 5MB)"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),r.jsx("input",{type:"text",value:n.basicInfo.firstName,onChange:y=>t("basicInfo","firstName",y.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.firstName?"border-red-500":"border-gray-300"}`,placeholder:"Enter first name"}),e.firstName&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.firstName})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),r.jsx("input",{type:"text",value:n.basicInfo.lastName,onChange:y=>t("basicInfo","lastName",y.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Enter last name"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),r.jsx("input",{type:"email",value:n.basicInfo.email,onChange:y=>t("basicInfo","email",y.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.email?"border-red-500":"border-gray-300"}`,placeholder:"employee@company.com",disabled:h}),e.email&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.email}),h&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),r.jsx("input",{type:"tel",value:n.basicInfo.phone,onChange:y=>t("basicInfo","phone",y.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.phone?"border-red-500":"border-gray-300"}`,placeholder:"+91 1234567890"}),e.phone&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.phone})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth *"}),r.jsx("input",{type:"date",value:x(n.basicInfo.dob),max:new Date(new Date().setFullYear(new Date().getFullYear()-16)).toISOString().split("T")[0],onChange:y=>t("basicInfo","dob",y.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.dob?"border-red-500":"border-gray-300"}`}),e.dob&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.dob})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),r.jsxs("select",{value:n.basicInfo.gender,onChange:y=>t("basicInfo","gender",y.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",children:[r.jsx("option",{value:"male",children:"Male"}),r.jsx("option",{value:"female",children:"Female"}),r.jsx("option",{value:"other",children:"Other"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),r.jsx("textarea",{value:n.basicInfo.address||"",onChange:y=>t("basicInfo","address",y.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Enter complete address",rows:"3"})]}),r.jsx(aT,{formData:n,handleDocumentUpload:s,removeDocument:i,isEditMode:h,uploadProgress:m,uploadingDocs:p})]})},rT=({formData:n,errors:e,handleInputChange:t,handleAddAllowance:s,handleRemoveAllowance:i,handleAddDeduction:l,handleRemoveDeduction:c,isEditMode:u=!1})=>{const h=parseFloat(n.payrollInfo.basic)||0,m=parseFloat(n.payrollInfo.hra)||0,p=parseFloat(n.payrollInfo.tax)||0,x=Math.round(h*p/100*100)/100,y=n.payrollInfo.allowances.reduce((N,S)=>N+(parseFloat(S.amount)||0),0),v=n.payrollInfo.deductions.reduce((N,S)=>N+(parseFloat(S.amount)||0),0)+x,w=h+m+y,A=w-v;return r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Payroll Information"}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Set up the employee's salary structure"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Basic Salary *"}),r.jsx("input",{type:"number",value:n.payrollInfo.basic,onChange:N=>t("payrollInfo","basic",N.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.basic?"border-red-500":"border-gray-300"}`,placeholder:"0.00",min:"0"}),e.basic&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.basic})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HRA"}),r.jsx("input",{type:"number",value:n.payrollInfo.hra,onChange:N=>t("payrollInfo","hra",N.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"0.00",min:"0"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax (%)"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:n.payrollInfo.tax,onChange:N=>t("payrollInfo","tax",N.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Tax percentage e.g. 2"})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Allowances"}),r.jsx("button",{type:"button",onClick:s,className:"text-sm text-[#104774] hover:text-[#104774] font-medium",children:"+ Add Allowance"})]}),n.payrollInfo.allowances.map((N,S)=>r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-2",children:[r.jsx("input",{type:"text",value:N.title,onChange:E=>{const C=[...n.payrollInfo.allowances];C[S].title=E.target.value,t("payrollInfo","allowances",C)},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Allowance title"}),r.jsx("input",{type:"number",value:N.amount,onChange:E=>{const C=[...n.payrollInfo.allowances];C[S].amount=E.target.value,t("payrollInfo","allowances",C)},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Amount",min:"0"}),r.jsx("button",{type:"button",onClick:()=>i(S),className:"px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200",children:"Remove"})]},S))]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Deductions"}),r.jsx("button",{type:"button",onClick:l,className:"text-sm text-[#104774] hover:text-[#104774] font-medium",children:"+ Add Deduction"})]}),n.payrollInfo.deductions.map((N,S)=>r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-2",children:[r.jsx("input",{type:"text",value:N.title,onChange:E=>{const C=[...n.payrollInfo.deductions];C[S].title=E.target.value,t("payrollInfo","deductions",C)},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Deduction title"}),r.jsx("input",{type:"number",value:N.amount,onChange:E=>{const C=[...n.payrollInfo.deductions];C[S].amount=E.target.value,t("payrollInfo","deductions",C)},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent",placeholder:"Amount",min:"0"}),r.jsx("button",{type:"button",onClick:()=>c(S),className:"px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200",children:"Remove"})]},S))]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payroll Month *"}),r.jsx("input",{type:"month",value:n.payrollInfo.month,onChange:N=>t("payrollInfo","month",N.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#104774] focus:border-transparent ${e.month?"border-red-500":"border-gray-300"}`}),e.month&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:e.month})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mt-4",children:[r.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Salary Summary"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Basic Salary:"}),r.jsxs("span",{className:"font-medium",children:["₹",h.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"HRA:"}),r.jsxs("span",{className:"font-medium",children:["₹",m.toLocaleString()]})]}),n.payrollInfo.allowances.map((N,S)=>r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-gray-600",children:[N.title||"Allowance",":"]}),r.jsxs("span",{className:"font-medium",children:["₹",(parseFloat(N.amount)||0).toLocaleString()]})]},S)),r.jsxs("div",{className:"flex justify-between border-t border-gray-200 pt-2",children:[r.jsx("span",{className:"text-gray-600",children:"Total Earnings:"}),r.jsxs("span",{className:"font-medium text-green-600",children:["₹",w.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-gray-600",children:["Tax Deduction (",p,"%):"]}),r.jsxs("span",{className:"font-medium text-red-600",children:["-₹",x.toLocaleString()]})]}),n.payrollInfo.deductions.map((N,S)=>r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{className:"text-gray-600",children:[N.title||"Deduction",":"]}),r.jsxs("span",{className:"font-medium text-red-600",children:["-₹",(parseFloat(N.amount)||0).toLocaleString()]})]},S)),r.jsxs("div",{className:"flex justify-between border-t border-gray-200 pt-2",children:[r.jsx("span",{className:"text-gray-800 font-semibold",children:"Net Pay:"}),r.jsxs("span",{className:"font-bold text-[#104774]",children:["₹",A.toLocaleString()]})]})]})]})]})},lT=({onClose:n,employee:e,isEditMode:t=!1})=>{const[s,i]=_.useState(1),[l,c]=_.useState({basicInfo:{firstName:"",lastName:"",email:"",phone:"",dob:"",gender:"other",address:"",documents:[],profileImage:null},jobInfo:{designation:"",department:"",dateOfJoining:"",employmentType:"full-time",workMode:"work-from-home",shiftTiming:{start:"",end:""}},payrollInfo:{basic:"",hra:"",tax:"",allowances:[],deductions:[],month:new Date().toISOString().slice(0,7),status:"draft"},password:"",role:"employee"}),[u,h]=_.useState({}),[m,p]=_.useState(!1),[x,y]=_.useState(null),[v,w]=_.useState({}),[A,N]=_.useState({});_.useEffect(()=>{if(t&&e){const I=(e.documents||[]).map(T=>({type:T.type||T.docType||null,name:T.name||T.originalName||T.filename||T.fileName||T._id||"",originalName:T.originalName||T.name||null,url:T.url||T.path||T.secure_url||T.link||"",fileType:T.fileType||T.type||null,uploadedAt:T.uploadedAt||T.createdAt||null,raw:T}));c(T=>({...T,basicInfo:{firstName:e.firstName||"",lastName:e.lastName||"",email:e.user?.email||"",phone:e.phone||"",dob:e.dob||"",gender:e.gender||"other",address:e.address||"",documents:I||[],profileImage:e.avatarUrl?{url:e.avatarUrl}:null},jobInfo:{designation:e.designation||"",department:e.department||"",dateOfJoining:e.dateOfJoining||"",employmentType:e.employmentType||"full-time",workMode:e.workMode||"work-from-home",shiftTiming:e.shiftTiming||{start:"",end:""}},role:e.user?.role||"employee",payrollInfo:{...T.payrollInfo,basic:e.payrollInfo?.basic??T.payrollInfo.basic,hra:e.payrollInfo?.hra??T.payrollInfo.hra,tax:e.payrollInfo?.tax??T.payrollInfo.tax,allowances:e.payrollInfo?.allowances||T.payrollInfo.allowances,deductions:e.payrollInfo?.deductions||T.payrollInfo.deductions,month:e.payrollInfo?.month||T.payrollInfo.month,status:e.payrollInfo?.status||T.payrollInfo.status}})),e.avatarUrl&&y({url:e.avatarUrl})}},[t,e]);const S=async I=>{try{const T=new FormData;return I.forEach(M=>T.append("documents",M.file)),I.forEach(M=>T.append("types[]",M.type||"")),I.forEach(M=>T.append("originalNames[]",M.name||M.file.name)),(await xe.post("/upload-files/upload",T,{onUploadProgress:M=>{if(M.total){const G=Math.round(M.loaded*100/M.total);console.log("overall upload:",G,"%")}}})).data.files.map((M,G)=>({type:M.type||I[G]?.type||null,originalName:M.originalName||M.name||I[G]?.name,url:M.url||M.secure_url||M.path||"",raw:M}))}catch(T){throw console.error("File upload error (frontend):",T),T.response?(console.error("Server response:",T.response.status,T.response.data),T.response.status===413?new Error("File too large: Maximum size is 5MB"):new Error(T.response.data?.message||"Server error while uploading files")):T.request?new Error("Network error: Please check your connection"):new Error(T.message||"Failed to upload files")}},E=I=>{const T={};if(I===1){l.basicInfo.firstName.trim()||(T.firstName="First name is required"),l.basicInfo.email.trim()?/\S+@\S+\.\S+/.test(l.basicInfo.email)||(T.email="Invalid email format"):T.email="Email is required",l.basicInfo.phone.trim()||(T.phone="Phone number is required"),l.basicInfo.dob||(T.dob="Date of birth is required");const V=["aadhar","pan","tenth","twelfth","bank"],M=(l.basicInfo.documents||[]).map(de=>de.type);V.filter(de=>!M.includes(de)).length>0&&!t&&(T.documents="Please upload all required documents")}return I===2&&(l.jobInfo.designation.trim()||(T.designation="Designation is required"),l.jobInfo.department.trim()||(T.department="Department is required"),l.jobInfo.dateOfJoining||(T.dateOfJoining="Date of joining is required")),I===3&&((!l.payrollInfo.basic||l.payrollInfo.basic<=0)&&(T.basic="Valid basic salary is required"),l.payrollInfo.month||(T.month="Payroll month is required")),I===4&&!t&&(l.password.trim()?l.password.length<6&&(T.password="Password must be at least 6 characters"):T.password="Password is required"),h(T),Object.keys(T).length===0},C=()=>{E(s)&&i(I=>I+1)},R=()=>i(I=>Math.max(1,I-1)),D=(I,T,V)=>{c(M=>({...M,[I]:{...M[I],[T]:V}})),u[T]&&h(M=>({...M,[T]:""}))},O=I=>{const T=I.target.value;c(V=>({...V,password:T})),u.password&&h(V=>({...V,password:""}))},H=I=>{const T=I.target.value;c(V=>({...V,role:T}))},F=async(I,T)=>{const V=I.target.files?.[0];if(!V)return;const M=typeof T=="string"?T:T.id,G=typeof T=="object"?T.label:null;if(V.size>5*1024*1024){alert("File size must be less than 5MB"),I.target.value="";return}if(!["image/jpeg","image/png","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(V.type)){alert("Only JPEG, PNG, PDF, DOC, and DOCX files are allowed"),I.target.value="";return}N(re=>({...re,[M]:!0})),w(re=>({...re,[M]:0}));try{const re=new FormData;re.append("document",V);const ye=await xe.post("/upload-files/upload",re,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:je=>{if(je.total){const Le=Math.round(je.loaded*100/je.total);w(he=>({...he,[M]:Le}))}}});if(ye.data?.success&&ye.data?.file){const je=ye.data.file,Le={type:M,name:G||je.originalName||V.name,originalName:je.originalName||V.name,url:je.url,fileType:je.type};c(he=>{const $e=(he.basicInfo.documents||[]).filter(ge=>ge.type!==M);return{...he,basicInfo:{...he.basicInfo,documents:[...$e,Le]}}})}else throw new Error("Invalid upload response")}catch(re){console.error("Document upload failed:",re),alert(re.response?.data?.message||re.message||"Upload failed")}finally{N(re=>({...re,[M]:!1})),w(re=>({...re,[M]:0})),I.target.value=""}},P=I=>{const T=typeof I=="string"?I:I&&(I.type||I.url||I.originalName||I.name);if(!window.confirm("Are you sure you want to remove this document?"))return;const V=(l.basicInfo.documents||[]).filter(M=>{if(!T)return!0;const G=M.type&&T&&M.type===T,de=M.url&&T&&M.url===T,re=M.originalName&&T&&M.originalName===T,ye=M.name&&T&&M.name===T;return!(G||de||re||ye)});c(M=>({...M,basicInfo:{...M.basicInfo,documents:V}}))},Z=async I=>{const T=I.target.files[0];if(T){if(T.size>5*1024*1024){alert("Profile image must be less than 5MB");return}if(!T.type.startsWith("image/")){alert("Please select an image file");return}N(V=>({...V,profile:!0})),w(V=>({...V,profile:0}));try{const V=new FormData;V.append("document",T);const M=await xe.post("/upload-files/upload",V,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:G=>{if(G.total){const de=Math.round(G.loaded*100/G.total);w(re=>({...re,profile:de}))}}});if(M.data.success){const G=M.data.file,de={name:G.originalName,url:G.url,fileType:G.type};y(de),c(re=>({...re,basicInfo:{...re.basicInfo,profileImage:{url:G.url}}}))}}catch(V){console.error("Profile image upload error:",V),alert("Profile image upload failed. Please try again.")}finally{N(V=>({...V,profile:!1})),w(V=>({...V,profile:0})),I.target.value=""}}},z=()=>{y(null),c(I=>({...I,basicInfo:{...I.basicInfo,profileImage:null}}))},K=()=>{c(I=>({...I,payrollInfo:{...I.payrollInfo,allowances:[...I.payrollInfo.allowances,{title:"",amount:0}]}}))},W=I=>{c(T=>({...T,payrollInfo:{...T.payrollInfo,allowances:T.payrollInfo.allowances.filter((V,M)=>M!==I)}}))},ce=()=>{c(I=>({...I,payrollInfo:{...I.payrollInfo,deductions:[...I.payrollInfo.deductions,{title:"",amount:0}]}}))},me=I=>{c(T=>({...T,payrollInfo:{...T.payrollInfo,deductions:T.payrollInfo.deductions.filter((V,M)=>M!==I)}}))},L=async()=>{if(E(4)){p(!0);try{let I=null;if(x&&x.file){const re=new FormData;re.append("document",x.file);const ye=await xe.post("/upload-files/upload",re,{headers:{"Content-Type":"multipart/form-data"}});ye.data.file&&(I=ye.data.file)}let T=[];const V=(l.basicInfo.documents||[]).filter(re=>!re.url&&re.file);V.length>0&&(T=await S(V));const M=(l.basicInfo.documents||[]).map(re=>{const ye=T.find(je=>je.type===re.type||je.originalName===re.originalName);return ye?{type:ye.type,name:re.name||ye.originalName,url:ye.url}:{type:re.type,name:re.name||re.originalName||re.name,url:re.url}}),G={basicInfo:{...l.basicInfo,profileImage:I?{url:I.url}:l.basicInfo.profileImage,documents:M},jobInfo:l.jobInfo,payrollInfo:l.payrollInfo,password:l.password,role:l.role},de=await xe.post("/employee/add",G);alert("Employee added successfully!"),n()}catch(I){console.error("Error adding employee:",I),alert(I.response?.data?.message||"Error adding employee")}finally{p(!1)}}},q=async()=>{if(E(4)){p(!0);try{let I=null;if(x&&x.file){const re=new FormData;re.append("document",x.file);const ye=await xe.post("/upload-files/upload",re,{headers:{"Content-Type":"multipart/form-data"}});ye.data.file&&(I=ye.data.file)}let T=[];const V=(l.basicInfo.documents||[]).filter(re=>!re.url&&re.file);V.length>0&&(T=await S(V));const M=(l.basicInfo.documents||[]).map(re=>{const ye=T.find(je=>je.type===re.type||je.originalName===re.originalName);return ye?{type:ye.type,name:re.name||ye.originalName,url:ye.url}:{type:re.type,name:re.name||re.originalName||re.name,url:re.url}}),G={basicInfo:{...l.basicInfo,profileImage:I?{url:I.url}:l.basicInfo.profileImage,documents:M},jobInfo:l.jobInfo,payrollInfo:l.payrollInfo},de=await xe.put(`/employee/update/${e._id}`,G);alert("Employee updated successfully!"),n()}catch(I){console.error("Error updating employee:",I),alert(I.response?.data?.message||"Error updating employee")}finally{p(!1)}}},$=s/4*100;return r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto mx-auto my-8 relative",children:[r.jsx("button",{onClick:n,className:"absolute top-4 right-4 z-10 bg-gray-200 hover:bg-gray-300 rounded-full p-2",children:"✕"}),r.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl",children:[r.jsx("div",{className:"flex justify-between items-center mb-4",children:r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:t?"Edit Employee":"Add New Employee"})}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:r.jsx("div",{className:"bg-[#104774] h-2 rounded-full transition-all duration-300",style:{width:`${$}%`}})}),r.jsx("div",{className:"flex justify-between mb-2",children:["Basic Info","Job Details","Payroll","Credentials"].map((I,T)=>r.jsx("div",{className:`text-xs font-medium ${s>T+1?"text-green-600":s===T+1?"text-[#104774]":"text-gray-500"}`,children:I},I))})]}),r.jsxs("div",{className:"p-6",children:[s===1&&r.jsx(iT,{formData:l,errors:u,handleInputChange:D,handleDocumentUpload:F,removeDocument:P,profileImage:x,handleProfileImageUpload:Z,removeProfileImage:z,isEditMode:t,uploadProgress:v,uploadingDocs:A}),s===2&&r.jsx(sT,{formData:l,errors:u,handleInputChange:D,isEditMode:t}),s===3&&r.jsx(rT,{formData:l,errors:u,handleInputChange:D,handleAddAllowance:K,handleRemoveAllowance:W,handleAddDeduction:ce,handleRemoveDeduction:me,isEditMode:t}),s===4&&r.jsx(nT,{formData:l,errors:u,handlePasswordChange:O,handleRoleChange:H,isEditMode:t})]}),r.jsx("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 p-6 rounded-b-xl",children:r.jsxs("div",{className:"flex justify-between",children:[s>1?r.jsx("button",{onClick:R,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",disabled:m,children:"← Back"}):r.jsx("div",{}),s<4?r.jsx("button",{onClick:C,className:"px-6 py-3 bg-[#104774] text-white rounded-lg hover:bg-[#104774] transition-colors",children:"Next →"}):r.jsx("button",{onClick:t?q:L,disabled:m,className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-400 transition-colors",children:m?r.jsxs("span",{className:"flex items-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),t?"Updating...":"Creating..."]}):t?"Update Employee":"Create Employee"})]})})]})},Ns=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Xm=[.001,0,0,.001,0,0],cm=1.35,Zs={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ga={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},h1="pdfjs_internal_editor_",qe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},at={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},oT={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},xs={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Rd={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Yt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Br={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},yu={ERRORS:0,WARNINGS:1,INFOS:5},$d={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},ud={moveTo:0,lineTo:1,curveTo:2,closePath:3},cT={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let bu=yu.WARNINGS;function dT(n){Number.isInteger(n)&&(bu=n)}function uT(){return bu}function vu(n){bu>=yu.INFOS&&console.log(`Info: ${n}`)}function Ve(n){bu>=yu.WARNINGS&&console.log(`Warning: ${n}`)}function yt(n){throw new Error(n)}function Xt(n,e){n||yt(e)}function hT(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function f1(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"&&(t.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),t.tryConvertEncoding))try{n=xT(n)}catch{}const s=e?URL.parse(n,e):URL.parse(n);return hT(s)?s:null}function m1(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&f1(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function st(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const $i=(function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e})();class zb extends $i{constructor(e,t){super(e,"PasswordException"),this.code=t}}class dm extends $i{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Qm extends $i{constructor(e){super(e,"InvalidPDFException")}}class Gd extends $i{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class fT extends $i{constructor(e){super(e,"FormatError")}}class Ka extends $i{constructor(e){super(e,"AbortException")}}function p1(n){(typeof n!="object"||n?.length===void 0)&&yt("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const l=Math.min(i+t,e),c=n.subarray(i,l);s.push(String.fromCharCode.apply(null,c))}return s.join("")}function Vo(n){typeof n!="string"&&yt("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function mT(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function pT(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function gT(){try{return new Function(""),!0}catch{return!1}}class fs{static get isLittleEndian(){return st(this,"isLittleEndian",pT())}static get isEvalSupported(){return st(this,"isEvalSupported",gT())}static get isOffscreenCanvasSupported(){return st(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return st(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return st(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return st(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const um=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class Me{static makeHexColor(e,t,s){return`#${um[e]}${um[t]}${um[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,s=0){const i=e[s],l=e[s+1];e[s]=i*t[0]+l*t[2]+t[4],e[s+1]=i*t[1]+l*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const i=t[0],l=t[1],c=t[2],u=t[3],h=t[4],m=t[5];for(let p=0;p<6;p+=2){const x=e[s+p],y=e[s+p+1];e[s+p]=x*i+y*c+h,e[s+p+1]=x*l+y*u+m}}static applyInverseTransform(e,t){const s=e[0],i=e[1],l=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/l,e[1]=(-s*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/l}static axialAlignedBoundingBox(e,t,s){const i=t[0],l=t[1],c=t[2],u=t[3],h=t[4],m=t[5],p=e[0],x=e[1],y=e[2],v=e[3];let w=i*p+h,A=w,N=i*y+h,S=N,E=u*x+m,C=E,R=u*v+m,D=R;if(l!==0||c!==0){const O=l*p,H=l*y,F=c*x,P=c*v;w+=F,S+=F,N+=P,A+=P,E+=O,D+=O,R+=H,C+=H}s[0]=Math.min(s[0],w,N,A,S),s[1]=Math.min(s[1],E,R,C,D),s[2]=Math.max(s[2],w,N,A,S),s[3]=Math.max(s[3],E,R,C,D)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],i=e[1],l=e[2],c=e[3],u=s**2+i**2,h=s*l+i*c,m=l**2+c**2,p=(u+m)/2,x=Math.sqrt(p**2-(u*m-h**2));t[0]=Math.sqrt(p+x||1),t[1]=Math.sqrt(p-x||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const l=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),c=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return l>c?null:[s,l,i,c]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,i,l){l[0]=Math.min(l[0],e,s),l[1]=Math.min(l[1],t,i),l[2]=Math.max(l[2],e,s),l[3]=Math.max(l[3],t,i)}static#e(e,t,s,i,l,c,u,h,m,p){if(m<=0||m>=1)return;const x=1-m,y=m*m,v=y*m,w=x*(x*(x*e+3*m*t)+3*y*s)+v*i,A=x*(x*(x*l+3*m*c)+3*y*u)+v*h;p[0]=Math.min(p[0],w),p[1]=Math.min(p[1],A),p[2]=Math.max(p[2],w),p[3]=Math.max(p[3],A)}static#t(e,t,s,i,l,c,u,h,m,p,x,y){if(Math.abs(m)<1e-12){Math.abs(p)>=1e-12&&this.#e(e,t,s,i,l,c,u,h,-x/p,y);return}const v=p**2-4*x*m;if(v<0)return;const w=Math.sqrt(v),A=2*m;this.#e(e,t,s,i,l,c,u,h,(-p+w)/A,y),this.#e(e,t,s,i,l,c,u,h,(-p-w)/A,y)}static bezierBoundingBox(e,t,s,i,l,c,u,h,m){m[0]=Math.min(m[0],e,u),m[1]=Math.min(m[1],t,h),m[2]=Math.max(m[2],e,u),m[3]=Math.max(m[3],t,h),this.#t(e,s,l,u,t,i,c,h,3*(-e+3*(s-l)+u),6*(e-2*s+l),3*(s-e),m),this.#t(e,s,l,u,t,i,c,h,3*(-t+3*(i-c)+h),6*(t-2*i+c),3*(i-t),m)}}function xT(n){return decodeURIComponent(escape(n))}let hm=null,Fb=null;function yT(n){return hm||(hm=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Fb=new Map([["ﬅ","ſt"]])),n.replaceAll(hm,(e,t,s)=>t?t.normalize("NFKC"):Fb.get(s))}function g1(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),p1(n)}const Op="pdfjs_internal_id_";function bT(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,i,...l]=t;if(!n(s)&&!Number.isInteger(s)||!e(i))return!1;const c=l.length;let u=!0;switch(i.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const h of l)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function Ss(n,e,t){return Math.min(Math.max(n,e),t)}function x1(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(p1(n))}function vT(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):Vo(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const ha="http://www.w3.org/2000/svg";class Kr{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function $o(n,e="text"){if(po(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class Go{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:l=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=l,this.offsetY=c,s*=t;const h=(e[2]+e[0])/2,m=(e[3]+e[1])/2;let p,x,y,v;switch(i%=360,i<0&&(i+=360),i){case 180:p=-1,x=0,y=0,v=1;break;case 90:p=0,x=1,y=1,v=0;break;case 270:p=0,x=-1,y=-1,v=0;break;case 0:p=1,x=0,y=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(y=-y,v=-v);let w,A,N,S;p===0?(w=Math.abs(m-e[1])*s+l,A=Math.abs(h-e[0])*s+c,N=(e[3]-e[1])*s,S=(e[2]-e[0])*s):(w=Math.abs(h-e[0])*s+l,A=Math.abs(m-e[1])*s+c,N=(e[2]-e[0])*s,S=(e[3]-e[1])*s),this.transform=[p*s,x*s,y*s,v*s,w-p*s*h-y*s*m,A-x*s*h-v*s*m],this.width=N,this.height=S}get rawDims(){const e=this.viewBox;return st(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:l=!1}={}){return new Go({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:l})}convertToViewportPoint(e,t){const s=[e,t];return Me.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];Me.applyTransform(t,this.transform);const s=[e[2],e[3]];return Me.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return Me.applyInverseTransform(s,this.transform),s}}class Pp extends $i{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function wu(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function Ip(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function wT(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function AT(n,e="document.pdf"){if(typeof n!="string")return e;if(wu(n))return Ve('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(n);if(!s)return e;const i=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},l=/\.pdf$/i,c=s.pathname.split("/").at(-1);if(l.test(c))return i(c);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const m of u)if(l.test(m))return i(m);const h=Array.from(s.searchParams.keys()).reverse();for(const m of h)if(l.test(m))return i(m)}if(s.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(h)return i(h[0])}return e}class Ub{started=Object.create(null);times=[];time(e){e in this.started&&Ve(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ve(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:l}of this.times)e.push(`${s.padEnd(t)} ${l-i}ms
`);return e.join("")}}function po(n,e){const t=e?URL.parse(n,e):URL.parse(n);return t?.protocol==="http:"||t?.protocol==="https:"}function _n(n){n.preventDefault()}function Wt(n){n.preventDefault(),n.stopPropagation()}function NT(n){console.log("Deprecated API usage: "+n)}class y1{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let l=parseInt(t[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(t[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(t[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const m=t[7]||"Z";let p=parseInt(t[8],10);p=p>=0&&p<=23?p:0;let x=parseInt(t[9],10)||0;return x=x>=0&&x<=59?x:0,m==="-"?(c+=p,u+=x):m==="+"&&(c-=p,u-=x),new Date(Date.UTC(s,i,l,c,u,h))}}function ST(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,l=[0,0,parseInt(s),parseInt(i)];return new Go({viewBox:l,userUnit:1,scale:e,rotation:t})}function Bp(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ve(`Not a valid color format: "${n}"`),[0,0,0])}function jT(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,Bp(s))}e.remove()}function Mt(n){const{a:e,b:t,c:s,d:i,e:l,f:c}=n.getTransform();return[e,t,s,i,l,c]}function Un(n){const{a:e,b:t,c:s,d:i,e:l,f:c}=n.getTransform().invertSelf();return[e,t,s,i,l,c]}function Fi(n,e,t=!1,s=!0){if(e instanceof Go){const{pageWidth:i,pageHeight:l}=e.rawDims,{style:c}=n,u=fs.isCSSRoundSupported,h=`var(--total-scale-factor) * ${i}px`,m=`var(--total-scale-factor) * ${l}px`,p=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,x=u?`round(down, ${m}, var(--scale-round-y))`:`calc(${m})`;!t||e.rotation%180===0?(c.width=p,c.height=x):(c.width=x,c.height=p)}s&&n.setAttribute("data-main-rotation",e.rotation)}class Wn{constructor(){const{pixelRatio:e}=Wn;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,i,l=-1){let c=1/0,u=1/0,h=1/0;s=Wn.capPixels(s,l),s>0&&(c=Math.sqrt(s/(e*t))),i!==-1&&(u=i/e,h=i/t);const m=Math.min(c,u,h);return this.sx>m||this.sy>m?(this.sx=m,this.sy=m,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const Zm=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class vo{#e=null;#t=null;#s;#n=null;#i=null;#a=null;static#l=null;constructor(e){this.#s=e,vo.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#s._uiManager._signal;e.addEventListener("contextmenu",_n,{signal:t}),e.addEventListener("pointerdown",vo.#r,{signal:t});const s=this.#n=document.createElement("div");s.className="buttons",e.append(s);const i=this.#s.toolbarPosition;if(i){const{style:l}=e,c=this.#s._uiManager.direction==="ltr"?1-i[0]:i[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#r(e){e.stopPropagation()}#u(e){this.#s._focusEventsAllowed=!1,Wt(e)}#o(e){this.#s._focusEventsAllowed=!0,Wt(e)}#h(e){const t=this.#s._uiManager._signal;e.addEventListener("focusin",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#o.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",_n,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#i?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#s,s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",vo.#l[e]),this.#h(s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),this.#n.append(s)}get#d(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#h(t),this.#n.append(t,this.#d),this.#i=e}addColorPicker(e){this.#t=e;const t=e.renderButton();this.#h(t),this.#n.append(t,this.#d)}async addEditSignatureButton(e){const t=this.#a=await e.renderEditButton(this.#s);this.#h(t),this.#n.append(t,this.#d)}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break}}updateEditSignatureButton(e){this.#a&&(this.#a.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class ET{#e=null;#t=null;#s;constructor(e){this.#s=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",_n,{signal:this.#s._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#a(),e}#i(e,t){let s=0,i=0;for(const l of e){const c=l.y+l.height;if(c<s)continue;const u=l.x+(t?l.width:0);if(c>s){i=u,s=c;continue}t?u>i&&(i=u):u<i&&(i=u)}return[t?1-i:i,s]}show(e,t,s){const[i,l]=this.#i(t,s),{style:c}=this.#t||=this.#n();e.append(this.#t),c.insetInlineEnd=`${100*i}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#a(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=this.#s._signal;e.addEventListener("contextmenu",_n,{signal:s}),e.addEventListener("click",()=>{this.#s.highlightSelection("floating_button")},{signal:s}),this.#e.append(e)}}function b1(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}class _T{#e=0;get id(){return`${h1}${this.#e++}`}}class Hp{#e=g1();#t=0;#s=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const l=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return st(this,"_isSVGFittingCanvas",l)}async#n(e,t){this.#s||=new Map;let s=this.#s.get(e);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let i;if(typeof t=="string"?(s.url=t,i=await $o(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const l=Hp._isSVGFittingCanvas,c=new FileReader,u=new Image,h=new Promise((m,p)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,m()},c.onload=async()=>{const x=s.svgUrl=c.result;u.src=await l?`${x}#svgView(preserveAspectRatio(none))`:x},u.onerror=c.onerror=p});c.readAsDataURL(i),await h}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){Ve(i),s=null}return this.#s.set(e,s),s&&this.#s.set(s.id,s),s}async getFromFile(e){const{lastModified:t,name:s,size:i,type:l}=e;return this.#n(`${t}_${s}_${i}_${l}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const s=await t;return this.#n(e,s)}async getFromId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#s||=new Map;let s=this.#s.get(e);if(s?.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#s.set(e,s),this.#s.set(s.id,s),s}getSvgUrl(e){const t=this.#s.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(s.width,s.height);i.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=i.convertToBlob()}s.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class CT{#e=[];#t=!1;#s;#n=-1;constructor(e=128){this.#s=e}add({cmd:e,undo:t,post:s,mustExec:i,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(i&&e(),this.#t)return;const h={cmd:e,undo:t,post:s,type:l};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(h);return}if(c&&this.#e[this.#n].type===l){u&&(h.undo=this.#e[this.#n].undo),this.#e[this.#n]=h;return}const m=this.#n+1;m===this.#s?this.#e.splice(0,1):(this.#n=m,m<this.#e.length&&this.#e.splice(m)),this.#e.push(h)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class Yo{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=fs.platform;for(const[s,i,l={}]of e)for(const c of s){const u=c.startsWith("mac+");t&&u?(this.callbacks.set(c.slice(4),{callback:i,options:l}),this.allKeys.add(c.split("+").at(-1))):!t&&!u&&(this.callbacks.set(c,{callback:i,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(this.#e(t));if(!s)return;const{callback:i,options:{bubbles:l=!1,args:c=[],checker:u=null}}=s;u&&!u(e,t)||(i.bind(e,...c,t)(),l||Wt(t))}}class zp{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return jT(e),st(this,"_colors",e)}convert(e){const t=Bp(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((l,c)=>l===t[c]))return zp._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?Me.makeHexColor(...t):e}}class Ja{#e=new AbortController;#t=null;#s=new Map;#n=new Map;#i=null;#a=null;#l=null;#r=new CT;#u=null;#o=null;#h=0;#d=new Set;#f=null;#m=null;#p=new Set;_editorUndoBar=null;#c=!1;#g=!1;#x=!1;#y=null;#v=null;#w=null;#A=null;#j=!1;#_=null;#T=new _T;#N=!1;#C=!1;#E=null;#R=null;#k=null;#M=null;#z=null;#S=qe.NONE;#b=new Set;#I=null;#B=null;#q=null;#V=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#F=[0,0];#L=null;#O=null;#U=null;#X=null;#P=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=Ja.prototype,t=c=>c.#O.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),s=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return st(this,"_keyboardManager",new Yo([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#O.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#O.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-l,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[l,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-l],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,l],checker:t}]]))}constructor(e,t,s,i,l,c,u,h,m,p,x,y,v,w,A){const N=this._signal=this.#e.signal;this.#O=e,this.#U=t,this.#X=s,this.#i=i,this.#B=l,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:N}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:N}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:N}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:N}),c._on("setpreference",this.onSetPreference.bind(this),{signal:N}),c._on("switchannotationeditorparams",S=>this.updateParams(S.type,S.value),{signal:N}),this.#ae(),this.#oe(),this.#Z(),this.#a=u.annotationStorage,this.#y=u.filterFactory,this.#q=h,this.#A=m||null,this.#c=p,this.#g=x,this.#x=y,this.#z=v||null,this.viewParameters={realScale:Kr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=w||null,this._supportsPinchToZoom=A!==!1}destroy(){this.#P?.resolve(),this.#P=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#n.values())e.destroy();this.#n.clear(),this.#s.clear(),this.#p.clear(),this.#M?.clear(),this.#t=null,this.#b.clear(),this.#r.destroy(),this.#i?.destroy(),this.#B?.destroy(),this.#_?.hide(),this.#_=null,this.#k?.destroy(),this.#k=null,this.#v&&(clearTimeout(this.#v),this.#v=null),this.#L&&(clearTimeout(this.#L),this.#L=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#z}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#x}get hcmFilter(){return st(this,"hcmFilter",this.#q?this.#y.addHCMFilter(this.#q.foreground,this.#q.background):"none")}get direction(){return st(this,"direction",getComputedStyle(this.#O).direction)}get highlightColors(){return st(this,"highlightColors",this.#A?new Map(this.#A.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColorNames(){return st(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#o=e}setMainHighlightColorPicker(e){this.#k=e}editAltText(e,t=!1){this.#i?.editAltText(this,e,t)}getSignature(e){this.#B?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#B}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#x=t;break}}onPageChanging({pageNumber:e}){this.#h=e-1}focusMainContainer(){this.#O.focus()}findParent(e,t){for(const s of this.#n.values()){const{x:i,y:l,width:c,height:u}=s.div.getBoundingClientRect();if(e>=i&&e<=i+c&&t>=l&&t<=l+u)return s}return null}disableUserSelect(e=!1){this.#U.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Kr.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#o?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#Y({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#Q(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of this.#n.values())if(s.hasTextLayer(e))return s;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:l,focusOffset:c}=t,u=t.toString(),m=this.#Y(t).closest(".textLayer"),p=this.getSelectionBoxes(m);if(!p)return;t.empty();const x=this.#Q(m),y=this.#S===qe.NONE,v=()=>{x?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:p,anchorNode:s,anchorOffset:i,focusNode:l,focusOffset:c,text:u}),y&&this.showAllEditors("highlight",!0,!0)};if(y){this.switchToMode(qe.HIGHLIGHT,v);return}v()}#se(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=this.#Y(e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(this.#_||=new ET(this),this.#_.show(s,i,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#a&&!this.#a.has(e.id)&&this.#a.setValue(e.id,e)}a11yAlert(e,t=null){const s=this.#X;s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}#ne(){const e=document.getSelection();if(!e||e.isCollapsed){this.#I&&(this.#_?.hide(),this.#I=null,this.#D({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#I)return;const i=this.#Y(e).closest(".textLayer");if(!i){this.#I&&(this.#_?.hide(),this.#I=null,this.#D({hasSelectedText:!1}));return}if(this.#_?.hide(),this.#I=t,this.#D({hasSelectedText:!0}),!(this.#S!==qe.HIGHLIGHT&&this.#S!==qe.NONE)&&(this.#S===qe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#j=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#S===qe.HIGHLIGHT?this.#Q(i):null;l?.toggleDrawing();const c=new AbortController,u=this.combinedSignal(c),h=m=>{m.type==="pointerup"&&m.button!==0||(c.abort(),l?.toggleDrawing(!0),m.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}}#W(e=""){this.#S===qe.HIGHLIGHT?this.highlightSelection(e):this.#c&&this.#se()}#ae(){document.addEventListener("selectionchange",this.#ne.bind(this),{signal:this._signal})}#ie(){if(this.#w)return;this.#w=new AbortController;const e=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#re(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#j&&(this.#j=!1,this.#W("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#b)if(t.div.contains(e)){this.#R=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#R)return;const[e,t]=this.#R;this.#R=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#Z(){if(this.#E)return;this.#E=new AbortController;const e=this.combinedSignal(this.#E);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#le(){this.#E?.abort(),this.#E=null}#K(){if(this.#u)return;this.#u=new AbortController;const e=this.combinedSignal(this.#u);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#J(){this.#u?.abort(),this.#u=null}#oe(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#Z(),this.#K()}removeEditListeners(){this.#le(),this.#J()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of this.#m)if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of this.#m)if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of this.#b){const i=s.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const l of t.items)for(const c of this.#m)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(l){Ve(`paste: "${l.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const l=[];for(const h of s){const m=await i.deserialize(h);if(!m)return;l.push(m)}const c=()=>{for(const h of l)this.#ee(h);this.#te(l)},u=()=>{for(const h of l)h.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(l){Ve(`paste: "${l.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#S!==qe.NONE&&!this.isEditorHandlingKeyboard&&Ja._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#j&&(this.#j=!1,this.#W("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#D(e){Object.entries(e).some(([s,i])=>this.#$[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,e)}),this.#S===qe.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#H([[at.HIGHLIGHT_FREE,!0]]))}#H(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#ie(),this.#K(),this.#D({isEditing:this.#S!==qe.NONE,isEmpty:this.#G(),hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:this.#r.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#re(),this.#J(),this.#D({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#m){this.#m=e;for(const t of this.#m)this.#H(t.defaultPropertiesToUpdate)}}getId(){return this.#T.id}get currentLayer(){return this.#n.get(this.#h)}getLayer(e){return this.#n.get(e)}get currentPageIndex(){return this.#h}addLayer(e){this.#n.set(e.pageIndex,e),this.#N?e.enable():e.disable()}removeLayer(e){this.#n.delete(e.pageIndex)}async updateMode(e,t=null,s=!1,i=!1){if(this.#S!==e&&!(this.#P&&(await this.#P.promise,!this.#P))){if(this.#P=Promise.withResolvers(),this.#o?.commitOrRemove(),this.#S=e,e===qe.NONE){this.setEditingState(!1),this.#de(),this._editorUndoBar?.hide(),this.#P.resolve();return}e===qe.SIGNATURE&&await this.#B?.loadSignatures(),this.setEditingState(!0),await this.#ce(),this.unselectAll();for(const l of this.#n.values())l.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),this.#P.resolve();return}for(const l of this.#s.values())l.annotationElementId===t||l.id===t?(this.setSelected(l),i&&l.enterInEditMode()):l.unselect();this.#P.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#S&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#m){switch(e){case at.CREATE:this.currentLayer.addNewEditor(t);return;case at.HIGHLIGHT_DEFAULT_COLOR:this.#k?.updateColor(t);break;case at.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#V||=new Map).set(e,t),this.showAllEditors("highlight",t);break}for(const s of this.#b)s.updateParams(e,t);for(const s of this.#m)s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){for(const l of this.#s.values())l.editorType===e&&l.show(t);(this.#V?.get(at.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#H([[at.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#C!==e){this.#C=e;for(const t of this.#n.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#ce(){if(!this.#N){this.#N=!0;const e=[];for(const t of this.#n.values())e.push(t.enable());await Promise.all(e);for(const t of this.#s.values())t.enable()}}#de(){if(this.unselectAll(),this.#N){this.#N=!1;for(const e of this.#n.values())e.disable();for(const e of this.#s.values())e.disable()}}getEditors(e){const t=[];for(const s of this.#s.values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return this.#s.get(e)}addEditor(e){this.#s.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.focusMainContainer(),this.#v=null},0)),this.#s.delete(e.id),e.annotationElementId&&this.#M?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#d.has(e.annotationElementId))&&this.#a?.remove(e.id)}addDeletedAnnotationElement(e){this.#d.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#d.has(e)}removeDeletedAnnotationElement(e){this.#d.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#ee(e){const t=this.#n.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#H(e.propertiesToUpdate))}get#ue(){let e=null;for(e of this.#b);return e}updateUI(e){this.#ue===e&&this.#H(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#H(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#b.has(e)){this.#b.delete(e),e.unselect(),this.#D({hasSelectedEditor:this.hasSelection});return}this.#b.add(e),e.select(),this.#H(e.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.id}),this.#o?.commitOrRemove();for(const t of this.#b)t!==e&&t.unselect();this.#b.clear(),this.#b.add(e),e.select(),this.#H(e.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}isSelected(e){return this.#b.has(e)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(e){e.unselect(),this.#b.delete(e),this.#D({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#r.undo(),this.#D({hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#G()}),this._editorUndoBar?.hide()}redo(){this.#r.redo(),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:this.#r.hasSomethingToRedo(),isEmpty:this.#G()})}addCommands(e){this.#r.add(e),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#G()})}cleanUndoStack(e){this.#r.cleanType(e)}#G(){if(this.#s.size===0)return!0;if(this.#s.size===1)for(const e of this.#s.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#b],s=()=>{this._editorUndoBar?.show(i,t.length===1?t[0].editorType:t.length);for(const l of t)l.remove()},i=()=>{for(const l of t)this.#ee(l)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#te(e){for(const t of this.#b)t.unselect();this.#b.clear();for(const t of e)t.isEmpty()||(this.#b.add(t),t.select());this.#D({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#b)e.commit();this.#te(this.#s.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#S!==qe.NONE))&&!this.#o?.commitOrRemove()&&this.hasSelection){for(const e of this.#b)e.unselect();this.#b.clear(),this.#D({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#F[0]+=e,this.#F[1]+=t;const[i,l]=this.#F,c=[...this.#b],u=1e3;this.#L&&clearTimeout(this.#L),this.#L=setTimeout(()=>{this.#L=null,this.#F[0]=this.#F[1]=0,this.addCommands({cmd:()=>{for(const h of c)this.#s.has(h.id)&&(h.translateInPage(i,l),h.translationDone())},undo:()=>{for(const h of c)this.#s.has(h.id)&&(h.translateInPage(-i,-l),h.translationDone())},mustExec:!1})},u);for(const h of c)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(const e of this.#b)this.#f.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);const e=this.#f;this.#f=null;let t=!1;for(const[{x:i,y:l,pageIndex:c},u]of e)u.newX=i,u.newY=l,u.newPageIndex=c,t||=i!==u.savedX||l!==u.savedY||c!==u.savedPageIndex;if(!t)return!1;const s=(i,l,c,u)=>{if(this.#s.has(i.id)){const h=this.#n.get(u);h?i._setParentAndPosition(h,l,c):(i.pageIndex=u,i.x=l,i.y=c)}};return this.addCommands({cmd:()=>{for(const[i,{newX:l,newY:c,newPageIndex:u}]of e)s(i,l,c,u)},undo:()=>{for(const[i,{savedX:l,savedY:c,savedPageIndex:u}]of e)s(i,l,c,u)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#f)for(const s of this.#f.keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#S}get imageManager(){return st(this,"imageManager",new Hp)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let m=0,p=t.rangeCount;m<p;m++)if(!e.contains(t.getRangeAt(m).commonAncestorContainer))return null;const{x:s,y:i,width:l,height:c}=e.getBoundingClientRect();let u;switch(e.getAttribute("data-main-rotation")){case"90":u=(m,p,x,y)=>({x:(p-i)/c,y:1-(m+x-s)/l,width:y/c,height:x/l});break;case"180":u=(m,p,x,y)=>({x:1-(m+x-s)/l,y:1-(p+y-i)/c,width:x/l,height:y/c});break;case"270":u=(m,p,x,y)=>({x:1-(p+y-i)/c,y:(m-s)/l,width:y/c,height:x/l});break;default:u=(m,p,x,y)=>({x:(m-s)/l,y:(p-i)/c,width:x/l,height:y/c});break}const h=[];for(let m=0,p=t.rangeCount;m<p;m++){const x=t.getRangeAt(m);if(!x.collapsed)for(const{x:y,y:v,width:w,height:A}of x.getClientRects())w===0||A===0||h.push(u(y,v,w,A))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#l||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#l?.delete(e)}renderAnnotationElement(e){const t=this.#l?.get(e.data.id);if(!t)return;const s=this.#a.getRawValue(t);s&&(this.#S===qe.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){const i=this.#M?.get(e);i&&(i.setCanvas(t,s),this.#M.delete(e))}addMissingCanvas(e,t){(this.#M||=new Map).set(e,t)}}class $n{#e=null;#t=!1;#s=null;#n=null;#i=null;#a=null;#l=!1;#r=null;#u=null;#o=null;#h=null;#d=!1;static#f=null;static _l10n=null;constructor(e){this.#u=e,this.#d=e._uiManager.useNewAltTextFlow,$n.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){$n._l10n??=e}async render(){const e=this.#s=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#d?(e.classList.add("new"),e.setAttribute("data-l10n-id",$n.#f.missing),t.setAttribute("data-l10n-id",$n.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#u._uiManager._signal;e.addEventListener("contextmenu",_n,{signal:s}),e.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:s});const i=l=>{l.preventDefault(),this.#u._uiManager.editAltText(this.#u),this.#d&&this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",l=>{l.target===e&&l.key==="Enter"&&(this.#l=!0,i(l))},{signal:s}),await this.#p(),e}get#m(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#d?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#d?this.#e!==null||!!this.#o:this.isEmpty()}get guessedText(){return this.#o}async setGuessedText(e){this.#e===null&&(this.#o=e,this.#h=await $n._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#p())}toggleAltTextBadge(e=!1){if(!this.#d||this.#e){this.#r?.remove(),this.#r=null;return}if(!this.#r){const t=this.#r=document.createElement("div");t.className="noAltTextBadge",this.#u.div.append(t)}this.#r.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#o===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#o,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:l=!1}){s&&(this.#o=s,this.#h=i),!(this.#e===e&&this.#t===t)&&(l||(this.#e=e,this.#t=t),this.#p())}toggle(e=!1){this.#s&&(!e&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#s.disabled=!e)}shown(){this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#s?.remove(),this.#s=null,this.#n=null,this.#i=null,this.#r?.remove(),this.#r=null}async#p(){const e=this.#s;if(!e)return;if(this.#d){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",$n.#f[this.#m]),this.#n?.setAttribute("data-l10n-id",$n.#f[`${this.#m}-label`]),!this.#e){this.#i?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#i?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#i;if(!t){this.#i=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#u.id}`;const i=100,l=this.#u._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#a),this.#a=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#i.classList.add("show"),this.#u._reportTelemetry({action:"alt_text_tooltip"})},i)},{signal:l}),e.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#i?.classList.remove("show")},{signal:l})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#u.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class Au{#e;#t=!1;#s=null;#n;#i;#a;#l;#r=null;#u;#o=null;#h;#d=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:l=null,onPinchEnd:c=null,signal:u}){this.#e=e,this.#s=s,this.#n=t,this.#i=i,this.#a=l,this.#l=c,this.#h=new AbortController,this.#u=AbortSignal.any([u,this.#h.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#u})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Wn.pixelRatio}#f(e){if(this.#n?.())return;if(e.touches.length===1){if(this.#r)return;const i=this.#r=new AbortController,l=AbortSignal.any([this.#u,i.signal]),c=this.#e,u={capture:!0,signal:l,passive:!1},h=m=>{m.pointerType==="touch"&&(this.#r?.abort(),this.#r=null)};c.addEventListener("pointerdown",m=>{m.pointerType==="touch"&&(Wt(m),h(m))},u),c.addEventListener("pointerup",h,u),c.addEventListener("pointercancel",h,u);return}if(!this.#d){this.#d=new AbortController;const i=AbortSignal.any([this.#u,this.#d.signal]),l=this.#e,c={signal:i,capture:!1,passive:!1};l.addEventListener("touchmove",this.#m.bind(this),c);const u=this.#p.bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",Wt,c),l.addEventListener("pointermove",Wt,c),l.addEventListener("pointercancel",Wt,c),l.addEventListener("pointerup",Wt,c),this.#i?.()}if(Wt(e),e.touches.length!==2||this.#s?.()){this.#o=null;return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),this.#o={touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#m(e){if(!this.#o||e.touches.length!==2)return;Wt(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:l}=t,{screenX:c,screenY:u}=s,h=this.#o,{touch0X:m,touch0Y:p,touch1X:x,touch1Y:y}=h,v=x-m,w=y-p,A=c-i,N=u-l,S=Math.hypot(A,N)||1,E=Math.hypot(v,w)||1;if(!this.#t&&Math.abs(E-S)<=Au.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=i,h.touch0Y=l,h.touch1X=c,h.touch1Y=u,!this.#t){this.#t=!0;return}const C=[(i+c)/2,(l+u)/2];this.#a?.(C,E,S)}#p(e){e.touches.length>=2||(this.#d&&(this.#d.abort(),this.#d=null,this.#l?.()),this.#o&&(Wt(e),this.#o=null,this.#t=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#r?.abort(),this.#r=null}}class Oe{#e=null;#t=null;#s=null;#n=!1;#i=null;#a="";#l=!1;#r=null;#u=null;#o=null;#h=null;#d="";#f=!1;#m=null;#p=!1;#c=!1;#g=!1;#x=null;#y=0;#v=0;#w=null;#A=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#j=!1;#_=Oe._zIndex++;static _borderLineWidth=-1;static _colorManager=new zp;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=Oe.prototype._resizeWithKeyboard,t=Ja.TRANSLATE_SMALL,s=Ja.TRANSLATE_BIG;return st(this,"_resizerKeyboardManager",new Yo([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],Oe.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[l,c];const[u,h]=this.parentDimensions;this.x=e.x/u,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return st(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new TT({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Oe._l10n??=e,Oe._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Oe._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);Oe._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){yt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#j}set _isDraggable(e){this.#j=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#_}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#U(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[l,c]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/l,this.y=(t+i)/c,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,i]=this.parentDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i),this._onTranslated()}#T([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#T(this.parentDimensions,e,t)}translateInPage(e,t){this.#m||=[this.x,this.y,this.width,this.height],this.#T(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#m||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[i,l]}=this;if(this.x+=e/i,this.y+=t/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x,y}=this.div.getBoundingClientRect();this.parent.findNewParent(this,x,y)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[h,m]=this.getBaseTranslation();c+=h,u+=m;const{style:p}=s;p.left=`${(100*c).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#m&&(this.#m[0]!==this.x||this.#m[1]!==this.y)}get _hasBeenResized(){return!!this.#m&&(this.#m[2]!==this.width||this.#m[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=Oe,i=s/e,l=s/t;switch(this.rotation){case 90:return[-i,l];case 180:return[i,l];case 270:return[i,-l];default:return[-i,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:l,y:c,width:u,height:h}=this;if(u*=s,h*=i,l*=s,c*=i,this._mustFixPosition)switch(e){case 0:l=Ss(l,0,s-u),c=Ss(c,0,i-h);break;case 90:l=Ss(l,0,s-h),c=Ss(c,u,i);break;case 180:l=Ss(l,u,s),c=Ss(c,h,i);break;case 270:l=Ss(l,h,s),c=Ss(c,0,i-u);break}this.x=l/=s,this.y=c/=i;const[m,p]=this.getBaseTranslation();l+=m,c+=p,t.left=`${(100*l).toFixed(2)}%`,t.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#N(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return Oe.#N(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Oe.#N(e,t,360-this.parentRotation)}#C(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:l}=this.div;l.width=`${(100*e/s).toFixed(2)}%`,this.#l||(l.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),l=!this.#l&&t.endsWith("%");if(i&&l)return;const[c,u]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/c).toFixed(2)}%`),!this.#l&&!l&&(e.height=`${(100*parseFloat(t)/u).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#E(){if(this.#r)return;this.#r=document.createElement("div"),this.#r.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");this.#r.append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",this.#R.bind(this,s),{signal:t}),i.addEventListener("contextmenu",_n,{signal:t}),i.tabIndex=-1}this.div.prepend(this.#r)}#R(e,t){t.preventDefault();const{isMac:s}=fs.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#s?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#u=[t.screenX,t.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#z.bind(this,e),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",Wt,{passive:!1,signal:c}),window.addEventListener("contextmenu",_n,{signal:c}),this.#o={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const m=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#M()};window.addEventListener("pointerup",m,{signal:c}),window.addEventListener("blur",m,{signal:c})}#k(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[l,c]=this.parentDimensions;this.setDims(l*s,c*i),this.fixAndSetPosition(),this._onResized()}_onResized(){}#M(){if(!this.#o)return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=this.#o;this.#o=null;const l=this.x,c=this.y,u=this.width,h=this.height;l===e&&c===t&&u===s&&h===i||this.addCommands({cmd:this.#k.bind(this,l,c,u,h),undo:this.#k.bind(this,e,t,s,i),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#z(e,t){const[s,i]=this.parentDimensions,l=this.x,c=this.y,u=this.width,h=this.height,m=Oe.MIN_SIZE/s,p=Oe.MIN_SIZE/i,x=this.#C(this.rotation),y=(L,q)=>[x[0]*L+x[2]*q,x[1]*L+x[3]*q],v=this.#C(360-this.rotation),w=(L,q)=>[v[0]*L+v[2]*q,v[1]*L+v[3]*q];let A,N,S=!1,E=!1;switch(e){case"topLeft":S=!0,A=(L,q)=>[0,0],N=(L,q)=>[L,q];break;case"topMiddle":A=(L,q)=>[L/2,0],N=(L,q)=>[L/2,q];break;case"topRight":S=!0,A=(L,q)=>[L,0],N=(L,q)=>[0,q];break;case"middleRight":E=!0,A=(L,q)=>[L,q/2],N=(L,q)=>[0,q/2];break;case"bottomRight":S=!0,A=(L,q)=>[L,q],N=(L,q)=>[0,0];break;case"bottomMiddle":A=(L,q)=>[L/2,q],N=(L,q)=>[L/2,0];break;case"bottomLeft":S=!0,A=(L,q)=>[0,q],N=(L,q)=>[L,0];break;case"middleLeft":E=!0,A=(L,q)=>[0,q/2],N=(L,q)=>[L,q/2];break}const C=A(u,h),R=N(u,h);let D=y(...R);const O=Oe._round(l+D[0]),H=Oe._round(c+D[1]);let F=1,P=1,Z,z;if(t.fromKeyboard)({deltaX:Z,deltaY:z}=t);else{const{screenX:L,screenY:q}=t,[$,I]=this.#u;[Z,z]=this.screenToPageTranslation(L-$,q-I),this.#u[0]=L,this.#u[1]=q}if([Z,z]=w(Z/s,z/i),S){const L=Math.hypot(u,h);F=P=Math.max(Math.min(Math.hypot(R[0]-C[0]-Z,R[1]-C[1]-z)/L,1/u,1/h),m/u,p/h)}else E?F=Ss(Math.abs(R[0]-C[0]-Z),m,1)/u:P=Ss(Math.abs(R[1]-C[1]-z),p,1)/h;const K=Oe._round(u*F),W=Oe._round(h*P);D=y(...N(K,W));const ce=O-D[0],me=H-D[1];this.#m||=[this.x,this.y,this.width,this.height],this.width=K,this.height=W,this.x=ce,this.y=me,this.setDims(s*K,i*W),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#c)return this._editToolbar;this._editToolbar=new vo(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#s?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#s||($n.initialize(Oe._l10n),this.#s=new $n(this),this.#e&&(this.#s.data=this.#e,this.#e=null)),this.#s}get altTextData(){return this.#s?.data}set altTextData(e){this.#s&&(this.#s.data=e)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(e){await this.#s?.setGuessedText(e)}serializeAltText(e){return this.#s?.serialize(e)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#n?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#V();const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[i,l]=this.getInitialTranslation();return this.translate(i,l),b1(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#A||=new Au({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#S.bind(this),onPinching:this.#b.bind(this),onPinchEnd:this.#I.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),e}#S(){this.#o={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#s?.toggle(!1),this.parent.togglePointerEvents(!1)}#b(e,t,s){let l=.7*(s/t)+1-.7;if(l===1)return;const c=this.#C(this.rotation),u=(O,H)=>[c[0]*O+c[2]*H,c[1]*O+c[3]*H],[h,m]=this.parentDimensions,p=this.x,x=this.y,y=this.width,v=this.height,w=Oe.MIN_SIZE/h,A=Oe.MIN_SIZE/m;l=Math.max(Math.min(l,1/y,1/v),w/y,A/v);const N=Oe._round(y*l),S=Oe._round(v*l);if(N===y&&S===v)return;this.#m||=[p,x,y,v];const E=u(y/2,v/2),C=Oe._round(p+E[0]),R=Oe._round(x+E[1]),D=u(N/2,S/2);this.x=C-D[0],this.y=R-D[1],this.width=N,this.height=S,this.setDims(h*N,m*S),this.fixAndSetPosition(),this._onResizing()}#I(){this.#s?.toggle(!0),this.parent.togglePointerEvents(!0),this.#M()}pointerdown(e){const{isMac:t}=fs.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#q(e);return}this.#B(e)}#B(e){const{isMac:t}=fs.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#q(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,l=this._uiManager.combinedSignal(i),c={capture:!0,passive:!1,signal:l},u=m=>{i.abort(),this.#i=null,this.#f=!1,this._uiManager.endDragSession()||this.#B(m),s&&this._onStopDragging()};t&&(this.#y=e.clientX,this.#v=e.clientY,this.#i=e.pointerId,this.#a=e.pointerType,window.addEventListener("pointermove",m=>{s||(s=!0,this._onStartDragging());const{clientX:p,clientY:x,pointerId:y}=m;if(y!==this.#i){Wt(m);return}const[v,w]=this.screenToPageTranslation(p-this.#y,x-this.#v);this.#y=p,this.#v=x,this._uiManager.dragSelectedEditors(v,w)},c),window.addEventListener("touchmove",Wt,c),window.addEventListener("pointerdown",m=>{m.pointerType===this.#a&&(this.#A||m.isPrimary)&&u(m),Wt(m)},c));const h=m=>{if(!this.#i||this.#i===m.pointerId){u(m);return}Wt(m)};window.addEventListener("pointerup",h,{signal:l}),window.addEventListener("blur",h,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.#x=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[l,c]=this.pageDimensions,[u,h]=this.pageTranslation,m=e/i,p=t/i,x=this.x*l,y=this.y*c,v=this.width*l,w=this.height*c;switch(s){case 0:return[x+m+u,c-y-p-w+h,x+m+v+u,c-y-p+h];case 90:return[x+p+u,c-y+m+h,x+p+w+u,c-y+m+v+h];case 180:return[x-m-v+u,c-y+p+h,x-m+u,c-y+p+w+h];case 270:return[x-p-w+u,c-y-m-v+h,x-p+u,c-y-m+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,l,c]=e,u=l-s,h=c-i;switch(this.rotation){case 0:return[s,t-c,u,h];case 90:return[s,t-i,h,u];case 180:return[l,t-i,u,h];case 270:return[l,t-c,h,u];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#c=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#c=!1,!0):!1}isInEditMode(){return this.#c}shouldGetKeyboardEvents(){return this.#g}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return t<c&&i>0&&e<l&&s>0}#V(){if(this.#h||!this.div)return;this.#h=new AbortController;const e=this._uiManager.combinedSignal(this.#h);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#V()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){yt("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId});i.rotation=e.rotation,i.#e=e.accessibilityData,i._isCopy=e.isCopy||!1;const[l,c]=i.pageDimensions,[u,h,m,p]=i.getRectInCurrentCoords(e.rect,c);return i.x=u/l,i.y=h/c,i.width=m/l,i.height=p/c,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#h?.abort(),this.#h=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#x&&(clearTimeout(this.#x),this.#x=null),this.#U(),this.removeEditToolbar(),this.#w){for(const e of this.#w.values())clearTimeout(e);this.#w=null}this.parent=null,this.#A?.destroy(),this.#A=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#E(),this.#r.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#o={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#r.children;if(!this.#t){this.#t=Array.from(t);const c=this.#$.bind(this),u=this.#F.bind(this),h=this._uiManager._signal;for(const m of this.#t){const p=m.getAttribute("data-resizer-name");m.setAttribute("role","spinbutton"),m.addEventListener("keydown",c,{signal:h}),m.addEventListener("blur",u,{signal:h}),m.addEventListener("focus",this.#L.bind(this,p),{signal:h}),m.setAttribute("data-l10n-id",Oe._l10nResizer[p])}}const s=this.#t[0];let i=0;for(const c of t){if(c===s)break;i++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(l!==i){if(l<i)for(let u=0;u<i-l;u++)this.#r.append(this.#r.firstChild);else if(l>i)for(let u=0;u<l-i;u++)this.#r.firstChild.before(this.#r.lastChild);let c=0;for(const u of t){const m=this.#t[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",Oe._l10nResizer[m])}}this.#O(0),this.#g=!0,this.#r.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#$(e){Oe._resizerKeyboardManager.exec(this,e)}#F(e){this.#g&&e.relatedTarget?.parentNode!==this.#r&&this.#U()}#L(e){this.#d=this.#g?e:""}#O(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#g&&this.#z(this.#d,{deltaX:e,deltaY:t,fromKeyboard:!0})}#U(){this.#g=!1,this.#O(-1),this.#M()}_stopResizingWithKeyboard(){this.#U(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#r?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#l=!0;const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#w||=new Map;const{action:s}=e;let i=this.#w.get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),this.#w.delete(s),this.#w.size===0&&(this.#w=null)},Oe._telemetryTimeout),this.#w.set(s,i);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#n=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#n=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class TT extends Oe{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const qb=3285377520,hn=4294901760,qn=65535;class v1{constructor(e){this.h1=e?e&4294967295:qb,this.h2=e?e&4294967295:qb}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let A=0,N=e.length;A<N;A++){const S=e.charCodeAt(A);S<=255?t[s++]=S:(t[s++]=S>>>8,t[s++]=S&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,l=s-i*4,c=new Uint32Array(t.buffer,0,i);let u=0,h=0,m=this.h1,p=this.h2;const x=3432918353,y=461845907,v=x&qn,w=y&qn;for(let A=0;A<i;A++)A&1?(u=c[A],u=u*x&hn|u*v&qn,u=u<<15|u>>>17,u=u*y&hn|u*w&qn,m^=u,m=m<<13|m>>>19,m=m*5+3864292196):(h=c[A],h=h*x&hn|h*v&qn,h=h<<15|h>>>17,h=h*y&hn|h*w&qn,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,l){case 3:u^=t[i*4+2]<<16;case 2:u^=t[i*4+1]<<8;case 1:u^=t[i*4],u=u*x&hn|u*v&qn,u=u<<15|u>>>17,u=u*y&hn|u*w&qn,i&1?m^=u:p^=u}this.h1=m,this.h2=p}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&hn|e*36045&qn,t=t*4283543511&hn|((t<<16|e>>>16)*2950163797&hn)>>>16,e^=t>>>1,e=e*444984403&hn|e*60499&qn,t=t*3301882366&hn|((t<<16|e>>>16)*3120437893&hn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Km=Object.freeze({map:null,hash:"",transfer:void 0});class Fp{#e=!1;#t=null;#s=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=this.#s.get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return this.#s.get(e)}remove(e){if(this.#s.delete(e),this.#s.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#s.values())if(t instanceof Oe)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=this.#s.get(e);let i=!1;if(s!==void 0)for(const[l,c]of Object.entries(t))s[l]!==c&&(i=!0,s[l]=c);else i=!0,this.#s.set(e,t);i&&this.#n(),t instanceof Oe&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#s.has(e)}get size(){return this.#s.size}#n(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new w1(this)}get serializable(){if(this.#s.size===0)return Km;const e=new Map,t=new v1,s=[],i=Object.create(null);let l=!1;for(const[c,u]of this.#s){const h=u instanceof Oe?u.serialize(!1,i):u;h&&(e.set(c,h),t.update(`${c}:${JSON.stringify(h)}`),l||=!!h.bitmap)}if(l)for(const c of e.values())c.bitmap&&s.push(c.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Km}get editorStats(){let e=null;const t=new Map;for(const s of this.#s.values()){if(!(s instanceof Oe))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:l}=i;t.has(l)||t.set(l,Object.getPrototypeOf(s).constructor),e||=Object.create(null);const c=e[l]||=new Map;for(const[u,h]of Object.entries(i)){if(u==="type")continue;let m=c.get(u);m||(m=new Map,c.set(u,m));const p=m.get(h)??0;m.set(h,p+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#s.values())!(t instanceof Oe)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#s.entries()}}class w1 extends Fp{#e;constructor(e){super();const{map:t,hash:s,transfer:i}=e.serializable,l=structuredClone(t,i?{transfer:i}:null);this.#e={map:l,hash:s,transfer:i}}get print(){yt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return st(this,"modifiedIds",{ids:new Set,hash:""})}}class DT{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||this.#e.has(e.loadedName))){if(Xt(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:l,style:c}=e,u=new FontFace(i,l,c);this.addNativeFontFace(u);try{await u.load(),this.#e.add(i),s?.(e)}catch{Ve(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}yt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw Ve(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return st(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return st(this,"isSyncFontLoadingSupported",Ns||fs.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Xt(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const l=s.shift();setTimeout(l.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return st(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(R,D){return R.charCodeAt(D)<<24|R.charCodeAt(D+1)<<16|R.charCodeAt(D+2)<<8|R.charCodeAt(D+3)&255}function i(R,D,O,H){const F=R.substring(0,D),P=R.substring(D+O);return F+H+P}let l,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let m=0;function p(R,D){if(++m>30){Ve("Load test font never loaded."),D();return}if(h.font="30px "+R,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(p.bind(null,R,D))}const x=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=i(y,976,x.length,x);const w=16,A=1482184792;let N=s(y,w);for(l=0,c=x.length-3;l<c;l+=4)N=N-A+s(x,l)|0;l<x.length&&(N=N-A+s(x+"XXX",l)|0),y=i(y,w,4,mT(N));const S=`url(data:font/opentype;base64,${btoa(y)});`,E=`@font-face {font-family:"${x}";src:${S}}`;this.insertRule(E);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const R of[e.loadedName,x]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=R,C.append(D)}this._document.body.append(C),p(x,()=>{C.remove(),t.complete()})}}class RT{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this._inspectFont=t}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${x1(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(c){Ve(`getPathGenerator - ignoring character: "${c}".`)}const l=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=l}}function kT(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Ns)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function MT(n){if(Ns&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Vo(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function hd(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const Jm=n=>typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0,LT=n=>typeof n=="object"&&typeof n?.name=="string",OT=bT.bind(null,Jm,LT);class PT{#e=new Map;#t=Promise.resolve();postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[i]of this.#e)i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if(s?.signal instanceof AbortSignal){const{signal:l}=s;if(l.aborted){Ve("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(e,t);i=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#e.set(t,i)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const fd={DATA:1,ERROR:2},Gt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Vb(){}function Os(n){if(n instanceof Ka||n instanceof Qm||n instanceof zb||n instanceof Gd||n instanceof dm)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||yt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Ka(n.message);case"InvalidPDFException":return new Qm(n.message);case"PasswordException":return new zb(n.message,n.code);case"ResponseException":return new Gd(n.message,n.status,n.missing);case"UnknownErrorException":return new dm(n.message,n.details)}return new dm(n.message,n.toString())}class go{#e=new AbortController;constructor(e,t,s){this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===fd.DATA)i.resolve(e.data);else if(e.callback===fd.ERROR)i.reject(Os(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,l=this.comObj;Promise.try(t,e.data).then(function(c){l.postMessage({sourceName:s,targetName:i,callback:fd.DATA,callbackId:e.callbackId,data:c})},function(c){l.postMessage({sourceName:s,targetName:i,callback:fd.ERROR,callbackId:e.callbackId,reason:Os(c)})});return}if(e.streamId){this.#s(e);return}t(e.data)}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[i]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(c){l.reject(c)}return l.promise}sendWithStream(e,t,s,i){const l=this.streamId++,c=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:m=>{const p=Promise.withResolvers();return this.streamControllers[l]={controller:m,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:c,targetName:u,action:e,streamId:l,data:t,desiredSize:m.desiredSize},i),p.promise},pull:m=>{const p=Promise.withResolvers();return this.streamControllers[l].pullCall=p,h.postMessage({sourceName:c,targetName:u,stream:Gt.PULL,streamId:l,desiredSize:m.desiredSize}),p.promise},cancel:m=>{Xt(m instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[l].cancelCall=p,this.streamControllers[l].isClosed=!0,h.postMessage({sourceName:c,targetName:u,stream:Gt.CANCEL,streamId:l,reason:Os(m)}),p.promise}},s)}#s(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,l=this.comObj,c=this,u=this.actionHandler[e.action],h={enqueue(m,p=1,x){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=p,y>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:s,targetName:i,stream:Gt.ENQUEUE,streamId:t,chunk:m},x)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:i,stream:Gt.CLOSE,streamId:t}),delete c.streamSinks[t])},error(m){Xt(m instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:i,stream:Gt.ERROR,streamId:t,reason:Os(m)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(u,e.data,h).then(function(){l.postMessage({sourceName:s,targetName:i,stream:Gt.START_COMPLETE,streamId:t,success:!0})},function(m){l.postMessage({sourceName:s,targetName:i,stream:Gt.START_COMPLETE,streamId:t,reason:Os(m)})})}#n(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,l=this.comObj,c=this.streamControllers[t],u=this.streamSinks[t];switch(e.stream){case Gt.START_COMPLETE:e.success?c.startCall.resolve():c.startCall.reject(Os(e.reason));break;case Gt.PULL_COMPLETE:e.success?c.pullCall.resolve():c.pullCall.reject(Os(e.reason));break;case Gt.PULL:if(!u){l.postMessage({sourceName:s,targetName:i,stream:Gt.PULL_COMPLETE,streamId:t,success:!0});break}u.desiredSize<=0&&e.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=e.desiredSize,Promise.try(u.onPull||Vb).then(function(){l.postMessage({sourceName:s,targetName:i,stream:Gt.PULL_COMPLETE,streamId:t,success:!0})},function(m){l.postMessage({sourceName:s,targetName:i,stream:Gt.PULL_COMPLETE,streamId:t,reason:Os(m)})});break;case Gt.ENQUEUE:if(Xt(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(e.chunk);break;case Gt.CLOSE:if(Xt(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#i(c,t);break;case Gt.ERROR:Xt(c,"error should have stream controller"),c.controller.error(Os(e.reason)),this.#i(c,t);break;case Gt.CANCEL_COMPLETE:e.success?c.cancelCall.resolve():c.cancelCall.reject(Os(e.reason)),this.#i(c,t);break;case Gt.CANCEL:if(!u)break;const h=Os(e.reason);Promise.try(u.onCancel||Vb,h).then(function(){l.postMessage({sourceName:s,targetName:i,stream:Gt.CANCEL_COMPLETE,streamId:t,success:!0})},function(m){l.postMessage({sourceName:s,targetName:i,stream:Gt.CANCEL_COMPLETE,streamId:t,reason:Os(m)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#i(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class A1{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){yt("Abstract method `_createCanvas` called.")}}class IT extends A1{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class N1{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){yt("Abstract method `_fetch` called.")}}class $b extends N1{async _fetch(e){const t=await $o(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Vo(t)}}class S1{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,l){return"none"}destroy(e=!1){}}class BT extends S1{#e;#t;#s;#n;#i;#a;#l=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#i=t}get#r(){return this.#t||=new Map}get#u(){return this.#a||=new Map}get#o(){if(!this.#s){const e=this.#i.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const s=this.#i.createElementNS(ha,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#s=this.#i.createElementNS(ha,"defs"),e.append(s),s.append(this.#s),this.#i.body.append(e)}return this.#s}#h(e){if(e.length===1){const h=e[0],m=new Array(256);for(let x=0;x<256;x++)m[x]=h[x]/255;const p=m.join(",");return[p,p,p]}const[t,s,i]=e,l=new Array(256),c=new Array(256),u=new Array(256);for(let h=0;h<256;h++)l[h]=t[h]/255,c[h]=s[h]/255,u[h]=i[h]/255;return[l.join(","),c.join(","),u.join(",")]}#d(e){if(this.#e===void 0){this.#e="";const t=this.#i.URL;t!==this.#i.baseURI&&(wu(t)?Ve('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=m1(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#r.get(e);if(t)return t;const[s,i,l]=this.#h(e),c=e.length===1?s:`${s}${i}${l}`;if(t=this.#r.get(c),t)return this.#r.set(e,t),t;const u=`g_${this.#n}_transfer_map_${this.#l++}`,h=this.#d(u);this.#r.set(e,h),this.#r.set(c,h);const m=this.#p(u);return this.#g(s,i,l,m),h}addHCMFilter(e,t){const s=`${e}-${t}`,i="base";let l=this.#u.get(i);if(l?.key===s||(l?(l.filter?.remove(),l.key=s,l.url="none",l.filter=null):(l={key:s,url:"none",filter:null},this.#u.set(i,l)),!e||!t))return l.url;const c=this.#y(e);e=Me.makeHexColor(...c);const u=this.#y(t);if(t=Me.makeHexColor(...u),this.#o.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return l.url;const h=new Array(256);for(let v=0;v<=255;v++){const w=v/255;h[v]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const m=h.join(","),p=`g_${this.#n}_hcm_filter`,x=l.filter=this.#p(p);this.#g(m,m,m,x),this.#m(x);const y=(v,w)=>{const A=c[v]/255,N=u[v]/255,S=new Array(w+1);for(let E=0;E<=w;E++)S[E]=A+E/w*(N-A);return S.join(",")};return this.#g(y(0,5),y(1,5),y(2,5),x),l.url=this.#d(p),l.url}addAlphaFilter(e){let t=this.#r.get(e);if(t)return t;const[s]=this.#h([e]),i=`alpha_${s}`;if(t=this.#r.get(i),t)return this.#r.set(e,t),t;const l=`g_${this.#n}_alpha_map_${this.#l++}`,c=this.#d(l);this.#r.set(e,c),this.#r.set(i,c);const u=this.#p(l);return this.#x(s,u),c}addLuminosityFilter(e){let t=this.#r.get(e||"luminosity");if(t)return t;let s,i;if(e?([s]=this.#h([e]),i=`luminosity_${s}`):i="luminosity",t=this.#r.get(i),t)return this.#r.set(e,t),t;const l=`g_${this.#n}_luminosity_map_${this.#l++}`,c=this.#d(l);this.#r.set(e,c),this.#r.set(i,c);const u=this.#p(l);return this.#f(u),e&&this.#x(s,u),c}addHighlightHCMFilter(e,t,s,i,l){const c=`${t}-${s}-${i}-${l}`;let u=this.#u.get(e);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#u.set(e,u)),!t||!s))return u.url;const[h,m]=[t,s].map(this.#y.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),x=Math.round(.2126*m[0]+.7152*m[1]+.0722*m[2]),[y,v]=[i,l].map(this.#y.bind(this));x<p&&([p,x,y,v]=[x,p,v,y]),this.#o.style.color="";const w=(S,E,C)=>{const R=new Array(256),D=(x-p)/C,O=S/255,H=(E-S)/(255*C);let F=0;for(let P=0;P<=C;P++){const Z=Math.round(p+P*D),z=O+P*H;for(let K=F;K<=Z;K++)R[K]=z;F=Z+1}for(let P=F;P<256;P++)R[P]=R[F-1];return R.join(",")},A=`g_${this.#n}_hcm_${e}_filter`,N=u.filter=this.#p(A);return this.#m(N),this.#g(w(y[0],v[0],5),w(y[1],v[1],5),w(y[2],v[2],5),N),u.url=this.#d(A),u.url}destroy(e=!1){e&&this.#a?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#t?.clear(),this.#t=null,this.#a?.clear(),this.#a=null,this.#l=0)}#f(e){const t=this.#i.createElementNS(ha,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#m(e){const t=this.#i.createElementNS(ha,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){const t=this.#i.createElementNS(ha,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#o.append(t),t}#c(e,t,s){const i=this.#i.createElementNS(ha,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",s),e.append(i)}#g(e,t,s,i){const l=this.#i.createElementNS(ha,"feComponentTransfer");i.append(l),this.#c(l,"feFuncR",e),this.#c(l,"feFuncG",t),this.#c(l,"feFuncB",s)}#x(e,t){const s=this.#i.createElementNS(ha,"feComponentTransfer");t.append(s),this.#c(s,"feFuncA",e)}#y(e){return this.#o.style.color=e,Bp(getComputedStyle(this.#o).getPropertyValue("color"))}}class j1{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){yt("Abstract method `_fetch` called.")}}class Gb extends j1{async _fetch(e){const t=await $o(e,"arraybuffer");return new Uint8Array(t)}}class E1{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){yt("Abstract method `_fetch` called.")}}class Yb extends E1{async _fetch(e){const t=await $o(e,"arraybuffer");return new Uint8Array(t)}}Ns&&Ve("Please use the `legacy` build in Node.js environments.");async function Up(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class HT extends S1{}class zT extends A1{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class FT extends N1{async _fetch(e){return Up(e)}}class UT extends j1{async _fetch(e){return Up(e)}}class qT extends E1{async _fetch(e){return Up(e)}}const hs={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function ep(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class qp{isModifyingCurrentTransform(){return!1}getPattern(){yt("Abstract method `getPattern` called.")}}class VT extends qp{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let l;if(i===hs.STROKE||i===hs.FILL){const c=t.current.getClippedPathBoundingBox(i,Mt(e))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,h=Math.ceil(c[3]-c[1])||1,m=t.cachedCanvases.getCanvas("pattern",u,h),p=m.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-c[0],-c[1]),s=Me.transform(s,[1,0,0,1,c[0],c[1]]),p.transform(...t.baseTransform),this.matrix&&p.transform(...this.matrix),ep(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),l=e.createPattern(m.canvas,"no-repeat");const x=new DOMMatrix(s);l.setTransform(x)}else ep(e,this._bbox),l=this._createGradient(e);return l}}function fm(n,e,t,s,i,l,c,u){const h=e.coords,m=e.colors,p=n.data,x=n.width*4;let y;h[t+1]>h[s+1]&&(y=t,t=s,s=y,y=l,l=c,c=y),h[s+1]>h[i+1]&&(y=s,s=i,i=y,y=c,c=u,u=y),h[t+1]>h[s+1]&&(y=t,t=s,s=y,y=l,l=c,c=y);const v=(h[t]+e.offsetX)*e.scaleX,w=(h[t+1]+e.offsetY)*e.scaleY,A=(h[s]+e.offsetX)*e.scaleX,N=(h[s+1]+e.offsetY)*e.scaleY,S=(h[i]+e.offsetX)*e.scaleX,E=(h[i+1]+e.offsetY)*e.scaleY;if(w>=E)return;const C=m[l],R=m[l+1],D=m[l+2],O=m[c],H=m[c+1],F=m[c+2],P=m[u],Z=m[u+1],z=m[u+2],K=Math.round(w),W=Math.round(E);let ce,me,L,q,$,I,T,V;for(let M=K;M<=W;M++){if(M<N){const je=M<w?0:(w-M)/(w-N);ce=v-(v-A)*je,me=C-(C-O)*je,L=R-(R-H)*je,q=D-(D-F)*je}else{let je;M>E?je=1:N===E?je=0:je=(N-M)/(N-E),ce=A-(A-S)*je,me=O-(O-P)*je,L=H-(H-Z)*je,q=F-(F-z)*je}let G;M<w?G=0:M>E?G=1:G=(w-M)/(w-E),$=v-(v-S)*G,I=C-(C-P)*G,T=R-(R-Z)*G,V=D-(D-z)*G;const de=Math.round(Math.min(ce,$)),re=Math.round(Math.max(ce,$));let ye=x*M+de*4;for(let je=de;je<=re;je++)G=(ce-je)/(ce-$),G<0?G=0:G>1&&(G=1),p[ye++]=me-(me-I)*G|0,p[ye++]=L-(L-T)*G|0,p[ye++]=q-(q-V)*G|0,p[ye++]=255}}function $T(n,e,t){const s=e.coords,i=e.colors;let l,c;switch(e.type){case"lattice":const u=e.verticesPerRow,h=Math.floor(s.length/u)-1,m=u-1;for(l=0;l<h;l++){let p=l*u;for(let x=0;x<m;x++,p++)fm(n,t,s[p],s[p+1],s[p+u],i[p],i[p+1],i[p+u]),fm(n,t,s[p+u+1],s[p+1],s[p+u],i[p+u+1],i[p+1],i[p+u])}break;case"triangles":for(l=0,c=s.length;l<c;l+=3)fm(n,t,s[l],s[l+1],s[l+2],i[l],i[l+1],i[l+2]);break;default:throw new Error("illegal figure")}}class GT extends qp{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),m=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-h,x=Math.min(Math.ceil(Math.abs(m*e[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),v=m/x,w=p/y,A={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/v,scaleY:1/w},N=x+4,S=y+4,E=s.getCanvas("mesh",N,S),C=E.context,R=C.createImageData(x,y);if(t){const O=R.data;for(let H=0,F=O.length;H<F;H+=4)O[H]=t[0],O[H+1]=t[1],O[H+2]=t[2],O[H+3]=255}for(const O of this._figures)$T(R,O,A);return C.putImageData(R,2,2),{canvas:E.canvas,offsetX:u-2*v,offsetY:h-2*w,scaleX:v,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,i){ep(e,this._bbox);const l=new Float32Array(2);if(i===hs.SHADING)Me.singularValueDecompose2dScale(Mt(e),l);else if(this.matrix){Me.singularValueDecompose2dScale(this.matrix,l);const[u,h]=l;Me.singularValueDecompose2dScale(t.baseTransform,l),l[0]*=u,l[1]*=h}else Me.singularValueDecompose2dScale(t.baseTransform,l);const c=this._createMeshCanvas(l,i===hs.SHADING?null:this._background,t.cachedCanvases);return i!==hs.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(c.offsetX,c.offsetY),e.scale(c.scaleX,c.scaleY),e.createPattern(c.canvas,"no-repeat")}}class YT extends qp{getPattern(){return"hotpink"}}function WT(n){switch(n[0]){case"RadialAxial":return new VT(n);case"Mesh":return new GT(n);case"Dummy":return new YT}throw new Error(`Unknown IR type: ${n[0]}`)}const Wb={COLORED:1,UNCOLORED:2};class Vp{static MAX_PATTERN_SIZE=3e3;constructor(e,t,s,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:l,color:c,canvasGraphicsFactory:u}=this;let{xstep:h,ystep:m}=this;h=Math.abs(h),m=Math.abs(m),vu("TilingType: "+l);const p=t[0],x=t[1],y=t[2],v=t[3],w=y-p,A=v-x,N=new Float32Array(2);Me.singularValueDecompose2dScale(this.matrix,N);const[S,E]=N;Me.singularValueDecompose2dScale(this.baseTransform,N);const C=S*N[0],R=E*N[1];let D=w,O=A,H=!1,F=!1;const P=Math.ceil(h*C),Z=Math.ceil(m*R),z=Math.ceil(w*C),K=Math.ceil(A*R);P>=z?D=h:H=!0,Z>=K?O=m:F=!0;const W=this.getSizeAndScale(D,this.ctx.canvas.width,C),ce=this.getSizeAndScale(O,this.ctx.canvas.height,R),me=e.cachedCanvases.getCanvas("pattern",W.size,ce.size),L=me.context,q=u.createCanvasGraphics(L);if(q.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(q,i,c),L.translate(-W.scale*p,-ce.scale*x),q.transform(W.scale,0,0,ce.scale,0,0),L.save(),this.clipBbox(q,p,x,y,v),q.baseTransform=Mt(q.ctx),q.executeOperatorList(s),q.endDrawing(),L.restore(),H||F){const $=me.canvas;H&&(D=h),F&&(O=m);const I=this.getSizeAndScale(D,this.ctx.canvas.width,C),T=this.getSizeAndScale(O,this.ctx.canvas.height,R),V=I.size,M=T.size,G=e.cachedCanvases.getCanvas("pattern-workaround",V,M),de=G.context,re=H?Math.floor(w/h):0,ye=F?Math.floor(A/m):0;for(let je=0;je<=re;je++)for(let Le=0;Le<=ye;Le++)de.drawImage($,V*je,M*Le,V,M,0,0,V,M);return{canvas:G.canvas,scaleX:I.scale,scaleY:T.scale,offsetX:p,offsetY:x}}return{canvas:me.canvas,scaleX:W.scale,scaleY:ce.scale,offsetX:p,offsetY:x}}getSizeAndScale(e,t,s){const i=Math.max(Vp.MAX_PATTERN_SIZE,t);let l=Math.ceil(e*s);return l>=i?l=i:s=l/e,{scale:s,size:l}}clipBbox(e,t,s,i,l){const c=i-t,u=l-s;e.ctx.rect(t,s,c,u),Me.axialAlignedBoundingBox([t,s,i,l],Mt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,l=e.current;switch(t){case Wb.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;i.fillStyle=l.fillColor=c,i.strokeStyle=l.strokeColor=u;break;case Wb.UNCOLORED:i.fillStyle=i.strokeStyle=s,l.fillColor=l.strokeColor=s;break;default:throw new fT(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,i){let l=s;i!==hs.SHADING&&(l=Me.transform(l,t.baseTransform),this.matrix&&(l=Me.transform(l,this.matrix)));const c=this.createPatternCanvas(t);let u=new DOMMatrix(l);u=u.translate(c.offsetX,c.offsetY),u=u.scale(1/c.scaleX,1/c.scaleY);const h=e.createPattern(c.canvas,"repeat");return h.setTransform(u),h}}function XT({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const u=fs.isLittleEndian?4278190080:255,[h,m]=c?[l,u]:[u,l],p=s>>3,x=s&7,y=n.length;t=new Uint32Array(t.buffer);let v=0;for(let w=0;w<i;w++){for(const N=e+p;e<N;e++){const S=e<y?n[e]:255;t[v++]=S&128?m:h,t[v++]=S&64?m:h,t[v++]=S&32?m:h,t[v++]=S&16?m:h,t[v++]=S&8?m:h,t[v++]=S&4?m:h,t[v++]=S&2?m:h,t[v++]=S&1?m:h}if(x===0)continue;const A=e<y?n[e++]:255;for(let N=0;N<x;N++)t[v++]=A&1<<7-N?m:h}return{srcPos:e,destPos:v}}const Xb=16,Qb=100,QT=15,Zb=10,Ps=16,mm=new DOMMatrix,Ks=new Float32Array(2),qr=new Float32Array([1/0,1/0,-1/0,-1/0]);function ZT(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,i,l,c,u){e.transform(t,s,i,l,c,u),this.__originalTransform(t,s,i,l,c,u)},n.setTransform=function(t,s,i,l,c,u){e.setTransform(t,s,i,l,c,u),this.__originalSetTransform(t,s,i,l,c,u)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,l,c,u){e.bezierCurveTo(t,s,i,l,c,u),this.__originalBezierCurveTo(t,s,i,l,c,u)},n.rect=function(t,s,i,l){e.rect(t,s,i,l),this.__originalRect(t,s,i,l)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class KT{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function md(n,e,t,s,i,l,c,u,h,m){const[p,x,y,v,w,A]=Mt(n);if(x===0&&y===0){const E=c*p+w,C=Math.round(E),R=u*v+A,D=Math.round(R),O=(c+h)*p+w,H=Math.abs(Math.round(O)-C)||1,F=(u+m)*v+A,P=Math.abs(Math.round(F)-D)||1;return n.setTransform(Math.sign(p),0,0,Math.sign(v),C,D),n.drawImage(e,t,s,i,l,0,0,H,P),n.setTransform(p,x,y,v,w,A),[H,P]}if(p===0&&v===0){const E=u*y+w,C=Math.round(E),R=c*x+A,D=Math.round(R),O=(u+m)*y+w,H=Math.abs(Math.round(O)-C)||1,F=(c+h)*x+A,P=Math.abs(Math.round(F)-D)||1;return n.setTransform(0,Math.sign(x),Math.sign(y),0,C,D),n.drawImage(e,t,s,i,l,0,0,P,H),n.setTransform(p,x,y,v,w,A),[P,H]}n.drawImage(e,t,s,i,l,c,u,h,m);const N=Math.hypot(p,x),S=Math.hypot(y,v);return[N*h,S*m]}class Kb{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Xm;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=xs.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t){this.clipBox=new Float32Array([0,0,e,t]),this.minMax=qr.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=hs.FILL,t=null){const s=this.minMax.slice();if(e===hs.STROKE){t||yt("Stroke bounding box must include transform."),Me.singularValueDecompose2dScale(t,Ks);const i=Ks[0]*this.lineWidth/2,l=Ks[1]*this.lineWidth/2;s[0]-=i,s[1]-=l,s[2]+=i,s[3]+=l}return s}updateClipFromPath(){const e=Me.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(qr,0)}getClippedPathBoundingBox(e=hs.FILL,t=null){return Me.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Jb(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%Ps,l=(t-i)/Ps,c=i===0?l:l+1,u=n.createImageData(s,Ps);let h=0,m;const p=e.data,x=u.data;let y,v,w,A;if(e.kind===Rd.GRAYSCALE_1BPP){const N=p.byteLength,S=new Uint32Array(x.buffer,0,x.byteLength>>2),E=S.length,C=s+7>>3,R=4294967295,D=fs.isLittleEndian?4278190080:255;for(y=0;y<c;y++){for(w=y<l?Ps:i,m=0,v=0;v<w;v++){const O=N-h;let H=0;const F=O>C?s:O*8-7,P=F&-8;let Z=0,z=0;for(;H<P;H+=8)z=p[h++],S[m++]=z&128?R:D,S[m++]=z&64?R:D,S[m++]=z&32?R:D,S[m++]=z&16?R:D,S[m++]=z&8?R:D,S[m++]=z&4?R:D,S[m++]=z&2?R:D,S[m++]=z&1?R:D;for(;H<F;H++)Z===0&&(z=p[h++],Z=128),S[m++]=z&Z?R:D,Z>>=1}for(;m<E;)S[m++]=0;n.putImageData(u,0,y*Ps)}}else if(e.kind===Rd.RGBA_32BPP){for(v=0,A=s*Ps*4,y=0;y<l;y++)x.set(p.subarray(h,h+A)),h+=A,n.putImageData(u,0,v),v+=Ps;y<c&&(A=s*i*4,x.set(p.subarray(h,h+A)),n.putImageData(u,0,v))}else if(e.kind===Rd.RGB_24BPP)for(w=Ps,A=s*w,y=0;y<c;y++){for(y>=l&&(w=i,A=s*w),m=0,v=A;v--;)x[m++]=p[h++],x[m++]=p[h++],x[m++]=p[h++],x[m++]=255;n.putImageData(u,0,y*Ps)}else throw new Error(`bad image kind: ${e.kind}`)}function ev(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%Ps,l=(t-i)/Ps,c=i===0?l:l+1,u=n.createImageData(s,Ps);let h=0;const m=e.data,p=u.data;for(let x=0;x<c;x++){const y=x<l?Ps:i;({srcPos:h}=XT({src:m,srcPos:h,dest:p,width:s,height:y,nonBlackColor:0})),n.putImageData(u,0,x*Ps)}}function ro(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function pd(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function tv(n,e){if(e)return!0;Me.singularValueDecompose2dScale(n,Ks);const t=Math.fround(Wn.pixelRatio*Kr.PDF_TO_CSS_UNITS);return Ks[0]<=t&&Ks[1]<=t}const JT=["butt","round","square"],eD=["miter","round","bevel"],tD={},sv={};class Gr{constructor(e,t,s,i,l,{optionalContentConfig:c,markedContentStack:u=null},h,m){this.ctx=e,this.current=new Kb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new KT(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=m,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=u,s){const h=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Mt(this.compositeCtx))}this.ctx.save(),pd(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Mt(this.ctx)}executeOperatorList(e,t,s,i){const l=e.argsArray,c=e.fnArray;let u=t||0;const h=l.length;if(h===u)return u;const m=h-u>Zb&&typeof s=="function",p=m?Date.now()+QT:0;let x=0;const y=this.commonObjs,v=this.objs;let w;for(;;){if(i!==void 0&&u===i.nextBreakPoint)return i.breakIt(u,s),u;if(w=c[u],w!==$d.dependency)this[w].apply(this,l[u]);else for(const A of l[u]){const N=A.startsWith("g_")?y:v;if(!N.has(A))return N.get(A,s),u}if(u++,u===h)return u;if(m&&++x>Zb){if(Date.now()>p)return s(),u;x=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let l=Math.max(Math.hypot(t[0],t[1]),1),c=Math.max(Math.hypot(t[2],t[3]),1),u=s,h=i,m="prescale1",p,x;for(;l>2&&u>1||c>2&&h>1;){let y=u,v=h;l>2&&u>1&&(y=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/y),c>2&&h>1&&(v=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,c/=h/v),p=this.cachedCanvases.getCanvas(m,y,v),x=p.context,x.clearRect(0,0,y,v),x.drawImage(e,0,0,u,h,0,0,y,v),e=p.canvas,u=y,h=v,m=m==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:u,paintHeight:h}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,l=this.current.fillColor,c=this.current.patternFill,u=Mt(t);let h,m,p,x;if((e.bitmap||e.data)&&e.count>1){const P=e.bitmap||e.data.buffer;m=JSON.stringify(c?u:[u.slice(0,4),l]),h=this._cachedBitmapsMap.get(P),h||(h=new Map,this._cachedBitmapsMap.set(P,h));const Z=h.get(m);if(Z&&!c){const z=Math.round(Math.min(u[0],u[2])+u[4]),K=Math.round(Math.min(u[1],u[3])+u[5]);return{canvas:Z,offsetX:z,offsetY:K}}p=Z}p||(x=this.cachedCanvases.getCanvas("maskCanvas",s,i),ev(x.context,e));let y=Me.transform(u,[1/s,0,0,-1/i,0,0]);y=Me.transform(y,[1,0,0,1,0,-i]);const v=qr.slice();Me.axialAlignedBoundingBox([0,0,s,i],y,v);const[w,A,N,S]=v,E=Math.round(N-w)||1,C=Math.round(S-A)||1,R=this.cachedCanvases.getCanvas("fillCanvas",E,C),D=R.context,O=w,H=A;D.translate(-O,-H),D.transform(...y),p||(p=this._scaleImage(x.canvas,Un(D)),p=p.img,h&&c&&h.set(m,p)),D.imageSmoothingEnabled=tv(Mt(D),e.interpolate),md(D,p,0,0,p.width,p.height,0,0,s,i),D.globalCompositeOperation="source-in";const F=Me.transform(Un(D),[1,0,0,1,-O,-H]);return D.fillStyle=c?l.getPattern(t,this,F,hs.FILL):l,D.fillRect(0,0,s,i),h&&!c&&(this.cachedCanvases.delete("fillCanvas"),h.set(m,R.canvas)),{canvas:R.canvas,offsetX:Math.round(O),offsetY:Math.round(H)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=JT[e]}setLineJoin(e){this.ctx.lineJoin=eD[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx;const l=this.ctx=i.context;l.setTransform(this.suspendedCtx.getTransform()),ro(this.suspendedCtx,l),ZT(l,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ro(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const l=i[0],c=i[1],u=i[2]-l,h=i[3]-c;u===0||h===0||(this.genericComposeSMask(t.context,s,u,h,t.subtype,t.backdrop,t.transferMap,l,c,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,l,c,u,h,m,p,x){let y=e.canvas,v=h-p,w=m-x;if(c)if(v<0||w<0||v+s>y.width||w+i>y.height){const N=this.cachedCanvases.getCanvas("maskExtension",s,i),S=N.context;S.drawImage(y,-v,-w),S.globalCompositeOperation="destination-atop",S.fillStyle=c,S.fillRect(0,0,s,i),S.globalCompositeOperation="source-over",y=N.canvas,v=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const N=new Path2D;N.rect(v,w,s,i),e.clip(N),e.globalCompositeOperation="destination-atop",e.fillStyle=c,e.fillRect(v,w,s,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?t.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(u));const A=new Path2D;A.rect(h,m,s,i),t.clip(A),t.globalCompositeOperation="destination-in",t.drawImage(y,v,w,s,i,h,m,s,i),t.restore()}save(){this.inSMaskMode&&ro(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&ro(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,i,l,c){this.ctx.transform(e,t,s,i,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){let[i]=t;if(!s){i||=t[0]=new Path2D,this[e](i);return}if(!(i instanceof Path2D)){const l=t[0]=new Path2D;for(let c=0,u=i.length;c<u;)switch(i[c++]){case ud.moveTo:l.moveTo(i[c++],i[c++]);break;case ud.lineTo:l.lineTo(i[c++],i[c++]);break;case ud.curveTo:l.bezierCurveTo(i[c++],i[c++],i[c++],i[c++],i[c++],i[c++]);break;case ud.closePath:l.closePath();break;default:Ve(`Unrecognized drawing path operator: ${i[c-1]}`);break}i=l}Me.axialAlignedBoundingBox(s,Mt(this.ctx),this.current.minMax),this[e](i)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const s=this.ctx,i=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&i?.getPattern){const l=i.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=i.getPattern(s,this,Un(s),hs.STROKE),l){const c=new Path2D;c.addPath(e,s.getTransform().invertSelf().multiplySelf(l)),e=c}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(hs.STROKE,Mt(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const s=this.ctx,i=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const h=i.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.fillStyle=i.getPattern(s,this,Un(s),hs.FILL),h){const m=new Path2D;m.addPath(e,s.getTransform().invertSelf().multiplySelf(h)),e=m}c=!0}const u=this.current.getClippedPathBoundingBox();this.contentVisible&&u!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),c&&s.restore(),t&&this.consumePath(e,u)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=tD}eoClip(){this.pendingClip=sv}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const s=new Path2D,i=t.getTransform().invertSelf();for(const{transform:l,x:c,y:u,fontSize:h,path:m}of e)s.addPath(m,new DOMMatrix(l).preMultiplySelf(i).translate(c,u).scale(h,-h));t.clip(s),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||Xm,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Ve("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const l=s.loadedName||"sans-serif",c=s.systemFontInfo?.css||`"${l}", ${s.fallbackName}`;let u="normal";s.black?u="900":s.bold&&(u="bold");const h=s.italic?"italic":"normal";let m=t;t<Xb?m=Xb:t>Qb&&(m=Qb),this.current.fontSizeScale=t/m,this.ctx.font=`${h} ${u} ${m}px ${c}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#s(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i}paintChar(e,t,s,i,l){const c=this.ctx,u=this.current,h=u.font,m=u.textRenderingMode,p=u.fontSize/u.fontSizeScale,x=m&xs.FILL_STROKE_MASK,y=!!(m&xs.ADD_TO_PATH_FLAG),v=u.patternFill&&!h.missingFile,w=u.patternStroke&&!h.missingFile;let A;if((h.disableFontFace||y||v||w)&&(A=h.getPathGenerator(this.commonObjs,e)),h.disableFontFace||v||w){c.save(),c.translate(t,s),c.scale(p,-p);let N;if((x===xs.FILL||x===xs.FILL_STROKE)&&(i?(N=c.getTransform(),c.setTransform(...i),c.fill(this.#s(A,N,i))):c.fill(A)),x===xs.STROKE||x===xs.FILL_STROKE)if(l){N||=c.getTransform(),c.setTransform(...l);const{a:S,b:E,c:C,d:R}=N,D=Me.inverseTransform(l),O=Me.transform([S,E,C,R,0,0],D);Me.singularValueDecompose2dScale(O,Ks),c.lineWidth*=Math.max(Ks[0],Ks[1])/p,c.stroke(this.#s(A,N,l))}else c.lineWidth/=p,c.stroke(A);c.restore()}else(x===xs.FILL||x===xs.FILL_STROKE)&&c.fillText(e,t,s),(x===xs.STROKE||x===xs.FILL_STROKE)&&c.strokeText(e,t,s);y&&(this.pendingTextPaths||=[]).push({transform:Mt(c),x:t,y:s,fontSize:p,path:A})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return st(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const l=this.ctx,c=t.fontSizeScale,u=t.charSpacing,h=t.wordSpacing,m=t.fontDirection,p=t.textHScale*m,x=e.length,y=s.vertical,v=y?1:-1,w=s.defaultVMetrics,A=i*t.fontMatrix[0],N=t.textRenderingMode===xs.FILL&&!s.disableFontFace&&!t.patternFill;l.save(),t.textMatrix&&l.transform(...t.textMatrix),l.translate(t.x,t.y+t.textRise),m>0?l.scale(p,-1):l.scale(p,1);let S,E;if(t.patternFill){l.save();const H=t.fillColor.getPattern(l,this,Un(l),hs.FILL);S=Mt(l),l.restore(),l.fillStyle=H}if(t.patternStroke){l.save();const H=t.strokeColor.getPattern(l,this,Un(l),hs.STROKE);E=Mt(l),l.restore(),l.strokeStyle=H}let C=t.lineWidth;const R=t.textMatrixScale;if(R===0||C===0){const H=t.textRenderingMode&xs.FILL_STROKE_MASK;(H===xs.STROKE||H===xs.FILL_STROKE)&&(C=this.getSinglePixelWidth())}else C/=R;if(c!==1&&(l.scale(c,c),C/=c),l.lineWidth=C,s.isInvalidPDFjsFont){const H=[];let F=0;for(const P of e)H.push(P.unicode),F+=P.width;l.fillText(H.join(""),0,0),t.x+=F*A*p,l.restore(),this.compose();return}let D=0,O;for(O=0;O<x;++O){const H=e[O];if(typeof H=="number"){D+=v*H*i/1e3;continue}let F=!1;const P=(H.isSpace?h:0)+u,Z=H.fontChar,z=H.accent;let K,W,ce=H.width;if(y){const L=H.vmetric||w,q=-(H.vmetric?L[1]:ce*.5)*A,$=L[2]*A;ce=L?-L[0]:ce,K=q/c,W=(D+$)/c}else K=D/c,W=0;if(s.remeasure&&ce>0){const L=l.measureText(Z).width*1e3/i*c;if(ce<L&&this.isFontSubpixelAAEnabled){const q=ce/L;F=!0,l.save(),l.scale(q,1),K/=q}else ce!==L&&(K+=(ce-L)/2e3*i/c)}if(this.contentVisible&&(H.isInFont||s.missingFile)){if(N&&!z)l.fillText(Z,K,W);else if(this.paintChar(Z,K,W,S,E),z){const L=K+i*z.offset.x/c,q=W-i*z.offset.y/c;this.paintChar(z.fontChar,L,q,S,E)}}const me=y?ce*A-P*m:ce*A+P*m;D+=me,F&&l.restore()}y?t.y-=D:t.x+=D*p,l.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,l=s.fontSize,c=s.fontDirection,u=i.vertical?1:-1,h=s.charSpacing,m=s.wordSpacing,p=s.textHScale*c,x=s.fontMatrix||Xm,y=e.length,v=s.textRenderingMode===xs.INVISIBLE;let w,A,N,S;if(!(v||l===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),s.textMatrix&&t.transform(...s.textMatrix),t.translate(s.x,s.y+s.textRise),t.scale(p,c),w=0;w<y;++w){if(A=e[w],typeof A=="number"){S=u*A*l/1e3,this.ctx.translate(S,0),s.x+=S*p;continue}const E=(A.isSpace?m:0)+h,C=i.charProcOperatorList[A.operatorListId];C?this.contentVisible&&(this.save(),t.scale(l,l),t.transform(...x),this.executeOperatorList(C),this.restore()):Ve(`Type3 character "${A.operatorListId}" is not available.`);const R=[A.width,0];Me.applyTransform(R,x),N=R[0]*l+E,t.translate(N,0),s.x+=N*p}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,l,c){const u=new Path2D;u.rect(s,i,l-s,c-i),this.ctx.clip(u),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=this.baseTransform||Mt(this.ctx),i={createCanvasGraphics:l=>new Gr(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Vp(e,this.ctx,i,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=WT(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,Un(t),hs.SHADING);const i=Un(t);if(i){const{width:l,height:c}=t.canvas,u=qr.slice();Me.axialAlignedBoundingBox([0,0,l,c],i,u);const[h,m,p,x]=u;this.ctx.fillRect(h,m,p-h,x-m)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){yt("Should not call beginInlineImage")}beginImageData(){yt("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Mt(this.ctx),t)){Me.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[s,i,l,c]=t,u=new Path2D;u.rect(s,i,l-s,c-i),this.ctx.clip(u),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||vu("TODO: Support non-isolated groups."),e.knockout&&Ve("Knockout groups not supported.");const s=Mt(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=qr.slice();Me.axialAlignedBoundingBox(e.bbox,Mt(t),i);const l=[0,0,t.canvas.width,t.canvas.height];i=Me.intersect(i,l)||[0,0,0,0];const c=Math.floor(i[0]),u=Math.floor(i[1]),h=Math.max(Math.ceil(i[2])-c,1),m=Math.max(Math.ceil(i[3])-u,1);this.current.startNewPathAndClipBox([0,0,h,m]);let p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);const x=this.cachedCanvases.getCanvas(p,h,m),y=x.context;y.translate(-c,-u),y.transform(...s);let v=new Path2D;const[w,A,N,S]=e.bbox;if(v.rect(w,A,N-w,S-A),e.matrix){const E=new Path2D;E.addPath(v,new DOMMatrix(e.matrix)),v=E}y.clip(v),e.smask?this.smaskStack.push({canvas:x.canvas,context:y,offsetX:c,offsetY:u,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(c,u),t.save()),ro(t,y),this.ctx=y,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Mt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const l=qr.slice();Me.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i,l),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(e,t,s,i,l){if(this.#e(),pd(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const c=t[2]-t[0],u=t[3]-t[1];if(l&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=c,t[3]=u,Me.singularValueDecompose2dScale(Mt(this.ctx),Ks);const{viewportScale:h}=this,m=Math.ceil(c*this.outputScaleX*h),p=Math.ceil(u*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(m,p);const{canvas:x,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(e,x),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(Ks[0],0,0,-Ks[1],0,u*Ks[1]),pd(this.ctx)}else{pd(this.ctx),this.endPath();const h=new Path2D;h.rect(t[0],t[1],c,u),this.ctx.clip(h)}}this.current=new Kb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this._createMaskCanvas(e),l=i.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(l,i.offsetX,i.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,l,c){if(!this.contentVisible)return;e=this.getObject(e.data,e);const u=this.ctx;u.save();const h=Mt(u);u.transform(t,s,i,l,0,0);const m=this._createMaskCanvas(e);u.setTransform(1,0,0,1,m.offsetX-h[4],m.offsetY-h[5]);for(let p=0,x=c.length;p<x;p+=2){const y=Me.transform(h,[t,s,i,l,c[p],c[p+1]]);u.drawImage(m.canvas,y[4],y[5])}u.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const l of e){const{data:c,width:u,height:h,transform:m}=l,p=this.cachedCanvases.getCanvas("maskCanvas",u,h),x=p.context;x.save();const y=this.getObject(c,l);ev(x,y),x.globalCompositeOperation="source-in",x.fillStyle=i?s.getPattern(x,this,Un(t),hs.FILL):s,x.fillRect(0,0,u,h),x.restore(),t.save(),t.transform(...m),t.scale(1,-1),md(t,p.canvas,0,0,u,h,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Ve("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const l=this.getObject(e);if(!l){Ve("Dependent image isn't ready yet");return}const c=l.width,u=l.height,h=[];for(let m=0,p=i.length;m<p;m+=2)h.push({transform:[t,0,0,s,i[m],i[m+1]],x:0,y:0,w:c,h:u});this.paintInlineImageXObjectGroup(l,h)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,l=this.cachedCanvases.getCanvas("inlineImage",s,i),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(t,0,0),c.filter="none",l.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;this.save();const{filter:l}=i;l!=="none"&&l!==""&&(i.filter="none"),i.scale(1/t,-1/s);let c;if(e.bitmap)c=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)c=e;else{const m=this.cachedCanvases.getCanvas("inlineImage",t,s).context;Jb(m,e),c=this.applyTransferMapsToCanvas(m)}const u=this._scaleImage(c,Un(i));i.imageSmoothingEnabled=tv(Mt(i),e.interpolate),md(i,u.img,0,0,u.paintWidth,u.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const l=e.width,c=e.height,h=this.cachedCanvases.getCanvas("inlineImage",l,c).context;Jb(h,e),i=this.applyTransferMapsToCanvas(h)}for(const l of t)s.save(),s.transform(...l.transform),s.scale(1,-1),md(s,i,l.x,l.y,l.w,l.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(s||(this.pendingClip===sv?i.clip(e,"evenodd"):i.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Mt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:l}=this.ctx.getTransform();let c,u;if(s===0&&i===0){const h=Math.abs(t),m=Math.abs(l);if(h===m)if(e===0)c=u=1/h;else{const p=h*e;c=u=p<1?1/p:1}else if(e===0)c=1/h,u=1/m;else{const p=h*e,x=m*e;c=p<1?1/p:1,u=x<1?1/x:1}}else{const h=Math.abs(t*l-s*i),m=Math.hypot(t,s),p=Math.hypot(i,l);if(e===0)c=p/h,u=m/h;else{const x=e*h;c=p>x?p/x:1,u=m>x?m/x:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:i}}=this,[l,c]=this.getScaleForStroking();if(l===c){s.lineWidth=(i||1)*l,s.stroke(e);return}const u=s.getLineDash();t&&s.save(),s.scale(l,c),mm.a=1/l,mm.d=1/c;const h=new Path2D;if(h.addPath(e,mm),u.length>0){const m=Math.max(l,c);s.setLineDash(u.map(p=>p/m)),s.lineDashOffset/=m}s.lineWidth=i||1,s.stroke(h),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const n in $d)Gr.prototype[n]!==void 0&&(Gr.prototype[$d[n]]=Gr.prototype[n]);class Yr{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class sD{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const Hr=Symbol("INTERNAL");class nD{#e=!1;#t=!1;#s=!1;#n=!0;constructor(e,{name:t,intent:s,usage:i,rbGroups:l}){this.#e=!!(e&Zs.DISPLAY),this.#t=!!(e&Zs.PRINT),this.name=t,this.intent=s,this.usage=i,this.rbGroups=l}get visible(){if(this.#s)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,s=!1){e!==Hr&&yt("Internal method `_setVisible` called."),this.#s=s,this.#n=t}}class aD{#e=null;#t=new Map;#s=null;#n=null;constructor(e,t=Zs.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const s of e.groups)this.#t.set(s.id,new nD(t,s));if(e.baseState==="OFF")for(const s of this.#t.values())s._setVisible(Hr,!1);for(const s of e.on)this.#t.get(s)._setVisible(Hr,!0);for(const s of e.off)this.#t.get(s)._setVisible(Hr,!1);this.#s=this.getHash()}}#i(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const l=e[i];let c;if(Array.isArray(l))c=this.#i(l);else if(this.#t.has(l))c=this.#t.get(l).visible;else return Ve(`Optional content group not found: ${l}`),!0;switch(s){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return s==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return vu("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Ve(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#i(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Ve(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Ve(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Ve(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Ve(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Ve(`Unknown optional content policy ${e.policy}.`),!0}return Ve(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){const i=this.#t.get(e);if(!i){Ve(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const l of i.rbGroups)for(const c of l)c!==e&&this.#t.get(c)?._setVisible(Hr,!1,!0);i._setVisible(Hr,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const l=this.#t.get(i);if(l)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!l.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new v1;for(const[t,s]of this.#t)e.update(`${t}:${s.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class iD{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Xt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:l,progressiveDone:c,contentDispositionFilename:u}=e;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=u,l?.length>0){const h=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,m)=>{this._onReceiveData({begin:h,chunk:m})}),e.addProgressListener((h,m)=>{this._onProgress({loaded:h,total:m})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(l){return l._begin!==e?!1:(l._enqueue(s),!0)});Xt(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Xt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new rD(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new lD(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class rD{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=Ip(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class lD{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function oD(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let p=u(t);return p=unescape(p),p=h(p),p=m(p),l(p)}if(t=c(n),t){const p=m(t);return l(p)}if(t=s("filename","i").exec(n),t){t=t[1];let p=u(t);return p=m(p),l(p)}function s(p,x){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',x)}function i(p,x){if(p){if(!/^[\x00-\xFF]+$/.test(x))return x;try{const y=new TextDecoder(p,{fatal:!0}),v=Vo(x);x=y.decode(v),e=!1}catch{}}return x}function l(p){return e&&/[\x80-\xff]/.test(p)&&(p=i("utf-8",p),e&&(p=i("iso-8859-1",p))),p}function c(p){const x=[];let y;const v=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=v.exec(p))!==null;){let[,A,N,S]=y;if(A=parseInt(A,10),A in x){if(A===0)break;continue}x[A]=[N,S]}const w=[];for(let A=0;A<x.length&&A in x;++A){let[N,S]=x[A];S=u(S),N&&(S=unescape(S),A===0&&(S=h(S))),w.push(S)}return w.join("")}function u(p){if(p.startsWith('"')){const x=p.slice(1).split('\\"');for(let y=0;y<x.length;++y){const v=x[y].indexOf('"');v!==-1&&(x[y]=x[y].slice(0,v),x.length=y+1),x[y]=x[y].replaceAll(/\\(.)/g,"$1")}p=x.join('"')}return p}function h(p){const x=p.indexOf("'");if(x===-1)return p;const y=p.slice(0,x),w=p.slice(x+1).replace(/^[^']*'/,"");return i(y,w)}function m(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(x,y,v,w){if(v==="q"||v==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,N){return String.fromCharCode(parseInt(N,16))}),i(y,w);try{w=atob(w)}catch{}return i(y,w)})}return""}function _1(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function Nu(n){return URL.parse(n)?.origin??null}function C1({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(n.get("Content-Length"),10);return!Number.isInteger(l)||(i.suggestedLength=l,l<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function T1(n){const e=n.get("Content-Disposition");if(e){let t=oD(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Ip(t))return t}return null}function Wo(n,e){return new Gd(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function D1(n){return n===200||n===206}function R1(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function k1(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Ve(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class cD{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=_1(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Xt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new dD(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new uD(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class dD{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,R1(s,this._withCredentials,this._abortController)).then(l=>{if(e._responseOrigin=Nu(l.url),!D1(l.status))throw Wo(l.status,i);this._reader=l.body.getReader(),this._headersCapability.resolve();const c=l.headers,{allowRangeRequests:u,suggestedLength:h}=C1({responseHeaders:c,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=T1(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ka("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:k1(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class uD{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const l=new Headers(e.headers);l.append("Range",`bytes=${t}-${s-1}`);const c=i.url;fetch(c,R1(l,this._withCredentials,this._abortController)).then(u=>{const h=Nu(u.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!D1(u.status))throw Wo(u.status,c);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:k1(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const pm=200,gm=206;function hD(n){const e=n.response;return typeof e!="string"?e:Vo(e).buffer}class fD{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:s}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=_1(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[l,c]of this.headers)t.setRequestHeader(l,c);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=gm):i.expectedStatus=pm,t.responseType="arraybuffer",Xt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){const s=this.pendingRequests[e];s&&s.onProgress?.(t)}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const l=i.status||pm;if(!(l===pm&&s.expectedStatus===gm)&&l!==s.expectedStatus){s.onError(i.status);return}const u=hD(i);if(l===gm){const h=i.getResponseHeader("Content-Range"),m=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);m?s.onDone({begin:parseInt(m[1],10),chunk:u}):(Ve('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class mD{constructor(e){this._source=e,this._manager=new fD(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Xt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new pD(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new gD(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class pD{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Nu(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...m]=u.split(": ");return[h,m.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:c}=C1({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=T1(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Wo(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class gD{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=Nu(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=Wo(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const xD=/^[a-z][a-z0-9\-+.]+:/i;function yD(n){if(xD.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class bD{constructor(e){this.source=e,this.url=yD(e.url),Xt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Xt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new vD(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new wD(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class vD{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=Wo(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ka("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class wD{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const lo=Symbol("INITIAL_DATA");class M1{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:lo}}get(e,t=null){if(t){const i=this.#t(e);return i.promise.then(()=>t(i.data)),null}const s=this.#e[e];if(!s||s.data===lo)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=this.#e[e];return!!t&&t.data!==lo}delete(e){const t=this.#e[e];return!t||t.data===lo?!1:(delete this.#e[e],!0)}resolve(e,t=null){const s=this.#t(e);s.data=t,s.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==lo&&(yield[e,t])}}}const AD=1e5,nv=30;class As{#e=Promise.withResolvers();#t=null;#s=!1;#n=!!globalThis.FontInspector?.enabled;#i=null;#a=null;#l=0;#r=0;#u=null;#o=null;#h=0;#d=0;#f=Object.create(null);#m=[];#p=null;#c=[];#g=new WeakMap;#x=null;static#y=new Map;static#v=new Map;static#w=new WeakMap;static#A=null;static#j=new Set;constructor({textContentSource:e,container:t,viewport:s}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(h){h.enqueue(e),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#o=t,this.#d=s.scale*Wn.pixelRatio,this.#h=s.rotation,this.#a={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:l,pageX:c,pageY:u}=s.rawDims;this.#x=[1,0,0,-1,-c,u+l],this.#r=i,this.#l=l,As.#R(),Fi(t,s),this.#e.promise.finally(()=>{As.#j.delete(this),this.#a=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=fs.platform;return st(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#u.read().then(({value:t,done:s})=>{if(s){this.#e.resolve();return}this.#i??=t.lang,Object.assign(this.#f,t.styles),this.#_(t.items),e()},this.#e.reject)};return this.#u=this.#p.getReader(),As.#j.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const s=e.scale*Wn.pixelRatio,i=e.rotation;if(i!==this.#h&&(t?.(),this.#h=i,Fi(this.#o,{rotation:i})),s!==this.#d){t?.(),this.#d=s;const l={div:null,properties:null,ctx:As.#C(this.#i)};for(const c of this.#c)l.properties=this.#g.get(c),l.div=c,this.#N(l)}}cancel(){const e=new Ka("TextLayer task cancelled.");this.#u?.cancel(e).catch(()=>{}),this.#u=null,this.#e.reject(e)}get textDivs(){return this.#c}get textContentItemsStr(){return this.#m}#_(e){if(this.#s)return;this.#a.ctx??=As.#C(this.#i);const t=this.#c,s=this.#m;for(const i of e){if(t.length>AD){Ve("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){const l=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),i.id!==null&&this.#t.setAttribute("id",`${i.id}`),l.append(this.#t)}else i.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}s.push(i.str),this.#T(i)}}#T(e){const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#c.push(t);const i=Me.transform(this.#x,e.transform);let l=Math.atan2(i[1],i[0]);const c=this.#f[e.fontName];c.vertical&&(l+=Math.PI/2);let u=this.#n&&c.fontSubstitution||c.fontFamily;u=As.fontFamilyMap.get(u)||u;const h=Math.hypot(i[2],i[3]),m=h*As.#k(u,c,this.#i);let p,x;l===0?(p=i[4],x=i[5]-m):(p=i[4]+m*Math.sin(l),x=i[5]-m*Math.cos(l));const y="calc(var(--total-scale-factor) *",v=t.style;this.#t===this.#o?(v.left=`${(100*p/this.#r).toFixed(2)}%`,v.top=`${(100*x/this.#l).toFixed(2)}%`):(v.left=`${y}${p.toFixed(2)}px)`,v.top=`${y}${x.toFixed(2)}px)`),v.fontSize=`${y}${(As.#A*h).toFixed(2)}px)`,v.fontFamily=u,s.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=c.fontSubstitutionLoadedName||e.fontName),l!==0&&(s.angle=l*(180/Math.PI));let w=!1;if(e.str.length>1)w=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const A=Math.abs(e.transform[0]),N=Math.abs(e.transform[3]);A!==N&&Math.max(A,N)/Math.min(A,N)>1.5&&(w=!0)}if(w&&(s.canvasWidth=c.vertical?e.height:e.width),this.#g.set(t,s),this.#a.div=t,this.#a.properties=s,this.#N(this.#a),s.hasText&&this.#t.append(t),s.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),this.#t.append(A)}}#N(e){const{div:t,properties:s,ctx:i}=e,{style:l}=t;let c="";if(As.#A>1&&(c=`scale(${1/As.#A})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:u}=l,{canvasWidth:h,fontSize:m}=s;As.#E(i,m*this.#d,u);const{width:p}=i.measureText(t.textContent);p>0&&(c=`scaleX(${h*this.#d/p}) ${c}`)}s.angle!==0&&(c=`rotate(${s.angle}deg) ${c}`),c.length>0&&(l.transform=c)}static cleanup(){if(!(this.#j.size>0)){this.#y.clear();for(const{canvas:e}of this.#v.values())e.remove();this.#v.clear()}}static#C(e=null){let t=this.#v.get(e||="");if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(e,t),this.#w.set(t,{size:0,family:""})}return t}static#E(e,t,s){const i=this.#w.get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)}static#R(){if(this.#A!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#A=e.getBoundingClientRect().height,e.remove()}static#k(e,t,s){const i=this.#y.get(e);if(i)return i;const l=this.#C(s);l.canvas.width=l.canvas.height=nv,this.#E(l,nv,e);const c=l.measureText(""),u=c.fontBoundingBoxAscent,h=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let m=.8;return u?m=u/(u+h):(fs.platform.isFirefox&&Ve("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?m=t.ascent:t.descent&&(m=1+t.descent)),this.#y.set(e,m),m}}class Do{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(l){if(!l)return;let c=null;const u=l.name;if(u==="#text")c=l.value;else if(Do.shouldBuildText(u))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&t.push({str:c}),!!l.children)for(const h of l.children)i(h)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const ND=100;function SD(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new $p,{docId:t}=e,s=n.url?kT(n.url):null,i=n.data?MT(n.data):null,l=n.httpHeaders||null,c=n.withCredentials===!0,u=n.password??null,h=n.range instanceof L1?n.range:null,m=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let p=n.worker instanceof Ro?n.worker:null;const x=n.verbosity,y=typeof n.docBaseUrl=="string"&&!wu(n.docBaseUrl)?n.docBaseUrl:null,v=hd(n.cMapUrl),w=n.cMapPacked!==!1,A=n.CMapReaderFactory||(Ns?FT:$b),N=hd(n.iccUrl),S=hd(n.standardFontDataUrl),E=n.StandardFontDataFactory||(Ns?UT:Gb),C=hd(n.wasmUrl),R=n.WasmFactory||(Ns?qT:Yb),D=n.stopAtErrors!==!0,O=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,H=n.isEvalSupported!==!1,F=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Ns,P=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Ns&&(fs.platform.isFirefox||!globalThis.chrome),Z=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,z=typeof n.disableFontFace=="boolean"?n.disableFontFace:Ns,K=n.fontExtraProperties===!0,W=n.enableXfa===!0,ce=n.ownerDocument||globalThis.document,me=n.disableRange===!0,L=n.disableStream===!0,q=n.disableAutoFetch===!0,$=n.pdfBug===!0,I=n.CanvasFactory||(Ns?zT:IT),T=n.FilterFactory||(Ns?HT:BT),V=n.enableHWA===!0,M=n.useWasm!==!1,G=h?h.length:n.length??NaN,de=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Ns&&!z,re=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(A===$b&&E===Gb&&R===Yb&&v&&S&&C&&po(v,document.baseURI)&&po(S,document.baseURI)&&po(C,document.baseURI)),ye=null;dT(x);const je={canvasFactory:new I({ownerDocument:ce,enableHWA:V}),filterFactory:new T({docId:t,ownerDocument:ce}),cMapReaderFactory:re?null:new A({baseUrl:v,isCompressed:w}),standardFontDataFactory:re?null:new E({baseUrl:S}),wasmFactory:re?null:new R({baseUrl:C})};p||(p=Ro.create({verbosity:x,port:Yr.workerPort}),e._worker=p);const Le={docId:t,apiVersion:"5.3.93",data:i,password:u,disableAutoFetch:q,rangeChunkSize:m,length:G,docBaseUrl:y,enableXfa:W,evaluatorOptions:{maxImageSize:O,disableFontFace:z,ignoreErrors:D,isEvalSupported:H,isOffscreenCanvasSupported:F,isImageDecoderSupported:P,canvasMaxAreaInBytes:Z,fontExtraProperties:K,useSystemFonts:de,useWasm:M,useWorkerFetch:re,cMapUrl:v,iccUrl:N,standardFontDataUrl:S,wasmUrl:C}},he={ownerDocument:ce,pdfBug:$,styleElement:ye,loadingParams:{disableAutoFetch:q,enableXfa:W}};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const $e=p.messageHandler.sendWithPromise("GetDocRequest",Le,i?[i.buffer]:null);let ge;if(h)ge=new iD(h,{disableRange:me,disableStream:L});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");const we=po(s)?cD:Ns?bD:mD;ge=new we({url:s,length:G,httpHeaders:l,withCredentials:c,rangeChunkSize:m,disableRange:me,disableStream:L})}return $e.then(we=>{if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const ke=new go(t,we,p.port),te=new _D(ke,e,ge,he,je);e._transport=te,ke.send("Ready",null)})}).catch(e._capability.reject),e}class $p{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${$p.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class L1{#e=Promise.withResolvers();#t=[];#s=[];#n=[];#i=[];constructor(e,t,s=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i}addRangeListener(e){this.#i.push(e)}addProgressListener(e){this.#n.push(e)}addProgressiveReadListener(e){this.#s.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const s of this.#i)s(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const s of this.#n)s(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#s)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){yt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class jD{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return st(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class ED{#e=!1;constructor(e,t,s,i=!1){this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new Ub:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new M1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:l=!1}={}){return new Go({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:l})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return st(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=Ga.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:u=null,annotationCanvasMap:h=null,pageColors:m=null,printAnnotationStorage:p=null,isEditing:x=!1}){this._stats?.time("Overall");const y=this._transport.getRenderingIntent(s,i,p,x),{renderingIntent:v,cacheKey:w}=y;this.#e=!1,u||=this._transport.getOptionalContentConfig(v);let A=this._intentStates.get(w);A||(A=Object.create(null),this._intentStates.set(w,A)),A.streamReaderCancelTimeout&&(clearTimeout(A.streamReaderCancelTimeout),A.streamReaderCancelTimeout=null);const N=!!(v&Zs.PRINT);A.displayReadyCapability||(A.displayReadyCapability=Promise.withResolvers(),A.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(y));const S=R=>{A.renderTasks.delete(E),N&&(this.#e=!0),this.#t(),R?(E.capability.reject(R),this._abortOperatorList({intentState:A,reason:R instanceof Error?R:new Error(R)})):E.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},E=new Vr({callback:S,params:{canvasContext:e,viewport:t,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:A.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!N,pdfBug:this._pdfBug,pageColors:m});(A.renderTasks||=new Set).add(E);const C=E.task;return Promise.all([A.displayReadyCapability.promise,u]).then(([R,D])=>{if(this.destroyed){S();return}if(this._stats?.time("Rendering"),!(D.renderingIntent&v))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");E.initializeGraphics({transparency:R,optionalContentConfig:D}),E.operatorListChanged()}).catch(S),C}getOperatorList({intent:e="display",annotationMode:t=Ga.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const c=this._transport.getRenderingIntent(e,t,s,i,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Do.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function l(){c.read().then(function({value:h,done:m}){if(m){s(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),l()},i)}const c=t.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new Ub),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const s=this._intentStates.get(t);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:l,transfer:c}=s,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:l,modifiedIds:i},c).getReader(),m=this._intentStates.get(t);m.streamReader=h;const p=()=>{h.read().then(({value:x,done:y})=>{if(y){m.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(x,m),p())},x=>{if(m.streamReader=null,!this._transport.destroyed){if(m.operatorList){m.operatorList.lastChunk=!0;for(const y of m.renderTasks)y.operatorListChanged();this.#t()}if(m.displayReadyCapability)m.displayReadyCapability.reject(x);else if(m.opListReadCapability)m.opListReadCapability.reject(x);else throw x}})};p()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof Pp){let i=ND;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Ka(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,l]of this._intentStates)if(l===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}var Ya,Sn,ma,Mi,cu,Li,Oi,_s,kd,O1,P1,xo,Qr,Md;const _t=class _t{constructor({name:e=null,port:t=null,verbosity:s=uT()}={}){Hn(this,_s);Hn(this,Ya,Promise.withResolvers());Hn(this,Sn,null);Hn(this,ma,null);Hn(this,Mi,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(Et(_t,Oi).has(t))throw new Error("Cannot use more than one PDFWorker per port.");Et(_t,Oi).set(t,this),zn(this,_s,O1).call(this,t)}else zn(this,_s,P1).call(this)}get promise(){return Et(this,Ya).promise}get port(){return Et(this,ma)}get messageHandler(){return Et(this,Sn)}destroy(){this.destroyed=!0,Et(this,Mi)?.terminate(),Ls(this,Mi,null),Et(_t,Oi).delete(Et(this,ma)),Ls(this,ma,null),Et(this,Sn)?.destroy(),Ls(this,Sn,null)}static create(e){const t=Et(this,Oi).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new _t(e)}static get workerSrc(){if(Yr.workerSrc)return Yr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return st(this,"_setupFakeWorkerGlobal",(async()=>Et(this,Qr,Md)?Et(this,Qr,Md):(await import(this.workerSrc)).WorkerMessageHandler)())}};Ya=new WeakMap,Sn=new WeakMap,ma=new WeakMap,Mi=new WeakMap,cu=new WeakMap,Li=new WeakMap,Oi=new WeakMap,_s=new WeakSet,kd=function(){Et(this,Ya).resolve(),Et(this,Sn).send("configure",{verbosity:this.verbosity})},O1=function(e){Ls(this,ma,e),Ls(this,Sn,new go("main","worker",e)),Et(this,Sn).on("ready",()=>{}),zn(this,_s,kd).call(this)},P1=function(){if(Et(_t,Li)||Et(_t,Qr,Md)){zn(this,_s,xo).call(this);return}let{workerSrc:e}=_t;try{_t._isSameOrigin(window.location,e)||(e=_t._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new go("main","worker",t),i=()=>{l.abort(),s.destroy(),t.terminate(),this.destroyed?Et(this,Ya).reject(new Error("Worker was destroyed")):zn(this,_s,xo).call(this)},l=new AbortController;t.addEventListener("error",()=>{Et(this,Mi)||i()},{signal:l.signal}),s.on("test",u=>{if(l.abort(),this.destroyed||!u){i();return}Ls(this,Sn,s),Ls(this,ma,t),Ls(this,Mi,t),zn(this,_s,kd).call(this)}),s.on("ready",u=>{if(l.abort(),this.destroyed){i();return}try{c()}catch{zn(this,_s,xo).call(this)}});const c=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};c();return}catch{vu("The worker has been disabled.")}zn(this,_s,xo).call(this)},xo=function(){Et(_t,Li)||(Ve("Setting up fake worker."),Ls(_t,Li,!0)),_t._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){Et(this,Ya).reject(new Error("Worker was destroyed"));return}const t=new PT;Ls(this,ma,t);const s=`fake${lb(_t,cu)._++}`,i=new go(s+"_worker",s,t);e.setup(i,t),Ls(this,Sn,new go(s,s+"_worker",t)),zn(this,_s,kd).call(this)}).catch(e=>{Et(this,Ya).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Qr=new WeakSet,Md=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Hn(_t,Qr),Hn(_t,cu,0),Hn(_t,Li,!1),Hn(_t,Oi,new WeakMap),Ns&&(Ls(_t,Li,!0),Yr.workerSrc||="./pdf.worker.mjs"),_t._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!s?.origin||s.origin==="null")return!1;const i=new URL(t,s);return s.origin===i.origin},_t._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},_t.fromPort=e=>{if(NT("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return _t.create(e)};let Ro=_t;class _D{#e=new Map;#t=new Map;#s=new Map;#n=new Map;#i=null;constructor(e,t,s,i,l){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new M1,this.fontLoader=new DT({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#a(e,t=null){const s=this.#e.get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,i),i}get annotationStorage(){return st(this,"annotationStorage",new Fp)}getRenderingIntent(e,t=Ga.ENABLE,s=null,i=!1,l=!1){let c=Zs.DISPLAY,u=Km;switch(e){case"any":c=Zs.ANY;break;case"display":break;case"print":c=Zs.PRINT;break;default:Ve(`getRenderingIntent - invalid intent: ${e}`)}const h=c&Zs.PRINT&&s instanceof w1?s:this.annotationStorage;switch(t){case Ga.DISABLE:c+=Zs.ANNOTATIONS_DISABLE;break;case Ga.ENABLE:break;case Ga.ENABLE_FORMS:c+=Zs.ANNOTATIONS_FORMS;break;case Ga.ENABLE_STORAGE:c+=Zs.ANNOTATIONS_STORAGE,u=h.serializable;break;default:Ve(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(c+=Zs.IS_EDITING),l&&(c+=Zs.OPLIST);const{ids:m,hash:p}=h.modifiedIds,x=[c,u.hash,p];return{renderingIntent:c,cacheKey:x.join("_"),annotationStorageSerializable:u,modifiedIds:m}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#i?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of this.#t.values())e.push(s._destroy());this.#t.clear(),this.#s.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),As.cleanup(),this._networkStream?.cancelAllRequests(new Ka("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{Xt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},i.onPull=()=>{this._fullReader.read().then(function({value:l,done:c}){if(c){i.close();return}Xt(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{i.error(l)})},i.onCancel=l=>{this._fullReader.cancel(l),i.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:l,contentLength:c}=this._fullReader;return(!i||!l)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{t.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:i,isRangeSupported:l,contentLength:c}}),e.on("GetRangeReader",(s,i)=>{Xt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(s.begin,s.end);if(!l){i.close();return}i.onPull=()=>{l.read().then(function({value:c,done:u}){if(u){i.close();return}Xt(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{i.error(c)})},i.onCancel=c=>{l.cancel(c),i.ready.catch(u=>{if(!this.destroyed)throw u})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new jD(s,this))}),e.on("DocException",s=>{t._capability.reject(Os(s))}),e.on("PasswordRequest",s=>{this.#i=Promise.withResolvers();try{if(!t.onPassword)throw Os(s);const i=l=>{l instanceof Error?this.#i.reject(l):this.#i.resolve({password:l})};t.onPassword(i,s.code)}catch(i){this.#i.reject(i)}return this.#i.promise}),e.on("DataLoaded",s=>{t.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;this.#t.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,l])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":if("error"in l){const m=l.error;Ve(`Error during font loading: ${m}`),this.commonObjs.resolve(s,m);break}const c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(m,p)=>globalThis.FontInspector.fontAdded(m,p):null,u=new RT(l,c);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!u.fontExtraProperties&&u.data&&(u.data=null),this.commonObjs.resolve(s,u)});break;case"CopyLocalImage":const{imageRef:h}=l;Xt(h,"The imageRef must be defined.");for(const m of this.#t.values())for(const[,p]of m.objs)if(p?.ref===h)return p.dataLen?(this.commonObjs.resolve(s,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,l);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,l,c])=>{if(this.destroyed)return;const u=this.#t.get(i);if(!u.objs.has(s)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(s,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),e.on("DocProgress",s=>{this.destroyed||t.onProgress?.({loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[s.type];if(!i)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ve("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=this.#s.get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#n.set(l.refStr,e);const c=new ED(t,l,this,this._params.pdfBug);return this.#t.set(t,c),c});return this.#s.set(t,i),i}getPageIndex(e){return Jm(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#a("GetFieldObjects")}hasJSActions(){return this.#a("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#a("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#a("GetOptionalContentConfig").then(t=>new aD(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new sD(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),As.cleanup()}}cachedPageNumber(e){if(!Jm(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#n.get(t)??null}}class CD{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class Vr{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:l,operatorList:c,pageIndex:u,canvasFactory:h,filterFactory:m,useRequestAnimationFrame:p=!1,pdfBug:x=!1,pageColors:y=null}){this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=m,this._pdfBug=x,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new CD(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(Vr.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Vr.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:l,background:c}=this.params;this.gfx=new Gr(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:l,viewport:i,transparency:e,background:c}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),Vr.#t.delete(this._canvas),e||=new Pp(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Vr.#t.delete(this._canvas),this.callback())))}}const I1="5.3.93",TD="cbeef3233";function av(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function oo(n){return Math.max(0,Math.min(255,255*n))}class iv{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=oo(e),[e,e,e]}static G_HTML([e]){const t=av(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(oo)}static RGB_HTML(e){return`#${e.map(av).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[oo(1-Math.min(1,e+i)),oo(1-Math.min(1,s+i)),oo(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,l=1-t,c=1-s,u=Math.min(i,l,c);return["CMYK",i,l,c,u]}}class DD{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){yt("Abstract method `_createSVG` called.")}}class Yd extends DD{_createSVG(e){return document.createElementNS(ha,e)}}class B1{static setupStorage(e,t,s,i,l){const c=i.getValue(t,{value:null});switch(s.name){case"textarea":if(c.value!==null&&(e.textContent=c.value),l==="print")break;e.addEventListener("input",u=>{i.setValue(t,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(c.value===s.attributes.xfaOn?e.setAttribute("checked",!0):c.value===s.attributes.xfaOff&&e.removeAttribute("checked"),l==="print")break;e.addEventListener("change",u=>{i.setValue(t,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&e.setAttribute("value",c.value),l==="print")break;e.addEventListener("input",u=>{i.setValue(t,{value:u.target.value})})}break;case"select":if(c.value!==null){e.setAttribute("value",c.value);for(const u of s.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}e.addEventListener("input",u=>{const h=u.target.options,m=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(t,{value:m})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:l}){const{attributes:c}=t,u=e instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${i}`);for(const[h,m]of Object.entries(c))if(m!=null)switch(h){case"class":m.length&&e.setAttribute(h,m.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",m);break;case"style":Object.assign(e.style,m);break;case"textContent":e.textContent=m;break;default:(!u||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,m)}u&&l.addLinkAttributes(e,c.href,c.newWindow),s&&c.dataId&&this.setupStorage(e,c.dataId,t,s)}static render(e){const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,l=e.intent||"display",c=document.createElement(i.name);i.attributes&&this.setAttributes({html:c,element:i,intent:l,linkService:s});const u=l!=="richText",h=e.div;if(h.append(c),e.viewport){const x=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=x}u&&h.setAttribute("class","xfaLayer xfaFont");const m=[];if(i.children.length===0){if(i.value){const x=document.createTextNode(i.value);c.append(x),u&&Do.shouldBuildText(i.name)&&m.push(x)}return{textDivs:m}}const p=[[i,-1,c]];for(;p.length>0;){const[x,y,v]=p.at(-1);if(y+1===x.children.length){p.pop();continue}const w=x.children[++p.at(-1)[1]];if(w===null)continue;const{name:A}=w;if(A==="#text"){const S=document.createTextNode(w.value);m.push(S),v.append(S);continue}const N=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,A):document.createElement(A);if(v.append(N),w.attributes&&this.setAttributes({html:N,element:w,storage:t,intent:l,linkService:s}),w.children?.length>0)p.push([w,-1,N]);else if(w.value){const S=document.createTextNode(w.value);u&&Do.shouldBuildText(A)&&m.push(S),N.append(S)}}for(const x of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))x.setAttribute("readOnly",!0);return{textDivs:m}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const RD=9,Ui=new WeakSet;class rv{static create(e){switch(e.data.annotationType){case Yt.LINK:return new H1(e);case Yt.TEXT:return new kD(e);case Yt.WIDGET:switch(e.data.fieldType){case"Tx":return new MD(e);case"Btn":return e.data.radioButton?new z1(e):e.data.checkBox?new OD(e):new PD(e);case"Ch":return new ID(e);case"Sig":return new LD(e)}return new Gi(e);case Yt.POPUP:return new tp(e);case Yt.FREETEXT:return new F1(e);case Yt.LINE:return new HD(e);case Yt.SQUARE:return new zD(e);case Yt.CIRCLE:return new FD(e);case Yt.POLYLINE:return new U1(e);case Yt.CARET:return new qD(e);case Yt.INK:return new Gp(e);case Yt.POLYGON:return new UD(e);case Yt.HIGHLIGHT:return new q1(e);case Yt.UNDERLINE:return new VD(e);case Yt.SQUIGGLY:return new $D(e);case Yt.STRIKEOUT:return new GD(e);case Yt.STAMP:return new V1(e);case Yt.FILEATTACHMENT:return new YD(e);default:return new Ut(e)}}}class Ut{#e=null;#t=!1;#s=null;constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ut._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#n(t),this.#s?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#s?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:u,pageY:h}}}}=this;s?.splice(0,4,...e),t.left=`${100*(e[0]-u)/l}%`,t.top=`${100*(c-e[3]+h)/c}%`,i===0?(t.width=`${100*(e[2]-e[0])/l}%`,t.height=`${100*(e[3]-e[1])/c}%`):this.setRotation(i)}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",t.id),this instanceof Gi||(l.tabIndex=0);const{style:c}=l;if(c.zIndex=this.parent.zIndex++,t.alternativeText&&(l.title=t.alternativeText),t.noRotate&&l.classList.add("norotate"),!t.rect||this instanceof tp){const{rotation:A}=t;return!t.hasOwnCanvas&&A!==0&&this.setRotation(A,l),l}const{width:u,height:h}=this;if(!e&&t.borderStyle.width>0){c.borderWidth=`${t.borderStyle.width}px`;const A=t.borderStyle.horizontalCornerRadius,N=t.borderStyle.verticalCornerRadius;if(A>0||N>0){const E=`calc(${A}px * var(--total-scale-factor)) / calc(${N}px * var(--total-scale-factor))`;c.borderRadius=E}else if(this instanceof z1){const E=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;c.borderRadius=E}switch(t.borderStyle.style){case Br.SOLID:c.borderStyle="solid";break;case Br.DASHED:c.borderStyle="dashed";break;case Br.BEVELED:Ve("Unimplemented border style: beveled");break;case Br.INSET:Ve("Unimplemented border style: inset");break;case Br.UNDERLINE:c.borderBottomStyle="solid";break}const S=t.borderColor||null;S?(this.#t=!0,c.borderColor=Me.makeHexColor(S[0]|0,S[1]|0,S[2]|0)):c.borderWidth=0}const m=Me.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:p,pageHeight:x,pageX:y,pageY:v}=i.rawDims;c.left=`${100*(m[0]-y)/p}%`,c.top=`${100*(m[1]-v)/x}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(c.width=`${100*u/p}%`,c.height=`${100*h/x}%`):this.setRotation(w,l),l}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims;let{width:l,height:c}=this;e%180!==0&&([l,c]=[c,l]),t.style.width=`${100*l/s}%`,t.style.height=`${100*c/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const l=i.detail[t],c=l[0],u=l.slice(1);i.target.style[s]=iv[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:iv[`${c}_rgb`](u)})};return st(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail))(e[i]||s[i])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,l]of Object.entries(t)){const c=s[i];if(c){const u={detail:{[i]:l},target:e};c(u),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,l]=this.data.rect.map(A=>Math.fround(A));if(e.length===8){const[A,N,S,E]=e.subarray(2,6);if(i===A&&l===N&&t===S&&s===E)return}const{style:c}=this.container;let u;if(this.#t){const{borderColor:A,borderWidth:N}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${A}" stroke-width="${N}">`],this.container.classList.add("hasBorder")}const h=i-t,m=l-s,{svgFactory:p}=this,x=p.createElement("svg");x.classList.add("quadrilateralsContainer"),x.setAttribute("width",0),x.setAttribute("height",0),x.role="none";const y=p.createElement("defs");x.append(y);const v=p.createElement("clipPath"),w=`clippath_${this.data.id}`;v.setAttribute("id",w),v.setAttribute("clipPathUnits","objectBoundingBox"),y.append(v);for(let A=2,N=e.length;A<N;A+=8){const S=e[A],E=e[A+1],C=e[A+2],R=e[A+3],D=p.createElement("rect"),O=(C-t)/h,H=(l-E)/m,F=(S-C)/h,P=(E-R)/m;D.setAttribute("x",O),D.setAttribute("y",H),D.setAttribute("width",F),D.setAttribute("height",P),v.append(D),u?.push(`<rect vector-effect="non-scaling-stroke" x="${O}" y="${H}" width="${F}" height="${P}"/>`)}this.#t&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(x),this.container.style.clipPath=`url(#${w})`}_createPopup(){const{data:e}=this,t=this.#s=new tp({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){yt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:l,id:c,exportValues:u}of i){if(l===-1||c===t)continue;const h=typeof u=="string"?u:null,m=document.querySelector(`[data-element-id="${c}"]`);if(m&&!Ui.has(m)){Ve(`_getElementsByName - element not allowed: ${c}`);continue}s.push({id:c,exportValue:h,domElement:m})}return s}for(const i of document.getElementsByName(e)){const{exportValue:l}=i,c=i.getAttribute("data-element-id");c!==t&&Ui.has(i)&&s.push({id:c,exportValue:l,domElement:i})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class H1 extends Ut{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(s,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(s,e.action),i=!0):e.attachment?(this.#t(s,e.attachment,e.attachmentDest),i=!0):e.setOCGState?(this.#s(s,e.setOCGState),i=!0):e.dest?(this._bindLink(s,e.dest),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),i=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(s,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(s),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,s=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,s),!1),this.#e()}#s(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const l=s.get(i);l&&(e[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Ve('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(e.onclick=()=>!1);return}e.onclick=()=>{s?.();const{fields:i,refs:l,include:c}=t,u=[];if(i.length!==0||l.length!==0){const p=new Set(l);for(const x of i){const y=this._fieldObjects[x]||[];for(const{id:v}of y)p.add(v)}for(const x of Object.values(this._fieldObjects))for(const y of x)p.has(y.id)===c&&u.push(y)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const h=this.annotationStorage,m=[];for(const p of u){const{id:x}=p;switch(m.push(x),p.type){case"text":{const v=p.defaultValue||"";h.setValue(x,{value:v});break}case"checkbox":case"radiobutton":{const v=p.defaultValue===p.exportValues;h.setValue(x,{value:v});break}case"combobox":case"listbox":{const v=p.defaultValue||"";h.setValue(x,{value:v});break}default:continue}const y=document.querySelector(`[data-element-id="${x}"]`);if(y){if(!Ui.has(y)){Ve(`_bindResetFormAction - element not allowed: ${x}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:m,name:"ResetForm"}}),!1}}}class kD extends Ut{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Gi extends Ut{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return fs.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,l){s.includes("mouse")?e.addEventListener(s,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):e.addEventListener(s,c=>{if(s==="blur"){if(!t.focused||!c.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:l(c)}})})}_setEventListeners(e,t,s,i){for(const[l,c]of s)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,l,c,i),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Me.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||RD,l=e.style;let c;const u=2,h=m=>Math.round(10*m)/10;if(this.data.multiLine){const m=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(m/(cm*i))||1,x=m/p;c=Math.min(i,h(x/cm))}else{const m=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(i,h(m/cm))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=Me.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(l.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class MD extends Gi{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const l=this.annotationStorage;for(const c of this._getElementsByName(e.name,e.id))c.domElement&&(c.domElement[t]=s),l.setValue(c.id,{[i]:s})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const i=e.getValue(t,{value:this.data.fieldValue});let l=i.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=i.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??l,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??l),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Ui.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const m=this.data.dateFormat||this.data.timeFormat;m&&(s.title=m),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",x=>{e.setValue(t,{value:x.target.value}),this.setPropertyOnSiblings(s,"value",x.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",x=>{const y=this.data.defaultFieldValue??"";s.value=h.userValue=y,h.formattedValue=null});let p=x=>{const{formattedValue:y}=h;y!=null&&(x.target.value=y),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",y=>{if(h.focused)return;const{target:v}=y;h.userValue&&(v.value=h.userValue),h.lastCommittedValue=v.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",y=>{this.showElementAndHideCanvas(y.target);const v={value(w){h.userValue=w.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),w.target.value=h.userValue},formattedValue(w){const{formattedValue:A}=w.detail;h.formattedValue=A,A!=null&&w.target!==document.activeElement&&(w.target.value=A),e.setValue(t,{formattedValue:A})},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{const{charLimit:A}=w.detail,{target:N}=w;if(A===0){N.removeAttribute("maxLength");return}N.setAttribute("maxLength",A);let S=h.userValue;!S||S.length<=A||(S=S.slice(0,A),N.value=h.userValue=S,e.setValue(t,{value:S}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,willCommit:!0,commitKey:1,selStart:N.selectionStart,selEnd:N.selectionEnd}}))}};this._dispatchEventFromSandbox(v,y)}),s.addEventListener("keydown",y=>{h.commitKey=1;let v=-1;if(y.key==="Escape"?v=0:y.key==="Enter"&&!this.data.multiLine?v=2:y.key==="Tab"&&(h.commitKey=3),v===-1)return;const{value:w}=y.target;h.lastCommittedValue!==w&&(h.lastCommittedValue=w,h.userValue=w,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:v,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}))});const x=p;p=null,s.addEventListener("blur",y=>{if(!h.focused||!y.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{value:v}=y.target;h.userValue=v,h.lastCommittedValue!==v&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:h.commitKey,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}),x(y)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",y=>{h.lastCommittedValue=null;const{data:v,target:w}=y,{value:A,selectionStart:N,selectionEnd:S}=w;let E=N,C=S;switch(y.inputType){case"deleteWordBackward":{const R=A.substring(0,N).match(/\w*[^\w]*$/);R&&(E-=R[0].length);break}case"deleteWordForward":{const R=A.substring(N).match(/^[^\w]*\w*/);R&&(C+=R[0].length);break}case"deleteContentBackward":N===S&&(E-=1);break;case"deleteContentForward":N===S&&(C+=1);break}y.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,change:v||"",willCommit:!1,selStart:E,selEnd:C}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],y=>y.target.value)}if(p&&s.addEventListener("blur",p),this.data.comb){const y=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${y}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class LD extends Gi{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class OD extends Gi{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return Ui.add(l),l.setAttribute("data-element-id",s),l.disabled=t.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=t.fieldName,i&&l.setAttribute("checked",!0),l.setAttribute("exportValue",t.exportValue),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const m of this._getElementsByName(u,s)){const p=h&&m.exportValue===t.exportValue;m.domElement&&(m.domElement.checked=p),e.setValue(m.id,{value:p})}e.setValue(s,{value:h})}),l.addEventListener("resetform",c=>{const u=t.defaultFieldValue||"Off";c.target.checked=u===t.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const u={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class z1 extends Gi{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const c of this._getElementsByName(t.fieldName,s))e.setValue(c.id,{value:!1});const l=document.createElement("input");if(Ui.add(l),l.setAttribute("data-element-id",s),l.disabled=t.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=t.fieldName,i&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:h}=c.target;for(const m of this._getElementsByName(u,s))e.setValue(m.id,{value:!1});e.setValue(s,{value:h})}),l.addEventListener("resetform",c=>{const u=t.defaultFieldValue;c.target.checked=u!=null&&u===t.buttonValue}),this.enableScripting&&this.hasJSActions){const c=t.buttonValue;l.addEventListener("updatefromsandbox",u=>{const h={value:m=>{const p=c===m.detail.value;for(const x of this._getElementsByName(m.target.name)){const y=p&&x.id===s;x.domElement&&(x.domElement.checked=y),e.setValue(x.id,{value:y})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class PD extends H1{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class ID extends Gi{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Ui.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",p=>{const x=this.data.defaultFieldValue;for(const y of i.options)y.selected=y.value===x});for(const p of this.data.options){const x=document.createElement("option");x.textContent=p.displayValue,x.value=p.exportValue,s.value.includes(p.exportValue)&&(x.setAttribute("selected",!0),l=!1),i.append(x)}let c=null;if(l){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),i.prepend(p),c=()=>{p.remove(),i.removeEventListener("input",c),c=null},i.addEventListener("input",c)}const u=p=>{const x=p?"value":"textContent",{options:y,multiple:v}=i;return v?Array.prototype.filter.call(y,w=>w.selected).map(w=>w[x]):y.selectedIndex===-1?null:y[y.selectedIndex][x]};let h=u(!1);const m=p=>{const x=p.target.options;return Array.prototype.map.call(x,y=>({displayValue:y.textContent,exportValue:y.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",p=>{const x={value(y){c?.();const v=y.detail.value,w=new Set(Array.isArray(v)?v:[v]);for(const A of i.options)A.selected=w.has(A.value);e.setValue(t,{value:u(!0)}),h=u(!1)},multipleSelection(y){i.multiple=!0},remove(y){const v=i.options,w=y.detail.remove;v[w].selected=!1,i.remove(w),v.length>0&&Array.prototype.findIndex.call(v,N=>N.selected)===-1&&(v[0].selected=!0),e.setValue(t,{value:u(!0),items:m(y)}),h=u(!1)},clear(y){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),h=u(!1)},insert(y){const{index:v,displayValue:w,exportValue:A}=y.detail.insert,N=i.children[v],S=document.createElement("option");S.textContent=w,S.value=A,N?N.before(S):i.append(S),e.setValue(t,{value:u(!0),items:m(y)}),h=u(!1)},items(y){const{items:v}=y.detail;for(;i.length!==0;)i.remove(0);for(const w of v){const{displayValue:A,exportValue:N}=w,S=document.createElement("option");S.textContent=A,S.value=N,i.append(S)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:u(!0),items:m(y)}),h=u(!1)},indices(y){const v=new Set(y.detail.indices);for(const w of y.target.options)w.selected=v.has(w.index);e.setValue(t,{value:u(!0)}),h=u(!1)},editable(y){y.target.disabled=!y.detail.editable}};this._dispatchEventFromSandbox(x,p)}),i.addEventListener("input",p=>{const x=u(!0),y=u(!1);e.setValue(t,{value:x}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:y,changeEx:x,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):i.addEventListener("input",function(p){e.setValue(t,{value:u(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class tp extends Ut{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:Ut._hasPopupData(t)}),this.elements=s,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new BD({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),s=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",s.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(i=>`${Op}${i}`).join(",")),this.container}}class BD{#e=this.#_.bind(this);#t=this.#E.bind(this);#s=this.#C.bind(this);#n=this.#N.bind(this);#i=null;#a=null;#l=null;#r=null;#u=null;#o=null;#h=null;#d=!1;#f=null;#m=null;#p=null;#c=null;#g=null;#x=null;#y=!1;constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:l,contentsObj:c,richText:u,parent:h,rect:m,parentRect:p,open:x}){this.#a=e,this.#g=i,this.#l=c,this.#c=u,this.#o=h,this.#i=t,this.#p=m,this.#h=p,this.#u=s,this.#r=y1.toDateObject(l),this.trigger=s.flatMap(y=>y.getElementsToTriggerPopup());for(const y of this.trigger)y.addEventListener("click",this.#n),y.addEventListener("mouseenter",this.#s),y.addEventListener("mouseleave",this.#t),y.classList.add("popupTriggerArea");for(const y of s)y.container?.addEventListener("keydown",this.#e);this.#a.hidden=!0,x&&this.#N()}render(){if(this.#f)return;const e=this.#f=document.createElement("div");if(e.className="popup",this.#i){const l=e.style.outlineColor=Me.makeHexColor(...this.#i);e.style.backgroundColor=`color-mix(in srgb, ${l} 30%, white)`}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=this.#g,e.append(t),this.#r){const l=document.createElement("time");l.classList.add("popupDate"),l.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),l.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#r.valueOf()})),l.dateTime=this.#r.toISOString(),t.append(l)}const i=this.#v;if(i)B1.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const l=this._formatContents(this.#l);e.append(l)}this.#a.append(e)}get#v(){const e=this.#c,t=this.#l;return e?.str&&(!t?.str||t.str===e.str)&&this.#c.html||null}get#w(){return this.#v?.attributes?.style?.fontSize||0}get#A(){return this.#v?.attributes?.style?.color||null}#j(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:this.#A,fontSize:this.#w?`calc(${this.#w}px * var(--total-scale-factor))`:""}};for(const l of e.split(`
`))t.push({name:"span",value:l,attributes:i});return s}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let l=0,c=i.length;l<c;++l){const u=i[l];s.append(document.createTextNode(u)),l<c-1&&s.append(document.createElement("br"))}return s}#_(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#d)&&this.#N()}updateEdited({rect:e,popupContent:t}){this.#x||={contentsObj:this.#l,richText:this.#c},e&&(this.#m=null),t&&(this.#c=this.#j(t),this.#l=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#x&&({contentsObj:this.#l,richText:this.#c}=this.#x,this.#x=null,this.#f?.remove(),this.#f=null,this.#m=null)}#T(){if(this.#m!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:l}}}=this.#o;let c=!!this.#h,u=c?this.#h:this.#p;for(const w of this.#u)if(!u||Me.intersect(w.data.rect,u)!==null){u=w.data.rect,c=!0;break}const h=Me.normalizeRect([u[0],e[3]-u[1]+e[1],u[2],e[3]-u[3]+e[1]]),p=c?u[2]-u[0]+5:0,x=h[0]+p,y=h[1];this.#m=[100*(x-i)/t,100*(y-l)/s];const{style:v}=this.#a;v.left=`${this.#m[0]}%`,v.top=`${this.#m[1]}%`}#N(){this.#d=!this.#d,this.#d?(this.#C(),this.#a.addEventListener("click",this.#n),this.#a.addEventListener("keydown",this.#e)):(this.#E(),this.#a.removeEventListener("click",this.#n),this.#a.removeEventListener("keydown",this.#e))}#C(){this.#f||this.render(),this.isVisible?this.#d&&this.#a.classList.add("focused"):(this.#T(),this.#a.hidden=!1,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)+1e3)}#E(){this.#a.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#a.hidden=!0,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)-1e3)}forceHide(){this.#y=this.isVisible,this.#y&&(this.#a.hidden=!0)}maybeShow(){this.#y&&(this.#f||this.#C(),this.#y=!1,this.#a.hidden=!1)}get isVisible(){return this.#a.hidden===!1}}class F1 extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=qe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class HD extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:s}=this,i=this.svgFactory.create(t,s,!0),l=this.#e=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),l.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),l.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),l.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),l.setAttribute("stroke-width",e.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class zD extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:s}=this,i=this.svgFactory.create(t,s,!0),l=e.borderStyle.width,c=this.#e=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",t-l),c.setAttribute("height",s-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),i.append(c),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class FD extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:s}=this,i=this.svgFactory.create(t,s,!0),l=e.borderStyle.width,c=this.#e=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",t/2),c.setAttribute("cy",s/2),c.setAttribute("rx",t/2-l/2),c.setAttribute("ry",s/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),i.append(c),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class U1 extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:s,popupRef:i},width:l,height:c}=this;if(!t)return this.container;const u=this.svgFactory.create(l,c,!0);let h=[];for(let p=0,x=t.length;p<x;p+=2){const y=t[p]-e[0],v=e[3]-t[p+1];h.push(`${y},${v}`)}h=h.join(" ");const m=this.#e=this.svgFactory.createElement(this.svgElementName);return m.setAttribute("points",h),m.setAttribute("stroke-width",s.width||1),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),u.append(m),this.container.append(u),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class UD extends U1{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class qD extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Gp extends Ut{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?qe.HIGHLIGHT:qe.INK}#s(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:s,borderStyle:i,popupRef:l}}=this,{transform:c,width:u,height:h}=this.#s(t,e),m=this.svgFactory.create(u,h,!0),p=this.#e=this.svgFactory.createElement("svg:g");m.append(p),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",c);for(let x=0,y=s.length;x<y;x++){const v=this.svgFactory.createElement(this.svgElementName);this.#t.push(v),v.setAttribute("points",s[x].join(",")),p.append(v)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(m),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:s,rect:i}=e,l=this.#e;if(t>=0&&l.setAttribute("stroke-width",t||1),s)for(let c=0,u=this.#t.length;c<u;c++)this.#t[c].setAttribute("points",s[c].join(","));if(i){const{transform:c,width:u,height:h}=this.#s(this.data.rotation,i);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class q1 extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=qe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class VD extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class $D extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class GD extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class V1 extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=qe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class YD extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let s;t.hasAppearance||t.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#t.bind(this)),this.#e=s;const{isMac:i}=fs.platform;return e.addEventListener("keydown",l=>{l.key==="Enter"&&(i?l.metaKey:l.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Yp{#e=null;#t=null;#s=new Map;#n=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:l,viewport:c,structTreeLayer:u}){this.div=e,this.#e=t,this.#t=s,this.#n=u||null,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#s.size>0}async#i(e,t,s){const i=e.firstChild||e,l=i.id=`${Op}${t}`,c=await this.#n?.getAriaAttributes(l);if(c)for(const[u,h]of c)i.setAttribute(u,h);s?s.at(-1).container.after(e):(this.div.append(e),this.#e?.moveElementInDOM(this.div,e,i,!1))}async render(e){const{annotations:t}=e,s=this.div;Fi(s,this.viewport);const i=new Map,l={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Yd,annotationStorage:e.annotationStorage||new Fp,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const u=c.annotationType===Yt.POPUP;if(u){const p=i.get(c.id);if(!p)continue;l.elements=p}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;l.data=c;const h=rv.create(l);if(!h.isRenderable)continue;if(!u&&c.popupRef){const p=i.get(c.popupRef);p?p.push(h):i.set(c.popupRef,[h])}const m=h.render();c.hidden&&(m.style.visibility="hidden"),await this.#i(m,c.id,l.elements),h._isEditable&&(this.#s.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#a()}async addLinkAnnotations(e,t){const s={data:null,layer:this.div,linkService:t,svgFactory:new Yd,parent:this};for(const i of e){i.borderStyle||=Yp._defaultBorderStyle,s.data=i;const l=rv.create(s);if(!l.isRenderable)continue;const c=l.render();await this.#i(c,i.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,Fi(t,{rotation:e.rotation}),this.#a(),t.hidden=!1}#a(){if(!this.#t)return;const e=this.div;for(const[t,s]of this.#t){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:l}=i;l?l.nodeName==="CANVAS"?l.replaceWith(s):l.classList.contains("annotationContent")?l.after(s):l.before(s):i.append(s);const c=this.#s.get(t);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,i.id,s),c._hasNoCanvas=!1):c.canvas=s)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(e){return this.#s.get(e)}static get _defaultBorderStyle(){return st(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Br.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const gd=/\r\n?|\n/g;class Jt extends Oe{#e;#t="";#s=`${this.id}-editor`;#n=null;#i;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=Jt.prototype,t=l=>l.isEmpty(),s=Ja.TRANSLATE_SMALL,i=Ja.TRANSLATE_BIG;return st(this,"_keyboardManager",new Yo([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}static _type="freetext";static _editorType=qe.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#e=e.color||Jt._defaultColor||Oe._defaultLineColor,this.#i=e.fontSize||Jt._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(e,t){Oe.initialize(e,t);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case at.FREETEXT_SIZE:Jt._defaultFontSize=t;break;case at.FREETEXT_COLOR:Jt._defaultColor=t;break}}updateParams(e,t){switch(e){case at.FREETEXT_SIZE:this.#a(t);break;case at.FREETEXT_COLOR:this.#l(t);break}}static get defaultPropertiesToUpdate(){return[[at.FREETEXT_SIZE,Jt._defaultFontSize],[at.FREETEXT_COLOR,Jt._defaultColor||Oe._defaultLineColor]]}get propertiesToUpdate(){return[[at.FREETEXT_SIZE,this.#i],[at.FREETEXT_COLOR,this.#e]]}#a(e){const t=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-this.#i)*this.parentScale),this.#i=i,this.#u()},s=this.#i;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:at.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(e){const t=i=>{this.#e=this.editorDiv.style.color=i},s=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:at.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Jt._internalPadding*e,-(Jt._internalPadding+this.#i)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const e=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#s),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const e=[];this.editorDiv.normalize();let t=null;for(const s of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(Jt.#o(s)),t=s);return e.join(`
`)}#u(){const[e,t]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:i,div:l}=this,c=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",i.div.append(this.div),s=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/t):(this.width=s.height/e,this.height=s.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#t,t=this.#t=this.#r().trimEnd();if(e===t)return;const s=i=>{if(this.#t=i,!i){this.remove();return}this.#h(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{s(t)},undo:()=>{s(e)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Jt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#s),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[m,p]=this.pageDimensions,[x,y]=this.pageTranslation;let v,w;switch(this.rotation){case 0:v=e+(c[0]-x)/m,w=t+this.height-(c[1]-y)/p;break;case 90:v=e+(c[0]-x)/m,w=t-(c[1]-y)/p,[u,h]=[h,-u];break;case 180:v=e-this.width+(c[0]-x)/m,w=t-(c[1]-y)/p,[u,h]=[-u,-h];break;case 270:v=e+(c[0]-x-this.height*p)/m,w=t+(c[1]-y-this.width*m)/p,[u,h]=[-h,u];break}this.setAt(v*i,w*l,u,h)}else this._moveAfterPaste(e,t);this.#h(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#o(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(gd,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:s}=t;if(s.length===1&&s[0]==="text/plain")return;e.preventDefault();const i=Jt.#f(t.getData("text")||"").replaceAll(gd,`
`);if(!i)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!i.includes(`
`)){c.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:h}=c,m=[],p=[];if(u.nodeType===Node.TEXT_NODE){const v=u.parentElement;if(p.push(u.nodeValue.slice(h).replaceAll(gd,"")),v!==this.editorDiv){let w=m;for(const A of this.editorDiv.childNodes){if(A===v){w=p;continue}w.push(Jt.#o(A))}}m.push(u.nodeValue.slice(0,h).replaceAll(gd,""))}else if(u===this.editorDiv){let v=m,w=0;for(const A of this.editorDiv.childNodes)w++===h&&(v=p),v.push(Jt.#o(A))}this.#t=`${m.join(`
`)}${i}${p.join(`
`)}`,this.#h();const x=new Range;let y=Math.sumPrecise(m.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const w=v.nodeValue.length;if(y<=w){x.setStart(v,y),x.setEnd(v,y);break}y-=w}l.removeAllRanges(),l.addRange(x)}#h(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const e of this.#t.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#d(){return this.#t.replaceAll(" "," ")}static#f(e){return e.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,s){let i=null;if(e instanceof F1){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:m,id:p,popupRef:x},textContent:y,textPosition:v,parent:{page:{pageNumber:w}}}=e;if(!y||y.length===0)return null;i=e={annotationType:qe.FREETEXT,color:Array.from(u),fontSize:c,value:y.join(`
`),position:v,pageIndex:w-1,rect:h.slice(0),rotation:m,annotationElementId:p,id:p,deleted:!1,popupRef:x}}const l=await super.deserialize(e,t,s);return l.#i=e.fontSize,l.#e=Me.makeHexColor(...e.color),l.#t=Jt.#f(e.value),l._initialData=i,l}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Jt._internalPadding*this.parentScale,s=this.getRect(t,t),i=Oe._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),l={annotationType:qe.FREETEXT,color:i,fontSize:this.#i,value:this.#d(),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(l.isCopy=!0,l):this.annotationElementId&&!this.#m(l)?null:(l.id=this.annotationElementId,l)}#m(e){const{value:t,fontSize:s,color:i,pageIndex:l}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==s||e.color.some((c,u)=>c!==i[u])||e.pageIndex!==l}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:s}=t;s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.#e,t.replaceChildren();for(const l of this.#t.split(`
`)){const c=document.createElement("div");c.append(l?document.createTextNode(l):document.createElement("br")),t.append(c)}const i=Jt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(i,i),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class Ce{static PRECISION=1e-4;toSVGPath(){yt("Abstract method `toSVGPath` must be implemented.")}get box(){yt("Abstract getter `box` must be implemented.")}serialize(e,t){yt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,l,c){c||=new Float32Array(e.length);for(let u=0,h=e.length;u<h;u+=2)c[u]=t+e[u]*i,c[u+1]=s+e[u+1]*l;return c}static _rescaleAndSwap(e,t,s,i,l,c){c||=new Float32Array(e.length);for(let u=0,h=e.length;u<h;u+=2)c[u]=t+e[u+1]*i,c[u+1]=s+e[u]*l;return c}static _translate(e,t,s,i){i||=new Float32Array(e.length);for(let l=0,c=e.length;l<c;l+=2)i[l]=t+e[l],i[l+1]=s+e[l+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,l){switch(l){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,l,c){return[(e+5*s)/6,(t+5*i)/6,(5*s+l)/6,(5*i+c)/6,(s+l)/2,(i+c)/2]}}class Ri{#e;#t=[];#s;#n;#i=[];#a=new Float32Array(18);#l;#r;#u;#o;#h;#d;#f=[];static#m=8;static#p=2;static#c=Ri.#m+Ri.#p;constructor({x:e,y:t},s,i,l,c,u=0){this.#e=s,this.#d=l*i,this.#n=c,this.#a.set([NaN,NaN,NaN,NaN,e,t],6),this.#s=u,this.#o=Ri.#m*i,this.#u=Ri.#c*i,this.#h=i,this.#f.push(e,t)}isEmpty(){return isNaN(this.#a[8])}#g(){const e=this.#a.subarray(4,6),t=this.#a.subarray(16,18),[s,i,l,c]=this.#e;return[(this.#l+(e[0]-t[0])/2-s)/l,(this.#r+(e[1]-t[1])/2-i)/c,(this.#l+(t[0]-e[0])/2-s)/l,(this.#r+(t[1]-e[1])/2-i)/c]}add({x:e,y:t}){this.#l=e,this.#r=t;const[s,i,l,c]=this.#e;let[u,h,m,p]=this.#a.subarray(8,12);const x=e-m,y=t-p,v=Math.hypot(x,y);if(v<this.#u)return!1;const w=v-this.#o,A=w/v,N=A*x,S=A*y;let E=u,C=h;u=m,h=p,m+=N,p+=S,this.#f?.push(e,t);const R=-S/w,D=N/w,O=R*this.#d,H=D*this.#d;return this.#a.set(this.#a.subarray(2,8),0),this.#a.set([m+O,p+H],4),this.#a.set(this.#a.subarray(14,18),12),this.#a.set([m-O,p-H],16),isNaN(this.#a[6])?(this.#i.length===0&&(this.#a.set([u+O,h+H],2),this.#i.push(NaN,NaN,NaN,NaN,(u+O-s)/l,(h+H-i)/c),this.#a.set([u-O,h-H],14),this.#t.push(NaN,NaN,NaN,NaN,(u-O-s)/l,(h-H-i)/c)),this.#a.set([E,C,u,h,m,p],6),!this.isEmpty()):(this.#a.set([E,C,u,h,m,p],6),Math.abs(Math.atan2(C-h,E-u)-Math.atan2(S,N))<Math.PI/2?([u,h,m,p]=this.#a.subarray(2,6),this.#i.push(NaN,NaN,NaN,NaN,((u+m)/2-s)/l,((h+p)/2-i)/c),[u,h,E,C]=this.#a.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((E+u)/2-s)/l,((C+h)/2-i)/c),!0):([E,C,u,h,m,p]=this.#a.subarray(0,6),this.#i.push(((E+5*u)/6-s)/l,((C+5*h)/6-i)/c,((5*u+m)/6-s)/l,((5*h+p)/6-i)/c,((u+m)/2-s)/l,((h+p)/2-i)/c),[m,p,u,h,E,C]=this.#a.subarray(12,18),this.#t.push(((E+5*u)/6-s)/l,((C+5*h)/6-i)/c,((5*u+m)/6-s)/l,((5*h+p)/6-i)/c,((u+m)/2-s)/l,((h+p)/2-i)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#i,t=this.#t;if(isNaN(this.#a[6])&&!this.isEmpty())return this.#x();const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);this.#v(s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return this.#y(s),s.join(" ")}#x(){const[e,t,s,i]=this.#e,[l,c,u,h]=this.#g();return`M${(this.#a[2]-e)/s} ${(this.#a[3]-t)/i} L${(this.#a[4]-e)/s} ${(this.#a[5]-t)/i} L${l} ${c} L${u} ${h} L${(this.#a[16]-e)/s} ${(this.#a[17]-t)/i} L${(this.#a[14]-e)/s} ${(this.#a[15]-t)/i} Z`}#y(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#v(e){const[t,s,i,l]=this.#e,c=this.#a.subarray(4,6),u=this.#a.subarray(16,18),[h,m,p,x]=this.#g();e.push(`L${(c[0]-t)/i} ${(c[1]-s)/l} L${h} ${m} L${p} ${x} L${(u[0]-t)/i} ${(u[1]-s)/l}`)}newFreeDrawOutline(e,t,s,i,l,c){return new $1(e,t,s,i,l,c)}getOutlines(){const e=this.#i,t=this.#t,s=this.#a,[i,l,c,u]=this.#e,h=new Float32Array((this.#f?.length??0)+2);for(let x=0,y=h.length-2;x<y;x+=2)h[x]=(this.#f[x]-i)/c,h[x+1]=(this.#f[x+1]-l)/u;if(h[h.length-2]=(this.#l-i)/c,h[h.length-1]=(this.#r-l)/u,isNaN(s[6])&&!this.isEmpty())return this.#w(h);const m=new Float32Array(this.#i.length+24+this.#t.length);let p=e.length;for(let x=0;x<p;x+=2){if(isNaN(e[x])){m[x]=m[x+1]=NaN;continue}m[x]=e[x],m[x+1]=e[x+1]}p=this.#j(m,p);for(let x=t.length-6;x>=6;x-=6)for(let y=0;y<6;y+=2){if(isNaN(t[x+y])){m[p]=m[p+1]=NaN,p+=2;continue}m[p]=t[x+y],m[p+1]=t[x+y+1],p+=2}return this.#A(m,p),this.newFreeDrawOutline(m,h,this.#e,this.#h,this.#s,this.#n)}#w(e){const t=this.#a,[s,i,l,c]=this.#e,[u,h,m,p]=this.#g(),x=new Float32Array(36);return x.set([NaN,NaN,NaN,NaN,(t[2]-s)/l,(t[3]-i)/c,NaN,NaN,NaN,NaN,(t[4]-s)/l,(t[5]-i)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,m,p,NaN,NaN,NaN,NaN,(t[16]-s)/l,(t[17]-i)/c,NaN,NaN,NaN,NaN,(t[14]-s)/l,(t[15]-i)/c],0),this.newFreeDrawOutline(x,e,this.#e,this.#h,this.#s,this.#n)}#A(e,t){const s=this.#t;return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6}#j(e,t){const s=this.#a.subarray(4,6),i=this.#a.subarray(16,18),[l,c,u,h]=this.#e,[m,p,x,y]=this.#g();return e.set([NaN,NaN,NaN,NaN,(s[0]-l)/u,(s[1]-c)/h,NaN,NaN,NaN,NaN,m,p,NaN,NaN,NaN,NaN,x,y,NaN,NaN,NaN,NaN,(i[0]-l)/u,(i[1]-c)/h],t),t+=24}}class $1 extends Ce{#e;#t=new Float32Array(4);#s;#n;#i;#a;#l;constructor(e,t,s,i,l,c){super(),this.#l=e,this.#i=t,this.#e=s,this.#a=i,this.#s=l,this.#n=c,this.lastPoint=[NaN,NaN],this.#r(c);const[u,h,m,p]=this.#t;for(let x=0,y=e.length;x<y;x+=2)e[x]=(e[x]-u)/m,e[x+1]=(e[x+1]-h)/p;for(let x=0,y=t.length;x<y;x+=2)t[x]=(t[x]-u)/m,t[x+1]=(t[x+1]-h)/p}toSVGPath(){const e=[`M${this.#l[4]} ${this.#l[5]}`];for(let t=6,s=this.#l.length;t<s;t+=6){if(isNaN(this.#l[t])){e.push(`L${this.#l[t+4]} ${this.#l[t+5]}`);continue}e.push(`C${this.#l[t]} ${this.#l[t+1]} ${this.#l[t+2]} ${this.#l[t+3]} ${this.#l[t+4]} ${this.#l[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,s,i],l){const c=s-e,u=i-t;let h,m;switch(l){case 0:h=Ce._rescale(this.#l,e,i,c,-u),m=Ce._rescale(this.#i,e,i,c,-u);break;case 90:h=Ce._rescaleAndSwap(this.#l,e,t,c,u),m=Ce._rescaleAndSwap(this.#i,e,t,c,u);break;case 180:h=Ce._rescale(this.#l,s,t,-c,u),m=Ce._rescale(this.#i,s,t,-c,u);break;case 270:h=Ce._rescaleAndSwap(this.#l,s,i,-c,-u),m=Ce._rescaleAndSwap(this.#i,s,i,-c,-u);break}return{outline:Array.from(h),points:[Array.from(m)]}}#r(e){const t=this.#l;let s=t[4],i=t[5];const l=[s,i,s,i];let c=s,u=i;const h=e?Math.max:Math.min;for(let p=6,x=t.length;p<x;p+=6){const y=t[p+4],v=t[p+5];if(isNaN(t[p]))Me.pointBoundingBox(y,v,l),u<v?(c=y,u=v):u===v&&(c=h(c,y));else{const w=[1/0,1/0,-1/0,-1/0];Me.bezierBoundingBox(s,i,...t.slice(p,p+6),w),Me.rectBoundingBox(...w,l),u<w[3]?(c=w[2],u=w[3]):u===w[3]&&(c=h(c,w[2]))}s=y,i=v}const m=this.#t;m[0]=l[0]-this.#s,m[1]=l[1]-this.#s,m[2]=l[2]-l[0]+2*this.#s,m[3]=l[3]-l[1]+2*this.#s,this.lastPoint=[c,u]}get box(){return this.#t}newOutliner(e,t,s,i,l,c=0){return new Ri(e,t,s,i,l,c)}getNewOutline(e,t){const[s,i,l,c]=this.#t,[u,h,m,p]=this.#e,x=l*m,y=c*p,v=s*m+u,w=i*p+h,A=this.newOutliner({x:this.#i[0]*x+v,y:this.#i[1]*y+w},this.#e,this.#a,e,this.#n,t??this.#s);for(let N=2;N<this.#i.length;N+=2)A.add({x:this.#i[N]*x+v,y:this.#i[N+1]*y+w});return A.getOutlines()}}class sp{#e;#t;#s=[];#n=[];constructor(e,t=0,s=0,i=!0){const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:v,y:w,width:A,height:N}of e){const S=Math.floor((v-t)/c)*c,E=Math.ceil((v+A+t)/c)*c,C=Math.floor((w-t)/c)*c,R=Math.ceil((w+N+t)/c)*c,D=[S,C,R,!0],O=[E,C,R,!1];this.#s.push(D,O),Me.rectBoundingBox(S,C,E,R,l)}const u=l[2]-l[0]+2*s,h=l[3]-l[1]+2*s,m=l[0]-s,p=l[1]-s,x=this.#s.at(i?-1:-2),y=[x[0],x[2]];for(const v of this.#s){const[w,A,N]=v;v[0]=(w-m)/u,v[1]=(A-p)/h,v[2]=(N-p)/h}this.#e=new Float32Array([m,p,u,h]),this.#t=y}getOutlines(){this.#s.sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of this.#s)t[3]?(e.push(...this.#u(t)),this.#l(t)):(this.#r(t),e.push(...this.#u(t)));return this.#i(e)}#i(e){const t=[],s=new Set;for(const c of e){const[u,h,m]=c;t.push([u,h,c],[u,m,c])}t.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=t.length;c<u;c+=2){const h=t[c][2],m=t[c+1][2];h.push(m),m.push(h),s.add(h),s.add(m)}const i=[];let l;for(;s.size>0;){const c=s.values().next().value;let[u,h,m,p,x]=c;s.delete(c);let y=u,v=h;for(l=[u,m],i.push(l);;){let w;if(s.has(p))w=p;else if(s.has(x))w=x;else break;s.delete(w),[u,h,m,p,x]=w,y!==u&&(l.push(y,v,u,v===h?h:m),y=u),v=v===h?m:h}l.push(y,v)}return new WD(i,this.#e,this.#t)}#a(e){const t=this.#n;let s=0,i=t.length-1;for(;s<=i;){const l=s+i>>1,c=t[l][0];if(c===e)return l;c<e?s=l+1:i=l-1}return i+1}#l([,e,t]){const s=this.#a(e);this.#n.splice(s,0,[e,t])}#r([,e,t]){const s=this.#a(e);for(let i=s;i<this.#n.length;i++){const[l,c]=this.#n[i];if(l!==e)break;if(l===e&&c===t){this.#n.splice(i,1);return}}for(let i=s-1;i>=0;i--){const[l,c]=this.#n[i];if(l!==e)break;if(l===e&&c===t){this.#n.splice(i,1);return}}}#u(e){const[t,s,i]=e,l=[[t,s,i]],c=this.#a(i);for(let u=0;u<c;u++){const[h,m]=this.#n[u];for(let p=0,x=l.length;p<x;p++){const[,y,v]=l[p];if(!(m<=y||v<=h)){if(y>=h){if(v>m)l[p][1]=m;else{if(x===1)return[];l.splice(p,1),p--,x--}continue}l[p][2]=h,v>m&&l.push([t,m,v])}}}return l}}class WD extends Ce{#e;#t;constructor(e,t,s){super(),this.#t=e,this.#e=t,this.lastPoint=s}toSVGPath(){const e=[];for(const t of this.#t){let[s,i]=t;e.push(`M${s} ${i}`);for(let l=2;l<t.length;l+=2){const c=t[l],u=t[l+1];c===s?(e.push(`V${u}`),i=u):u===i&&(e.push(`H${c}`),s=c)}e.push("Z")}return e.join(" ")}serialize([e,t,s,i],l){const c=[],u=s-e,h=i-t;for(const m of this.#t){const p=new Array(m.length);for(let x=0;x<m.length;x+=2)p[x]=e+m[x]*u,p[x+1]=i-m[x+1]*h;c.push(p)}return c}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class np extends Ri{newFreeDrawOutline(e,t,s,i,l,c){return new XD(e,t,s,i,l,c)}}class XD extends $1{newOutliner(e,t,s,i,l,c=0){return new np(e,t,s,i,l,c)}}class fn{#e=null;#t=null;#s;#n=null;#i=!1;#a=!1;#l=null;#r;#u=null;#o=null;#h;static#d=null;static get _keyboardManager(){return st(this,"_keyboardManager",new Yo([[["Escape","mac+Escape"],fn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],fn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],fn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],fn.prototype._moveToPrevious],[["Home","mac+Home"],fn.prototype._moveToBeginning],[["End","mac+End"],fn.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#a=!1,this.#h=at.HIGHLIGHT_COLOR,this.#l=e):(this.#a=!0,this.#h=at.HIGHLIGHT_DEFAULT_COLOR),this.#o=e?._uiManager||t,this.#r=this.#o._eventBus,this.#s=e?.color?.toUpperCase()||this.#o?.highlightColors.values().next().value||"#FFFF98",fn.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#l&&(e.ariaControls=`${this.#l.id}_colorpicker_dropdown`);const t=this.#o._signal;e.addEventListener("click",this.#c.bind(this),{signal:t}),e.addEventListener("keydown",this.#p.bind(this),{signal:t});const s=this.#t=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#s,e.append(s),e}renderMainDropdown(){const e=this.#n=this.#f();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#f(){const e=document.createElement("div"),t=this.#o._signal;e.addEventListener("contextmenu",_n,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#l&&(e.id=`${this.#l.id}_colorpicker_dropdown`);for(const[s,i]of this.#o.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",i),l.title=s,l.setAttribute("data-l10n-id",fn.#d[s]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=i,l.ariaSelected=i===this.#s,l.addEventListener("click",this.#m.bind(this,i),{signal:t}),e.append(l)}return e.addEventListener("keydown",this.#p.bind(this),{signal:t}),e}#m(e,t){t.stopPropagation(),this.#r.dispatch("switchannotationeditorparams",{source:this,type:this.#h,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#c(e);return}const t=e.target.getAttribute("data-color");t&&this.#m(t,e)}_moveToNext(e){if(!this.#x){this.#c(e);return}if(e.target===this.#e){this.#n.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstChild||e.target===this.#e){this.#x&&this._hideDropdownFromKeyboard();return}this.#x||this.#c(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#x){this.#c(e);return}this.#n.firstChild?.focus()}_moveToEnd(e){if(!this.#x){this.#c(e);return}this.#n.lastChild?.focus()}#p(e){fn._keyboardManager.exec(this,e)}#c(e){if(this.#x){this.hideDropdown();return}if(this.#i=e.detail===0,this.#u||(this.#u=new AbortController,window.addEventListener("pointerdown",this.#g.bind(this),{signal:this.#o.combinedSignal(this.#u)})),this.#e.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#f();this.#e.append(t)}#g(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#u?.abort(),this.#u=null}get#x(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#a){if(!this.#x){this.#l?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#i})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#o.highlightColors.values();for(const s of this.#n.children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class zt extends Oe{#e=null;#t=0;#s;#n=null;#i=null;#a=null;#l=null;#r=0;#u=null;#o=null;#h=null;#d=!1;#f=null;#m;#p=null;#c="";#g;#x="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=qe.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=zt.prototype;return st(this,"_keyboardManager",new Yo([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||zt._defaultColor,this.#g=e.thickness||zt._defaultThickness,this.#m=e.opacity||zt._defaultOpacity,this.#s=e.boxes||null,this.#x=e.methodOfCreation||"",this.#c=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#d=!0,this.#v(e),this.#T()):this.#s&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#l=e.focusNode,this.#r=e.focusOffset,this.#y(),this.#T(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#d?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#g,methodOfCreation:this.#x}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#y(){const e=new sp(this.#s,.001);this.#o=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#o.box;const t=new sp(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#a=t.getOutlines();const{lastPoint:s}=this.#a;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#v({highlightOutlines:e,highlightId:t,clipPathId:s}){this.#o=e;const i=1.5;if(this.#a=e.getNewOutline(this.#g/2+i,.0025),t>=0)this.#h=t,this.#n=s,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},!0);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:zt.#N(this.#o.box,(p-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:zt.#N(this.#a.box,p),path:{d:this.#a.toSVGPath()}})}const[l,c,u,h]=e.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=u,this.height=h;break;case 90:{const[p,x]=this.parentDimensions;this.x=c,this.y=1-l,this.width=u*x/p,this.height=h*p/x;break}case 180:this.x=1-l,this.y=1-c,this.width=u,this.height=h;break;case 270:{const[p,x]=this.parentDimensions;this.x=1-c,this.y=l,this.width=u*x/p,this.height=h*p/x;break}}const{lastPoint:m}=this.#a;this.#f=[(m[0]-l)/u,(m[1]-c)/h]}static initialize(e,t){Oe.initialize(e,t),zt._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case at.HIGHLIGHT_DEFAULT_COLOR:zt._defaultColor=t;break;case at.HIGHLIGHT_THICKNESS:zt._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#f}updateParams(e,t){switch(e){case at.HIGHLIGHT_COLOR:this.#w(t);break;case at.HIGHLIGHT_THICKNESS:this.#A(t);break}}static get defaultPropertiesToUpdate(){return[[at.HIGHLIGHT_DEFAULT_COLOR,zt._defaultColor],[at.HIGHLIGHT_THICKNESS,zt._defaultThickness]]}get propertiesToUpdate(){return[[at.HIGHLIGHT_COLOR,this.color||zt._defaultColor],[at.HIGHLIGHT_THICKNESS,this.#g||zt._defaultThickness],[at.HIGHLIGHT_FREE,this.#d]]}#w(e){const t=(l,c)=>{this.color=l,this.#m=c,this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:l,"fill-opacity":c}}),this.#i?.updateColor(l)},s=this.color,i=this.#m;this.addCommands({cmd:t.bind(this,e,zt._defaultOpacity),undo:t.bind(this,s,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:at.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#A(e){const t=this.#g,s=i=>{this.#g=i,this.#j(i)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:at.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#i=new fn({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#R())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#R())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#_(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#T(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#_():e&&(this.#T(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#j(e){if(!this.#d)return;this.#v({highlightOutlines:this.#o.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,s]=this.parentDimensions;this.setDims(this.width*t,this.height*s)}#_(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#T(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#o.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#m},rootClass:{highlight:!0,free:this.#d},path:{d:this.#o.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#d},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},this.#d),this.#u&&(this.#u.style.clipPath=this.#n))}static#N([e,t,s,i],l){switch(l){case 90:return[1-t-i,e,i,s];case 180:return[1-e-s,1-t-i,s,i];case 270:return[t,1-e-s,i,s]}return[e,t,s,i]}rotate(e){const{drawLayer:t}=this.parent;let s;this.#d?(e=(e-this.rotation+360)%360,s=zt.#N(this.#o.box,e)):s=zt.#N([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:s,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:zt.#N(this.#a.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#c&&(e.setAttribute("aria-label",this.#c),e.setAttribute("role","mark")),this.#d?e.classList.add("free"):this.div.addEventListener("keydown",this.#C.bind(this),{signal:this._uiManager._signal});const t=this.#u=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n;const[s,i]=this.parentDimensions;return this.setDims(this.width*s,this.height*i),b1(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#C(e){zt._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#E(!0);break;case 1:case 3:this.#E(!1);break}}#E(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#l,this.#r)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#d||this.#E(!1))}get _mustFixPosition(){return!this.#d}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#R(){return this.#d?this.rotation:0}#k(){if(this.#d)return null;const[e,t]=this.pageDimensions,[s,i]=this.pageTranslation,l=this.#s,c=new Float32Array(l.length*8);let u=0;for(const{x:h,y:m,width:p,height:x}of l){const y=h*e+s,v=(1-m)*t+i;c[u]=c[u+4]=y,c[u+1]=c[u+3]=v,c[u+2]=c[u+6]=y+p*e,c[u+5]=c[u+7]=v-x*t,u+=8}return c}#M(e){return this.#o.serialize(e,this.#R())}static startHighlighting(e,t,{target:s,x:i,y:l}){const{x:c,y:u,width:h,height:m}=s.getBoundingClientRect(),p=new AbortController,x=e.combinedSignal(p),y=v=>{p.abort(),this.#S(e,v)};window.addEventListener("blur",y,{signal:x}),window.addEventListener("pointerup",y,{signal:x}),window.addEventListener("pointerdown",Wt,{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",_n,{signal:x}),s.addEventListener("pointermove",this.#z.bind(this,e),{signal:x}),this._freeHighlight=new np({x:i,y:l},[c,u,h,m],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#z(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#S(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,s){let i=null;if(e instanceof q1){const{data:{quadPoints:w,rect:A,rotation:N,id:S,color:E,opacity:C,popupRef:R},parent:{page:{pageNumber:D}}}=e;i=e={annotationType:qe.HIGHLIGHT,color:Array.from(E),opacity:C,quadPoints:w,boxes:null,pageIndex:D-1,rect:A.slice(0),rotation:N,annotationElementId:S,id:S,deleted:!1,popupRef:R}}else if(e instanceof Gp){const{data:{inkLists:w,rect:A,rotation:N,id:S,color:E,borderStyle:{rawWidth:C},popupRef:R},parent:{page:{pageNumber:D}}}=e;i=e={annotationType:qe.HIGHLIGHT,color:Array.from(E),thickness:C,inkLists:w,boxes:null,pageIndex:D-1,rect:A.slice(0),rotation:N,annotationElementId:S,id:S,deleted:!1,popupRef:R}}const{color:l,quadPoints:c,inkLists:u,opacity:h}=e,m=await super.deserialize(e,t,s);m.color=Me.makeHexColor(...l),m.#m=h||1,u&&(m.#g=e.thickness),m._initialData=i;const[p,x]=m.pageDimensions,[y,v]=m.pageTranslation;if(c){const w=m.#s=[];for(let A=0;A<c.length;A+=8)w.push({x:(c[A]-y)/p,y:1-(c[A+1]-v)/x,width:(c[A+2]-c[A])/p,height:(c[A+1]-c[A+5])/x});m.#y(),m.#T(),m.rotate(m.rotation)}else if(u){m.#d=!0;const w=u[0],A={x:w[0]-y,y:x-(w[1]-v)},N=new np(A,[0,0,p,x],1,m.#g/2,!0,.001);for(let C=0,R=w.length;C<R;C+=2)A.x=w[C]-y,A.y=x-(w[C+1]-v),N.add(A);const{id:S,clipPathId:E}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:m.color,"fill-opacity":m._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:N.toSVGPath()}},!0,!0);m.#v({highlightOutlines:N.getOutlines(),highlightId:S,clipPathId:E}),m.#T(),m.rotate(m.parentRotation)}return m}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),s=Oe._colorManager.convert(this.color),i={annotationType:qe.HIGHLIGHT,color:s,opacity:this.#m,thickness:this.#g,quadPoints:this.#k(),outlines:this.#M(t),pageIndex:this.pageIndex,rect:t,rotation:this.#R(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#b(i)?null:(i.id=this.annotationElementId,i)}#b(e){const{color:t}=this._initialData;return e.color.some((s,i)=>s!==t[i])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class G1{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){yt("Not implemented")}}class ze extends Oe{#e=null;#t;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#s=null;static#n=null;static#i=null;static#a=NaN;static#l=null;static#r=null;static#u=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}_addOutlines(e){e.drawOutlines&&(this.#o(e),this.#f())}#o({drawOutlines:e,drawId:t,drawingOptions:s}){this.#e=e,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#h(e,this.parent),this.#c(e.box)}#h(e,t){const{id:s}=t.drawLayer.draw(ze._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(e,t){const s=new Set(Object.keys(e));for(const[i,l]of Object.entries(t))s.has(i)?Object.assign(e[i],l):e[i]=l;return e}static getDefaultDrawingOptions(e){yt("Not implemented")}static get typesMap(){yt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const s=this.typesMap.get(e);s&&this._defaultDrawingOptions.updateProperty(s,t),this._currentParent&&(ze.#s.updateProperty(s,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const s=this.constructor.typesMap.get(e);s&&this._updateProperty(e,s,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[s,i]of this.typesMap)e.push([s,t[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[s,i]of this.constructor.typesMap)e.push([s,t[i]]);return e}_updateProperty(e,t,s){const i=this._drawingOptions,l=i[t],c=u=>{i.updateProperty(t,u);const h=this.#e.updateProperty(t,u);h&&this.#c(h),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:c.bind(this,s),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,ze._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,ze._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,ze._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#d(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#c(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#d()):e&&(this._uiManager.addShouldRescale(this),this.#f(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#d(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#h(this.#e,e)}}#m([e,t,s,i]){const{parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[t,1-e,s*(c/l),i*(l/c)];case 180:return[1-e,1-t,s,i];case 270:return[1-t,e,s*(c/l),i*(l/c)];default:return[e,t,s,i]}}#p(){const{x:e,y:t,width:s,height:i,parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[1-t,e,s*(l/c),i*(c/l)];case 180:return[1-e,1-t,s,i];case 270:return[t,1-e,s*(l/c),i*(c/l)];default:return[e,t,s,i]}}#c(e){if([this.x,this.y,this.width,this.height]=this.#m(e),this.div){this.fixAndSetPosition();const[t,s]=this.parentDimensions;this.setDims(this.width*t,this.height*s)}this._onResized()}#g(){const{x:e,y:t,width:s,height:i,rotation:l,parentRotation:c,parentDimensions:[u,h]}=this;switch((l*4+c)/90){case 1:return[1-t-i,e,i,s];case 2:return[1-e-s,1-t-i,s,i];case 3:return[t,1-e-s,i,s];case 4:return[e,t-s*(u/h),i*(h/u),s*(u/h)];case 5:return[1-t,e,s*(u/h),i*(h/u)];case 6:return[1-e-i*(h/u),1-t,i*(h/u),s*(u/h)];case 7:return[t-s*(u/h),1-e-i*(h/u),s*(u/h),i*(h/u)];case 8:return[e-s,t-i,s,i];case 9:return[1-t,e-s,i,s];case 10:return[1-e,1-t,s,i];case 11:return[t-i,1-e,i,s];case 12:return[e-i*(h/u),t,i*(h/u),s*(u/h)];case 13:return[1-t-s*(u/h),e-i*(h/u),s*(u/h),i*(h/u)];case 14:return[1-e,1-t-s*(u/h),i*(h/u),s*(u/h)];case 15:return[t,1-e,s*(u/h),i*(h/u)];default:return[e,t,s,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ze._mergeSVGProperties({bbox:this.#g()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#c(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const s=super.render();s.classList.add("draw");const i=document.createElement("div");s.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[l,c]=this.parentDimensions;return this.setDims(this.width*l,this.height*c),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),s}static createDrawerInstance(e,t,s,i,l){yt("Not implemented")}static startDrawing(e,t,s,i){const{target:l,offsetX:c,offsetY:u,pointerId:h,pointerType:m}=i;if(ze.#l&&ze.#l!==m)return;const{viewport:{rotation:p}}=e,{width:x,height:y}=l.getBoundingClientRect(),v=ze.#n=new AbortController,w=e.combinedSignal(v);if(ze.#a||=h,ze.#l??=m,window.addEventListener("pointerup",A=>{ze.#a===A.pointerId?this._endDraw(A):ze.#r?.delete(A.pointerId)},{signal:w}),window.addEventListener("pointercancel",A=>{ze.#a===A.pointerId?this._currentParent.endDrawingSession():ze.#r?.delete(A.pointerId)},{signal:w}),window.addEventListener("pointerdown",A=>{ze.#l===A.pointerType&&((ze.#r||=new Set).add(A.pointerId),ze.#s.isCancellable()&&(ze.#s.removeLastElement(),ze.#s.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",_n,{signal:w}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),l.addEventListener("touchmove",A=>{A.timeStamp===ze.#u&&Wt(A)},{signal:w}),e.toggleDrawing(),t._editorUndoBar?.hide(),ze.#s){e.drawLayer.updateProperties(this._currentDrawId,ze.#s.startNew(c,u,x,y,p));return}t.updateUIForDefaultProperties(this),ze.#s=this.createDrawerInstance(c,u,x,y,p),ze.#i=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(ze.#i.toSVGProperties(),ze.#s.defaultSVGProperties),!0,!1)}static _drawMove(e){if(ze.#u=-1,!ze.#s)return;const{offsetX:t,offsetY:s,pointerId:i}=e;if(ze.#a===i){if(ze.#r?.size>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,ze.#s.add(t,s)),ze.#u=e.timeStamp,Wt(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,ze.#s=null,ze.#i=null,ze.#l=null,ze.#u=NaN),ze.#n&&(ze.#n.abort(),ze.#n=null,ze.#a=NaN,ze.#r=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,ze.#s.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const s=ze.#s,i=this._currentDrawId,l=s.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(i,s.setLastElement(l))},undo:()=>{t.drawLayer.updateProperties(i,s.removeLastElement())},mustExec:!1,type:at.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(at.DRAW_STEP),!ze.#s.isEmpty()){const{pageDimensions:[s,i],scale:l}=t,c=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:ze.#s.getOutlines(s*l,i*l,l,this._INNER_MARGIN),drawingOptions:ze.#i,mustBeCommitted:!e});return this._cleanup(!0),c}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,s,i,l,c){yt("Not implemented")}static async deserialize(e,t,s){const{rawDims:{pageWidth:i,pageHeight:l,pageX:c,pageY:u}}=t.viewport,h=this.deserializeDraw(c,u,i,l,this._INNER_MARGIN,e),m=await super.deserialize(e,t,s);return m.createDrawingOptions(e),m.#o({drawOutlines:h}),m.#f(),m.onScaleChanging(),m.rotate(),m}serializeDraw(e){const[t,s]=this.pageTranslation,[i,l]=this.pageDimensions;return this.#e.serialize([t,s,i,l],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class QD{#e=new Float64Array(6);#t;#s;#n;#i;#a;#l="";#r=0;#u=new Xo;#o;#h;constructor(e,t,s,i,l,c){this.#o=s,this.#h=i,this.#n=l,this.#i=c,[e,t]=this.#d(e,t);const u=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#a=[e,t],this.#s=[{line:u,points:this.#a}],this.#e.set(u,0)}updateProperty(e,t){e==="stroke-width"&&(this.#i=t)}#d(e,t){return Ce._normalizePoint(e,t,this.#o,this.#h,this.#n)}isEmpty(){return!this.#s||this.#s.length===0}isCancellable(){return this.#a.length<=10}add(e,t){[e,t]=this.#d(e,t);const[s,i,l,c]=this.#e.subarray(2,6),u=e-l,h=t-c;return Math.hypot(this.#o*u,this.#h*h)<=2?null:(this.#a.push(e,t),isNaN(s)?(this.#e.set([l,c,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([s,i,l,c,e,t],0),this.#t.push(...Ce.createBezierPoints(s,i,l,c,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(this.#a.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,l){this.#o=s,this.#h=i,this.#n=l,[e,t]=this.#d(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#a=[e,t];const u=this.#s.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#s.push({line:c,points:this.#a}),this.#e.set(c,0),this.#r=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(e){return this.#s?(this.#s.push(e),this.#t=e.line,this.#a=e.points,this.#r=0,{path:{d:this.toSVGPath()}}):this.#u.setLastElement(e)}removeLastElement(){if(!this.#s)return this.#u.removeLastElement();this.#s.pop(),this.#l="";for(let e=0,t=this.#s.length;e<t;e++){const{line:s,points:i}=this.#s[e];this.#t=s,this.#a=i,this.#r=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){const e=Ce.svgRound(this.#t[4]),t=Ce.svgRound(this.#t[5]);if(this.#a.length===2)return this.#l=`${this.#l} M ${e} ${t} Z`,this.#l;if(this.#a.length<=6){const i=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,i)} M ${e} ${t}`,this.#r=6}if(this.#a.length===4){const i=Ce.svgRound(this.#t[10]),l=Ce.svgRound(this.#t[11]);return this.#l=`${this.#l} L ${i} ${l}`,this.#r=12,this.#l}const s=[];this.#r===0&&(s.push(`M ${e} ${t}`),this.#r=6);for(let i=this.#r,l=this.#t.length;i<l;i+=6){const[c,u,h,m,p,x]=this.#t.slice(i,i+6).map(Ce.svgRound);s.push(`C${c} ${u} ${h} ${m} ${p} ${x}`)}return this.#l+=s.join(" "),this.#r=this.#t.length,this.#l}getOutlines(e,t,s,i){const l=this.#s.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#u.build(this.#s,e,t,s,this.#n,this.#i,i),this.#e=null,this.#t=null,this.#s=null,this.#l=null,this.#u}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Xo extends Ce{#e;#t=0;#s;#n;#i;#a;#l;#r;#u;build(e,t,s,i,l,c,u){this.#i=t,this.#a=s,this.#l=i,this.#r=l,this.#u=c,this.#s=u??0,this.#n=e,this.#d()}get thickness(){return this.#u}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${Ce.svgRound(t[4])} ${Ce.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${Ce.svgRound(t[10])} ${Ce.svgRound(t[11])}`);continue}for(let s=6,i=t.length;s<i;s+=6){const[l,c,u,h,m,p]=t.subarray(s,s+6).map(Ce.svgRound);e.push(`C${l} ${c} ${u} ${h} ${m} ${p}`)}}return e.join("")}serialize([e,t,s,i],l){const c=[],u=[],[h,m,p,x]=this.#h();let y,v,w,A,N,S,E,C,R;switch(this.#r){case 0:R=Ce._rescale,y=e,v=t+i,w=s,A=-i,N=e+h*s,S=t+(1-m-x)*i,E=e+(h+p)*s,C=t+(1-m)*i;break;case 90:R=Ce._rescaleAndSwap,y=e,v=t,w=s,A=i,N=e+m*s,S=t+h*i,E=e+(m+x)*s,C=t+(h+p)*i;break;case 180:R=Ce._rescale,y=e+s,v=t,w=-s,A=i,N=e+(1-h-p)*s,S=t+m*i,E=e+(1-h)*s,C=t+(m+x)*i;break;case 270:R=Ce._rescaleAndSwap,y=e+s,v=t+i,w=-s,A=-i,N=e+(1-m-x)*s,S=t+(1-h-p)*i,E=e+(1-m)*s,C=t+(1-h)*i;break}for(const{line:D,points:O}of this.#n)c.push(R(D,y,v,w,A,l?new Array(D.length):null)),u.push(R(O,y,v,w,A,l?new Array(O.length):null));return{lines:c,points:u,rect:[N,S,E,C]}}static deserialize(e,t,s,i,l,{paths:{lines:c,points:u},rotation:h,thickness:m}){const p=[];let x,y,v,w,A;switch(h){case 0:A=Ce._rescale,x=-e/s,y=t/i+1,v=1/s,w=-1/i;break;case 90:A=Ce._rescaleAndSwap,x=-t/i,y=-e/s,v=1/i,w=1/s;break;case 180:A=Ce._rescale,x=e/s+1,y=-t/i,v=-1/s,w=1/i;break;case 270:A=Ce._rescaleAndSwap,x=t/i+1,y=e/s+1,v=-1/i,w=-1/s;break}if(!c){c=[];for(const S of u){const E=S.length;if(E===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1]]));continue}if(E===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,S[0],S[1],NaN,NaN,NaN,NaN,S[2],S[3]]));continue}const C=new Float32Array(3*(E-2));c.push(C);let[R,D,O,H]=S.subarray(0,4);C.set([NaN,NaN,NaN,NaN,R,D],0);for(let F=4;F<E;F+=2){const P=S[F],Z=S[F+1];C.set(Ce.createBezierPoints(R,D,O,H,P,Z),(F-2)*3),[R,D,O,H]=[O,H,P,Z]}}}for(let S=0,E=c.length;S<E;S++)p.push({line:A(c[S].map(C=>C??NaN),x,y,v,w),points:A(u[S].map(C=>C??NaN),x,y,v,w)});const N=new this.prototype.constructor;return N.build(p,s,i,1,h,m,l),N}#o(e=this.#u){const t=this.#s+e/2*this.#l;return this.#r%180===0?[t/this.#i,t/this.#a]:[t/this.#a,t/this.#i]}#h(){const[e,t,s,i]=this.#e,[l,c]=this.#o(0);return[e+l,t+c,s-2*l,i-2*c]}#d(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:i}of this.#n){if(i.length<=12){for(let u=4,h=i.length;u<h;u+=6)Me.pointBoundingBox(i[u],i[u+1],e);continue}let l=i[4],c=i[5];for(let u=6,h=i.length;u<h;u+=6){const[m,p,x,y,v,w]=i.subarray(u,u+6);Me.bezierBoundingBox(l,c,m,p,x,y,v,w,e),l=v,c=w}}const[t,s]=this.#o();e[0]=Ss(e[0]-t,0,1),e[1]=Ss(e[1]-s,0,1),e[2]=Ss(e[2]+t,0,1),e[3]=Ss(e[3]+s,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,s]=this.#o();this.#u=e;const[i,l]=this.#o(),[c,u]=[i-t,l-s],h=this.#e;return h[0]-=c,h[1]-=u,h[2]+=2*c,h[3]+=2*u,h}updateParentDimensions([e,t],s){const[i,l]=this.#o();this.#i=e,this.#a=t,this.#l=s;const[c,u]=this.#o(),h=c-i,m=u-l,p=this.#e;return p[0]-=h,p[1]-=m,p[2]+=2*h,p[3]+=2*m,p}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(Ce.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ce.svgRound(e)} ${Ce.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let s=0,i=0,l=0,c=0,u=0,h=0;switch(this.#t){case 90:i=t/e,l=-e/t,u=e;break;case 180:s=-1,c=-1,u=e,h=t;break;case 270:i=-t/e,l=e/t,h=t;break;default:return""}return`matrix(${s} ${i} ${l} ${c} ${Ce.svgRound(u)} ${Ce.svgRound(h)})`}getPathResizingSVGProperties([e,t,s,i]){const[l,c]=this.#o(),[u,h,m,p]=this.#e;if(Math.abs(m-l)<=Ce.PRECISION||Math.abs(p-c)<=Ce.PRECISION){const A=e+s/2-(u+m/2),N=t+i/2-(h+p/2);return{path:{"transform-origin":`${Ce.svgRound(e)} ${Ce.svgRound(t)}`,transform:`${this.rotationTransform} translate(${A} ${N})`}}}const x=(s-2*l)/(m-2*l),y=(i-2*c)/(p-2*c),v=m/s,w=p/i;return{path:{"transform-origin":`${Ce.svgRound(u)} ${Ce.svgRound(h)}`,transform:`${this.rotationTransform} scale(${v} ${w}) translate(${Ce.svgRound(l)} ${Ce.svgRound(c)}) scale(${x} ${y}) translate(${Ce.svgRound(-l)} ${Ce.svgRound(-c)})`}}}getPathResizedSVGProperties([e,t,s,i]){const[l,c]=this.#o(),u=this.#e,[h,m,p,x]=u;if(u[0]=e,u[1]=t,u[2]=s,u[3]=i,Math.abs(p-l)<=Ce.PRECISION||Math.abs(x-c)<=Ce.PRECISION){const N=e+s/2-(h+p/2),S=t+i/2-(m+x/2);for(const{line:E,points:C}of this.#n)Ce._translate(E,N,S,E),Ce._translate(C,N,S,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ce.svgRound(e)} ${Ce.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(s-2*l)/(p-2*l),v=(i-2*c)/(x-2*c),w=-y*(h+l)+e+l,A=-v*(m+c)+t+c;if(y!==1||v!==1||w!==0||A!==0)for(const{line:N,points:S}of this.#n)Ce._rescale(N,w,A,y,v,N),Ce._rescale(S,w,A,y,v,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ce.svgRound(e)} ${Ce.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],s){const[i,l]=s,c=this.#e,u=e-c[0],h=t-c[1];if(this.#i===i&&this.#a===l)for(const{line:m,points:p}of this.#n)Ce._translate(m,u,h,m),Ce._translate(p,u,h,p);else{const m=this.#i/i,p=this.#a/l;this.#i=i,this.#a=l;for(const{line:x,points:y}of this.#n)Ce._rescale(x,u,h,m,p,x),Ce._rescale(y,u,h,m,p,y);c[2]*=m,c[3]*=p}return c[0]=e,c[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Ce.svgRound(e)} ${Ce.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Ce.svgRound(e[0])} ${Ce.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Su extends G1{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Oe._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Su(this._viewParameters);return e.updateAll(this),e}}class Wp extends ze{static _type="ink";static _editorType=qe.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){Oe.initialize(e,t),this._defaultDrawingOptions=new Su(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return st(this,"typesMap",new Map([[at.INK_THICKNESS,"stroke-width"],[at.INK_COLOR,"stroke"],[at.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,s,i,l){return new QD(e,t,s,i,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,s,i,l,c){return Xo.deserialize(e,t,s,i,l,c)}static async deserialize(e,t,s){let i=null;if(e instanceof Gp){const{data:{inkLists:c,rect:u,rotation:h,id:m,color:p,opacity:x,borderStyle:{rawWidth:y},popupRef:v},parent:{page:{pageNumber:w}}}=e;i=e={annotationType:qe.INK,color:Array.from(p),thickness:y,opacity:x,paths:{points:c},boxes:null,pageIndex:w-1,rect:u.slice(0),rotation:h,annotationElementId:m,id:m,deleted:!1,popupRef:v}}const l=await super.deserialize(e,t,s);return l._initialData=i,l}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:s}=this;t.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:s}){this._drawingOptions=Wp.getDefaultDrawingOptions({stroke:Me.makeHexColor(...e),"stroke-width":t,"stroke-opacity":s})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:s,rect:i}=this.serializeDraw(e),{_drawingOptions:{stroke:l,"stroke-opacity":c,"stroke-width":u}}=this,h={annotationType:qe.INK,color:Oe._colorManager.convert(l),opacity:c,thickness:u,paths:{lines:t,points:s},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(h.isCopy=!0,h):this.annotationElementId&&!this.#e(h)?null:(h.id=this.annotationElementId,h)}#e(e){const{color:t,thickness:s,opacity:i,pageIndex:l}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((c,u)=>c!==t[u])||e.thickness!==s||e.opacity!==i||e.pageIndex!==l}renderAnnotationElement(e){const{points:t,rect:s}=this.serializeDraw(!1);return e.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:t}),null}}class ap extends Xo{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const xd=8,co=3;class zr{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,s,i){return s-=e,i-=t,s===0?i>0?0:4:s===1?i+6:2-i}static#s=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(e,t,s,i,l,c,u){const h=this.#t(s,i,l,c);for(let m=0;m<8;m++){const p=(-m+h-u+16)%8,x=this.#s[2*p],y=this.#s[2*p+1];if(e[(s+x)*t+(i+y)]!==0)return p}return-1}static#i(e,t,s,i,l,c,u){const h=this.#t(s,i,l,c);for(let m=0;m<8;m++){const p=(m+h+u+16)%8,x=this.#s[2*p],y=this.#s[2*p+1];if(e[(s+x)*t+(i+y)]!==0)return p}return-1}static#a(e,t,s,i){const l=e.length,c=new Int32Array(l);for(let p=0;p<l;p++)c[p]=e[p]<=i?1:0;for(let p=1;p<s-1;p++)c[p*t]=c[p*t+t-1]=0;for(let p=0;p<t;p++)c[p]=c[t*s-1-p]=0;let u=1,h;const m=[];for(let p=1;p<s-1;p++){h=1;for(let x=1;x<t-1;x++){const y=p*t+x,v=c[y];if(v===0)continue;let w=p,A=x;if(v===1&&c[y-1]===0)u+=1,A-=1;else if(v>=1&&c[y+1]===0)u+=1,A+=1,v>1&&(h=v);else{v!==1&&(h=Math.abs(v));continue}const N=[x,p],S=A===x+1,E={isHole:S,points:N,id:u,parent:0};m.push(E);let C;for(const z of m)if(z.id===h){C=z;break}C?C.isHole?E.parent=S?C.parent:h:E.parent=S?h:C.parent:E.parent=S?h:0;const R=this.#n(c,t,p,x,w,A,0);if(R===-1){c[y]=-u,c[y]!==1&&(h=Math.abs(c[y]));continue}let D=this.#s[2*R],O=this.#s[2*R+1];const H=p+D,F=x+O;w=H,A=F;let P=p,Z=x;for(;;){const z=this.#i(c,t,P,Z,w,A,1);D=this.#s[2*z],O=this.#s[2*z+1];const K=P+D,W=Z+O;N.push(W,K);const ce=P*t+Z;if(c[ce+1]===0?c[ce]=-u:c[ce]===1&&(c[ce]=u),K===p&&W===x&&P===H&&Z===F){c[y]!==1&&(h=Math.abs(c[y]));break}else w=P,A=Z,P=K,Z=W}}}return m}static#l(e,t,s,i){if(s-t<=4){for(let H=t;H<s-2;H+=2)i.push(e[H],e[H+1]);return}const l=e[t],c=e[t+1],u=e[s-4]-l,h=e[s-3]-c,m=Math.hypot(u,h),p=u/m,x=h/m,y=p*c-x*l,v=h/u,w=1/m,A=Math.atan(v),N=Math.cos(A),S=Math.sin(A),E=w*(Math.abs(N)+Math.abs(S)),C=w*(1-E+E**2),R=Math.max(Math.atan(Math.abs(S+N)*C),Math.atan(Math.abs(S-N)*C));let D=0,O=t;for(let H=t+2;H<s-2;H+=2){const F=Math.abs(y-p*e[H+1]+x*e[H]);F>D&&(O=H,D=F)}D>(m*R)**2?(this.#l(e,t,O+2,i),this.#l(e,O,s,i)):i.push(l,c)}static#r(e){const t=[],s=e.length;return this.#l(e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t}static#u(e,t,s,i,l,c){const u=new Float32Array(c**2),h=-2*i**2,m=c>>1;for(let A=0;A<c;A++){const N=(A-m)**2;for(let S=0;S<c;S++)u[A*c+S]=Math.exp((N+(S-m)**2)/h)}const p=new Float32Array(256),x=-2*l**2;for(let A=0;A<256;A++)p[A]=Math.exp(A**2/x);const y=e.length,v=new Uint8Array(y),w=new Uint32Array(256);for(let A=0;A<s;A++)for(let N=0;N<t;N++){const S=A*t+N,E=e[S];let C=0,R=0;for(let O=0;O<c;O++){const H=A+O-m;if(!(H<0||H>=s))for(let F=0;F<c;F++){const P=N+F-m;if(P<0||P>=t)continue;const Z=e[H*t+P],z=u[O*c+F]*p[Math.abs(Z-E)];C+=Z*z,R+=z}}const D=v[S]=Math.round(C/R);w[D]++}return[v,w]}static#o(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t}static#h(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let i=-1/0,l=1/0;for(let u=0,h=s.length;u<h;u++){if(e[(u<<2)+3]===0){i=s[u]=255;continue}const p=s[u]=e[u<<2];p>i&&(i=p),p<l&&(l=p)}const c=255/(i-l);for(let u=0;u<t;u++)s[u]=(s[u]-l)*c;return s}static#d(e){let t,s=-1/0,i=-1/0;const l=e.findIndex(h=>h!==0);let c=l,u=l;for(t=l;t<256;t++){const h=e[t];h>s&&(t-c>i&&(i=t-c,u=t-1),s=h,c=t)}for(t=u-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:s,height:i}=e,{maxDim:l}=this.#e;let c=s,u=i;if(s>l||i>l){let y=s,v=i,w=Math.log2(Math.max(s,i)/l);const A=Math.floor(w);w=w===A?A-1:A;for(let S=0;S<w;S++){c=Math.ceil(y/2),u=Math.ceil(v/2);const E=new OffscreenCanvas(c,u);E.getContext("2d").drawImage(e,0,0,y,v,0,0,c,u),y=c,v=u,e!==t&&e.close(),e=E.transferToImageBitmap()}const N=Math.min(l/c,l/u);c=Math.round(c*N),u=Math.round(u*N)}const m=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});m.filter="grayscale(1)",m.drawImage(e,0,0,e.width,e.height,0,0,c,u);const p=m.getImageData(0,0,c,u).data;return[this.#h(p),c,u]}static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:i},l,c,u,h){let m=new OffscreenCanvas(1,1),p=m.getContext("2d",{alpha:!1});const x=200,y=p.font=`${s} ${i} ${x}px ${t}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:w,actualBoundingBoxAscent:A,actualBoundingBoxDescent:N,fontBoundingBoxAscent:S,fontBoundingBoxDescent:E,width:C}=p.measureText(e),R=1.5,D=Math.ceil(Math.max(Math.abs(v)+Math.abs(w)||0,C)*R),O=Math.ceil(Math.max(Math.abs(A)+Math.abs(N)||x,Math.abs(S)+Math.abs(E)||x)*R);m=new OffscreenCanvas(D,O),p=m.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=y,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,D,O),p.fillStyle="black",p.fillText(e,D*(R-1)/2,O*(3-R)/2);const H=this.#h(p.getImageData(0,0,D,O).data),F=this.#o(H),P=this.#d(F),Z=this.#a(H,D,O,P);return this.processDrawnLines({lines:{curves:Z,width:D,height:O},pageWidth:l,pageHeight:c,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,s,i,l){const[c,u,h]=this.#f(e),[m,p]=this.#u(c,u,h,Math.hypot(u,h)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),x=this.#d(p),y=this.#a(m,u,h,x);return this.processDrawnLines({lines:{curves:y,width:u,height:h},pageWidth:t,pageHeight:s,rotation:i,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:i,innerMargin:l,mustSmooth:c,areContours:u}){i%180!==0&&([t,s]=[s,t]);const{curves:h,width:m,height:p}=e,x=e.thickness??0,y=[],v=Math.min(t/m,s/p),w=v/t,A=v/s,N=[];for(const{points:E}of h){const C=c?this.#r(E):E;if(!C)continue;N.push(C);const R=C.length,D=new Float32Array(R),O=new Float32Array(3*(R===2?2:R-2));if(y.push({line:O,points:D}),R===2){D[0]=C[0]*w,D[1]=C[1]*A,O.set([NaN,NaN,NaN,NaN,D[0],D[1]],0);continue}let[H,F,P,Z]=C;H*=w,F*=A,P*=w,Z*=A,D.set([H,F,P,Z],0),O.set([NaN,NaN,NaN,NaN,H,F],0);for(let z=4;z<R;z+=2){const K=D[z]=C[z]*w,W=D[z+1]=C[z+1]*A;O.set(Ce.createBezierPoints(H,F,P,Z,K,W),(z-2)*3),[H,F,P,Z]=[P,Z,K,W]}}if(y.length===0)return null;const S=u?new ap:new Xo;return S.build(y,t,s,1,i,u?0:x,l),{outline:S,newCurves:N,areContours:u,thickness:x,width:m,height:p}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:i,height:l}){let c=1/0,u=-1/0,h=0;for(const C of e){h+=C.length;for(let R=2,D=C.length;R<D;R++){const O=C[R]-C[R-2];c=Math.min(c,O),u=Math.max(u,O)}}let m;c>=-128&&u<=127?m=Int8Array:c>=-32768&&u<=32767?m=Int16Array:m=Int32Array;const p=e.length,x=xd+co*p,y=new Uint32Array(x);let v=0;y[v++]=x*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*m.BYTES_PER_ELEMENT,y[v++]=0,y[v++]=i,y[v++]=l,y[v++]=t?0:1,y[v++]=Math.max(0,Math.floor(s??0)),y[v++]=p,y[v++]=m.BYTES_PER_ELEMENT;for(const C of e)y[v++]=C.length-2,y[v++]=C[0],y[v++]=C[1];const w=new CompressionStream("deflate-raw"),A=w.writable.getWriter();await A.ready,A.write(y);const N=m.prototype.constructor;for(const C of e){const R=new N(C.length-2);for(let D=2,O=C.length;D<O;D++)R[D-2]=C[D]-C[D-2];A.write(R)}A.close();const S=await new Response(w.readable).arrayBuffer(),E=new Uint8Array(S);return x1(E)}static async decompressSignature(e){try{const t=vT(e),{readable:s,writable:i}=new DecompressionStream("deflate-raw"),l=i.getWriter();await l.ready,l.write(t).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,u=0;for await(const C of s)c||=new Uint8Array(new Uint32Array(C.buffer,0,4)[0]),c.set(C,u),u+=C.length;const h=new Uint32Array(c.buffer,0,c.length>>2),m=h[1];if(m!==0)throw new Error(`Invalid version: ${m}`);const p=h[2],x=h[3],y=h[4]===0,v=h[5],w=h[6],A=h[7],N=[],S=(xd+co*w)*Uint32Array.BYTES_PER_ELEMENT;let E;switch(A){case Int8Array.BYTES_PER_ELEMENT:E=new Int8Array(c.buffer,S);break;case Int16Array.BYTES_PER_ELEMENT:E=new Int16Array(c.buffer,S);break;case Int32Array.BYTES_PER_ELEMENT:E=new Int32Array(c.buffer,S);break}u=0;for(let C=0;C<w;C++){const R=h[co*C+xd],D=new Float32Array(R+2);N.push(D);for(let O=0;O<co-1;O++)D[O]=h[co*C+xd+O+1];for(let O=0;O<R;O++)D[O+2]=D[O]+E[u++]}return{areContours:y,thickness:v,outlines:N,width:p,height:x}}catch(t){return Ve(`decompressSignature: ${t}`),null}}}class Xp extends G1{constructor(){super(),super.updateProperties({fill:Oe._defaultLineColor,"stroke-width":0})}clone(){const e=new Xp;return e.updateAll(this),e}}class Qp extends Su{constructor(e){super(e),super.updateProperties({stroke:Oe._defaultLineColor,"stroke-width":1})}clone(){const e=new Qp(this._viewParameters);return e.updateAll(this),e}}class Vn extends ze{#e=!1;#t=null;#s=null;#n=null;static _type="signature";static _editorType=qe.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#s=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){Oe.initialize(e,t),this._defaultDrawingOptions=new Xp,this._defaultDrawnSignatureOptions=new Qp(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return st(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#s){const{lines:i,mustSmooth:l,areContours:c,description:u,uuid:h,heightInPage:m}=this.#s,{rawDims:{pageWidth:p,pageHeight:x},rotation:y}=this.parent.viewport,v=zr.processDrawnLines({lines:i,pageWidth:p,pageHeight:x,rotation:y,innerMargin:Vn._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(v,m,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return s&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#n=e,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#t}set description(e){this.#t=e,super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)})}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:s,width:i,height:l}=this.#s,c=Math.max(i,l),u=zr.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:s,width:i,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,s,i){const{x:l,y:c}=this,{outline:u}=this.#s=e;this.#e=u instanceof ap,this.description=s,this.div.setAttribute("data-l10n-args",JSON.stringify({description:s}));let h;this.#e?h=Vn.getDefaultDrawingOptions():(h=Vn._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[m,p]=this.parentDimensions,[,x]=this.pageDimensions;let y=t/x;y=y>=1?.5:y,this.width*=y/this.height,this.width>=1&&(y*=.9/this.width,this.width=.9),this.height=y,this.setDims(m*this.width,p*this.height),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:s},rotation:i}=this.parent.viewport;return zr.process(e,t,s,i,Vn._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:l}=this.parent.viewport;return zr.extractContoursFromText(e,t,s,i,l,Vn._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:s},rotation:i}=this.parent.viewport;return zr.processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:i,innerMargin:Vn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=Vn.getDefaultDrawingOptions():(this._drawingOptions=Vn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:s,rect:i}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":l}}=this,c={annotationType:qe.SIGNATURE,isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:l,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(c.paths={lines:t,points:s},c.uuid=this.#n,c.isCopy=!0):c.lines=t,this.#t&&(c.accessibilityData={type:"Figure",alt:this.#t}),c}static deserializeDraw(e,t,s,i,l,c){return c.areContours?ap.deserialize(e,t,s,i,l,c):Xo.deserialize(e,t,s,i,l,c)}static async deserialize(e,t,s){const i=await super.deserialize(e,t,s);return i.#e=e.areContours,i.#t=e.accessibilityData?.alt||"",i.#n=e.uuid,i}}class ZD extends Oe{#e=null;#t=null;#s=null;#n=null;#i=null;#a="";#l=null;#r=!1;#u=null;#o=!1;#h=!1;static _type="stamp";static _editorType=qe.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#i=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){Oe.initialize(e,t)}static isHandlingMimeForPasting(e){return Zm.includes(e)}static paste(e,t){t.pasteEditor({mode:qe.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#d(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#o=e.isSvg),e.file&&(this.#a=e.file.name),this.#p()}#f(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:l,height:c}=e||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:i,width:l,height:c,channels:i.length/(l*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),t&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(s=>this.#d(s,!0)).finally(()=>this.#f());return}if(this.#n){const s=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(s).then(i=>this.#d(i)).finally(()=>this.#f());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(s).then(i=>this.#d(i)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=Zm.join(",");const t=this._uiManager._signal;this.#s=new Promise(s=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#d(i)}s()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),s()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#l?.remove(),this.#l=null,this.#u&&(clearTimeout(this.#u),this.#u=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#m();return}super.rebuild(),this.div!==null&&(this.#t&&this.#l===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#s||this.#e||this.#n||this.#i||this.#t||this.#r)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#r||(this.#e?this.#p():this.#m()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:s,bitmap:i}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#t=s,i&&(this.#e=i),this.#r=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#u!==null&&clearTimeout(this.#u);const e=200;this.#u=setTimeout(()=>{this.#u=null,this.#g()},e)}#p(){const{div:e}=this;let{width:t,height:s}=this.#e;const[i,l]=this.pageDimensions,c=.75;if(this.width)t=this.width*i,s=this.height*l;else if(t>c*i||s>c*l){const p=Math.min(c*i/t,c*l/s);t*=p,s*=p}const[u,h]=this.parentDimensions;this.setDims(t*u/i,s*h/l),this._uiManager.enableWaiting(!1);const m=this.#l=document.createElement("canvas");m.setAttribute("role","img"),this.addContainer(m),this.width=t/i,this.height=s/l,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#g(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#a&&this.div.setAttribute("aria-description",this.#a),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,s=!1){e||(e=224);const{width:i,height:l}=this.#e,c=new Wn;let u=this.#e,h=i,m=l,p=null;if(t){if(i>t||l>t){const O=Math.min(t/i,t/l);h=Math.floor(i*O),m=Math.floor(l*O)}p=document.createElement("canvas");const y=p.width=Math.ceil(h*c.sx),v=p.height=Math.ceil(m*c.sy);this.#o||(u=this.#c(y,v));const w=p.getContext("2d");w.filter=this._uiManager.hcmFilter;let A="white",N="#cfcfd8";this._uiManager.hcmFilter!=="none"?N="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(A="#8f8f9d",N="#42414d");const S=15,E=S*c.sx,C=S*c.sy,R=new OffscreenCanvas(E*2,C*2),D=R.getContext("2d");D.fillStyle=A,D.fillRect(0,0,E*2,C*2),D.fillStyle=N,D.fillRect(0,0,E,C),D.fillRect(E,C,E,C),w.fillStyle=w.createPattern(R,"repeat"),w.fillRect(0,0,y,v),w.drawImage(u,0,0,u.width,u.height,0,0,y,v)}let x=null;if(s){let y,v;if(c.symmetric&&u.width<e&&u.height<e)y=u.width,v=u.height;else if(u=this.#e,i>e||l>e){const N=Math.min(e/i,e/l);y=Math.floor(i*N),v=Math.floor(l*N),this.#o||(u=this.#c(y,v))}const A=new OffscreenCanvas(y,v).getContext("2d",{willReadFrequently:!0});A.drawImage(u,0,0,u.width,u.height,0,0,y,v),x={width:y,height:v,data:A.getImageData(0,0,y,v).data}}return{canvas:p,width:h,height:m,imageData:x}}#c(e,t){const{width:s,height:i}=this.#e;let l=s,c=i,u=this.#e;for(;l>2*e||c>2*t;){const h=l,m=c;l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*t&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const p=new OffscreenCanvas(l,c);p.getContext("2d").drawImage(u,0,0,h,m,0,0,l,c),u=p.transferToImageBitmap()}return u}#g(){const[e,t]=this.parentDimensions,{width:s,height:i}=this,l=new Wn,c=Math.ceil(s*e*l.sx),u=Math.ceil(i*t*l.sy),h=this.#l;if(!h||h.width===c&&h.height===u)return;h.width=c,h.height=u;const m=this.#o?this.#e:this.#c(c,u),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(m,0,0,m.width,m.height,0,0,c,u)}#x(e){if(e){if(this.#o){const i=this._uiManager.imageManager.getSvgUrl(this.#t);if(i)return i}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#o){const[t,s]=this.pageDimensions,i=Math.round(this.width*t*Kr.PDF_TO_CSS_UNITS),l=Math.round(this.height*s*Kr.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(i,l);return c.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,i,l),c.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,s){let i=null,l=!1;if(e instanceof V1){const{data:{rect:A,rotation:N,id:S,structParent:E,popupRef:C},container:R,parent:{page:{pageNumber:D}},canvas:O}=e;let H,F;O?(delete e.canvas,{id:H,bitmap:F}=s.imageManager.getFromCanvas(R.id,O),O.remove()):(l=!0,e._hasNoCanvas=!0);const P=(await t._structTree.getAriaAttributes(`${Op}${S}`))?.get("aria-label")||"";i=e={annotationType:qe.STAMP,bitmapId:H,bitmap:F,pageIndex:D-1,rect:A.slice(0),rotation:N,annotationElementId:S,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:P},isSvg:!1,structParent:E,popupRef:C}}const c=await super.deserialize(e,t,s),{rect:u,bitmap:h,bitmapUrl:m,bitmapId:p,isSvg:x,accessibilityData:y}=e;l?(s.addMissingCanvas(e.id,c),c.#r=!0):p&&s.imageManager.isValidId(p)?(c.#t=p,h&&(c.#e=h)):c.#n=m,c.#o=x;const[v,w]=c.pageDimensions;return c.width=(u[2]-u[0])/v,c.height=(u[3]-u[1])/w,y&&(c.altTextData=y),c._initialData=i,c.#h=!!i,c}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:qe.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#o,structTreeParentId:this._structTreeParentId};if(e)return s.bitmapUrl=this.#x(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:i,altText:l}=this.serializeAltText(!1);if(!i&&l&&(s.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#y(s);if(u.isSame)return null;u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,t===null)return s;t.stamps||=new Map;const c=this.#o?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:c,serialized:s}),s.bitmap=this.#x(!1);else if(this.#o){const u=t.stamps.get(this.#t);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#x(!1))}return s}#y(e){const{pageIndex:t,accessibilityData:{altText:s}}=this._initialData,i=e.pageIndex===t,l=(e.accessibilityData?.alt||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&l,isSameAltText:l}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class fa{#e;#t=!1;#s=null;#n=null;#i=null;#a=new Map;#l=!1;#r=!1;#u=!1;#o=null;#h=null;#d=null;#f=null;#m=null;#p=-1;#c;static _initialized=!1;static#g=new Map([Jt,Wp,ZD,zt,Vn].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:l,annotationLayer:c,drawLayer:u,textLayer:h,viewport:m,l10n:p}){const x=[...fa.#g.values()];if(!fa._initialized){fa._initialized=!0;for(const y of x)y.initialize(p,e)}e.registerEditorTypes(x),this.#c=e,this.pageIndex=t,this.div=s,this.#e=l,this.#s=c,this.viewport=m,this.#d=h,this.drawLayer=u,this._structTree=i,this.#c.addLayer(this)}get isEmpty(){return this.#a.size===0}get isInvisible(){return this.isEmpty&&this.#c.getMode()===qe.NONE}updateToolbar(e){this.#c.updateToolbar(e)}updateMode(e=this.#c.getMode()){switch(this.#A(),e){case qe.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case qe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case qe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of fa.#g.values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#d?.div}setEditingState(e){this.#c.setEditingState(e)}addCommands(e){this.#c.addCommands(e)}cleanUndoStack(e){this.#c.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#s?.div.classList.toggle("disabled",!e)}async enable(){this.#u=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.#m?.abort(),this.#m=null;const e=new Set;for(const s of this.#a.values())s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#c.removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!this.#s){this.#u=!1;return}const t=this.#s.getEditableAnnotations();for(const s of t){if(s.hide(),this.#c.isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}this.#u=!1}disable(){if(this.#r=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.#d&&!this.#m){this.#m=new AbortController;const i=this.#c.combinedSignal(this.#m);this.#d.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:h,timeStamp:m}=l,p=this.#p;if(m-p>500){this.#p=m;return}this.#p=-1;const{classList:x}=this.div;x.toggle("getElements",!0);const y=document.elementsFromPoint(u,h);if(x.toggle("getElements",!1),!this.div.contains(y[0]))return;let v;const w=new RegExp(`^${h1}[0-9]+$`);for(const N of y)if(w.test(N.id)){v=N.id;break}if(!v)return;const A=this.#a.get(v);A?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),A.dblclick())},{signal:i,capture:!0})}const e=new Map,t=new Map;for(const i of this.#a.values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){e.set(i.annotationElementId,i);continue}else t.set(i.annotationElementId,i);this.getEditableAnnotation(i.annotationElementId)?.show(),i.remove()}if(this.#s){const i=this.#s.getEditableAnnotations();for(const l of i){const{id:c}=l.data;if(this.#c.isDeletedAnnotationElement(c))continue;let u=t.get(c);if(u){u.resetAnnotationElement(l),u.show(!1),l.show();continue}u=e.get(c),u&&(this.#c.addChangedExistingAnnotation(u),u.renderAnnotationElement(l)&&u.show(!1)),l.show()}}this.#A(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const i of fa.#g.values())s.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#r=!1}getEditableAnnotation(e){return this.#s?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#c.getActive()!==e&&this.#c.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#d?.div&&!this.#f){this.#f=new AbortController;const e=this.#c.combinedSignal(this.#f);this.#d.div.addEventListener("pointerdown",this.#x.bind(this),{signal:e}),this.#d.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#d?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#d.div.classList.remove("highlighting"))}#x(e){this.#c.unselectAll();const{target:t}=e;if(t===this.#d.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#d.div.contains(t)){const{isMac:s}=fs.platform;if(e.button!==0||e.ctrlKey&&s)return;this.#c.showAllEditors("highlight",!0,!0),this.#d.div.classList.add("free"),this.toggleDrawing(),zt.startHighlighting(this,this.#c.direction==="ltr",{target:this.#d.div,x:e.x,y:e.y}),this.#d.div.addEventListener("pointerup",()=>{this.#d.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#c._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#c.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#a.set(e.id,e);const{annotationElementId:t}=e;t&&this.#c.isDeletedAnnotationElement(t)&&this.#c.removeDeletedAnnotationElement(e)}detach(e){this.#a.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#r&&e.annotationElementId&&this.#c.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#c.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#c.addDeletedAnnotationElement(e.annotationElementId),Oe.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#c.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#u),this.#c.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#i&&(e._focusEventsAllowed=!1,this.#i=setTimeout(()=>{this.#i=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#c._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return this.#c.getId()}get#y(){return fa.#g.get(this.#c.getMode())}combinedSignal(e){return this.#c.combinedSignal(e)}#v(e){const t=this.#y;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#c.updateMode(e.mode);const{offsetX:s,offsetY:i}=this.#w(),l=this.getNextId(),c=this.#v({parent:this,id:l,x:s,y:i,uiManager:this.#c,isCentered:!0,...t});c&&this.add(c)}async deserialize(e){return await fa.#g.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#c)||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),l=this.#v({parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:this.#c,isCentered:t,...s});return l&&this.add(l),l}#w(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),l=Math.max(0,e),c=Math.max(0,t),u=Math.min(window.innerWidth,e+s),h=Math.min(window.innerHeight,t+i),m=(l+u)/2-e,p=(c+h)/2-t,[x,y]=this.viewport.rotation%180===0?[m,p]:[p,m];return{offsetX:x,offsetY:y}}addNewEditor(e={}){this.createAndAddNewEditor(this.#w(),!0,e)}setSelected(e){this.#c.setSelected(e)}toggleSelected(e){this.#c.toggleSelected(e)}unselect(e){this.#c.unselect(e)}pointerup(e){const{isMac:t}=fs.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#l||(this.#l=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const s=this.#c.getMode();if(s===qe.STAMP||s===qe.SIGNATURE){this.#c.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#c.getMode()===qe.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:t}=fs.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#l=!0,this.#y?.isDrawer){this.startDrawingSession(e);return}const s=this.#c.getActive();this.#t=!s||s.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#o){this.#y.startDrawing(this,this.#c,!1,e);return}this.#c.setCurrentDrawingSession(this),this.#o=new AbortController;const t=this.#c.combinedSignal(this.#o);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#y.startDrawing(this,this.#c,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#o?(this.#c.setCurrentDrawingSession(null),this.#o.abort(),this.#o=null,this.#h=null,this.#y.endDrawing(e)):null}findNewParent(e,t,s){const i=this.#c.findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return this.#o?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#o&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#c.getActive()?.parent===this&&(this.#c.commitOrRemove(),this.#c.setActiveEditor(null)),this.#i&&(clearTimeout(this.#i),this.#i=null);for(const e of this.#a.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#a.clear(),this.#c.removeLayer(this)}#A(){for(const e of this.#a.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,Fi(this.div,e);for(const t of this.#c.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#c.commitOrRemove(),this.#A();const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,Fi(this.div,{rotation:s}),t!==s)for(const i of this.#a.values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#c.viewParameters.realScale}}class us{#e=null;#t=new Map;#s=new Map;static#n=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return st(this,"_svgFactory",new Yd)}static#i(e,[t,s,i,l]){const{style:c}=e;c.top=`${100*s}%`,c.left=`${100*t}%`,c.width=`${100*i}%`,c.height=`${100*l}%`}#a(){const e=us._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#l(e,t){const s=us._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const l=us._svgFactory.createElement("use");return s.append(l),l.setAttribute("href",`#${t}`),l.classList.add("clip"),i}#r(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)}draw(e,t=!1,s=!1){const i=us.#n++,l=this.#a(),c=us._svgFactory.createElement("defs");l.append(c);const u=us._svgFactory.createElement("path");c.append(u);const h=`path_p${this.pageIndex}_${i}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#s.set(i,u);const m=s?this.#l(c,h):null,p=us._svgFactory.createElement("use");return l.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(l,e),this.#t.set(i,l),{id:i,clipPathId:`url(#${m})`}}drawOutline(e,t){const s=us.#n++,i=this.#a(),l=us._svgFactory.createElement("defs");i.append(l);const c=us._svgFactory.createElement("path");l.append(c);const u=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const x=us._svgFactory.createElement("mask");l.append(x),h=`mask_p${this.pageIndex}_${s}`,x.setAttribute("id",h),x.setAttribute("maskUnits","objectBoundingBox");const y=us._svgFactory.createElement("rect");x.append(y),y.setAttribute("width","1"),y.setAttribute("height","1"),y.setAttribute("fill","white");const v=us._svgFactory.createElement("use");x.append(v),v.setAttribute("href",`#${u}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const m=us._svgFactory.createElement("use");i.append(m),m.setAttribute("href",`#${u}`),h&&m.setAttribute("mask",`url(#${h})`);const p=m.cloneNode();return i.append(p),m.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(i,e),this.#t.set(s,i),s}finalizeDraw(e,t){this.#s.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:s,bbox:i,rootClass:l,path:c}=t,u=typeof e=="number"?this.#t.get(e):e;if(u){if(s&&this.#r(u,s),i&&us.#i(u,i),l){const{classList:h}=u;for(const[m,p]of Object.entries(l))h.toggle(m,p)}if(c){const m=u.firstChild.firstChild;this.#r(m,c)}}}updateParent(e,t){if(t===this)return;const s=this.#t.get(e);s&&(t.#e.append(s),this.#t.delete(e),t.#t.set(e,s))}remove(e){this.#s.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#s.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:sp};globalThis.pdfjsLib={AbortException:Ka,AnnotationEditorLayer:fa,AnnotationEditorParamsType:at,AnnotationEditorType:qe,AnnotationEditorUIManager:Ja,AnnotationLayer:Yp,AnnotationMode:Ga,AnnotationType:Yt,build:TD,ColorPicker:fn,createValidAbsoluteUrl:f1,DOMSVGFactory:Yd,DrawLayer:us,FeatureTest:fs,fetchData:$o,getDocument:SD,getFilenameFromUrl:wT,getPdfFilenameFromUrl:AT,getUuid:g1,getXfaPageViewport:ST,GlobalWorkerOptions:Yr,ImageKind:Rd,InvalidPDFException:Qm,isDataScheme:wu,isPdfFile:Ip,isValidExplicitDest:OT,MathClamp:Ss,noContextMenu:_n,normalizeUnicode:yT,OPS:$d,OutputScale:Wn,PasswordResponses:cT,PDFDataRangeTransport:L1,PDFDateString:y1,PDFWorker:Ro,PermissionFlag:oT,PixelsPerInch:Kr,RenderingCancelledException:Pp,ResponseException:Gd,setLayerDimensions:Fi,shadow:st,SignatureExtractor:zr,stopEvent:Wt,SupportedImageMimeTypes:Zm,TextLayer:As,TouchManager:Au,updateUrlHash:m1,Util:Me,VerbosityLevel:yu,version:I1,XfaLayer:B1};Yr.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${I1}/pdf.worker.min.js`;const KD=({employeeId:n,onClose:e})=>{const[t,s]=_.useState(null),[i,l]=_.useState(!0),[c,u]=_.useState({});_.useEffect(()=>{n&&(async()=>{try{l(!0);const[x,y]=await Promise.all([xe.get(`/employee/${n}`),xe.get(`/employee/bank/${n}`).catch(v=>{if(v.response?.status===404)return{data:null};throw v})]);s({...x.data.data,bankDetails:y.data})}catch(x){console.error("Error fetching employee details:",x),alert("Error loading employee details")}finally{l(!1)}})()},[n]);const h=p=>{try{return p.split("/").pop().split("?")[0]}catch{return"document.pdf"}},m=async(p,x,y)=>{u(v=>({...v,[y]:!0}));try{const v=await xe.get(p,{responseType:"blob"}),w=new Blob([v.data],{type:v.data.type}),A=window.URL.createObjectURL(w),N=document.createElement("a");N.href=A,N.download=x||p.split("/").pop(),document.body.appendChild(N),N.click(),N.remove(),window.URL.revokeObjectURL(A)}catch(v){console.error("Download failed:",v),alert("Download failed. Please try again.")}finally{u(v=>({...v,[y]:!1}))}};return i?r.jsx("div",{className:"fixed inset-0 bg-opacity-50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:r.jsx("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full p-6",children:r.jsx("div",{className:"flex justify-center items-center h-40",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#104774]"})})})}):t?r.jsx("div",{className:"fixed inset-0 bg-opacity-50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl flex justify-between items-center",children:[r.jsxs("h2",{className:"text-2xl font-bold text-gray-800",children:["Employee Details - ",t.firstName," ",t.lastName]}),r.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-2xl",children:"×"})]}),r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4 text-[#104774]",children:"Personal Information"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Employee ID:"}),r.jsx("span",{className:"text-gray-700",children:t.employeeId})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Name:"}),r.jsxs("span",{className:"text-gray-700",children:[t.firstName," ",t.lastName]})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Email:"}),r.jsx("span",{className:"text-gray-700",children:t.user?.email})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Phone:"}),r.jsx("span",{className:"text-gray-700",children:t.phone||"N/A"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Date of Birth:"}),r.jsx("span",{className:"text-gray-700",children:t.dob?new Date(t.dob).toLocaleDateString():"N/A"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Gender:"}),r.jsx("span",{className:"text-gray-700 capitalize",children:t.gender||"N/A"})]}),r.jsxs("div",{className:"flex items-start",children:[r.jsx("span",{className:"font-medium w-32",children:"Address:"}),r.jsx("span",{className:"text-gray-700 flex-1",children:t.address||"N/A"})]})]})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4 text-[#104774]",children:"Job Information"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Department:"}),r.jsx("span",{className:"text-gray-700",children:t.department||"N/A"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Designation:"}),r.jsx("span",{className:"text-gray-700",children:t.designation||"N/A"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Date of Joining:"}),r.jsx("span",{className:"text-gray-700",children:t.dateOfJoining?new Date(t.dateOfJoining).toLocaleDateString():"N/A"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Employment Type:"}),r.jsx("span",{className:"text-gray-700 capitalize",children:t.employmentType?.replace("-"," ")||"N/A"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Work Mode:"}),r.jsx("span",{className:"text-gray-700 capitalize",children:t.workMode?.replace(/-/g," ")||"N/A"})]}),t.shiftTiming?.start||t.shiftTiming?.end?r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Shift Timing:"}),r.jsx("span",{className:"text-gray-700",children:t.shiftTiming.start&&t.shiftTiming.end?`${t.shiftTiming.start} - ${t.shiftTiming.end}`:"N/A"})]}):null,r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Role:"}),r.jsx("span",{className:"text-gray-700 capitalize",children:t.user?.role||"N/A"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-32",children:"Status:"}),r.jsx("span",{className:`px-2 py-1 rounded text-xs ${t.user?.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.user?.isActive?"Active":"Inactive"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.bankDetails&&r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4 text-[#104774]",children:"Bank Details"}),r.jsxs("div",{className:"space-y-3 text-gray-700",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-36",children:"Account Holder:"}),r.jsx("span",{className:"font-semibold",children:t.bankDetails.accountHolderName})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-36",children:"Account Number:"}),r.jsx("span",{className:"font-semibold",children:t.bankDetails.accountNumber})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-36",children:"Bank Name:"}),r.jsx("span",{className:"font-semibold",children:t.bankDetails.bankName})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-36",children:"IFSC Code:"}),r.jsx("span",{className:"font-semibold",children:t.bankDetails.ifscCode})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium w-36",children:"Account Type:"}),r.jsx("span",{className:"font-semibold",children:t.bankDetails.accountType})]})]})]}),t.documents?.length>0&&r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4 text-[#104774]",children:"Documents"}),r.jsx("div",{className:"space-y-2",children:t.documents.map((p,x)=>r.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded border",children:[r.jsx("span",{className:"text-sm text-gray-700 truncate",children:p.name||h(p.url)}),r.jsx("div",{className:"flex items-center space-x-3",children:r.jsx("button",{onClick:()=>m(p.url,p.name,x),disabled:c?.[x],className:"text-[#104774] hover:underline text-sm font-medium",children:c?.[x]?"Downloading...":"Download"})})]},x))})]})]})]}),r.jsx("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 p-6 rounded-b-xl text-right",children:r.jsx("button",{onClick:e,className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Close"})})]})}):r.jsx("div",{className:"fixed inset-0 bg-opacity-50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:r.jsx("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full p-6",children:r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:"text-red-500",children:"Employee not found"}),r.jsx("button",{onClick:e,className:"mt-4 px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Close"})]})})})},lv=()=>{const[n,e]=_.useState(!1),[t,s]=_.useState([]),[i,l]=_.useState(null),[c,u]=_.useState(null),[h,m]=_.useState(!1),p=async()=>{try{const N=await xe.get("/employee/all-employees");s(N.data.data||[])}catch(N){console.error("Error fetching employees:",N)}};_.useEffect(()=>{p()},[]);const x=()=>{l(null),e(!0)},y=async N=>{if(!N?._id){l(N),e(!0);return}m(!0);try{const S=await xe.get(`/employee/${N._id}`),E=S.data?.data||S.data||N;l(E),e(!0)}catch(S){console.warn("Could not fetch full employee, opening with provided object:",S),l(N),e(!0)}finally{m(!1)}},v=()=>{e(!1),l(null),p()},w=N=>{u(N._id)},A=()=>{u(null)};return r.jsxs("div",{className:"p-4 md:p-6 bg-gray-50 min-h-[80vh]",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6 md:mb-8",children:[r.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800 text-center sm:text-left",children:"Manage Employees"}),r.jsx("button",{onClick:x,className:"px-4 py-2 md:px-6 md:py-3 text-white font-semibold rounded-lg hover:opacity-90 transition shadow-md hover:shadow-lg w-full sm:w-auto text-sm md:text-base",style:{backgroundColor:"#104774"},children:"+ New Employee"})]}),r.jsxs("div",{className:"bg-white rounded-xl md:rounded-2xl shadow-lg overflow-hidden",children:[r.jsx("div",{className:"block md:hidden  space-y-4 ",children:t.length>0?t.map((N,S)=>r.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm hover:shadow-md transition-all duration-200",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-50 text-blue-600 text-xs font-bold mr-2",children:S+1}),r.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Employee ID"})]}),r.jsx("p",{className:"text-sm font-mono font-semibold bg-blue-50 px-2 py-1 rounded-md text-blue-700",children:N.employeeId||"N/A"})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-1",children:[N.firstName," ",N.lastName]}),r.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:N.department||"N/A"}),r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:N.designation||"N/A"})]}),r.jsxs("div",{className:"mt-3 flex items-center text-sm text-gray-600",children:[r.jsx("svg",{className:"w-4 h-4 mr-1.5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),r.jsx("span",{className:"truncate",children:N.user?.email||"N/A"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:()=>y(N),className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-all duration-200 shadow-sm active:scale-95",style:{backgroundColor:"#104774"},children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),r.jsxs("button",{onClick:()=>w(N),className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-all duration-200 shadow-sm active:scale-95",children:[r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View"]})]})]},N._id)):r.jsx("div",{className:"text-center p-8 bg-gradient-to-br from-gray-50 to-blue-50 rounded-2xl border border-gray-100 shadow-sm",children:r.jsxs("div",{className:"flex flex-col items-center justify-center",children:[r.jsxs("div",{className:"relative mb-4",children:[r.jsx("svg",{className:"w-16 h-16 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})]}),r.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-1",children:"No employees found"}),r.jsx("p",{className:"text-sm text-gray-500 max-w-xs",children:"Get started by adding your first employee to the system"}),r.jsx("button",{className:"mt-4 px-4 py-2 text-sm font-medium text-white rounded-lg shadow-sm hover:opacity-90 transition-all duration-200",style:{backgroundColor:"#104774"},children:"+ New Employee"})]})})}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{children:r.jsxs("tr",{className:"bg-[#104774] text-white",children:[r.jsx("th",{className:"p-3 md:p-4 text-left font-semibold text-xs md:text-sm uppercase tracking-wider",children:"#"}),r.jsx("th",{className:"p-3 md:p-4 text-left font-semibold text-xs md:text-sm uppercase tracking-wider",children:"Employee ID"}),r.jsx("th",{className:"p-3 md:p-4 text-left font-semibold text-xs md:text-sm uppercase tracking-wider",children:"Name"}),r.jsx("th",{className:"p-3 md:p-4 text-left font-semibold text-xs md:text-sm uppercase tracking-wider",children:"Department"}),r.jsx("th",{className:"p-3 md:p-4 text-left font-semibold text-xs md:text-sm uppercase tracking-wider",children:"Designation"}),r.jsx("th",{className:"p-3 md:p-4 text-left font-semibold text-xs md:text-sm uppercase tracking-wider",children:"Email"}),r.jsx("th",{className:"p-3 md:p-4 text-center font-semibold text-xs md:text-sm uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:t.length>0?t.map((N,S)=>r.jsxs("tr",{className:"hover:bg-blue-50 transition-colors duration-150 even:bg-gray-50",children:[r.jsx("td",{className:"p-3 md:p-4 font-medium text-gray-700 text-sm",children:S+1}),r.jsx("td",{className:"p-3 md:p-4 font-mono text-xs md:text-sm text-blue-700",children:N.employeeId||"N/A"}),r.jsxs("td",{className:"p-3 md:p-4 font-medium text-sm",children:[N.firstName," ",N.lastName]}),r.jsx("td",{className:"p-3 md:p-4",children:r.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:N.department||"N/A"})}),r.jsx("td",{className:"p-3 md:p-4 text-sm",children:N.designation||"N/A"}),r.jsx("td",{className:"p-3 md:p-4 text-blue-600 text-sm",children:N.user?.email||"N/A"}),r.jsxs("td",{className:"p-3 md:p-4 flex justify-center space-x-2",children:[r.jsx("button",{onClick:()=>y(N),className:"px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm font-medium text-white rounded-lg hover:opacity-90 transition shadow-sm",style:{backgroundColor:"#104774"},children:"Edit"}),r.jsx("button",{onClick:()=>w(N),className:"px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm font-medium bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition shadow-sm",children:"View"})]})]},N._id)):r.jsx("tr",{children:r.jsx("td",{colSpan:"7",className:"text-center p-6 md:p-8 text-gray-500",children:r.jsxs("div",{className:"flex flex-col items-center justify-center",children:[r.jsx("svg",{className:"w-16 h-16 text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),r.jsx("p",{className:"text-lg md:text-xl",children:"No employees found"}),r.jsx("p",{className:"mt-2 text-sm md:text-base",children:'Click "New Employee" to add your first employee'})]})})})})]})})]}),c&&r.jsx(KD,{employeeId:c,onClose:A}),n&&r.jsx("div",{className:"fixed inset-0  bg-opacity-40 backdrop-blur-sm z-50 flex items-center justify-center p-2 md:p-4",children:h?r.jsxs("div",{className:"bg-white rounded-lg md:rounded-xl p-4 md:p-8 flex items-center justify-center max-w-xs md:max-w-md w-full",children:[r.jsx("div",{className:"animate-spin rounded-full h-6 w-6 md:h-8 md:w-8 border-b-2 border-[#104774] mr-3 md:mr-4"}),r.jsx("div",{className:"text-sm md:text-base",children:"Loading employee details..."})]}):r.jsx(lT,{onClose:v,employee:i,isEditMode:!!i})})]})},xm=({children:n,allowedRoles:e})=>{const{user:t,loading:s}=ls();if(s)return r.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading..."});if(!t)return r.jsx(pa,{to:"/login",replace:!0});if(!e.includes(t.role)){if(t.role==="admin")return r.jsx(pa,{to:"/admin",replace:!0});if(t.role==="hr")return r.jsx(pa,{to:"/hr",replace:!0});if(t.role==="employee")return r.jsx(pa,{to:"/employee",replace:!0})}return n},JD=({isOpen:n,onClose:e,onSave:t,existingData:s})=>{const[i,l]=_.useState({accountHolderName:"",accountNumber:"",bankName:"",ifscCode:"",accountType:"savings"});_.useEffect(()=>{s&&l(s)},[s]);const c=h=>{l({...i,[h.target.name]:h.target.value})},u=async h=>{h.preventDefault(),await t(i)};return n?r.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:s?"Update Bank Details":"Add Bank Details"}),r.jsxs("form",{onSubmit:u,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Account Holder Name"}),r.jsx("input",{type:"text",name:"accountHolderName",value:i.accountHolderName,onChange:c,required:!0,className:"w-full p-2 border rounded"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Account Number"}),r.jsx("input",{type:"text",name:"accountNumber",value:i.accountNumber,onChange:c,required:!0,className:"w-full p-2 border rounded"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bank Name"}),r.jsx("input",{type:"text",name:"bankName",value:i.bankName,onChange:c,required:!0,className:"w-full p-2 border rounded"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"IFSC Code"}),r.jsx("input",{type:"text",name:"ifscCode",value:i.ifscCode,onChange:c,required:!0,className:"w-full p-2 border rounded uppercase"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Account Type"}),r.jsxs("select",{name:"accountType",value:i.accountType,onChange:c,className:"w-full p-2 border rounded",children:[r.jsx("option",{value:"savings",children:"Savings"}),r.jsx("option",{value:"current",children:"Current"}),r.jsx("option",{value:"other",children:"Other"})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-3",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border rounded hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-4 py-2 bg-[#104774] text-white rounded hover:bg-[#0d3a5f]",children:s?"Update":"Save"})]})]})]})}):null},ym=()=>{const[n,e]=_.useState(null),[t,s]=_.useState(null),[i,l]=_.useState(!0),[c,u]=_.useState(!1),[h,m]=_.useState(!1);_.useEffect(()=>{p(),x()},[]);const p=async()=>{try{const S=await xe.get("/employee/profile");e(S.data.data)}catch(S){console.error("Error fetching employee profile:",S)}finally{l(!1)}},x=async()=>{try{const S=await xe.get("/employee/bank/me");s(S.data||null)}catch(S){console.error("Error fetching bank details:",S)}},y=async S=>{try{await xe.post("/employee/bank",S),alert(t?"Bank details updated!":"Bank details added!"),m(!1),x()}catch(E){console.error(E),alert(E.response?.data?.message||"Failed to save bank details")}},v=async S=>{const E=S.target.files[0];if(!E)return;if(!["image/jpeg","image/jpg","image/png","image/gif"].includes(E.type)){alert("Please select a valid image file (JPEG, PNG, GIF)");return}if(E.size>5*1024*1024){alert("Image size should be less than 5MB");return}u(!0);try{const R=new FormData;R.append("image",E);const D=await xe.patch("/employee/profile/image",R,{headers:{"Content-Type":"multipart/form-data"}});e(O=>({...O,avatarUrl:D.data.data.avatarUrl})),alert("Profile image updated successfully!")}catch(R){console.error(R),alert(R.response?.data?.message||"Failed to upload image")}finally{u(!1),S.target.value=""}},w=S=>S?`XXXX-XXXX-${S.slice(-4)}`:"N/A";function A(S){if(S===null||typeof S>"u"||S==="")return"";const E=P=>{if(!P&&P!==0)return null;if(P instanceof Date)return{hour:P.getHours(),minute:P.getMinutes()};if(typeof P=="object"){const Z=Number(P.hour??P.h??P.H??P.hours??P.hours24),z=Number(P.minute??P.m??0);return Number.isNaN(Z)?null:{hour:Z,minute:z}}if(typeof P=="number"){const Z=Math.floor(P),z=Math.round((P-Z)*60);return{hour:Z,minute:z}}if(typeof P=="string"){let Z=P.trim();(Z.startsWith('"')&&Z.endsWith('"')||Z.startsWith("'")&&Z.endsWith("'"))&&(Z=Z.slice(1,-1).trim());const z=Z.match(/\b(AM|PM)\b/i),K=!!z;K&&(Z=Z.replace(/\b(AM|PM)\b/i,"").trim());const W=Z.split(":").map(L=>L.trim());let ce,me;if(W.length===1){const L=W[0];if(/^\d{3,4}$/.test(L)){const q=L.padStart(4,"0");ce=parseInt(q.slice(0,2),10),me=parseInt(q.slice(2),10)}else ce=parseInt(L,10),me=0}else ce=parseInt(W[0],10),me=parseInt(W[1],10)||0;if(Number.isNaN(ce))return null;if(K){const L=z[0].toUpperCase();L==="PM"&&ce!==12&&(ce+=12),L==="AM"&&ce===12&&(ce=0)}return{hour:ce,minute:me}}return null},C=({hour:P,minute:Z})=>{if(P===null||typeof P>"u")return"";const z=P>=12?"PM":"AM",K=P%12===0?12:P%12,W=String(Z??0).padStart(2,"0");return`${String(K).padStart(2,"0")}:${W} ${z}`},R=P=>{if(typeof P=="string"){const Z=P.split(/–|—|-|\bto\b/i).map(z=>z.trim()).filter(Boolean);if(Z.length>=2)return Z.slice(0,2);try{const z=JSON.parse(P);if(Array.isArray(z))return z;if(z&&typeof z=="object")return[z.start??z.from??z.startTime,z.end??z.to??z.endTime]}catch{}return[P]}return Array.isArray(P)?P:typeof P=="object"?[P.start??P.from??P.startTime??P[0],P.end??P.to??P.endTime??P[1]]:[String(P)]},[D,O]=R(S),H=E(D),F=E(O);return H&&F?`${C(H)} – ${C(F)}`:H?C(H):typeof S=="string"?S:Array.isArray(S)?S.join(" – "):typeof S=="object"?`${D??""}${O?" – "+O:""}`:String(S)}const N=S=>S?new Date(S).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A";return i?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#104774]"})}):n?r.jsxs("div",{className:"max-w-6xl mx-auto min-h-[75vh]",children:[r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-2",children:r.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6",children:[r.jsxs("div",{className:"flex-shrink-0 relative",children:[r.jsxs("div",{className:"w-32 h-32 rounded-full bg-gray-100 flex items-center justify-center border-2 border-gray-200 relative group",children:[n.avatarUrl?r.jsx("img",{src:n.avatarUrl,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):r.jsxs("span",{className:"text-4xl text-gray-600 font-semibold",children:[n.firstName?.charAt(0),n.lastName?.charAt(0)]}),r.jsxs("label",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",children:[c?r.jsx(OC,{className:"w-6 h-6 text-white animate-spin"}):r.jsx(fC,{className:"w-6 h-6 text-white"}),r.jsx("input",{type:"file",accept:"image/*",onChange:v,className:"hidden",disabled:c})]})]}),r.jsxs("div",{className:"text-center mt-3",children:[r.jsxs("label",{className:"text-sm text-[#104774] cursor-pointer hover:underline",children:["Change Photo",r.jsx("input",{type:"file",accept:"image/*",onChange:v,className:"hidden",disabled:c})]}),c&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Uploading..."})]})]}),r.jsxs("div",{className:"flex-1 text-center md:text-left",children:[r.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:[n.firstName," ",n.lastName]}),r.jsx("p",{className:"text-xl text-[#104774] font-semibold mb-3",children:n.designation||"Software Developer"}),r.jsxs("div",{className:"space-y-1 text-gray-600",children:[r.jsxs("p",{children:["Employee ID:"," ",r.jsx("span",{className:"font-medium text-gray-800",children:n.employeeId})]}),r.jsxs("p",{children:["Date of Joining:"," ",r.jsx("span",{className:"font-medium text-gray-800",children:N(n.dateOfJoining)})]})]})]}),r.jsx("div",{className:"flex-shrink-0",children:r.jsx("span",{className:`px-4 py-2 rounded-md text-sm font-semibold ${n.user?.isActive?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:n.user?.isActive?"Active":"Inactive"})})]})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-100",children:"Personal Information"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Phone:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium",children:n.phone||"+91 12347 65890"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Email:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium break-all",children:n.user?.email||"anthony@gmail.com"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Date of Birth:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium",children:N(n.dob)||"28 December 1992"})]}),r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Address:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium",children:n.address||"Dehradun, Uttarakhand"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Gender:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium capitalize",children:n.gender||"Male"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-100",children:"Job Details"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Designation:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium",children:n.designation||"Software Developer"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Department:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium",children:n.department||"IT & Development"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Employment Type:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium capitalize",children:n.employmentType?n.employmentType.replace("-"," "):"Full Time"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Shift Timing:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium",children:A(n.shiftTiming)||"10:00 AM – 07:00 PM"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2/5 text-gray-600 font-medium",children:"Work Mode:"}),r.jsx("div",{className:"w-3/5 text-gray-900 font-medium capitalize",children:n.workMode?n.workMode.replace(/-/g," "):"Work From Home"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-2 ",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 h-60 overflow-y-scroll ",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4 border-b border-gray-100 pb-3",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Bank Details"}),r.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-[#104774] text-white text-sm rounded hover:bg-[#0d3a5f]",children:[t?r.jsx(Wm,{size:16}):r.jsx(Ii,{size:16}),t?"Edit":"Add"]})]}),t?r.jsxs("div",{className:"space-y-3 text-gray-700",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Account Holder:"})," ",t.accountHolderName]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Account Number:"})," ",w(t.accountNumber)]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Bank Name:"})," ",t.bankName]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"IFSC:"})," ",t.ifscCode]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Account Type:"})," ",t.accountType]})]}):r.jsx("div",{className:"text-center py-4 text-gray-500",children:"No bank details added yet."})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 h-60 overflow-y-scroll",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 pb-3 border-b border-gray-100",children:"Documents"}),n.documents&&n.documents.length>0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-1 gap-4",children:n.documents.map((S,E)=>r.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:border-gray-300 transition-colors",children:[r.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[r.jsx("div",{className:"w-10 h-10 bg-gray-50 border border-gray-200 rounded-lg flex items-center justify-center mr-3 flex-shrink-0",children:r.jsx("span",{className:"text-gray-500 text-sm",children:"📄"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:S.name}),r.jsxs("p",{className:"text-xs text-gray-500",children:["Uploaded:"," ",S.uploadedAt?N(S.uploadedAt):"N/A"]})]})]}),r.jsx("a",{href:S.url,target:"_blank",rel:"noopener noreferrer",className:"ml-3 text-[#104774] hover:text-[#0d3a5f] text-sm font-medium flex-shrink-0",children:"View"})]},E))}):r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-50 border border-gray-200 rounded-full flex items-center justify-center mx-auto mb-3",children:r.jsx("span",{className:"text-gray-400 text-2xl",children:"📂"})}),r.jsx("p",{className:"text-gray-500 font-medium",children:"No documents available"})]})]})]}),r.jsx(JD,{isOpen:h,onClose:()=>m(!1),onSave:y,existingData:t})]}):r.jsx("div",{className:"text-center py-8",children:r.jsx("p",{className:"text-red-500",children:"Employee profile not found"})})};var ju,Pe,Y1,W1,Jr,Ti,ov,X1,Q1,Wd={},Z1=[],eR=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Wa(n,e){for(var t in e)n[t]=e[t];return n}function K1(n){var e=n.parentNode;e&&e.removeChild(n)}function ie(n,e,t){var s,i,l,c={};for(l in e)l=="key"?s=e[l]:l=="ref"?i=e[l]:c[l]=e[l];if(arguments.length>2&&(c.children=arguments.length>3?ju.call(arguments,2):t),typeof n=="function"&&n.defaultProps!=null)for(l in n.defaultProps)c[l]===void 0&&(c[l]=n.defaultProps[l]);return Ld(n,c,s,i,null)}function Ld(n,e,t,s,i){var l={type:n,props:e,key:t,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++Y1};return i==null&&Pe.vnode!=null&&Pe.vnode(l),l}function ya(){return{current:null}}function It(n){return n.children}function tR(n,e,t,s,i){var l;for(l in t)l==="children"||l==="key"||l in e||Xd(n,l,null,t[l],s);for(l in e)i&&typeof e[l]!="function"||l==="children"||l==="key"||l==="value"||l==="checked"||t[l]===e[l]||Xd(n,l,e[l],t[l],s)}function cv(n,e,t){e[0]==="-"?n.setProperty(e,t??""):n[e]=t==null?"":typeof t!="number"||eR.test(e)?t:t+"px"}function Xd(n,e,t,s,i){var l;e:if(e==="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof s=="string"&&(n.style.cssText=s=""),s)for(e in s)t&&e in t||cv(n.style,e,"");if(t)for(e in t)s&&t[e]===s[e]||cv(n.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")l=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in n?e.toLowerCase().slice(2):e.slice(2),n.l||(n.l={}),n.l[e+l]=t,t?s||n.addEventListener(e,l?uv:dv,l):n.removeEventListener(e,l?uv:dv,l);else if(e!=="dangerouslySetInnerHTML"){if(i)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="width"&&e!=="height"&&e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in n)try{n[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e.indexOf("-")==-1?n.removeAttribute(e):n.setAttribute(e,t))}}function dv(n){Jr=!0;try{return this.l[n.type+!1](Pe.event?Pe.event(n):n)}finally{Jr=!1}}function uv(n){Jr=!0;try{return this.l[n.type+!0](Pe.event?Pe.event(n):n)}finally{Jr=!1}}function Js(n,e){this.props=n,this.context=e}function ko(n,e){if(e==null)return n.__?ko(n.__,n.__.__k.indexOf(n)+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?ko(n):null}function J1(n){var e,t;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return J1(n)}}function sR(n){Jr?setTimeout(n):X1(n)}function ip(n){(!n.__d&&(n.__d=!0)&&Ti.push(n)&&!Qd.__r++||ov!==Pe.debounceRendering)&&((ov=Pe.debounceRendering)||sR)(Qd)}function Qd(){var n,e,t,s,i,l,c,u;for(Ti.sort(function(h,m){return h.__v.__b-m.__v.__b});n=Ti.shift();)n.__d&&(e=Ti.length,s=void 0,i=void 0,c=(l=(t=n).__v).__e,(u=t.__P)&&(s=[],(i=Wa({},l)).__v=l.__v+1,Zp(u,l,i,t.__n,u.ownerSVGElement!==void 0,l.__h!=null?[c]:null,s,c??ko(l),l.__h),aA(s,l),l.__e!=c&&J1(l)),Ti.length>e&&Ti.sort(function(h,m){return h.__v.__b-m.__v.__b}));Qd.__r=0}function eA(n,e,t,s,i,l,c,u,h,m){var p,x,y,v,w,A,N,S=s&&s.__k||Z1,E=S.length;for(t.__k=[],p=0;p<e.length;p++)if((v=t.__k[p]=(v=e[p])==null||typeof v=="boolean"?null:typeof v=="string"||typeof v=="number"||typeof v=="bigint"?Ld(null,v,null,null,v):Array.isArray(v)?Ld(It,{children:v},null,null,null):v.__b>0?Ld(v.type,v.props,v.key,v.ref?v.ref:null,v.__v):v)!=null){if(v.__=t,v.__b=t.__b+1,(y=S[p])===null||y&&v.key==y.key&&v.type===y.type)S[p]=void 0;else for(x=0;x<E;x++){if((y=S[x])&&v.key==y.key&&v.type===y.type){S[x]=void 0;break}y=null}Zp(n,v,y=y||Wd,i,l,c,u,h,m),w=v.__e,(x=v.ref)&&y.ref!=x&&(N||(N=[]),y.ref&&N.push(y.ref,null,v),N.push(x,v.__c||w,v)),w!=null?(A==null&&(A=w),typeof v.type=="function"&&v.__k===y.__k?v.__d=h=tA(v,h,n):h=sA(n,v,y,S,w,h),typeof t.type=="function"&&(t.__d=h)):h&&y.__e==h&&h.parentNode!=n&&(h=ko(y))}for(t.__e=A,p=E;p--;)S[p]!=null&&(typeof t.type=="function"&&S[p].__e!=null&&S[p].__e==t.__d&&(t.__d=nA(s).nextSibling),rA(S[p],S[p]));if(N)for(p=0;p<N.length;p++)iA(N[p],N[++p],N[++p])}function tA(n,e,t){for(var s,i=n.__k,l=0;i&&l<i.length;l++)(s=i[l])&&(s.__=n,e=typeof s.type=="function"?tA(s,e,t):sA(t,s,s,i,s.__e,e));return e}function Zd(n,e){return e=e||[],n==null||typeof n=="boolean"||(Array.isArray(n)?n.some(function(t){Zd(t,e)}):e.push(n)),e}function sA(n,e,t,s,i,l){var c,u,h;if(e.__d!==void 0)c=e.__d,e.__d=void 0;else if(t==null||i!=l||i.parentNode==null)e:if(l==null||l.parentNode!==n)n.appendChild(i),c=null;else{for(u=l,h=0;(u=u.nextSibling)&&h<s.length;h+=1)if(u==i)break e;n.insertBefore(i,l),c=l}return c!==void 0?c:i.nextSibling}function nA(n){var e,t,s;if(n.type==null||typeof n.type=="string")return n.__e;if(n.__k){for(e=n.__k.length-1;e>=0;e--)if((t=n.__k[e])&&(s=nA(t)))return s}return null}function Zp(n,e,t,s,i,l,c,u,h){var m,p,x,y,v,w,A,N,S,E,C,R,D,O,H,F=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(h=t.__h,u=e.__e=t.__e,e.__h=null,l=[u]),(m=Pe.__b)&&m(e);try{e:if(typeof F=="function"){if(N=e.props,S=(m=F.contextType)&&s[m.__c],E=m?S?S.props.value:m.__:s,t.__c?A=(p=e.__c=t.__c).__=p.__E:("prototype"in F&&F.prototype.render?e.__c=p=new F(N,E):(e.__c=p=new Js(N,E),p.constructor=F,p.render=aR),S&&S.sub(p),p.props=N,p.state||(p.state={}),p.context=E,p.__n=s,x=p.__d=!0,p.__h=[],p._sb=[]),p.__s==null&&(p.__s=p.state),F.getDerivedStateFromProps!=null&&(p.__s==p.state&&(p.__s=Wa({},p.__s)),Wa(p.__s,F.getDerivedStateFromProps(N,p.__s))),y=p.props,v=p.state,p.__v=e,x)F.getDerivedStateFromProps==null&&p.componentWillMount!=null&&p.componentWillMount(),p.componentDidMount!=null&&p.__h.push(p.componentDidMount);else{if(F.getDerivedStateFromProps==null&&N!==y&&p.componentWillReceiveProps!=null&&p.componentWillReceiveProps(N,E),!p.__e&&p.shouldComponentUpdate!=null&&p.shouldComponentUpdate(N,p.__s,E)===!1||e.__v===t.__v){for(e.__v!==t.__v&&(p.props=N,p.state=p.__s,p.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(P){P&&(P.__=e)}),C=0;C<p._sb.length;C++)p.__h.push(p._sb[C]);p._sb=[],p.__h.length&&c.push(p);break e}p.componentWillUpdate!=null&&p.componentWillUpdate(N,p.__s,E),p.componentDidUpdate!=null&&p.__h.push(function(){p.componentDidUpdate(y,v,w)})}if(p.context=E,p.props=N,p.__P=n,R=Pe.__r,D=0,"prototype"in F&&F.prototype.render){for(p.state=p.__s,p.__d=!1,R&&R(e),m=p.render(p.props,p.state,p.context),O=0;O<p._sb.length;O++)p.__h.push(p._sb[O]);p._sb=[]}else do p.__d=!1,R&&R(e),m=p.render(p.props,p.state,p.context),p.state=p.__s;while(p.__d&&++D<25);p.state=p.__s,p.getChildContext!=null&&(s=Wa(Wa({},s),p.getChildContext())),x||p.getSnapshotBeforeUpdate==null||(w=p.getSnapshotBeforeUpdate(y,v)),H=m!=null&&m.type===It&&m.key==null?m.props.children:m,eA(n,Array.isArray(H)?H:[H],e,t,s,i,l,c,u,h),p.base=e.__e,e.__h=null,p.__h.length&&c.push(p),A&&(p.__E=p.__=null),p.__e=!1}else l==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=nR(t.__e,e,t,s,i,l,c,h);(m=Pe.diffed)&&m(e)}catch(P){e.__v=null,(h||l!=null)&&(e.__e=u,e.__h=!!h,l[l.indexOf(u)]=null),Pe.__e(P,e,t)}}function aA(n,e){Pe.__c&&Pe.__c(e,n),n.some(function(t){try{n=t.__h,t.__h=[],n.some(function(s){s.call(t)})}catch(s){Pe.__e(s,t.__v)}})}function nR(n,e,t,s,i,l,c,u){var h,m,p,x=t.props,y=e.props,v=e.type,w=0;if(v==="svg"&&(i=!0),l!=null){for(;w<l.length;w++)if((h=l[w])&&"setAttribute"in h==!!v&&(v?h.localName===v:h.nodeType===3)){n=h,l[w]=null;break}}if(n==null){if(v===null)return document.createTextNode(y);n=i?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,y.is&&y),l=null,u=!1}if(v===null)x===y||u&&n.data===y||(n.data=y);else{if(l=l&&ju.call(n.childNodes),m=(x=t.props||Wd).dangerouslySetInnerHTML,p=y.dangerouslySetInnerHTML,!u){if(l!=null)for(x={},w=0;w<n.attributes.length;w++)x[n.attributes[w].name]=n.attributes[w].value;(p||m)&&(p&&(m&&p.__html==m.__html||p.__html===n.innerHTML)||(n.innerHTML=p&&p.__html||""))}if(tR(n,y,x,i,u),p)e.__k=[];else if(w=e.props.children,eA(n,Array.isArray(w)?w:[w],e,t,s,i&&v!=="foreignObject",l,c,l?l[0]:t.__k&&ko(t,0),u),l!=null)for(w=l.length;w--;)l[w]!=null&&K1(l[w]);u||("value"in y&&(w=y.value)!==void 0&&(w!==n.value||v==="progress"&&!w||v==="option"&&w!==x.value)&&Xd(n,"value",w,x.value,!1),"checked"in y&&(w=y.checked)!==void 0&&w!==n.checked&&Xd(n,"checked",w,x.checked,!1))}return n}function iA(n,e,t){try{typeof n=="function"?n(e):n.current=e}catch(s){Pe.__e(s,t)}}function rA(n,e,t){var s,i;if(Pe.unmount&&Pe.unmount(n),(s=n.ref)&&(s.current&&s.current!==n.__e||iA(s,null,e)),(s=n.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(l){Pe.__e(l,e)}s.base=s.__P=null,n.__c=void 0}if(s=n.__k)for(i=0;i<s.length;i++)s[i]&&rA(s[i],e,t||typeof n.type!="function");t||n.__e==null||K1(n.__e),n.__=n.__e=n.__d=void 0}function aR(n,e,t){return this.constructor(n,t)}function Mo(n,e,t){var s,i,l;Pe.__&&Pe.__(n,e),i=(s=!1)?null:e.__k,l=[],Zp(e,n=e.__k=ie(It,null,[n]),i||Wd,Wd,e.ownerSVGElement!==void 0,i?null:e.firstChild?ju.call(e.childNodes):null,l,i?i.__e:e.firstChild,s),aA(l,n)}function iR(n,e){var t={__c:e="__cC"+Q1++,__:n,Consumer:function(s,i){return s.children(i)},Provider:function(s){var i,l;return this.getChildContext||(i=[],(l={})[e]=this,this.getChildContext=function(){return l},this.shouldComponentUpdate=function(c){this.props.value!==c.value&&i.some(function(u){u.__e=!0,ip(u)})},this.sub=function(c){i.push(c);var u=c.componentWillUnmount;c.componentWillUnmount=function(){i.splice(i.indexOf(c),1),u&&u.call(c)}}),s.children}};return t.Provider.__=t.Consumer.contextType=t}ju=Z1.slice,Pe={__e:function(n,e,t,s){for(var i,l,c;e=e.__;)if((i=e.__c)&&!i.__)try{if((l=i.constructor)&&l.getDerivedStateFromError!=null&&(i.setState(l.getDerivedStateFromError(n)),c=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(n,s||{}),c=i.__d),c)return i.__E=i}catch(u){n=u}throw n}},Y1=0,W1=function(n){return n!=null&&n.constructor===void 0},Jr=!1,Js.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Wa({},this.state),typeof n=="function"&&(n=n(Wa({},t),this.props)),n&&Wa(t,n),n!=null&&this.__v&&(e&&this._sb.push(e),ip(this))},Js.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),ip(this))},Js.prototype.render=It,Ti=[],X1=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Qd.__r=0,Q1=0;var Gn,bm,hv,lA=[],vm=[],fv=Pe.__b,mv=Pe.__r,pv=Pe.diffed,gv=Pe.__c,xv=Pe.unmount;function rR(){for(var n;n=lA.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(Od),n.__H.__h.forEach(rp),n.__H.__h=[]}catch(e){n.__H.__h=[],Pe.__e(e,n.__v)}}Pe.__b=function(n){Gn=null,fv&&fv(n)},Pe.__r=function(n){mv&&mv(n);var e=(Gn=n.__c).__H;e&&(bm===Gn?(e.__h=[],Gn.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=vm,t.__N=t.i=void 0})):(e.__h.forEach(Od),e.__h.forEach(rp),e.__h=[])),bm=Gn},Pe.diffed=function(n){pv&&pv(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(lA.push(e)!==1&&hv===Pe.requestAnimationFrame||((hv=Pe.requestAnimationFrame)||lR)(rR)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==vm&&(t.__=t.__V),t.i=void 0,t.__V=vm})),bm=Gn=null},Pe.__c=function(n,e){e.some(function(t){try{t.__h.forEach(Od),t.__h=t.__h.filter(function(s){return!s.__||rp(s)})}catch(s){e.some(function(i){i.__h&&(i.__h=[])}),e=[],Pe.__e(s,t.__v)}}),gv&&gv(n,e)},Pe.unmount=function(n){xv&&xv(n);var e,t=n.__c;t&&t.__H&&(t.__H.__.forEach(function(s){try{Od(s)}catch(i){e=i}}),t.__H=void 0,e&&Pe.__e(e,t.__v))};var yv=typeof requestAnimationFrame=="function";function lR(n){var e,t=function(){clearTimeout(s),yv&&cancelAnimationFrame(e),setTimeout(n)},s=setTimeout(t,100);yv&&(e=requestAnimationFrame(t))}function Od(n){var e=Gn,t=n.__c;typeof t=="function"&&(n.__c=void 0,t()),Gn=e}function rp(n){var e=Gn;n.__c=n.__(),Gn=e}function oR(n,e){for(var t in e)n[t]=e[t];return n}function bv(n,e){for(var t in n)if(t!=="__source"&&!(t in e))return!0;for(var s in e)if(s!=="__source"&&n[s]!==e[s])return!0;return!1}function vv(n){this.props=n}(vv.prototype=new Js).isPureReactComponent=!0,vv.prototype.shouldComponentUpdate=function(n,e){return bv(this.props,n)||bv(this.state,e)};var wv=Pe.__b;Pe.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),wv&&wv(n)};var cR=Pe.__e;Pe.__e=function(n,e,t,s){if(n.then){for(var i,l=e;l=l.__;)if((i=l.__c)&&i.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),i.__c(n,e)}cR(n,e,t,s)};var Av=Pe.unmount;function oA(n,e,t){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(s){typeof s.__c=="function"&&s.__c()}),n.__c.__H=null),(n=oR({},n)).__c!=null&&(n.__c.__P===t&&(n.__c.__P=e),n.__c=null),n.__k=n.__k&&n.__k.map(function(s){return oA(s,e,t)})),n}function cA(n,e,t){return n&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(s){return cA(s,e,t)}),n.__c&&n.__c.__P===e&&(n.__e&&t.insertBefore(n.__e,n.__d),n.__c.__e=!0,n.__c.__P=t)),n}function wm(){this.__u=0,this.t=null,this.__b=null}function dA(n){var e=n.__.__c;return e&&e.__a&&e.__a(n)}function yd(){this.u=null,this.o=null}Pe.unmount=function(n){var e=n.__c;e&&e.__R&&e.__R(),e&&n.__h===!0&&(n.type=null),Av&&Av(n)},(wm.prototype=new Js).__c=function(n,e){var t=e.__c,s=this;s.t==null&&(s.t=[]),s.t.push(t);var i=dA(s.__v),l=!1,c=function(){l||(l=!0,t.__R=null,i?i(u):u())};t.__R=c;var u=function(){if(!--s.__u){if(s.state.__a){var m=s.state.__a;s.__v.__k[0]=cA(m,m.__c.__P,m.__c.__O)}var p;for(s.setState({__a:s.__b=null});p=s.t.pop();)p.forceUpdate()}},h=e.__h===!0;s.__u++||h||s.setState({__a:s.__b=s.__v.__k[0]}),n.then(c,c)},wm.prototype.componentWillUnmount=function(){this.t=[]},wm.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),s=this.__v.__k[0].__c;this.__v.__k[0]=oA(this.__b,t,s.__O=s.__P)}this.__b=null}var i=e.__a&&ie(It,null,n.fallback);return i&&(i.__h=null),[ie(It,null,e.__a?null:n.children),i]};var Nv=function(n,e,t){if(++t[1]===t[0]&&n.o.delete(e),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.o.size))for(t=n.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;n.u=t=t[2]}};function dR(n){return this.getChildContext=function(){return n.context},n.children}function uR(n){var e=this,t=n.i;e.componentWillUnmount=function(){Mo(null,e.l),e.l=null,e.i=null},e.i&&e.i!==t&&e.componentWillUnmount(),n.__v?(e.l||(e.i=t,e.l={nodeType:1,parentNode:t,childNodes:[],appendChild:function(s){this.childNodes.push(s),e.i.appendChild(s)},insertBefore:function(s,i){this.childNodes.push(s),e.i.appendChild(s)},removeChild:function(s){this.childNodes.splice(this.childNodes.indexOf(s)>>>1,1),e.i.removeChild(s)}}),Mo(ie(dR,{context:e.context},n.__v),e.l)):e.l&&e.componentWillUnmount()}function hR(n,e){var t=ie(uR,{__v:n,i:e});return t.containerInfo=e,t}(yd.prototype=new Js).__a=function(n){var e=this,t=dA(e.__v),s=e.o.get(n);return s[0]++,function(i){var l=function(){e.props.revealOrder?(s.push(i),Nv(e,n,s)):i()};t?t(l):l()}},yd.prototype.render=function(n){this.u=null,this.o=new Map;var e=Zd(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return n.children},yd.prototype.componentDidUpdate=yd.prototype.componentDidMount=function(){var n=this;this.o.forEach(function(e,t){Nv(n,t,e)})};var fR=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,mR=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,pR=typeof document<"u",gR=function(n){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(n)};Js.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(n){Object.defineProperty(Js.prototype,n,{configurable:!0,get:function(){return this["UNSAFE_"+n]},set:function(e){Object.defineProperty(this,n,{configurable:!0,writable:!0,value:e})}})});var Sv=Pe.event;function xR(){}function yR(){return this.cancelBubble}function bR(){return this.defaultPrevented}Pe.event=function(n){return Sv&&(n=Sv(n)),n.persist=xR,n.isPropagationStopped=yR,n.isDefaultPrevented=bR,n.nativeEvent=n};var jv={configurable:!0,get:function(){return this.class}},Ev=Pe.vnode;Pe.vnode=function(n){var e=n.type,t=n.props,s=t;if(typeof e=="string"){var i=e.indexOf("-")===-1;for(var l in s={},t){var c=t[l];pR&&l==="children"&&e==="noscript"||l==="value"&&"defaultValue"in t&&c==null||(l==="defaultValue"&&"value"in t&&t.value==null?l="value":l==="download"&&c===!0?c="":/ondoubleclick/i.test(l)?l="ondblclick":/^onchange(textarea|input)/i.test(l+e)&&!gR(t.type)?l="oninput":/^onfocus$/i.test(l)?l="onfocusin":/^onblur$/i.test(l)?l="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(l)?l=l.toLowerCase():i&&mR.test(l)?l=l.replace(/[A-Z0-9]/g,"-$&").toLowerCase():c===null&&(c=void 0),/^oninput$/i.test(l)&&(l=l.toLowerCase(),s[l]&&(l="oninputCapture")),s[l]=c)}e=="select"&&s.multiple&&Array.isArray(s.value)&&(s.value=Zd(t.children).forEach(function(u){u.props.selected=s.value.indexOf(u.props.value)!=-1})),e=="select"&&s.defaultValue!=null&&(s.value=Zd(t.children).forEach(function(u){u.props.selected=s.multiple?s.defaultValue.indexOf(u.props.value)!=-1:s.defaultValue==u.props.value})),n.props=s,t.class!=t.className&&(jv.enumerable="className"in t,t.className!=null&&(s.class=t.className),Object.defineProperty(s,"className",jv))}n.$$typeof=fR,Ev&&Ev(n)};var _v=Pe.__r;Pe.__r=function(n){_v&&_v(n),n.__c};const uA=[],lp=new Map;function hA(n){uA.push(n),lp.forEach(e=>{mA(e,n)})}function vR(n){n.isConnected&&n.getRootNode&&fA(n.getRootNode())}function fA(n){let e=lp.get(n);if(!e||!e.isConnected){if(e=n.querySelector("style[data-fullcalendar]"),!e){e=document.createElement("style"),e.setAttribute("data-fullcalendar","");const t=AR();t&&(e.nonce=t);const s=n===document?document.head:n,i=n===document?s.querySelector("script,link[rel=stylesheet],link[as=style],style"):s.firstChild;s.insertBefore(e,i)}lp.set(n,e),wR(e)}}function wR(n){for(const e of uA)mA(n,e)}function mA(n,e){const{sheet:t}=n,s=t.cssRules.length;e.split("}").forEach((i,l)=>{i=i.trim(),i&&t.insertRule(i+"}",s+l)})}let Am;function AR(){return Am===void 0&&(Am=NR()),Am}function NR(){const n=document.querySelector('meta[name="csp-nonce"]');if(n&&n.hasAttribute("content"))return n.getAttribute("content");const e=document.querySelector("script[nonce]");return e&&e.nonce||""}typeof document<"u"&&fA(document);var SR=':root{--fc-small-font-size:.85em;--fc-page-bg-color:#fff;--fc-neutral-bg-color:hsla(0,0%,82%,.3);--fc-neutral-text-color:grey;--fc-border-color:#ddd;--fc-button-text-color:#fff;--fc-button-bg-color:#2c3e50;--fc-button-border-color:#2c3e50;--fc-button-hover-bg-color:#1e2b37;--fc-button-hover-border-color:#1a252f;--fc-button-active-bg-color:#1a252f;--fc-button-active-border-color:#151e27;--fc-event-bg-color:#3788d8;--fc-event-border-color:#3788d8;--fc-event-text-color:#fff;--fc-event-selected-overlay-color:rgba(0,0,0,.25);--fc-more-link-bg-color:#d0d0d0;--fc-more-link-text-color:inherit;--fc-event-resizer-thickness:8px;--fc-event-resizer-dot-total-width:8px;--fc-event-resizer-dot-border-width:1px;--fc-non-business-color:hsla(0,0%,84%,.3);--fc-bg-event-color:#8fdf82;--fc-bg-event-opacity:0.3;--fc-highlight-color:rgba(188,232,241,.3);--fc-today-bg-color:rgba(255,220,40,.15);--fc-now-indicator-color:red}.fc-not-allowed,.fc-not-allowed .fc-event{cursor:not-allowed}.fc{display:flex;flex-direction:column;font-size:1em}.fc,.fc *,.fc :after,.fc :before{box-sizing:border-box}.fc table{border-collapse:collapse;border-spacing:0;font-size:1em}.fc th{text-align:center}.fc td,.fc th{padding:0;vertical-align:top}.fc a[data-navlink]{cursor:pointer}.fc a[data-navlink]:hover{text-decoration:underline}.fc-direction-ltr{direction:ltr;text-align:left}.fc-direction-rtl{direction:rtl;text-align:right}.fc-theme-standard td,.fc-theme-standard th{border:1px solid var(--fc-border-color)}.fc-liquid-hack td,.fc-liquid-hack th{position:relative}@font-face{font-family:fcicons;font-style:normal;font-weight:400;src:url("data:application/x-font-ttf;charset=utf-8;base64,AAEAAAALAIAAAwAwT1MvMg8SBfAAAAC8AAAAYGNtYXAXVtKNAAABHAAAAFRnYXNwAAAAEAAAAXAAAAAIZ2x5ZgYydxIAAAF4AAAFNGhlYWQUJ7cIAAAGrAAAADZoaGVhB20DzAAABuQAAAAkaG10eCIABhQAAAcIAAAALGxvY2ED4AU6AAAHNAAAABhtYXhwAA8AjAAAB0wAAAAgbmFtZXsr690AAAdsAAABhnBvc3QAAwAAAAAI9AAAACAAAwPAAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADpBgPA/8AAQAPAAEAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAOAAAAAoACAACAAIAAQAg6Qb//f//AAAAAAAg6QD//f//AAH/4xcEAAMAAQAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAABAWIAjQKeAskAEwAAJSc3NjQnJiIHAQYUFwEWMjc2NCcCnuLiDQ0MJAz/AA0NAQAMJAwNDcni4gwjDQwM/wANIwz/AA0NDCMNAAAAAQFiAI0CngLJABMAACUBNjQnASYiBwYUHwEHBhQXFjI3AZ4BAA0N/wAMJAwNDeLiDQ0MJAyNAQAMIw0BAAwMDSMM4uINIwwNDQAAAAIA4gC3Ax4CngATACcAACUnNzY0JyYiDwEGFB8BFjI3NjQnISc3NjQnJiIPAQYUHwEWMjc2NCcB87e3DQ0MIw3VDQ3VDSMMDQ0BK7e3DQ0MJAzVDQ3VDCQMDQ3zuLcMJAwNDdUNIwzWDAwNIwy4twwkDA0N1Q0jDNYMDA0jDAAAAgDiALcDHgKeABMAJwAAJTc2NC8BJiIHBhQfAQcGFBcWMjchNzY0LwEmIgcGFB8BBwYUFxYyNwJJ1Q0N1Q0jDA0Nt7cNDQwjDf7V1Q0N1QwkDA0Nt7cNDQwkDLfWDCMN1Q0NDCQMt7gMIw0MDNYMIw3VDQ0MJAy3uAwjDQwMAAADAFUAAAOrA1UAMwBoAHcAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMhMjY1NCYjISIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAAVYRGRkR/qoRGRkRA1UFBAUOCQkVDAsZDf2rDRkLDBUJCA4FBQUFBQUOCQgVDAsZDQJVDRkLDBUJCQ4FBAVVAgECBQMCBwQECAX9qwQJAwQHAwMFAQICAgIBBQMDBwQDCQQCVQUIBAQHAgMFAgEC/oAZEhEZGRESGQAAAAADAFUAAAOrA1UAMwBoAIkAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMzFRQWMzI2PQEzMjY1NCYrATU0JiMiBh0BIyIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAgBkSEhmAERkZEYAZEhIZgBEZGREDVQUEBQ4JCRUMCxkN/asNGQsMFQkIDgUFBQUFBQ4JCBUMCxkNAlUNGQsMFQkJDgUEBVUCAQIFAwIHBAQIBf2rBAkDBAcDAwUBAgICAgEFAwMHBAMJBAJVBQgEBAcCAwUCAQL+gIASGRkSgBkSERmAEhkZEoAZERIZAAABAOIAjQMeAskAIAAAExcHBhQXFjI/ARcWMjc2NC8BNzY0JyYiDwEnJiIHBhQX4uLiDQ0MJAzi4gwkDA0N4uINDQwkDOLiDCQMDQ0CjeLiDSMMDQ3h4Q0NDCMN4uIMIw0MDOLiDAwNIwwAAAABAAAAAQAAa5n0y18PPPUACwQAAAAAANivOVsAAAAA2K85WwAAAAADqwNVAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAOrAAEAAAAAAAAAAAAAAAAAAAALBAAAAAAAAAAAAAAAAgAAAAQAAWIEAAFiBAAA4gQAAOIEAABVBAAAVQQAAOIAAAAAAAoAFAAeAEQAagCqAOoBngJkApoAAQAAAAsAigADAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAcAAAABAAAAAAACAAcAYAABAAAAAAADAAcANgABAAAAAAAEAAcAdQABAAAAAAAFAAsAFQABAAAAAAAGAAcASwABAAAAAAAKABoAigADAAEECQABAA4ABwADAAEECQACAA4AZwADAAEECQADAA4APQADAAEECQAEAA4AfAADAAEECQAFABYAIAADAAEECQAGAA4AUgADAAEECQAKADQApGZjaWNvbnMAZgBjAGkAYwBvAG4Ac1ZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMGZjaWNvbnMAZgBjAGkAYwBvAG4Ac2ZjaWNvbnMAZgBjAGkAYwBvAG4Ac1JlZ3VsYXIAUgBlAGcAdQBsAGEAcmZjaWNvbnMAZgBjAGkAYwBvAG4Ac0ZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=") format("truetype")}.fc-icon{speak:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:inline-block;font-family:fcicons!important;font-style:normal;font-variant:normal;font-weight:400;height:1em;line-height:1;text-align:center;text-transform:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:1em}.fc-icon-chevron-left:before{content:"\\e900"}.fc-icon-chevron-right:before{content:"\\e901"}.fc-icon-chevrons-left:before{content:"\\e902"}.fc-icon-chevrons-right:before{content:"\\e903"}.fc-icon-minus-square:before{content:"\\e904"}.fc-icon-plus-square:before{content:"\\e905"}.fc-icon-x:before{content:"\\e906"}.fc .fc-button{border-radius:0;font-family:inherit;font-size:inherit;line-height:inherit;margin:0;overflow:visible;text-transform:none}.fc .fc-button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}.fc .fc-button{-webkit-appearance:button}.fc .fc-button:not(:disabled){cursor:pointer}.fc .fc-button{background-color:transparent;border:1px solid transparent;border-radius:.25em;display:inline-block;font-size:1em;font-weight:400;line-height:1.5;padding:.4em .65em;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle}.fc .fc-button:hover{text-decoration:none}.fc .fc-button:focus{box-shadow:0 0 0 .2rem rgba(44,62,80,.25);outline:0}.fc .fc-button:disabled{opacity:.65}.fc .fc-button-primary{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:hover{background-color:var(--fc-button-hover-bg-color);border-color:var(--fc-button-hover-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:disabled{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button-primary:not(:disabled).fc-button-active,.fc .fc-button-primary:not(:disabled):active{background-color:var(--fc-button-active-bg-color);border-color:var(--fc-button-active-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:not(:disabled).fc-button-active:focus,.fc .fc-button-primary:not(:disabled):active:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button .fc-icon{font-size:1.5em;vertical-align:middle}.fc .fc-button-group{display:inline-flex;position:relative;vertical-align:middle}.fc .fc-button-group>.fc-button{flex:1 1 auto;position:relative}.fc .fc-button-group>.fc-button.fc-button-active,.fc .fc-button-group>.fc-button:active,.fc .fc-button-group>.fc-button:focus,.fc .fc-button-group>.fc-button:hover{z-index:1}.fc-direction-ltr .fc-button-group>.fc-button:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0;margin-left:-1px}.fc-direction-ltr .fc-button-group>.fc-button:not(:last-child){border-bottom-right-radius:0;border-top-right-radius:0}.fc-direction-rtl .fc-button-group>.fc-button:not(:first-child){border-bottom-right-radius:0;border-top-right-radius:0;margin-right:-1px}.fc-direction-rtl .fc-button-group>.fc-button:not(:last-child){border-bottom-left-radius:0;border-top-left-radius:0}.fc .fc-toolbar{align-items:center;display:flex;justify-content:space-between}.fc .fc-toolbar.fc-header-toolbar{margin-bottom:1.5em}.fc .fc-toolbar.fc-footer-toolbar{margin-top:1.5em}.fc .fc-toolbar-title{font-size:1.75em;margin:0}.fc-direction-ltr .fc-toolbar>*>:not(:first-child){margin-left:.75em}.fc-direction-rtl .fc-toolbar>*>:not(:first-child){margin-right:.75em}.fc-direction-rtl .fc-toolbar-ltr{flex-direction:row-reverse}.fc .fc-scroller{-webkit-overflow-scrolling:touch;position:relative}.fc .fc-scroller-liquid{height:100%}.fc .fc-scroller-liquid-absolute{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-scroller-harness{direction:ltr;overflow:hidden;position:relative}.fc .fc-scroller-harness-liquid{height:100%}.fc-direction-rtl .fc-scroller-harness>.fc-scroller{direction:rtl}.fc-theme-standard .fc-scrollgrid{border:1px solid var(--fc-border-color)}.fc .fc-scrollgrid,.fc .fc-scrollgrid table{table-layout:fixed;width:100%}.fc .fc-scrollgrid table{border-left-style:hidden;border-right-style:hidden;border-top-style:hidden}.fc .fc-scrollgrid{border-bottom-width:0;border-collapse:separate;border-right-width:0}.fc .fc-scrollgrid-liquid{height:100%}.fc .fc-scrollgrid-section,.fc .fc-scrollgrid-section table,.fc .fc-scrollgrid-section>td{height:1px}.fc .fc-scrollgrid-section-liquid>td{height:100%}.fc .fc-scrollgrid-section>*{border-left-width:0;border-top-width:0}.fc .fc-scrollgrid-section-footer>*,.fc .fc-scrollgrid-section-header>*{border-bottom-width:0}.fc .fc-scrollgrid-section-body table,.fc .fc-scrollgrid-section-footer table{border-bottom-style:hidden}.fc .fc-scrollgrid-section-sticky>*{background:var(--fc-page-bg-color);position:sticky;z-index:3}.fc .fc-scrollgrid-section-header.fc-scrollgrid-section-sticky>*{top:0}.fc .fc-scrollgrid-section-footer.fc-scrollgrid-section-sticky>*{bottom:0}.fc .fc-scrollgrid-sticky-shim{height:1px;margin-bottom:-1px}.fc-sticky{position:sticky}.fc .fc-view-harness{flex-grow:1;position:relative}.fc .fc-view-harness-active>.fc-view{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-col-header-cell-cushion{display:inline-block;padding:2px 4px}.fc .fc-bg-event,.fc .fc-highlight,.fc .fc-non-business{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-non-business{background:var(--fc-non-business-color)}.fc .fc-bg-event{background:var(--fc-bg-event-color);opacity:var(--fc-bg-event-opacity)}.fc .fc-bg-event .fc-event-title{font-size:var(--fc-small-font-size);font-style:italic;margin:.5em}.fc .fc-highlight{background:var(--fc-highlight-color)}.fc .fc-cell-shaded,.fc .fc-day-disabled{background:var(--fc-neutral-bg-color)}a.fc-event,a.fc-event:hover{text-decoration:none}.fc-event.fc-event-draggable,.fc-event[href]{cursor:pointer}.fc-event .fc-event-main{position:relative;z-index:2}.fc-event-dragging:not(.fc-event-selected){opacity:.75}.fc-event-dragging.fc-event-selected{box-shadow:0 2px 7px rgba(0,0,0,.3)}.fc-event .fc-event-resizer{display:none;position:absolute;z-index:4}.fc-event-selected .fc-event-resizer,.fc-event:hover .fc-event-resizer{display:block}.fc-event-selected .fc-event-resizer{background:var(--fc-page-bg-color);border-color:inherit;border-radius:calc(var(--fc-event-resizer-dot-total-width)/2);border-style:solid;border-width:var(--fc-event-resizer-dot-border-width);height:var(--fc-event-resizer-dot-total-width);width:var(--fc-event-resizer-dot-total-width)}.fc-event-selected .fc-event-resizer:before{bottom:-20px;content:"";left:-20px;position:absolute;right:-20px;top:-20px}.fc-event-selected,.fc-event:focus{box-shadow:0 2px 5px rgba(0,0,0,.2)}.fc-event-selected:before,.fc-event:focus:before{bottom:0;content:"";left:0;position:absolute;right:0;top:0;z-index:3}.fc-event-selected:after,.fc-event:focus:after{background:var(--fc-event-selected-overlay-color);bottom:-1px;content:"";left:-1px;position:absolute;right:-1px;top:-1px;z-index:1}.fc-h-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-h-event .fc-event-main{color:var(--fc-event-text-color)}.fc-h-event .fc-event-main-frame{display:flex}.fc-h-event .fc-event-time{max-width:100%;overflow:hidden}.fc-h-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-width:0}.fc-h-event .fc-event-title{display:inline-block;left:0;max-width:100%;overflow:hidden;right:0;vertical-align:top}.fc-h-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-start),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-end){border-bottom-left-radius:0;border-left-width:0;border-top-left-radius:0}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-end),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-start){border-bottom-right-radius:0;border-right-width:0;border-top-right-radius:0}.fc-h-event:not(.fc-event-selected) .fc-event-resizer{bottom:0;top:0;width:var(--fc-event-resizer-thickness)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end{cursor:w-resize;left:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start{cursor:e-resize;right:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-h-event.fc-event-selected .fc-event-resizer{margin-top:calc(var(--fc-event-resizer-dot-total-width)*-.5);top:50%}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-start,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-end{left:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-end,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-start{right:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc .fc-popover{box-shadow:0 2px 6px rgba(0,0,0,.15);position:absolute;z-index:9999}.fc .fc-popover-header{align-items:center;display:flex;flex-direction:row;justify-content:space-between;padding:3px 4px}.fc .fc-popover-title{margin:0 2px}.fc .fc-popover-close{cursor:pointer;font-size:1.1em;opacity:.65}.fc-theme-standard .fc-popover{background:var(--fc-page-bg-color);border:1px solid var(--fc-border-color)}.fc-theme-standard .fc-popover-header{background:var(--fc-neutral-bg-color)}';hA(SR);class Kp{constructor(e){this.drainedOption=e,this.isRunning=!1,this.isDirty=!1,this.pauseDepths={},this.timeoutId=0}request(e){this.isDirty=!0,this.isPaused()||(this.clearTimeout(),e==null?this.tryDrain():this.timeoutId=setTimeout(this.tryDrain.bind(this),e))}pause(e=""){let{pauseDepths:t}=this;t[e]=(t[e]||0)+1,this.clearTimeout()}resume(e="",t){let{pauseDepths:s}=this;e in s&&(t?delete s[e]:(s[e]-=1,s[e]<=0&&delete s[e]),this.tryDrain())}isPaused(){return Object.keys(this.pauseDepths).length}tryDrain(){if(!this.isRunning&&!this.isPaused()){for(this.isRunning=!0;this.isDirty;)this.isDirty=!1,this.drained();this.isRunning=!1}}clear(){this.clearTimeout(),this.isDirty=!1,this.pauseDepths={}}clearTimeout(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=0)}drained(){this.drainedOption&&this.drainedOption()}}function Jp(n){n.parentNode&&n.parentNode.removeChild(n)}function bs(n,e){if(n.closest)return n.closest(e);if(!document.documentElement.contains(n))return null;do{if(jR(n,e))return n;n=n.parentElement||n.parentNode}while(n!==null&&n.nodeType===1);return null}function jR(n,e){return(n.matches||n.matchesSelector||n.msMatchesSelector).call(n,e)}function ER(n,e){let t=n instanceof HTMLElement?[n]:n,s=[];for(let i=0;i<t.length;i+=1){let l=t[i].querySelectorAll(e);for(let c=0;c<l.length;c+=1)s.push(l[c])}return s}const _R=/(top|left|right|bottom|width|height)$/i;function wo(n,e){for(let t in e)pA(n,t,e[t])}function pA(n,e,t){t==null?n.style[e]="":typeof t=="number"&&_R.test(e)?n.style[e]=`${t}px`:n.style[e]=t}function gA(n){var e,t;return(t=(e=n.composedPath)===null||e===void 0?void 0:e.call(n)[0])!==null&&t!==void 0?t:n.target}let Cv=0;function Eu(){return Cv+=1,"fc-dom-"+Cv}function _u(n){n.preventDefault()}function CR(n,e){return t=>{let s=bs(t.target,n);s&&e.call(s,t,s)}}function xA(n,e,t,s){let i=CR(t,s);return n.addEventListener(e,i),()=>{n.removeEventListener(e,i)}}function TR(n,e,t,s){let i;return xA(n,"mouseover",e,(l,c)=>{if(c!==i){i=c,t(l,c);let u=h=>{i=null,s(h,c),c.removeEventListener("mouseleave",u)};c.addEventListener("mouseleave",u)}})}const Tv=["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"];function DR(n,e){let t=s=>{e(s),Tv.forEach(i=>{n.removeEventListener(i,t)})};Tv.forEach(s=>{n.addEventListener(s,t)})}function yA(n){return Object.assign({onClick:n},bA(n))}function bA(n){return{tabIndex:0,onKeyDown(e){(e.key==="Enter"||e.key===" ")&&(n(e),e.preventDefault())}}}let Dv=0;function Yi(){return Dv+=1,String(Dv)}function eg(){document.body.classList.add("fc-not-allowed")}function tg(){document.body.classList.remove("fc-not-allowed")}function RR(n){n.style.userSelect="none",n.style.webkitUserSelect="none",n.addEventListener("selectstart",_u)}function kR(n){n.style.userSelect="",n.style.webkitUserSelect="",n.removeEventListener("selectstart",_u)}function MR(n){n.addEventListener("contextmenu",_u)}function LR(n){n.removeEventListener("contextmenu",_u)}function OR(n){let e=[],t=[],s,i;for(typeof n=="string"?t=n.split(/\s*,\s*/):typeof n=="function"?t=[n]:Array.isArray(n)&&(t=n),s=0;s<t.length;s+=1)i=t[s],typeof i=="string"?e.push(i.charAt(0)==="-"?{field:i.substring(1),order:-1}:{field:i,order:1}):typeof i=="function"&&e.push({func:i});return e}function PR(n,e,t){let s,i;for(s=0;s<t.length;s+=1)if(i=IR(n,e,t[s]),i)return i;return 0}function IR(n,e,t){return t.func?t.func(n,e):BR(n[t.field],e[t.field])*(t.order||1)}function BR(n,e){return!n&&!e?0:e==null?-1:n==null?1:typeof n=="string"||typeof e=="string"?String(n).localeCompare(String(e)):n-e}function Nm(n,e){let t=String(n);return"000".substr(0,e-t.length)+t}function Ao(n,e,t){return typeof n=="function"?n(...e):typeof n=="string"?e.reduce((s,i,l)=>s.replace("$"+l,i||""),n):t}function HR(n,e){return n-e}function Sm(n){return n%1===0}function zR(n){let e=n.querySelector(".fc-scrollgrid-shrink-frame"),t=n.querySelector(".fc-scrollgrid-shrink-cushion");if(!e)throw new Error("needs fc-scrollgrid-shrink-frame className");if(!t)throw new Error("needs fc-scrollgrid-shrink-cushion className");return n.getBoundingClientRect().width-e.getBoundingClientRect().width+t.getBoundingClientRect().width}const FR=/^(-?)(?:(\d+)\.)?(\d+):(\d\d)(?::(\d\d)(?:\.(\d\d\d))?)?/;function ct(n,e){return typeof n=="string"?UR(n):typeof n=="object"&&n?Rv(n):typeof n=="number"?Rv({[e||"milliseconds"]:n}):null}function UR(n){let e=FR.exec(n);if(e){let t=e[1]?-1:1;return{years:0,months:0,days:t*(e[2]?parseInt(e[2],10):0),milliseconds:t*((e[3]?parseInt(e[3],10):0)*60*60*1e3+(e[4]?parseInt(e[4],10):0)*60*1e3+(e[5]?parseInt(e[5],10):0)*1e3+(e[6]?parseInt(e[6],10):0))}}return null}function Rv(n){let e={years:n.years||n.year||0,months:n.months||n.month||0,days:n.days||n.day||0,milliseconds:(n.hours||n.hour||0)*60*60*1e3+(n.minutes||n.minute||0)*60*1e3+(n.seconds||n.second||0)*1e3+(n.milliseconds||n.millisecond||n.ms||0)},t=n.weeks||n.week;return t&&(e.days+=t*7,e.specifiedWeeks=!0),e}function qR(n,e){return n.years===e.years&&n.months===e.months&&n.days===e.days&&n.milliseconds===e.milliseconds}function VR(n,e){return{years:n.years-e.years,months:n.months-e.months,days:n.days-e.days,milliseconds:n.milliseconds-e.milliseconds}}function $R(n){return Wr(n)/365}function GR(n){return Wr(n)/30}function Wr(n){return Lo(n)/864e5}function Lo(n){return n.years*(365*864e5)+n.months*(30*864e5)+n.days*864e5+n.milliseconds}function op(n){let e=n.milliseconds;if(e){if(e%1e3!==0)return{unit:"millisecond",value:e};if(e%(1e3*60)!==0)return{unit:"second",value:e/1e3};if(e%(1e3*60*60)!==0)return{unit:"minute",value:e/(1e3*60)};if(e)return{unit:"hour",value:e/(1e3*60*60)}}return n.days?n.specifiedWeeks&&n.days%7===0?{unit:"week",value:n.days/7}:{unit:"day",value:n.days}:n.months?{unit:"month",value:n.months}:n.years?{unit:"year",value:n.years}:{unit:"millisecond",value:0}}function ei(n,e,t){if(n===e)return!0;let s=n.length,i;if(s!==e.length)return!1;for(i=0;i<s;i+=1)if(!(t?t(n[i],e[i]):n[i]===e[i]))return!1;return!0}const YR=["sun","mon","tue","wed","thu","fri","sat"];function kv(n,e){let t=Xa(n);return t[2]+=e*7,Is(t)}function rs(n,e){let t=Xa(n);return t[2]+=e,Is(t)}function ti(n,e){let t=Xa(n);return t[6]+=e,Is(t)}function WR(n,e){return ol(n,e)/7}function ol(n,e){return(e.valueOf()-n.valueOf())/(1e3*60*60*24)}function XR(n,e){return(e.valueOf()-n.valueOf())/(1e3*60*60)}function QR(n,e){return(e.valueOf()-n.valueOf())/(1e3*60)}function ZR(n,e){return(e.valueOf()-n.valueOf())/1e3}function KR(n,e){let t=Ct(n),s=Ct(e);return{years:0,months:0,days:Math.round(ol(t,s)),milliseconds:e.valueOf()-s.valueOf()-(n.valueOf()-t.valueOf())}}function JR(n,e){let t=Kd(n,e);return t!==null&&t%7===0?t/7:null}function Kd(n,e){return Qa(n)===Qa(e)?Math.round(ol(n,e)):null}function Ct(n){return Is([n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()])}function ek(n){return Is([n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours()])}function tk(n){return Is([n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes()])}function sk(n){return Is([n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds()])}function nk(n,e,t){let s=n.getUTCFullYear(),i=jm(n,s,e,t);if(i<1)return jm(n,s-1,e,t);let l=jm(n,s+1,e,t);return l>=1?Math.min(i,l):i}function jm(n,e,t,s){let i=Is([e,0,1+ak(e,t,s)]),l=Ct(n),c=Math.round(ol(i,l));return Math.floor(c/7)+1}function ak(n,e,t){let s=7+e-t;return-((7+Is([n,0,s]).getUTCDay()-e)%7)+s-1}function Mv(n){return[n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()]}function Lv(n){return new Date(n[0],n[1]||0,n[2]==null?1:n[2],n[3]||0,n[4]||0,n[5]||0)}function Xa(n){return[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds()]}function Is(n){return n.length===1&&(n=n.concat([0])),new Date(Date.UTC(...n))}function vA(n){return!isNaN(n.valueOf())}function Qa(n){return n.getUTCHours()*1e3*60*60+n.getUTCMinutes()*1e3*60+n.getUTCSeconds()*1e3+n.getUTCMilliseconds()}function ik(n,e,t=!1){let s=n.toISOString();return s=s.replace(".000",""),t&&(s=s.replace("T00:00:00Z","")),s.length>10&&(e==null?s=s.replace("Z",""):e!==0&&(s=s.replace("Z",ng(e,!0)))),s}function sg(n){return n.toISOString().replace(/T.*$/,"")}function rk(n){return n.toISOString().match(/^\d{4}-\d{2}/)[0]}function ng(n,e=!1){let t=n<0?"-":"+",s=Math.abs(n),i=Math.floor(s/60),l=Math.round(s%60);return e?`${t+Nm(i,2)}:${Nm(l,2)}`:`GMT${t}${i}${l?`:${Nm(l,2)}`:""}`}function lt(n,e,t){let s,i;return function(...l){if(!s)i=n.apply(this,l);else if(!ei(s,l)){let c=n.apply(this,l);(!e||!e(c,i))&&(i=c)}return s=l,i}}function Pd(n,e,t){let s,i;return l=>(s?Cn(s,l)||(i=n.call(this,l)):i=n.call(this,l),s=l,i)}const Em={week:3,separator:9,omitZeroMinute:9,meridiem:9,omitCommas:9},Jd={timeZoneName:7,era:6,year:5,month:4,day:2,weekday:2,hour:1,minute:1,second:1},bd=/\s*([ap])\.?m\.?/i,lk=/,/g,ok=/\s+/g,ck=/\u200e/g,dk=/UTC|GMT/;class uk{constructor(e){let t={},s={},i=9;for(let l in e)l in Em?(s[l]=e[l],Em[l]<9&&(i=Math.min(Em[l],i))):(t[l]=e[l],l in Jd&&(i=Math.min(Jd[l],i)));this.standardDateProps=t,this.extendedSettings=s,this.smallestUnitNum=i,this.buildFormattingFunc=lt(Ov)}format(e,t){return this.buildFormattingFunc(this.standardDateProps,this.extendedSettings,t)(e)}formatRange(e,t,s,i){let{standardDateProps:l,extendedSettings:c}=this,u=xk(e.marker,t.marker,s.calendarSystem);if(!u)return this.format(e,s);let h=u;h>1&&(l.year==="numeric"||l.year==="2-digit")&&(l.month==="numeric"||l.month==="2-digit")&&(l.day==="numeric"||l.day==="2-digit")&&(h=1);let m=this.format(e,s),p=this.format(t,s);if(m===p)return m;let x=yk(l,h),y=Ov(x,c,s),v=y(e),w=y(t),A=bk(m,v,p,w),N=c.separator||i||s.defaultSeparator||"";return A?A.before+v+N+w+A.after:m+N+p}getSmallestUnit(){switch(this.smallestUnitNum){case 7:case 6:case 5:return"year";case 4:return"month";case 3:return"week";case 2:return"day";default:return"time"}}}function Ov(n,e,t){let s=Object.keys(n).length;return s===1&&n.timeZoneName==="short"?i=>ng(i.timeZoneOffset):s===0&&e.week?i=>gk(t.computeWeekNumber(i.marker),t.weekText,t.weekTextLong,t.locale,e.week):hk(n,e,t)}function hk(n,e,t){n=Object.assign({},n),e=Object.assign({},e),fk(n,e),n.timeZone="UTC";let s=new Intl.DateTimeFormat(t.locale.codes,n),i;if(e.omitZeroMinute){let l=Object.assign({},n);delete l.minute,i=new Intl.DateTimeFormat(t.locale.codes,l)}return l=>{let{marker:c}=l,u;i&&!c.getUTCMinutes()?u=i:u=s;let h=u.format(c);return mk(h,l,n,e,t)}}function fk(n,e){n.timeZoneName&&(n.hour||(n.hour="2-digit"),n.minute||(n.minute="2-digit")),n.timeZoneName==="long"&&(n.timeZoneName="short"),e.omitZeroMinute&&(n.second||n.millisecond)&&delete e.omitZeroMinute}function mk(n,e,t,s,i){return n=n.replace(ck,""),t.timeZoneName==="short"&&(n=pk(n,i.timeZone==="UTC"||e.timeZoneOffset==null?"UTC":ng(e.timeZoneOffset))),s.omitCommas&&(n=n.replace(lk,"").trim()),s.omitZeroMinute&&(n=n.replace(":00","")),s.meridiem===!1?n=n.replace(bd,"").trim():s.meridiem==="narrow"?n=n.replace(bd,(l,c)=>c.toLocaleLowerCase()):s.meridiem==="short"?n=n.replace(bd,(l,c)=>`${c.toLocaleLowerCase()}m`):s.meridiem==="lowercase"&&(n=n.replace(bd,l=>l.toLocaleLowerCase())),n=n.replace(ok," "),n=n.trim(),n}function pk(n,e){let t=!1;return n=n.replace(dk,()=>(t=!0,e)),t||(n+=` ${e}`),n}function gk(n,e,t,s,i){let l=[];return i==="long"?l.push(t):(i==="short"||i==="narrow")&&l.push(e),(i==="long"||i==="short")&&l.push(" "),l.push(s.simpleNumberFormat.format(n)),s.options.direction==="rtl"&&l.reverse(),l.join("")}function xk(n,e,t){return t.getMarkerYear(n)!==t.getMarkerYear(e)?5:t.getMarkerMonth(n)!==t.getMarkerMonth(e)?4:t.getMarkerDay(n)!==t.getMarkerDay(e)?2:Qa(n)!==Qa(e)?1:0}function yk(n,e){let t={};for(let s in n)(!(s in Jd)||Jd[s]<=e)&&(t[s]=n[s]);return t}function bk(n,e,t,s){let i=0;for(;i<n.length;){let l=n.indexOf(e,i);if(l===-1)break;let c=n.substr(0,l);i=l+e.length;let u=n.substr(i),h=0;for(;h<t.length;){let m=t.indexOf(s,h);if(m===-1)break;let p=t.substr(0,m);h=m+s.length;let x=t.substr(h);if(c===p&&u===x)return{before:c,after:u}}}return null}function Pv(n,e){let t=e.markerToArray(n.marker);return{marker:n.marker,timeZoneOffset:n.timeZoneOffset,array:t,year:t[0],month:t[1],day:t[2],hour:t[3],minute:t[4],second:t[5],millisecond:t[6]}}function eu(n,e,t,s){let i=Pv(n,t.calendarSystem),l=e?Pv(e,t.calendarSystem):null;return{date:i,start:i,end:l,timeZone:t.timeZone,localeCodes:t.locale.codes,defaultSeparator:s||t.defaultSeparator}}class vk{constructor(e){this.cmdStr=e}format(e,t,s){return t.cmdFormatter(this.cmdStr,eu(e,null,t,s))}formatRange(e,t,s,i){return s.cmdFormatter(this.cmdStr,eu(e,t,s,i))}}class wk{constructor(e){this.func=e}format(e,t,s){return this.func(eu(e,null,t,s))}formatRange(e,t,s,i){return this.func(eu(e,t,s,i))}}function is(n){return typeof n=="object"&&n?new uk(n):typeof n=="string"?new vk(n):typeof n=="function"?new wk(n):null}const Iv={navLinkDayClick:ae,navLinkWeekClick:ae,duration:ct,bootstrapFontAwesome:ae,buttonIcons:ae,customButtons:ae,defaultAllDayEventDuration:ct,defaultTimedEventDuration:ct,nextDayThreshold:ct,scrollTime:ct,scrollTimeReset:Boolean,slotMinTime:ct,slotMaxTime:ct,dayPopoverFormat:is,slotDuration:ct,snapDuration:ct,headerToolbar:ae,footerToolbar:ae,defaultRangeSeparator:String,titleRangeSeparator:String,forceEventDuration:Boolean,dayHeaders:Boolean,dayHeaderFormat:is,dayHeaderClassNames:ae,dayHeaderContent:ae,dayHeaderDidMount:ae,dayHeaderWillUnmount:ae,dayCellClassNames:ae,dayCellContent:ae,dayCellDidMount:ae,dayCellWillUnmount:ae,initialView:String,aspectRatio:Number,weekends:Boolean,weekNumberCalculation:ae,weekNumbers:Boolean,weekNumberClassNames:ae,weekNumberContent:ae,weekNumberDidMount:ae,weekNumberWillUnmount:ae,editable:Boolean,viewClassNames:ae,viewDidMount:ae,viewWillUnmount:ae,nowIndicator:Boolean,nowIndicatorSnap:ae,nowIndicatorClassNames:ae,nowIndicatorContent:ae,nowIndicatorDidMount:ae,nowIndicatorWillUnmount:ae,showNonCurrentDates:Boolean,lazyFetching:Boolean,startParam:String,endParam:String,timeZoneParam:String,timeZone:String,locales:ae,locale:ae,themeSystem:String,dragRevertDuration:Number,dragScroll:Boolean,allDayMaintainDuration:Boolean,unselectAuto:Boolean,dropAccept:ae,eventOrder:OR,eventOrderStrict:Boolean,handleWindowResize:Boolean,windowResizeDelay:Number,longPressDelay:Number,eventDragMinDistance:Number,expandRows:Boolean,height:ae,contentHeight:ae,direction:String,weekNumberFormat:is,eventResizableFromStart:Boolean,displayEventTime:Boolean,displayEventEnd:Boolean,weekText:String,weekTextLong:String,progressiveEventRendering:Boolean,businessHours:ae,initialDate:ae,now:ae,eventDataTransform:ae,stickyHeaderDates:ae,stickyFooterScrollbar:ae,viewHeight:ae,defaultAllDay:Boolean,eventSourceFailure:ae,eventSourceSuccess:ae,eventDisplay:String,eventStartEditable:Boolean,eventDurationEditable:Boolean,eventOverlap:ae,eventConstraint:ae,eventAllow:ae,eventBackgroundColor:String,eventBorderColor:String,eventTextColor:String,eventColor:String,eventClassNames:ae,eventContent:ae,eventDidMount:ae,eventWillUnmount:ae,selectConstraint:ae,selectOverlap:ae,selectAllow:ae,droppable:Boolean,unselectCancel:String,slotLabelFormat:ae,slotLaneClassNames:ae,slotLaneContent:ae,slotLaneDidMount:ae,slotLaneWillUnmount:ae,slotLabelClassNames:ae,slotLabelContent:ae,slotLabelDidMount:ae,slotLabelWillUnmount:ae,dayMaxEvents:ae,dayMaxEventRows:ae,dayMinWidth:Number,slotLabelInterval:ct,allDayText:String,allDayClassNames:ae,allDayContent:ae,allDayDidMount:ae,allDayWillUnmount:ae,slotMinWidth:Number,navLinks:Boolean,eventTimeFormat:is,rerenderDelay:Number,moreLinkText:ae,moreLinkHint:ae,selectMinDistance:Number,selectable:Boolean,selectLongPressDelay:Number,eventLongPressDelay:Number,selectMirror:Boolean,eventMaxStack:Number,eventMinHeight:Number,eventMinWidth:Number,eventShortHeight:Number,slotEventOverlap:Boolean,plugins:ae,firstDay:Number,dayCount:Number,dateAlignment:String,dateIncrement:ct,hiddenDays:ae,fixedWeekCount:Boolean,validRange:ae,visibleRange:ae,titleFormat:ae,eventInteractive:Boolean,noEventsText:String,viewHint:ae,navLinkHint:ae,closeHint:String,timeHint:String,eventHint:String,moreLinkClick:ae,moreLinkClassNames:ae,moreLinkContent:ae,moreLinkDidMount:ae,moreLinkWillUnmount:ae,monthStartFormat:is,handleCustomRendering:ae,customRenderingMetaMap:ae,customRenderingReplaces:Boolean},No={eventDisplay:"auto",defaultRangeSeparator:" - ",titleRangeSeparator:" – ",defaultTimedEventDuration:"01:00:00",defaultAllDayEventDuration:{day:1},forceEventDuration:!1,nextDayThreshold:"00:00:00",dayHeaders:!0,initialView:"",aspectRatio:1.35,headerToolbar:{start:"title",center:"",end:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"local",editable:!1,nowIndicator:!1,scrollTime:"06:00:00",scrollTimeReset:!0,slotMinTime:"00:00:00",slotMaxTime:"24:00:00",showNonCurrentDates:!0,lazyFetching:!0,startParam:"start",endParam:"end",timeZoneParam:"timeZone",timeZone:"local",locales:[],locale:"",themeSystem:"standard",dragRevertDuration:500,dragScroll:!0,allDayMaintainDuration:!1,unselectAuto:!0,dropAccept:"*",eventOrder:"start,-duration,allDay,title",dayPopoverFormat:{month:"long",day:"numeric",year:"numeric"},handleWindowResize:!0,windowResizeDelay:100,longPressDelay:1e3,eventDragMinDistance:5,expandRows:!1,navLinks:!1,selectable:!1,eventMinHeight:15,eventMinWidth:30,eventShortHeight:30,monthStartFormat:{month:"long",day:"numeric"},nowIndicatorSnap:"auto"},Bv={datesSet:ae,eventsSet:ae,eventAdd:ae,eventChange:ae,eventRemove:ae,windowResize:ae,eventClick:ae,eventMouseEnter:ae,eventMouseLeave:ae,select:ae,unselect:ae,loading:ae,_unmount:ae,_beforeprint:ae,_afterprint:ae,_noEventDrop:ae,_noEventResize:ae,_resize:ae,_scrollRequest:ae},Hv={buttonText:ae,buttonHints:ae,views:ae,plugins:ae,initialEvents:ae,events:ae,eventSources:ae},Ei={headerToolbar:_i,footerToolbar:_i,buttonText:_i,buttonHints:_i,buttonIcons:_i,dateIncrement:_i,plugins:vd,events:vd,eventSources:vd,resources:vd};function _i(n,e){return typeof n=="object"&&typeof e=="object"&&n&&e?Cn(n,e):n===e}function vd(n,e){return Array.isArray(n)&&Array.isArray(e)?ei(n,e):n===e}const Ak={type:String,component:ae,buttonText:String,buttonTextKey:String,dateProfileGeneratorClass:ae,usesMinMaxTime:Boolean,classNames:ae,content:ae,didMount:ae,willUnmount:ae};function _m(n){return ig(n,Ei)}function ag(n,e){let t={},s={};for(let i in e)i in n&&(t[i]=e[i](n[i]));for(let i in n)i in e||(s[i]=n[i]);return{refined:t,extra:s}}function ae(n){return n}const{hasOwnProperty:tu}=Object.prototype;function ig(n,e){let t={};if(e){for(let s in e)if(e[s]===_i){let i=[];for(let l=n.length-1;l>=0;l-=1){let c=n[l][s];if(typeof c=="object"&&c)i.unshift(c);else if(c!==void 0){t[s]=c;break}}i.length&&(t[s]=ig(i))}}for(let s=n.length-1;s>=0;s-=1){let i=n[s];for(let l in i)l in t||(t[l]=i[l])}return t}function qi(n,e){let t={};for(let s in n)e(n[s],s)&&(t[s]=n[s]);return t}function Wi(n,e){let t={};for(let s in n)t[s]=e(n[s],s);return t}function wA(n){let e={};for(let t of n)e[t]=!0;return e}function rg(n){let e=[];for(let t in n)e.push(n[t]);return e}function Cn(n,e){if(n===e)return!0;for(let t in n)if(tu.call(n,t)&&!(t in e))return!1;for(let t in e)if(tu.call(e,t)&&n[t]!==e[t])return!1;return!0}const Nk=/^on[A-Z]/;function Sk(n,e){const t=jk(n,e);for(let s of t)if(!Nk.test(s))return!1;return!0}function jk(n,e){let t=[];for(let s in n)tu.call(n,s)&&(s in e||t.push(s));for(let s in e)tu.call(e,s)&&n[s]!==e[s]&&t.push(s);return t}function Cm(n,e,t={}){if(n===e)return!0;for(let s in e)if(!(s in n&&Ek(n[s],e[s],t[s])))return!1;for(let s in n)if(!(s in e))return!1;return!0}function Ek(n,e,t){return n===e||t===!0?!0:t?t(n,e):!1}function _k(n,e=0,t,s=1){let i=[];t==null&&(t=Object.keys(n).length);for(let l=e;l<t;l+=s){let c=n[l];c!==void 0&&i.push(c)}return i}let AA={};function Ck(n,e){AA[n]=e}function Tk(n){return new AA[n]}class Dk{getMarkerYear(e){return e.getUTCFullYear()}getMarkerMonth(e){return e.getUTCMonth()}getMarkerDay(e){return e.getUTCDate()}arrayToMarker(e){return Is(e)}markerToArray(e){return Xa(e)}}Ck("gregory",Dk);const Rk=/^\s*(\d{4})(-?(\d{2})(-?(\d{2})([T ](\d{2}):?(\d{2})(:?(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/;function kk(n){let e=Rk.exec(n);if(e){let t=new Date(Date.UTC(Number(e[1]),e[3]?Number(e[3])-1:0,Number(e[5]||1),Number(e[7]||0),Number(e[8]||0),Number(e[10]||0),e[12]?+`0.${e[12]}`*1e3:0));if(vA(t)){let s=null;return e[13]&&(s=(e[15]==="-"?-1:1)*(Number(e[16]||0)*60+Number(e[18]||0))),{marker:t,isTimeUnspecified:!e[6],timeZoneOffset:s}}}return null}class Mk{constructor(e){let t=this.timeZone=e.timeZone,s=t!=="local"&&t!=="UTC";e.namedTimeZoneImpl&&s&&(this.namedTimeZoneImpl=new e.namedTimeZoneImpl(t)),this.canComputeOffset=!!(!s||this.namedTimeZoneImpl),this.calendarSystem=Tk(e.calendarSystem),this.locale=e.locale,this.weekDow=e.locale.week.dow,this.weekDoy=e.locale.week.doy,e.weekNumberCalculation==="ISO"&&(this.weekDow=1,this.weekDoy=4),typeof e.firstDay=="number"&&(this.weekDow=e.firstDay),typeof e.weekNumberCalculation=="function"&&(this.weekNumberFunc=e.weekNumberCalculation),this.weekText=e.weekText!=null?e.weekText:e.locale.options.weekText,this.weekTextLong=(e.weekTextLong!=null?e.weekTextLong:e.locale.options.weekTextLong)||this.weekText,this.cmdFormatter=e.cmdFormatter,this.defaultSeparator=e.defaultSeparator}createMarker(e){let t=this.createMarkerMeta(e);return t===null?null:t.marker}createNowMarker(){return this.canComputeOffset?this.timestampToMarker(new Date().valueOf()):Is(Mv(new Date))}createMarkerMeta(e){if(typeof e=="string")return this.parse(e);let t=null;return typeof e=="number"?t=this.timestampToMarker(e):e instanceof Date?(e=e.valueOf(),isNaN(e)||(t=this.timestampToMarker(e))):Array.isArray(e)&&(t=Is(e)),t===null||!vA(t)?null:{marker:t,isTimeUnspecified:!1,forcedTzo:null}}parse(e){let t=kk(e);if(t===null)return null;let{marker:s}=t,i=null;return t.timeZoneOffset!==null&&(this.canComputeOffset?s=this.timestampToMarker(s.valueOf()-t.timeZoneOffset*60*1e3):i=t.timeZoneOffset),{marker:s,isTimeUnspecified:t.isTimeUnspecified,forcedTzo:i}}getYear(e){return this.calendarSystem.getMarkerYear(e)}getMonth(e){return this.calendarSystem.getMarkerMonth(e)}getDay(e){return this.calendarSystem.getMarkerDay(e)}add(e,t){let s=this.calendarSystem.markerToArray(e);return s[0]+=t.years,s[1]+=t.months,s[2]+=t.days,s[6]+=t.milliseconds,this.calendarSystem.arrayToMarker(s)}subtract(e,t){let s=this.calendarSystem.markerToArray(e);return s[0]-=t.years,s[1]-=t.months,s[2]-=t.days,s[6]-=t.milliseconds,this.calendarSystem.arrayToMarker(s)}addYears(e,t){let s=this.calendarSystem.markerToArray(e);return s[0]+=t,this.calendarSystem.arrayToMarker(s)}addMonths(e,t){let s=this.calendarSystem.markerToArray(e);return s[1]+=t,this.calendarSystem.arrayToMarker(s)}diffWholeYears(e,t){let{calendarSystem:s}=this;return Qa(e)===Qa(t)&&s.getMarkerDay(e)===s.getMarkerDay(t)&&s.getMarkerMonth(e)===s.getMarkerMonth(t)?s.getMarkerYear(t)-s.getMarkerYear(e):null}diffWholeMonths(e,t){let{calendarSystem:s}=this;return Qa(e)===Qa(t)&&s.getMarkerDay(e)===s.getMarkerDay(t)?s.getMarkerMonth(t)-s.getMarkerMonth(e)+(s.getMarkerYear(t)-s.getMarkerYear(e))*12:null}greatestWholeUnit(e,t){let s=this.diffWholeYears(e,t);return s!==null?{unit:"year",value:s}:(s=this.diffWholeMonths(e,t),s!==null?{unit:"month",value:s}:(s=JR(e,t),s!==null?{unit:"week",value:s}:(s=Kd(e,t),s!==null?{unit:"day",value:s}:(s=XR(e,t),Sm(s)?{unit:"hour",value:s}:(s=QR(e,t),Sm(s)?{unit:"minute",value:s}:(s=ZR(e,t),Sm(s)?{unit:"second",value:s}:{unit:"millisecond",value:t.valueOf()-e.valueOf()}))))))}countDurationsBetween(e,t,s){let i;return s.years&&(i=this.diffWholeYears(e,t),i!==null)?i/$R(s):s.months&&(i=this.diffWholeMonths(e,t),i!==null)?i/GR(s):s.days&&(i=Kd(e,t),i!==null)?i/Wr(s):(t.valueOf()-e.valueOf())/Lo(s)}startOf(e,t){return t==="year"?this.startOfYear(e):t==="month"?this.startOfMonth(e):t==="week"?this.startOfWeek(e):t==="day"?Ct(e):t==="hour"?ek(e):t==="minute"?tk(e):t==="second"?sk(e):null}startOfYear(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e)])}startOfMonth(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e)])}startOfWeek(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e),e.getUTCDate()-(e.getUTCDay()-this.weekDow+7)%7])}computeWeekNumber(e){return this.weekNumberFunc?this.weekNumberFunc(this.toDate(e)):nk(e,this.weekDow,this.weekDoy)}format(e,t,s={}){return t.format({marker:e,timeZoneOffset:s.forcedTzo!=null?s.forcedTzo:this.offsetForMarker(e)},this)}formatRange(e,t,s,i={}){return i.isEndExclusive&&(t=ti(t,-1)),s.formatRange({marker:e,timeZoneOffset:i.forcedStartTzo!=null?i.forcedStartTzo:this.offsetForMarker(e)},{marker:t,timeZoneOffset:i.forcedEndTzo!=null?i.forcedEndTzo:this.offsetForMarker(t)},this,i.defaultSeparator)}formatIso(e,t={}){let s=null;return t.omitTimeZoneOffset||(t.forcedTzo!=null?s=t.forcedTzo:s=this.offsetForMarker(e)),ik(e,s,t.omitTime)}timestampToMarker(e){return this.timeZone==="local"?Is(Mv(new Date(e))):this.timeZone==="UTC"||!this.namedTimeZoneImpl?new Date(e):Is(this.namedTimeZoneImpl.timestampToArray(e))}offsetForMarker(e){return this.timeZone==="local"?-Lv(Xa(e)).getTimezoneOffset():this.timeZone==="UTC"?0:this.namedTimeZoneImpl?this.namedTimeZoneImpl.offsetForArray(Xa(e)):null}toDate(e,t){return this.timeZone==="local"?Lv(Xa(e)):this.timeZone==="UTC"?new Date(e.valueOf()):this.namedTimeZoneImpl?new Date(e.valueOf()-this.namedTimeZoneImpl.offsetForArray(Xa(e))*1e3*60):new Date(e.valueOf()-(t||0))}}class Qo{constructor(e){this.iconOverrideOption&&this.setIconOverride(e[this.iconOverrideOption])}setIconOverride(e){let t,s;if(typeof e=="object"&&e){t=Object.assign({},this.iconClasses);for(s in e)t[s]=this.applyIconOverridePrefix(e[s]);this.iconClasses=t}else e===!1&&(this.iconClasses={})}applyIconOverridePrefix(e){let t=this.iconOverridePrefix;return t&&e.indexOf(t)!==0&&(e=t+e),e}getClass(e){return this.classes[e]||""}getIconClass(e,t){let s;return t&&this.rtlIconClasses?s=this.rtlIconClasses[e]||this.iconClasses[e]:s=this.iconClasses[e],s?`${this.baseIconClass} ${s}`:""}getCustomButtonIconClass(e){let t;return this.iconOverrideCustomButtonOption&&(t=e[this.iconOverrideCustomButtonOption],t)?`${this.baseIconClass} ${this.applyIconOverridePrefix(t)}`:""}}Qo.prototype.classes={};Qo.prototype.iconClasses={};Qo.prototype.baseIconClass="";Qo.prototype.iconOverridePrefix="";function su(n){n();let e=Pe.debounceRendering,t=[];function s(i){t.push(i)}for(Pe.debounceRendering=s,Mo(ie(Lk,{}),document.createElement("div"));t.length;)t.shift()();Pe.debounceRendering=e}class Lk extends Js{render(){return ie("div",{})}componentDidMount(){this.setState({})}}function NA(n){let e=iR(n),t=e.Provider;return e.Provider=function(){let s=!this.getChildContext,i=t.apply(this,arguments);if(s){let l=[];this.shouldComponentUpdate=c=>{this.props.value!==c.value&&l.forEach(u=>{u.context=c.value,u.forceUpdate()})},this.sub=c=>{l.push(c);let u=c.componentWillUnmount;c.componentWillUnmount=()=>{l.splice(l.indexOf(c),1),u&&u.call(c)}}}return i},e}class Ok{constructor(e,t,s,i){this.execFunc=e,this.emitter=t,this.scrollTime=s,this.scrollTimeReset=i,this.handleScrollRequest=l=>{this.queuedRequest=Object.assign({},this.queuedRequest||{},l),this.drain()},t.on("_scrollRequest",this.handleScrollRequest),this.fireInitialScroll()}detach(){this.emitter.off("_scrollRequest",this.handleScrollRequest)}update(e){e&&this.scrollTimeReset?this.fireInitialScroll():this.drain()}fireInitialScroll(){this.handleScrollRequest({time:this.scrollTime})}drain(){this.queuedRequest&&this.execFunc(this.queuedRequest)&&(this.queuedRequest=null)}}const Xi=NA({});function Pk(n,e,t,s,i,l,c,u,h,m,p,x,y,v){return{dateEnv:i,nowManager:l,options:t,pluginHooks:u,emitter:p,dispatch:h,getCurrentData:m,calendarApi:x,viewSpec:n,viewApi:e,dateProfileGenerator:s,theme:c,isRtl:t.direction==="rtl",addResizeHandler(w){p.on("_resize",w)},removeResizeHandler(w){p.off("_resize",w)},createScrollResponder(w){return new Ok(w,p,ct(t.scrollTime),t.scrollTimeReset)},registerInteractiveComponent:y,unregisterInteractiveComponent:v}}class Qi extends Js{shouldComponentUpdate(e,t){return!Cm(this.props,e,this.propEquality)||!Cm(this.state,t,this.stateEquality)}safeSetState(e){Cm(this.state,Object.assign(Object.assign({},this.state),e),this.stateEquality)||this.setState(e)}}Qi.addPropsEquality=Ik;Qi.addStateEquality=Bk;Qi.contextType=Xi;Qi.prototype.propEquality={};Qi.prototype.stateEquality={};class Lt extends Qi{}Lt.contextType=Xi;function Ik(n){let e=Object.create(this.prototype.propEquality);Object.assign(e,n),this.prototype.propEquality=e}function Bk(n){let e=Object.create(this.prototype.stateEquality);Object.assign(e,n),this.prototype.stateEquality=e}function Xn(n,e){typeof n=="function"?n(e):n&&(n.current=e)}class lg extends Lt{constructor(){super(...arguments),this.id=Yi(),this.queuedDomNodes=[],this.currentDomNodes=[],this.handleEl=e=>{const{options:t}=this.context,{generatorName:s}=this.props;(!t.customRenderingReplaces||!cp(s,t))&&this.updateElRef(e)},this.updateElRef=e=>{this.props.elRef&&Xn(this.props.elRef,e)}}render(){const{props:e,context:t}=this,{options:s}=t,{customGenerator:i,defaultGenerator:l,renderProps:c}=e,u=SA(e,[],this.handleEl);let h=!1,m,p=[],x;if(i!=null){const y=typeof i=="function"?i(c,ie):i;if(y===!0)h=!0;else{const v=y&&typeof y=="object";v&&"html"in y?u.dangerouslySetInnerHTML={__html:y.html}:v&&"domNodes"in y?p=Array.prototype.slice.call(y.domNodes):(v?W1(y):typeof y!="function")?m=y:x=y}}else h=!cp(e.generatorName,s);return h&&l&&(m=l(c)),this.queuedDomNodes=p,this.currentGeneratorMeta=x,ie(e.elTag,u,m)}componentDidMount(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentDidUpdate(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentWillUnmount(){this.triggerCustomRendering(!1)}triggerCustomRendering(e){var t;const{props:s,context:i}=this,{handleCustomRendering:l,customRenderingMetaMap:c}=i.options;if(l){const u=(t=this.currentGeneratorMeta)!==null&&t!==void 0?t:c?.[s.generatorName];u&&l(Object.assign(Object.assign({id:this.id,isActive:e,containerEl:this.base,reportNewContainerEl:this.updateElRef,generatorMeta:u},s),{elClasses:(s.elClasses||[]).filter(Hk)}))}}applyQueueudDomNodes(){const{queuedDomNodes:e,currentDomNodes:t}=this,s=this.base;if(!ei(e,t)){t.forEach(Jp);for(let i of e)s.appendChild(i);this.currentDomNodes=e}}}lg.addPropsEquality({elClasses:ei,elStyle:Cn,elAttrs:Sk,renderProps:Cn});function cp(n,e){var t;return!!(e.handleCustomRendering&&n&&(!((t=e.customRenderingMetaMap)===null||t===void 0)&&t[n]))}function SA(n,e,t){const s=Object.assign(Object.assign({},n.elAttrs),{ref:t});return(n.elClasses||e)&&(s.className=(n.elClasses||[]).concat(e||[]).concat(s.className||[]).filter(Boolean).join(" ")),n.elStyle&&(s.style=n.elStyle),s}function Hk(n){return!!n}const jA=NA(0);class va extends Js{constructor(){super(...arguments),this.InnerContent=zk.bind(void 0,this),this.handleEl=e=>{this.el=e,this.props.elRef&&(Xn(this.props.elRef,e),e&&this.didMountMisfire&&this.componentDidMount())}}render(){const{props:e}=this,t=Fk(e.classNameGenerator,e.renderProps);if(e.children){const s=SA(e,t,this.handleEl),i=e.children(this.InnerContent,e.renderProps,s);return e.elTag?ie(e.elTag,s,i):i}else return ie(lg,Object.assign(Object.assign({},e),{elRef:this.handleEl,elTag:e.elTag||"div",elClasses:(e.elClasses||[]).concat(t),renderId:this.context}))}componentDidMount(){var e,t;this.el?(t=(e=this.props).didMount)===null||t===void 0||t.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el})):this.didMountMisfire=!0}componentWillUnmount(){var e,t;(t=(e=this.props).willUnmount)===null||t===void 0||t.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el}))}}va.contextType=jA;function zk(n,e){const t=n.props;return ie(lg,Object.assign({renderProps:t.renderProps,generatorName:t.generatorName,customGenerator:t.customGenerator,defaultGenerator:t.defaultGenerator,renderId:n.context},e))}function Fk(n,e){const t=typeof n=="function"?n(e):n||[];return typeof t=="string"?[t]:t}class zv extends Lt{render(){let{props:e,context:t}=this,{options:s}=t,i={view:t.viewApi};return ie(va,{elRef:e.elRef,elTag:e.elTag||"div",elAttrs:e.elAttrs,elClasses:[...EA(e.viewSpec),...e.elClasses||[]],elStyle:e.elStyle,renderProps:i,classNameGenerator:s.viewClassNames,generatorName:void 0,didMount:s.viewDidMount,willUnmount:s.viewWillUnmount},()=>e.children)}}function EA(n){return[`fc-${n.type}-view`,"fc-view"]}function Uk(n,e){let t=null,s=null;return n.start&&(t=e.createMarker(n.start)),n.end&&(s=e.createMarker(n.end)),!t&&!s||t&&s&&s<t?null:{start:t,end:s}}function Fv(n,e){let t=[],{start:s}=e,i,l;for(n.sort(qk),i=0;i<n.length;i+=1)l=n[i],l.start>s&&t.push({start:s,end:l.start}),l.end>s&&(s=l.end);return s<e.end&&t.push({start:s,end:e.end}),t}function qk(n,e){return n.start.valueOf()-e.start.valueOf()}function el(n,e){let{start:t,end:s}=n,i=null;return e.start!==null&&(t===null?t=e.start:t=new Date(Math.max(t.valueOf(),e.start.valueOf()))),e.end!=null&&(s===null?s=e.end:s=new Date(Math.min(s.valueOf(),e.end.valueOf()))),(t===null||s===null||t<s)&&(i={start:t,end:s}),i}function Vk(n,e){return(n.start===null?null:n.start.valueOf())===(e.start===null?null:e.start.valueOf())&&(n.end===null?null:n.end.valueOf())===(e.end===null?null:e.end.valueOf())}function og(n,e){return(n.end===null||e.start===null||n.end>e.start)&&(n.start===null||e.end===null||n.start<e.end)}function Cu(n,e){return(n.start===null||e.start!==null&&e.start>=n.start)&&(n.end===null||e.end!==null&&e.end<=n.end)}function Za(n,e){return(n.start===null||e>=n.start)&&(n.end===null||e<n.end)}function $k(n,e){return e.start!=null&&n<e.start?e.start:e.end!=null&&n>=e.end?new Date(e.end.valueOf()-1):n}function _A(n){let e=Math.floor(ol(n.start,n.end))||1,t=Ct(n.start),s=rs(t,e);return{start:t,end:s}}function CA(n,e=ct(0)){let t=null,s=null;if(n.end){s=Ct(n.end);let i=n.end.valueOf()-s.valueOf();i&&i>=Lo(e)&&(s=rs(s,1))}return n.start&&(t=Ct(n.start),s&&s<=t&&(s=rs(t,1))),{start:t,end:s}}function $r(n,e,t,s){return s==="year"?ct(t.diffWholeYears(n,e),"year"):s==="month"?ct(t.diffWholeMonths(n,e),"month"):KR(n,e)}class TA{constructor(e){this.props=e,this.initHiddenDays()}buildPrev(e,t,s){let{dateEnv:i}=this.props,l=i.subtract(i.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(l,-1,s)}buildNext(e,t,s){let{dateEnv:i}=this.props,l=i.add(i.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(l,1,s)}build(e,t,s=!0){let{props:i}=this,l,c,u,h,m,p;return l=this.buildValidRange(),l=this.trimHiddenDays(l),s&&(e=$k(e,l)),c=this.buildCurrentRangeInfo(e,t),u=/^(year|month|week|day)$/.test(c.unit),h=this.buildRenderRange(this.trimHiddenDays(c.range),c.unit,u),h=this.trimHiddenDays(h),m=h,i.showNonCurrentDates||(m=el(m,c.range)),m=this.adjustActiveRange(m),m=el(m,l),p=og(c.range,l),Za(h,e)||(e=h.start),{currentDate:e,validRange:l,currentRange:c.range,currentRangeUnit:c.unit,isRangeAllDay:u,activeRange:m,renderRange:h,slotMinTime:i.slotMinTime,slotMaxTime:i.slotMaxTime,isValid:p,dateIncrement:this.buildDateIncrement(c.duration)}}buildValidRange(){let e=this.props.validRangeInput,t=typeof e=="function"?e.call(this.props.calendarApi,this.props.dateEnv.toDate(this.props.nowManager.getDateMarker())):e;return this.refineRange(t)||{start:null,end:null}}buildCurrentRangeInfo(e,t){let{props:s}=this,i=null,l=null,c=null,u;return s.duration?(i=s.duration,l=s.durationUnit,c=this.buildRangeFromDuration(e,t,i,l)):(u=this.props.dayCount)?(l="day",c=this.buildRangeFromDayCount(e,t,u)):(c=this.buildCustomVisibleRange(e))?l=s.dateEnv.greatestWholeUnit(c.start,c.end).unit:(i=this.getFallbackDuration(),l=op(i).unit,c=this.buildRangeFromDuration(e,t,i,l)),{duration:i,unit:l,range:c}}getFallbackDuration(){return ct({day:1})}adjustActiveRange(e){let{dateEnv:t,usesMinMaxTime:s,slotMinTime:i,slotMaxTime:l}=this.props,{start:c,end:u}=e;return s&&(Wr(i)<0&&(c=Ct(c),c=t.add(c,i)),Wr(l)>1&&(u=Ct(u),u=rs(u,-1),u=t.add(u,l))),{start:c,end:u}}buildRangeFromDuration(e,t,s,i){let{dateEnv:l,dateAlignment:c}=this.props,u,h,m;if(!c){let{dateIncrement:x}=this.props;x&&Lo(x)<Lo(s)?c=op(x).unit:c=i}Wr(s)<=1&&this.isHiddenDay(u)&&(u=this.skipHiddenDays(u,t),u=Ct(u));function p(){u=l.startOf(e,c),h=l.add(u,s),m={start:u,end:h}}return p(),this.trimHiddenDays(m)||(e=this.skipHiddenDays(e,t),p()),m}buildRangeFromDayCount(e,t,s){let{dateEnv:i,dateAlignment:l}=this.props,c=0,u=e,h;l&&(u=i.startOf(u,l)),u=Ct(u),u=this.skipHiddenDays(u,t),h=u;do h=rs(h,1),this.isHiddenDay(h)||(c+=1);while(c<s);return{start:u,end:h}}buildCustomVisibleRange(e){let{props:t}=this,s=t.visibleRangeInput,i=typeof s=="function"?s.call(t.calendarApi,t.dateEnv.toDate(e)):s,l=this.refineRange(i);return l&&(l.start==null||l.end==null)?null:l}buildRenderRange(e,t,s){return e}buildDateIncrement(e){let{dateIncrement:t}=this.props,s;return t||((s=this.props.dateAlignment)?ct(1,s):e||ct({days:1}))}refineRange(e){if(e){let t=Uk(e,this.props.dateEnv);return t&&(t=CA(t)),t}return null}initHiddenDays(){let e=this.props.hiddenDays||[],t=[],s=0,i;for(this.props.weekends===!1&&e.push(0,6),i=0;i<7;i+=1)(t[i]=e.indexOf(i)!==-1)||(s+=1);if(!s)throw new Error("invalid hiddenDays");this.isHiddenDayHash=t}trimHiddenDays(e){let{start:t,end:s}=e;return t&&(t=this.skipHiddenDays(t)),s&&(s=this.skipHiddenDays(s,-1,!0)),t==null||s==null||t<s?{start:t,end:s}:null}isHiddenDay(e){return e instanceof Date&&(e=e.getUTCDay()),this.isHiddenDayHash[e]}skipHiddenDays(e,t=1,s=!1){for(;this.isHiddenDayHash[(e.getUTCDay()+(s?t:0)+7)%7];)e=rs(e,t);return e}}function cg(n,e,t,s){return{instanceId:Yi(),defId:n,range:e,forcedStartTzo:t??null,forcedEndTzo:s??null}}function Gk(n,e,t,s){for(let i=0;i<s.length;i+=1){let l=s[i].parse(n,t);if(l){let{allDay:c}=n;return c==null&&(c=e,c==null&&(c=l.allDayGuess,c==null&&(c=!1))),{allDay:c,duration:l.duration,typeData:l.typeData,typeId:i}}}return null}function Vi(n,e,t){let{dateEnv:s,pluginHooks:i,options:l}=t,{defs:c,instances:u}=n;u=qi(u,h=>!c[h.defId].recurringDef);for(let h in c){let m=c[h];if(m.recurringDef){let{duration:p}=m.recurringDef;p||(p=m.allDay?l.defaultAllDayEventDuration:l.defaultTimedEventDuration);let x=Yk(m,p,e,s,i.recurringTypes);for(let y of x){let v=cg(h,{start:y,end:s.add(y,p)});u[v.instanceId]=v}}}return{defs:c,instances:u}}function Yk(n,e,t,s,i){let c=i[n.recurringDef.typeId].expand(n.recurringDef.typeData,{start:s.subtract(t.start,e),end:t.end},s);return n.allDay&&(c=c.map(Ct)),c}const Id={id:String,groupId:String,title:String,url:String,interactive:Boolean},DA={start:ae,end:ae,date:ae,allDay:Boolean},Wk=Object.assign(Object.assign(Object.assign({},Id),DA),{extendedProps:ae});function RA(n,e,t,s,i=dg(t),l,c){let{refined:u,extra:h}=kA(n,t,i),m=Qk(e,t),p=Gk(u,m,t.dateEnv,t.pluginHooks.recurringTypes);if(p){let y=dp(u,h,e?e.sourceId:"",p.allDay,!!p.duration,t,l);return y.recurringDef={typeId:p.typeId,typeData:p.typeData,duration:p.duration},{def:y,instance:null}}let x=Xk(u,m,t,s);if(x){let y=dp(u,h,e?e.sourceId:"",x.allDay,x.hasEnd,t,l),v=cg(y.defId,x.range,x.forcedStartTzo,x.forcedEndTzo);return c&&y.publicId&&c[y.publicId]&&(v.instanceId=c[y.publicId]),{def:y,instance:v}}return null}function kA(n,e,t=dg(e)){return ag(n,t)}function dg(n){return Object.assign(Object.assign(Object.assign({},nu),Wk),n.pluginHooks.eventRefiners)}function dp(n,e,t,s,i,l,c){let u={title:n.title||"",groupId:n.groupId||"",publicId:n.id||"",url:n.url||"",recurringDef:null,defId:(c&&n.id?c[n.id]:"")||Yi(),sourceId:t,allDay:s,hasEnd:i,interactive:n.interactive,ui:au(n,l),extendedProps:Object.assign(Object.assign({},n.extendedProps||{}),e)};for(let h of l.pluginHooks.eventDefMemberAdders)Object.assign(u,h(n));return Object.freeze(u.ui.classNames),Object.freeze(u.extendedProps),u}function Xk(n,e,t,s){let{allDay:i}=n,l,c=null,u=!1,h,m=null,p=n.start!=null?n.start:n.date;if(l=t.dateEnv.createMarkerMeta(p),l)c=l.marker;else if(!s)return null;return n.end!=null&&(h=t.dateEnv.createMarkerMeta(n.end)),i==null&&(e!=null?i=e:i=(!l||l.isTimeUnspecified)&&(!h||h.isTimeUnspecified)),i&&c&&(c=Ct(c)),h&&(m=h.marker,i&&(m=Ct(m)),c&&m<=c&&(m=null)),m?u=!0:s||(u=t.options.forceEventDuration||!1,m=t.dateEnv.add(c,i?t.options.defaultAllDayEventDuration:t.options.defaultTimedEventDuration)),{allDay:i,hasEnd:u,range:{start:c,end:m},forcedStartTzo:l?l.forcedTzo:null,forcedEndTzo:h?h.forcedTzo:null}}function Qk(n,e){let t=null;return n&&(t=n.defaultAllDay),t==null&&(t=e.options.defaultAllDay),t}function Oo(n,e,t,s,i,l){let c=jn(),u=dg(t);for(let h of n){let m=RA(h,e,t,s,u,i,l);m&&up(m,c)}return c}function up(n,e=jn()){return e.defs[n.def.defId]=n.def,n.instance&&(e.instances[n.instance.instanceId]=n.instance),e}function ug(n,e){let t=n.instances[e];if(t){let s=n.defs[t.defId],i=Tu(n,l=>Zk(s,l));return i.defs[s.defId]=s,i.instances[t.instanceId]=t,i}return jn()}function Zk(n,e){return!!(n.groupId&&n.groupId===e.groupId)}function jn(){return{defs:{},instances:{}}}function hg(n,e){return{defs:Object.assign(Object.assign({},n.defs),e.defs),instances:Object.assign(Object.assign({},n.instances),e.instances)}}function Tu(n,e){let t=qi(n.defs,e),s=qi(n.instances,i=>t[i.defId]);return{defs:t,instances:s}}function Kk(n,e){let{defs:t,instances:s}=n,i={},l={};for(let c in t)e.defs[c]||(i[c]=t[c]);for(let c in s)!e.instances[c]&&i[s[c].defId]&&(l[c]=s[c]);return{defs:i,instances:l}}function Jk(n,e){return Array.isArray(n)?Oo(n,null,e,!0):typeof n=="object"&&n?Oo([n],null,e,!0):n!=null?String(n):null}function Uv(n){return Array.isArray(n)?n:typeof n=="string"?n.split(/\s+/):[]}const nu={display:String,editable:Boolean,startEditable:Boolean,durationEditable:Boolean,constraint:ae,overlap:ae,allow:ae,className:Uv,classNames:Uv,color:String,backgroundColor:String,borderColor:String,textColor:String},eM={display:null,startEditable:null,durationEditable:null,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]};function au(n,e){let t=Jk(n.constraint,e);return{display:n.display||null,startEditable:n.startEditable!=null?n.startEditable:n.editable,durationEditable:n.durationEditable!=null?n.durationEditable:n.editable,constraints:t!=null?[t]:[],overlap:n.overlap!=null?n.overlap:null,allows:n.allow!=null?[n.allow]:[],backgroundColor:n.backgroundColor||n.color||"",borderColor:n.borderColor||n.color||"",textColor:n.textColor||"",classNames:(n.className||[]).concat(n.classNames||[])}}function tM(n){return n.reduce(sM,eM)}function sM(n,e){return{display:e.display!=null?e.display:n.display,startEditable:e.startEditable!=null?e.startEditable:n.startEditable,durationEditable:e.durationEditable!=null?e.durationEditable:n.durationEditable,constraints:n.constraints.concat(e.constraints),overlap:typeof e.overlap=="boolean"?e.overlap:n.overlap,allows:n.allows.concat(e.allows),backgroundColor:e.backgroundColor||n.backgroundColor,borderColor:e.borderColor||n.borderColor,textColor:e.textColor||n.textColor,classNames:n.classNames.concat(e.classNames)}}const nM={id:String,defaultAllDay:Boolean,url:String,format:String,events:ae,eventDataTransform:ae,success:ae,failure:ae};function MA(n,e,t=LA(e)){let s;if(typeof n=="string"?s={url:n}:typeof n=="function"||Array.isArray(n)?s={events:n}:typeof n=="object"&&n&&(s=n),s){let{refined:i,extra:l}=ag(s,t),c=aM(i,e);if(c)return{_raw:n,isFetching:!1,latestFetchId:"",fetchRange:null,defaultAllDay:i.defaultAllDay,eventDataTransform:i.eventDataTransform,success:i.success,failure:i.failure,publicId:i.id||"",sourceId:Yi(),sourceDefId:c.sourceDefId,meta:c.meta,ui:au(i,e),extendedProps:l}}return null}function LA(n){return Object.assign(Object.assign(Object.assign({},nu),nM),n.pluginHooks.eventSourceRefiners)}function aM(n,e){let t=e.pluginHooks.eventSourceDefs;for(let s=t.length-1;s>=0;s-=1){let l=t[s].parseMeta(n);if(l)return{sourceDefId:s,meta:l}}return null}function iM(n,e,t,s,i){switch(e.type){case"RECEIVE_EVENTS":return rM(n,t[e.sourceId],e.fetchId,e.fetchRange,e.rawEvents,i);case"RESET_RAW_EVENTS":return lM(n,t[e.sourceId],e.rawEvents,s.activeRange,i);case"ADD_EVENTS":return oM(n,e.eventStore,s?s.activeRange:null,i);case"RESET_EVENTS":return e.eventStore;case"MERGE_EVENTS":return hg(n,e.eventStore);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return s?Vi(n,s.activeRange,i):n;case"REMOVE_EVENTS":return Kk(n,e.eventStore);case"REMOVE_EVENT_SOURCE":return PA(n,e.sourceId);case"REMOVE_ALL_EVENT_SOURCES":return Tu(n,l=>!l.sourceId);case"REMOVE_ALL_EVENTS":return jn();default:return n}}function rM(n,e,t,s,i,l){if(e&&t===e.latestFetchId){let c=Oo(OA(i,e,l),e,l);return s&&(c=Vi(c,s,l)),hg(PA(n,e.sourceId),c)}return n}function lM(n,e,t,s,i){const{defIdMap:l,instanceIdMap:c}=dM(n);let u=Oo(OA(t,e,i),e,i,!1,l,c);return Vi(u,s,i)}function OA(n,e,t){let s=t.options.eventDataTransform,i=e?e.eventDataTransform:null;return i&&(n=qv(n,i)),s&&(n=qv(n,s)),n}function qv(n,e){let t;if(!e)t=n;else{t=[];for(let s of n){let i=e(s);i?t.push(i):i==null&&t.push(s)}}return t}function oM(n,e,t,s){return t&&(e=Vi(e,t,s)),hg(n,e)}function Vv(n,e,t){let{defs:s}=n,i=Wi(n.instances,l=>s[l.defId].allDay?l:Object.assign(Object.assign({},l),{range:{start:t.createMarker(e.toDate(l.range.start,l.forcedStartTzo)),end:t.createMarker(e.toDate(l.range.end,l.forcedEndTzo))},forcedStartTzo:t.canComputeOffset?null:l.forcedStartTzo,forcedEndTzo:t.canComputeOffset?null:l.forcedEndTzo}));return{defs:s,instances:i}}function PA(n,e){return Tu(n,t=>t.sourceId!==e)}function cM(n,e){return{defs:n.defs,instances:qi(n.instances,t=>!e[t.instanceId])}}function dM(n){const{defs:e,instances:t}=n,s={},i={};for(let l in e){const c=e[l],{publicId:u}=c;u&&(s[u]=l)}for(let l in t){const c=t[l],u=e[c.defId],{publicId:h}=u;h&&(i[h]=l)}return{defIdMap:s,instanceIdMap:i}}class Du{constructor(){this.handlers={},this.thisContext=null}setThisContext(e){this.thisContext=e}setOptions(e){this.options=e}on(e,t){uM(this.handlers,e,t)}off(e,t){hM(this.handlers,e,t)}trigger(e,...t){let s=this.handlers[e]||[],i=this.options&&this.options[e],l=[].concat(i||[],s);for(let c of l)c.apply(this.thisContext,t)}hasHandlers(e){return!!(this.handlers[e]&&this.handlers[e].length||this.options&&this.options[e])}}function uM(n,e,t){(n[e]||(n[e]=[])).push(t)}function hM(n,e,t){t?n[e]&&(n[e]=n[e].filter(s=>s!==t)):delete n[e]}const fM={startTime:"09:00",endTime:"17:00",daysOfWeek:[1,2,3,4,5],display:"inverse-background",classNames:"fc-non-business",groupId:"_businessHours"};function mM(n,e){return Oo(pM(n),null,e)}function pM(n){let e;return n===!0?e=[{}]:Array.isArray(n)?e=n.filter(t=>t.daysOfWeek):typeof n=="object"&&n?e=[n]:e=[],e=e.map(t=>Object.assign(Object.assign({},fM),t)),e}function IA(n,e,t){t.emitter.trigger("select",Object.assign(Object.assign({},fg(n,t)),{jsEvent:e?e.origEvent:null,view:t.viewApi||t.calendarApi.view}))}function gM(n,e){e.emitter.trigger("unselect",{jsEvent:n?n.origEvent:null,view:e.viewApi||e.calendarApi.view})}function fg(n,e){let t={};for(let s of e.pluginHooks.dateSpanTransforms)Object.assign(t,s(n,e));return Object.assign(t,RM(n,e.dateEnv)),t}function $v(n,e,t){let{dateEnv:s,options:i}=t,l=e;return n?(l=Ct(l),l=s.add(l,i.defaultAllDayEventDuration)):l=s.add(l,i.defaultTimedEventDuration),l}function mg(n,e,t,s){let i=iu(n.defs,e),l=jn();for(let c in n.defs){let u=n.defs[c];l.defs[c]=xM(u,i[c],t,s)}for(let c in n.instances){let u=n.instances[c],h=l.defs[u.defId];l.instances[c]=yM(u,h,i[u.defId],t,s)}return l}function xM(n,e,t,s){let i=t.standardProps||{};i.hasEnd==null&&e.durationEditable&&(t.startDelta||t.endDelta)&&(i.hasEnd=!0);let l=Object.assign(Object.assign(Object.assign({},n),i),{ui:Object.assign(Object.assign({},n.ui),i.ui)});t.extendedProps&&(l.extendedProps=Object.assign(Object.assign({},l.extendedProps),t.extendedProps));for(let c of s.pluginHooks.eventDefMutationAppliers)c(l,t,s);return!l.hasEnd&&s.options.forceEventDuration&&(l.hasEnd=!0),l}function yM(n,e,t,s,i){let{dateEnv:l}=i,c=s.standardProps&&s.standardProps.allDay===!0,u=s.standardProps&&s.standardProps.hasEnd===!1,h=Object.assign({},n);return c&&(h.range=_A(h.range)),s.datesDelta&&t.startEditable&&(h.range={start:l.add(h.range.start,s.datesDelta),end:l.add(h.range.end,s.datesDelta)}),s.startDelta&&t.durationEditable&&(h.range={start:l.add(h.range.start,s.startDelta),end:h.range.end}),s.endDelta&&t.durationEditable&&(h.range={start:h.range.start,end:l.add(h.range.end,s.endDelta)}),u&&(h.range={start:h.range.start,end:$v(e.allDay,h.range.start,i)}),e.allDay&&(h.range={start:Ct(h.range.start),end:Ct(h.range.end)}),h.range.end<h.range.start&&(h.range.end=$v(e.allDay,h.range.start,i)),h}class Fr{constructor(e,t){this.context=e,this.internalEventSource=t}remove(){this.context.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:this.internalEventSource.sourceId})}refetch(){this.context.dispatch({type:"FETCH_EVENT_SOURCES",sourceIds:[this.internalEventSource.sourceId],isRefetch:!0})}get id(){return this.internalEventSource.publicId}get url(){return this.internalEventSource.meta.url}get format(){return this.internalEventSource.meta.format}}class Tt{constructor(e,t,s){this._context=e,this._def=t,this._instance=s||null}setProp(e,t){if(e in DA)console.warn("Could not set date-related prop 'name'. Use one of the date-related methods instead.");else if(e==="id")t=Id[e](t),this.mutate({standardProps:{publicId:t}});else if(e in Id)t=Id[e](t),this.mutate({standardProps:{[e]:t}});else if(e in nu){let s=nu[e](t);e==="color"?s={backgroundColor:t,borderColor:t}:e==="editable"?s={startEditable:t,durationEditable:t}:s={[e]:t},this.mutate({standardProps:{ui:s}})}else console.warn(`Could not set prop '${e}'. Use setExtendedProp instead.`)}setExtendedProp(e,t){this.mutate({extendedProps:{[e]:t}})}setStart(e,t={}){let{dateEnv:s}=this._context,i=s.createMarker(e);if(i&&this._instance){let l=this._instance.range,c=$r(l.start,i,s,t.granularity);t.maintainDuration?this.mutate({datesDelta:c}):this.mutate({startDelta:c})}}setEnd(e,t={}){let{dateEnv:s}=this._context,i;if(!(e!=null&&(i=s.createMarker(e),!i))&&this._instance)if(i){let l=$r(this._instance.range.end,i,s,t.granularity);this.mutate({endDelta:l})}else this.mutate({standardProps:{hasEnd:!1}})}setDates(e,t,s={}){let{dateEnv:i}=this._context,l={allDay:s.allDay},c=i.createMarker(e),u;if(c&&!(t!=null&&(u=i.createMarker(t),!u))&&this._instance){let h=this._instance.range;s.allDay===!0&&(h=_A(h));let m=$r(h.start,c,i,s.granularity);if(u){let p=$r(h.end,u,i,s.granularity);qR(m,p)?this.mutate({datesDelta:m,standardProps:l}):this.mutate({startDelta:m,endDelta:p,standardProps:l})}else l.hasEnd=!1,this.mutate({datesDelta:m,standardProps:l})}}moveStart(e){let t=ct(e);t&&this.mutate({startDelta:t})}moveEnd(e){let t=ct(e);t&&this.mutate({endDelta:t})}moveDates(e){let t=ct(e);t&&this.mutate({datesDelta:t})}setAllDay(e,t={}){let s={allDay:e},{maintainDuration:i}=t;i==null&&(i=this._context.options.allDayMaintainDuration),this._def.allDay!==e&&(s.hasEnd=i),this.mutate({standardProps:s})}formatRange(e){let{dateEnv:t}=this._context,s=this._instance,i=is(e);return this._def.hasEnd?t.formatRange(s.range.start,s.range.end,i,{forcedStartTzo:s.forcedStartTzo,forcedEndTzo:s.forcedEndTzo}):t.format(s.range.start,i,{forcedTzo:s.forcedStartTzo})}mutate(e){let t=this._instance;if(t){let s=this._def,i=this._context,{eventStore:l}=i.getCurrentData(),c=ug(l,t.instanceId);c=mg(c,{"":{display:"",startEditable:!0,durationEditable:!0,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]}},e,i);let h=new Tt(i,s,t);this._def=c.defs[s.defId],this._instance=c.instances[t.instanceId],i.dispatch({type:"MERGE_EVENTS",eventStore:c}),i.emitter.trigger("eventChange",{oldEvent:h,event:this,relatedEvents:Bi(c,i,t),revert(){i.dispatch({type:"RESET_EVENTS",eventStore:l})}})}}remove(){let e=this._context,t=BA(this);e.dispatch({type:"REMOVE_EVENTS",eventStore:t}),e.emitter.trigger("eventRemove",{event:this,relatedEvents:[],revert(){e.dispatch({type:"MERGE_EVENTS",eventStore:t})}})}get source(){let{sourceId:e}=this._def;return e?new Fr(this._context,this._context.getCurrentData().eventSources[e]):null}get start(){return this._instance?this._context.dateEnv.toDate(this._instance.range.start):null}get end(){return this._instance&&this._def.hasEnd?this._context.dateEnv.toDate(this._instance.range.end):null}get startStr(){let e=this._instance;return e?this._context.dateEnv.formatIso(e.range.start,{omitTime:this._def.allDay,forcedTzo:e.forcedStartTzo}):""}get endStr(){let e=this._instance;return e&&this._def.hasEnd?this._context.dateEnv.formatIso(e.range.end,{omitTime:this._def.allDay,forcedTzo:e.forcedEndTzo}):""}get id(){return this._def.publicId}get groupId(){return this._def.groupId}get allDay(){return this._def.allDay}get title(){return this._def.title}get url(){return this._def.url}get display(){return this._def.ui.display||"auto"}get startEditable(){return this._def.ui.startEditable}get durationEditable(){return this._def.ui.durationEditable}get constraint(){return this._def.ui.constraints[0]||null}get overlap(){return this._def.ui.overlap}get allow(){return this._def.ui.allows[0]||null}get backgroundColor(){return this._def.ui.backgroundColor}get borderColor(){return this._def.ui.borderColor}get textColor(){return this._def.ui.textColor}get classNames(){return this._def.ui.classNames}get extendedProps(){return this._def.extendedProps}toPlainObject(e={}){let t=this._def,{ui:s}=t,{startStr:i,endStr:l}=this,c={allDay:t.allDay};return t.title&&(c.title=t.title),i&&(c.start=i),l&&(c.end=l),t.publicId&&(c.id=t.publicId),t.groupId&&(c.groupId=t.groupId),t.url&&(c.url=t.url),s.display&&s.display!=="auto"&&(c.display=s.display),e.collapseColor&&s.backgroundColor&&s.backgroundColor===s.borderColor?c.color=s.backgroundColor:(s.backgroundColor&&(c.backgroundColor=s.backgroundColor),s.borderColor&&(c.borderColor=s.borderColor)),s.textColor&&(c.textColor=s.textColor),s.classNames.length&&(c.classNames=s.classNames),Object.keys(t.extendedProps).length&&(e.collapseExtendedProps?Object.assign(c,t.extendedProps):c.extendedProps=t.extendedProps),c}toJSON(){return this.toPlainObject()}}function BA(n){let e=n._def,t=n._instance;return{defs:{[e.defId]:e},instances:t?{[t.instanceId]:t}:{}}}function Bi(n,e,t){let{defs:s,instances:i}=n,l=[],c=t?t.instanceId:"";for(let u in i){let h=i[u],m=s[h.defId];h.instanceId!==c&&l.push(new Tt(e,m,h))}return l}function Gv(n,e,t,s){let i={},l={},c={},u=[],h=[],m=iu(n.defs,e);for(let p in n.defs){let x=n.defs[p];m[x.defId].display==="inverse-background"&&(x.groupId?(i[x.groupId]=[],c[x.groupId]||(c[x.groupId]=x)):l[p]=[])}for(let p in n.instances){let x=n.instances[p],y=n.defs[x.defId],v=m[y.defId],w=x.range,A=!y.allDay&&s?CA(w,s):w,N=el(A,t);N&&(v.display==="inverse-background"?y.groupId?i[y.groupId].push(N):l[x.defId].push(N):v.display!=="none"&&(v.display==="background"?u:h).push({def:y,ui:v,instance:x,range:N,isStart:A.start&&A.start.valueOf()===N.start.valueOf(),isEnd:A.end&&A.end.valueOf()===N.end.valueOf()}))}for(let p in i){let x=i[p],y=Fv(x,t);for(let v of y){let w=c[p],A=m[w.defId];u.push({def:w,ui:A,instance:null,range:v,isStart:!1,isEnd:!1})}}for(let p in l){let x=l[p],y=Fv(x,t);for(let v of y)u.push({def:n.defs[p],ui:m[p],instance:null,range:v,isStart:!1,isEnd:!1})}return{bg:u,fg:h}}function Yv(n,e){n.fcSeg=e}function tl(n){return n.fcSeg||n.parentNode.fcSeg||null}function iu(n,e){return Wi(n,t=>HA(t,e))}function HA(n,e){let t=[];return e[""]&&t.push(e[""]),e[n.defId]&&t.push(e[n.defId]),t.push(n.ui),tM(t)}function bM(n,e){let t=n.map(vM);return t.sort((s,i)=>PR(s,i,e)),t.map(s=>s._seg)}function vM(n){let{eventRange:e}=n,t=e.def,s=e.instance?e.instance.range:e.range,i=s.start?s.start.valueOf():0,l=s.end?s.end.valueOf():0;return Object.assign(Object.assign(Object.assign({},t.extendedProps),t),{id:t.publicId,start:i,end:l,duration:l-i,allDay:Number(t.allDay),_seg:n})}function wM(n,e){let{pluginHooks:t}=e,s=t.isDraggableTransformers,{def:i,ui:l}=n.eventRange,c=l.startEditable;for(let u of s)c=u(c,i,l,e);return c}function AM(n,e){return n.isStart&&n.eventRange.ui.durationEditable&&e.options.eventResizableFromStart}function NM(n,e){return n.isEnd&&n.eventRange.ui.durationEditable}function zA(n,e,t,s,i,l,c){let{dateEnv:u,options:h}=t,{displayEventTime:m,displayEventEnd:p}=h,x=n.eventRange.def,y=n.eventRange.instance;m==null&&(m=s!==!1),p==null&&(p=i!==!1);let v=y.range.start,w=y.range.end,A=n.start||n.eventRange.range.start,N=n.end||n.eventRange.range.end,S=Ct(v).valueOf()===Ct(A).valueOf(),E=Ct(ti(w,-1)).valueOf()===Ct(ti(N,-1)).valueOf();return m&&!x.allDay&&(S||E)?(A=S?v:A,N=E?w:N,p&&x.hasEnd?u.formatRange(A,N,e,{forcedStartTzo:y.forcedStartTzo,forcedEndTzo:y.forcedEndTzo}):u.format(A,e,{forcedTzo:y.forcedStartTzo})):""}function So(n,e,t){let s=n.eventRange.range;return{isPast:s.end<=e.start,isFuture:s.start>=e.end,isToday:e&&Za(e,s.start)}}function SM(n){let e=["fc-event"];return n.isMirror&&e.push("fc-event-mirror"),n.isDraggable&&e.push("fc-event-draggable"),(n.isStartResizable||n.isEndResizable)&&e.push("fc-event-resizable"),n.isDragging&&e.push("fc-event-dragging"),n.isResizing&&e.push("fc-event-resizing"),n.isSelected&&e.push("fc-event-selected"),n.isStart&&e.push("fc-event-start"),n.isEnd&&e.push("fc-event-end"),n.isPast&&e.push("fc-event-past"),n.isToday&&e.push("fc-event-today"),n.isFuture&&e.push("fc-event-future"),e}function jM(n){return n.instance?n.instance.instanceId:`${n.def.defId}:${n.range.start.toISOString()}`}function FA(n,e){let{def:t,instance:s}=n.eventRange,{url:i}=t;if(i)return{href:i};let{emitter:l,options:c}=e,{eventInteractive:u}=c;return u==null&&(u=t.interactive,u==null&&(u=!!l.hasHandlers("eventClick"))),u?bA(h=>{l.trigger("eventClick",{el:h.target,event:new Tt(e,t,s),jsEvent:h,view:e.viewApi})}):{}}const EM={start:ae,end:ae,allDay:Boolean};function _M(n,e,t){let s=CM(n,e),{range:i}=s;if(!i.start)return null;if(!i.end){if(t==null)return null;i.end=e.add(i.start,t)}return s}function CM(n,e){let{refined:t,extra:s}=ag(n,EM),i=t.start?e.createMarkerMeta(t.start):null,l=t.end?e.createMarkerMeta(t.end):null,{allDay:c}=t;return c==null&&(c=i&&i.isTimeUnspecified&&(!l||l.isTimeUnspecified)),Object.assign({range:{start:i?i.marker:null,end:l?l.marker:null},allDay:c},s)}function TM(n,e){return Vk(n.range,e.range)&&n.allDay===e.allDay&&DM(n,e)}function DM(n,e){for(let t in e)if(t!=="range"&&t!=="allDay"&&n[t]!==e[t])return!1;for(let t in n)if(!(t in e))return!1;return!0}function RM(n,e){return Object.assign(Object.assign({},qA(n.range,e,n.allDay)),{allDay:n.allDay})}function UA(n,e,t){return Object.assign(Object.assign({},qA(n,e,t)),{timeZone:e.timeZone})}function qA(n,e,t){return{start:e.toDate(n.start),end:e.toDate(n.end),startStr:e.formatIso(n.start,{omitTime:t}),endStr:e.formatIso(n.end,{omitTime:t})}}function kM(n,e,t){let s=kA({editable:!1},t),i=dp(s.refined,s.extra,"",n.allDay,!0,t);return{def:i,ui:HA(i,e),instance:cg(i.defId,n.range),range:n.range,isStart:!0,isEnd:!0}}function MM(n,e,t){let s=!1,i=function(u){s||(s=!0,e(u))},l=function(u){s||(s=!0,t(u))},c=n(i,l);c&&typeof c.then=="function"&&c.then(i,l)}class Wv extends Error{constructor(e,t){super(e),this.response=t}}function LM(n,e,t){n=n.toUpperCase();const s={method:n};return n==="GET"?e+=(e.indexOf("?")===-1?"?":"&")+new URLSearchParams(t):(s.body=new URLSearchParams(t),s.headers={"Content-Type":"application/x-www-form-urlencoded"}),fetch(e,s).then(i=>{if(i.ok)return i.json().then(l=>[l,i],()=>{throw new Wv("Failure parsing JSON",i)});throw new Wv("Request failed",i)})}let Tm;function VA(){return Tm==null&&(Tm=OM()),Tm}function OM(){if(typeof document>"u")return!0;let n=document.createElement("div");n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.innerHTML="<table><tr><td><div></div></td></tr></table>",n.querySelector("table").style.height="100px",n.querySelector("div").style.height="100%",document.body.appendChild(n);let t=n.querySelector("div").offsetHeight>0;return document.body.removeChild(n),t}class PM extends Lt{constructor(){super(...arguments),this.state={forPrint:!1},this.handleBeforePrint=()=>{su(()=>{this.setState({forPrint:!0})})},this.handleAfterPrint=()=>{su(()=>{this.setState({forPrint:!1})})}}render(){let{props:e}=this,{options:t}=e,{forPrint:s}=this.state,i=s||t.height==="auto"||t.contentHeight==="auto",l=!i&&t.height!=null?t.height:"",c=["fc",s?"fc-media-print":"fc-media-screen",`fc-direction-${t.direction}`,e.theme.getClass("root")];return VA()||c.push("fc-liquid-hack"),e.children(c,l,i,s)}componentDidMount(){let{emitter:e}=this.props;e.on("_beforeprint",this.handleBeforePrint),e.on("_afterprint",this.handleAfterPrint)}componentWillUnmount(){let{emitter:e}=this.props;e.off("_beforeprint",this.handleBeforePrint),e.off("_afterprint",this.handleAfterPrint)}}class cl{constructor(e){this.component=e.component,this.isHitComboAllowed=e.isHitComboAllowed||null}destroy(){}}function IM(n,e){return{component:n,el:e.el,useEventCenter:e.useEventCenter!=null?e.useEventCenter:!0,isHitComboAllowed:e.isHitComboAllowed||null}}function pg(n){return{[n.component.uid]:n}}const hp={};class Ru extends Js{constructor(e,t){super(e,t),this.handleRefresh=()=>{let s=this.computeTiming();s.state.nowDate.valueOf()!==this.state.nowDate.valueOf()&&this.setState(s.state),this.clearTimeout(),this.setTimeout(s.waitMs)},this.handleVisibilityChange=()=>{document.hidden||this.handleRefresh()},this.state=this.computeTiming().state}render(){let{props:e,state:t}=this;return e.children(t.nowDate,t.todayRange)}componentDidMount(){this.setTimeout(),this.context.nowManager.addResetListener(this.handleRefresh),document.addEventListener("visibilitychange",this.handleVisibilityChange)}componentDidUpdate(e){e.unit!==this.props.unit&&(this.clearTimeout(),this.setTimeout())}componentWillUnmount(){this.clearTimeout(),this.context.nowManager.removeResetListener(this.handleRefresh),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}computeTiming(){let{props:e,context:t}=this,s=t.nowManager.getDateMarker(),{nowIndicatorSnap:i}=t.options;i==="auto"&&(i=/year|month|week|day/.test(e.unit)||(e.unitValue||1)===1);let l,c;return i?(l=t.dateEnv.startOf(s,e.unit),c=t.dateEnv.add(l,ct(1,e.unit)).valueOf()-s.valueOf()):(l=s,c=1e3*60),c=Math.min(1e3*60*60*24,c),{state:{nowDate:l,todayRange:BM(l)},waitMs:c}}setTimeout(e=this.computeTiming().waitMs){this.timeoutId=setTimeout(()=>{const t=this.computeTiming();this.setState(t.state,()=>{this.setTimeout(t.waitMs)})},e)}clearTimeout(){this.timeoutId&&clearTimeout(this.timeoutId)}}Ru.contextType=Xi;function BM(n){let e=Ct(n),t=rs(e,1);return{start:e,end:t}}class HM{getCurrentData(){return this.currentDataManager.getCurrentData()}dispatch(e){this.currentDataManager.dispatch(e)}get view(){return this.getCurrentData().viewApi}batchRendering(e){e()}updateSize(){this.trigger("_resize",!0)}setOption(e,t){this.dispatch({type:"SET_OPTION",optionName:e,rawOptionValue:t})}getOption(e){return this.currentDataManager.currentCalendarOptionsInput[e]}getAvailableLocaleCodes(){return Object.keys(this.getCurrentData().availableRawLocales)}on(e,t){let{currentDataManager:s}=this;s.currentCalendarOptionsRefiners[e]?s.emitter.on(e,t):console.warn(`Unknown listener name '${e}'`)}off(e,t){this.currentDataManager.emitter.off(e,t)}trigger(e,...t){this.currentDataManager.emitter.trigger(e,...t)}changeView(e,t){this.batchRendering(()=>{if(this.unselect(),t)if(t.start&&t.end)this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e}),this.dispatch({type:"SET_OPTION",optionName:"visibleRange",rawOptionValue:t});else{let{dateEnv:s}=this.getCurrentData();this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e,dateMarker:s.createMarker(t)})}else this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e})})}zoomTo(e,t){let s=this.getCurrentData(),i;t=t||"day",i=s.viewSpecs[t]||this.getUnitViewSpec(t),this.unselect(),i?this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:i.type,dateMarker:e}):this.dispatch({type:"CHANGE_DATE",dateMarker:e})}getUnitViewSpec(e){let{viewSpecs:t,toolbarConfig:s}=this.getCurrentData(),i=[].concat(s.header?s.header.viewsWithButtons:[],s.footer?s.footer.viewsWithButtons:[]),l,c;for(let u in t)i.push(u);for(l=0;l<i.length;l+=1)if(c=t[i[l]],c&&c.singleUnit===e)return c;return null}prev(){this.unselect(),this.dispatch({type:"PREV"})}next(){this.unselect(),this.dispatch({type:"NEXT"})}prevYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,-1)})}nextYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,1)})}today(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.nowManager.getDateMarker()})}gotoDate(e){let t=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.createMarker(e)})}incrementDate(e){let t=this.getCurrentData(),s=ct(e);s&&(this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.add(t.currentDate,s)}))}getDate(){let e=this.getCurrentData();return e.dateEnv.toDate(e.currentDate)}formatDate(e,t){let{dateEnv:s}=this.getCurrentData();return s.format(s.createMarker(e),is(t))}formatRange(e,t,s){let{dateEnv:i}=this.getCurrentData();return i.formatRange(i.createMarker(e),i.createMarker(t),is(s),s)}formatIso(e,t){let{dateEnv:s}=this.getCurrentData();return s.formatIso(s.createMarker(e),{omitTime:t})}select(e,t){let s;t==null?e.start!=null?s=e:s={start:e,end:null}:s={start:e,end:t};let i=this.getCurrentData(),l=_M(s,i.dateEnv,ct({days:1}));l&&(this.dispatch({type:"SELECT_DATES",selection:l}),IA(l,null,i))}unselect(e){let t=this.getCurrentData();t.dateSelection&&(this.dispatch({type:"UNSELECT_DATES"}),gM(e,t))}addEvent(e,t){if(e instanceof Tt){let c=e._def,u=e._instance;return this.getCurrentData().eventStore.defs[c.defId]||(this.dispatch({type:"ADD_EVENTS",eventStore:up({def:c,instance:u})}),this.triggerEventAdd(e)),e}let s=this.getCurrentData(),i;if(t instanceof Fr)i=t.internalEventSource;else if(typeof t=="boolean")t&&([i]=rg(s.eventSources));else if(t!=null){let c=this.getEventSourceById(t);if(!c)return console.warn(`Could not find an event source with ID "${t}"`),null;i=c.internalEventSource}let l=RA(e,i,s,!1);if(l){let c=new Tt(s,l.def,l.def.recurringDef?null:l.instance);return this.dispatch({type:"ADD_EVENTS",eventStore:up(l)}),this.triggerEventAdd(c),c}return null}triggerEventAdd(e){let{emitter:t}=this.getCurrentData();t.trigger("eventAdd",{event:e,relatedEvents:[],revert:()=>{this.dispatch({type:"REMOVE_EVENTS",eventStore:BA(e)})}})}getEventById(e){let t=this.getCurrentData(),{defs:s,instances:i}=t.eventStore;e=String(e);for(let l in s){let c=s[l];if(c.publicId===e){if(c.recurringDef)return new Tt(t,c,null);for(let u in i){let h=i[u];if(h.defId===c.defId)return new Tt(t,c,h)}}}return null}getEvents(){let e=this.getCurrentData();return Bi(e.eventStore,e)}removeAllEvents(){this.dispatch({type:"REMOVE_ALL_EVENTS"})}getEventSources(){let e=this.getCurrentData(),t=e.eventSources,s=[];for(let i in t)s.push(new Fr(e,t[i]));return s}getEventSourceById(e){let t=this.getCurrentData(),s=t.eventSources;e=String(e);for(let i in s)if(s[i].publicId===e)return new Fr(t,s[i]);return null}addEventSource(e){let t=this.getCurrentData();if(e instanceof Fr)return t.eventSources[e.internalEventSource.sourceId]||this.dispatch({type:"ADD_EVENT_SOURCES",sources:[e.internalEventSource]}),e;let s=MA(e,t);return s?(this.dispatch({type:"ADD_EVENT_SOURCES",sources:[s]}),new Fr(t,s)):null}removeAllEventSources(){this.dispatch({type:"REMOVE_ALL_EVENT_SOURCES"})}refetchEvents(){this.dispatch({type:"FETCH_EVENT_SOURCES",isRefetch:!0})}scrollToTime(e){let t=ct(e);t&&this.trigger("_scrollRequest",{time:t})}}function zM(n,e){return n.left>=e.left&&n.left<e.right&&n.top>=e.top&&n.top<e.bottom}function $A(n,e){let t={left:Math.max(n.left,e.left),right:Math.min(n.right,e.right),top:Math.max(n.top,e.top),bottom:Math.min(n.bottom,e.bottom)};return t.left<t.right&&t.top<t.bottom?t:!1}function FM(n,e){return{left:Math.min(Math.max(n.left,e.left),e.right),top:Math.min(Math.max(n.top,e.top),e.bottom)}}function UM(n){return{left:(n.left+n.right)/2,top:(n.top+n.bottom)/2}}function qM(n,e){return{left:n.left-e.left,top:n.top-e.top}}function GA(n,e,t,s){return{dow:n.getUTCDay(),isDisabled:!!(s&&(!s.activeRange||!Za(s.activeRange,n))),isOther:!!(s&&!Za(s.currentRange,n)),isToday:!!(e&&Za(e,n)),isPast:!!(e&&n<e.start),isFuture:!!(e&&n>=e.end)}}function gg(n,e){let t=["fc-day",`fc-day-${YR[n.dow]}`];return n.isDisabled?t.push("fc-day-disabled"):(n.isToday&&(t.push("fc-day-today"),t.push(e.getClass("today"))),n.isPast&&t.push("fc-day-past"),n.isFuture&&t.push("fc-day-future"),n.isOther&&t.push("fc-day-other")),t}const VM=is({year:"numeric",month:"long",day:"numeric"}),$M=is({week:"long"});function fp(n,e,t="day",s=!0){const{dateEnv:i,options:l,calendarApi:c}=n;let u=i.format(e,t==="week"?$M:VM);if(l.navLinks){let h=i.toDate(e);const m=p=>{let x=t==="day"?l.navLinkDayClick:t==="week"?l.navLinkWeekClick:null;typeof x=="function"?x.call(c,i.toDate(e),p):(typeof x=="string"&&(t=x),c.zoomTo(e,t))};return Object.assign({title:Ao(l.navLinkHint,[u,h],u),"data-navlink":""},s?yA(m):{onClick:m})}return{"aria-label":u}}let Dm=null;function GM(){return Dm===null&&(Dm=YM()),Dm}function YM(){let n=document.createElement("div");wo(n,{position:"absolute",top:-1e3,left:0,border:0,padding:0,overflow:"scroll",direction:"rtl"}),n.innerHTML="<div></div>",document.body.appendChild(n);let t=n.firstChild.getBoundingClientRect().left>n.getBoundingClientRect().left;return Jp(n),t}let Rm;function WM(){return Rm||(Rm=XM()),Rm}function XM(){let n=document.createElement("div");n.style.overflow="scroll",n.style.position="absolute",n.style.top="-9999px",n.style.left="-9999px",document.body.appendChild(n);let e=YA(n);return document.body.removeChild(n),e}function YA(n){return{x:n.offsetHeight-n.clientHeight,y:n.offsetWidth-n.clientWidth}}function QM(n,e=!1){let t=window.getComputedStyle(n),s=parseInt(t.borderLeftWidth,10)||0,i=parseInt(t.borderRightWidth,10)||0,l=parseInt(t.borderTopWidth,10)||0,c=parseInt(t.borderBottomWidth,10)||0,u=YA(n),h=u.y-s-i,m=u.x-l-c,p={borderLeft:s,borderRight:i,borderTop:l,borderBottom:c,scrollbarBottom:m,scrollbarLeft:0,scrollbarRight:0};return GM()&&t.direction==="rtl"?p.scrollbarLeft=h:p.scrollbarRight=h,e&&(p.paddingLeft=parseInt(t.paddingLeft,10)||0,p.paddingRight=parseInt(t.paddingRight,10)||0,p.paddingTop=parseInt(t.paddingTop,10)||0,p.paddingBottom=parseInt(t.paddingBottom,10)||0),p}function ZM(n,e=!1,t){let s=xg(n),i=QM(n,e),l={left:s.left+i.borderLeft+i.scrollbarLeft,right:s.right-i.borderRight-i.scrollbarRight,top:s.top+i.borderTop,bottom:s.bottom-i.borderBottom-i.scrollbarBottom};return e&&(l.left+=i.paddingLeft,l.right-=i.paddingRight,l.top+=i.paddingTop,l.bottom-=i.paddingBottom),l}function xg(n){let e=n.getBoundingClientRect();return{left:e.left+window.scrollX,top:e.top+window.scrollY,right:e.right+window.scrollX,bottom:e.bottom+window.scrollY}}function KM(n){let e=WA(n),t=n.getBoundingClientRect();for(let s of e){let i=$A(t,s.getBoundingClientRect());if(i)t=i;else return null}return t}function WA(n){let e=[];for(;n instanceof HTMLElement;){let t=window.getComputedStyle(n);if(t.position==="fixed")break;/(auto|scroll)/.test(t.overflow+t.overflowY+t.overflowX)&&e.push(n),n=n.parentNode}return e}class ru{constructor(e,t,s,i){this.els=t;let l=this.originClientRect=e.getBoundingClientRect();s&&this.buildElHorizontals(l.left),i&&this.buildElVerticals(l.top)}buildElHorizontals(e){let t=[],s=[];for(let i of this.els){let l=i.getBoundingClientRect();t.push(l.left-e),s.push(l.right-e)}this.lefts=t,this.rights=s}buildElVerticals(e){let t=[],s=[];for(let i of this.els){let l=i.getBoundingClientRect();t.push(l.top-e),s.push(l.bottom-e)}this.tops=t,this.bottoms=s}leftToIndex(e){let{lefts:t,rights:s}=this,i=t.length,l;for(l=0;l<i;l+=1)if(e>=t[l]&&e<s[l])return l}topToIndex(e){let{tops:t,bottoms:s}=this,i=t.length,l;for(l=0;l<i;l+=1)if(e>=t[l]&&e<s[l])return l}getWidth(e){return this.rights[e]-this.lefts[e]}getHeight(e){return this.bottoms[e]-this.tops[e]}similarTo(e){return wd(this.tops||[],e.tops||[])&&wd(this.bottoms||[],e.bottoms||[])&&wd(this.lefts||[],e.lefts||[])&&wd(this.rights||[],e.rights||[])}}function wd(n,e){const t=n.length;if(t!==e.length)return!1;for(let s=0;s<t;s++)if(Math.round(n[s])!==Math.round(e[s]))return!1;return!0}class yg{getMaxScrollTop(){return this.getScrollHeight()-this.getClientHeight()}getMaxScrollLeft(){return this.getScrollWidth()-this.getClientWidth()}canScrollVertically(){return this.getMaxScrollTop()>0}canScrollHorizontally(){return this.getMaxScrollLeft()>0}canScrollUp(){return this.getScrollTop()>0}canScrollDown(){return this.getScrollTop()<this.getMaxScrollTop()}canScrollLeft(){return this.getScrollLeft()>0}canScrollRight(){return this.getScrollLeft()<this.getMaxScrollLeft()}}class JM extends yg{constructor(e){super(),this.el=e}getScrollTop(){return this.el.scrollTop}getScrollLeft(){return this.el.scrollLeft}setScrollTop(e){this.el.scrollTop=e}setScrollLeft(e){this.el.scrollLeft=e}getScrollWidth(){return this.el.scrollWidth}getScrollHeight(){return this.el.scrollHeight}getClientHeight(){return this.el.clientHeight}getClientWidth(){return this.el.clientWidth}}class e4 extends yg{getScrollTop(){return window.scrollY}getScrollLeft(){return window.scrollX}setScrollTop(e){window.scroll(window.scrollX,e)}setScrollLeft(e){window.scroll(e,window.scrollY)}getScrollWidth(){return document.documentElement.scrollWidth}getScrollHeight(){return document.documentElement.scrollHeight}getClientHeight(){return document.documentElement.clientHeight}getClientWidth(){return document.documentElement.clientWidth}}class Zi extends Lt{constructor(){super(...arguments),this.uid=Yi()}prepareHits(){}queryHit(e,t,s,i){return null}isValidSegDownEl(e){return!this.props.eventDrag&&!this.props.eventResize&&!bs(e,".fc-event-mirror")}isValidDateDownEl(e){return!bs(e,".fc-event:not(.fc-bg-event)")&&!bs(e,".fc-more-link")&&!bs(e,"a[data-navlink]")&&!bs(e,".fc-popover")}}class t4{constructor(e=t=>t.thickness||1){this.getEntryThickness=e,this.strictOrder=!1,this.allowReslicing=!1,this.maxCoord=-1,this.maxStackCnt=-1,this.levelCoords=[],this.entriesByLevel=[],this.stackCnts={}}addSegs(e){let t=[];for(let s of e)this.insertEntry(s,t);return t}insertEntry(e,t){let s=this.findInsertion(e);this.isInsertionValid(s,e)?this.insertEntryAt(e,s):this.handleInvalidInsertion(s,e,t)}isInsertionValid(e,t){return(this.maxCoord===-1||e.levelCoord+this.getEntryThickness(t)<=this.maxCoord)&&(this.maxStackCnt===-1||e.stackCnt<this.maxStackCnt)}handleInvalidInsertion(e,t,s){if(this.allowReslicing&&e.touchingEntry){const i=Object.assign(Object.assign({},t),{span:XA(t.span,e.touchingEntry.span)});s.push(i),this.splitEntry(t,e.touchingEntry,s)}else s.push(t)}splitEntry(e,t,s){let i=e.span,l=t.span;i.start<l.start&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:i.start,end:l.start}},s),i.end>l.end&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:l.end,end:i.end}},s)}insertEntryAt(e,t){let{entriesByLevel:s,levelCoords:i}=this;t.lateral===-1?(km(i,t.level,t.levelCoord),km(s,t.level,[e])):km(s[t.level],t.lateral,e),this.stackCnts[jo(e)]=t.stackCnt}findInsertion(e){let{levelCoords:t,entriesByLevel:s,strictOrder:i,stackCnts:l}=this,c=t.length,u=0,h=-1,m=-1,p=null,x=0;for(let w=0;w<c;w+=1){const A=t[w];if(!i&&A>=u+this.getEntryThickness(e))break;let N=s[w],S,E=Qv(N,e.span.start,Xv),C=E[0]+E[1];for(;(S=N[C])&&S.span.start<e.span.end;){let R=A+this.getEntryThickness(S);R>u&&(u=R,p=S,h=w,m=C),R===u&&(x=Math.max(x,l[jo(S)]+1)),C+=1}}let y=0;if(p)for(y=h+1;y<c&&t[y]<u;)y+=1;let v=-1;return y<c&&t[y]===u&&(v=Qv(s[y],e.span.end,Xv)[0]),{touchingLevel:h,touchingLateral:m,touchingEntry:p,stackCnt:x,levelCoord:u,level:y,lateral:v}}toRects(){let{entriesByLevel:e,levelCoords:t}=this,s=e.length,i=[];for(let l=0;l<s;l+=1){let c=e[l],u=t[l];for(let h of c)i.push(Object.assign(Object.assign({},h),{thickness:this.getEntryThickness(h),levelCoord:u}))}return i}}function Xv(n){return n.span.end}function jo(n){return n.index+":"+n.span.start}function XA(n,e){let t=Math.max(n.start,e.start),s=Math.min(n.end,e.end);return t<s?{start:t,end:s}:null}function km(n,e,t){n.splice(e,0,t)}function Qv(n,e,t){let s=0,i=n.length;if(!i||e<t(n[s]))return[0,0];if(e>t(n[i-1]))return[i,0];for(;s<i;){let l=Math.floor(s+(i-s)/2),c=t(n[l]);if(e<c)i=l;else if(e>c)s=l+1;else return[l,1]}return[s,0]}class s4{constructor(e,t){this.emitter=new Du}destroy(){}setMirrorIsVisible(e){}setMirrorNeedsRevert(e){}setAutoScrollEnabled(e){}}const bg={};function n4(n,e){return!n||e>10?is({weekday:"short"}):e>1?is({weekday:"short",month:"numeric",day:"numeric",omitCommas:!0}):is({weekday:"long"})}const QA="fc-col-header-cell";function ZA(n){return n.text}class a4 extends Lt{render(){let{dateEnv:e,options:t,theme:s,viewApi:i}=this.context,{props:l}=this,{date:c,dateProfile:u}=l,h=GA(c,l.todayRange,null,u),m=[QA].concat(gg(h,s)),p=e.format(c,l.dayHeaderFormat),x=!h.isDisabled&&l.colCnt>1?fp(this.context,c):{},y=e.toDate(c);e.namedTimeZoneImpl&&(y=ti(y,36e5));let v=Object.assign(Object.assign(Object.assign({date:y,view:i},l.extraRenderProps),{text:p}),h);return ie(va,{elTag:"th",elClasses:m,elAttrs:Object.assign({role:"columnheader",colSpan:l.colSpan,"data-date":h.isDisabled?void 0:sg(c)},l.extraDataAttrs),renderProps:v,generatorName:"dayHeaderContent",customGenerator:t.dayHeaderContent,defaultGenerator:ZA,classNameGenerator:t.dayHeaderClassNames,didMount:t.dayHeaderDidMount,willUnmount:t.dayHeaderWillUnmount},w=>ie("div",{className:"fc-scrollgrid-sync-inner"},!h.isDisabled&&ie(w,{elTag:"a",elAttrs:x,elClasses:["fc-col-header-cell-cushion",l.isSticky&&"fc-sticky"]})))}}const i4=is({weekday:"long"});class r4 extends Lt{render(){let{props:e}=this,{dateEnv:t,theme:s,viewApi:i,options:l}=this.context,c=rs(new Date(2592e5),e.dow),u={dow:e.dow,isDisabled:!1,isFuture:!1,isPast:!1,isToday:!1,isOther:!1},h=t.format(c,e.dayHeaderFormat),m=Object.assign(Object.assign(Object.assign(Object.assign({date:c},u),{view:i}),e.extraRenderProps),{text:h});return ie(va,{elTag:"th",elClasses:[QA,...gg(u,s),...e.extraClassNames||[]],elAttrs:Object.assign({role:"columnheader",colSpan:e.colSpan},e.extraDataAttrs),renderProps:m,generatorName:"dayHeaderContent",customGenerator:l.dayHeaderContent,defaultGenerator:ZA,classNameGenerator:l.dayHeaderClassNames,didMount:l.dayHeaderDidMount,willUnmount:l.dayHeaderWillUnmount},p=>ie("div",{className:"fc-scrollgrid-sync-inner"},ie(p,{elTag:"a",elClasses:["fc-col-header-cell-cushion",e.isSticky&&"fc-sticky"],elAttrs:{"aria-label":t.format(c,i4)}})))}}class l4 extends Lt{constructor(){super(...arguments),this.createDayHeaderFormatter=lt(o4)}render(){let{context:e}=this,{dates:t,dateProfile:s,datesRepDistinctDays:i,renderIntro:l}=this.props,c=this.createDayHeaderFormatter(e.options.dayHeaderFormat,i,t.length);return ie(Ru,{unit:"day"},(u,h)=>ie("tr",{role:"row"},l&&l("day"),t.map(m=>i?ie(a4,{key:m.toISOString(),date:m,dateProfile:s,todayRange:h,colCnt:t.length,dayHeaderFormat:c}):ie(r4,{key:m.getUTCDay(),dow:m.getUTCDay(),dayHeaderFormat:c}))))}}function o4(n,e,t){return n||n4(e,t)}class c4{constructor(e,t){let s=e.start,{end:i}=e,l=[],c=[],u=-1;for(;s<i;)t.isHiddenDay(s)?l.push(u+.5):(u+=1,l.push(u),c.push(s)),s=rs(s,1);this.dates=c,this.indices=l,this.cnt=c.length}sliceRange(e){let t=this.getDateDayIndex(e.start),s=this.getDateDayIndex(rs(e.end,-1)),i=Math.max(0,t),l=Math.min(this.cnt-1,s);return i=Math.ceil(i),l=Math.floor(l),i<=l?{firstIndex:i,lastIndex:l,isStart:t===i,isEnd:s===l}:null}getDateDayIndex(e){let{indices:t}=this,s=Math.floor(ol(this.dates[0],e));return s<0?t[0]-1:s>=t.length?t[t.length-1]+1:t[s]}}class d4{constructor(e,t){let{dates:s}=e,i,l,c;if(t){for(l=s[0].getUTCDay(),i=1;i<s.length&&s[i].getUTCDay()!==l;i+=1);c=Math.ceil(s.length/i)}else c=1,i=s.length;this.rowCnt=c,this.colCnt=i,this.daySeries=e,this.cells=this.buildCells(),this.headerDates=this.buildHeaderDates()}buildCells(){let e=[];for(let t=0;t<this.rowCnt;t+=1){let s=[];for(let i=0;i<this.colCnt;i+=1)s.push(this.buildCell(t,i));e.push(s)}return e}buildCell(e,t){let s=this.daySeries.dates[e*this.colCnt+t];return{key:s.toISOString(),date:s}}buildHeaderDates(){let e=[];for(let t=0;t<this.colCnt;t+=1)e.push(this.cells[0][t].date);return e}sliceRange(e){let{colCnt:t}=this,s=this.daySeries.sliceRange(e),i=[];if(s){let{firstIndex:l,lastIndex:c}=s,u=l;for(;u<=c;){let h=Math.floor(u/t),m=Math.min((h+1)*t,c+1);i.push({row:h,firstCol:u%t,lastCol:(m-1)%t,isStart:s.isStart&&u===l,isEnd:s.isEnd&&m-1===c}),u=m}}return i}}class u4{constructor(){this.sliceBusinessHours=lt(this._sliceBusinessHours),this.sliceDateSelection=lt(this._sliceDateSpan),this.sliceEventStore=lt(this._sliceEventStore),this.sliceEventDrag=lt(this._sliceInteraction),this.sliceEventResize=lt(this._sliceInteraction),this.forceDayIfListItem=!1}sliceProps(e,t,s,i,...l){let{eventUiBases:c}=e,u=this.sliceEventStore(e.eventStore,c,t,s,...l);return{dateSelectionSegs:this.sliceDateSelection(e.dateSelection,t,s,c,i,...l),businessHourSegs:this.sliceBusinessHours(e.businessHours,t,s,i,...l),fgEventSegs:u.fg,bgEventSegs:u.bg,eventDrag:this.sliceEventDrag(e.eventDrag,c,t,s,...l),eventResize:this.sliceEventResize(e.eventResize,c,t,s,...l),eventSelection:e.eventSelection}}sliceNowDate(e,t,s,i,...l){return this._sliceDateSpan({range:{start:e,end:ti(e,1)},allDay:!1},t,s,{},i,...l)}_sliceBusinessHours(e,t,s,i,...l){return e?this._sliceEventStore(Vi(e,Ad(t,!!s),i),{},t,s,...l).bg:[]}_sliceEventStore(e,t,s,i,...l){if(e){let c=Gv(e,t,Ad(s,!!i),i);return{bg:this.sliceEventRanges(c.bg,l),fg:this.sliceEventRanges(c.fg,l)}}return{bg:[],fg:[]}}_sliceInteraction(e,t,s,i,...l){if(!e)return null;let c=Gv(e.mutatedEvents,t,Ad(s,!!i),i);return{segs:this.sliceEventRanges(c.fg,l),affectedInstances:e.affectedEvents.instances,isEvent:e.isEvent}}_sliceDateSpan(e,t,s,i,l,...c){if(!e)return[];let u=Ad(t,!!s),h=el(e.range,u);if(h){e=Object.assign(Object.assign({},e),{range:h});let m=kM(e,i,l),p=this.sliceRange(e.range,...c);for(let x of p)x.eventRange=m;return p}return[]}sliceEventRanges(e,t){let s=[];for(let i of e)s.push(...this.sliceEventRange(i,t));return s}sliceEventRange(e,t){let s=e.range;this.forceDayIfListItem&&e.ui.display==="list-item"&&(s={start:s.start,end:rs(s.start,1)});let i=this.sliceRange(s,...t);for(let l of i)l.eventRange=e,l.isStart=e.isStart&&l.isStart,l.isEnd=e.isEnd&&l.isEnd;return i}}function Ad(n,e){let t=n.activeRange;return e?t:{start:ti(t.start,n.slotMinTime.milliseconds),end:ti(t.end,n.slotMaxTime.milliseconds-864e5)}}function KA(n,e,t){let{instances:s}=n.mutatedEvents;for(let i in s)if(!Cu(e.validRange,s[i].range))return!1;return JA({eventDrag:n},t)}function h4(n,e,t){return Cu(e.validRange,n.range)?JA({dateSelection:n},t):!1}function JA(n,e){let t=e.getCurrentData(),s=Object.assign({businessHours:t.businessHours,dateSelection:"",eventStore:t.eventStore,eventUiBases:t.eventUiBases,eventSelection:"",eventDrag:null,eventResize:null},n);return(e.pluginHooks.isPropsValid||f4)(s,e)}function f4(n,e,t={},s){return!(n.eventDrag&&!m4(n,e,t,s)||n.dateSelection&&!p4(n,e,t,s))}function m4(n,e,t,s){let i=e.getCurrentData(),l=n.eventDrag,c=l.mutatedEvents,u=c.defs,h=c.instances,m=iu(u,l.isEvent?n.eventUiBases:{"":i.selectionConfig});s&&(m=Wi(m,s));let p=cM(n.eventStore,l.affectedEvents.instances),x=p.defs,y=p.instances,v=iu(x,n.eventUiBases);for(let w in h){let A=h[w],N=A.range,S=m[A.defId],E=u[A.defId];if(!eN(S.constraints,N,p,n.businessHours,e))return!1;let{eventOverlap:C}=e.options,R=typeof C=="function"?C:null;for(let O in y){let H=y[O];if(og(N,H.range)&&(v[H.defId].overlap===!1&&l.isEvent||S.overlap===!1||R&&!R(new Tt(e,x[H.defId],H),new Tt(e,E,A))))return!1}let D=i.eventStore;for(let O of S.allows){let H=Object.assign(Object.assign({},t),{range:A.range,allDay:E.allDay}),F=D.defs[E.defId],P=D.instances[w],Z;if(F?Z=new Tt(e,F,P):Z=new Tt(e,E),!O(fg(H,e),Z))return!1}}return!0}function p4(n,e,t,s){let i=n.eventStore,l=i.defs,c=i.instances,u=n.dateSelection,h=u.range,{selectionConfig:m}=e.getCurrentData();if(s&&(m=s(m)),!eN(m.constraints,h,i,n.businessHours,e))return!1;let{selectOverlap:p}=e.options,x=typeof p=="function"?p:null;for(let y in c){let v=c[y];if(og(h,v.range)&&(m.overlap===!1||x&&!x(new Tt(e,l[v.defId],v),null)))return!1}for(let y of m.allows){let v=Object.assign(Object.assign({},t),u);if(!y(fg(v,e),null))return!1}return!0}function eN(n,e,t,s,i){for(let l of n)if(!x4(g4(l,e,t,s,i),e))return!1;return!0}function g4(n,e,t,s,i){return n==="businessHours"?Mm(Vi(s,e,i)):typeof n=="string"?Mm(Tu(t,l=>l.groupId===n)):typeof n=="object"&&n?Mm(Vi(n,e,i)):[]}function Mm(n){let{instances:e}=n,t=[];for(let s in e)t.push(e[s].range);return t}function x4(n,e){for(let t of n)if(Cu(t,e))return!0;return!1}const Nd=/^(visible|hidden)$/;class y4 extends Lt{constructor(){super(...arguments),this.handleEl=e=>{this.el=e,Xn(this.props.elRef,e)}}render(){let{props:e}=this,{liquid:t,liquidIsAbsolute:s}=e,i=t&&s,l=["fc-scroller"];return t&&(s?l.push("fc-scroller-liquid-absolute"):l.push("fc-scroller-liquid")),ie("div",{ref:this.handleEl,className:l.join(" "),style:{overflowX:e.overflowX,overflowY:e.overflowY,left:i&&-(e.overcomeLeft||0)||"",right:i&&-(e.overcomeRight||0)||"",bottom:i&&-(e.overcomeBottom||0)||"",marginLeft:!i&&-(e.overcomeLeft||0)||"",marginRight:!i&&-(e.overcomeRight||0)||"",marginBottom:!i&&-(e.overcomeBottom||0)||"",maxHeight:e.maxHeight||""}},e.children)}needsXScrolling(){if(Nd.test(this.props.overflowX))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().width-this.getYScrollbarWidth(),{children:s}=e;for(let i=0;i<s.length;i+=1)if(s[i].getBoundingClientRect().width>t)return!0;return!1}needsYScrolling(){if(Nd.test(this.props.overflowY))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().height-this.getXScrollbarWidth(),{children:s}=e;for(let i=0;i<s.length;i+=1)if(s[i].getBoundingClientRect().height>t)return!0;return!1}getXScrollbarWidth(){return Nd.test(this.props.overflowX)?0:this.el.offsetHeight-this.el.clientHeight}getYScrollbarWidth(){return Nd.test(this.props.overflowY)?0:this.el.offsetWidth-this.el.clientWidth}}class ki{constructor(e){this.masterCallback=e,this.currentMap={},this.depths={},this.callbackMap={},this.handleValue=(t,s)=>{let{depths:i,currentMap:l}=this,c=!1,u=!1;t!==null?(c=s in l,l[s]=t,i[s]=(i[s]||0)+1,u=!0):(i[s]-=1,i[s]||(delete l[s],delete this.callbackMap[s],c=!0)),this.masterCallback&&(c&&this.masterCallback(null,String(s)),u&&this.masterCallback(t,String(s)))}}createRef(e){let t=this.callbackMap[e];return t||(t=this.callbackMap[e]=s=>{this.handleValue(s,String(e))}),t}collect(e,t,s){return _k(this.currentMap,e,t,s)}getAll(){return rg(this.currentMap)}}function b4(n){let e=ER(n,".fc-scrollgrid-shrink"),t=0;for(let s of e)t=Math.max(t,zR(s));return Math.ceil(t)}function tN(n,e){return n.liquid&&e.liquid}function v4(n,e){return e.maxHeight!=null||tN(n,e)}function w4(n,e,t,s){let{expandRows:i}=t;return typeof e.content=="function"?e.content(t):ie("table",{role:"presentation",className:[e.tableClassName,n.syncRowHeights?"fc-scrollgrid-sync-table":""].join(" "),style:{minWidth:t.tableMinWidth,width:t.clientWidth,height:i?t.clientHeight:""}},t.tableColGroupNode,ie(s?"thead":"tbody",{role:"presentation"},typeof e.rowContent=="function"?e.rowContent(t):e.rowContent))}function A4(n,e){return ei(n,e,Cn)}function N4(n,e){let t=[];for(let s of n){let i=s.span||1;for(let l=0;l<i;l+=1)t.push(ie("col",{style:{width:s.width==="shrink"?S4(e):s.width||"",minWidth:s.minWidth||""}}))}return ie("colgroup",{},...t)}function S4(n){return n??4}function j4(n){for(let e of n)if(e.width==="shrink")return!0;return!1}function E4(n,e){let t=["fc-scrollgrid",e.theme.getClass("table")];return n&&t.push("fc-scrollgrid-liquid"),t}function _4(n,e){let t=["fc-scrollgrid-section",`fc-scrollgrid-section-${n.type}`,n.className];return e&&n.liquid&&n.maxHeight==null&&t.push("fc-scrollgrid-section-liquid"),n.isSticky&&t.push("fc-scrollgrid-section-sticky"),t}function C4(n){return ie("div",{className:"fc-scrollgrid-sticky-shim",style:{width:n.clientWidth,minWidth:n.tableMinWidth}})}function Zv(n){let{stickyHeaderDates:e}=n;return(e==null||e==="auto")&&(e=n.height==="auto"||n.viewHeight==="auto"),e}function T4(n){let{stickyFooterScrollbar:e}=n;return(e==null||e==="auto")&&(e=n.height==="auto"||n.viewHeight==="auto"),e}class sN extends Lt{constructor(){super(...arguments),this.processCols=lt(e=>e,A4),this.renderMicroColGroup=lt(N4),this.scrollerRefs=new ki,this.scrollerElRefs=new ki(this._handleScrollerEl.bind(this)),this.state={shrinkWidth:null,forceYScrollbars:!1,scrollerClientWidths:{},scrollerClientHeights:{}},this.handleSizing=()=>{this.safeSetState(Object.assign({shrinkWidth:this.computeShrinkWidth()},this.computeScrollerDims()))}}render(){let{props:e,state:t,context:s}=this,i=e.sections||[],l=this.processCols(e.cols),c=this.renderMicroColGroup(l,t.shrinkWidth),u=E4(e.liquid,s);e.collapsibleWidth&&u.push("fc-scrollgrid-collapsible");let h=i.length,m=0,p,x=[],y=[],v=[];for(;m<h&&(p=i[m]).type==="header";)x.push(this.renderSection(p,c,!0)),m+=1;for(;m<h&&(p=i[m]).type==="body";)y.push(this.renderSection(p,c,!1)),m+=1;for(;m<h&&(p=i[m]).type==="footer";)v.push(this.renderSection(p,c,!0)),m+=1;let w=!VA();const A={role:"rowgroup"};return ie("table",{role:"grid",className:u.join(" "),style:{height:e.height}},!!(!w&&x.length)&&ie("thead",A,...x),!!(!w&&y.length)&&ie("tbody",A,...y),!!(!w&&v.length)&&ie("tfoot",A,...v),w&&ie("tbody",A,...x,...y,...v))}renderSection(e,t,s){return"outerContent"in e?ie(It,{key:e.key},e.outerContent):ie("tr",{key:e.key,role:"presentation",className:_4(e,this.props.liquid).join(" ")},this.renderChunkTd(e,t,e.chunk,s))}renderChunkTd(e,t,s,i){if("outerContent"in s)return s.outerContent;let{props:l}=this,{forceYScrollbars:c,scrollerClientWidths:u,scrollerClientHeights:h}=this.state,m=v4(l,e),p=tN(l,e),x=l.liquid?c?"scroll":m?"auto":"hidden":"visible",y=e.key,v=w4(e,s,{tableColGroupNode:t,tableMinWidth:"",clientWidth:!l.collapsibleWidth&&u[y]!==void 0?u[y]:null,clientHeight:h[y]!==void 0?h[y]:null,expandRows:e.expandRows,syncRowHeights:!1,rowSyncHeights:[],reportRowHeightChange:()=>{}},i);return ie(i?"th":"td",{ref:s.elRef,role:"presentation"},ie("div",{className:`fc-scroller-harness${p?" fc-scroller-harness-liquid":""}`},ie(y4,{ref:this.scrollerRefs.createRef(y),elRef:this.scrollerElRefs.createRef(y),overflowY:x,overflowX:l.liquid?"hidden":"visible",maxHeight:e.maxHeight,liquid:p,liquidIsAbsolute:!0},v)))}_handleScrollerEl(e,t){let s=D4(this.props.sections,t);s&&Xn(s.chunk.scrollerElRef,e)}componentDidMount(){this.handleSizing(),this.context.addResizeHandler(this.handleSizing)}componentDidUpdate(){this.handleSizing()}componentWillUnmount(){this.context.removeResizeHandler(this.handleSizing)}computeShrinkWidth(){return j4(this.props.cols)?b4(this.scrollerElRefs.getAll()):0}computeScrollerDims(){let e=WM(),{scrollerRefs:t,scrollerElRefs:s}=this,i=!1,l={},c={};for(let u in t.currentMap){let h=t.currentMap[u];if(h&&h.needsYScrolling()){i=!0;break}}for(let u of this.props.sections){let h=u.key,m=s.currentMap[h];if(m){let p=m.parentNode;l[h]=Math.floor(p.getBoundingClientRect().width-(i?e.y:0)),c[h]=Math.floor(p.getBoundingClientRect().height)}}return{forceYScrollbars:i,scrollerClientWidths:l,scrollerClientHeights:c}}}sN.addStateEquality({scrollerClientWidths:Cn,scrollerClientHeights:Cn});function D4(n,e){for(let t of n)if(t.key===e)return t;return null}class vg extends Lt{constructor(){super(...arguments),this.buildPublicEvent=lt((e,t,s)=>new Tt(e,t,s)),this.handleEl=e=>{this.el=e,Xn(this.props.elRef,e),e&&Yv(e,this.props.seg)}}render(){const{props:e,context:t}=this,{options:s}=t,{seg:i}=e,{eventRange:l}=i,{ui:c}=l,u={event:this.buildPublicEvent(t,l.def,l.instance),view:t.viewApi,timeText:e.timeText,textColor:c.textColor,backgroundColor:c.backgroundColor,borderColor:c.borderColor,isDraggable:!e.disableDragging&&wM(i,t),isStartResizable:!e.disableResizing&&AM(i,t),isEndResizable:!e.disableResizing&&NM(i),isMirror:!!(e.isDragging||e.isResizing||e.isDateSelecting),isStart:!!i.isStart,isEnd:!!i.isEnd,isPast:!!e.isPast,isFuture:!!e.isFuture,isToday:!!e.isToday,isSelected:!!e.isSelected,isDragging:!!e.isDragging,isResizing:!!e.isResizing};return ie(va,{elRef:this.handleEl,elTag:e.elTag,elAttrs:e.elAttrs,elClasses:[...SM(u),...i.eventRange.ui.classNames,...e.elClasses||[]],elStyle:e.elStyle,renderProps:u,generatorName:"eventContent",customGenerator:s.eventContent,defaultGenerator:e.defaultGenerator,classNameGenerator:s.eventClassNames,didMount:s.eventDidMount,willUnmount:s.eventWillUnmount},e.children)}componentDidUpdate(e){this.el&&this.props.seg!==e.seg&&Yv(this.el,this.props.seg)}}class nN extends Lt{render(){let{props:e,context:t}=this,{options:s}=t,{seg:i}=e,{ui:l}=i.eventRange,c=s.eventTimeFormat||e.defaultTimeFormat,u=zA(i,c,t,e.defaultDisplayEventTime,e.defaultDisplayEventEnd);return ie(vg,Object.assign({},e,{elTag:"a",elStyle:{borderColor:l.borderColor,backgroundColor:l.backgroundColor},elAttrs:FA(i,t),defaultGenerator:R4,timeText:u}),(h,m)=>ie(It,null,ie(h,{elTag:"div",elClasses:["fc-event-main"],elStyle:{color:m.textColor}}),!!m.isStartResizable&&ie("div",{className:"fc-event-resizer fc-event-resizer-start"}),!!m.isEndResizable&&ie("div",{className:"fc-event-resizer fc-event-resizer-end"})))}}nN.addPropsEquality({seg:Cn});function R4(n){return ie("div",{className:"fc-event-main-frame"},n.timeText&&ie("div",{className:"fc-event-time"},n.timeText),ie("div",{className:"fc-event-title-container"},ie("div",{className:"fc-event-title fc-sticky"},n.event.title||ie(It,null," "))))}const k4=is({day:"numeric"});class aN extends Lt{constructor(){super(...arguments),this.refineRenderProps=Pd(M4)}render(){let{props:e,context:t}=this,{options:s}=t,i=this.refineRenderProps({date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,isMonthStart:e.isMonthStart||!1,showDayNumber:e.showDayNumber,extraRenderProps:e.extraRenderProps,viewApi:t.viewApi,dateEnv:t.dateEnv,monthStartFormat:s.monthStartFormat});return ie(va,{elRef:e.elRef,elTag:e.elTag,elAttrs:Object.assign(Object.assign({},e.elAttrs),i.isDisabled?{}:{"data-date":sg(e.date)}),elClasses:[...gg(i,t.theme),...e.elClasses||[]],elStyle:e.elStyle,renderProps:i,generatorName:"dayCellContent",customGenerator:s.dayCellContent,defaultGenerator:e.defaultGenerator,classNameGenerator:i.isDisabled?void 0:s.dayCellClassNames,didMount:s.dayCellDidMount,willUnmount:s.dayCellWillUnmount},e.children)}}function iN(n){return!!(n.dayCellContent||cp("dayCellContent",n))}function M4(n){let{date:e,dateEnv:t,dateProfile:s,isMonthStart:i}=n,l=GA(e,n.todayRange,null,s),c=n.showDayNumber?t.format(e,i?n.monthStartFormat:k4):"";return Object.assign(Object.assign(Object.assign({date:t.toDate(e),view:n.viewApi},l),{isMonthStart:i,dayNumberText:c}),n.extraRenderProps)}class L4 extends Lt{render(){let{props:e}=this,{seg:t}=e;return ie(vg,{elTag:"div",elClasses:["fc-bg-event"],elStyle:{backgroundColor:t.eventRange.ui.backgroundColor},defaultGenerator:O4,seg:t,timeText:"",isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,isPast:e.isPast,isFuture:e.isFuture,isToday:e.isToday,disableDragging:!0,disableResizing:!0})}}function O4(n){let{title:e}=n.event;return e&&ie("div",{className:"fc-event-title"},n.event.title)}function P4(n){return ie("div",{className:`fc-${n}`})}const I4=n=>ie(Xi.Consumer,null,e=>{let{dateEnv:t,options:s}=e,{date:i}=n,l=s.weekNumberFormat||n.defaultFormat,c=t.computeWeekNumber(i),u=t.format(i,l),h={num:c,text:u,date:i};return ie(va,{elRef:n.elRef,elTag:n.elTag,elAttrs:n.elAttrs,elClasses:n.elClasses,elStyle:n.elStyle,renderProps:h,generatorName:"weekNumberContent",customGenerator:s.weekNumberContent,defaultGenerator:B4,classNameGenerator:s.weekNumberClassNames,didMount:s.weekNumberDidMount,willUnmount:s.weekNumberWillUnmount},n.children)});function B4(n){return n.text}const Lm=10;class H4 extends Lt{constructor(){super(...arguments),this.state={titleId:Eu()},this.handleRootEl=e=>{this.rootEl=e,this.props.elRef&&Xn(this.props.elRef,e)},this.handleDocumentMouseDown=e=>{const t=gA(e);this.rootEl.contains(t)||this.handleCloseClick()},this.handleDocumentKeyDown=e=>{e.key==="Escape"&&this.handleCloseClick()},this.handleCloseClick=()=>{let{onClose:e}=this.props;e&&e()}}render(){let{theme:e,options:t}=this.context,{props:s,state:i}=this,l=["fc-popover",e.getClass("popover")].concat(s.extraClassNames||[]);return hR(ie("div",Object.assign({},s.extraAttrs,{id:s.id,className:l.join(" "),"aria-labelledby":i.titleId,ref:this.handleRootEl}),ie("div",{className:"fc-popover-header "+e.getClass("popoverHeader")},ie("span",{className:"fc-popover-title",id:i.titleId},s.title),ie("span",{className:"fc-popover-close "+e.getIconClass("close"),title:t.closeHint,onClick:this.handleCloseClick})),ie("div",{className:"fc-popover-body "+e.getClass("popoverContent")},s.children)),s.parentEl)}componentDidMount(){document.addEventListener("mousedown",this.handleDocumentMouseDown),document.addEventListener("keydown",this.handleDocumentKeyDown),this.updateSize()}componentWillUnmount(){document.removeEventListener("mousedown",this.handleDocumentMouseDown),document.removeEventListener("keydown",this.handleDocumentKeyDown)}updateSize(){let{isRtl:e}=this.context,{alignmentEl:t,alignGridTop:s}=this.props,{rootEl:i}=this,l=KM(t);if(l){let c=i.getBoundingClientRect(),u=s?bs(t,".fc-scrollgrid").getBoundingClientRect().top:l.top,h=e?l.right-c.width:l.left;u=Math.max(u,Lm),h=Math.min(h,document.documentElement.clientWidth-Lm-c.width),h=Math.max(h,Lm);let m=i.offsetParent.getBoundingClientRect();wo(i,{top:u-m.top,left:h-m.left})}}}class z4 extends Zi{constructor(){super(...arguments),this.handleRootEl=e=>{this.rootEl=e,e?this.context.registerInteractiveComponent(this,{el:e,useEventCenter:!1}):this.context.unregisterInteractiveComponent(this)}}render(){let{options:e,dateEnv:t}=this.context,{props:s}=this,{startDate:i,todayRange:l,dateProfile:c}=s,u=t.format(i,e.dayPopoverFormat);return ie(aN,{elRef:this.handleRootEl,date:i,dateProfile:c,todayRange:l},(h,m,p)=>ie(H4,{elRef:p.ref,id:s.id,title:u,extraClassNames:["fc-more-popover"].concat(p.className||[]),extraAttrs:p,parentEl:s.parentEl,alignmentEl:s.alignmentEl,alignGridTop:s.alignGridTop,onClose:s.onClose},iN(e)&&ie(h,{elTag:"div",elClasses:["fc-more-popover-misc"]}),s.children))}queryHit(e,t,s,i){let{rootEl:l,props:c}=this;return e>=0&&e<s&&t>=0&&t<i?{dateProfile:c.dateProfile,dateSpan:Object.assign({allDay:!c.forceTimed,range:{start:c.startDate,end:c.endDate}},c.extraDateSpan),dayEl:l,rect:{left:0,top:0,right:s,bottom:i},layer:1}:null}}class F4 extends Lt{constructor(){super(...arguments),this.state={isPopoverOpen:!1,popoverId:Eu()},this.handleLinkEl=e=>{this.linkEl=e,this.props.elRef&&Xn(this.props.elRef,e)},this.handleClick=e=>{let{props:t,context:s}=this,{moreLinkClick:i}=s.options,l=Kv(t).start;function c(u){let{def:h,instance:m,range:p}=u.eventRange;return{event:new Tt(s,h,m),start:s.dateEnv.toDate(p.start),end:s.dateEnv.toDate(p.end),isStart:u.isStart,isEnd:u.isEnd}}typeof i=="function"&&(i=i({date:l,allDay:!!t.allDayDate,allSegs:t.allSegs.map(c),hiddenSegs:t.hiddenSegs.map(c),jsEvent:e,view:s.viewApi})),!i||i==="popover"?this.setState({isPopoverOpen:!0}):typeof i=="string"&&s.calendarApi.zoomTo(l,i)},this.handlePopoverClose=()=>{this.setState({isPopoverOpen:!1})}}render(){let{props:e,state:t}=this;return ie(Xi.Consumer,null,s=>{let{viewApi:i,options:l,calendarApi:c}=s,{moreLinkText:u}=l,{moreCnt:h}=e,m=Kv(e),p=typeof u=="function"?u.call(c,h):`+${h} ${u}`,x=Ao(l.moreLinkHint,[h],p),y={num:h,shortText:`+${h}`,text:p,view:i};return ie(It,null,!!e.moreCnt&&ie(va,{elTag:e.elTag||"a",elRef:this.handleLinkEl,elClasses:[...e.elClasses||[],"fc-more-link"],elStyle:e.elStyle,elAttrs:Object.assign(Object.assign(Object.assign({},e.elAttrs),yA(this.handleClick)),{title:x,"aria-expanded":t.isPopoverOpen,"aria-controls":t.isPopoverOpen?t.popoverId:""}),renderProps:y,generatorName:"moreLinkContent",customGenerator:l.moreLinkContent,defaultGenerator:e.defaultGenerator||U4,classNameGenerator:l.moreLinkClassNames,didMount:l.moreLinkDidMount,willUnmount:l.moreLinkWillUnmount},e.children),t.isPopoverOpen&&ie(z4,{id:t.popoverId,startDate:m.start,endDate:m.end,dateProfile:e.dateProfile,todayRange:e.todayRange,extraDateSpan:e.extraDateSpan,parentEl:this.parentEl,alignmentEl:e.alignmentElRef?e.alignmentElRef.current:this.linkEl,alignGridTop:e.alignGridTop,forceTimed:e.forceTimed,onClose:this.handlePopoverClose},e.popoverContent()))})}componentDidMount(){this.updateParentEl()}componentDidUpdate(){this.updateParentEl()}updateParentEl(){this.linkEl&&(this.parentEl=bs(this.linkEl,".fc-view-harness"))}}function U4(n){return n.text}function Kv(n){if(n.allDayDate)return{start:n.allDayDate,end:rs(n.allDayDate,1)};let{hiddenSegs:e}=n;return{start:q4(e),end:$4(e)}}function q4(n){return n.reduce(V4).eventRange.range.start}function V4(n,e){return n.eventRange.range.start<e.eventRange.range.start?n:e}function $4(n){return n.reduce(G4).eventRange.range.end}function G4(n,e){return n.eventRange.range.end>e.eventRange.range.end?n:e}class Y4{constructor(){this.handlers=[]}set(e){this.currentValue=e;for(let t of this.handlers)t(e)}subscribe(e){this.handlers.push(e),this.currentValue!==void 0&&e(this.currentValue)}}class W4 extends Y4{constructor(){super(...arguments),this.map=new Map}handle(e){const{map:t}=this;let s=!1;e.isActive?(t.set(e.id,e),s=!0):t.has(e.id)&&(t.delete(e.id),s=!0),s&&this.set(t)}}const X4=[],rN={code:"en",week:{dow:0,doy:4},direction:"ltr",buttonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",year:"year",today:"today",month:"month",week:"week",day:"day",list:"list"},weekText:"W",weekTextLong:"Week",closeHint:"Close",timeHint:"Time",eventHint:"Event",allDayText:"all-day",moreLinkText:"more",noEventsText:"No events to display"},lN=Object.assign(Object.assign({},rN),{buttonHints:{prev:"Previous $0",next:"Next $0",today(n,e){return e==="day"?"Today":`This ${n}`}},viewHint:"$0 view",navLinkHint:"Go to $0",moreLinkHint(n){return`Show ${n} more event${n===1?"":"s"}`}});function Q4(n){let e=n.length>0?n[0].code:"en",t=X4.concat(n),s={en:lN};for(let i of t)s[i.code]=i;return{map:s,defaultCode:e}}function oN(n,e){return typeof n=="object"&&!Array.isArray(n)?cN(n.code,[n.code],n):Z4(n,e)}function Z4(n,e){let t=[].concat(n||[]),s=K4(t,e)||lN;return cN(n,t,s)}function K4(n,e){for(let t=0;t<n.length;t+=1){let s=n[t].toLocaleLowerCase().split("-");for(let i=s.length;i>0;i-=1){let l=s.slice(0,i).join("-");if(e[l])return e[l]}}return null}function cN(n,e,t){let s=ig([rN,t],["buttonText"]);delete s.code;let{week:i}=s;return delete s.week,{codeArg:n,codes:e,week:i,simpleNumberFormat:new Intl.NumberFormat(n),options:s}}function ni(n){return{id:Yi(),name:n.name,premiumReleaseDate:n.premiumReleaseDate?new Date(n.premiumReleaseDate):void 0,deps:n.deps||[],reducers:n.reducers||[],isLoadingFuncs:n.isLoadingFuncs||[],contextInit:[].concat(n.contextInit||[]),eventRefiners:n.eventRefiners||{},eventDefMemberAdders:n.eventDefMemberAdders||[],eventSourceRefiners:n.eventSourceRefiners||{},isDraggableTransformers:n.isDraggableTransformers||[],eventDragMutationMassagers:n.eventDragMutationMassagers||[],eventDefMutationAppliers:n.eventDefMutationAppliers||[],dateSelectionTransformers:n.dateSelectionTransformers||[],datePointTransforms:n.datePointTransforms||[],dateSpanTransforms:n.dateSpanTransforms||[],views:n.views||{},viewPropsTransformers:n.viewPropsTransformers||[],isPropsValid:n.isPropsValid||null,externalDefTransforms:n.externalDefTransforms||[],viewContainerAppends:n.viewContainerAppends||[],eventDropTransformers:n.eventDropTransformers||[],componentInteractions:n.componentInteractions||[],calendarInteractions:n.calendarInteractions||[],themeClasses:n.themeClasses||{},eventSourceDefs:n.eventSourceDefs||[],cmdFormatter:n.cmdFormatter,recurringTypes:n.recurringTypes||[],namedTimeZonedImpl:n.namedTimeZonedImpl,initialView:n.initialView||"",elementDraggingImpl:n.elementDraggingImpl,optionChangeHandlers:n.optionChangeHandlers||{},scrollGridImpl:n.scrollGridImpl||null,listenerRefiners:n.listenerRefiners||{},optionRefiners:n.optionRefiners||{},propSetHandlers:n.propSetHandlers||{}}}function J4(n,e){let t={},s={premiumReleaseDate:void 0,reducers:[],isLoadingFuncs:[],contextInit:[],eventRefiners:{},eventDefMemberAdders:[],eventSourceRefiners:{},isDraggableTransformers:[],eventDragMutationMassagers:[],eventDefMutationAppliers:[],dateSelectionTransformers:[],datePointTransforms:[],dateSpanTransforms:[],views:{},viewPropsTransformers:[],isPropsValid:null,externalDefTransforms:[],viewContainerAppends:[],eventDropTransformers:[],componentInteractions:[],calendarInteractions:[],themeClasses:{},eventSourceDefs:[],cmdFormatter:null,recurringTypes:[],namedTimeZonedImpl:null,initialView:"",elementDraggingImpl:null,optionChangeHandlers:{},scrollGridImpl:null,listenerRefiners:{},optionRefiners:{},propSetHandlers:{}};function i(l){for(let c of l){const u=c.name,h=t[u];h===void 0?(t[u]=c.id,i(c.deps),s=t3(s,c)):h!==c.id&&console.warn(`Duplicate plugin '${u}'`)}}return n&&i(n),i(e),s}function e3(){let n=[],e=[],t;return(s,i)=>((!t||!ei(s,n)||!ei(i,e))&&(t=J4(s,i)),n=s,e=i,t)}function t3(n,e){return{premiumReleaseDate:s3(n.premiumReleaseDate,e.premiumReleaseDate),reducers:n.reducers.concat(e.reducers),isLoadingFuncs:n.isLoadingFuncs.concat(e.isLoadingFuncs),contextInit:n.contextInit.concat(e.contextInit),eventRefiners:Object.assign(Object.assign({},n.eventRefiners),e.eventRefiners),eventDefMemberAdders:n.eventDefMemberAdders.concat(e.eventDefMemberAdders),eventSourceRefiners:Object.assign(Object.assign({},n.eventSourceRefiners),e.eventSourceRefiners),isDraggableTransformers:n.isDraggableTransformers.concat(e.isDraggableTransformers),eventDragMutationMassagers:n.eventDragMutationMassagers.concat(e.eventDragMutationMassagers),eventDefMutationAppliers:n.eventDefMutationAppliers.concat(e.eventDefMutationAppliers),dateSelectionTransformers:n.dateSelectionTransformers.concat(e.dateSelectionTransformers),datePointTransforms:n.datePointTransforms.concat(e.datePointTransforms),dateSpanTransforms:n.dateSpanTransforms.concat(e.dateSpanTransforms),views:Object.assign(Object.assign({},n.views),e.views),viewPropsTransformers:n.viewPropsTransformers.concat(e.viewPropsTransformers),isPropsValid:e.isPropsValid||n.isPropsValid,externalDefTransforms:n.externalDefTransforms.concat(e.externalDefTransforms),viewContainerAppends:n.viewContainerAppends.concat(e.viewContainerAppends),eventDropTransformers:n.eventDropTransformers.concat(e.eventDropTransformers),calendarInteractions:n.calendarInteractions.concat(e.calendarInteractions),componentInteractions:n.componentInteractions.concat(e.componentInteractions),themeClasses:Object.assign(Object.assign({},n.themeClasses),e.themeClasses),eventSourceDefs:n.eventSourceDefs.concat(e.eventSourceDefs),cmdFormatter:e.cmdFormatter||n.cmdFormatter,recurringTypes:n.recurringTypes.concat(e.recurringTypes),namedTimeZonedImpl:e.namedTimeZonedImpl||n.namedTimeZonedImpl,initialView:n.initialView||e.initialView,elementDraggingImpl:n.elementDraggingImpl||e.elementDraggingImpl,optionChangeHandlers:Object.assign(Object.assign({},n.optionChangeHandlers),e.optionChangeHandlers),scrollGridImpl:e.scrollGridImpl||n.scrollGridImpl,listenerRefiners:Object.assign(Object.assign({},n.listenerRefiners),e.listenerRefiners),optionRefiners:Object.assign(Object.assign({},n.optionRefiners),e.optionRefiners),propSetHandlers:Object.assign(Object.assign({},n.propSetHandlers),e.propSetHandlers)}}function s3(n,e){return n===void 0?e:e===void 0?n:new Date(Math.max(n.valueOf(),e.valueOf()))}class ai extends Qo{}ai.prototype.classes={root:"fc-theme-standard",tableCellShaded:"fc-cell-shaded",buttonGroup:"fc-button-group",button:"fc-button fc-button-primary",buttonActive:"fc-button-active"};ai.prototype.baseIconClass="fc-icon";ai.prototype.iconClasses={close:"fc-icon-x",prev:"fc-icon-chevron-left",next:"fc-icon-chevron-right",prevYear:"fc-icon-chevrons-left",nextYear:"fc-icon-chevrons-right"};ai.prototype.rtlIconClasses={prev:"fc-icon-chevron-right",next:"fc-icon-chevron-left",prevYear:"fc-icon-chevrons-right",nextYear:"fc-icon-chevrons-left"};ai.prototype.iconOverrideOption="buttonIcons";ai.prototype.iconOverrideCustomButtonOption="icon";ai.prototype.iconOverridePrefix="fc-icon-";function n3(n,e){let t={},s;for(s in n)mp(s,t,n,e);for(s in e)mp(s,t,n,e);return t}function mp(n,e,t,s){if(e[n])return e[n];let i=a3(n,e,t,s);return i&&(e[n]=i),i}function a3(n,e,t,s){let i=t[n],l=s[n],c=p=>i&&i[p]!==null?i[p]:l&&l[p]!==null?l[p]:null,u=c("component"),h=c("superType"),m=null;if(h){if(h===n)throw new Error("Can't have a custom view type that references itself");m=mp(h,e,t,s)}return!u&&m&&(u=m.component),u?{type:n,component:u,defaults:Object.assign(Object.assign({},m?m.defaults:{}),i?i.rawOptions:{}),overrides:Object.assign(Object.assign({},m?m.overrides:{}),l?l.rawOptions:{})}:null}function Jv(n){return Wi(n,i3)}function i3(n){let e=typeof n=="function"?{component:n}:n,{component:t}=e;return e.content?t=ew(e):t&&!(t.prototype instanceof Lt)&&(t=ew(Object.assign(Object.assign({},e),{content:t}))),{superType:e.type,component:t,rawOptions:e}}function ew(n){return e=>ie(Xi.Consumer,null,t=>ie(va,{elTag:"div",elClasses:EA(t.viewSpec),renderProps:Object.assign(Object.assign({},e),{nextDayThreshold:t.options.nextDayThreshold}),generatorName:void 0,customGenerator:n.content,classNameGenerator:n.classNames,didMount:n.didMount,willUnmount:n.willUnmount}))}function r3(n,e,t,s){let i=Jv(n),l=Jv(e.views),c=n3(i,l);return Wi(c,u=>l3(u,l,e,t,s))}function l3(n,e,t,s,i){let l=n.overrides.duration||n.defaults.duration||s.duration||t.duration,c=null,u="",h="",m={};if(l&&(c=o3(l),c)){let y=op(c);u=y.unit,y.value===1&&(h=u,m=e[u]?e[u].rawOptions:{})}let p=y=>{let v=y.buttonText||{},w=n.defaults.buttonTextKey;return w!=null&&v[w]!=null?v[w]:v[n.type]!=null?v[n.type]:v[h]!=null?v[h]:null},x=y=>{let v=y.buttonHints||{},w=n.defaults.buttonTextKey;return w!=null&&v[w]!=null?v[w]:v[n.type]!=null?v[n.type]:v[h]!=null?v[h]:null};return{type:n.type,component:n.component,duration:c,durationUnit:u,singleUnit:h,optionDefaults:n.defaults,optionOverrides:Object.assign(Object.assign({},m),n.overrides),buttonTextOverride:p(s)||p(t)||n.overrides.buttonText,buttonTextDefault:p(i)||n.defaults.buttonText||p(No)||n.type,buttonTitleOverride:x(s)||x(t)||n.overrides.buttonHint,buttonTitleDefault:x(i)||n.defaults.buttonHint||x(No)}}let tw={};function o3(n){let e=JSON.stringify(n),t=tw[e];return t===void 0&&(t=ct(n),tw[e]=t),t}function c3(n,e){switch(e.type){case"CHANGE_VIEW_TYPE":n=e.viewType}return n}function d3(n,e){switch(e.type){case"CHANGE_DATE":return e.dateMarker;default:return n}}function u3(n,e,t){let s=n.initialDate;return s!=null?e.createMarker(s):t.getDateMarker()}function h3(n,e){switch(e.type){case"SET_OPTION":return Object.assign(Object.assign({},n),{[e.optionName]:e.rawOptionValue});default:return n}}function f3(n,e,t,s){let i;switch(e.type){case"CHANGE_VIEW_TYPE":return s.build(e.dateMarker||t);case"CHANGE_DATE":return s.build(e.dateMarker);case"PREV":if(i=s.buildPrev(n,t),i.isValid)return i;break;case"NEXT":if(i=s.buildNext(n,t),i.isValid)return i;break}return n}function m3(n,e,t){let s=e?e.activeRange:null;return uN({},w3(n,t),s,t)}function p3(n,e,t,s){let i=t?t.activeRange:null;switch(e.type){case"ADD_EVENT_SOURCES":return uN(n,e.sources,i,s);case"REMOVE_EVENT_SOURCE":return x3(n,e.sourceId);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return t?hN(n,i,s):n;case"FETCH_EVENT_SOURCES":return wg(n,e.sourceIds?wA(e.sourceIds):fN(n,s),i,e.isRefetch||!1,s);case"RECEIVE_EVENTS":case"RECEIVE_EVENT_ERROR":return v3(n,e.sourceId,e.fetchId,e.fetchRange);case"REMOVE_ALL_EVENT_SOURCES":return{};default:return n}}function g3(n,e,t){let s=e?e.activeRange:null;return wg(n,fN(n,t),s,!0,t)}function dN(n){for(let e in n)if(n[e].isFetching)return!0;return!1}function uN(n,e,t,s){let i={};for(let l of e)i[l.sourceId]=l;return t&&(i=hN(i,t,s)),Object.assign(Object.assign({},n),i)}function x3(n,e){return qi(n,t=>t.sourceId!==e)}function hN(n,e,t){return wg(n,qi(n,s=>y3(s,e,t)),e,!1,t)}function y3(n,e,t){return mN(n,t)?!t.options.lazyFetching||!n.fetchRange||n.isFetching||e.start<n.fetchRange.start||e.end>n.fetchRange.end:!n.latestFetchId}function wg(n,e,t,s,i){let l={};for(let c in n){let u=n[c];e[c]?l[c]=b3(u,t,s,i):l[c]=u}return l}function b3(n,e,t,s){let{options:i,calendarApi:l}=s,c=s.pluginHooks.eventSourceDefs[n.sourceDefId],u=Yi();return c.fetch({eventSource:n,range:e,isRefetch:t,context:s},h=>{let{rawEvents:m}=h;i.eventSourceSuccess&&(m=i.eventSourceSuccess.call(l,m,h.response)||m),n.success&&(m=n.success.call(l,m,h.response)||m),s.dispatch({type:"RECEIVE_EVENTS",sourceId:n.sourceId,fetchId:u,fetchRange:e,rawEvents:m})},h=>{let m=!1;i.eventSourceFailure&&(i.eventSourceFailure.call(l,h),m=!0),n.failure&&(n.failure(h),m=!0),m||console.warn(h.message,h),s.dispatch({type:"RECEIVE_EVENT_ERROR",sourceId:n.sourceId,fetchId:u,fetchRange:e,error:h})}),Object.assign(Object.assign({},n),{isFetching:!0,latestFetchId:u})}function v3(n,e,t,s){let i=n[e];return i&&t===i.latestFetchId?Object.assign(Object.assign({},n),{[e]:Object.assign(Object.assign({},i),{isFetching:!1,fetchRange:s})}):n}function fN(n,e){return qi(n,t=>mN(t,e))}function w3(n,e){let t=LA(e),s=[].concat(n.eventSources||[]),i=[];n.initialEvents&&s.unshift(n.initialEvents),n.events&&s.unshift(n.events);for(let l of s){let c=MA(l,e,t);c&&i.push(c)}return i}function mN(n,e){return!e.pluginHooks.eventSourceDefs[n.sourceDefId].ignoreRange}function A3(n,e){switch(e.type){case"UNSELECT_DATES":return null;case"SELECT_DATES":return e.selection;default:return n}}function N3(n,e){switch(e.type){case"UNSELECT_EVENT":return"";case"SELECT_EVENT":return e.eventInstanceId;default:return n}}function S3(n,e){let t;switch(e.type){case"UNSET_EVENT_DRAG":return null;case"SET_EVENT_DRAG":return t=e.state,{affectedEvents:t.affectedEvents,mutatedEvents:t.mutatedEvents,isEvent:t.isEvent};default:return n}}function j3(n,e){let t;switch(e.type){case"UNSET_EVENT_RESIZE":return null;case"SET_EVENT_RESIZE":return t=e.state,{affectedEvents:t.affectedEvents,mutatedEvents:t.mutatedEvents,isEvent:t.isEvent};default:return n}}function E3(n,e,t,s,i){let l=n.headerToolbar?sw(n.headerToolbar,n,e,t,s,i):null,c=n.footerToolbar?sw(n.footerToolbar,n,e,t,s,i):null;return{header:l,footer:c}}function sw(n,e,t,s,i,l){let c={},u=[],h=!1;for(let m in n){let p=n[m],x=_3(p,e,t,s,i,l);c[m]=x.widgets,u.push(...x.viewsWithButtons),h=h||x.hasTitle}return{sectionWidgets:c,viewsWithButtons:u,hasTitle:h}}function _3(n,e,t,s,i,l){let c=e.direction==="rtl",u=e.customButtons||{},h=t.buttonText||{},m=e.buttonText||{},p=t.buttonHints||{},x=e.buttonHints||{},y=n?n.split(" "):[],v=[],w=!1;return{widgets:y.map(N=>N.split(",").map(S=>{if(S==="title")return w=!0,{buttonName:S};let E,C,R,D,O,H;if(E=u[S])R=F=>{E.click&&E.click.call(F.target,F,F.target)},(D=s.getCustomButtonIconClass(E))||(D=s.getIconClass(S,c))||(O=E.text),H=E.hint||E.text;else if(C=i[S]){v.push(S),R=()=>{l.changeView(S)},(O=C.buttonTextOverride)||(D=s.getIconClass(S,c))||(O=C.buttonTextDefault);let F=C.buttonTextOverride||C.buttonTextDefault;H=Ao(C.buttonTitleOverride||C.buttonTitleDefault||e.viewHint,[F,S],F)}else if(l[S])if(R=()=>{l[S]()},(O=h[S])||(D=s.getIconClass(S,c))||(O=m[S]),S==="prevYear"||S==="nextYear"){let F=S==="prevYear"?"prev":"next";H=Ao(p[F]||x[F],[m.year||"year","year"],m[S])}else H=F=>Ao(p[S]||x[S],[m[F]||F,F],m[S]);return{buttonName:S,buttonClick:R,buttonIcon:D,buttonText:O,buttonHint:H}})),viewsWithButtons:v,hasTitle:w}}class C3{constructor(e,t,s){this.type=e,this.getCurrentData=t,this.dateEnv=s}get calendar(){return this.getCurrentData().calendarApi}get title(){return this.getCurrentData().viewTitle}get activeStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start)}get activeEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end)}get currentStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start)}get currentEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end)}getOption(e){return this.getCurrentData().options[e]}}let T3={ignoreRange:!0,parseMeta(n){return Array.isArray(n.events)?n.events:null},fetch(n,e){e({rawEvents:n.eventSource.meta})}};const D3=ni({name:"array-event-source",eventSourceDefs:[T3]});let R3={parseMeta(n){return typeof n.events=="function"?n.events:null},fetch(n,e,t){const{dateEnv:s}=n.context,i=n.eventSource.meta;MM(i.bind(null,UA(n.range,s)),l=>e({rawEvents:l}),t)}};const k3=ni({name:"func-event-source",eventSourceDefs:[R3]}),M3={method:String,extraParams:ae,startParam:String,endParam:String,timeZoneParam:String};let L3={parseMeta(n){return n.url&&(n.format==="json"||!n.format)?{url:n.url,format:"json",method:(n.method||"GET").toUpperCase(),extraParams:n.extraParams,startParam:n.startParam,endParam:n.endParam,timeZoneParam:n.timeZoneParam}:null},fetch(n,e,t){const{meta:s}=n.eventSource,i=P3(s,n.range,n.context);LM(s.method,s.url,i).then(([l,c])=>{e({rawEvents:l,response:c})},t)}};const O3=ni({name:"json-event-source",eventSourceRefiners:M3,eventSourceDefs:[L3]});function P3(n,e,t){let{dateEnv:s,options:i}=t,l,c,u,h,m={};return l=n.startParam,l==null&&(l=i.startParam),c=n.endParam,c==null&&(c=i.endParam),u=n.timeZoneParam,u==null&&(u=i.timeZoneParam),typeof n.extraParams=="function"?h=n.extraParams():h=n.extraParams||{},Object.assign(m,h),m[l]=s.formatIso(e.start),m[c]=s.formatIso(e.end),s.timeZone!=="local"&&(m[u]=s.timeZone),m}const I3={daysOfWeek:ae,startTime:ct,endTime:ct,duration:ct,startRecur:ae,endRecur:ae};let B3={parse(n,e){if(n.daysOfWeek||n.startTime||n.endTime||n.startRecur||n.endRecur){let t={daysOfWeek:n.daysOfWeek||null,startTime:n.startTime||null,endTime:n.endTime||null,startRecur:n.startRecur?e.createMarker(n.startRecur):null,endRecur:n.endRecur?e.createMarker(n.endRecur):null,dateEnv:e},s;return n.duration&&(s=n.duration),!s&&n.startTime&&n.endTime&&(s=VR(n.endTime,n.startTime)),{allDayGuess:!n.startTime&&!n.endTime,duration:s,typeData:t}}return null},expand(n,e,t){let s=el(e,{start:n.startRecur,end:n.endRecur});return s?z3(n.daysOfWeek,n.startTime,n.dateEnv,t,s):[]}};const H3=ni({name:"simple-recurring-event",recurringTypes:[B3],eventRefiners:I3});function z3(n,e,t,s,i){let l=n?wA(n):null,c=Ct(i.start),u=i.end,h=[];for(e&&(e.milliseconds<0?u=rs(u,1):e.milliseconds>=1e3*60*60*24&&(c=rs(c,-1)));c<u;){let m;(!l||l[c.getUTCDay()])&&(e?m=s.add(c,e):m=c,h.push(s.createMarker(t.toDate(m)))),c=rs(c,1)}return h}const F3=ni({name:"change-handler",optionChangeHandlers:{events(n,e){nw([n],e)},eventSources:nw}});function nw(n,e){let t=rg(e.getCurrentData().eventSources);if(t.length===1&&n.length===1&&Array.isArray(t[0]._raw)&&Array.isArray(n[0])){e.dispatch({type:"RESET_RAW_EVENTS",sourceId:t[0].sourceId,rawEvents:n[0]});return}let s=[];for(let i of n){let l=!1;for(let c=0;c<t.length;c+=1)if(t[c]._raw===i){t.splice(c,1),l=!0;break}l||s.push(i)}for(let i of t)e.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:i.sourceId});for(let i of s)e.calendarApi.addEventSource(i)}function U3(n,e){e.emitter.trigger("datesSet",Object.assign(Object.assign({},UA(n.activeRange,e.dateEnv)),{view:e.viewApi}))}function q3(n,e){let{emitter:t}=e;t.hasHandlers("eventsSet")&&t.trigger("eventsSet",Bi(n,e))}const V3=[D3,k3,O3,H3,F3,ni({name:"misc",isLoadingFuncs:[n=>dN(n.eventSources)],propSetHandlers:{dateProfile:U3,eventStore:q3}})];class $3{constructor(e,t){this.runTaskOption=e,this.drainedOption=t,this.queue=[],this.delayedRunner=new Kp(this.drain.bind(this))}request(e,t){this.queue.push(e),this.delayedRunner.request(t)}pause(e){this.delayedRunner.pause(e)}resume(e,t){this.delayedRunner.resume(e,t)}drain(){let{queue:e}=this;for(;e.length;){let t=[],s;for(;s=e.shift();)this.runTask(s),t.push(s);this.drained(t)}}runTask(e){this.runTaskOption&&this.runTaskOption(e)}drained(e){this.drainedOption&&this.drainedOption(e)}}function G3(n,e,t){let s;return/^(year|month)$/.test(n.currentRangeUnit)?s=n.currentRange:s=n.activeRange,t.formatRange(s.start,s.end,is(e.titleFormat||Y3(n)),{isEndExclusive:n.isRangeAllDay,defaultSeparator:e.titleRangeSeparator})}function Y3(n){let{currentRangeUnit:e}=n;if(e==="year")return{year:"numeric"};if(e==="month")return{year:"numeric",month:"long"};let t=Kd(n.currentRange.start,n.currentRange.end);return t!==null&&t>1?{year:"numeric",month:"short",day:"numeric"}:{year:"numeric",month:"long",day:"numeric"}}class aw{constructor(){this.resetListeners=new Set}handleInput(e,t){const s=this.dateEnv;if(e!==s&&(typeof t=="function"?this.nowFn=t:s||(this.nowAnchorDate=e.toDate(t?e.createMarker(t):e.createNowMarker()),this.nowAnchorQueried=Date.now()),this.dateEnv=e,s))for(const i of this.resetListeners.values())i()}getDateMarker(){return this.nowAnchorDate?this.dateEnv.timestampToMarker(this.nowAnchorDate.valueOf()+(Date.now()-this.nowAnchorQueried)):this.dateEnv.createMarker(this.nowFn())}addResetListener(e){this.resetListeners.add(e)}removeResetListener(e){this.resetListeners.delete(e)}}class W3{constructor(e){this.computeCurrentViewData=lt(this._computeCurrentViewData),this.organizeRawLocales=lt(Q4),this.buildLocale=lt(oN),this.buildPluginHooks=e3(),this.buildDateEnv=lt(X3),this.buildTheme=lt(Q3),this.parseToolbars=lt(E3),this.buildViewSpecs=lt(r3),this.buildDateProfileGenerator=Pd(Z3),this.buildViewApi=lt(K3),this.buildViewUiProps=Pd(tL),this.buildEventUiBySource=lt(J3,Cn),this.buildEventUiBases=lt(eL),this.parseContextBusinessHours=Pd(sL),this.buildTitle=lt(G3),this.nowManager=new aw,this.emitter=new Du,this.actionRunner=new $3(this._handleAction.bind(this),this.updateData.bind(this)),this.currentCalendarOptionsInput={},this.currentCalendarOptionsRefined={},this.currentViewOptionsInput={},this.currentViewOptionsRefined={},this.currentCalendarOptionsRefiners={},this.optionsForRefining=[],this.optionsForHandling=[],this.getCurrentData=()=>this.data,this.dispatch=y=>{this.actionRunner.request(y)},this.props=e,this.actionRunner.pause(),this.nowManager=new aw;let t={},s=this.computeOptionsData(e.optionOverrides,t,e.calendarApi),i=s.calendarOptions.initialView||s.pluginHooks.initialView,l=this.computeCurrentViewData(i,s,e.optionOverrides,t);e.calendarApi.currentDataManager=this,this.emitter.setThisContext(e.calendarApi),this.emitter.setOptions(l.options);let c={nowManager:this.nowManager,dateEnv:s.dateEnv,options:s.calendarOptions,pluginHooks:s.pluginHooks,calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},u=u3(s.calendarOptions,s.dateEnv,this.nowManager),h=l.dateProfileGenerator.build(u);Za(h.activeRange,u)||(u=h.currentRange.start);for(let y of s.pluginHooks.contextInit)y(c);let m=m3(s.calendarOptions,h,c),p={dynamicOptionOverrides:t,currentViewType:i,currentDate:u,dateProfile:h,businessHours:this.parseContextBusinessHours(c),eventSources:m,eventUiBases:{},eventStore:jn(),renderableEventStore:jn(),dateSelection:null,eventSelection:"",eventDrag:null,eventResize:null,selectionConfig:this.buildViewUiProps(c).selectionConfig},x=Object.assign(Object.assign({},c),p);for(let y of s.pluginHooks.reducers)Object.assign(p,y(null,null,x));Om(p,c)&&this.emitter.trigger("loading",!0),this.state=p,this.updateData(),this.actionRunner.resume()}resetOptions(e,t){let{props:s}=this;t===void 0?s.optionOverrides=e:(s.optionOverrides=Object.assign(Object.assign({},s.optionOverrides||{}),e),this.optionsForRefining.push(...t)),(t===void 0||t.length)&&this.actionRunner.request({type:"NOTHING"})}_handleAction(e){let{props:t,state:s,emitter:i}=this,l=h3(s.dynamicOptionOverrides,e),c=this.computeOptionsData(t.optionOverrides,l,t.calendarApi),u=c3(s.currentViewType,e),h=this.computeCurrentViewData(u,c,t.optionOverrides,l);t.calendarApi.currentDataManager=this,i.setThisContext(t.calendarApi),i.setOptions(h.options);let m={nowManager:this.nowManager,dateEnv:c.dateEnv,options:c.calendarOptions,pluginHooks:c.pluginHooks,calendarApi:t.calendarApi,dispatch:this.dispatch,emitter:i,getCurrentData:this.getCurrentData},{currentDate:p,dateProfile:x}=s;this.data&&this.data.dateProfileGenerator!==h.dateProfileGenerator&&(x=h.dateProfileGenerator.build(p)),p=d3(p,e),x=f3(x,e,p,h.dateProfileGenerator),(e.type==="PREV"||e.type==="NEXT"||!Za(x.currentRange,p))&&(p=x.currentRange.start);let y=p3(s.eventSources,e,x,m),v=iM(s.eventStore,e,y,x,m),A=dN(y)&&!h.options.progressiveEventRendering&&s.renderableEventStore||v,{eventUiSingleBase:N,selectionConfig:S}=this.buildViewUiProps(m),E=this.buildEventUiBySource(y),C=this.buildEventUiBases(A.defs,N,E),R={dynamicOptionOverrides:l,currentViewType:u,currentDate:p,dateProfile:x,eventSources:y,eventStore:v,renderableEventStore:A,selectionConfig:S,eventUiBases:C,businessHours:this.parseContextBusinessHours(m),dateSelection:A3(s.dateSelection,e),eventSelection:N3(s.eventSelection,e),eventDrag:S3(s.eventDrag,e),eventResize:j3(s.eventResize,e)},D=Object.assign(Object.assign({},m),R);for(let F of c.pluginHooks.reducers)Object.assign(R,F(s,e,D));let O=Om(s,m),H=Om(R,m);!O&&H?i.trigger("loading",!0):O&&!H&&i.trigger("loading",!1),this.state=R,t.onAction&&t.onAction(e)}updateData(){let{props:e,state:t}=this,s=this.data,i=this.computeOptionsData(e.optionOverrides,t.dynamicOptionOverrides,e.calendarApi),l=this.computeCurrentViewData(t.currentViewType,i,e.optionOverrides,t.dynamicOptionOverrides),c=this.data=Object.assign(Object.assign(Object.assign({nowManager:this.nowManager,viewTitle:this.buildTitle(t.dateProfile,l.options,i.dateEnv),calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},i),l),t),u=i.pluginHooks.optionChangeHandlers,h=s&&s.calendarOptions,m=i.calendarOptions;if(h&&h!==m){h.timeZone!==m.timeZone&&(t.eventSources=c.eventSources=g3(c.eventSources,t.dateProfile,c),t.eventStore=c.eventStore=Vv(c.eventStore,s.dateEnv,c.dateEnv),t.renderableEventStore=c.renderableEventStore=Vv(c.renderableEventStore,s.dateEnv,c.dateEnv));for(let p in u)(this.optionsForHandling.indexOf(p)!==-1||h[p]!==m[p])&&u[p](m[p],c)}this.optionsForHandling=[],e.onData&&e.onData(c)}computeOptionsData(e,t,s){if(!this.optionsForRefining.length&&e===this.stableOptionOverrides&&t===this.stableDynamicOptionOverrides)return this.stableCalendarOptionsData;let{refinedOptions:i,pluginHooks:l,localeDefaults:c,availableLocaleData:u,extra:h}=this.processRawCalendarOptions(e,t);iw(h);let m=this.buildDateEnv(i.timeZone,i.locale,i.weekNumberCalculation,i.firstDay,i.weekText,l,u,i.defaultRangeSeparator),p=this.buildViewSpecs(l.views,this.stableOptionOverrides,this.stableDynamicOptionOverrides,c),x=this.buildTheme(i,l),y=this.parseToolbars(i,this.stableOptionOverrides,x,p,s);return this.stableCalendarOptionsData={calendarOptions:i,pluginHooks:l,dateEnv:m,viewSpecs:p,theme:x,toolbarConfig:y,localeDefaults:c,availableRawLocales:u.map}}processRawCalendarOptions(e,t){let{locales:s,locale:i}=_m([No,e,t]),l=this.organizeRawLocales(s),c=l.map,u=this.buildLocale(i||l.defaultCode,c).options,h=this.buildPluginHooks(e.plugins||[],V3),m=this.currentCalendarOptionsRefiners=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Iv),Bv),Hv),h.listenerRefiners),h.optionRefiners),p={},x=_m([No,u,e,t]),y={},v=this.currentCalendarOptionsInput,w=this.currentCalendarOptionsRefined,A=!1;for(let N in x)this.optionsForRefining.indexOf(N)===-1&&(x[N]===v[N]||Ei[N]&&N in v&&Ei[N](v[N],x[N]))?y[N]=w[N]:m[N]?(y[N]=m[N](x[N]),A=!0):p[N]=v[N];return A&&(this.currentCalendarOptionsInput=x,this.currentCalendarOptionsRefined=y,this.stableOptionOverrides=e,this.stableDynamicOptionOverrides=t),this.optionsForHandling.push(...this.optionsForRefining),this.optionsForRefining=[],{rawOptions:this.currentCalendarOptionsInput,refinedOptions:this.currentCalendarOptionsRefined,pluginHooks:h,availableLocaleData:l,localeDefaults:u,extra:p}}_computeCurrentViewData(e,t,s,i){let l=t.viewSpecs[e];if(!l)throw new Error(`viewType "${e}" is not available. Please make sure you've loaded all neccessary plugins`);let{refinedOptions:c,extra:u}=this.processRawViewOptions(l,t.pluginHooks,t.localeDefaults,s,i);iw(u),this.nowManager.handleInput(t.dateEnv,c.now);let h=this.buildDateProfileGenerator({dateProfileGeneratorClass:l.optionDefaults.dateProfileGeneratorClass,nowManager:this.nowManager,duration:l.duration,durationUnit:l.durationUnit,usesMinMaxTime:l.optionDefaults.usesMinMaxTime,dateEnv:t.dateEnv,calendarApi:this.props.calendarApi,slotMinTime:c.slotMinTime,slotMaxTime:c.slotMaxTime,showNonCurrentDates:c.showNonCurrentDates,dayCount:c.dayCount,dateAlignment:c.dateAlignment,dateIncrement:c.dateIncrement,hiddenDays:c.hiddenDays,weekends:c.weekends,validRangeInput:c.validRange,visibleRangeInput:c.visibleRange,fixedWeekCount:c.fixedWeekCount}),m=this.buildViewApi(e,this.getCurrentData,t.dateEnv);return{viewSpec:l,options:c,dateProfileGenerator:h,viewApi:m}}processRawViewOptions(e,t,s,i,l){let c=_m([No,e.optionDefaults,s,i,e.optionOverrides,l]),u=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Iv),Bv),Hv),Ak),t.listenerRefiners),t.optionRefiners),h={},m=this.currentViewOptionsInput,p=this.currentViewOptionsRefined,x=!1,y={};for(let v in c)c[v]===m[v]||Ei[v]&&Ei[v](c[v],m[v])?h[v]=p[v]:(c[v]===this.currentCalendarOptionsInput[v]||Ei[v]&&Ei[v](c[v],this.currentCalendarOptionsInput[v])?v in this.currentCalendarOptionsRefined&&(h[v]=this.currentCalendarOptionsRefined[v]):u[v]?h[v]=u[v](c[v]):y[v]=c[v],x=!0);return x&&(this.currentViewOptionsInput=c,this.currentViewOptionsRefined=h),{rawOptions:this.currentViewOptionsInput,refinedOptions:this.currentViewOptionsRefined,extra:y}}}function X3(n,e,t,s,i,l,c,u){let h=oN(e||c.defaultCode,c.map);return new Mk({calendarSystem:"gregory",timeZone:n,namedTimeZoneImpl:l.namedTimeZonedImpl,locale:h,weekNumberCalculation:t,firstDay:s,weekText:i,cmdFormatter:l.cmdFormatter,defaultSeparator:u})}function Q3(n,e){let t=e.themeClasses[n.themeSystem]||ai;return new t(n)}function Z3(n){let e=n.dateProfileGeneratorClass||TA;return new e(n)}function K3(n,e,t){return new C3(n,e,t)}function J3(n){return Wi(n,e=>e.ui)}function eL(n,e,t){let s={"":e};for(let i in n){let l=n[i];l.sourceId&&t[l.sourceId]&&(s[i]=t[l.sourceId])}return s}function tL(n){let{options:e}=n;return{eventUiSingleBase:au({display:e.eventDisplay,editable:e.editable,startEditable:e.eventStartEditable,durationEditable:e.eventDurationEditable,constraint:e.eventConstraint,overlap:typeof e.eventOverlap=="boolean"?e.eventOverlap:void 0,allow:e.eventAllow,backgroundColor:e.eventBackgroundColor,borderColor:e.eventBorderColor,textColor:e.eventTextColor,color:e.eventColor},n),selectionConfig:au({constraint:e.selectConstraint,overlap:typeof e.selectOverlap=="boolean"?e.selectOverlap:void 0,allow:e.selectAllow},n)}}function Om(n,e){for(let t of e.pluginHooks.isLoadingFuncs)if(t(n))return!0;return!1}function sL(n){return mM(n.options.businessHours,n)}function iw(n,e){for(let t in n)console.warn(`Unknown option '${t}'`)}class nL extends Lt{render(){let e=this.props.widgetGroups.map(t=>this.renderWidgetGroup(t));return ie("div",{className:"fc-toolbar-chunk"},...e)}renderWidgetGroup(e){let{props:t}=this,{theme:s}=this.context,i=[],l=!0;for(let c of e){let{buttonName:u,buttonClick:h,buttonText:m,buttonIcon:p,buttonHint:x}=c;if(u==="title")l=!1,i.push(ie("h2",{className:"fc-toolbar-title",id:t.titleId},t.title));else{let y=u===t.activeButton,v=!t.isTodayEnabled&&u==="today"||!t.isPrevEnabled&&u==="prev"||!t.isNextEnabled&&u==="next",w=[`fc-${u}-button`,s.getClass("button")];y&&w.push(s.getClass("buttonActive")),i.push(ie("button",{type:"button",title:typeof x=="function"?x(t.navUnit):x,disabled:v,"aria-pressed":y,className:w.join(" "),onClick:h},m||(p?ie("span",{className:p,role:"img"}):"")))}}if(i.length>1){let c=l&&s.getClass("buttonGroup")||"";return ie("div",{className:c},...i)}return i[0]}}class rw extends Lt{render(){let{model:e,extraClassName:t}=this.props,s=!1,i,l,c=e.sectionWidgets,u=c.center;return c.left?(s=!0,i=c.left):i=c.start,c.right?(s=!0,l=c.right):l=c.end,ie("div",{className:[t||"","fc-toolbar",s?"fc-toolbar-ltr":""].join(" ")},this.renderSection("start",i||[]),this.renderSection("center",u||[]),this.renderSection("end",l||[]))}renderSection(e,t){let{props:s}=this;return ie(nL,{key:e,widgetGroups:t,title:s.title,navUnit:s.navUnit,activeButton:s.activeButton,isTodayEnabled:s.isTodayEnabled,isPrevEnabled:s.isPrevEnabled,isNextEnabled:s.isNextEnabled,titleId:s.titleId})}}class aL extends Lt{constructor(){super(...arguments),this.state={availableWidth:null},this.handleEl=e=>{this.el=e,Xn(this.props.elRef,e),this.updateAvailableWidth()},this.handleResize=()=>{this.updateAvailableWidth()}}render(){let{props:e,state:t}=this,{aspectRatio:s}=e,i=["fc-view-harness",s||e.liquid||e.height?"fc-view-harness-active":"fc-view-harness-passive"],l="",c="";return s?t.availableWidth!==null?l=t.availableWidth/s:c=`${1/s*100}%`:l=e.height||"",ie("div",{"aria-labelledby":e.labeledById,ref:this.handleEl,className:i.join(" "),style:{height:l,paddingBottom:c}},e.children)}componentDidMount(){this.context.addResizeHandler(this.handleResize)}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}updateAvailableWidth(){this.el&&this.props.aspectRatio&&this.setState({availableWidth:this.el.offsetWidth})}}class iL extends cl{constructor(e){super(e),this.handleSegClick=(t,s)=>{let{component:i}=this,{context:l}=i,c=tl(s);if(c&&i.isValidSegDownEl(t.target)){let u=bs(t.target,".fc-event-forced-url"),h=u?u.querySelector("a[href]").href:"";l.emitter.trigger("eventClick",{el:s,event:new Tt(i.context,c.eventRange.def,c.eventRange.instance),jsEvent:t,view:l.viewApi}),h&&!t.defaultPrevented&&(window.location.href=h)}},this.destroy=xA(e.el,"click",".fc-event",this.handleSegClick)}}class rL extends cl{constructor(e){super(e),this.handleEventElRemove=t=>{t===this.currentSegEl&&this.handleSegLeave(null,this.currentSegEl)},this.handleSegEnter=(t,s)=>{tl(s)&&(this.currentSegEl=s,this.triggerEvent("eventMouseEnter",t,s))},this.handleSegLeave=(t,s)=>{this.currentSegEl&&(this.currentSegEl=null,this.triggerEvent("eventMouseLeave",t,s))},this.removeHoverListeners=TR(e.el,".fc-event",this.handleSegEnter,this.handleSegLeave)}destroy(){this.removeHoverListeners()}triggerEvent(e,t,s){let{component:i}=this,{context:l}=i,c=tl(s);(!t||i.isValidSegDownEl(t.target))&&l.emitter.trigger(e,{el:s,event:new Tt(l,c.eventRange.def,c.eventRange.instance),jsEvent:t,view:l.viewApi})}}class lL extends Qi{constructor(){super(...arguments),this.buildViewContext=lt(Pk),this.buildViewPropTransformers=lt(cL),this.buildToolbarProps=lt(oL),this.headerRef=ya(),this.footerRef=ya(),this.interactionsStore={},this.state={viewLabelId:Eu()},this.registerInteractiveComponent=(e,t)=>{let s=IM(e,t),c=[iL,rL].concat(this.props.pluginHooks.componentInteractions).map(u=>new u(s));this.interactionsStore[e.uid]=c,hp[e.uid]=s},this.unregisterInteractiveComponent=e=>{let t=this.interactionsStore[e.uid];if(t){for(let s of t)s.destroy();delete this.interactionsStore[e.uid]}delete hp[e.uid]},this.resizeRunner=new Kp(()=>{this.props.emitter.trigger("_resize",!0),this.props.emitter.trigger("windowResize",{view:this.props.viewApi})}),this.handleWindowResize=e=>{let{options:t}=this.props;t.handleWindowResize&&e.target===window&&this.resizeRunner.request(t.windowResizeDelay)}}render(){let{props:e}=this,{toolbarConfig:t,options:s}=e,i=!1,l="",c;e.isHeightAuto||e.forPrint?l="":s.height!=null?i=!0:s.contentHeight!=null?l=s.contentHeight:c=Math.max(s.aspectRatio,.5);let u=this.buildViewContext(e.viewSpec,e.viewApi,e.options,e.dateProfileGenerator,e.dateEnv,e.nowManager,e.theme,e.pluginHooks,e.dispatch,e.getCurrentData,e.emitter,e.calendarApi,this.registerInteractiveComponent,this.unregisterInteractiveComponent),h=t.header&&t.header.hasTitle?this.state.viewLabelId:void 0;return ie(Xi.Provider,{value:u},ie(Ru,{unit:"day"},m=>{let p=this.buildToolbarProps(e.viewSpec,e.dateProfile,e.dateProfileGenerator,e.currentDate,m,e.viewTitle);return ie(It,null,t.header&&ie(rw,Object.assign({ref:this.headerRef,extraClassName:"fc-header-toolbar",model:t.header,titleId:h},p)),ie(aL,{liquid:i,height:l,aspectRatio:c,labeledById:h},this.renderView(e),this.buildAppendContent()),t.footer&&ie(rw,Object.assign({ref:this.footerRef,extraClassName:"fc-footer-toolbar",model:t.footer,titleId:""},p)))}))}componentDidMount(){let{props:e}=this;this.calendarInteractions=e.pluginHooks.calendarInteractions.map(s=>new s(e)),window.addEventListener("resize",this.handleWindowResize);let{propSetHandlers:t}=e.pluginHooks;for(let s in t)t[s](e[s],e)}componentDidUpdate(e){let{props:t}=this,{propSetHandlers:s}=t.pluginHooks;for(let i in s)t[i]!==e[i]&&s[i](t[i],t)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),this.resizeRunner.clear();for(let e of this.calendarInteractions)e.destroy();this.props.emitter.trigger("_unmount")}buildAppendContent(){let{props:e}=this,t=e.pluginHooks.viewContainerAppends.map(s=>s(e));return ie(It,{},...t)}renderView(e){let{pluginHooks:t}=e,{viewSpec:s}=e,i={dateProfile:e.dateProfile,businessHours:e.businessHours,eventStore:e.renderableEventStore,eventUiBases:e.eventUiBases,dateSelection:e.dateSelection,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,isHeightAuto:e.isHeightAuto,forPrint:e.forPrint},l=this.buildViewPropTransformers(t.viewPropsTransformers);for(let u of l)Object.assign(i,u.transform(i,e));let c=s.component;return ie(c,Object.assign({},i))}}function oL(n,e,t,s,i,l){let c=t.build(i,void 0,!1),u=t.buildPrev(e,s,!1),h=t.buildNext(e,s,!1);return{title:l,activeButton:n.type,navUnit:n.singleUnit,isTodayEnabled:c.isValid&&!Za(e.currentRange,i),isPrevEnabled:u.isValid,isNextEnabled:h.isValid}}function cL(n){return n.map(e=>new e)}class dL extends HM{constructor(e,t={}){super(),this.isRendering=!1,this.isRendered=!1,this.currentClassNames=[],this.customContentRenderId=0,this.handleAction=s=>{switch(s.type){case"SET_EVENT_DRAG":case"SET_EVENT_RESIZE":this.renderRunner.tryDrain()}},this.handleData=s=>{this.currentData=s,this.renderRunner.request(s.calendarOptions.rerenderDelay)},this.handleRenderRequest=()=>{if(this.isRendering){this.isRendered=!0;let{currentData:s}=this;su(()=>{Mo(ie(PM,{options:s.calendarOptions,theme:s.theme,emitter:s.emitter},(i,l,c,u)=>(this.setClassNames(i),this.setHeight(l),ie(jA.Provider,{value:this.customContentRenderId},ie(lL,Object.assign({isHeightAuto:c,forPrint:u},s))))),this.el)})}else this.isRendered&&(this.isRendered=!1,Mo(null,this.el),this.setClassNames([]),this.setHeight(""))},vR(e),this.el=e,this.renderRunner=new Kp(this.handleRenderRequest),new W3({optionOverrides:t,calendarApi:this,onAction:this.handleAction,onData:this.handleData})}render(){let e=this.isRendering;e?this.customContentRenderId+=1:this.isRendering=!0,this.renderRunner.request(),e&&this.updateSize()}destroy(){this.isRendering&&(this.isRendering=!1,this.renderRunner.request())}updateSize(){su(()=>{super.updateSize()})}batchRendering(e){this.renderRunner.pause("batchRendering"),e(),this.renderRunner.resume("batchRendering")}pauseRendering(){this.renderRunner.pause("pauseRendering")}resumeRendering(){this.renderRunner.resume("pauseRendering",!0)}resetOptions(e,t){this.currentDataManager.resetOptions(e,t)}setClassNames(e){if(!ei(e,this.currentClassNames)){let{classList:t}=this.el;for(let s of this.currentClassNames)t.remove(s);for(let s of e)t.add(s);this.currentClassNames=e}}setHeight(e){pA(this.el,"height",e)}}const uL=parseInt(String(Eo.version).split(".")[0]),hL=uL<18;class pN extends _.Component{constructor(){super(...arguments),this.elRef=_.createRef(),this.isUpdating=!1,this.isUnmounting=!1,this.state={customRenderingMap:new Map},this.requestResize=()=>{this.isUnmounting||(this.cancelResize(),this.resizeId=requestAnimationFrame(()=>{this.doResize()}))}}render(){const e=[];for(const t of this.state.customRenderingMap.values())e.push(Eo.createElement(fL,{key:t.id,customRendering:t}));return Eo.createElement("div",{ref:this.elRef},e)}componentDidMount(){this.isUnmounting=!1;const e=new W4;this.handleCustomRendering=e.handle.bind(e),this.calendar=new dL(this.elRef.current,Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.calendar.render(),this.calendar.on("_beforeprint",()=>{zm.flushSync(()=>{})});let t;e.subscribe(s=>{const i=Date.now(),l=!t;(hL||l||this.isUpdating||this.isUnmounting||i-t<100?gN:zm.flushSync)(()=>{this.setState({customRenderingMap:s},()=>{t=i,l?this.doResize():this.requestResize()})})})}componentDidUpdate(){this.isUpdating=!0,this.calendar.resetOptions(Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.isUpdating=!1}componentWillUnmount(){this.isUnmounting=!0,this.cancelResize(),this.calendar.destroy()}doResize(){this.calendar.updateSize()}cancelResize(){this.resizeId!==void 0&&(cancelAnimationFrame(this.resizeId),this.resizeId=void 0)}getApi(){return this.calendar}}pN.act=gN;class fL extends _.PureComponent{render(){const{customRendering:e}=this.props,{generatorMeta:t}=e,s=typeof t=="function"?t(e.renderProps):t;return zm.createPortal(s,e.containerEl)}}function gN(n){n()}class mL extends Zi{constructor(){super(...arguments),this.headerElRef=ya()}renderSimpleLayout(e,t){let{props:s,context:i}=this,l=[],c=Zv(i.options);return e&&l.push({type:"header",key:"header",isSticky:c,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),l.push({type:"body",key:"body",liquid:!0,chunk:{content:t}}),ie(zv,{elClasses:["fc-daygrid"],viewSpec:i.viewSpec},ie(sN,{liquid:!s.isHeightAuto&&!s.forPrint,collapsibleWidth:s.forPrint,cols:[],sections:l}))}renderHScrollLayout(e,t,s,i){let l=this.context.pluginHooks.scrollGridImpl;if(!l)throw new Error("No ScrollGrid implementation");let{props:c,context:u}=this,h=!c.forPrint&&Zv(u.options),m=!c.forPrint&&T4(u.options),p=[];return e&&p.push({type:"header",key:"header",isSticky:h,chunks:[{key:"main",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),p.push({type:"body",key:"body",liquid:!0,chunks:[{key:"main",content:t}]}),m&&p.push({type:"footer",key:"footer",isSticky:!0,chunks:[{key:"main",content:C4}]}),ie(zv,{elClasses:["fc-daygrid"],viewSpec:u.viewSpec},ie(l,{liquid:!c.isHeightAuto&&!c.forPrint,forPrint:c.forPrint,collapsibleWidth:c.forPrint,colGroups:[{cols:[{span:s,minWidth:i}]}],sections:p}))}}function Bd(n,e){let t=[];for(let s=0;s<e;s+=1)t[s]=[];for(let s of n)t[s.row].push(s);return t}function Sd(n,e){let t=[];for(let s=0;s<e;s+=1)t[s]=[];for(let s of n)t[s.firstCol].push(s);return t}function lw(n,e){let t=[];if(n){for(let s=0;s<e;s+=1)t[s]={affectedInstances:n.affectedInstances,isEvent:n.isEvent,segs:[]};for(let s of n.segs)t[s.row].segs.push(s)}else for(let s=0;s<e;s+=1)t[s]=null;return t}const xN=is({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"narrow"});function yN(n){let{display:e}=n.eventRange.ui;return e==="list-item"||e==="auto"&&!n.eventRange.def.allDay&&n.firstCol===n.lastCol&&n.isStart&&n.isEnd}class bN extends Lt{render(){let{props:e}=this;return ie(nN,Object.assign({},e,{elClasses:["fc-daygrid-event","fc-daygrid-block-event","fc-h-event"],defaultTimeFormat:xN,defaultDisplayEventEnd:e.defaultDisplayEventEnd,disableResizing:!e.seg.eventRange.def.allDay}))}}class vN extends Lt{render(){let{props:e,context:t}=this,{options:s}=t,{seg:i}=e,l=s.eventTimeFormat||xN,c=zA(i,l,t,!0,e.defaultDisplayEventEnd);return ie(vg,Object.assign({},e,{elTag:"a",elClasses:["fc-daygrid-event","fc-daygrid-dot-event"],elAttrs:FA(e.seg,t),defaultGenerator:pL,timeText:c,isResizing:!1,isDateSelecting:!1}))}}function pL(n){return ie(It,null,ie("div",{className:"fc-daygrid-event-dot",style:{borderColor:n.borderColor||n.backgroundColor}}),n.timeText&&ie("div",{className:"fc-event-time"},n.timeText),ie("div",{className:"fc-event-title"},n.event.title||ie(It,null," ")))}class gL extends Lt{constructor(){super(...arguments),this.compileSegs=lt(xL)}render(){let{props:e}=this,{allSegs:t,invisibleSegs:s}=this.compileSegs(e.singlePlacements);return ie(F4,{elClasses:["fc-daygrid-more-link"],dateProfile:e.dateProfile,todayRange:e.todayRange,allDayDate:e.allDayDate,moreCnt:e.moreCnt,allSegs:t,hiddenSegs:s,alignmentElRef:e.alignmentElRef,alignGridTop:e.alignGridTop,extraDateSpan:e.extraDateSpan,popoverContent:()=>{let i=(e.eventDrag?e.eventDrag.affectedInstances:null)||(e.eventResize?e.eventResize.affectedInstances:null)||{};return ie(It,null,t.map(l=>{let c=l.eventRange.instance.instanceId;return ie("div",{className:"fc-daygrid-event-harness",key:c,style:{visibility:i[c]?"hidden":""}},yN(l)?ie(vN,Object.assign({seg:l,isDragging:!1,isSelected:c===e.eventSelection,defaultDisplayEventEnd:!1},So(l,e.todayRange))):ie(bN,Object.assign({seg:l,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:c===e.eventSelection,defaultDisplayEventEnd:!1},So(l,e.todayRange))))}))}})}}function xL(n){let e=[],t=[];for(let s of n)e.push(s.seg),s.isVisible||t.push(s.seg);return{allSegs:e,invisibleSegs:t}}const yL=is({week:"narrow"});class bL extends Zi{constructor(){super(...arguments),this.rootElRef=ya(),this.state={dayNumberId:Eu()},this.handleRootEl=e=>{Xn(this.rootElRef,e),Xn(this.props.elRef,e)}}render(){let{context:e,props:t,state:s,rootElRef:i}=this,{options:l,dateEnv:c}=e,{date:u,dateProfile:h}=t;const m=t.showDayNumber&&wL(u,h.currentRange,c);return ie(aN,{elTag:"td",elRef:this.handleRootEl,elClasses:["fc-daygrid-day",...t.extraClassNames||[]],elAttrs:Object.assign(Object.assign(Object.assign({},t.extraDataAttrs),t.showDayNumber?{"aria-labelledby":s.dayNumberId}:{}),{role:"gridcell"}),defaultGenerator:vL,date:u,dateProfile:h,todayRange:t.todayRange,showDayNumber:t.showDayNumber,isMonthStart:m,extraRenderProps:t.extraRenderProps},(p,x)=>ie("div",{ref:t.innerElRef,className:"fc-daygrid-day-frame fc-scrollgrid-sync-inner",style:{minHeight:t.minHeight}},t.showWeekNumber&&ie(I4,{elTag:"a",elClasses:["fc-daygrid-week-number"],elAttrs:fp(e,u,"week"),date:u,defaultFormat:yL}),!x.isDisabled&&(t.showDayNumber||iN(l)||t.forceDayTop)?ie("div",{className:"fc-daygrid-day-top"},ie(p,{elTag:"a",elClasses:["fc-daygrid-day-number",m&&"fc-daygrid-month-start"],elAttrs:Object.assign(Object.assign({},fp(e,u)),{id:s.dayNumberId})})):t.showDayNumber?ie("div",{className:"fc-daygrid-day-top",style:{visibility:"hidden"}},ie("a",{className:"fc-daygrid-day-number"}," ")):void 0,ie("div",{className:"fc-daygrid-day-events",ref:t.fgContentElRef},t.fgContent,ie("div",{className:"fc-daygrid-day-bottom",style:{marginTop:t.moreMarginTop}},ie(gL,{allDayDate:u,singlePlacements:t.singlePlacements,moreCnt:t.moreCnt,alignmentElRef:i,alignGridTop:!t.showDayNumber,extraDateSpan:t.extraDateSpan,dateProfile:t.dateProfile,eventSelection:t.eventSelection,eventDrag:t.eventDrag,eventResize:t.eventResize,todayRange:t.todayRange}))),ie("div",{className:"fc-daygrid-day-bg"},t.bgContent)))}}function vL(n){return n.dayNumberText||ie(It,null," ")}function wL(n,e,t){const{start:s,end:i}=e,l=ti(i,-1),c=t.getYear(s),u=t.getMonth(s),h=t.getYear(l),m=t.getMonth(l);return!(c===h&&u===m)&&(n.valueOf()===s.valueOf()||t.getDay(n)===1&&n.valueOf()<i.valueOf())}function wN(n){return n.eventRange.instance.instanceId+":"+n.firstCol}function AN(n){return wN(n)+":"+n.lastCol}function AL(n,e,t,s,i,l,c){let u=new jL(S=>{let E=n[S.index].eventRange.instance.instanceId+":"+S.span.start+":"+(S.span.end-1);return i[E]||1});u.allowReslicing=!0,u.strictOrder=s,e===!0||t===!0?(u.maxCoord=l,u.hiddenConsumes=!0):typeof e=="number"?u.maxStackCnt=e:typeof t=="number"&&(u.maxStackCnt=t,u.hiddenConsumes=!0);let h=[],m=[];for(let S=0;S<n.length;S+=1){let E=n[S],C=AN(E);i[C]!=null?h.push({index:S,span:{start:E.firstCol,end:E.lastCol+1}}):m.push(E)}let p=u.addSegs(h),x=u.toRects(),{singleColPlacements:y,multiColPlacements:v,leftoverMargins:w}=NL(x,n,c),A=[],N=[];for(let S of m){v[S.firstCol].push({seg:S,isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let E=S.firstCol;E<=S.lastCol;E+=1)y[E].push({seg:Xr(S,E,E+1,c),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let S=0;S<c.length;S+=1)A.push(0);for(let S of p){let E=n[S.index],C=S.span;v[C.start].push({seg:Xr(E,C.start,C.end,c),isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let R=C.start;R<C.end;R+=1)A[R]+=1,y[R].push({seg:Xr(E,R,R+1,c),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let S=0;S<c.length;S+=1)N.push(w[S]);return{singleColPlacements:y,multiColPlacements:v,moreCnts:A,moreMarginTops:N}}function NL(n,e,t){let s=SL(n,t.length),i=[],l=[],c=[];for(let u=0;u<t.length;u+=1){let h=s[u],m=[],p=0,x=0;for(let v of h){let w=e[v.index];m.push({seg:Xr(w,u,u+1,t),isVisible:!0,isAbsolute:!1,absoluteTop:v.levelCoord,marginTop:v.levelCoord-p}),p=v.levelCoord+v.thickness}let y=[];p=0,x=0;for(let v of h){let w=e[v.index],A=v.span.end-v.span.start>1,N=v.span.start===u;x+=v.levelCoord-p,p=v.levelCoord+v.thickness,A?(x+=v.thickness,N&&y.push({seg:Xr(w,v.span.start,v.span.end,t),isVisible:!0,isAbsolute:!0,absoluteTop:v.levelCoord,marginTop:0})):N&&(y.push({seg:Xr(w,v.span.start,v.span.end,t),isVisible:!0,isAbsolute:!1,absoluteTop:v.levelCoord,marginTop:x}),x=0)}i.push(m),l.push(y),c.push(x)}return{singleColPlacements:i,multiColPlacements:l,leftoverMargins:c}}function SL(n,e){let t=[];for(let s=0;s<e;s+=1)t.push([]);for(let s of n)for(let i=s.span.start;i<s.span.end;i+=1)t[i].push(s);return t}function Xr(n,e,t,s){if(n.firstCol===e&&n.lastCol===t-1)return n;let i=n.eventRange,l=i.range,c=el(l,{start:s[e].date,end:rs(s[t-1].date,1)});return Object.assign(Object.assign({},n),{firstCol:e,lastCol:t-1,eventRange:{def:i.def,ui:Object.assign(Object.assign({},i.ui),{durationEditable:!1}),instance:i.instance,range:c},isStart:n.isStart&&c.start.valueOf()===l.start.valueOf(),isEnd:n.isEnd&&c.end.valueOf()===l.end.valueOf()})}class jL extends t4{constructor(){super(...arguments),this.hiddenConsumes=!1,this.forceHidden={}}addSegs(e){const t=super.addSegs(e),{entriesByLevel:s}=this,i=l=>!this.forceHidden[jo(l)];for(let l=0;l<s.length;l+=1)s[l]=s[l].filter(i);return t}handleInvalidInsertion(e,t,s){const{entriesByLevel:i,forceHidden:l}=this,{touchingEntry:c,touchingLevel:u,touchingLateral:h}=e;if(this.hiddenConsumes&&c){const m=jo(c);if(!l[m])if(this.allowReslicing){const p=Object.assign(Object.assign({},c),{span:XA(c.span,t.span)}),x=jo(p);l[x]=!0,i[u][h]=p,s.push(p),this.splitEntry(c,t,s)}else l[m]=!0,s.push(c)}super.handleInvalidInsertion(e,t,s)}}class NN extends Zi{constructor(){super(...arguments),this.cellElRefs=new ki,this.frameElRefs=new ki,this.fgElRefs=new ki,this.segHarnessRefs=new ki,this.rootElRef=ya(),this.state={framePositions:null,maxContentHeight:null,segHeights:{}},this.handleResize=e=>{e&&this.updateSizing(!0)}}render(){let{props:e,state:t,context:s}=this,{options:i}=s,l=e.cells.length,c=Sd(e.businessHourSegs,l),u=Sd(e.bgEventSegs,l),h=Sd(this.getHighlightSegs(),l),m=Sd(this.getMirrorSegs(),l),{singleColPlacements:p,multiColPlacements:x,moreCnts:y,moreMarginTops:v}=AL(bM(e.fgEventSegs,i.eventOrder),e.dayMaxEvents,e.dayMaxEventRows,i.eventOrderStrict,t.segHeights,t.maxContentHeight,e.cells),w=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{};return ie("tr",{ref:this.rootElRef,role:"row"},e.renderIntro&&e.renderIntro(),e.cells.map((A,N)=>{let S=this.renderFgSegs(N,e.forPrint?p[N]:x[N],e.todayRange,w),E=this.renderFgSegs(N,EL(m[N],x),e.todayRange,{},!!e.eventDrag,!!e.eventResize,!1);return ie(bL,{key:A.key,elRef:this.cellElRefs.createRef(A.key),innerElRef:this.frameElRefs.createRef(A.key),dateProfile:e.dateProfile,date:A.date,showDayNumber:e.showDayNumbers,showWeekNumber:e.showWeekNumbers&&N===0,forceDayTop:e.showWeekNumbers,todayRange:e.todayRange,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,extraRenderProps:A.extraRenderProps,extraDataAttrs:A.extraDataAttrs,extraClassNames:A.extraClassNames,extraDateSpan:A.extraDateSpan,moreCnt:y[N],moreMarginTop:v[N],singlePlacements:p[N],fgContentElRef:this.fgElRefs.createRef(A.key),fgContent:ie(It,null,ie(It,null,S),ie(It,null,E)),bgContent:ie(It,null,this.renderFillSegs(h[N],"highlight"),this.renderFillSegs(c[N],"non-business"),this.renderFillSegs(u[N],"bg-event")),minHeight:e.cellMinHeight})}))}componentDidMount(){this.updateSizing(!0),this.context.addResizeHandler(this.handleResize)}componentDidUpdate(e,t){let s=this.props;this.updateSizing(!Cn(e,s))}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}getHighlightSegs(){let{props:e}=this;return e.eventDrag&&e.eventDrag.segs.length?e.eventDrag.segs:e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:e.dateSelectionSegs}getMirrorSegs(){let{props:e}=this;return e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:[]}renderFgSegs(e,t,s,i,l,c,u){let{context:h}=this,{eventSelection:m}=this.props,{framePositions:p}=this.state,x=this.props.cells.length===1,y=l||c||u,v=[];if(p)for(let w of t){let{seg:A}=w,{instanceId:N}=A.eventRange.instance,S=w.isVisible&&!i[N],E=w.isAbsolute,C="",R="";E&&(h.isRtl?(R=0,C=p.lefts[A.lastCol]-p.lefts[A.firstCol]):(C=0,R=p.rights[A.firstCol]-p.rights[A.lastCol])),v.push(ie("div",{className:"fc-daygrid-event-harness"+(E?" fc-daygrid-event-harness-abs":""),key:wN(A),ref:y?null:this.segHarnessRefs.createRef(AN(A)),style:{visibility:S?"":"hidden",marginTop:E?"":w.marginTop,top:E?w.absoluteTop:"",left:C,right:R}},yN(A)?ie(vN,Object.assign({seg:A,isDragging:l,isSelected:N===m,defaultDisplayEventEnd:x},So(A,s))):ie(bN,Object.assign({seg:A,isDragging:l,isResizing:c,isDateSelecting:u,isSelected:N===m,defaultDisplayEventEnd:x},So(A,s)))))}return v}renderFillSegs(e,t){let{isRtl:s}=this.context,{todayRange:i}=this.props,{framePositions:l}=this.state,c=[];if(l)for(let u of e){let h=s?{right:0,left:l.lefts[u.lastCol]-l.lefts[u.firstCol]}:{left:0,right:l.rights[u.firstCol]-l.rights[u.lastCol]};c.push(ie("div",{key:jM(u.eventRange),className:"fc-daygrid-bg-harness",style:h},t==="bg-event"?ie(L4,Object.assign({seg:u},So(u,i))):P4(t)))}return ie(It,{},...c)}updateSizing(e){let{props:t,state:s,frameElRefs:i}=this;if(!t.forPrint&&t.clientWidth!==null){if(e){let h=t.cells.map(m=>i.currentMap[m.key]);if(h.length){let m=this.rootElRef.current,p=new ru(m,h,!0,!1);(!s.framePositions||!s.framePositions.similarTo(p))&&this.setState({framePositions:new ru(m,h,!0,!1)})}}const l=this.state.segHeights,c=this.querySegHeights(),u=t.dayMaxEvents===!0||t.dayMaxEventRows===!0;this.safeSetState({segHeights:Object.assign(Object.assign({},l),c),maxContentHeight:u?this.computeMaxContentHeight():null})}}querySegHeights(){let e=this.segHarnessRefs.currentMap,t={};for(let s in e){let i=Math.round(e[s].getBoundingClientRect().height);t[s]=Math.max(t[s]||0,i)}return t}computeMaxContentHeight(){let e=this.props.cells[0].key,t=this.cellElRefs.currentMap[e],s=this.fgElRefs.currentMap[e];return t.getBoundingClientRect().bottom-s.getBoundingClientRect().top}getCellEls(){let e=this.cellElRefs.currentMap;return this.props.cells.map(t=>e[t.key])}}NN.addStateEquality({segHeights:Cn});function EL(n,e){if(!n.length)return[];let t=_L(e);return n.map(s=>({seg:s,isVisible:!0,isAbsolute:!0,absoluteTop:t[s.eventRange.instance.instanceId],marginTop:0}))}function _L(n){let e={};for(let t of n)for(let s of t)e[s.seg.eventRange.instance.instanceId]=s.absoluteTop;return e}class CL extends Zi{constructor(){super(...arguments),this.splitBusinessHourSegs=lt(Bd),this.splitBgEventSegs=lt(TL),this.splitFgEventSegs=lt(Bd),this.splitDateSelectionSegs=lt(Bd),this.splitEventDrag=lt(lw),this.splitEventResize=lt(lw),this.rowRefs=new ki}render(){let{props:e,context:t}=this,s=e.cells.length,i=this.splitBusinessHourSegs(e.businessHourSegs,s),l=this.splitBgEventSegs(e.bgEventSegs,s),c=this.splitFgEventSegs(e.fgEventSegs,s),u=this.splitDateSelectionSegs(e.dateSelectionSegs,s),h=this.splitEventDrag(e.eventDrag,s),m=this.splitEventResize(e.eventResize,s),p=s>=7&&e.clientWidth?e.clientWidth/t.options.aspectRatio/6:null;return ie(Ru,{unit:"day"},(x,y)=>ie(It,null,e.cells.map((v,w)=>ie(NN,{ref:this.rowRefs.createRef(w),key:v.length?v[0].date.toISOString():w,showDayNumbers:s>1,showWeekNumbers:e.showWeekNumbers,todayRange:y,dateProfile:e.dateProfile,cells:v,renderIntro:e.renderRowIntro,businessHourSegs:i[w],eventSelection:e.eventSelection,bgEventSegs:l[w],fgEventSegs:c[w],dateSelectionSegs:u[w],eventDrag:h[w],eventResize:m[w],dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,clientWidth:e.clientWidth,clientHeight:e.clientHeight,cellMinHeight:p,forPrint:e.forPrint}))))}componentDidMount(){this.registerInteractiveComponent()}componentDidUpdate(){this.registerInteractiveComponent()}registerInteractiveComponent(){if(!this.rootEl){const e=this.rowRefs.currentMap[0].getCellEls()[0],t=e?e.closest(".fc-daygrid-body"):null;t&&(this.rootEl=t,this.context.registerInteractiveComponent(this,{el:t,isHitComboAllowed:this.props.isHitComboAllowed}))}}componentWillUnmount(){this.rootEl&&(this.context.unregisterInteractiveComponent(this),this.rootEl=null)}prepareHits(){this.rowPositions=new ru(this.rootEl,this.rowRefs.collect().map(e=>e.getCellEls()[0]),!1,!0),this.colPositions=new ru(this.rootEl,this.rowRefs.currentMap[0].getCellEls(),!0,!1)}queryHit(e,t){let{colPositions:s,rowPositions:i}=this,l=s.leftToIndex(e),c=i.topToIndex(t);if(c!=null&&l!=null){let u=this.props.cells[c][l];return{dateProfile:this.props.dateProfile,dateSpan:Object.assign({range:this.getCellRange(c,l),allDay:!0},u.extraDateSpan),dayEl:this.getCellEl(c,l),rect:{left:s.lefts[l],right:s.rights[l],top:i.tops[c],bottom:i.bottoms[c]},layer:0}}return null}getCellEl(e,t){return this.rowRefs.currentMap[e].getCellEls()[t]}getCellRange(e,t){let s=this.props.cells[e][t].date,i=rs(s,1);return{start:s,end:i}}}function TL(n,e){return Bd(n.filter(DL),e)}function DL(n){return n.eventRange.def.allDay}class RL extends Zi{constructor(){super(...arguments),this.elRef=ya(),this.needsScrollReset=!1}render(){let{props:e}=this,{dayMaxEventRows:t,dayMaxEvents:s,expandRows:i}=e,l=s===!0||t===!0;l&&!i&&(l=!1,t=null,s=null);let c=["fc-daygrid-body",l?"fc-daygrid-body-balanced":"fc-daygrid-body-unbalanced",i?"":"fc-daygrid-body-natural"];return ie("div",{ref:this.elRef,className:c.join(" "),style:{width:e.clientWidth,minWidth:e.tableMinWidth}},ie("table",{role:"presentation",className:"fc-scrollgrid-sync-table",style:{width:e.clientWidth,minWidth:e.tableMinWidth,height:i?e.clientHeight:""}},e.colGroupNode,ie("tbody",{role:"presentation"},ie(CL,{dateProfile:e.dateProfile,cells:e.cells,renderRowIntro:e.renderRowIntro,showWeekNumbers:e.showWeekNumbers,clientWidth:e.clientWidth,clientHeight:e.clientHeight,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,dayMaxEvents:s,dayMaxEventRows:t,forPrint:e.forPrint,isHitComboAllowed:e.isHitComboAllowed}))))}componentDidMount(){this.requestScrollReset()}componentDidUpdate(e){e.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&this.props.clientWidth){const e=kL(this.elRef.current,this.props.dateProfile);if(e){const t=e.closest(".fc-daygrid-body"),s=t.closest(".fc-scroller"),i=e.getBoundingClientRect().top-t.getBoundingClientRect().top;s.scrollTop=i?i+1:0}this.needsScrollReset=!1}}}function kL(n,e){let t;return e.currentRangeUnit.match(/year|month/)&&(t=n.querySelector(`[data-date="${rk(e.currentDate)}-01"]`)),t||(t=n.querySelector(`[data-date="${sg(e.currentDate)}"]`)),t}class ML extends u4{constructor(){super(...arguments),this.forceDayIfListItem=!0}sliceRange(e,t){return t.sliceRange(e)}}class LL extends Zi{constructor(){super(...arguments),this.slicer=new ML,this.tableRef=ya()}render(){let{props:e,context:t}=this;return ie(RL,Object.assign({ref:this.tableRef},this.slicer.sliceProps(e,e.dateProfile,e.nextDayThreshold,t,e.dayTableModel),{dateProfile:e.dateProfile,cells:e.dayTableModel.cells,colGroupNode:e.colGroupNode,tableMinWidth:e.tableMinWidth,renderRowIntro:e.renderRowIntro,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.showWeekNumbers,expandRows:e.expandRows,headerAlignElRef:e.headerAlignElRef,clientWidth:e.clientWidth,clientHeight:e.clientHeight,forPrint:e.forPrint}))}}class OL extends mL{constructor(){super(...arguments),this.buildDayTableModel=lt(PL),this.headerRef=ya(),this.tableRef=ya()}render(){let{options:e,dateProfileGenerator:t}=this.context,{props:s}=this,i=this.buildDayTableModel(s.dateProfile,t),l=e.dayHeaders&&ie(l4,{ref:this.headerRef,dateProfile:s.dateProfile,dates:i.headerDates,datesRepDistinctDays:i.rowCnt===1}),c=u=>ie(LL,{ref:this.tableRef,dateProfile:s.dateProfile,dayTableModel:i,businessHours:s.businessHours,dateSelection:s.dateSelection,eventStore:s.eventStore,eventUiBases:s.eventUiBases,eventSelection:s.eventSelection,eventDrag:s.eventDrag,eventResize:s.eventResize,nextDayThreshold:e.nextDayThreshold,colGroupNode:u.tableColGroupNode,tableMinWidth:u.tableMinWidth,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.weekNumbers,expandRows:!s.isHeightAuto,headerAlignElRef:this.headerElRef,clientWidth:u.clientWidth,clientHeight:u.clientHeight,forPrint:s.forPrint});return e.dayMinWidth?this.renderHScrollLayout(l,c,i.colCnt,e.dayMinWidth):this.renderSimpleLayout(l,c)}}function PL(n,e){let t=new c4(n.renderRange,e);return new d4(t,/year|month|week/.test(n.currentRangeUnit))}class IL extends TA{buildRenderRange(e,t,s){let i=super.buildRenderRange(e,t,s),{props:l}=this;return BL({currentRange:i,snapToWeek:/^(year|month)$/.test(t),fixedWeekCount:l.fixedWeekCount,dateEnv:l.dateEnv})}}function BL(n){let{dateEnv:e,currentRange:t}=n,{start:s,end:i}=t,l;if(n.snapToWeek&&(s=e.startOfWeek(s),l=e.startOfWeek(i),l.valueOf()!==i.valueOf()&&(i=kv(l,1))),n.fixedWeekCount){let c=e.startOfWeek(e.startOfMonth(rs(t.end,-1))),u=Math.ceil(WR(c,i));i=kv(i,6-u)}return{start:s,end:i}}var HL=':root{--fc-daygrid-event-dot-width:8px}.fc-daygrid-day-events:after,.fc-daygrid-day-events:before,.fc-daygrid-day-frame:after,.fc-daygrid-day-frame:before,.fc-daygrid-event-harness:after,.fc-daygrid-event-harness:before{clear:both;content:"";display:table}.fc .fc-daygrid-body{position:relative;z-index:1}.fc .fc-daygrid-day.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-daygrid-day-frame{min-height:100%;position:relative}.fc .fc-daygrid-day-top{display:flex;flex-direction:row-reverse}.fc .fc-day-other .fc-daygrid-day-top{opacity:.3}.fc .fc-daygrid-day-number{padding:4px;position:relative;z-index:4}.fc .fc-daygrid-month-start{font-size:1.1em;font-weight:700}.fc .fc-daygrid-day-events{margin-top:1px}.fc .fc-daygrid-body-balanced .fc-daygrid-day-events{left:0;position:absolute;right:0}.fc .fc-daygrid-body-unbalanced .fc-daygrid-day-events{min-height:2em;position:relative}.fc .fc-daygrid-body-natural .fc-daygrid-day-events{margin-bottom:1em}.fc .fc-daygrid-event-harness{position:relative}.fc .fc-daygrid-event-harness-abs{left:0;position:absolute;right:0;top:0}.fc .fc-daygrid-bg-harness{bottom:0;position:absolute;top:0}.fc .fc-daygrid-day-bg .fc-non-business{z-index:1}.fc .fc-daygrid-day-bg .fc-bg-event{z-index:2}.fc .fc-daygrid-day-bg .fc-highlight{z-index:3}.fc .fc-daygrid-event{margin-top:1px;z-index:6}.fc .fc-daygrid-event.fc-event-mirror{z-index:7}.fc .fc-daygrid-day-bottom{font-size:.85em;margin:0 2px}.fc .fc-daygrid-day-bottom:after,.fc .fc-daygrid-day-bottom:before{clear:both;content:"";display:table}.fc .fc-daygrid-more-link{border-radius:3px;cursor:pointer;line-height:1;margin-top:1px;max-width:100%;overflow:hidden;padding:2px;position:relative;white-space:nowrap;z-index:4}.fc .fc-daygrid-more-link:hover{background-color:rgba(0,0,0,.1)}.fc .fc-daygrid-week-number{background-color:var(--fc-neutral-bg-color);color:var(--fc-neutral-text-color);min-width:1.5em;padding:2px;position:absolute;text-align:center;top:0;z-index:5}.fc .fc-more-popover .fc-popover-body{min-width:220px;padding:10px}.fc-direction-ltr .fc-daygrid-event.fc-event-start,.fc-direction-rtl .fc-daygrid-event.fc-event-end{margin-left:2px}.fc-direction-ltr .fc-daygrid-event.fc-event-end,.fc-direction-rtl .fc-daygrid-event.fc-event-start{margin-right:2px}.fc-direction-ltr .fc-daygrid-more-link{float:left}.fc-direction-ltr .fc-daygrid-week-number{border-radius:0 0 3px 0;left:0}.fc-direction-rtl .fc-daygrid-more-link{float:right}.fc-direction-rtl .fc-daygrid-week-number{border-radius:0 0 0 3px;right:0}.fc-liquid-hack .fc-daygrid-day-frame{position:static}.fc-daygrid-event{border-radius:3px;font-size:var(--fc-small-font-size);position:relative;white-space:nowrap}.fc-daygrid-block-event .fc-event-time{font-weight:700}.fc-daygrid-block-event .fc-event-time,.fc-daygrid-block-event .fc-event-title{padding:1px}.fc-daygrid-dot-event{align-items:center;display:flex;padding:2px 0}.fc-daygrid-dot-event .fc-event-title{flex-grow:1;flex-shrink:1;font-weight:700;min-width:0;overflow:hidden}.fc-daygrid-dot-event.fc-event-mirror,.fc-daygrid-dot-event:hover{background:rgba(0,0,0,.1)}.fc-daygrid-dot-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-daygrid-event-dot{border:calc(var(--fc-daygrid-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-daygrid-event-dot-width)/2);box-sizing:content-box;height:0;margin:0 4px;width:0}.fc-direction-ltr .fc-daygrid-event .fc-event-time{margin-right:3px}.fc-direction-rtl .fc-daygrid-event .fc-event-time{margin-left:3px}';hA(HL);var zL=ni({name:"@fullcalendar/daygrid",initialView:"dayGridMonth",views:{dayGrid:{component:OL,dateProfileGeneratorClass:IL},dayGridDay:{type:"dayGrid",duration:{days:1}},dayGridWeek:{type:"dayGrid",duration:{weeks:1}},dayGridMonth:{type:"dayGrid",duration:{months:1},fixedWeekCount:!0},dayGridYear:{type:"dayGrid",duration:{years:1}}}});bg.touchMouseIgnoreWait=500;let pp=0,lu=0,gp=!1;class SN{constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=t=>{if(!this.shouldIgnoreMouse()&&FL(t)&&this.tryStart(t)){let s=this.createEventFromMouse(t,!0);this.emitter.trigger("pointerdown",s),this.initScrollWatch(s),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=t=>{let s=this.createEventFromMouse(t);this.recordCoords(s),this.emitter.trigger("pointermove",s)},this.handleMouseUp=t=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(t)),this.cleanup()},this.handleTouchStart=t=>{if(this.tryStart(t)){this.isTouchDragging=!0;let s=this.createEventFromTouch(t,!0);this.emitter.trigger("pointerdown",s),this.initScrollWatch(s);let i=t.target;this.shouldIgnoreMove||i.addEventListener("touchmove",this.handleTouchMove),i.addEventListener("touchend",this.handleTouchEnd),i.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=t=>{let s=this.createEventFromTouch(t);this.recordCoords(s),this.emitter.trigger("pointermove",s)},this.handleTouchEnd=t=>{if(this.isDragging){let s=t.target;s.removeEventListener("touchmove",this.handleTouchMove),s.removeEventListener("touchend",this.handleTouchEnd),s.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(t)),this.cleanup(),this.isTouchDragging=!1,UL()}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=t=>{if(!this.shouldIgnoreMove){let s=window.scrollX-this.prevScrollX+this.prevPageX,i=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:t,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:s,pageY:i,deltaX:s-this.origPageX,deltaY:i-this.origPageY})}},this.containerEl=e,this.emitter=new Du,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),qL()}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),VL()}tryStart(e){let t=this.querySubjectEl(e),s=e.target;return t&&(!this.handleSelector||bs(s,this.handleSelector))?(this.subjectEl=t,this.isDragging=!0,this.wasTouchScroll=!1,!0):!1}cleanup(){gp=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?bs(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return pp||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(gp=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,t){let s=0,i=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(s=e.pageX-this.origPageX,i=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:s,deltaY:i}}createEventFromTouch(e,t){let s=e.touches,i,l,c=0,u=0;return s&&s.length?(i=s[0].pageX,l=s[0].pageY):(i=e.pageX,l=e.pageY),t?(this.origPageX=i,this.origPageY=l):(c=i-this.origPageX,u=l-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:i,pageY:l,deltaX:c,deltaY:u}}}function FL(n){return n.button===0&&!n.ctrlKey}function UL(){pp+=1,setTimeout(()=>{pp-=1},bg.touchMouseIgnoreWait)}function qL(){lu+=1,lu===1&&window.addEventListener("touchmove",jN,{passive:!1})}function VL(){lu-=1,lu||window.removeEventListener("touchmove",jN,{passive:!1})}function jN(n){gp&&n.preventDefault()}class $L{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,t,s){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.scrollX,this.origScreenY=s-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,t){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=t-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,t){let s=()=>{this.cleanup(),t()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(s,this.revertDuration):setTimeout(s,0)}doRevertAnimation(e,t){let s=this.mirrorEl,i=this.sourceEl.getBoundingClientRect();s.style.transition="top "+t+"ms,left "+t+"ms",wo(s,{left:i.left,top:i.top}),DR(s,()=>{s.style.transition="",e()})}cleanup(){this.mirrorEl&&(Jp(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&wo(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,t=this.mirrorEl;return t||(t=this.mirrorEl=this.sourceEl.cloneNode(!0),t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.pointerEvents="none",t.classList.add("fc-event-dragging"),wo(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t}}class EN extends yg{constructor(e,t){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=t,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}}class _N extends EN{constructor(e,t){super(new JM(e),t)}getEventTarget(){return this.scrollController.el}computeClientRect(){return ZM(this.scrollController.el)}}class GL extends EN{constructor(e){super(new e4,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}}const ow=typeof performance=="function"?performance.now:Date.now;class YL{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let t=ow();this.handleSide(e,(t-this.msSinceRequest)/1e3),this.requestAnimation(t)}else this.isAnimating=!1}}}start(e,t,s){this.isEnabled&&(this.scrollCaches=this.buildCaches(s),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))}handleMove(e,t){if(this.isEnabled){let s=e-window.scrollX,i=t-window.scrollY,l=this.pointerScreenY===null?0:i-this.pointerScreenY,c=this.pointerScreenX===null?0:s-this.pointerScreenX;l<0?this.everMovedUp=!0:l>0&&(this.everMovedDown=!0),c<0?this.everMovedLeft=!0:c>0&&(this.everMovedRight=!0),this.pointerScreenX=s,this.pointerScreenY=i,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(ow()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,t){let{scrollCache:s}=e,{edgeThreshold:i}=this,l=i-e.distance,c=l*l/(i*i)*this.maxVelocity*t,u=1;switch(e.name){case"left":u=-1;case"right":s.setScrollLeft(s.getScrollLeft()+c*u);break;case"top":u=-1;case"bottom":s.setScrollTop(s.getScrollTop()+c*u);break}}computeBestEdge(e,t){let{edgeThreshold:s}=this,i=null,l=this.scrollCaches||[];for(let c of l){let u=c.clientRect,h=e-u.left,m=u.right-e,p=t-u.top,x=u.bottom-t;h>=0&&m>=0&&p>=0&&x>=0&&(p<=s&&this.everMovedUp&&c.canScrollUp()&&(!i||i.distance>p)&&(i={scrollCache:c,name:"top",distance:p}),x<=s&&this.everMovedDown&&c.canScrollDown()&&(!i||i.distance>x)&&(i={scrollCache:c,name:"bottom",distance:x}),h<=s&&this.everMovedLeft&&c.canScrollLeft()&&(!i||i.distance>h)&&(i={scrollCache:c,name:"left",distance:h}),m<=s&&this.everMovedRight&&c.canScrollRight()&&(!i||i.distance>m)&&(i={scrollCache:c,name:"right",distance:m}))}return i}buildCaches(e){return this.queryScrollEls(e).map(t=>t===window?new GL(!1):new _N(t,!1))}queryScrollEls(e){let t=[];for(let s of this.scrollQuery)typeof s=="object"?t.push(s):t.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(s)));return t}}class Zo extends s4{constructor(e,t){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=i=>{this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,RR(document.body),MR(document.body),i.isTouch||i.origEvent.preventDefault(),this.emitter.trigger("pointerdown",i),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(i.subjectEl,i.pageX,i.pageY),this.startDelay(i),this.minDistance||this.handleDistanceSurpassed(i)))},this.onPointerMove=i=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",i),!this.isDistanceSurpassed){let l=this.minDistance,c,{deltaX:u,deltaY:h}=i;c=u*u+h*h,c>=l*l&&this.handleDistanceSurpassed(i)}this.isDragging&&(i.origEvent.type!=="scroll"&&(this.mirror.handleMove(i.pageX,i.pageY),this.autoScroller.handleMove(i.pageX,i.pageY)),this.emitter.trigger("dragmove",i))}},this.onPointerUp=i=>{this.isInteracting&&(this.isInteracting=!1,kR(document.body),LR(document.body),this.emitter.trigger("pointerup",i),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(i)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let s=this.pointer=new SN(e);s.emitter.on("pointerdown",this.onPointerDown),s.emitter.on("pointermove",this.onPointerMove),s.emitter.on("pointerup",this.onPointerUp),t&&(s.selector=t),this.mirror=new $L,this.autoScroller=new YL}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){typeof this.delay=="number"?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(!this.pointer.wasTouchScroll||this.touchScrollAllowed)&&(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),this.touchScrollAllowed===!1&&this.pointer.cancelTouchScroll())}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}}class WL{constructor(e){this.el=e,this.origRect=xg(e),this.scrollCaches=WA(e).map(t=>new _N(t,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let t of this.scrollCaches)e+=t.origScrollLeft-t.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let t of this.scrollCaches)e+=t.origScrollTop-t.getScrollTop();return e}isWithinClipping(e,t){let s={left:e,top:t};for(let i of this.scrollCaches)if(!XL(i.getEventTarget())&&!zM(s,i.clientRect))return!1;return!0}}function XL(n){let e=n.tagName;return e==="HTML"||e==="BODY"}class ku{constructor(e,t){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=s=>{let{dragging:i}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(s),this.initialHit||!this.requireInitial?(i.setIgnoreMove(!1),this.emitter.trigger("pointerdown",s)):i.setIgnoreMove(!0)},this.handleDragStart=s=>{this.emitter.trigger("dragstart",s),this.handleMove(s,!0)},this.handleDragMove=s=>{this.emitter.trigger("dragmove",s),this.handleMove(s)},this.handlePointerUp=s=>{this.releaseHits(),this.emitter.trigger("pointerup",s)},this.handleDragEnd=s=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,s),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",s)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new Du}processFirstCoord(e){let t={left:e.pageX,top:e.pageY},s=t,i=e.subjectEl,l;i instanceof HTMLElement&&(l=xg(i),s=FM(s,l));let c=this.initialHit=this.queryHitForOffset(s.left,s.top);if(c){if(this.useSubjectCenter&&l){let u=$A(l,c.rect);u&&(s=UM(u))}this.coordAdjust=qM(s,t)}else this.coordAdjust={left:0,top:0}}handleMove(e,t){let s=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);(t||!Mu(this.movingHit,s))&&(this.movingHit=s,this.emitter.trigger("hitupdate",s,!1,e))}prepareHits(){this.offsetTrackers=Wi(this.droppableStore,e=>(e.component.prepareHits(),new WL(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let t in e)e[t].destroy();this.offsetTrackers={}}queryHitForOffset(e,t){let{droppableStore:s,offsetTrackers:i}=this,l=null;for(let c in s){let u=s[c].component,h=i[c];if(h&&h.isWithinClipping(e,t)){let m=h.computeLeft(),p=h.computeTop(),x=e-m,y=t-p,{origRect:v}=h,w=v.right-v.left,A=v.bottom-v.top;if(x>=0&&x<w&&y>=0&&y<A){let N=u.queryHit(x,y,w,A);N&&Cu(N.dateProfile.activeRange,N.dateSpan.range)&&(this.disablePointCheck||h.el.contains(h.el.getRootNode().elementFromPoint(x+m-window.scrollX,y+p-window.scrollY)))&&(!l||N.layer>l.layer)&&(N.componentId=c,N.context=u.context,N.rect.left+=m,N.rect.right+=m,N.rect.top+=p,N.rect.bottom+=p,l=N)}}}return l}}function Mu(n,e){return!n&&!e?!0:!!n!=!!e?!1:TM(n.dateSpan,e.dateSpan)}function CN(n,e){let t={};for(let s of e.pluginHooks.datePointTransforms)Object.assign(t,s(n,e));return Object.assign(t,QL(n,e.dateEnv)),t}function QL(n,e){return{date:e.toDate(n.range.start),dateStr:e.formatIso(n.range.start,{omitTime:n.allDay}),allDay:n.allDay}}class ZL extends cl{constructor(e){super(e),this.handlePointerDown=s=>{let{dragging:i}=this,l=s.origEvent.target;i.setIgnoreMove(!this.component.isValidDateDownEl(l))},this.handleDragEnd=s=>{let{component:i}=this,{pointer:l}=this.dragging;if(!l.wasTouchScroll){let{initialHit:c,finalHit:u}=this.hitDragging;if(c&&u&&Mu(c,u)){let{context:h}=i,m=Object.assign(Object.assign({},CN(c.dateSpan,h)),{dayEl:c.dayEl,jsEvent:s.origEvent,view:h.viewApi||h.calendarApi.view});h.emitter.trigger("dateClick",m)}}},this.dragging=new Zo(e.el),this.dragging.autoScroller.isEnabled=!1;let t=this.hitDragging=new ku(this.dragging,pg(e));t.emitter.on("pointerdown",this.handlePointerDown),t.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}}class KL extends cl{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=c=>{let{component:u,dragging:h}=this,{options:m}=u.context,p=m.selectable&&u.isValidDateDownEl(c.origEvent.target);h.setIgnoreMove(!p),h.delay=c.isTouch?JL(u):null},this.handleDragStart=c=>{this.component.context.calendarApi.unselect(c)},this.handleHitUpdate=(c,u)=>{let{context:h}=this.component,m=null,p=!1;if(c){let x=this.hitDragging.initialHit;c.componentId===x.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(x,c)||(m=eO(x,c,h.pluginHooks.dateSelectionTransformers)),(!m||!h4(m,c.dateProfile,h))&&(p=!0,m=null)}m?h.dispatch({type:"SELECT_DATES",selection:m}):u||h.dispatch({type:"UNSELECT_DATES"}),p?eg():tg(),u||(this.dragSelection=m)},this.handlePointerUp=c=>{this.dragSelection&&(IA(this.dragSelection,c,this.component.context),this.dragSelection=null)};let{component:t}=e,{options:s}=t.context,i=this.dragging=new Zo(e.el);i.touchScrollAllowed=!1,i.minDistance=s.selectMinDistance||0,i.autoScroller.isEnabled=s.dragScroll;let l=this.hitDragging=new ku(this.dragging,pg(e));l.emitter.on("pointerdown",this.handlePointerDown),l.emitter.on("dragstart",this.handleDragStart),l.emitter.on("hitupdate",this.handleHitUpdate),l.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}}function JL(n){let{options:e}=n.context,t=e.selectLongPressDelay;return t==null&&(t=e.longPressDelay),t}function eO(n,e,t){let s=n.dateSpan,i=e.dateSpan,l=[s.range.start,s.range.end,i.range.start,i.range.end];l.sort(HR);let c={};for(let u of t){let h=u(n,e);if(h===!1)return null;h&&Object.assign(c,h)}return c.range={start:l[0],end:l[3]},c.allDay=s.allDay,c}class Ko extends cl{constructor(e){super(e),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=c=>{let u=c.origEvent.target,{component:h,dragging:m}=this,{mirror:p}=m,{options:x}=h.context,y=h.context;this.subjectEl=c.subjectEl;let v=this.subjectSeg=tl(c.subjectEl),A=(this.eventRange=v.eventRange).instance.instanceId;this.relevantEvents=ug(y.getCurrentData().eventStore,A),m.minDistance=c.isTouch?0:x.eventDragMinDistance,m.delay=c.isTouch&&A!==h.props.eventSelection?sO(h):null,x.fixedMirrorParent?p.parentNode=x.fixedMirrorParent:p.parentNode=bs(u,".fc"),p.revertDuration=x.dragRevertDuration;let N=h.isValidSegDownEl(u)&&!bs(u,".fc-event-resizer");m.setIgnoreMove(!N),this.isDragging=N&&c.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=c=>{let u=this.component.context,h=this.eventRange,m=h.instance.instanceId;c.isTouch?m!==this.component.props.eventSelection&&u.dispatch({type:"SELECT_EVENT",eventInstanceId:m}):u.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(u.calendarApi.unselect(c),u.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new Tt(u,h.def,h.instance),jsEvent:c.origEvent,view:u.viewApi}))},this.handleHitUpdate=(c,u)=>{if(!this.isDragging)return;let h=this.relevantEvents,m=this.hitDragging.initialHit,p=this.component.context,x=null,y=null,v=null,w=!1,A={affectedEvents:h,mutatedEvents:jn(),isEvent:!0};if(c){x=c.context;let N=x.options;p===x||N.editable&&N.droppable?(y=tO(m,c,this.eventRange.instance.range.start,x.getCurrentData().pluginHooks.eventDragMutationMassagers),y&&(v=mg(h,x.getCurrentData().eventUiBases,y,x),A.mutatedEvents=v,KA(A,c.dateProfile,x)||(w=!0,y=null,v=null,A.mutatedEvents=jn()))):x=null}this.displayDrag(x,A),w?eg():tg(),u||(p===x&&Mu(m,c)&&(y=null),this.dragging.setMirrorNeedsRevert(!y),this.dragging.setMirrorIsVisible(!c||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=x,this.validMutation=y,this.mutatedRelevantEvents=v)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=c=>{if(this.isDragging){let u=this.component.context,h=u.viewApi,{receivingContext:m,validMutation:p}=this,x=this.eventRange.def,y=this.eventRange.instance,v=new Tt(u,x,y),w=this.relevantEvents,A=this.mutatedRelevantEvents,{finalHit:N}=this.hitDragging;if(this.clearDrag(),u.emitter.trigger("eventDragStop",{el:this.subjectEl,event:v,jsEvent:c.origEvent,view:h}),p){if(m===u){let S=new Tt(u,A.defs[x.defId],y?A.instances[y.instanceId]:null);u.dispatch({type:"MERGE_EVENTS",eventStore:A});let E={oldEvent:v,event:S,relatedEvents:Bi(A,u,y),revert(){u.dispatch({type:"MERGE_EVENTS",eventStore:w})}},C={};for(let R of u.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(C,R(p,u));u.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},E),C),{el:c.subjectEl,delta:p.datesDelta,jsEvent:c.origEvent,view:h})),u.emitter.trigger("eventChange",E)}else if(m){let S={event:v,relatedEvents:Bi(w,u,y),revert(){u.dispatch({type:"MERGE_EVENTS",eventStore:w})}};u.emitter.trigger("eventLeave",Object.assign(Object.assign({},S),{draggedEl:c.subjectEl,view:h})),u.dispatch({type:"REMOVE_EVENTS",eventStore:w}),u.emitter.trigger("eventRemove",S);let E=A.defs[x.defId],C=A.instances[y.instanceId],R=new Tt(m,E,C);m.dispatch({type:"MERGE_EVENTS",eventStore:A});let D={event:R,relatedEvents:Bi(A,m,C),revert(){m.dispatch({type:"REMOVE_EVENTS",eventStore:A})}};m.emitter.trigger("eventAdd",D),c.isTouch&&m.dispatch({type:"SELECT_EVENT",eventInstanceId:y.instanceId}),m.emitter.trigger("drop",Object.assign(Object.assign({},CN(N.dateSpan,m)),{draggedEl:c.subjectEl,jsEvent:c.origEvent,view:N.context.viewApi})),m.emitter.trigger("eventReceive",Object.assign(Object.assign({},D),{draggedEl:c.subjectEl,view:N.context.viewApi}))}}else u.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:t}=this,{options:s}=t.context,i=this.dragging=new Zo(e.el);i.pointer.selector=Ko.SELECTOR,i.touchScrollAllowed=!1,i.autoScroller.isEnabled=s.dragScroll;let l=this.hitDragging=new ku(this.dragging,hp);l.useSubjectCenter=e.useEventCenter,l.emitter.on("pointerdown",this.handlePointerDown),l.emitter.on("dragstart",this.handleDragStart),l.emitter.on("hitupdate",this.handleHitUpdate),l.emitter.on("pointerup",this.handlePointerUp),l.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(e,t){let s=this.component.context,i=this.receivingContext;i&&i!==e&&(i===s?i.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:t.affectedEvents,mutatedEvents:jn(),isEvent:!0}}):i.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})}clearDrag(){let e=this.component.context,{receivingContext:t}=this;t&&t.dispatch({type:"UNSET_EVENT_DRAG"}),e!==t&&e.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}}Ko.SELECTOR=".fc-event-draggable, .fc-event-resizable";function tO(n,e,t,s){let i=n.dateSpan,l=e.dateSpan,c=i.range.start,u=l.range.start,h={};i.allDay!==l.allDay&&(h.allDay=l.allDay,h.hasEnd=e.context.options.allDayMaintainDuration,l.allDay?c=Ct(t):c=t);let m=$r(c,u,n.context.dateEnv,n.componentId===e.componentId?n.largeUnit:null);m.milliseconds&&(h.allDay=!1);let p={datesDelta:m,standardProps:h};for(let x of s)x(p,n,e);return p}function sO(n){let{options:e}=n.context,t=e.eventLongPressDelay;return t==null&&(t=e.longPressDelay),t}class nO extends cl{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=l=>{let{component:c}=this,u=this.querySegEl(l),h=tl(u),m=this.eventRange=h.eventRange;this.dragging.minDistance=c.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(l.origEvent.target)||l.isTouch&&this.component.props.eventSelection!==m.instance.instanceId)},this.handleDragStart=l=>{let{context:c}=this.component,u=this.eventRange;this.relevantEvents=ug(c.getCurrentData().eventStore,this.eventRange.instance.instanceId);let h=this.querySegEl(l);this.draggingSegEl=h,this.draggingSeg=tl(h),c.calendarApi.unselect(),c.emitter.trigger("eventResizeStart",{el:h,event:new Tt(c,u.def,u.instance),jsEvent:l.origEvent,view:c.viewApi})},this.handleHitUpdate=(l,c,u)=>{let{context:h}=this.component,m=this.relevantEvents,p=this.hitDragging.initialHit,x=this.eventRange.instance,y=null,v=null,w=!1,A={affectedEvents:m,mutatedEvents:jn(),isEvent:!0};l&&(l.componentId===p.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(p,l)||(y=aO(p,l,u.subjectEl.classList.contains("fc-event-resizer-start"),x.range))),y&&(v=mg(m,h.getCurrentData().eventUiBases,y,h),A.mutatedEvents=v,KA(A,l.dateProfile,h)||(w=!0,y=null,v=null,A.mutatedEvents=null)),v?h.dispatch({type:"SET_EVENT_RESIZE",state:A}):h.dispatch({type:"UNSET_EVENT_RESIZE"}),w?eg():tg(),c||(y&&Mu(p,l)&&(y=null),this.validMutation=y,this.mutatedRelevantEvents=v)},this.handleDragEnd=l=>{let{context:c}=this.component,u=this.eventRange.def,h=this.eventRange.instance,m=new Tt(c,u,h),p=this.relevantEvents,x=this.mutatedRelevantEvents;if(c.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:m,jsEvent:l.origEvent,view:c.viewApi}),this.validMutation){let y=new Tt(c,x.defs[u.defId],h?x.instances[h.instanceId]:null);c.dispatch({type:"MERGE_EVENTS",eventStore:x});let v={oldEvent:m,event:y,relatedEvents:Bi(x,c,h),revert(){c.dispatch({type:"MERGE_EVENTS",eventStore:p})}};c.emitter.trigger("eventResize",Object.assign(Object.assign({},v),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||ct(0),endDelta:this.validMutation.endDelta||ct(0),jsEvent:l.origEvent,view:c.viewApi})),c.emitter.trigger("eventChange",v)}else c.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:t}=e,s=this.dragging=new Zo(e.el);s.pointer.selector=".fc-event-resizer",s.touchScrollAllowed=!1,s.autoScroller.isEnabled=t.context.options.dragScroll;let i=this.hitDragging=new ku(this.dragging,pg(e));i.emitter.on("pointerdown",this.handlePointerDown),i.emitter.on("dragstart",this.handleDragStart),i.emitter.on("hitupdate",this.handleHitUpdate),i.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return bs(e.subjectEl,".fc-event")}}function aO(n,e,t,s){let i=n.context.dateEnv,l=n.dateSpan.range.start,c=e.dateSpan.range.start,u=$r(l,c,i,n.largeUnit);if(t){if(i.add(s.start,u)<s.end)return{startDelta:u}}else if(i.add(s.end,u)>s.start)return{endDelta:u};return null}class iO{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=s=>{s.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=s=>{let i=this.context.options.unselectCancel,l=gA(s.origEvent);this.matchesCancel=!!bs(l,i),this.matchesEvent=!!bs(l,Ko.SELECTOR)},this.onDocumentPointerUp=s=>{let{context:i}=this,{documentPointer:l}=this,c=i.getCurrentData();if(!l.wasTouchScroll){if(c.dateSelection&&!this.isRecentPointerDateSelect){let u=i.options.unselectAuto;u&&(!u||!this.matchesCancel)&&i.calendarApi.unselect(s)}c.eventSelection&&!this.matchesEvent&&i.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let t=this.documentPointer=new SN(document);t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerdown",this.onDocumentPointerDown),t.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}}const rO={fixedMirrorParent:ae},lO={dateClick:ae,eventDragStart:ae,eventDragStop:ae,eventDrop:ae,eventResizeStart:ae,eventResizeStop:ae,eventResize:ae,drop:ae,eventReceive:ae,eventLeave:ae};bg.dataAttrPrefix="";var oO=ni({name:"@fullcalendar/interaction",componentInteractions:[ZL,KL,Ko,nO],calendarInteractions:[iO],elementDraggingImpl:Zo,optionRefiners:rO,listenerRefiners:lO});const jd="/events";function Pm(){const{user:n,token:e}=ls(),[t,s]=_.useState([]),[i,l]=_.useState([]),[c,u]=_.useState({}),[h,m]=_.useState(!1),[p,x]=_.useState(null),[y,v]=_.useState({title:"",description:"",startDate:"",endDate:"",category:"meeting"}),[w,A]=_.useState(new Date),[N,S]=_.useState(new Date),[E,C]=_.useState([]),[R,D]=_.useState(!1),O=_.useRef(null),H=`:root { --primary-color: #104774; --primary-hover: #0d3a61; --sunday-bg-color: #fff5f5; --sunday-text-color: #e53e3e; --holiday-bg-color: #fff5f5; --holiday-text-color: #e53e3e; }
  .fc .fc-toolbar-title{font-size:1.25rem;font-weight:600;color:#104774}
  .fc .fc-button{background-color:#104774;border-color:#104774}
  .fc .fc-button:hover{background-color:#0d3a61;border-color:#0d3a61}
  .fc .fc-daygrid-day.fc-day-today{background-color:#f0f9ff}
  .fc .fc-day-sun,.fc .fc-day-holiday{background-color:var(--holiday-bg-color)}
  .fc .fc-day-sun .fc-daygrid-day-number,.fc .fc-day-holiday .fc-daygrid-day-number{color:var(--holiday-text-color);font-weight:600}
  .fc-event{border-radius:4px;border:none;padding:2px 4px;font-size:0.8rem;cursor:pointer}
  .fc-daygrid-day-frame{cursor:pointer;max-height:150px!important}
  .fc-event-title{font-weight:500}
  .fc-event-description{font-size:0.7rem;opacity:0.8;margin-top:2px}
  `,F=te=>{const be=new Date(te),ve=be.getFullYear(),Ee=String(be.getMonth()+1).padStart(2,"0"),Ye=String(be.getDate()).padStart(2,"0");return`${ve}-${Ee}-${Ye}`},P=te=>new Date(te).getDay()===0,Z=te=>{const be=F(te);return{id:`sunday-${be}`,title:"Sunday Holiday",start:be,extendedProps:{description:"Weekly holiday",category:"holiday",isSundayHoliday:!0},color:z("holiday"),display:"auto",allDay:!0}},z=te=>{switch(te){case"meeting":return"#104774";case"deadline":return"#ef4444";case"event":return"#8b5cf6";case"leave":return"#f97316";case"holiday":return"#10b981";default:return"#6b7280"}},K=te=>{switch(te){case"meeting":return"bg-blue-50 border-blue-200";case"deadline":return"bg-red-50 border-red-200";case"event":return"bg-purple-50 border-purple-200";case"leave":return"bg-orange-50 border-orange-200";case"holiday":return"bg-green-50 border-green-200";default:return"bg-gray-50 border-gray-200"}},W=_.useCallback(te=>(te||[]).map(be=>{let ve=be.endDate;if(be.endDate&&be.endDate!==be.startDate){const Ee=new Date(be.endDate);Ee.setDate(Ee.getDate()+1),ve=F(Ee)}return{id:be._id.toString(),title:be.title,start:F(be.startDate),end:ve||void 0,extendedProps:{description:be.description,category:be.category||"meeting",originalEndDate:be.endDate||null,isSundayHoliday:!1,isHoliday:!!be.isHoliday,source:be.source||"backend",externalId:be.externalId||void 0},color:z(be.category||"meeting"),display:"auto",allDay:!0}}),[]),ce=te=>{const be=te.end.date?te.end.date:te.end.dateTime;return{id:`holiday-${te.id}`,title:te.summary,start:F(te.start.date||te.start.dateTime),end:be?F(be):void 0,extendedProps:{description:te.description||te.summary,category:"holiday",isHoliday:!0,source:"google",externalId:te.id},color:z("holiday"),display:"auto",allDay:!0}},me=()=>{const te=t||[],be=[...te];return i.forEach(ve=>{const Ee=ve.extendedProps?.externalId,Ye=F(ve.start),J=(ve.title||"").toLowerCase();te.some(Ie=>!!(Ee&&Ie.extendedProps?.externalId&&Ie.extendedProps.externalId===Ee||F(Ie.start)===Ye&&(Ie.title||"").toLowerCase()===J))||be.push(ve)}),be},L=_.useCallback(async()=>{D(!0);try{const te=await xe.get(jd,{headers:{Authorization:`Bearer ${e}`}}),be=W(te.data.events||[]);s(be);const ve=[...be,...i];I(N,ve)}catch(te){console.error(te.response?.data||te.message)}finally{D(!1)}},[e,W,i,N]);_.useEffect(()=>{L(),$(w.getFullYear())},[]),_.useEffect(()=>{I(N)},[t,i,N]);const q=te=>{const be=(te.summary||"").toLowerCase(),ve=["public holiday","national holiday","gazetted holiday","bank holiday","independence day","republic day","gandhi jayanti","guru nanak jayanti","diwali","holi","eid","christmas","good friday","mahatma gandhi","republic","independence","janmashtami","dussehra","ram navami","maha shivratri"],Ee=["observance","observances","festival","festivals","optional holiday","restricted holiday","eve","beginning","ends","monthly","week","daylight saving","season","solstice","equinox","fasting","vrat","puja","parva"],Ye=ve.some(Se=>be.includes(Se)),J=Ee.some(Se=>be.includes(Se));return Ye&&!J},$=async te=>{if(c[te])return;const be="AIzaSyBG-v7rJFHD3hgzTW802GaGTa-gA_n3J3A",ve="en.indian%23holiday%40group.v.calendar.google.com",Ee=`${te}-01-01T00:00:00Z`,Ye=`${te}-12-31T23:59:59Z`,J=`https://www.googleapis.com/calendar/v3/calendars/${ve}/events?key=${be}&timeMin=${Ee}&timeMax=${Ye}&singleEvents=true`,Se=new AbortController,Ie=setTimeout(()=>Se.abort(),1e4);try{const Xe=await fetch(J,{signal:Se.signal,headers:{Accept:"application/json"}});if(clearTimeout(Ie),!Xe.ok)throw new Error(`HTTP ${Xe.status} - ${Xe.statusText}`);const wt=await Xe.json(),Ne=(Array.isArray(wt.items)?wt.items:[]).filter(q).map(ce);l(_e=>{const Ue=new Set(_e.map(Qt=>Qt.id)),dt=Ne.filter(Qt=>!Ue.has(Qt.id));return[..._e,...dt]}),u(_e=>({..._e,[te]:!0}))}catch(Xe){Xe.name==="AbortError"?console.warn("Holiday fetch aborted"):console.error("Holiday fetch error:",Xe.message||Xe)}finally{clearTimeout(Ie)}},I=(te,be=null)=>{const ve=be||me(),Ee=F(te),Ye=P(te),J=ve.filter(Xe=>{const wt=F(Xe.start);if(Xe.end){const qt=F(Xe.end);return Ee>=wt&&Ee<qt}return Ee===wt});Ye&&(J.some(wt=>wt.extendedProps?.isSundayHoliday||wt.extendedProps?.isHoliday)||J.push(Z(te)));const Se=new Set,Ie=[];J.forEach(Xe=>{const wt=Xe.extendedProps?.externalId||Xe.id||`${(Xe.title||"").toLowerCase()}|${F(Xe.start)}`;Se.has(wt)||(Se.add(wt),Ie.push(Xe))}),C(Ie)},T=te=>{const be=new Date(te.view.currentStart);A(be),$(be.getFullYear())},V=te=>{const be=new Date(te.dateStr);S(be),I(be)},M=te=>{if(n.role==="employee")return;const be=te.event;if(be.extendedProps?.isSundayHoliday||be.extendedProps?.isHoliday)return;const ve=be.extendedProps?.originalEndDate||be.endStr||be.startStr,Ee=be.startStr?be.startStr.slice(0,10):F(be.start),Ye=ve?ve.slice?ve.slice(0,10):F(ve):Ee;x({id:be.id}),v({title:be.title||"",description:be.extendedProps?.description||"",startDate:Ee,endDate:Ye,category:be.extendedProps?.category||"meeting"}),m(!0)},G=()=>{x(null),v({title:"",description:"",startDate:F(N),endDate:F(N),category:"meeting"}),m(!0)},de=te=>new Date(te).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),re=async()=>{D(!0);try{const te={title:y.title,description:y.description,startDate:y.startDate,endDate:y.endDate&&y.endDate!==y.startDate?y.endDate:void 0,category:y.category};if(p){const be=await xe.put(`${jd}/${p.id}`,te,{headers:{Authorization:`Bearer ${e}`}}),ve=W([be.data.event])[0];s(Ee=>Ee.map(Ye=>Ye.id===ve.id?ve:Ye))}else{const be=await xe.post(jd,te,{headers:{Authorization:`Bearer ${e}`}}),ve=W([be.data.event])[0];s(Ee=>{if(new Set(Ee.map(Se=>Se.id)).has(ve.id))return Ee;const J=[...Ee,ve];return I(N,[...J,...i]),J})}m(!1)}catch(te){console.error(te.response?.data||te.message)}finally{D(!1)}},ye=async()=>{if(p){D(!0);try{await xe.delete(`${jd}/${p.id}`,{headers:{Authorization:`Bearer ${e}`}}),s(te=>te.filter(be=>be.id!==p.id)),m(!1)}catch(te){console.error(te.response?.data||te.message)}finally{D(!1)}}},je=()=>{if(O.current){const te=O.current.getApi();te.prev(),A(new Date(te.getDate()))}},Le=()=>{if(O.current){const te=O.current.getApi();te.next(),A(new Date(te.getDate()))}},he=te=>{const be=F(te);return me().some(Ee=>{const Ye=F(Ee.start);if(Ee.end){const J=F(Ee.end);return be>=Ye&&be<J&&!!Ee.extendedProps?.isHoliday}return be===Ye&&!!Ee.extendedProps?.isHoliday})},$e=te=>te.event.extendedProps?.isSundayHoliday?null:r.jsxs("div",{className:"fc-event-content",children:[r.jsx("div",{className:"fc-event-title",children:te.event.title}),te.event.extendedProps.description&&r.jsx("div",{className:"fc-event-description",children:te.event.extendedProps.description.length>20?`${te.event.extendedProps.description.substring(0,20)}...`:te.event.extendedProps.description})]}),ge=te=>{const be=new Date(te.date),ve=P(be),Ee=he(be);return r.jsx("div",{className:"fc-daygrid-day-frame",children:r.jsx("div",{className:"fc-daygrid-day-top",children:r.jsx("div",{className:`fc-daygrid-day-number ${ve||Ee?"text-red-600 font-bold":""}`,children:te.dayNumberText})})})},we=te=>{const be=new Date(te.date),ve=P(be),Ee=he(be);return ve||Ee?"fc-day-holiday":""},ke=me();return r.jsxs("div",{className:"space-y-4 sm:space-y-6 lg:space-y-8 p-2 sm:p-4 lg:p-0",children:[r.jsx("style",{children:H}),r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"Company Calendar"}),r.jsx("p",{className:"text-gray-500 text-xs sm:text-sm mt-1",children:"Manage company events and schedules"})]}),n.role!=="employee"&&r.jsxs("button",{onClick:G,className:"flex items-center justify-center bg-[#104774] text-white px-3 py-2 sm:px-4 sm:py-2 rounded-lg sm:rounded-xl hover:bg-[#0d3a61] transition-all duration-200 text-sm sm:text-base",children:[r.jsx(Ii,{size:16,className:"mr-2 sm:mr-2"}),r.jsx("span",{className:"sm:inline",children:"Add Event"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8",children:[r.jsx("div",{className:"lg:col-span-2",children:r.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[r.jsx("div",{className:"bg-[#104774] p-3 sm:p-4 lg:p-6 text-white",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("button",{onClick:je,className:"p-1.5 sm:p-2 hover:bg-[#0d3a61] rounded-md sm:rounded-lg transition-colors",children:[r.jsx(Ib,{size:20,className:"sm:hidden"}),r.jsx(Ib,{size:24,className:"hidden sm:block"})]}),r.jsxs("div",{className:"text-center px-2",children:[r.jsx("h2",{className:"text-base sm:text-lg lg:text-xl font-semibold",children:w.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),r.jsx("p",{className:"text-blue-100 text-xs sm:text-sm hidden sm:block",children:"Click on any date to view events"})]}),r.jsxs("button",{onClick:Le,className:"p-1.5 sm:p-2 hover:bg-[#0d3a61] rounded-md sm:rounded-lg transition-colors",children:[r.jsx(Bb,{size:20,className:"sm:hidden"}),r.jsx(Bb,{size:24,className:"hidden sm:block"})]})]})}),r.jsx("div",{className:"calendar-container",children:r.jsx(pN,{ref:O,plugins:[zL,oO],initialView:"dayGridMonth",events:ke,dateClick:V,eventClick:M,height:"auto",headerToolbar:!1,initialDate:w,datesSet:T,eventContent:$e,dayCellContent:ge,dayCellClassNames:we,dayMaxEvents:1,fixedWeekCount:!1})})]})}),r.jsx("div",{className:"space-y-4 sm:space-y-6",children:r.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-sm border border-gray-100 p-3 sm:p-4 lg:p-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3 sm:mb-4 gap-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(Es,{size:20,className:"text-[#104774] mr-2 sm:mr-3 sm:hidden"}),r.jsx(Es,{size:24,className:"text-[#104774] mr-2 sm:mr-3 hidden sm:block"}),r.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-gray-800",children:[de(N),(P(N)||E.some(te=>te.extendedProps?.isHoliday))&&r.jsx("span",{className:"ml-2 text-red-600 text-xs sm:text-sm font-normal",children:"(Holiday)"})]})]}),n.role!=="employee"&&E.length>0&&r.jsx("button",{onClick:G,className:"text-[#104774] text-xs sm:text-sm hover:text-[#0d3a61] self-start sm:self-center",children:"+ Add Event"})]}),E.length>0?r.jsx("div",{className:"space-y-2 sm:space-y-3",children:E.map((te,be)=>{const ve=new Date(te.start),Ee=te.end?new Date(te.end):null;return r.jsxs("div",{className:`p-3 sm:p-4 rounded-lg sm:rounded-xl border ${K(te.extendedProps?.category||"meeting")} ${n.role!=="employee"&&!te.extendedProps?.isSundayHoliday&&!te.extendedProps?.isHoliday?"cursor-pointer hover:shadow-md transition-shadow":""}`,onClick:()=>{n.role!=="employee"&&!te.extendedProps?.isSundayHoliday&&!te.extendedProps?.isHoliday&&(x(te),v({title:te.title,description:te.extendedProps?.description||"",startDate:te.start,endDate:te.extendedProps?.originalEndDate||te.start,category:te.extendedProps?.category||"meeting"}),m(!0))},children:[r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("h4",{className:"font-semibold text-gray-800 text-sm sm:text-base truncate",children:[te.title,(te.extendedProps?.isSundayHoliday||te.extendedProps?.isHoliday)&&r.jsx("span",{className:"ml-2 text-green-600 text-xs font-normal"})]}),te.extendedProps?.description&&r.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1 sm:mt-2 line-clamp-2",children:te.extendedProps.description}),r.jsxs("div",{className:"text-xs text-gray-400 mt-1 sm:mt-2",children:[ve.toLocaleDateString(),Ee&&Ee>ve&&` to ${Ee.toLocaleDateString()}`]})]}),r.jsx("div",{className:"w-3 h-3 rounded-full ml-2 flex-shrink-0",style:{backgroundColor:z(te.extendedProps?.category||"meeting")}})]}),n.role!=="employee"&&!te.extendedProps?.isSundayHoliday&&!te.extendedProps?.isHoliday&&r.jsx("div",{className:"text-xs text-[#104774] mt-2 hidden sm:block",children:"Click to edit"})]},be)})}):r.jsxs("div",{className:"text-center py-6 sm:py-8",children:[r.jsx(Es,{size:40,className:"text-gray-300 mx-auto mb-2 sm:mb-3 sm:hidden"}),r.jsx(Es,{size:48,className:"text-gray-300 mx-auto mb-2 sm:mb-3 hidden sm:block"}),r.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"No events scheduled"}),n.role!=="employee"&&r.jsx("button",{onClick:G,className:"text-[#104774] text-xs sm:text-sm mt-2 hover:text-[#0d3a61]",children:"+ Add Event"})]})]})})]}),h&&r.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-3 sm:p-4",children:r.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-lg w-full max-w-sm sm:max-w-md max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-6 border-b",children:[r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-800",children:p?"Edit Event":"Add Event"}),r.jsxs("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 p-1",children:[r.jsx(Zr,{size:18,className:"sm:hidden"}),r.jsx(Zr,{size:20,className:"hidden sm:block"})]})]}),r.jsxs("div",{className:"p-4 sm:p-6 space-y-3 sm:space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Event Title"}),r.jsx("input",{type:"text",placeholder:"Enter event title",value:y.title,onChange:te=>v({...y,title:te.target.value}),className:"w-full border border-gray-300 rounded-lg p-2.5 sm:p-3 text-sm sm:text-base focus:ring-2 focus:ring-[#104774] focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),r.jsx("textarea",{placeholder:"Enter event description",value:y.description,onChange:te=>v({...y,description:te.target.value}),rows:3,className:"w-full border border-gray-300 rounded-lg p-2.5 sm:p-3 text-sm sm:text-base focus:ring-2 focus:ring-[#104774] focus:border-transparent resize-none"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),r.jsxs("select",{value:y.category,onChange:te=>v({...y,category:te.target.value}),className:"w-full border border-gray-300 rounded-lg p-2.5 sm:p-3 text-sm sm:text-base focus:ring-2 focus:ring-[#104774] focus:border-transparent",children:[r.jsx("option",{value:"meeting",children:"Meeting"}),r.jsx("option",{value:"deadline",children:"Deadline"}),r.jsx("option",{value:"event",children:"Company Event"}),r.jsx("option",{value:"leave",children:"Leave Day"}),r.jsx("option",{value:"holiday",children:"Holiday"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),r.jsx("input",{type:"date",value:y.startDate?y.startDate.slice(0,10):"",onChange:te=>v({...y,startDate:te.target.value}),className:"w-full border border-gray-300 rounded-lg p-2.5 sm:p-3 text-sm sm:text-base focus:ring-2 focus:ring-[#104774] focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date (optional)"}),r.jsx("input",{type:"date",value:y.endDate?y.endDate.slice(0,10):"",onChange:te=>v({...y,endDate:te.target.value}),className:"w-full border border-gray-300 rounded-lg p-2.5 sm:p-3 text-sm sm:text-base focus:ring-2 focus:ring-[#104774] focus:border-transparent"})]})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-3 p-4 sm:p-6 border-t",children:[r.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 text-sm sm:text-base order-2 sm:order-1",children:"Cancel"}),p&&r.jsx("button",{onClick:ye,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm sm:text-base order-3 sm:order-2",children:"Delete"}),r.jsx("button",{onClick:re,className:"px-4 py-2 bg-[#104774] text-white rounded-lg hover:bg-[#0d3a61] text-sm sm:text-base order-1 sm:order-3",children:p?"Update":"Save"})]})]})})]})}function cO(n){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}cO(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Ag=n=>typeof n=="number"&&!isNaN(n),Po=n=>typeof n=="string",TN=n=>typeof n=="function",dO=n=>Po(n)||Ag(n),uO=n=>_.isValidElement(n)||Po(n)||TN(n)||Ag(n),hO=1,DN=()=>`${hO++}`,Yn=new Map,xp=[],cw=new Set,RN=()=>Yn.size>0,fO=(n,{containerId:e})=>{var t;return(t=Yn.get(e||1))==null?void 0:t.toasts.get(n)};function mO(n,e){var t;if(e)return!!((t=Yn.get(e))!=null&&t.isToastActive(n));let s=!1;return Yn.forEach(i=>{i.isToastActive(n)&&(s=!0)}),s}function pO(n){if(!RN()){xp=xp.filter(e=>n!=null&&e.options.toastId!==n);return}if(n==null||dO(n))Yn.forEach(e=>{e.removeToast(n)});else if(n&&("containerId"in n||"id"in n)){let e=Yn.get(n.containerId);e?e.removeToast(n.id):Yn.forEach(t=>{t.removeToast(n.id)})}}var gO=(n={})=>{Yn.forEach(e=>{e.props.limit&&(!n.containerId||e.id===n.containerId)&&e.clearQueue()})};function xO(n,e){uO(n)&&(RN()||xp.push({content:n,options:e}),Yn.forEach(t=>{t.buildToast(n,e)}))}function kN(n,e){Yn.forEach(t=>{(e==null||!(e!=null&&e.containerId)||e?.containerId===t.id)&&t.toggle(n,e?.id)})}function yO(n){return cw.add(n),()=>{cw.delete(n)}}function bO(n){return n&&(Po(n.toastId)||Ag(n.toastId))?n.toastId:DN()}function Jo(n,e){return xO(n,e),e.toastId}function Lu(n,e){return{...e,type:e&&e.type||n,toastId:bO(e)}}function Ou(n){return(e,t)=>Jo(e,Lu(n,t))}function Ze(n,e){return Jo(n,Lu("default",e))}Ze.loading=(n,e)=>Jo(n,Lu("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function vO(n,{pending:e,error:t,success:s},i){let l;e&&(l=Po(e)?Ze.loading(e,i):Ze.loading(e.render,{...i,...e}));let c={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},u=(m,p,x)=>{if(p==null){Ze.dismiss(l);return}let y={type:m,...c,...i,data:x},v=Po(p)?{render:p}:p;return l?Ze.update(l,{...y,...v}):Ze(v.render,{...y,...v}),x},h=TN(n)?n():n;return h.then(m=>u("success",s,m)).catch(m=>u("error",t,m)),h}Ze.promise=vO;Ze.success=Ou("success");Ze.info=Ou("info");Ze.error=Ou("error");Ze.warning=Ou("warning");Ze.warn=Ze.warning;Ze.dark=(n,e)=>Jo(n,Lu("default",{theme:"dark",...e}));function wO(n){pO(n)}Ze.dismiss=wO;Ze.clearWaitingQueue=gO;Ze.isActive=mO;Ze.update=(n,e={})=>{let t=fO(n,e);if(t){let{props:s,content:i}=t,l={delay:100,...s,...e,toastId:e.toastId||n,updateId:DN()};l.toastId!==n&&(l.staleId=n);let c=l.render||i;delete l.render,Jo(c,l)}};Ze.done=n=>{Ze.update(n,{progress:1})};Ze.onChange=yO;Ze.play=n=>kN(!0,n);Ze.pause=n=>kN(!1,n);function AO(){const{user:n,token:e}=ls(),[t,s]=_.useState({}),[i,l]=_.useState([]),[c,u]=_.useState([]),[h,m]=_.useState([]),[p,x]=_.useState(!0),[y,v]=_.useState(!1),[w,A]=_.useState(!1),[N,S]=_.useState(!1),[E,C]=_.useState(!1),[R,D]=_.useState(""),[O,H]=_.useState("all"),[F,P]=_.useState("all"),[Z,z]=_.useState(1),[K]=_.useState(5),[W,ce]=_.useState({leaveType:"",fromDate:"",toDate:"",reason:""}),[me,L]=_.useState({}),[q,$]=_.useState([]),I=_.useRef(new Set),T=_.useRef(new Set),[V,M]=_.useState(!1),[G,de]=_.useState(null),re=oe=>oe.toString().padStart(2,"0"),ye=oe=>`${oe.getFullYear()}-${re(oe.getMonth()+1)}-${re(oe.getDate())}`,je=async oe=>{try{const dt=(await(await fetch(`https://www.googleapis.com/calendar/v3/calendars/en.indian%23holiday@group.v.calendar.google.com/events?key=AIzaSyBG-v7rJFHD3hgzTW802GaGTa-gA_n3J3A&timeMin=${oe}-01-01T00:00:00Z&timeMax=${oe}-12-31T23:59:59Z`)).json()).items||[],Qt=["republic day","independence day","gandhi","mahatma gandhi","gandhi jayanti","diwali","deepavali","dussehra","dashera","holi","christmas","new year's","new year","good friday","eid","bakrid","ramzan","guru nanak","janmashtami","mahavir","pongal","makar sankranti","dussehra","dussehra","mahatma gandhi jayanti","mahatma gandhi","mahatma"];return dt.map(Rt=>{const en=Rt.start||{};let zs=null;if(en.date)zs=en.date;else if(en.dateTime){const xn=new Date(en.dateTime);zs=`${xn.getFullYear()}-${re(xn.getMonth()+1)}-${re(xn.getDate())}`}const vs=(Rt.summary||"").toString(),gn=(Rt.description||"").toString();let Fs=!1;const ii=gn.toLowerCase(),ri=vs.toLowerCase();if(ii.includes("public holiday")||ii.includes("public"))Fs=!0;else if(ii.includes("observance"))Fs=!1;else if(ri.includes("holiday"))Fs=!0;else for(const xn of Qt)if(ri.includes(xn)){Fs=!0;break}return{id:Rt.id,title:vs,date:zs,description:gn,htmlLink:Rt.htmlLink,isOfficial:Fs}}).filter(Rt=>Rt.date)}catch(Ne){return console.error("Error fetching holidays:",Ne),[]}},Le=async(oe=[])=>{const Ne=oe.filter(Ue=>!T.current.has(Ue));if(Ne.length===0)return;const _e=[];for(const Ue of Ne){const Qt=(await je(Ue)).filter(Qn=>Qn.isOfficial);_e.push(...Qt),T.current.add(Ue)}if(_e.length>0){const Ue=new Set(I.current),dt=[...q];for(const Qt of _e)Qt.date&&!Ue.has(Qt.date)&&(Ue.add(Qt.date),dt.push(Qt));I.current=Ue,$(dt)}},he=async(oe,Ne)=>{if(!oe||!Ne)return 0;M(!0);try{const _e=new Date(oe),Ue=new Date(Ne);if(isNaN(_e)||isNaN(Ue)||_e>Ue)return 0;const dt=new Set([_e.getFullYear(),Ue.getFullYear()]);await Le(Array.from(dt));const Qt=I.current;let Qn=0;const Rt=new Date(_e);for(;Rt<=Ue;){const zs=Rt.getDay()===0,vs=ye(Rt),gn=Qt.has(vs);!zs&&!gn&&Qn++,Rt.setDate(Rt.getDate()+1)}return Qn}catch(_e){return console.error("Error calculating working days:",_e),0}finally{M(!1)}},$e=async()=>{if(n)try{const oe=await xe.get("/leave/balance",{headers:{Authorization:`Bearer ${e}`}});s(oe.data.balance||{})}catch(oe){console.error("Error fetching leave balance:",oe),Ze.error("Failed to fetch leave balance")}},ge=async()=>{try{const Ne=((await xe.get("/leave/get-leaveTypes",{headers:{Authorization:`Bearer ${e}`}})).data||[]).filter(_e=>_e.isActive);m(Ne),Ne.length>0&&!W.leaveType&&ce(_e=>({..._e,leaveType:Ne[0].name}))}catch(oe){console.error("Error fetching leave types:",oe),Ze.error("Failed to fetch leave types")}},we=async()=>{if(n)try{const oe=await xe.get("/leave/my-requests",{headers:{Authorization:`Bearer ${e}`}});l(oe.data||[]),u(oe.data||[])}catch(oe){console.error("Error fetching leave requests:",oe),Ze.error("Failed to fetch leave requests")}finally{x(!1)}};_.useEffect(()=>{if(n){$e(),ge(),we();const oe=new Date().getFullYear();Le([oe]).catch(Ne=>console.error(Ne))}},[n]),_.useEffect(()=>{let oe=!1;return(async()=>{if(W.fromDate&&W.toDate){M(!0);const _e=await he(W.fromDate,W.toDate);oe||de(_e),M(!1)}else de(null)})(),()=>{oe=!0}},[W.fromDate,W.toDate]),_.useEffect(()=>{let oe=i;O!=="all"&&(oe=oe.filter(Ne=>Ne.status===O)),F!=="all"&&(oe=oe.filter(Ne=>Ne.leaveType===F)),R&&(oe=oe.filter(Ne=>(Ne.reason||"").toLowerCase().includes(R.toLowerCase())||(Ne.leaveType||"").toLowerCase().includes(R.toLowerCase())||(Ne.status||"").toLowerCase().includes(R.toLowerCase()))),u(oe),z(1)},[R,O,F,i]);const ke=Z*K,te=ke-K,be=c.slice(te,ke),ve=Math.ceil(c.length/K),Ee=oe=>{const{name:Ne,value:_e}=oe.target;ce(Ue=>({...Ue,[Ne]:_e})),me[Ne]&&L(Ue=>({...Ue,[Ne]:""}))},Ye=async()=>{const oe={},Ne=new Date;Ne.setHours(0,0,0,0);const _e=new Date(W.fromDate);if(_e.setHours(0,0,0,0),W.leaveType||(oe.leaveType="Leave type is required"),W.fromDate||(oe.fromDate="From date is required"),W.toDate||(oe.toDate="To date is required"),W.fromDate&&W.toDate){new Date(W.fromDate)>new Date(W.toDate)&&(oe.toDate="To date cannot be before from date"),_e<Ne&&(oe.fromDate="Cannot apply for backdated leaves");const Ue=await he(W.fromDate,W.toDate),dt=t[W.leaveType]??0;dt<Ue&&(oe.leaveType=`Insufficient ${W.leaveType} leave balance! You have ${dt} days left.`)}return W.reason.trim()||(oe.reason="Reason is required"),W.reason.length>500&&(oe.reason="Reason cannot exceed 500 characters"),L(oe),Object.keys(oe).length===0},J=oe=>{const{name:Ne,value:_e}=oe.target;ce(Ue=>({...Ue,[Ne]:_e})),me[Ne]&&L(Ue=>({...Ue,[Ne]:""}))},Se=async oe=>{if(oe.preventDefault(),!y&&await Ye()){v(!0);try{const Ne=await he(W.fromDate,W.toDate),_e={...W,totalDays:Ne};await xe.post("/leave/create",_e,{headers:{Authorization:`Bearer ${e}`}}),Ze.success("Leave applied successfully!"),S(!1),ce({leaveType:h[0]?.name||"",fromDate:"",toDate:"",reason:""}),$e(),we()}catch(Ne){console.error("Error applying leave:",Ne);const _e=Ne.response?.data?.message||"Error applying leave. Please try again.";Ze.error(_e)}finally{v(!1)}}},Ie=async oe=>{if(!w){A(!0);try{await xe.put(`/leave/requests/${oe}/cancel`,{},{headers:{Authorization:`Bearer ${e}`}}),Ze.success("Leave cancelled successfully!"),we()}catch(Ne){console.error("Error cancelling leave:",Ne),Ze.error(Ne.response?.data?.message||"Error cancelling leave")}finally{A(!1)}}},Xe=()=>{D(""),H("all"),P("all"),u(i)},wt=oe=>{switch(oe){case"sick":return r.jsx(qd,{size:16,className:"text-red-400 mr-2"});case"casual":return r.jsx(Ud,{size:16,className:"text-purple-400 mr-2"});case"paid":return r.jsx(js,{size:16,className:"text-green-400 mr-2"});default:return r.jsx(Es,{size:16,className:"text-blue-400 mr-2"})}},qt=oe=>oe.replace(/_/g," ").replace(/\b\w/g,Ne=>Ne.toUpperCase());return p?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#104774]"})}):r.jsxs("div",{className:"p-4 md:p-6 space-y-6 bg-gray-50 min-h-[80vh",children:[r.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Leave Management"}),r.jsxs("button",{onClick:()=>S(!0),className:"flex items-center bg-[#104774] text-white px-4 md:px-6 py-2 md:py-3 rounded-lg font-medium hover:bg-[#0d3a61] transition-all duration-200 w-full md:w-auto justify-center",children:[r.jsx(Ii,{size:20,className:"mr-2"}),"Apply For Leave"]})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:Object.entries(t).map(([oe,Ne])=>r.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${oe==="sick"?"bg-red-300":oe==="casual"?"bg-purple-300":"bg-green-400"}`}),r.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:qt(oe)})]}),oe==="sick"?r.jsx(qd,{size:18,className:"text-red-300"}):oe==="casual"?r.jsx(Ud,{size:18,className:"text-purple-300"}):r.jsx(js,{size:18,className:"text-green-400"})]}),r.jsxs("div",{className:"text-2xl font-bold text-gray-800 mb-2",children:[Ne," ",r.jsx("span",{className:"text-sm font-medium text-gray-500",children:"days left"})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:`h-2 rounded-full ${oe==="sick"?"bg-red-300":oe==="casual"?"bg-purple-300":"bg-green-400"}`,style:{width:`${Math.min(Ne/10*100,100)}%`}})})]},oe))}),r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[r.jsxs("div",{className:"p-4 border-b border-gray-100 flex flex-col lg:flex-row justify-between items-start lg:items-center gap-3",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(Es,{size:24,className:"text-[#104774] mr-3"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Leave Application History"})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full lg:w-auto",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(Rp,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),r.jsx("input",{type:"text",placeholder:"Search leaves...",value:R,onChange:oe=>D(oe.target.value),className:"pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] w-full"})]}),r.jsxs("button",{onClick:()=>C(!E),className:"flex items-center px-3 py-2 border rounded-lg hover:bg-gray-50 text-sm",children:[r.jsx(o1,{size:16,className:"mr-2"}),"Filters",E?r.jsx(mo,{size:14,className:"ml-1"}):r.jsx(fo,{size:14,className:"ml-1"})]})]})]}),E&&r.jsx("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),r.jsxs("select",{value:O,onChange:oe=>H(oe.target.value),className:"w-full border rounded-lg p-2 text-sm",children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"rejected",children:"Rejected"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Leave Type"}),r.jsxs("select",{value:F,onChange:oe=>P(oe.target.value),className:"w-full border rounded-lg p-2 text-sm",children:[r.jsx("option",{value:"all",children:"All Types"}),h.map(oe=>r.jsxs("option",{value:oe.name,children:[qt(oe.name)," (",t[oe.name]??0," left)"]},oe._id))]})]}),r.jsx("div",{className:"flex items-end",children:r.jsx("button",{onClick:Xe,className:"px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 text-sm",children:"Reset Filters"})})]})}),r.jsx("div",{className:"overflow-x-auto",children:r.jsx("div",{className:"max-h-[400px] overflow-y-auto border border-gray-200 rounded-lg shadow-md",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Date Range"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Type"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Days"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm hidden md:table-cell",children:"Reason"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Status"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm hidden lg:table-cell",children:"Applied On"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Actions"})]})}),r.jsx("tbody",{children:be.length>0?be.map((oe,Ne)=>{const _e=Ue=>new Date(Ue).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"});return r.jsxs("tr",{className:`transition-colors ${Ne%2===0?"bg-white hover:bg-gray-50":"bg-gray-100 hover:bg-gray-200"}`,children:[r.jsx("td",{className:"p-3 font-medium text-gray-800 text-sm",children:`${_e(oe.fromDate)} – ${_e(oe.toDate)}`}),r.jsx("td",{className:"p-3",children:r.jsxs("div",{className:"flex items-center gap-1",children:[wt(oe.leaveType),r.jsx("span",{className:"text-gray-700 capitalize text-sm",children:qt(oe.leaveType)})]})}),r.jsxs("td",{className:"p-3 text-sm",children:[oe.totalDays," ",oe.totalDays===1?"day":"days"]}),r.jsx("td",{className:"p-3 text-gray-600 text-sm hidden md:table-cell max-w-xs",children:r.jsxs("div",{className:"relative group w-fit",children:[r.jsx("span",{className:"truncate block max-w-[150px] cursor-help",children:oe.reason||"-"}),oe.reason&&r.jsxs("div",{className:"absolute left-0 bottom-full mb-2 hidden group-hover:flex bg-gray-900 text-white text-xs px-3 py-2 rounded-lg shadow-lg whitespace-normal max-w-xs z-50",children:[r.jsx("span",{className:"leading-snug",children:oe.reason}),r.jsx("div",{className:"absolute left-3 top-full w-2 h-2 bg-gray-900 rotate-45"})]})]})}),r.jsx("td",{className:"p-3",children:r.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${oe.status==="approved"?"bg-green-100 text-green-700 border border-green-200":oe.status==="pending"?"bg-yellow-100 text-yellow-700 border border-yellow-200":oe.status==="rejected"?"bg-red-100 text-red-700 border border-red-200":"bg-gray-100 text-gray-700 border border-gray-200"}`,children:[oe.status==="approved"&&r.jsx(js,{size:12,className:"mr-1"}),oe.status==="pending"&&r.jsx(pn,{size:12,className:"mr-1"}),oe.status==="rejected"&&r.jsx(mn,{size:12,className:"mr-1"}),oe.status.charAt(0).toUpperCase()+oe.status.slice(1)]})}),r.jsx("td",{className:"p-3 text-gray-600 text-sm hidden lg:table-cell",children:_e(oe.appliedAt)}),r.jsx("td",{className:"p-3",children:oe.status==="pending"&&r.jsxs("button",{onClick:()=>Ie(oe._id),disabled:w,className:"flex items-center text-red-600 hover:text-red-800 text-xs font-medium disabled:opacity-50",children:[r.jsx(kp,{size:12,className:"mr-1"}),w?"...":"Cancel"]})})]},Ne)}):r.jsx("tr",{children:r.jsx("td",{colSpan:"7",className:"p-6 text-center text-gray-500 text-sm",children:i.length===0?"No leave applications found. Apply for your first leave!":"No leaves match your filters."})})})]})})}),ve>1&&r.jsxs("div",{className:"p-4 border-t border-gray-100 flex flex-col sm:flex-row justify-between items-center gap-3",children:[r.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",te+1," to"," ",Math.min(ke,c.length)," of"," ",c.length," entries"]}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("button",{onClick:()=>z(oe=>Math.max(oe-1,1)),disabled:Z===1,className:"px-2 py-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Prev"}),Array.from({length:Math.min(5,ve)},(oe,Ne)=>{let _e;return ve<=5||Z<=3?_e=Ne+1:Z>=ve-2?_e=ve-4+Ne:_e=Z-2+Ne,r.jsx("button",{onClick:()=>z(_e),className:`px-2 py-1 rounded border text-sm ${Z===_e?"bg-[#104774] text-white border-[#104774]":"border-gray-300"}`,children:_e},_e)}),r.jsx("button",{onClick:()=>z(oe=>Math.min(oe+1,ve)),disabled:Z===ve,className:"px-2 py-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Next"})]})]})]}),N&&r.jsx("div",{className:"fixed inset-0 backdrop-blur-md bg-opacity-40 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-xl p-4 w-full max-w-md relative max-h-[90vh] overflow-y-auto",children:[r.jsx("button",{onClick:()=>S(!1),className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600",children:r.jsx(Zr,{size:20})}),r.jsx("h2",{className:"text-xl font-bold mb-4",children:"Apply for Leave"}),W.leaveType&&t[W.leaveType]!==void 0&&r.jsx("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:r.jsxs("p",{className:"text-blue-800 font-medium text-sm",children:["Available ",qt(W.leaveType)," leave:"," ",t[W.leaveType]," days"]})}),r.jsxs("form",{onSubmit:Se,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"Leave Type"}),r.jsxs("select",{name:"leaveType",value:W.leaveType,onChange:Ee,className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",required:!0,children:[r.jsx("option",{value:"",children:"Select Leave Type"}),h.map(oe=>r.jsxs("option",{value:oe.name,children:[qt(oe.name)," (",t[oe.name]??0," left)"]},oe._id))]}),me.leaveType&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(as,{size:12,className:"mr-1"})," ",me.leaveType]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"From Date"}),r.jsx("input",{type:"date",name:"fromDate",value:W.fromDate,onChange:J,min:new Date().toISOString().split("T")[0],className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",required:!0}),me.fromDate&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(as,{size:12,className:"mr-1"})," ",me.fromDate]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"To Date"}),r.jsx("input",{type:"date",name:"toDate",value:W.toDate,onChange:J,min:W.fromDate||new Date().toISOString().split("T")[0],className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",required:!0}),me.toDate&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(as,{size:12,className:"mr-1"})," ",me.toDate]})]}),W.fromDate&&W.toDate&&r.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[r.jsx("p",{className:"text-gray-700 font-medium text-sm",children:V?"Calculating...":`Working Days: ${G??0}`}),r.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"(Excludes Sundays and Indian public holidays)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"Reason"}),r.jsx("textarea",{name:"reason",value:W.reason,onChange:Ee,rows:3,className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",placeholder:"Please provide a reason for your leave",required:!0}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[W.reason.length,"/500 characters"]}),me.reason&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(as,{size:12,className:"mr-1"})," ",me.reason]})]}),r.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[r.jsx("button",{type:"button",onClick:()=>S(!1),className:"px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 text-sm",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:y,className:"px-4 py-2 rounded-lg bg-[#104774] text-white hover:bg-[#0d3a61] disabled:opacity-50 text-sm",children:y?"Submitting...":"Submit"})]})]})]})})]})}const NO=()=>{const{token:n,user:e}=ls(),[t,s]=_.useState("employeeLeaves"),[i,l]=_.useState([]),[c,u]=_.useState([]),[h,m]=_.useState([]),[p,x]=_.useState({}),[y,v]=_.useState([]),[w,A]=_.useState(null),[N,S]=_.useState(""),[E,C]=_.useState(!1),[R,D]=_.useState(!1),[O,H]=_.useState(""),[F,P]=_.useState(!1),[Z,z]=_.useState(!1),[K,W]=_.useState(!1),[ce,me]=_.useState(""),[L,q]=_.useState("pending"),[$,I]=_.useState("all"),[T,V]=_.useState(null),[M,G]=_.useState(1),[de]=_.useState(10),[re,ye]=_.useState({key:null,direction:"ascending"}),[je,Le]=_.useState({}),[he,$e]=_.useState(!1),[ge,we]=_.useState(!1),[ke,te]=_.useState(null),be=_.useRef(0),[ve,Ee]=_.useState({leaveType:"",fromDate:"",toDate:"",reason:""}),[Ye,J]=_.useState({}),Se=X=>(X instanceof Date||(X=new Date(X)),Number.isNaN(X.getTime())?null:X.toISOString().slice(0,10)),Ie=X=>{if(!X||!X.start)return null;const Ae=X.start,De=Ae.date||Ae.dateTime||Ae?.dateTime;if(!De)return null;const Qe=new Date(De);return Number.isNaN(Qe.getTime())?null:Se(Qe)},Xe=async X=>{if(je[X])return je[X];try{const Ae="AIzaSyBG-v7rJFHD3hgzTW802GaGTa-gA_n3J3A",De=`${X}-01-01T00:00:00Z`,Qe=`${X}-12-31T23:59:59Z`,At=`https://www.googleapis.com/calendar/v3/calendars/en.indian%23holiday%40group.v.calendar.google.com/events?key=${Ae}&timeMin=${De}&timeMax=${Qe}&maxResults=500`,Cs=((await(await fetch(At)).json()).items||[]).filter(qs=>{const Ts=(qs.summary||"").toLowerCase(),bn=(qs.description||"").toLowerCase(),ms=(qs.visibility||"").toLowerCase();return!!(bn.includes("public holiday")||Ts.includes("holiday")||ms==="public"&&!bn.includes("observance"))}),yn=new Set;return Cs.forEach(qs=>{const Ts=Ie(qs);Ts&&yn.add(Ts)}),Le(qs=>({...qs,[X]:yn})),yn}catch(Ae){return console.error("Error fetching Indian holidays for year",X,Ae),Le(De=>({...De,[X]:new Set})),new Set}},wt=async(X,Ae)=>{$e(!0);const De=++be.current;try{const Qe=new Date(X),At=new Date(Ae);if(Number.isNaN(Qe.getTime())||Number.isNaN(At.getTime())||Qe>At)return 0;const bt=new Set,St=Qe.getFullYear(),tn=At.getFullYear();for(let ms=St;ms<=tn;ms++)bt.add(ms);const Cs={};for(const ms of bt)Cs[ms]=await Xe(ms);const yn=ms=>{const vn=Se(ms);if(!vn)return!1;const Mn=new Date(ms).getFullYear(),wa=Cs[Mn];return wa?wa.has(vn):!1};let qs=0;const Ts=new Date(Qe);Ts.setHours(0,0,0,0);const bn=new Date(At);for(bn.setHours(0,0,0,0);Ts<=bn;){const vn=Ts.getDay()===0,Mn=yn(Ts);!vn&&!Mn&&qs++,Ts.setDate(Ts.getDate()+1)}return De===be.current&&te(qs),qs}catch(Qe){return console.error("Error calculating working days:",Qe),De===be.current&&te(null),0}finally{$e(!1)}},qt=async()=>{try{const Ae=(await xe.get("/leave/get-leaveTypes",{headers:{Authorization:`Bearer ${n}`}})).data.filter(De=>De.isActive);v(Ae),Ae.length>0&&!ve.leaveType&&Ee(De=>({...De,leaveType:Ae[0].name}))}catch(X){console.error("Error fetching leave types:",X),Ze.error("Failed to fetch leave types")}},oe=async()=>{P(!0);try{const Ae=(await xe.get("/leave/requests",{headers:{Authorization:`Bearer ${n}`}})).data.filter(De=>De.employee?.role==="employee");l(Ae),m(Ae)}catch(X){console.error("Error fetching employee leave requests:",X),Ze.error("Failed to fetch employee leave requests")}finally{P(!1)}},Ne=async()=>{try{const X=await xe.get("/leave/my-requests",{headers:{Authorization:`Bearer ${n}`}});u(X.data)}catch(X){console.error("Error fetching my leave requests:",X),Ze.error("Failed to fetch your leave requests")}},_e=async()=>{try{const X=await xe.get("/leave/balance",{headers:{Authorization:`Bearer ${n}`}});x(X.data.balance||{})}catch(X){console.error("Error fetching leave balance:",X),Ze.error("Failed to fetch leave balance")}};_.useEffect(()=>{n&&(qt(),_e(),t==="employeeLeaves"?oe():Ne(),Xe(new Date().getFullYear()).then(()=>{}))},[n,t]),_.useEffect(()=>{if(t!=="employeeLeaves")return;let X=i;if(ce){const Ae=ce.toLowerCase();X=X.filter(De=>De.employee?.email?.toLowerCase().includes(Ae)||De.leaveType?.toLowerCase().includes(Ae)||De.reason?.toLowerCase().includes(Ae))}L!=="all"&&(X=X.filter(Ae=>Ae.status===L)),$!=="all"&&(X=X.filter(Ae=>Ae.leaveType===$)),m(X),G(1)},[ce,L,$,i,t]);const Ue=X=>{let Ae="ascending";re.key===X&&re.direction==="ascending"&&(Ae="descending"),ye({key:X,direction:Ae});const De=[...h].sort((Qe,At)=>{let bt,St;if(X.includes(".")){const tn=X.split(".");bt=tn.reduce((Cs,yn)=>Cs&&Cs[yn],Qe),St=tn.reduce((Cs,yn)=>Cs&&Cs[yn],At)}else bt=Qe[X],St=At[X];return bt==null?1:St==null?-1:bt<St?Ae==="ascending"?-1:1:bt>St?Ae==="ascending"?1:-1:0});m(De)},dt=M*de,Qt=dt-de,Qn=h.slice(Qt,dt),Rt=Math.ceil(h.length/de),en=async()=>{const X={},Ae=new Date().setHours(0,0,0,0),De=new Date(ve.fromDate).setHours(0,0,0,0);if(ve.leaveType||(X.leaveType="Leave type is required"),ve.fromDate||(X.fromDate="From date is required"),ve.toDate||(X.toDate="To date is required"),ve.fromDate&&ve.toDate){new Date(ve.fromDate)>new Date(ve.toDate)&&(X.toDate="To date cannot be before from date"),De<Ae&&(X.fromDate="Cannot apply for backdated leaves");const Qe=await wt(ve.fromDate,ve.toDate),At=p[ve.leaveType]??0;At<Qe&&(X.leaveType=`Insufficient ${ve.leaveType} leave balance! You have ${At} days left.`)}return ve.reason?.trim()||(X.reason="Reason is required"),ve.reason?.length>500&&(X.reason="Reason cannot exceed 500 characters"),J(X),Object.keys(X).length===0},zs=X=>{const{name:Ae,value:De}=X.target;Ee(Qe=>({...Qe,[Ae]:De})),Ye[Ae]&&J(Qe=>({...Qe,[Ae]:""}))};_.useEffect(()=>((async()=>{ve.fromDate&&ve.toDate?(te(null),await wt(ve.fromDate,ve.toDate)):te(null)})(),()=>{}),[ve.fromDate,ve.toDate]);const vs=X=>{const{name:Ae,value:De}=X.target;Ee(Qe=>({...Qe,[Ae]:De})),Ye[Ae]&&J(Qe=>({...Qe,[Ae]:""}))},gn=async X=>{if(X.preventDefault(),!Z&&await en()){z(!0);try{const Ae=await wt(ve.fromDate,ve.toDate),De={...ve,totalDays:Ae};await xe.post("/leave/create",De,{headers:{Authorization:`Bearer ${n}`}}),Ze.success("Leave applied successfully!"),C(!1),Ee({leaveType:y[0]?.name||"",fromDate:"",toDate:"",reason:""}),J({}),_e(),Ne()}catch(Ae){console.error("Error applying for leave:",Ae);const De=Ae.response?.data?.message||"Error applying leave. Please try again.";Ze.error(De)}finally{z(!1)}}},Fs=async(X,Ae)=>{try{await xe.post(`/leave/${X}/review`,{action:Ae,reason:N||`${Ae}ed by HR`},{headers:{Authorization:`Bearer ${n}`}}),A(null),S(""),D(!1),oe(),_e(),Ze.success(`Leave ${Ae}ed successfully!`)}catch(De){console.error("Error updating leave:",De);const Qe=De.response?.data?.message||"Error processing leave request.";Ze.error(Qe)}},ii=async X=>{if(!K){W(!0);try{await xe.put(`/leave/requests/${X}/cancel`,{},{headers:{Authorization:`Bearer ${n}`}}),Ze.success("Leave cancelled successfully!"),Ne(),_e()}catch(Ae){console.error("Error cancelling leave:",Ae),Ze.error(Ae.response?.data?.message||"Error cancelling leave")}finally{W(!1)}}},ri=()=>{me(""),q("all"),I("all"),m(i)},xn=({status:X})=>{const Ae={approved:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",icon:js},pending:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",icon:pn},rejected:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",icon:mn},cancelled:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-200",icon:mn}},De=Ae[X]||Ae.pending,Qe=De.icon;return r.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${De.bg} ${De.text} ${De.border}`,children:[r.jsx(Qe,{size:12,className:"mr-1"}),X]})},Ji=X=>{switch(X){case"sick":return r.jsx(qd,{size:16,className:"text-red-400 mr-2"});case"casual":return r.jsx(Ud,{size:16,className:"text-purple-400 mr-2"});case"paid":return r.jsx(js,{size:16,className:"text-green-400 mr-2"});default:return r.jsx(Es,{size:16,className:"text-blue-400 mr-2"})}},Us=X=>X.replace(/_/g," ").replace(/\b\w/g,Ae=>Ae.toUpperCase()),er=({title:X,value:Ae,subtitle:De,icon:Qe,color:At})=>r.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-2xl font-bold text-gray-800",children:Ae}),r.jsx("p",{className:"text-sm font-medium text-gray-600",children:X}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:De})]}),r.jsx("div",{className:`p-3 rounded-full ${At}`,children:r.jsx(Qe,{size:24,className:"text-white"})})]})}),li=(()=>{const X=new Date().getMonth(),Ae=new Date().getFullYear(),De=i.filter(Qe=>{const At=new Date(Qe.fromDate);return At.getMonth()===X&&At.getFullYear()===Ae});return{total:De.length,pending:De.filter(Qe=>Qe.status==="pending").length,approved:De.filter(Qe=>Qe.status==="approved").length,rejected:De.filter(Qe=>Qe.status==="rejected").length}})();return r.jsxs("div",{className:"p-4 md:p-6 space-y-6 bg-gray-50 min-h-[80vh]",children:[r.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"HR Leave Management"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:r.jsxs("button",{className:"flex items-center bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-all duration-200 text-sm md:text-base",onClick:()=>{_e(),t==="employeeLeaves"?oe():Ne()},children:[r.jsx(zi,{size:18,className:"mr-2"})," Refresh"]})})]}),r.jsx("div",{className:"bg-white rounded-xl p-1 shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex",children:[r.jsx("button",{className:`flex-1 py-3 px-4 text-center font-medium rounded-lg transition-all duration-200 text-sm md:text-base ${t==="employeeLeaves"?"bg-[#104774] text-white shadow":"text-gray-600 hover:text-[#104774]"}`,onClick:()=>s("employeeLeaves"),children:r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx(Vd,{size:18,className:"mr-2"}),"Employee Leaves"]})}),r.jsx("button",{className:`flex-1 py-3 px-4 text-center font-medium rounded-lg transition-all duration-200 text-sm md:text-base ${t==="myLeaves"?"bg-[#104774] text-white shadow":"text-gray-600 hover:text-[#104774]"}`,onClick:()=>s("myLeaves"),children:r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx(bo,{size:18,className:"mr-2"}),"My Leaves"]})})]})}),t==="employeeLeaves"&&r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4",children:[r.jsx(er,{title:"Total Requests",value:li.total,subtitle:"This Month",icon:Es,color:"bg-blue-500"}),r.jsx(er,{title:"Pending",value:li.pending,subtitle:"Require Action",icon:pn,color:"bg-yellow-500"}),r.jsx(er,{title:"Approved",value:li.approved,subtitle:"This month",icon:js,color:"bg-green-500"}),r.jsx(er,{title:"Rejected",value:li.rejected,subtitle:"Leaves",icon:mn,color:"bg-red-500"})]}),t==="myLeaves"&&r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-4",children:Object.entries(p).map(([X,Ae])=>r.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${X==="sick"?"bg-red-300":X==="casual"?"bg-purple-300":"bg-green-400"}`}),r.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:Us(X)})]}),X==="sick"?r.jsx(qd,{size:18,className:"text-red-300"}):X==="casual"?r.jsx(Ud,{size:18,className:"text-purple-300"}):r.jsx(js,{size:18,className:"text-green-400"})]}),r.jsxs("div",{className:"text-2xl font-bold text-gray-800 mb-2",children:[Ae," ",r.jsx("span",{className:"text-sm font-medium text-gray-500",children:"days left"})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:r.jsx("div",{className:`h-2 rounded-full ${X==="sick"?"bg-red-300":X==="casual"?"bg-purple-300":"bg-green-400"}`,style:{width:`${Math.min(Ae/10*100,100)}%`}})}),r.jsxs("div",{className:"text-xs text-gray-500",children:["As of ",new Date().toLocaleDateString()]})]},X))}),t==="employeeLeaves"&&r.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(Rp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),r.jsx("input",{type:"text",placeholder:"Search by employee, type, or reason...",value:ce,onChange:X=>me(X.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm md:text-base"})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs("button",{onClick:()=>we(!ge),className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 md:hidden text-sm",children:[r.jsx(o1,{size:16,className:"mr-2"}),"Filters"]}),r.jsxs("div",{className:`${ge?"flex":"hidden"} md:flex flex-col md:flex-row gap-2 w-full md:w-auto`,children:[r.jsxs("select",{value:L,onChange:X=>q(X.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm md:text-base",children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"rejected",children:"Rejected"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]}),r.jsxs("select",{value:$,onChange:X=>I(X.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm md:text-base",children:[r.jsx("option",{value:"all",children:"All Types"}),y.map(X=>r.jsx("option",{value:X.name,children:Us(X.name)},X._id))]}),r.jsx("button",{onClick:ri,className:"px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm md:text-base",children:"Reset"})]})]})]}),r.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Showing ",h.length," of ",i.length," ","requests"]})]}),t==="employeeLeaves"?r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center space-x-3",children:[r.jsx(Vd,{size:24,className:"text-[#104774]"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Employee Leave Requests"})]}),F?r.jsxs("div",{className:"p-8 text-center",children:[r.jsx(zi,{className:"animate-spin mx-auto text-[#104774]",size:32}),r.jsx("p",{className:"mt-2 text-gray-500",children:"Loading employee leave requests..."})]}):h.length===0?r.jsx("div",{className:"p-8 text-center",children:r.jsx("p",{className:"text-gray-500",children:"No employee leave requests found"})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsx("div",{className:"max-h-[350px] overflow-y-auto border border-gray-200 rounded-lg shadow-sm",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase cursor-pointer select-none",onClick:()=>Ue("employee.email"),children:["Employee"," ",re.key==="employee.email"&&(re.direction==="ascending"?r.jsx(mo,{size:14,className:"inline"}):r.jsx(fo,{size:14,className:"inline"}))]}),r.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase cursor-pointer select-none",onClick:()=>Ue("leaveType"),children:["Type"," ",re.key==="leaveType"&&(re.direction==="ascending"?r.jsx(mo,{size:14,className:"inline"}):r.jsx(fo,{size:14,className:"inline"}))]}),r.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase cursor-pointer select-none",onClick:()=>Ue("fromDate"),children:["From"," ",re.key==="fromDate"&&(re.direction==="ascending"?r.jsx(mo,{size:14,className:"inline"}):r.jsx(fo,{size:14,className:"inline"}))]}),r.jsxs("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase cursor-pointer select-none",onClick:()=>Ue("toDate"),children:["To"," ",re.key==="toDate"&&(re.direction==="ascending"?r.jsx(mo,{size:14,className:"inline"}):r.jsx(fo,{size:14,className:"inline"}))]}),r.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase",children:"Days"}),r.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase",children:"Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium uppercase",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Qn.map((X,Ae)=>{const De=X.currentRemaining?.[X.leaveType]>=X.totalDays;return r.jsxs(Eo.Fragment,{children:[r.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[r.jsx("td",{className:"px-4 py-3 text-sm",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"bg-gray-200 rounded-full p-1 mr-2",children:r.jsx(u1,{size:14,className:"text-gray-600"})}),X.employee?.email||"N/A"]})}),r.jsx("td",{className:"px-4 py-3 text-sm",children:r.jsxs("div",{className:"flex items-center gap-1",children:[Ji(X.leaveType),r.jsx("span",{className:"capitalize",children:Us(X.leaveType)})]})}),r.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(X.fromDate).toLocaleDateString()}),r.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(X.toDate).toLocaleDateString()}),r.jsx("td",{className:"px-4 py-3 text-sm",children:X.totalDays}),r.jsx("td",{className:"px-4 py-3",children:r.jsx(xn,{status:X.status})}),r.jsx("td",{className:"px-4 py-3",children:r.jsxs("div",{className:"flex space-x-2 items-center",children:[r.jsx("button",{className:"text-[#104774] hover:text-[#0d3a61] p-1 rounded",onClick:()=>V(T===X._id?null:X._id),title:"View Details",children:r.jsx(To,{size:16})}),X.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"text-green-600 hover:text-green-800 p-1 rounded",onClick:()=>{A(X),H("approve"),D(!0)},title:"Approve",children:r.jsx(js,{size:16})}),r.jsx("button",{className:"text-red-600 hover:text-red-800 p-1 rounded",onClick:()=>{A(X),H("reject"),D(!0)},title:"Reject",children:r.jsx(mn,{size:16})})]})]})})]}),T===X._id&&r.jsx("tr",{className:"bg-gray-50",children:r.jsx("td",{colSpan:7,className:"p-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium mb-2",children:"Request Details"}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Reason:"})," ",X.reason||"-"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Applied On:"})," ",new Date(X.appliedAt).toLocaleString()]}),X.processedBy&&r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Processed By:"})," ",X.processedBy?.email||"Admin"]}),X.processedAt&&r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Processed At:"})," ",new Date(X.processedAt).toLocaleString()]}),X.remarks&&r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Remarks:"})," ",X.remarks]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium mb-2",children:"Balance Information"}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Remaining at request:"})," ",X.balanceSnapshot?.remaining?.[X.leaveType]??"-"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Current remaining:"})," ",X.currentRemaining?.[X.leaveType]??"-"]}),!De&&r.jsxs("p",{className:"text-red-600 font-medium mt-2 flex items-center",children:[r.jsx(as,{size:14,className:"inline mr-1"}),"Insufficient balance for this request"]})]})]})})})]},X._id)})})]})})}),Rt>1&&r.jsxs("div",{className:"p-4 border-t border-gray-200 flex flex-col sm:flex-row justify-between items-center gap-3",children:[r.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",Qt+1," to"," ",Math.min(dt,h.length)," of"," ",h.length," entries"]}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("button",{onClick:()=>G(X=>Math.max(X-1,1)),disabled:M===1,className:"px-2 py-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Prev"}),Array.from({length:Math.min(5,Rt)},(X,Ae)=>{let De;return Rt<=5||M<=3?De=Ae+1:M>=Rt-2?De=Rt-4+Ae:De=M-2+Ae,r.jsx("button",{onClick:()=>G(De),className:`px-2 py-1 rounded border text-sm ${M===De?"bg-[#104774] text-white border-[#104774]":"border-gray-300"}`,children:De},De)}),r.jsx("button",{onClick:()=>G(X=>Math.min(X+1,Rt)),disabled:M===Rt,className:"px-2 py-1 rounded border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Next"})]})]})]})]}):r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(bo,{size:24,className:"text-[#104774]"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"My Leave Requests"})]}),r.jsxs("button",{className:"flex items-center bg-[#104774] text-white px-4 py-2 rounded-lg font-medium hover:bg-[#0d3a61] transition-all duration-200 text-sm md:text-base",onClick:()=>C(!0),children:[r.jsx(Ii,{size:18,className:"mr-2"})," Apply For Leave"]})]}),c.length===0?r.jsx("div",{className:"p-8 text-center",children:r.jsx("p",{className:"text-gray-500",children:"No leave requests found. Apply for your first leave!"})}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{className:"bg-[#104774] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Date Range"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Type"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Days"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm hidden md:table-cell",children:"Reason"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Status"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm hidden lg:table-cell",children:"Applied On"}),r.jsx("th",{className:"p-3 text-left font-medium text-sm",children:"Actions"})]})}),r.jsx("tbody",{children:c.map(X=>{X.currentRemaining&&X.currentRemaining[X.leaveType]>=X.totalDays;const Ae=De=>De?new Date(De).toLocaleDateString("en-GB",{day:"numeric",month:"short"}):"-";return r.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50 transition-colors",children:[r.jsx("td",{className:"p-3 font-medium text-gray-800 text-sm",children:`${Ae(X.fromDate)} to ${Ae(X.toDate)}`}),r.jsx("td",{className:"p-3 text-sm",children:r.jsxs("div",{className:"flex items-center gap-1",children:[Ji(X.leaveType),r.jsx("span",{className:"capitalize",children:Us(X.leaveType)})]})}),r.jsx("td",{className:"p-3 text-sm",children:X.totalDays}),r.jsxs("td",{className:"p-3 text-gray-600 text-sm hidden md:table-cell max-w-xs truncate cursor-pointer relative group",title:X.reason,children:[X.reason||"-",X.reason&&r.jsx("div",{className:"absolute hidden group-hover:block bg-gray-800 text-white text-xs rounded-md px-3 py-2 w-64 z-20 -top-1 left-1/2 -translate-x-1/2 shadow-lg",children:X.reason})]}),r.jsx("td",{className:"p-3",children:r.jsx(xn,{status:X.status})}),r.jsx("td",{className:"p-3 text-gray-600 text-sm hidden lg:table-cell",children:new Date(X.appliedAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),r.jsx("td",{className:"p-3",children:X.status==="pending"&&r.jsxs("button",{onClick:()=>ii(X._id),disabled:K,className:"flex items-center text-red-600 hover:text-red-800 text-xs font-medium disabled:opacity-50",children:[r.jsx(kp,{size:12,className:"mr-1"}),K?"...":"Cancel"]})})]},X._id)})})]})})]}),E&&r.jsx("div",{className:"fixed inset-0  bg-opacity-40 backdrop-blur-xs flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-xl p-4 w-full max-w-md relative max-h-[90vh] overflow-y-auto",children:[r.jsx("button",{onClick:()=>{C(!1),J({})},className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600",children:r.jsx(Zr,{size:20})}),r.jsx("h2",{className:"text-xl font-bold mb-4",children:"Apply for Leave"}),ve.leaveType&&p[ve.leaveType]!==void 0&&r.jsx("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:r.jsxs("p",{className:"text-blue-800 font-medium text-sm",children:["Available ",Us(ve.leaveType)," leave:"," ",p[ve.leaveType]," days"]})}),r.jsxs("form",{onSubmit:gn,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"Leave Type"}),r.jsxs("select",{name:"leaveType",value:ve.leaveType,onChange:zs,className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",required:!0,children:[r.jsx("option",{value:"",children:"Select Leave Type"}),y.map(X=>r.jsx("option",{value:X.name,children:Us(X.name)},X._id))]}),Ye.leaveType&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(as,{size:12,className:"mr-1"})," ",Ye.leaveType]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"From Date"}),r.jsx("input",{type:"date",name:"fromDate",value:ve.fromDate,onChange:vs,min:new Date().toISOString().split("T")[0],className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",required:!0}),Ye.fromDate&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(as,{size:12,className:"mr-1"})," ",Ye.fromDate]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"To Date"}),r.jsx("input",{type:"date",name:"toDate",value:ve.toDate,onChange:vs,min:ve.fromDate||new Date().toISOString().split("T")[0],className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",required:!0}),Ye.toDate&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(as,{size:12,className:"mr-1"})," ",Ye.toDate]})]})]}),ve.fromDate&&ve.toDate&&r.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[r.jsx("p",{className:"text-gray-700 font-medium text-sm",children:he?"Calculating...":`Working Days: ${ke??0}`}),r.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"(Excludes Sundays and Indian public holidays)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 font-medium text-sm",children:"Reason"}),r.jsx("textarea",{name:"reason",value:ve.reason,onChange:zs,rows:3,className:"w-full border rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",placeholder:"Please provide a reason for your leave",required:!0}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[ve.reason.length,"/500 characters"]}),Ye.reason&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(as,{size:12,className:"mr-1"})," ",Ye.reason]})]}),r.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[r.jsx("button",{type:"button",onClick:()=>{C(!1),J({})},className:"px-3 py-2 rounded-lg border border-gray-300 hover:bg-gray-50 text-sm",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:Z,className:"px-3 py-2 rounded-lg bg-[#104774] text-white hover:bg-[#0d3a61] disabled:opacity-50 text-sm",children:Z?"Submitting...":"Submit"})]})]})]})}),R&&w&&r.jsx("div",{className:"fixed inset-0 backdrop-blur-xs bg-opacity-40 flex items-center justify-center z-50 p-4 shadow-2xl",children:r.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl w-full max-w-md",children:[r.jsxs("h3",{className:"text-lg font-semibold mb-4",children:[O==="approve"?"Approve":"Reject"," Leave Request"]}),r.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[r.jsxs("p",{className:"text-sm",children:[r.jsx("strong",{children:"Employee:"})," ",w.employee?.email]}),r.jsxs("p",{className:"text-sm",children:[r.jsx("strong",{children:"Type:"})," ",Us(w.leaveType)]}),r.jsxs("p",{className:"text-sm",children:[r.jsx("strong",{children:"Duration:"})," ",w.totalDays," days"]}),r.jsxs("p",{className:"text-sm",children:[r.jsx("strong",{children:"Reason:"})," ",w.reason||"-"]}),w.currentRemaining&&r.jsxs("p",{className:`text-sm mt-2 ${w.currentRemaining[w.leaveType]<w.totalDays?"text-red-600 font-medium":""}`,children:[r.jsx("strong",{children:"Remaining Balance:"})," ",w.currentRemaining[w.leaveType],"/",w.balanceSnapshot?.remaining[w.leaveType],w.currentRemaining[w.leaveType]<w.totalDays&&r.jsx("span",{className:"ml-1",children:"(Insufficient balance)"})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Remarks (Optional)"}),r.jsx("textarea",{value:N,onChange:X=>S(X.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",rows:"3",placeholder:"Add remarks for this action..."})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{className:"px-3 py-2 rounded-lg bg-gray-300 hover:bg-gray-400 transition-colors text-sm",onClick:()=>{D(!1),S("")},children:"Cancel"}),r.jsx("button",{className:`px-3 py-2 rounded-lg text-white transition-colors text-sm ${O==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,onClick:()=>Fs(w._id,O),children:O==="approve"?"Approve":"Reject"})]})]})})]})},MN=6048e5,SO=864e5,dw=Symbol.for("constructDateFrom");function si(n,e){return typeof n=="function"?n(e):n&&typeof n=="object"&&dw in n?n[dw](e):n instanceof Date?new n.constructor(e):new Date(e)}function kn(n,e){return si(e||n,n)}let jO={};function Pu(){return jO}function Io(n,e){const t=Pu(),s=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,i=kn(n,e?.in),l=i.getDay(),c=(l<s?7:0)+l-s;return i.setDate(i.getDate()-c),i.setHours(0,0,0,0),i}function ou(n,e){return Io(n,{...e,weekStartsOn:1})}function LN(n,e){const t=kn(n,e?.in),s=t.getFullYear(),i=si(t,0);i.setFullYear(s+1,0,4),i.setHours(0,0,0,0);const l=ou(i),c=si(t,0);c.setFullYear(s,0,4),c.setHours(0,0,0,0);const u=ou(c);return t.getTime()>=l.getTime()?s+1:t.getTime()>=u.getTime()?s:s-1}function uw(n){const e=kn(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function EO(n,...e){const t=si.bind(null,e.find(s=>typeof s=="object"));return e.map(t)}function hw(n,e){const t=kn(n,e?.in);return t.setHours(0,0,0,0),t}function _O(n,e,t){const[s,i]=EO(t?.in,n,e),l=hw(s),c=hw(i),u=+l-uw(l),h=+c-uw(c);return Math.round((u-h)/SO)}function CO(n,e){const t=LN(n,e),s=si(n,0);return s.setFullYear(t,0,4),s.setHours(0,0,0,0),ou(s)}function TO(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function DO(n){return!(!TO(n)&&typeof n!="number"||isNaN(+kn(n)))}function RO(n,e){const t=kn(n,e?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const kO={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},MO=(n,e,t)=>{let s;const i=kO[n];return typeof i=="string"?s=i:e===1?s=i.one:s=i.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+s:s+" ago":s};function Im(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const LO={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},OO={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},PO={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},IO={date:Im({formats:LO,defaultWidth:"full"}),time:Im({formats:OO,defaultWidth:"full"}),dateTime:Im({formats:PO,defaultWidth:"full"})},BO={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},HO=(n,e,t,s)=>BO[n];function uo(n){return(e,t)=>{const s=t?.context?String(t.context):"standalone";let i;if(s==="formatting"&&n.formattingValues){const c=n.defaultFormattingWidth||n.defaultWidth,u=t?.width?String(t.width):c;i=n.formattingValues[u]||n.formattingValues[c]}else{const c=n.defaultWidth,u=t?.width?String(t.width):n.defaultWidth;i=n.values[u]||n.values[c]}const l=n.argumentCallback?n.argumentCallback(e):e;return i[l]}}const zO={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},FO={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},UO={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},qO={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},VO={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},$O={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},GO=(n,e)=>{const t=Number(n),s=t%100;if(s>20||s<10)switch(s%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},YO={ordinalNumber:GO,era:uo({values:zO,defaultWidth:"wide"}),quarter:uo({values:FO,defaultWidth:"wide",argumentCallback:n=>n-1}),month:uo({values:UO,defaultWidth:"wide"}),day:uo({values:qO,defaultWidth:"wide"}),dayPeriod:uo({values:VO,defaultWidth:"wide",formattingValues:$O,defaultFormattingWidth:"wide"})};function ho(n){return(e,t={})=>{const s=t.width,i=s&&n.matchPatterns[s]||n.matchPatterns[n.defaultMatchWidth],l=e.match(i);if(!l)return null;const c=l[0],u=s&&n.parsePatterns[s]||n.parsePatterns[n.defaultParseWidth],h=Array.isArray(u)?XO(u,x=>x.test(c)):WO(u,x=>x.test(c));let m;m=n.valueCallback?n.valueCallback(h):h,m=t.valueCallback?t.valueCallback(m):m;const p=e.slice(c.length);return{value:m,rest:p}}}function WO(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function XO(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function QO(n){return(e,t={})=>{const s=e.match(n.matchPattern);if(!s)return null;const i=s[0],l=e.match(n.parsePattern);if(!l)return null;let c=n.valueCallback?n.valueCallback(l[0]):l[0];c=t.valueCallback?t.valueCallback(c):c;const u=e.slice(i.length);return{value:c,rest:u}}}const ZO=/^(\d+)(th|st|nd|rd)?/i,KO=/\d+/i,JO={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},eP={any:[/^b/i,/^(a|c)/i]},tP={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},sP={any:[/1/i,/2/i,/3/i,/4/i]},nP={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},aP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},iP={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},rP={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},lP={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},oP={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},cP={ordinalNumber:QO({matchPattern:ZO,parsePattern:KO,valueCallback:n=>parseInt(n,10)}),era:ho({matchPatterns:JO,defaultMatchWidth:"wide",parsePatterns:eP,defaultParseWidth:"any"}),quarter:ho({matchPatterns:tP,defaultMatchWidth:"wide",parsePatterns:sP,defaultParseWidth:"any",valueCallback:n=>n+1}),month:ho({matchPatterns:nP,defaultMatchWidth:"wide",parsePatterns:aP,defaultParseWidth:"any"}),day:ho({matchPatterns:iP,defaultMatchWidth:"wide",parsePatterns:rP,defaultParseWidth:"any"}),dayPeriod:ho({matchPatterns:lP,defaultMatchWidth:"any",parsePatterns:oP,defaultParseWidth:"any"})},dP={code:"en-US",formatDistance:MO,formatLong:IO,formatRelative:HO,localize:YO,match:cP,options:{weekStartsOn:0,firstWeekContainsDate:1}};function uP(n,e){const t=kn(n,e?.in);return _O(t,RO(t))+1}function hP(n,e){const t=kn(n,e?.in),s=+ou(t)-+CO(t);return Math.round(s/MN)+1}function ON(n,e){const t=kn(n,e?.in),s=t.getFullYear(),i=Pu(),l=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,c=si(e?.in||n,0);c.setFullYear(s+1,0,l),c.setHours(0,0,0,0);const u=Io(c,e),h=si(e?.in||n,0);h.setFullYear(s,0,l),h.setHours(0,0,0,0);const m=Io(h,e);return+t>=+u?s+1:+t>=+m?s:s-1}function fP(n,e){const t=Pu(),s=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,i=ON(n,e),l=si(e?.in||n,0);return l.setFullYear(i,0,s),l.setHours(0,0,0,0),Io(l,e)}function mP(n,e){const t=kn(n,e?.in),s=+Io(t,e)-+fP(t,e);return Math.round(s/MN)+1}function ft(n,e){const t=n<0?"-":"",s=Math.abs(n).toString().padStart(e,"0");return t+s}const Va={y(n,e){const t=n.getFullYear(),s=t>0?t:1-t;return ft(e==="yy"?s%100:s,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):ft(t+1,2)},d(n,e){return ft(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return ft(n.getHours()%12||12,e.length)},H(n,e){return ft(n.getHours(),e.length)},m(n,e){return ft(n.getMinutes(),e.length)},s(n,e){return ft(n.getSeconds(),e.length)},S(n,e){const t=e.length,s=n.getMilliseconds(),i=Math.trunc(s*Math.pow(10,t-3));return ft(i,e.length)}},Ir={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},fw={G:function(n,e,t){const s=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(s,{width:"abbreviated"});case"GGGGG":return t.era(s,{width:"narrow"});case"GGGG":default:return t.era(s,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const s=n.getFullYear(),i=s>0?s:1-s;return t.ordinalNumber(i,{unit:"year"})}return Va.y(n,e)},Y:function(n,e,t,s){const i=ON(n,s),l=i>0?i:1-i;if(e==="YY"){const c=l%100;return ft(c,2)}return e==="Yo"?t.ordinalNumber(l,{unit:"year"}):ft(l,e.length)},R:function(n,e){const t=LN(n);return ft(t,e.length)},u:function(n,e){const t=n.getFullYear();return ft(t,e.length)},Q:function(n,e,t){const s=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return ft(s,2);case"Qo":return t.ordinalNumber(s,{unit:"quarter"});case"QQQ":return t.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(s,{width:"wide",context:"formatting"})}},q:function(n,e,t){const s=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return ft(s,2);case"qo":return t.ordinalNumber(s,{unit:"quarter"});case"qqq":return t.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(s,{width:"wide",context:"standalone"})}},M:function(n,e,t){const s=n.getMonth();switch(e){case"M":case"MM":return Va.M(n,e);case"Mo":return t.ordinalNumber(s+1,{unit:"month"});case"MMM":return t.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(s,{width:"wide",context:"formatting"})}},L:function(n,e,t){const s=n.getMonth();switch(e){case"L":return String(s+1);case"LL":return ft(s+1,2);case"Lo":return t.ordinalNumber(s+1,{unit:"month"});case"LLL":return t.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(s,{width:"wide",context:"standalone"})}},w:function(n,e,t,s){const i=mP(n,s);return e==="wo"?t.ordinalNumber(i,{unit:"week"}):ft(i,e.length)},I:function(n,e,t){const s=hP(n);return e==="Io"?t.ordinalNumber(s,{unit:"week"}):ft(s,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Va.d(n,e)},D:function(n,e,t){const s=uP(n);return e==="Do"?t.ordinalNumber(s,{unit:"dayOfYear"}):ft(s,e.length)},E:function(n,e,t){const s=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(s,{width:"short",context:"formatting"});case"EEEE":default:return t.day(s,{width:"wide",context:"formatting"})}},e:function(n,e,t,s){const i=n.getDay(),l=(i-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(l);case"ee":return ft(l,2);case"eo":return t.ordinalNumber(l,{unit:"day"});case"eee":return t.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(i,{width:"short",context:"formatting"});case"eeee":default:return t.day(i,{width:"wide",context:"formatting"})}},c:function(n,e,t,s){const i=n.getDay(),l=(i-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(l);case"cc":return ft(l,e.length);case"co":return t.ordinalNumber(l,{unit:"day"});case"ccc":return t.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(i,{width:"narrow",context:"standalone"});case"cccccc":return t.day(i,{width:"short",context:"standalone"});case"cccc":default:return t.day(i,{width:"wide",context:"standalone"})}},i:function(n,e,t){const s=n.getDay(),i=s===0?7:s;switch(e){case"i":return String(i);case"ii":return ft(i,e.length);case"io":return t.ordinalNumber(i,{unit:"day"});case"iii":return t.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(s,{width:"short",context:"formatting"});case"iiii":default:return t.day(s,{width:"wide",context:"formatting"})}},a:function(n,e,t){const i=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(n,e,t){const s=n.getHours();let i;switch(s===12?i=Ir.noon:s===0?i=Ir.midnight:i=s/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(n,e,t){const s=n.getHours();let i;switch(s>=17?i=Ir.evening:s>=12?i=Ir.afternoon:s>=4?i=Ir.morning:i=Ir.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let s=n.getHours()%12;return s===0&&(s=12),t.ordinalNumber(s,{unit:"hour"})}return Va.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Va.H(n,e)},K:function(n,e,t){const s=n.getHours()%12;return e==="Ko"?t.ordinalNumber(s,{unit:"hour"}):ft(s,e.length)},k:function(n,e,t){let s=n.getHours();return s===0&&(s=24),e==="ko"?t.ordinalNumber(s,{unit:"hour"}):ft(s,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Va.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Va.s(n,e)},S:function(n,e){return Va.S(n,e)},X:function(n,e,t){const s=n.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return pw(s);case"XXXX":case"XX":return Ci(s);case"XXXXX":case"XXX":default:return Ci(s,":")}},x:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"x":return pw(s);case"xxxx":case"xx":return Ci(s);case"xxxxx":case"xxx":default:return Ci(s,":")}},O:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+mw(s,":");case"OOOO":default:return"GMT"+Ci(s,":")}},z:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+mw(s,":");case"zzzz":default:return"GMT"+Ci(s,":")}},t:function(n,e,t){const s=Math.trunc(+n/1e3);return ft(s,e.length)},T:function(n,e,t){return ft(+n,e.length)}};function mw(n,e=""){const t=n>0?"-":"+",s=Math.abs(n),i=Math.trunc(s/60),l=s%60;return l===0?t+String(i):t+String(i)+e+ft(l,2)}function pw(n,e){return n%60===0?(n>0?"-":"+")+ft(Math.abs(n)/60,2):Ci(n,e)}function Ci(n,e=""){const t=n>0?"-":"+",s=Math.abs(n),i=ft(Math.trunc(s/60),2),l=ft(s%60,2);return t+i+e+l}const gw=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},PN=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},pP=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],s=t[1],i=t[2];if(!i)return gw(n,e);let l;switch(s){case"P":l=e.dateTime({width:"short"});break;case"PP":l=e.dateTime({width:"medium"});break;case"PPP":l=e.dateTime({width:"long"});break;case"PPPP":default:l=e.dateTime({width:"full"});break}return l.replace("{{date}}",gw(s,e)).replace("{{time}}",PN(i,e))},gP={p:PN,P:pP},xP=/^D+$/,yP=/^Y+$/,bP=["D","DD","YY","YYYY"];function vP(n){return xP.test(n)}function wP(n){return yP.test(n)}function AP(n,e,t){const s=NP(n,e,t);if(console.warn(s),bP.includes(n))throw new RangeError(s)}function NP(n,e,t){const s=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${s} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const SP=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,jP=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,EP=/^'([^]*?)'?$/,_P=/''/g,CP=/[a-zA-Z]/;function yo(n,e,t){const s=Pu(),i=s.locale??dP,l=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,c=s.weekStartsOn??s.locale?.options?.weekStartsOn??0,u=kn(n,t?.in);if(!DO(u))throw new RangeError("Invalid time value");let h=e.match(jP).map(p=>{const x=p[0];if(x==="p"||x==="P"){const y=gP[x];return y(p,i.formatLong)}return p}).join("").match(SP).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const x=p[0];if(x==="'")return{isToken:!1,value:TP(p)};if(fw[x])return{isToken:!0,value:p};if(x.match(CP))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:p}});i.localize.preprocessor&&(h=i.localize.preprocessor(u,h));const m={firstWeekContainsDate:l,weekStartsOn:c,locale:i};return h.map(p=>{if(!p.isToken)return p.value;const x=p.value;(wP(x)||vP(x))&&AP(x,e,String(n));const y=fw[x[0]];return y(u,x,i.localize,m)}).join("")}function TP(n){const e=n.match(EP);return e?e[1].replace(_P,"'"):n}const DP=()=>{const{token:n}=ls(),[e,t]=_.useState([]),[s,i]=_.useState([]),[l,c]=_.useState([]),[u,h]=_.useState([]),[m,p]=_.useState({total:0,pending:0,approved:0,rejected:0}),[x,y]=_.useState({role:"employee",year:new Date().getFullYear(),leaves:{}}),[v,w]=_.useState({name:"",isActive:!0}),[A,N]=_.useState(null),[S,E]=_.useState(null),[C,R]=_.useState(null),[D,O]=_.useState(""),[H,F]=_.useState(!1),[P,Z]=_.useState(""),[z,K]=_.useState("pending"),[W,ce]=_.useState("all"),[me,L]=_.useState(null),[q,$]=_.useState(1),[I]=_.useState(10),[T,V]=_.useState({key:null,direction:"ascending"}),[M,G]=_.useState(!1),de=async()=>{F(!0);try{const[J,Se,Ie]=await Promise.all([xe.get("/leave/requests",{headers:{Authorization:`Bearer ${n}`}}),xe.get("/leave/policies",{headers:{Authorization:`Bearer ${n}`}}),xe.get("/leave/get-leaveTypes",{headers:{Authorization:`Bearer ${n}`}})]);t(J.data),i(J.data),c(Se.data),h(Ie.data);const Xe=new Date().getMonth(),wt=new Date().getFullYear(),qt=J.data.filter(oe=>{const Ne=new Date(oe.fromDate);return Ne.getMonth()===Xe&&Ne.getFullYear()===wt});p({total:qt.length,pending:qt.filter(oe=>oe.status==="pending").length,approved:qt.filter(oe=>oe.status==="approved").length,rejected:qt.filter(oe=>oe.status==="rejected").length})}catch(J){console.error("Error fetching data:",J)}finally{F(!1)}};_.useEffect(()=>{n&&de()},[n]),_.useEffect(()=>{let J=e;P&&(J=J.filter(Se=>Se.employee?.email?.toLowerCase().includes(P.toLowerCase())||Se.leaveType?.toLowerCase().includes(P.toLowerCase())||Se.reason?.toLowerCase().includes(P.toLowerCase()))),z!=="all"&&(J=J.filter(Se=>Se.status===z)),W!=="all"&&(J=J.filter(Se=>Se.leaveType===W)),i(J),$(1)},[P,z,W,e]);const re=q*I,ye=re-I,je=s.slice(ye,re),Le=Math.ceil(s.length/I),he=async(J,Se)=>{try{await xe.post(`/leave/${J}/review`,{action:Se,reason:D||`${Se}ed by admin`},{headers:{Authorization:`Bearer ${n}`}}),N(null),O(""),de(),document.getElementById("actionModal").classList.add("hidden")}catch(Ie){console.error("Error updating leave:",Ie)}},$e=async J=>{J.preventDefault();try{await xe.post("/leave/create-leave-policy",x,{headers:{Authorization:`Bearer ${n}`}}),de(),y({role:"employee",year:new Date().getFullYear(),leaves:{}}),document.getElementById("policyModal").classList.add("hidden")}catch(Se){console.error("Error setting leave policy:",Se)}},ge=J=>{E(J);const Se={};J.leaves instanceof Map?J.leaves.forEach((Ie,Xe)=>{Se[Xe]=Ie}):Object.assign(Se,J.leaves),y({role:J.role,year:J.year,leaves:Se}),document.getElementById("policyModal").classList.remove("hidden")},we=async J=>{J.preventDefault();try{C?await xe.put(`/leave/update-leaveType/${C._id}`,{name:v.name},{headers:{Authorization:`Bearer ${n}`}}):await xe.post("/leave/create-leaveType",{name:v.name},{headers:{Authorization:`Bearer ${n}`}}),w({name:"",isActive:!0}),R(null),de(),document.getElementById("leaveTypeModal").classList.add("hidden")}catch(Se){console.error("Error creating/updating leave type:",Se)}},ke=async J=>{try{await xe.delete(`/leave/delete-leaveType/${J}`,{headers:{Authorization:`Bearer ${n}`}}),de()}catch(Se){console.error("Error deleting leave type:",Se)}},te=async J=>{try{await xe.patch(`/leave/toggle-leaveType-status/${J}`,{},{headers:{Authorization:`Bearer ${n}`}}),de()}catch(Se){console.error("Error toggling leave type status:",Se)}},be=J=>{R(J),w({name:J.name,isActive:J.isActive}),document.getElementById("leaveTypeModal").classList.remove("hidden")},ve=({status:J})=>{const Se={approved:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",icon:js},pending:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",icon:pn},rejected:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",icon:mn},cancelled:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-200",icon:mn}},Ie=Se[J]||Se.pending,Xe=Ie.icon;return r.jsxs("span",{className:`flex items-center px-3 py-1 rounded-full text-xs font-medium ${Ie.bg} ${Ie.text} ${Ie.border}`,children:[r.jsx(Xe,{size:12,className:"mr-1"}),J]})},Ee=({title:J,value:Se,subtitle:Ie,icon:Xe,color:wt})=>r.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-2xl font-bold text-gray-800",children:Se}),r.jsx("p",{className:"text-sm font-medium text-gray-600",children:J}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Ie})]}),r.jsx("div",{className:`p-3 rounded-full ${wt}`,children:r.jsx(Xe,{size:24,className:"text-white"})})]})}),Ye=u.filter(J=>J.isActive);return r.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-6 p-3 md:p-6 bg-gray-50 min-h-screen",children:[r.jsxs("div",{className:"md:hidden flex justify-between items-center p-3 bg-white rounded-lg shadow-sm mb-3",children:[r.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Admin Leave Management"}),r.jsx("button",{onClick:()=>G(!M),className:"p-2 rounded-lg bg-[#104774] text-white",children:M?r.jsx(Zr,{size:20}):r.jsx(d1,{size:20})})]}),r.jsxs("div",{className:"flex-1 space-y-4 md:space-y-6",children:[r.jsxs("div",{className:"hidden md:flex flex-col md:flex-row items-start md:items-center justify-between gap-3 md:gap-4 bg-white p-4 rounded-xl shadow-sm",children:[r.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-800",children:"Admin Leave Management"}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs("button",{className:"flex items-center bg-[#104774] text-white px-3 md:px-4 py-2 rounded-lg font-medium hover:bg-[#0d3a61] transition-all duration-200 text-sm md:text-base",onClick:()=>{E(null),document.getElementById("policyModal").classList.remove("hidden")},children:[r.jsx(Ii,{size:16,className:"mr-1 md:mr-2"})," Set Policy"]}),r.jsxs("button",{className:"flex items-center bg-green-600 text-white px-3 md:px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-all duration-200 text-sm md:text-base",onClick:de,children:[r.jsx(zi,{size:16,className:"mr-1 md:mr-2"})," Refresh"]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4",children:[r.jsx(Ee,{title:"Total Requests",value:m.total,subtitle:"This Month",icon:Es,color:"bg-blue-500"}),r.jsx(Ee,{title:"Pending",value:m.pending,subtitle:"Require Action",icon:pn,color:"bg-yellow-500"}),r.jsx(Ee,{title:"Approved",value:m.approved,subtitle:"This month",icon:js,color:"bg-green-500"}),r.jsx(Ee,{title:"Rejected",value:m.rejected,subtitle:"Leaves",icon:mn,color:"bg-red-500"})]}),r.jsxs("div",{className:"bg-white rounded-lg md:rounded-xl p-3 md:p-4 shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(Rp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),r.jsx("input",{type:"text",placeholder:"Search by employee, type, or reason...",value:P,onChange:J=>Z(J.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm md:text-base"})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs("select",{value:z,onChange:J=>K(J.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm w-full md:w-auto",children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"rejected",children:"Rejected"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]}),r.jsxs("select",{value:W,onChange:J=>ce(J.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm w-full md:w-auto",children:[r.jsx("option",{value:"all",children:"All Types"}),Ye.map(J=>r.jsx("option",{value:J.name,children:J.name.replace(/_/g," ").replace(/\b\w/g,Se=>Se.toUpperCase())},J._id))]})]})]}),r.jsxs("div",{className:"mt-2 text-xs md:text-sm text-gray-500",children:["Showing ",s.length," of ",e.length," requests"]})]}),r.jsxs("div",{className:"bg-white rounded-lg md:rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"p-3 md:p-4 border-b border-gray-200 flex items-center space-x-2 md:space-x-3",children:[r.jsx(Es,{size:20,className:"text-[#104774]"}),r.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-800",children:"All Leave Requests"})]}),H?r.jsxs("div",{className:"p-6 md:p-8 text-center",children:[r.jsx(zi,{className:"animate-spin mx-auto text-[#104774]",size:28}),r.jsx("p",{className:"mt-2 text-gray-500 text-sm md:text-base",children:"Loading leave requests..."})]}):s.length===0?r.jsx("div",{className:"p-6 md:p-8 text-center",children:r.jsx("p",{className:"text-gray-500 text-sm md:text-base",children:"No leave requests found"})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsx("div",{className:"min-w-[800px] md:min-w-full max-h-[400px] md:max-h-[500px] overflow-y-auto",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"p-2 md:p-3 text-left text-xs md:text-sm font-medium whitespace-nowrap",children:"Employee"}),r.jsx("th",{className:"p-2 md:p-3 text-left text-xs md:text-sm font-medium whitespace-nowrap",children:"Type"}),r.jsx("th",{className:"p-2 md:p-3 text-left text-xs md:text-sm font-medium whitespace-nowrap",children:"From"}),r.jsx("th",{className:"p-2 md:p-3 text-left text-xs md:text-sm font-medium whitespace-nowrap",children:"To"}),r.jsx("th",{className:"p-2 md:p-3 text-left text-xs md:text-sm font-medium whitespace-nowrap",children:"Days"}),r.jsx("th",{className:"p-2 md:p-3 text-left text-xs md:text-sm font-medium whitespace-nowrap",children:"Balance"}),r.jsx("th",{className:"p-2 md:p-3 text-left text-xs md:text-sm font-medium whitespace-nowrap",children:"Status"}),r.jsx("th",{className:"p-2 md:p-3 text-left text-xs md:text-sm font-medium whitespace-nowrap",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:je.sort((J,Se)=>new Date(Se.appliedAt)-new Date(J.appliedAt)).map((J,Se)=>{const Ie=J.currentRemaining&&J.currentRemaining[J.leaveType]>=J.totalDays;return r.jsxs(Eo.Fragment,{children:[r.jsxs("tr",{className:`${Se%2===0?"bg-white":"bg-gray-50"} hover:bg-gray-100 transition-colors`,children:[r.jsx("td",{className:"p-2 md:p-3 text-xs md:text-sm whitespace-nowrap",children:r.jsx("div",{className:"truncate max-w-[120px] md:max-w-none",children:J.employee?.email||"N/A"})}),r.jsx("td",{className:"p-2 md:p-3 text-xs md:text-sm capitalize whitespace-nowrap",children:J.leaveType.replace(/_/g," ")}),r.jsx("td",{className:"p-2 md:p-3 text-xs md:text-sm whitespace-nowrap",children:yo(new Date(J.fromDate),"dd MMM yyyy")}),r.jsx("td",{className:"p-2 md:p-3 text-xs md:text-sm whitespace-nowrap",children:yo(new Date(J.toDate),"dd MMM yyyy")}),r.jsx("td",{className:"p-2 md:p-3 text-xs md:text-sm whitespace-nowrap",children:J.totalDays}),r.jsx("td",{className:"p-2 md:p-3 text-xs md:text-sm whitespace-nowrap",children:r.jsx("div",{className:"flex items-center",children:J.currentRemaining?r.jsxs(r.Fragment,{children:[r.jsxs("span",{className:Ie?"text-green-600 font-medium":"text-red-600 font-medium",children:[J.currentRemaining[J.leaveType],"/",J.balanceSnapshot?.remaining[J.leaveType]]}),!Ie&&r.jsx(as,{size:14,className:"text-red-500 ml-1"})]}):r.jsx("span",{className:"text-gray-400",children:"N/A"})})}),r.jsx("td",{className:"p-2 md:p-3",children:r.jsx(ve,{status:J.status})}),r.jsx("td",{className:"p-2 md:p-3",children:r.jsxs("div",{className:"flex space-x-1 md:space-x-2",children:[r.jsx("button",{className:"p-1 md:p-1.5 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200",onClick:()=>L(me===J._id?null:J._id),title:"View Details",children:r.jsx(To,{size:14})}),J.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"p-1 md:p-1.5 rounded-full bg-green-100 text-green-600 hover:bg-green-200",onClick:()=>{N(J),document.getElementById("actionModal").classList.remove("hidden")},title:"Approve",children:r.jsx(js,{size:14})}),r.jsx("button",{className:"p-1 md:p-1.5 rounded-full bg-red-100 text-red-600 hover:bg-red-200",onClick:()=>{N(J),document.getElementById("actionModal").classList.remove("hidden")},title:"Reject",children:r.jsx(mn,{size:14})})]})]})})]}),me===J._id&&r.jsx("tr",{children:r.jsx("td",{colSpan:"8",className:"p-3 md:p-6 bg-gray-50",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-6",children:[r.jsxs("div",{className:"bg-white p-3 md:p-5 rounded-lg md:rounded-xl shadow-sm border",children:[r.jsx("h4",{className:"text-[#104774] font-semibold text-sm md:text-base mb-2 md:mb-3",children:"Request Details"}),r.jsxs("div",{className:"space-y-1 md:space-y-2 text-xs md:text-sm",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Reason:"})," ",J.reason||"-"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Applied On:"})," ",yo(new Date(J.appliedAt),"dd MMM yyyy, hh:mm a")]}),J.processedBy&&r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Processed By:"})," ",J.processedBy?.email||"Admin"]}),J.processedAt&&r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Processed At:"})," ",yo(new Date(J.processedAt),"dd MMM yyyy, hh:mm a")]}),J.remarks&&r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Remarks:"})," ",J.remarks]})]})]}),r.jsxs("div",{className:"bg-white p-3 md:p-5 rounded-lg md:rounded-xl shadow-sm border",children:[r.jsx("h4",{className:"text-[#104774] font-semibold text-sm md:text-base mb-2 md:mb-3",children:"Balance Information"}),r.jsxs("div",{className:"space-y-1 md:space-y-2 text-xs md:text-sm",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Remaining at request:"})," ",J.balanceSnapshot?.remaining?.[J.leaveType]??"-"]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-medium",children:"Current remaining:"})," ",J.currentRemaining?.[J.leaveType]??"-"]}),!Ie&&r.jsxs("p",{className:"text-red-600 font-medium flex items-center mt-1 md:mt-2",children:[r.jsx(as,{size:14,className:"mr-1"}),"Insufficient balance"]})]})]})]})})})]},J._id)})})]})})}),Le>1&&r.jsxs("div",{className:"p-3 md:p-4 border-t border-gray-200 flex flex-col sm:flex-row justify-between items-center gap-3",children:[r.jsxs("div",{className:"text-xs md:text-sm text-gray-500",children:["Showing ",ye+1," to"," ",Math.min(re,s.length)," of"," ",s.length," entries"]}),r.jsxs("div",{className:"flex space-x-1",children:[r.jsx("button",{onClick:()=>$(J=>Math.max(J-1,1)),disabled:q===1,className:"px-2 md:px-3 py-1 rounded-lg border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-xs md:text-sm hover:bg-gray-100",children:"Previous"}),Array.from({length:Math.min(5,Le)},(J,Se)=>{let Ie;return Le<=5||q<=3?Ie=Se+1:q>=Le-2?Ie=Le-4+Se:Ie=q-2+Se,r.jsx("button",{onClick:()=>$(Ie),className:`px-2 md:px-3 py-1 rounded-lg border text-xs md:text-sm transition ${q===Ie?"bg-[#104774] text-white border-[#104774]":"hover:bg-gray-100 border-gray-300"}`,children:Ie},Ie)}),r.jsx("button",{onClick:()=>$(J=>Math.min(J+1,Le)),disabled:q===Le,className:"px-2 md:px-3 py-1 rounded-lg border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed text-xs md:text-sm hover:bg-gray-100",children:"Next"})]})]})]})]})]}),r.jsxs("div",{className:`w-full md:w-80 space-y-4 md:space-y-6 ${M?"block":"hidden"} md:block`,children:[r.jsxs("div",{className:"bg-white rounded-lg md:rounded-xl p-3 md:p-4 shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3 md:mb-4",children:[r.jsx("h3",{className:"text-base md:text-lg font-semibold",children:"Leave Policies"}),r.jsx("button",{className:"text-[#104774] hover:text-[#0d3a61]",onClick:()=>{E(null),document.getElementById("policyModal").classList.remove("hidden")},children:r.jsx(Ii,{size:18})})]}),l.length===0?r.jsx("p",{className:"text-gray-500 text-center py-3 md:py-4 text-sm",children:"No policies set yet"}):r.jsx("div",{className:"space-y-2 md:space-y-3 max-h-60 md:max-h-80 overflow-y-auto",children:l.map(J=>{const Se=J.leaves instanceof Map?Object.fromEntries(J.leaves):J.leaves;return r.jsxs("div",{className:"border border-gray-200 rounded-lg p-2 md:p-3 hover:shadow-md transition-shadow",children:[r.jsxs("div",{className:"flex justify-between items-start mb-1 md:mb-2",children:[r.jsxs("h4",{className:"font-medium text-[#104774] text-sm md:text-base",children:[J.role.charAt(0).toUpperCase()+J.role.slice(1)," -"," ",J.year]}),r.jsx("button",{onClick:()=>ge(J),className:"text-gray-500 hover:text-[#104774]",children:r.jsx(Wm,{size:14})})]}),r.jsx("div",{className:"space-y-1 text-xs md:text-sm",children:Object.entries(Se).map(([Ie,Xe])=>r.jsxs("p",{className:"flex justify-between",children:[r.jsxs("span",{className:"capitalize",children:[Ie.replace(/_/g," "),":"]})," ",r.jsx("span",{className:"font-medium",children:Xe})]},Ie))})]},J._id)})})]}),r.jsxs("div",{className:"bg-white rounded-lg md:rounded-xl p-3 md:p-4 shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3 md:mb-4",children:[r.jsx("h3",{className:"text-base md:text-lg font-semibold",children:"Leave Types"}),r.jsx("button",{className:"text-[#104774] hover:text-[#0d3a61]",onClick:()=>{R(null),w({name:"",isActive:!0}),document.getElementById("leaveTypeModal").classList.remove("hidden")},children:r.jsx(Ii,{size:18})})]}),u.length===0?r.jsx("p",{className:"text-gray-500 text-center py-3 md:py-4 text-sm",children:"No leave types set yet"}):r.jsx("div",{className:"space-y-1 md:space-y-2 max-h-60 md:max-h-80 overflow-y-auto",children:u.map(J=>r.jsxs("div",{className:"flex justify-between items-center py-1 md:py-2 border-b border-gray-100 last:border-0",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:`text-xs md:text-sm ${J.isActive?"text-gray-800":"text-gray-400 line-through"}`,children:J.name.replace(/_/g," ").replace(/\b\w/g,Se=>Se.toUpperCase())}),!J.isActive&&r.jsx("span",{className:"ml-2 text-xs text-gray-400",children:"(Inactive)"})]}),r.jsxs("div",{className:"flex space-x-1 md:space-x-2",children:[r.jsx("button",{onClick:()=>be(J),className:"text-gray-500 hover:text-[#104774] p-1",children:r.jsx(Wm,{size:12})}),r.jsx("button",{onClick:()=>te(J._id),className:`p-1 text-xs ${J.isActive?"text-yellow-500 hover:text-yellow-700":"text-green-500 hover:text-green-700"}`,children:J.isActive?"Disable":"Enable"}),r.jsx("button",{onClick:()=>ke(J._id),className:"text-gray-500 hover:text-red-600 p-1",children:r.jsx(kp,{size:12})})]})]},J._id))})]})]}),r.jsx("div",{id:"policyModal",className:"fixed inset-0 backdrop-blur-sm  bg-opacity-40 flex items-center justify-center hidden z-50 p-3 md:p-4",children:r.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-lg md:rounded-xl w-full max-w-md max-h-[90vh] overflow-y-auto shadow-2xl",children:[r.jsx("h3",{className:"text-lg font-semibold mb-3 md:mb-4",children:S?"Edit Leave Policy":"Create Leave Policy"}),r.jsxs("form",{onSubmit:$e,className:"space-y-3 md:space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Role"}),r.jsxs("select",{value:x.role,onChange:J=>y({...x,role:J.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm md:text-base",children:[r.jsx("option",{value:"employee",children:"Employee"}),r.jsx("option",{value:"hr",children:"HR"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Year"}),r.jsx("input",{type:"number",min:"2000",max:"2100",value:x.year,onChange:J=>y({...x,year:parseInt(J.target.value)||new Date().getFullYear()}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm md:text-base"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Leave Types"}),r.jsx("div",{className:"space-y-2 md:space-y-3",children:u.filter(J=>J.isActive).map(J=>r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium mb-1 capitalize",children:[J.name.replace(/_/g," ")," Leaves"]}),r.jsx("input",{type:"number",min:"0",value:x.leaves[J.name]||0,onChange:Se=>y({...x,leaves:{...x.leaves,[J.name]:parseInt(Se.target.value)||0}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm md:text-base"})]},J._id))})]}),r.jsxs("div",{className:"flex justify-end space-x-2 pt-3 md:pt-4",children:[r.jsx("button",{type:"button",className:"px-3 md:px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400 transition-colors text-sm md:text-base",onClick:()=>document.getElementById("policyModal").classList.add("hidden"),children:"Cancel"}),r.jsx("button",{type:"submit",className:"px-3 md:px-4 py-2 rounded-lg bg-[#104774] text-white hover:bg-[#0d3a61] transition-colors text-sm md:text-base",children:S?"Update Policy":"Save Policy"})]})]})]})}),r.jsx("div",{id:"leaveTypeModal",className:"fixed inset-0 backdrop-blur-sm  bg-opacity-40 flex items-center justify-center hidden z-50 p-3 md:p-4",children:r.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-lg md:rounded-xl w-full max-w-md border border-gray-200 shadow-2xl",children:[r.jsx("h3",{className:"text-lg font-semibold mb-3 md:mb-4",children:C?"Edit Leave Type":"Add Leave Type"}),r.jsxs("form",{onSubmit:we,className:"space-y-3 md:space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Leave Type Name"}),r.jsx("input",{type:"text",value:v.name,onChange:J=>w({...v,name:J.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm md:text-base",placeholder:"e.g., Work From Home",required:!0}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Use underscores for spaces (e.g., "work_from_home")'})]}),r.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[r.jsx("button",{type:"button",className:"px-3 md:px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400 transition-colors text-sm md:text-base",onClick:()=>{document.getElementById("leaveTypeModal").classList.add("hidden"),R(null)},children:"Cancel"}),r.jsxs("button",{type:"submit",className:"px-3 md:px-4 py-2 rounded-lg bg-[#104774] text-white hover:bg-[#0d3a61] transition-colors text-sm md:text-base",children:[C?"Update":"Add"," Leave Type"]})]})]})]})}),r.jsx("div",{id:"actionModal",className:"fixed inset-0 backdrop-blur-sm  bg-opacity-40 flex items-center justify-center hidden z-50 p-2 sm:p-3 md:p-4",children:r.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-6 rounded-lg md:rounded-xl w-full max-w-md mx-2 sm:mx-4 border border-gray-200 shadow-2xl max-h-[90vh] overflow-y-auto",children:[r.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 md:mb-4",children:"Process Leave Request"}),A&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-3 md:mb-4 p-2 sm:p-3 bg-gray-50 rounded-lg",children:[r.jsxs("p",{className:"text-xs sm:text-sm md:text-base break-words",children:[r.jsx("strong",{children:"Employee:"})," ",A.employee?.email]}),r.jsxs("p",{className:"text-xs sm:text-sm md:text-base",children:[r.jsx("strong",{children:"Type:"})," ",A.leaveType]}),r.jsxs("p",{className:"text-xs sm:text-sm md:text-base",children:[r.jsx("strong",{children:"Duration:"})," ",A.totalDays," days"]}),r.jsxs("p",{className:"text-xs sm:text-sm md:text-base break-words",children:[r.jsx("strong",{children:"Reason:"})," ",A.reason||"-"]}),A.currentRemaining&&r.jsxs("p",{className:`mt-2 text-xs sm:text-sm md:text-base break-words ${A.currentRemaining[A.leaveType]<A.totalDays?"text-red-600 font-medium":""}`,children:[r.jsx("strong",{children:"Remaining Balance:"})," ",A.currentRemaining[A.leaveType],"/",A.balanceSnapshot?.remaining[A.leaveType],A.currentRemaining[A.leaveType]<A.totalDays&&r.jsx("span",{className:"ml-1",children:"(Insufficient balance)"})]})]}),r.jsxs("div",{className:"mb-3 md:mb-4",children:[r.jsx("label",{className:"block text-xs sm:text-sm font-medium mb-1",children:"Remarks (Optional)"}),r.jsx("textarea",{value:D,onChange:J=>O(J.target.value),className:"w-full border border-gray-300 rounded-lg px-2 sm:px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#104774] text-xs sm:text-sm md:text-base",rows:"3",placeholder:"Add remarks for this action..."})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:space-x-2",children:[r.jsx("button",{className:"px-3 md:px-4 py-2 rounded-lg bg-gray-300 hover:bg-gray-400 transition-colors text-xs sm:text-sm md:text-base order-3 sm:order-1",onClick:()=>{document.getElementById("actionModal").classList.add("hidden"),O("")},children:"Cancel"}),r.jsxs("div",{className:"flex space-x-2 order-1 sm:order-2",children:[r.jsx("button",{className:"px-3 md:px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 transition-colors text-xs sm:text-sm md:text-base flex-1",onClick:()=>he(A._id,"reject"),children:"Reject"}),r.jsx("button",{className:"px-3 md:px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 transition-colors text-xs sm:text-sm md:text-base flex-1",onClick:()=>he(A._id,"approve"),children:"Approve"})]})]})]})]})})]})},Iu=({isOpen:n,onClose:e,onSuccess:t,token:s,addNotification:i,basePath:l="/attendance"})=>{const[c,u]=_.useState(""),[h,m]=_.useState("Planned"),[p,x]=_.useState(""),[y,v]=_.useState(""),[w,A]=_.useState(!1),[N,S]=_.useState(!1),[E,C]=_.useState(!1),[R,D]=_.useState(null),[O,H]=_.useState(null);_.useEffect(()=>{n||(u(""),m("Planned"),x(""),v(""),A(!1),S(!1),D(null))},[n]),_.useEffect(()=>{n&&s&&F()},[n,s]);const F=async()=>{try{const z=await xe.get("/profile/my-profile",{headers:{Authorization:`Bearer ${s}`}});z.data?.shiftTiming&&(H(z.data.shiftTiming),P(z.data.shiftTiming))}catch(z){console.error("Error fetching shift timing:",z),i("Error fetching shift information","error")}},P=z=>{if(!z?.start)return;const K=new Date,W=K.getHours()*60+K.getMinutes(),[ce,me]=z.start.split(" "),[L,q]=ce.split(":").map(Number);let $=L*60+q;me==="PM"&&L!==12&&($+=720),me==="AM"&&L===12&&($-=720),W<$?(A(!0),D(`You are logging in before your shift start time (${z.start}). Please provide a reason for early login.`)):W>$+60&&(S(!0),D(`You are logging in after 1 hour from your shift start time (${z.start}). Please provide a reason for late login.`))},Z=async z=>{if(z.preventDefault(),!c.trim()){D("Task description is required");return}if(w&&!p.trim()){D("Early login reason is required");return}if(N&&!y.trim()){D("Late login reason is required");return}C(!0),D(null);try{const K={taskDescription:c,workProgress:h,...w&&{earlyLoginReason:p},...N&&{lateLoginReason:y}},W=await xe.post(`${l}/login`,K,{headers:{Authorization:`Bearer ${s}`}});W.data?.message&&i(W.data.message,"success");const ce=W.data?.attendance||W.data;ce&&t(ce),e()}catch(K){console.error("Error submitting attendance:",K);const W=K?.response?.data?.message||"Error submitting attendance";D(W),i(W,"error")}finally{C(!1)}};return n?r.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Mark Attendance"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),O&&r.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-md",children:r.jsxs("p",{className:"text-sm text-blue-800",children:["Your shift timing: ",r.jsxs("strong",{children:[O.start," - ",O.end]})]})}),R&&r.jsx("div",{className:`mb-4 p-3 rounded text-sm ${R.includes("Error")||R.includes("required")?"bg-red-50 text-red-800 border border-red-100":"bg-blue-50 text-blue-800 border border-blue-100"}`,children:R}),r.jsxs("form",{onSubmit:Z,children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Task Description *"}),r.jsx("textarea",{value:c,onChange:z=>u(z.target.value),rows:4,required:!0,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe what you'll be working on today..."})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Work Progress"}),r.jsxs("select",{value:h,onChange:z=>m(z.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"Planned",children:"Planned"}),r.jsx("option",{value:"In Progress",children:"In Progress"}),r.jsx("option",{value:"Completed",children:"Completed"})]})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:w,onChange:z=>{A(z.target.checked),z.target.checked&&S(!1)},className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),r.jsx("span",{className:"text-sm text-gray-700",children:"Logging in early"})]})}),w&&r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for early login *"}),r.jsx("textarea",{value:p,onChange:z=>x(z.target.value),rows:3,required:w,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Please provide reason for logging in early..."})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:N,onChange:z=>{S(z.target.checked),z.target.checked&&A(!1)},className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),r.jsx("span",{className:"text-sm text-gray-700",children:"Logging in late"})]})}),N&&r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for late login *"}),r.jsx("textarea",{value:y,onChange:z=>v(z.target.value),rows:3,required:N,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Please provide reason for logging in late..."})]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:E,children:"Cancel"}),r.jsx("button",{type:"submit",disabled:E,className:"px-4 py-2 rounded-md text-white disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#104774"},onMouseEnter:z=>z.currentTarget.style.backgroundColor="#0d3a61",onMouseLeave:z=>z.currentTarget.style.backgroundColor="#104774",children:E?"Submitting...":"Submit Attendance"})]})]})]})}):null},Bu=({isOpen:n,onClose:e,onSuccess:t,attendanceData:s,token:i,addNotification:l,basePath:c="/attendance"})=>{const[u,h]=_.useState(""),[m,p]=_.useState(""),[x,y]=_.useState(!1),[v,w]=_.useState(!1),[A,N]=_.useState(null),S=async E=>{if(E.preventDefault(),!u.trim()){N("Logout description is required");return}if(x&&!m.trim()){N("Early logout reason is required");return}w(!0),N(null);try{if(!s||!s._id)throw new Error("Attendance record id is missing.");const C=await xe.post(`${c}/logout/${s._id}`,{logoutDescription:u,earlyLogoutReason:x?m:void 0},{headers:{Authorization:`Bearer ${i}`}});C.data?.message?(l(C.data.message,"success"),N(C.data.message)):l("Logout recorded successfully","success");const R=C.data?.attendance||C.data;R&&R._id?t(R):t({...s,checkOut:new Date().toISOString(),logoutDescription:u,earlyLogoutReason:x?m:void 0}),h(""),p(""),y(!1)}catch(C){console.error("Error recording logout:",C);const R=C?.response?.data?.message||C.message||"Error recording logout";N(R),l(R,"error")}finally{w(!1)}};return n?r.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Log Out"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),A&&r.jsx("div",{className:`mb-4 p-3 rounded text-sm ${A.includes("Error")||A.includes("required")?"bg-red-50 text-red-800 border border-red-100":"bg-green-50 text-green-800 border border-green-100"}`,children:A}),r.jsxs("form",{onSubmit:S,children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logout Description *"}),r.jsx("textarea",{value:u,onChange:E=>h(E.target.value),rows:4,required:!0,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe what you completed today..."})]}),r.jsx("div",{className:"mb-4",children:r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:x,onChange:E=>y(E.target.checked),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),r.jsx("span",{className:"text-sm text-gray-700",children:"Logging out early"})]})}),x&&r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for early logout *"}),r.jsx("textarea",{value:m,onChange:E=>p(E.target.value),rows:3,required:x,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Please provide reason for early logout..."})]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:v,children:"Cancel"}),r.jsx("button",{type:"submit",disabled:v,className:"px-4 py-2 rounded-md text-white disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#104774"},onMouseEnter:E=>E.currentTarget.style.backgroundColor="#0d3a61",onMouseLeave:E=>E.currentTarget.style.backgroundColor="#104774",children:v?"Logging Out...":"Confirm Logout"})]})]})]})}):null},RP=({isOpen:n,onClose:e,onSuccess:t,token:s,addNotification:i,employeeId:l})=>{const[c,u]=_.useState(""),[h,m]=_.useState(""),[p,x]=_.useState(""),[y,v]=_.useState(""),[w,A]=_.useState(!1),[N,S]=_.useState(null),E=async C=>{if(C.preventDefault(),!c||!y.trim()){S("Date and reason are required");return}A(!0),S(null);try{const R=await xe.post("/attendance/regularization",{date:c,checkIn:h||void 0,checkOut:p||void 0,reason:y},{headers:{Authorization:`Bearer ${s}`}});R.data?.message?(i(R.data.message,"success"),S(R.data.message)):i("Regularization request submitted","success"),t(),u(""),m(""),x(""),v("")}catch(R){console.error("Error submitting regularization:",R);const D=R?.response?.data?.message||"Error submitting regularization request";S(D),i(D,"error")}finally{A(!1)}};return n?r.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Request Regularization"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),N&&r.jsx("div",{className:`mb-4 p-3 rounded text-sm ${N.includes("Error")||N.includes("required")?"bg-red-50 text-red-800 border border-red-100":"bg-green-50 text-green-800 border border-green-100"}`,children:N}),r.jsxs("form",{onSubmit:E,children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),r.jsx("input",{type:"date",value:c,onChange:C=>u(C.target.value),required:!0,max:new Date().toISOString().split("T")[0],className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Check-in Time"}),r.jsx("input",{type:"time",value:h,onChange:C=>m(C.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Check-out Time"}),r.jsx("input",{type:"time",value:p,onChange:C=>x(C.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for Regularization *"}),r.jsx("textarea",{value:y,onChange:C=>v(C.target.value),rows:4,required:!0,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Explain why you need regularization for this date..."})]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:w,children:"Cancel"}),r.jsx("button",{type:"submit",disabled:w,className:"px-4 py-2 rounded-md text-white disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#104774"},onMouseEnter:C=>C.currentTarget.style.backgroundColor="#0d3a61",onMouseLeave:C=>C.currentTarget.style.backgroundColor="#104774",children:w?"Submitting...":"Submit Request"})]})]})]})}):null},Ki=({notifications:n})=>{const e=s=>{switch(s){case"success":return"bg-green-50 text-green-800 border border-green-100";case"error":return"bg-red-50 text-red-800 border border-red-100";case"warning":return"bg-yellow-50 text-yellow-800 border border-yellow-100";default:return"bg-white text-gray-800 border border-gray-200"}},t=s=>{switch(s){case"success":return r.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case"error":return r.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})});case"warning":return r.jsx("svg",{className:"w-5 h-5 text-yellow-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})});default:return r.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}};return r.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2",children:n.map(s=>r.jsxs("div",{className:`max-w-sm w-full px-4 py-3 rounded-lg shadow-lg flex items-start gap-3 transform transition-all duration-300 animate-in slide-in-from-right-10 ${e(s.type)}`,children:[r.jsx("div",{className:"flex-shrink-0",children:t(s.type)}),r.jsx("div",{className:"flex-1",children:r.jsx("p",{className:"text-sm font-medium",children:s.message})})]},s.id))})},kP="#0d3a61",MP=()=>{const{token:n,user:e}=ls(),[t,s]=_.useState(null),[i,l]=_.useState(!1),[c,u]=_.useState(!1),[h,m]=_.useState(!1),[p,x]=_.useState([]),[y,v]=_.useState([]),[w,A]=_.useState(!1);_.useEffect(()=>{n&&(S(),E())},[n]);const N=(K,W="info",ce=4e3)=>{const me=Date.now()+Math.random();v(L=>[...L,{id:me,message:K,type:W}]),setTimeout(()=>v(L=>L.filter(q=>q.id!==me)),ce)},S=async()=>{try{const K=await xe.get("/attendance/today",{headers:{Authorization:`Bearer ${n}`}});s(K.data||null)}catch(K){console.error("Error fetching today attendance:",K),s(null),N(K?.response?.data?.message||"Could not fetch today attendance","error")}},E=async()=>{try{const K=await xe.get("/attendance/history",{headers:{Authorization:`Bearer ${n}`}});x(K.data||[])}catch(K){console.error("Error fetching attendance history:",K),x([]),N(K?.response?.data?.message||"Could not fetch attendance history","error")}},C=async K=>{try{return(await xe.get(`/attendance/check-holiday/${K}`,{headers:{Authorization:`Bearer ${n}`}})).data.isHoliday}catch(W){return console.error("Error checking holiday:",W),!1}},R=K=>{s(K),l(!1),N("Attendance submitted successfully","success"),S(),E()},D=K=>{s(K),u(!1),N("Logout recorded successfully","success"),S(),E()},O=()=>{m(!1),N("Regularization request submitted","success"),E()},H=K=>{if(!K)return"-";try{return new Date(K).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"-"}},F=K=>{if(!K)return"-";try{return new Date(K).toLocaleDateString()}catch{return"-"}},P=K=>{const W={pending:"bg-yellow-100 text-yellow-800",accepted:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${W[K]||"bg-gray-100 text-gray-800"}`,children:K})},Z=!t,z=t&&t.status==="accepted"&&!t.checkOut;return r.jsxs("div",{className:"min-h-[80vh] p-4",children:[r.jsx("style",{children:`
        .primary-btn:hover { background: ${kP} !important }
      `}),r.jsx(Ki,{notifications:y}),r.jsxs("header",{className:"p-4 mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"My Attendance"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Manage your daily attendance and view history"})]}),r.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 flex flex-col h-[275px] w-[350px] mb-5",children:[r.jsx("div",{className:"flex items-center justify-between mb-4",children:r.jsxs("h3",{className:"font-semibold text-slate-800 text-lg",children:["Today's Attendance",r.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",new Date().toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),")"]})]})}),r.jsxs("div",{className:"flex-grow space-y-3 overflow-y-auto pr-1 scrollbar-hide mb-4",children:[r.jsxs("div",{className:"text-sm text-slate-600",children:["Status:"," ",r.jsx("span",{className:`font-medium ${t?.status==="accepted"?"text-green-500":t?.status==="pending"?"text-yellow-400":t?.status==="rejected"?"text-red-500":"text-gray-400"}`,children:t?.status||"Not Logged In"})]}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Login Time:"," ",r.jsx("span",{className:"font-medium text-slate-900",children:t?.checkIn?H(t.checkIn):"-"})]}),t?.taskDescription&&r.jsxs("div",{className:"text-sm text-slate-600",children:["Task:"," ",r.jsx("span",{className:"font-medium text-slate-900",title:t.taskDescription,children:t.taskDescription})]}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Logout Time:"," ",r.jsx("span",{className:"font-medium text-slate-900",children:t?.checkOut?H(t.checkOut):"Pending"})]}),t?.logoutDescription&&r.jsxs("div",{className:"text-sm text-slate-600",children:["Logout Note:"," ",r.jsx("span",{className:"font-medium text-slate-900",title:t.logoutDescription,children:t.logoutDescription})]}),t?.earlyLogoutReason&&r.jsxs("div",{className:"text-sm text-red-600",children:["Early Logout:"," ",r.jsx("span",{className:"font-medium",title:t.earlyLogoutReason,children:t.earlyLogoutReason})]})]}),r.jsxs("div",{className:"flex gap-2 mt-auto",children:[Z&&r.jsx("button",{onClick:async()=>{const K=new Date().toISOString().split("T")[0];if(await C(K)){N("Today is a holiday. Cannot mark attendance.","warning");return}l(!0)},className:"flex-1 bg-[#104774] hover:bg-[#0d3a61] text-white py-2 rounded-xl font-medium transition-all duration-300 shadow-md hover:shadow-lg",children:"Mark Attendance"}),z&&r.jsx("button",{onClick:()=>u(!0),className:"flex-1 bg-[#104774] hover:bg-[#0d3a61] text-white py-2 rounded-xl font-medium transition-all duration-300 shadow-md hover:shadow-lg",children:"Log Out"})]})]}),r.jsxs("section",{className:"bg-white shadow rounded-lg p-6  ",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Attendance History"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Last 30 days"}),r.jsx("button",{onClick:E,className:"p-2 text-gray-500 hover:text-gray-700",title:"Refresh",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:`M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 \r
            0a8.003 8.003 0 01-15.357-2m15.357 2H15`})})})]})]}),r.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:r.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Login"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Logout"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Work Progress"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Task"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:p.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:"No attendance records found"})}):p.map(K=>r.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:F(K.date)}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:K.checkIn?H(K.checkIn):"-"}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:K.checkOut?H(K.checkOut):"-"}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:P(K.status)}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:K.workProgress||"-"}),r.jsxs("td",{className:"px-4 py-3 text-sm text-gray-700 relative group",children:[r.jsx("div",{className:"max-w-xs truncate cursor-pointer",children:K.taskDescription||"-"}),K.taskDescription&&r.jsx("div",{className:"absolute left-1/2 top-full mt-2 hidden group-hover:flex -translate-x-1/2 z-20",children:r.jsxs("div",{className:"bg-gray-800 text-white text-xs rounded-lg shadow-lg px-3 py-2 max-w-sm whitespace-normal relative animate-fadeIn",children:[K.taskDescription,r.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-800 rotate-45"})]})})]})]},K._id))})]})})})]}),r.jsx(Iu,{isOpen:i,onClose:()=>l(!1),onSuccess:R,token:n,addNotification:N}),r.jsx(Bu,{isOpen:c,onClose:()=>u(!1),onSuccess:D,attendanceData:t,token:n,addNotification:N}),r.jsx(RP,{isOpen:h,onClose:()=>m(!1),onSuccess:O,token:n,addNotification:N,employeeId:e?._id})]})},IN=({isOpen:n,onClose:e,onReject:t,remarks:s,setRemarks:i})=>n?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Reject Attendance"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for Rejection *"}),r.jsx("textarea",{value:s,onChange:l=>i(l.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"4",placeholder:"Please provide specific reason for rejecting this attendance...",required:!0})]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:()=>t(s),disabled:!s.trim(),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirm Reject"})]})]})}):null,LP=({token:n,addNotification:e,user:t})=>{const[s,i]=_.useState(null),[l,c]=_.useState(!1),[u,h]=_.useState(!1),[m,p]=_.useState([]),[x,y]=_.useState(!1);_.useEffect(()=>{v()},[n]);const v=async()=>{try{y(!0);const[D,O]=await Promise.all([xe.get("/attendance/hr/today",{headers:{Authorization:`Bearer ${n}`}}),xe.get("/attendance/hr/history",{headers:{Authorization:`Bearer ${n}`}})]);i(D.data),p(O.data||[])}catch(D){console.error("Error fetching HR attendance data:",D),e("Error loading attendance data","error")}finally{y(!1)}},w=D=>{i(D),c(!1),e("Attendance submitted successfully","success"),v()},A=D=>{i(D),h(!1),e("Logout recorded successfully","success"),v()},N=D=>{if(!D)return"-";try{return new Date(D).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"-"}},S=D=>{if(!D)return"-";try{return new Date(D).toLocaleDateString()}catch{return"-"}},E=D=>{const O={pending:"bg-yellow-100 text-yellow-800",accepted:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${O[D]||"bg-gray-100 text-gray-800"}`,children:D})},C=!s,R=s?.status==="accepted"&&!s.checkOut;return r.jsxs("div",{children:[r.jsxs("div",{className:"h-[300px] overflow-y-auto border border-gray-200 rounded-lg shadow-sm p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"My Attendance"}),r.jsx("button",{onClick:v,className:"p-2 text-gray-500 hover:text-gray-700",title:"Refresh",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),r.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Today's Attendance"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[r.jsxs("div",{className:"p-3 bg-white rounded-lg shadow flex flex-col",children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Status"}),r.jsx("span",{className:`text-lg font-semibold mt-1 capitalize ${s?.status==="accepted"?"text-green-600":s?.status==="pending"?"text-yellow-600":"text-red-600"}`,children:s?.status||"Not Logged In"})]}),r.jsxs("div",{className:"p-3 bg-white rounded-lg shadow flex flex-col",children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Login Time"}),r.jsx("span",{className:"text-lg font-semibold mt-1",children:s?.checkIn?N(s.checkIn):"-"})]}),r.jsxs("div",{className:"p-3 bg-white rounded-lg shadow flex flex-col",children:[r.jsx("span",{className:"text-sm text-gray-500",children:"Logout Time"}),r.jsx("span",{className:"text-lg font-semibold mt-1",children:s?.checkOut?N(s.checkOut):"Pending"})]})]}),r.jsxs("div",{className:"flex gap-3 mt-3",children:[C&&r.jsx("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-[#104774] text-white rounded-md hover:bg-[#0d3a61]",children:"Mark Attendance"}),R&&r.jsx("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-[#104774] text-white rounded-md hover:bg-[#0d3a61]",children:"Log Out"})]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Login"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Logout"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Task"})]})}),r.jsx("tbody",{children:m.map((D,O)=>r.jsxs("tr",{className:`${O%2===0?"bg-white":"bg-gray-50"} hover:bg-gray-100 transition`,children:[r.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 whitespace-nowrap",children:S(D.date)}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 whitespace-nowrap",children:D.checkIn?N(D.checkIn):"-"}),r.jsx("td",{className:"px-4 py-2 text-sm text-gray-700 whitespace-nowrap",children:D.checkOut?N(D.checkOut):"-"}),r.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:E(D.status)}),r.jsxs("td",{className:"px-4 py-2 text-sm text-gray-700 relative group max-w-xs truncate cursor-pointer",children:[D.taskDescription||"-",D.taskDescription&&r.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-1 w-64 bg-gray-800 text-white text-xs rounded-md p-2 shadow-lg z-[999] invisible opacity-0 group-hover:visible group-hover:opacity-100 break-words",children:D.taskDescription})]})]},D._id))})]})})]}),r.jsx(Iu,{isOpen:l,onClose:()=>c(!1),onSuccess:w,token:n,addNotification:e,basePath:"/attendance/hr"}),r.jsx(Bu,{isOpen:u,onClose:()=>h(!1),onSuccess:A,attendanceData:s,token:n,addNotification:e,basePath:"/attendance/hr"})]})},$a="#104774",OP="#0d3a61",PP=()=>{const{token:n,user:e}=ls(),[t,s]=_.useState([]),[i,l]=_.useState([]),[c,u]=_.useState(null),[h,m]=_.useState(!1),[p,x]=_.useState(""),[y,v]=_.useState("pending"),[w,A]=_.useState({totalEmployees:0,present:0,absent:0,pending:0}),[N,S]=_.useState([]),[E,C]=_.useState(!1),R=new Date().toISOString().split("T")[0],[D,O]=_.useState({employee:"",date:R,status:""});_.useEffect(()=>{n&&(F(),P(),Z())},[n]);const H=(M,G="info",de=3500)=>{const re=Date.now()+Math.random();S(ye=>[...ye,{id:re,message:M,type:G}]),setTimeout(()=>S(ye=>ye.filter(je=>je.id!==re)),de)},F=async()=>{try{C(!0);const M=await xe.get("/attendance/pending",{headers:{Authorization:`Bearer ${n}`}});s(M.data||[])}catch(M){console.error("Error fetching pending attendances:",M),H(M.response?.data?.message||"Could not load pending requests","error")}finally{C(!1)}},P=async()=>{try{C(!0);const M=await xe.get("/attendance/all",{headers:{Authorization:`Bearer ${n}`}});l(M.data||[])}catch(M){console.error("Error fetching all attendances:",M),H(M.response?.data?.message||"Could not load records","error")}finally{C(!1)}},Z=async()=>{try{const M=await xe.get("/attendance/stats",{headers:{Authorization:`Bearer ${n}`}});A(M.data||{})}catch(M){console.error("Error fetching stats:",M),H("Error loading statistics","error")}},z=M=>{!M||!M._id||(l(G=>{const de=G.findIndex(ye=>ye._id===M._id);if(de===-1)return[M,...G];const re=[...G];return re[de]={...re[de],...M},re}),s(G=>G.filter(de=>de._id!==M._id)))},K=async M=>{try{const G=await xe.patch(`/attendance/${M}/approve`,{},{headers:{Authorization:`Bearer ${n}`}}),de=G.data?.attendance||G.data;de&&de._id?z(de):(s(re=>re.filter(ye=>ye._id!==M)),P()),G.data?.stats?A(G.data.stats):Z(),H(G.data?.message||"Attendance approved","success")}catch(G){console.error("Error approving attendance:",G),H(G.response?.data?.message||"Error approving attendance","error")}},W=async M=>{if(c)try{const G=await xe.patch(`/attendance/${c}/reject`,{remarks:M},{headers:{Authorization:`Bearer ${n}`}}),de=G.data?.attendance||G.data;de&&de._id?z(de):(s(re=>re.filter(ye=>ye._id!==c)),P()),G.data?.stats?A(G.data.stats):Z(),H(G.data?.message||"Attendance rejected","success"),m(!1),x(""),u(null)}catch(G){console.error("Error rejecting attendance:",G),H(G.response?.data?.message||"Error rejecting attendance","error")}},ce=M=>{u(M),m(!0)},me=M=>{const{name:G,value:de}=M.target;O(re=>({...re,[G]:de}))},L=()=>{O({employee:"",date:"",status:""})},q=M=>{if(!M)return"-";try{return new Date(M).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"-"}},$=M=>{if(!M)return"-";try{return new Date(M).toLocaleDateString()}catch{return"-"}},I=M=>{const G={pending:"bg-yellow-100 text-yellow-800",accepted:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${G[M]||"bg-gray-100 text-gray-800"}`,children:M})},T=i.filter(M=>{const G=D.employee?`${M.employee?.profileRef?.firstName} ${M.employee?.profileRef?.lastName}`.toLowerCase().includes(D.employee.toLowerCase())||M.employee?.email?.toLowerCase().includes(D.employee.toLowerCase()):!0,de=D.date?$(M.date)===$(D.date):!0,re=D.status?M.status===D.status:!0;return G&&de&&re}),V=t.filter(M=>{const G=D.employee?`${M.employee?.profileRef?.firstName} ${M.employee?.profileRef?.lastName}`.toLowerCase().includes(D.employee.toLowerCase())||M.employee?.email?.toLowerCase().includes(D.employee.toLowerCase()):!0,de=D.date?$(M.date)===$(D.date):!0;return G&&de});return r.jsxs("div",{className:"min-h-[70vh] p-4 sm:p-6",children:[r.jsx("style",{children:`
        .primary-btn:hover { background: ${OP} !important }
        .primary-border-active { border-bottom-color: ${$a} !important; color: ${$a} !important }
      `}),r.jsx(Ki,{notifications:N}),r.jsxs("header",{className:"mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Attendance Management"}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage employee attendance approvals and records"})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 mb-6",children:[r.jsxs("div",{className:"bg-gradient-to-r from-blue-100 via-blue-100 to-blue-200 rounded-2xl p-6 shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-sm text-blue-700 font-semibold mb-2",children:"Total Employees"}),r.jsx("p",{className:"text-2xl font-bold text-blue-900",children:w.totalEmployees??0})]}),r.jsxs("div",{className:"bg-gradient-to-r from-green-100 via-green-100 to-green-200 rounded-2xl p-6 shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-sm text-green-700 font-semibold mb-2",children:"Present Today"}),r.jsx("p",{className:"text-2xl font-bold text-green-900",children:w.present??0})]}),r.jsxs("div",{className:"bg-gradient-to-r from-red-100 via-red-100 to-red-200 rounded-2xl p-6 shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-sm text-red-700 font-semibold mb-2",children:"Absent Today"}),r.jsx("p",{className:"text-2xl font-bold text-red-900",children:Math.max(0,w?.absent??0)})]}),r.jsxs("div",{className:"bg-gradient-to-r from-yellow-100 via-yellow-100 to-yellow-200 rounded-2xl p-6 shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-sm text-yellow-700 font-semibold mb-2",children:"Pending Approval"}),r.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:w.pending??0})]})]}),r.jsxs("div",{className:"bg-white shadow rounded-lg mb-6",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("nav",{className:"flex -mb-px overflow-auto",children:[r.jsxs("button",{onClick:()=>v("pending"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${y==="pending"?"primary-border-active":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,style:y==="pending"?{borderBottomColor:$a,color:$a}:{},children:["Pending Approvals",t.length>0&&r.jsx("span",{className:"ml-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:t.length})]}),r.jsx("button",{onClick:()=>v("all"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${y==="all"?"primary-border-active":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,style:y==="all"?{borderBottomColor:$a,color:$a}:{},children:"All Records"}),r.jsx("button",{onClick:()=>v("hr"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${y==="hr"?"primary-border-active":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,style:y==="hr"?{borderBottomColor:$a,color:$a}:{},children:"My Attendance"})]})}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Employee"}),r.jsx("input",{type:"text",name:"employee",value:D.employee,onChange:me,placeholder:"Name or email",className:"w-full p-2 border border-gray-300 rounded-md"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),r.jsx("input",{type:"date",name:"date",value:D.date,onChange:me,className:"w-full p-2 border border-gray-300 rounded-md"})]}),y==="all"&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),r.jsxs("select",{name:"status",value:D.status,onChange:me,className:"w-full p-2 border border-gray-300 rounded-md",children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"accepted",children:"Accepted"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsx("div",{className:"flex items-end",children:r.jsx("button",{onClick:L,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Clear Filters"})})]}),y==="pending"&&r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Pending Attendance Approvals"}),r.jsx("button",{onClick:F,className:"p-2 text-gray-500 hover:text-gray-700",title:"Refresh",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),E?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),r.jsx("p",{className:"text-gray-500 mt-2",children:"Loading pending requests..."})]}):V.length===0?r.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[r.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{className:"text-gray-500",children:"No pending approvals"})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsx("div",{className:"max-h-[290px] overflow-y-auto border border-gray-200 rounded-xl shadow-sm",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Employee"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Login Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Task Description"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Work Progress"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Actions"})]})}),r.jsxs("tbody",{className:"divide-y divide-gray-200",children:[V.map((M,G)=>r.jsxs("tr",{className:`${G%2===0?"bg-white":"bg-gray-50"} hover:bg-gray-100 transition`,children:[r.jsxs("td",{className:"px-6 py-4",children:[r.jsxs("div",{className:"font-medium text-gray-800",children:[M.employee?.profileRef?.firstName," ",M.employee?.profileRef?.lastName]}),r.jsx("div",{className:"text-sm text-gray-500",children:M.employee?.email}),r.jsx("div",{className:"text-xs text-gray-400",children:M.employee?.profileRef?.employeeId})]}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:$(M.date)}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:M.checkIn?q(M.checkIn):"-"}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"font-medium text-gray-800 mb-1",children:"Task:"}),r.jsx("div",{className:"max-w-xs truncate cursor-pointer",children:M.taskDescription||"-"}),M.taskDescription&&r.jsx("div",{className:"absolute hidden group-hover:block bg-gray-800 text-white text-xs rounded-md px-3 py-2 w-60 z-20 -top-1 left-1/2 -translate-x-1/2 shadow-lg",children:M.taskDescription})]}),M.earlyLoginReason&&r.jsxs("div",{className:"relative group mt-2 pt-2 border-t border-gray-100",children:[r.jsx("div",{className:"font-medium text-orange-600 mb-1",children:"Early Login Reason:"}),r.jsx("div",{className:"max-w-xs truncate cursor-pointer",children:M.earlyLoginReason}),r.jsx("div",{className:"absolute hidden group-hover:block bg-gray-800 text-white text-xs rounded-md px-3 py-2 w-60 z-20 -top-1 left-1/2 -translate-x-1/2 shadow-lg",children:M.earlyLoginReason})]}),M.lateLoginReason&&r.jsxs("div",{className:"relative group mt-2 pt-2 border-t border-gray-100",children:[r.jsx("div",{className:"font-medium text-red-600 mb-1",children:"Late Login Reason:"}),r.jsx("div",{className:"max-w-xs truncate cursor-pointer",children:M.lateLoginReason}),r.jsx("div",{className:"absolute hidden group-hover:block bg-gray-800 text-white text-xs rounded-md px-3 py-2 w-60 z-20 -top-1 left-1/2 -translate-x-1/2 shadow-lg",children:M.lateLoginReason})]})]})}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:M.workProgress||"-"}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx("button",{onClick:()=>K(M._id),className:"px-3 py-1.5 rounded-md text-white bg-[#104774] hover:bg-[#0d3a61] text-sm font-medium shadow-sm transition",children:"Approve"}),r.jsx("button",{onClick:()=>ce(M._id),className:"px-3 py-1.5 rounded-md text-white bg-red-600 hover:bg-red-700 text-sm font-medium shadow-sm transition",children:"Reject"})]})})]},M._id)),V.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,className:"px-6 py-10 text-center text-sm text-gray-500",children:"No pending attendances found"})})]})]})})})]}),y==="all"&&r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"All Attendance Records"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-sm text-gray-500",children:["Showing ",T.length," of"," ",i.length," records"]}),r.jsx("button",{onClick:P,className:"p-2 text-gray-500 hover:text-gray-700",title:"Refresh",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]}),E?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),r.jsx("p",{className:"text-gray-500 mt-2",children:"Loading records..."})]}):T.length===0?r.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[r.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{className:"text-gray-500",children:"No records found"})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsx("div",{className:"max-h-[250px] overflow-y-auto border border-gray-200 rounded-xl shadow-sm",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10 rounded-t-lg",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Employee"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Login Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Logout Time"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Work Progress"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Task"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Logout Note"})]})}),r.jsx("tbody",{children:T.map((M,G)=>r.jsxs("tr",{className:`${G%2===0?"bg-white":"bg-gray-100"} transition`,children:[r.jsxs("td",{className:"px-6 py-3 whitespace-nowrap",children:[r.jsxs("div",{className:"font-medium text-gray-800",children:[M.employee?.profileRef?.firstName," ",M.employee?.profileRef?.lastName]}),r.jsx("div",{className:"text-sm text-gray-500",children:M.employee?.email}),r.jsx("div",{className:"text-xs text-gray-400 mt-1",children:M.employee?.profileRef?.employeeId})]}),r.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm text-gray-700",children:$(M.date)}),r.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm text-gray-700",children:q(M.checkIn)}),r.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm text-gray-700",children:q(M.checkOut)||"-"}),r.jsx("td",{className:"px-6 py-3 whitespace-nowrap",children:I(M.status)}),r.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm text-gray-700",children:M.workProgress||"-"}),r.jsx("td",{className:"px-6 py-3 text-sm text-gray-700 max-w-xs",children:r.jsxs("div",{className:"space-y-1",children:[M.taskDescription?r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"truncate cursor-pointer font-medium hover:text-blue-600",children:M.taskDescription}),r.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-64 bg-gray-900 text-white text-xs rounded-lg p-2 shadow-lg z-50 invisible opacity-0 group-hover:visible group-hover:opacity-100 transition-all duration-200 break-words",children:[M.taskDescription,r.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -mt-1 w-2 h-2 bg-gray-900 rotate-45"})]})]}):r.jsx("span",{className:"text-gray-400 italic",children:"-"}),M.earlyLoginReason&&r.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Early Login:"})," ",M.earlyLoginReason]}),M.lateLoginReason&&r.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Late Login:"})," ",M.lateLoginReason]})]})}),r.jsx("td",{className:"px-6 py-3 text-sm",children:M.logoutDescription?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"font-medium",children:M.logoutDescription}),M.earlyLogoutReason&&r.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Early Logout:"})," ",M.earlyLogoutReason]})]}):"-"})]},M._id))})]})})})]}),y==="hr"&&r.jsx(LP,{token:n,addNotification:H,user:e})]})]}),r.jsx(IN,{isOpen:h,onClose:()=>{m(!1),x(""),u(null)},onReject:W,remarks:p,setRemarks:x})]})},IP=({token:n,addNotification:e})=>{const[t,s]=_.useState([]),[i,l]=_.useState(!1),[c,u]=_.useState({month:new Date().getMonth()+1,year:new Date().getFullYear(),department:""}),[h,m]=_.useState([]);_.useEffect(()=>{p(),x()},[c]);const p=async()=>{try{const A=await xe.get("/attendance/departments",{headers:{Authorization:`Bearer ${n}`}});m(A.data||[])}catch(A){console.error("Error fetching departments:",A),m(["HR","IT","Finance","Operations","Sales","Marketing"])}},x=async()=>{l(!0);try{const A=new URLSearchParams;c.month&&A.append("month",c.month),c.year&&A.append("year",c.year),c.department&&A.append("department",c.department);const N=await xe.get(`/attendance/reports/monthly?${A}`,{headers:{Authorization:`Bearer ${n}`}});s(N.data||[])}catch(A){console.error("Error generating reports:",A),e(A.response?.data?.message||"Error generating reports","error"),s([])}finally{l(!1)}},y=A=>{const{name:N,value:S}=A.target;u(E=>({...E,[N]:S}))},v=new Date().getFullYear(),w=Array.from({length:5},(A,N)=>v-N);return r.jsxs("div",{children:[r.jsx("div",{className:"flex flex-col mb-5 gap-3",children:r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Monthly Attendance Reports"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:"Track and analyze employee attendance patterns"})]})}),r.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-sm border border-gray-200 p-3 sm:p-4 mb-5",children:[r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-800 mb-3",children:"Filter Reports"}),r.jsx("div",{className:"grid grid-cols-1 gap-3",children:r.jsxs("div",{className:"space-y-3 md:space-y-0 md:grid md:grid-cols-4 md:gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2",children:"Month"}),r.jsxs("select",{name:"month",value:c.month,onChange:y,className:"w-full p-2 sm:p-3 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"All Months"}),Array.from({length:12},(A,N)=>r.jsx("option",{value:N+1,children:new Date(2023,N).toLocaleString("default",{month:"long"})},N+1))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2",children:"Year"}),r.jsxs("select",{name:"year",value:c.year,onChange:y,className:"w-full p-2 sm:p-3 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"All Years"}),w.map(A=>r.jsx("option",{value:A,children:A},A))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2",children:"Department"}),r.jsxs("select",{name:"department",value:c.department,onChange:y,className:"w-full p-2 sm:p-3 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"",children:"All Departments"}),h.map(A=>r.jsx("option",{value:A,children:A},A))]})]}),r.jsx("div",{className:"flex items-end pt-1",children:r.jsx("button",{onClick:x,className:"w-full px-4 py-2.5 sm:px-6 sm:py-3 rounded-lg text-white font-medium text-sm sm:text-base transition-all duration-200 shadow-md",style:{backgroundColor:"#104774"},children:i?r.jsxs("span",{className:"flex items-center justify-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 sm:w-4 sm:h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Refreshing..."]}):r.jsxs("span",{className:"flex items-center justify-center gap-1 sm:gap-2",children:[r.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Report"]})})})]})})]}),i?r.jsxs("div",{className:"text-center py-8 sm:py-12 bg-white rounded-lg sm:rounded-xl shadow-sm border border-gray-200",children:[r.jsx("div",{className:"animate-spin rounded-full h-10 w-10 sm:h-12 sm:w-12 border-b-2 border-blue-500 mx-auto mb-3 sm:mb-4"}),r.jsx("p",{className:"text-sm sm:text-gray-600 font-medium",children:"Generating reports..."}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:"Please wait while we process your data"})]}):t.length===0?r.jsxs("div",{className:"text-center py-10 sm:py-16 bg-white rounded-lg sm:rounded-xl shadow-sm border border-gray-200",children:[r.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4",children:r.jsx("svg",{className:"w-8 h-8 sm:w-10 sm:h-10 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-700 mb-2",children:"No report data available"}),r.jsx("p",{className:"text-xs sm:text-gray-500 max-w-md mx-auto px-2",children:"Try adjusting your filters or select a different date range to generate attendance reports."})]}):r.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[r.jsx("div",{className:"block lg:hidden space-y-3 p-3",children:t.map((A,N)=>r.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-shadow",children:[r.jsx("div",{className:"flex items-start justify-between mb-2",children:r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"font-semibold text-gray-900 text-sm truncate",children:A.employeeName||"N/A"}),r.jsx("p",{className:"text-xs text-gray-500 truncate",children:A.employeeEmail||"N/A"}),r.jsxs("div",{className:"flex items-center gap-1 mt-1 flex-wrap",children:[r.jsxs("span",{className:"text-xs text-gray-500",children:["ID: ",A.employeeId||"N/A"]}),r.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs",children:A.department||"N/A"})]})]})}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[r.jsxs("div",{className:"text-center p-1.5 bg-green-50 rounded",children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Present"}),r.jsx("p",{className:"font-semibold text-green-600 text-sm",children:A.present||0})]}),r.jsxs("div",{className:"text-center p-1.5 bg-red-50 rounded",children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Absent"}),r.jsx("p",{className:"font-semibold text-red-600 text-sm",children:A.absent||0})]}),r.jsxs("div",{className:"text-center p-1.5 bg-yellow-50 rounded",children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Pending"}),r.jsx("p",{className:"font-semibold text-yellow-600 text-sm",children:A.pending||0})]}),r.jsxs("div",{className:"text-center p-1.5 bg-red-50 rounded",children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Rejected"}),r.jsx("p",{className:"font-semibold text-red-600 text-sm",children:A.rejected||0})]})]}),r.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Total Days"}),r.jsx("p",{className:"font-semibold text-gray-800 text-sm",children:A.totalDays||0})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-xs text-gray-500",children:"Attendance"}),r.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${(A.attendancePercentage||0)>=90?"bg-green-100 text-green-800":(A.attendancePercentage||0)>=75?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[A.attendancePercentage?Math.round(A.attendancePercentage):0,"%"]})]})]})]},N))}),r.jsx("div",{className:"hidden lg:block overflow-x-auto",children:r.jsx("div",{className:"max-h-[180px] overflow-y-auto",children:r.jsxs("table",{className:"w-full min-w-[800px]",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs sm:text-sm font-semibold uppercase tracking-wider",children:"Employee"}),r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs sm:text-sm font-semibold uppercase tracking-wider",children:"Employee ID"}),r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs sm:text-sm font-semibold uppercase tracking-wider",children:"Department"}),r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs sm:text-sm font-semibold uppercase tracking-wider",children:"Present"}),r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs sm:text-sm font-semibold uppercase tracking-wider",children:"Absent"}),r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs sm:text-sm font-semibold uppercase tracking-wider",children:"Pending"}),r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs sm:text-sm font-semibold uppercase tracking-wider",children:"Rejected"}),r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs sm:text-sm font-semibold uppercase tracking-wider",children:"Total Days"}),r.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs sm:text-sm font-semibold uppercase tracking-wider",children:"Attendance %"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map((A,N)=>r.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[r.jsxs("td",{className:"px-4 sm:px-6 py-3",children:[r.jsx("div",{className:"font-medium text-gray-900 text-sm",children:A.employeeName||"N/A"}),r.jsx("div",{className:"text-xs text-gray-500",children:A.employeeEmail||"N/A"})]}),r.jsx("td",{className:"px-4 sm:px-6 py-3 text-xs sm:text-sm text-gray-700",children:A.employeeId||"N/A"}),r.jsx("td",{className:"px-4 sm:px-6 py-3",children:r.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:A.department||"N/A"})}),r.jsx("td",{className:"px-4 sm:px-6 py-3 text-green-600 font-semibold text-sm",children:A.present||0}),r.jsx("td",{className:"px-4 sm:px-6 py-3 text-red-600 font-semibold text-sm",children:A.absent||0}),r.jsx("td",{className:"px-4 sm:px-6 py-3 text-yellow-600 font-semibold text-sm",children:A.pending||0}),r.jsx("td",{className:"px-4 sm:px-6 py-3 text-red-600 font-semibold text-sm",children:A.rejected||0}),r.jsx("td",{className:"px-4 sm:px-6 py-3 font-semibold text-gray-700 text-sm",children:A.totalDays||0}),r.jsx("td",{className:"px-4 sm:px-6 py-3",children:r.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${(A.attendancePercentage||0)>=90?"bg-green-100 text-green-800":(A.attendancePercentage||0)>=75?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[A.attendancePercentage?Math.round(A.attendancePercentage):0,"%"]})})]},N))})]})})}),r.jsx("div",{className:"border-t border-gray-200 px-4 sm:px-6 py-2 bg-gray-50",children:r.jsxs("p",{className:"text-xs sm:text-sm text-gray-600",children:["Showing ",r.jsx("span",{className:"font-semibold",children:t.length})," employee records"]})})]})]})},ji="#104774",BP="#0d3a61",HP=()=>{const{token:n}=ls(),[e,t]=_.useState([]),[s,i]=_.useState([]),[l,c]=_.useState(!0),u=new Date().toISOString().split("T")[0],[h,m]=_.useState({employee:"",date:u,status:"pending",department:"",role:""}),[p,x]=_.useState({totalEmployees:0,present:0,absent:0,pending:0}),[y,v]=_.useState([]),[w,A]=_.useState(null),[N,S]=_.useState(!1),[E,C]=_.useState(""),[R,D]=_.useState("records"),[O,H]=_.useState([]);_.useEffect(()=>{n&&(P(),Z(),z())},[n]),_.useEffect(()=>{K()},[h,e]);const F=(I,T="info",V=3500)=>{const M=Date.now()+Math.random();v(G=>[...G,{id:M,message:I,type:T}]),setTimeout(()=>v(G=>G.filter(de=>de.id!==M)),V)},P=async()=>{c(!0);try{const I=await xe.get("/attendance/all",{headers:{Authorization:`Bearer ${n}`}});t(I.data||[])}catch(I){console.error("Error fetching all attendances:",I),F(I.response?.data?.message||"Could not fetch attendance records","error"),t([])}finally{c(!1)}},Z=async()=>{try{const I=await xe.get("/attendance/stats",{headers:{Authorization:`Bearer ${n}`}});x(I.data||{})}catch(I){console.error("Error fetching stats:",I),F("Error loading statistics","error")}},z=async()=>{try{const I=await xe.get("/departments");I.data.success&&H(I.data.data)}catch(I){console.error("Error fetching departments:",I)}},K=()=>{let I=[...e];h.employee&&(I=I.filter(T=>`${T.employee?.profileRef?.firstName||""} ${T.employee?.profileRef?.lastName||""}`.trim().toLowerCase().includes(h.employee.toLowerCase())||(T.employee?.email||"").toLowerCase().includes(h.employee.toLowerCase()))),h.date&&(I=I.filter(T=>T.date?new Date(T.date).toLocaleDateString()===new Date(h.date).toLocaleDateString():!1)),h.status&&(I=I.filter(T=>T.status===h.status)),h.department&&(I=I.filter(T=>T.employee?.profileRef?.department===h.department)),h.role&&(I=I.filter(T=>T.employee?.role===h.role)),i(I)},W=I=>{const{name:T,value:V}=I.target;m(M=>({...M,[T]:V}))},ce=()=>{m({employee:"",date:"",status:"",department:"",role:""})},me=async I=>{if(w)try{const T=await xe.patch(`/attendance/${w}/admin-reject`,{remarks:I},{headers:{Authorization:`Bearer ${n}`}});T.data?.attendance?t(V=>V.map(M=>M._id===w?T.data.attendance:M)):P(),Z(),F(T.data?.message||"Attendance rejected","success"),S(!1),C(""),A(null)}catch(T){console.error("Error rejecting attendance:",T),F(T.response?.data?.message||"Error rejecting attendance","error")}},L=I=>{if(!I)return"-";try{return new Date(I).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"-"}},q=I=>{if(!I)return"-";try{return new Date(I).toLocaleDateString()}catch{return"-"}},$=I=>{const T={pending:"bg-yellow-100 text-yellow-800",accepted:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${T[I]||"bg-gray-100 text-gray-800"}`,children:I})};return l&&e.length===0?r.jsx("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin inline-block w-8 h-8 border-4 rounded-full",style:{borderColor:ji,borderLeftColor:"transparent"},role:"status"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Loading attendance records..."})]})}):r.jsxs("div",{className:"max-h-[80vh] p-4 md:p-6",children:[r.jsx("style",{children:`
        .primary-btn:hover { background: ${BP} !important }
        .primary-border-active { border-bottom-color: ${ji} !important; color: ${ji} !important }
      `}),r.jsx(Ki,{notifications:y}),r.jsxs("header",{className:"p-4 mb-4 md:mb-6",children:[r.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-800 text-center md:text-left",children:"Admin Attendance Management"}),r.jsx("p",{className:"text-xs md:text-sm text-gray-600 mt-1 text-center md:text-left",children:"Manage all employee and HR attendance records"})]}),r.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-3 md:gap-6 mb-4 md:mb-6",children:[r.jsxs("div",{className:"bg-gradient-to-r from-blue-100 via-blue-100 to-blue-200 rounded-xl md:rounded-2xl p-3 md:p-6 shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-xs md:text-sm text-blue-700 font-semibold mb-1 md:mb-2",children:"Total Employees"}),r.jsx("p",{className:"text-lg md:text-2xl font-bold text-blue-900",children:p.totalEmployees??0})]}),r.jsxs("div",{className:"bg-gradient-to-r from-green-100 via-green-100 to-green-200 rounded-xl md:rounded-2xl p-3 md:p-6 shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-xs md:text-sm text-green-700 font-semibold mb-1 md:mb-2",children:"Present Today"}),r.jsx("p",{className:"text-lg md:text-2xl font-bold text-green-900",children:p.present??0})]}),r.jsxs("div",{className:"bg-gradient-to-r from-red-100 via-red-100 to-red-200 rounded-xl md:rounded-2xl p-3 md:p-6 shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-xs md:text-sm text-red-700 font-semibold mb-1 md:mb-2",children:"Absent Today"}),r.jsx("p",{className:"text-lg md:text-2xl font-bold text-red-900",children:Math.max(0,p?.absent??0)})]}),r.jsxs("div",{className:"bg-gradient-to-r from-yellow-100 via-yellow-100 to-yellow-200 rounded-xl md:rounded-2xl p-3 md:p-6 shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center",children:[r.jsx("h3",{className:"text-xs md:text-sm text-yellow-700 font-semibold mb-1 md:mb-2",children:"Pending Approval"}),r.jsx("p",{className:"text-lg md:text-2xl font-bold text-yellow-900",children:p.pending??0})]})]}),r.jsxs("div",{className:"bg-white shadow rounded-lg md:rounded-xl mb-6",children:[r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("nav",{className:"flex overflow-x-auto",children:[r.jsx("button",{onClick:()=>D("records"),className:`py-3 md:py-4 px-4 md:px-6 text-center border-b-2 font-medium text-xs md:text-sm min-w-max ${R==="records"?"primary-border-active":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,style:R==="records"?{borderBottomColor:ji,color:ji}:{},children:"Attendance Records"}),r.jsx("button",{onClick:()=>D("reports"),className:`py-3 md:py-4 px-4 md:px-6 text-center border-b-2 font-medium text-xs md:text-sm min-w-max ${R==="reports"?"primary-border-active":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,style:R==="reports"?{borderBottomColor:ji,color:ji}:{},children:"Reports & Analytics"})]})}),r.jsxs("div",{className:"p-3 md:p-6",children:[R==="records"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 md:gap-4 mb-4 md:mb-6",children:[r.jsxs("div",{className:"sm:col-span-2 lg:col-span-1",children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-700 mb-1",children:"Employee Name/Email"}),r.jsx("input",{type:"text",name:"employee",value:h.employee,onChange:W,className:"w-full p-2 text-xs md:text-sm border border-gray-300 rounded-md",placeholder:"Search employee..."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-700 mb-1",children:"Date"}),r.jsx("input",{type:"date",name:"date",value:h.date,onChange:W,className:"w-full p-2 text-xs md:text-sm border border-gray-300 rounded-md"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-700 mb-1",children:"Status"}),r.jsxs("select",{name:"status",value:h.status,onChange:W,className:"w-full p-2 text-xs md:text-sm border border-gray-300 rounded-md",children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"accepted",children:"Accepted"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsx("div",{className:"flex items-end gap-2",children:r.jsx("button",{onClick:ce,className:"px-3 md:px-4 py-2 text-xs md:text-sm bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 w-full",children:"Clear Filters"})})]}),r.jsxs("div",{className:"bg-white rounded-lg",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3 md:mb-4 gap-2 md:gap-3",children:[r.jsx("h2",{className:"text-lg md:text-xl font-semibold text-center sm:text-left",children:"Attendance Records"}),r.jsx("div",{className:"flex gap-2 justify-center sm:justify-start",children:r.jsx("button",{onClick:P,className:"p-2 text-gray-500 hover:text-gray-700 border rounded-md",title:"Refresh",children:r.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})})]}),r.jsxs("div",{className:"block md:hidden space-y-1",children:[s.map((I,T)=>r.jsxs("div",{className:"bg-white rounded-lg p-1 border border-gray-100 shadow-sm hover:shadow-md transition-all duration-200",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:[I.employee?.profileRef?.firstName," ",I.employee?.profileRef?.lastName]}),r.jsx("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:I.employee?.email})]}),r.jsx("div",{className:"text-right ml-2 flex-shrink-0",children:r.jsx("span",{className:"inline-block py-1 bg-blue-50 text-blue-700 text-xs font-medium rounded-full whitespace-nowrap",children:q(I.date)})})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-1 mb-2",children:[r.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[r.jsx("svg",{className:"w-3 h-3 text-green-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{className:"text-xs font-medium text-gray-500 truncate",children:"Login"})]}),r.jsx("p",{className:"text-xs font-semibold text-gray-800 truncate",children:L(I.checkIn)})]}),r.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[r.jsx("svg",{className:"w-3 h-3 text-red-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{className:"text-xs font-medium text-gray-500 truncate",children:"Logout"})]}),r.jsx("p",{className:"text-xs font-semibold text-gray-800 truncate",children:L(I.checkOut)||"-"})]})]}),r.jsxs("div",{className:"mb-2",children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Status"}),r.jsx("div",{className:"transform scale-90 origin-left",children:$(I.status)})]}),r.jsxs("div",{className:"space-y-1.5 mb-2",children:[r.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-gray-100",children:[r.jsx("span",{className:"text-xs font-medium text-gray-500 truncate",children:"Work Progress"}),r.jsx("span",{className:"text-xs text-gray-800 font-medium truncate ml-1",children:I.workProgress||"-"})]}),r.jsxs("div",{className:"py-1 border-b border-gray-100",children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 mb-0.5",children:"Task"}),r.jsx("p",{className:"text-xs text-gray-800 line-clamp-2 break-words",children:I.taskDescription||"No task description"})]}),r.jsxs("div",{className:"py-1",children:[r.jsx("p",{className:"text-xs font-medium text-gray-500 mb-0.5",children:"Logout Note"}),r.jsx("p",{className:"text-xs text-gray-800 line-clamp-2 break-words",children:I.logoutDescription||"No logout note"})]})]}),(I.earlyLoginReason||I.lateLoginReason||I.earlyLogoutReason)&&r.jsxs("div",{className:"bg-amber-50 border border-amber-200 p-2 rounded mb-1",children:[r.jsxs("div",{className:"flex items-center gap-1 mb-1.5",children:[r.jsx("svg",{className:"w-3.5 h-3.5 text-amber-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),r.jsx("p",{className:"text-xs font-semibold text-amber-800 truncate",children:"Attendance Notes"})]}),r.jsxs("div",{className:"space-y-1",children:[I.earlyLoginReason&&r.jsxs("div",{className:"flex items-start gap-1.5",children:[r.jsx("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-[10px] font-medium bg-amber-100 text-amber-800 mt-0.5 flex-shrink-0",children:"Early"}),r.jsx("p",{className:"text-[10px] text-amber-700 flex-1 break-words",children:I.earlyLoginReason})]}),I.lateLoginReason&&r.jsxs("div",{className:"flex items-start gap-1.5",children:[r.jsx("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-[10px] font-medium bg-amber-100 text-amber-800 mt-0.5 flex-shrink-0",children:"Late"}),r.jsx("p",{className:"text-[10px] text-amber-700 flex-1 break-words",children:I.lateLoginReason})]}),I.earlyLogoutReason&&r.jsxs("div",{className:"flex items-start gap-1.5",children:[r.jsx("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-[10px] font-medium bg-amber-100 text-amber-800 mt-0.5 flex-shrink-0",children:"Early Out"}),r.jsx("p",{className:"text-[10px] text-amber-700 flex-1 break-words",children:I.earlyLogoutReason})]})]})]})]},I._id)),s.length===0&&r.jsx("div",{className:"text-center p-4 bg-gradient-to-br from-gray-50 to-blue-50 rounded-lg border border-gray-100 shadow-sm mx-2",children:r.jsxs("div",{className:"flex flex-col items-center justify-center",children:[r.jsx("svg",{className:"w-10 h-10 text-gray-300 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-1",children:"No attendance records found"}),r.jsx("p",{className:"text-xs text-gray-500 px-2",children:"Try adjusting your filters or date range"})]})})]}),r.jsx("div",{className:"hidden md:block overflow-x-auto",children:r.jsx("div",{className:"max-h-[280px] overflow-y-auto border border-gray-200 rounded-xl shadow-sm",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-[#104774] text-white sticky top-0 z-10 rounded-t-lg",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Employee"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Login Time"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Logout Time"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Work Progress"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Task"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider",children:"Logout Note"})]})}),r.jsx("tbody",{children:s.map((I,T)=>r.jsxs("tr",{className:`${T%2===0?"bg-white":"bg-gray-100"} transition`,children:[r.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[r.jsxs("div",{className:"font-medium text-gray-800 text-sm",children:[I.employee?.profileRef?.firstName," ",I.employee?.profileRef?.lastName]}),r.jsx("div",{className:"text-xs text-gray-500",children:I.employee?.email}),r.jsx("div",{className:"text-xs text-gray-400 mt-1",children:I.employee?.profileRef?.employeeId})]}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-xs md:text-sm text-gray-700",children:q(I.date)}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-xs md:text-sm text-gray-700",children:L(I.checkIn)}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-xs md:text-sm text-gray-700",children:L(I.checkOut)||"-"}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:$(I.status)}),r.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-xs md:text-sm text-gray-700 max-w-[150px] truncate",children:I.workProgress||"-"}),r.jsx("td",{className:"px-4 py-3 text-xs md:text-sm text-gray-700 max-w-[200px]",children:r.jsxs("div",{className:"space-y-1",children:[I.taskDescription?r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"truncate cursor-pointer font-medium hover:text-blue-600",children:I.taskDescription}),r.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-64 bg-gray-900 text-white text-xs rounded-lg p-2 shadow-lg z-50 invisible opacity-0 group-hover:visible group-hover:opacity-100 transition-all duration-200 break-words",children:[I.taskDescription,r.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 -mt-1 w-2 h-2 bg-gray-900 rotate-45"})]})]}):r.jsx("span",{className:"text-gray-400 italic",children:"-"}),I.earlyLoginReason&&r.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Early Login:"})," ",I.earlyLoginReason]}),I.lateLoginReason&&r.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Late Login:"})," ",I.lateLoginReason]})]})}),r.jsx("td",{className:"px-4 py-3 text-xs md:text-sm max-w-[150px]",children:I.logoutDescription?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"font-medium truncate",children:I.logoutDescription}),I.earlyLogoutReason&&r.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[r.jsx("span",{className:"font-medium",children:"Early Logout:"})," ",I.earlyLogoutReason]})]}):"-"})]},I._id))})]})})})]})]}),R==="reports"&&r.jsx(IP,{token:n,addNotification:F,attendanceRecords:e})]})]}),r.jsx(IN,{isOpen:N,onClose:()=>{S(!1),C(""),A(null)},onReject:me,remarks:E,setRemarks:C})]})},xw="#104774",zP="#0d3a61",FP=()=>{const{token:n,user:e}=ls(),[t,s]=_.useState([]),[i,l]=_.useState(!0),[c,u]=_.useState(new Date().getFullYear()),[h,m]=_.useState(new Date().getMonth()+1),[p,x]=_.useState([]),[y,v]=_.useState(null),[w,A]=_.useState(!1);_.useEffect(()=>{S()},[c,h]);const N=(P,Z="info",z=3500)=>{const K=Date.now()+Math.random();x(W=>[...W,{id:K,message:P,type:Z}]),setTimeout(()=>x(W=>W.filter(ce=>ce.id!==K)),z)},S=async()=>{try{l(!0);const P=await xe.get(`/payroll/employee/my-payrolls?year=${c}&month=${h}`,{headers:{Authorization:`Bearer ${n}`}});s(P.data.data||[])}catch(P){console.error("Error fetching payrolls:",P),N(P.response?.data?.message||"Could not fetch payroll records","error"),s([])}finally{l(!1)}},E=async P=>{try{const Z=await xe.get(`/payroll/payslip/${P}`,{headers:{Authorization:`Bearer ${n}`},responseType:"blob"}),z=new Blob([Z.data],{type:"application/pdf"}),K=window.URL.createObjectURL(z),W=document.createElement("a");W.href=K,W.download=`payslip-${P}.pdf`,document.body.appendChild(W),W.click(),document.body.removeChild(W),window.URL.revokeObjectURL(K),N("Payslip downloaded successfully","success")}catch(Z){console.error("Error downloading payslip:",Z),Z.response?.status===404?Z.response?.data?.message==="Payslip not generated yet"?N("Payslip not ready yet. Please try again later.","error"):N("Payslip file missing. Contact HR.","error"):N(Z.response?.data?.message||"Error downloading payslip","error")}},C=P=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(P),R=P=>new Date(P).toLocaleDateString("en-IN",{day:"numeric",month:"long",year:"numeric"}),D=P=>{const Z={draft:"bg-gray-100 text-gray-800",pending_approval:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${Z[P]||"bg-gray-100 text-gray-800"}`,children:P.replace("_"," ").toUpperCase()})},O=["January","February","March","April","May","June","July","August","September","October","November","December"],H=new Date().getFullYear(),F=Array.from({length:5},(P,Z)=>H-Z);return i?r.jsx("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin inline-block w-8 h-8 border-4 rounded-full",style:{borderColor:xw,borderLeftColor:"transparent"},role:"status"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Loading payroll records..."})]})}):r.jsxs("div",{className:"min-h-[80vh] p-4",children:[r.jsx("style",{children:`
        .primary-btn:hover { background: ${zP} !important }
      `}),r.jsx(Ki,{notifications:p}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"My Payroll & Payslips"}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and download your salary slips"})]}),r.jsxs("div",{className:"mt-4 md:mt-0 flex items-center gap-4 bg-white shadow rounded-lg p-3",children:[r.jsxs("div",{className:"w-28",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Year"}),r.jsx("select",{value:c,onChange:P=>u(parseInt(P.target.value)),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:F.map(P=>r.jsx("option",{value:P,children:P},P))})]}),r.jsxs("div",{className:"w-32",children:[r.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Month"}),r.jsxs("select",{value:h,onChange:P=>m(parseInt(P.target.value)),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[r.jsx("option",{value:"",children:"All"}),O.map((P,Z)=>r.jsx("option",{value:Z+1,children:P},Z+1))]})]})]})]}),r.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:t.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{className:"text-gray-500",children:"No payroll records found"}),r.jsx("p",{className:"text-sm text-gray-400 mt-1",children:h?"Try selecting a different month or year":"No records available for your account"})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full border-collapse",children:[r.jsx("thead",{className:"bg-[#104774] ",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-white",children:"Month"}),r.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-white",children:"Generated On"}),r.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-white",children:"Net Salary"}),r.jsx("th",{className:"px-6 py-3 text-center text-sm font-semibold text-white",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-center text-sm font-semibold text-white",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:t.sort((P,Z)=>{const z=new Date(`${P.year}-${P.month}-01`);return new Date(`${Z.year}-${Z.month}-01`)-z}).map(P=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsxs("td",{className:"px-6 py-4 text-sm text-gray-800 font-medium",children:[O[parseInt(P.month.split("-")[1])-1]," ",P.year]}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:R(P.approvedAt)}),r.jsx("td",{className:"px-6 py-4 text-right text-sm font-semibold text-green-600",children:C(P.netPay)}),r.jsx("td",{className:"px-6 py-4 text-center",children:D(P.status)}),r.jsxs("td",{className:"px-6 py-4 text-center space-x-2",children:[r.jsx("button",{onClick:()=>{v(P),A(!0)},className:"px-3 py-1 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 text-sm",children:"View"}),P.status==="approved"&&r.jsx("button",{onClick:()=>E(P._id),className:"px-3 py-1 rounded-md text-white text-sm primary-btn",style:{backgroundColor:xw},children:"Download"}),P.status==="rejected"&&P.rejectionReason&&r.jsxs("p",{className:"mt-2 text-xs text-red-600",children:["Reason: ",P.rejectionReason]})]})]},P._id))})]})})}),w&&y&&r.jsx(UP,{payroll:y,onClose:()=>A(!1),formatCurrency:C})]})},UP=({payroll:n,onClose:e,formatCurrency:t})=>r.jsx("div",{className:"fixed inset-0 backdrop-blur-xs bg-opacity-40 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-gray-200 shadow-2xl",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Salary Details - ",n.month]}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-green-700 mb-4",children:"Earnings"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Basic Salary:"}),r.jsx("span",{className:"font-semibold",children:t(n.basic)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"House Rent Allowance (HRA):"}),r.jsx("span",{className:"font-semibold",children:t(n.hra)})]}),n.allowances&&n.allowances.map((s,i)=>r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{children:[s.title,":"]}),r.jsx("span",{className:"font-semibold",children:t(s.amount)})]},i)),r.jsx("div",{className:"border-t pt-2 mt-2",children:r.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[r.jsx("span",{children:"Total Earnings:"}),r.jsx("span",{className:"text-green-600",children:t(n.totalEarnings)})]})})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-red-700 mb-4",children:"Deductions"}),r.jsxs("div",{className:"space-y-3",children:[n.absentDeduction>0&&r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{children:["Absent Days Deduction (",n.absentDays," days):"]}),r.jsxs("span",{className:"font-semibold text-red-600",children:["-",t(n.absentDeduction)]})]}),n.deductions&&n.deductions.map((s,i)=>r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{children:[s.title,":"]}),r.jsxs("span",{className:"font-semibold text-red-600",children:["-",t(s.amount)]})]},i)),n.tax>0&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Tax:"}),r.jsxs("span",{className:"font-semibold text-red-600",children:["-",t(n.tax)]})]}),r.jsx("div",{className:"border-t pt-2 mt-2",children:r.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[r.jsx("span",{children:"Total Deductions:"}),r.jsxs("span",{className:"text-red-600",children:["-",t(n.totalDeductions)]})]})})]})]})]}),r.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-blue-50 to-green-50 rounded-lg",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Net Salary"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:t(n.netPay)})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${n.status==="approved"?"bg-green-100 text-green-800":n.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:n.status.replace("_"," ").toUpperCase()})]})]})}),r.jsx("div",{className:"mt-6 flex justify-end",children:r.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Close"})})]})}),qP="#104774",VP=({isOpen:n,onClose:e,onCreate:t,token:s,addNotification:i})=>{const[l,c]=_.useState(!1),[u,h]=_.useState([]),[m,p]=_.useState([]),[x,y]=_.useState([]),[v,w]=_.useState(""),[A,N]=_.useState(!1),[S,E]=_.useState({employeeId:"",month:new Date().getMonth()+1,year:new Date().getFullYear(),basic:0,hra:0,allowances:[],deductions:[],tax:0,taxPercentage:0}),[C,R]=_.useState({title:"",amount:0}),[D,O]=_.useState({title:"",amount:0}),[H,F]=_.useState(null),[P,Z]=_.useState(null),[z,K]=_.useState(null);_.useEffect(()=>{n&&(W(),E(ge=>({...ge,month:new Date().getMonth()+1,year:new Date().getFullYear()})),F(null),Z(null),K(null),w(""),p([]),y([]))},[n]),_.useEffect(()=>{v?ce(v):(p([]),y([]))},[v]),_.useEffect(()=>{x.length>0&&me()},[S.month,S.year,x]),_.useEffect(()=>{S.employeeId?(L(S.employeeId),q(S.employeeId,S.month,S.year)):(F(null),Z(null),K(null))},[S.employeeId,S.month,S.year]),_.useEffect(()=>{if(S.taxPercentage>0&&S.basic>0){const ge=Math.round(S.basic*S.taxPercentage/100);E(we=>({...we,tax:ge}))}else S.taxPercentage===0&&E(ge=>({...ge,tax:0}))},[S.taxPercentage,S.basic]);const W=async()=>{try{const ge=await xe.get("/departments",{headers:{Authorization:`Bearer ${s}`}});h(ge.data.data||[])}catch(ge){console.error(ge),i("Failed to fetch departments","error")}},ce=async ge=>{try{const we=await xe.get(`/departments/${ge}/employees`,{headers:{Authorization:`Bearer ${s}`}});y(we.data.data||[])}catch(we){console.error(we),i("Failed to fetch employees","error")}},me=async()=>{N(!0);try{const we=(await Promise.all(x.map(async ke=>{try{const te=await xe.get(`/payroll/employee/${ke._id}/exists?month=${S.month}&year=${S.year}`,{headers:{Authorization:`Bearer ${s}`}});return{emp:ke,hasPayroll:!!te.data.exists}}catch{return{emp:ke,hasPayroll:!1}}}))).filter(ke=>!ke.hasPayroll).map(ke=>ke.emp);p(we),S.employeeId&&!we.some(ke=>ke._id===S.employeeId)&&E(ke=>({...ke,employeeId:""}))}catch(ge){console.error(ge),p(x)}finally{N(!1)}},L=async ge=>{try{const ke=(await xe.get(`/payroll/employee/${ge}/latest`,{headers:{Authorization:`Bearer ${s}`}})).data?.data||null;if(Z(ke),ke&&typeof ke.basic=="number")E(te=>({...te,basic:ke.basic,hra:ke.hra??te.hra}));else try{const be=(await xe.get(`/profiles/${ge}`,{headers:{Authorization:`Bearer ${s}`}})).data?.data?.basicSalary??prev.basic;E(ve=>({...ve,basic:be}))}catch{}}catch(we){console.error("Error fetching latest payroll:",we)}},q=async(ge,we,ke)=>{try{const te=await xe.get(`/payroll/preview?employeeId=${ge}&month=${we}&year=${ke}&basic=${S.basic||0}&hra=${S.hra||0}&allowances=${JSON.stringify(S.allowances)}&deductions=${JSON.stringify(S.deductions)}&taxPercentage=${S.taxPercentage||0}`,{headers:{Authorization:`Bearer ${s}`}});K(te.data)}catch(te){console.error("Error fetching payroll preview:",te),K(null),I()}},$=ge=>Array.isArray(ge)?ge.reduce((we,ke)=>we+(Number(ke.amount)||0),0):0,I=()=>{if(!S.employeeId){i("Select employee to preview","error");return}const ge=Number(S.basic||0),we=Number(S.hra||0),ke=$(S.allowances),te=$(S.deductions),be=Number(S.tax||0),ve=ge/31;let Ee=0,Ye=0,J=0,Se=0;if(z)Ee=z.absent||0,Ye=z.workingDays||0,J=z.approvedLeaves||0,Se=z.absentDeduction||0;else if(H){const oe=Number(H.present||0),Ne=Number(H.leave||0),_e=Number(H.holidays||0),Ue=Number(H.sundays||0);Ye=Number(H.totalWorkingDays||31-(_e+Ue)),Ee=Number(H.absent??Ye-(oe+Ne)),Ee<0&&(Ee=0),Se=Math.round(ve*Ee),J=Ne}const Ie=Math.round(ge+we+ke),Xe=Math.round(te+be+Se),wt=Math.round(Ie-Xe),qt={basic:ge,hra:we,allowancesSum:ke,deductionsSum:te,tax:be,dailyRate:+ve.toFixed(2),workingDays:Ye,presentDays:Ye-Ee-J,leaveDays:J,absent:Ee,absentDeduction:Se,totalEarnings:Ie,totalDeductions:Xe,netPay:wt};return K(qt),qt},T=async ge=>{if(ge.preventDefault(),!S.employeeId)return i("Please select an employee","error");c(!0);try{const we={employeeId:S.employeeId,month:S.month,year:S.year,basic:Number(S.basic||0),hra:Number(S.hra||0),allowances:S.allowances||[],deductions:S.deductions||[],taxPercentage:S.taxPercentage||0},ke=await xe.post("/payroll/monthly",we,{headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});window.location.reload(),i(ke.data?.message||"Payroll created","success"),E({employeeId:"",month:new Date().getMonth()+1,year:new Date().getFullYear(),basic:0,hra:0,allowances:[],deductions:[],tax:0,taxPercentage:0}),F(null),K(null),w(""),t&&t(ke.data.data),e()}catch(we){console.error("Error creating payroll:",we)}finally{c(!1)}},V=()=>{!C.title||!C.amount||(E(ge=>({...ge,allowances:[...ge.allowances,{title:C.title,amount:Number(C.amount)}]})),R({title:"",amount:0}))},M=ge=>E(we=>({...we,allowances:we.allowances.filter((ke,te)=>te!==ge)})),G=()=>{!D.title||!D.amount||(E(ge=>({...ge,deductions:[...ge.deductions,{title:D.title,amount:Number(D.amount)}]})),O({title:"",amount:0}))},de=ge=>E(we=>({...we,deductions:we.deductions.filter((ke,te)=>te!==ge)})),re=ge=>{const{name:we,value:ke}=ge.target;["basic","hra","tax","taxPercentage"].includes(we)?E(te=>({...te,[we]:Number(ke)})):E(te=>({...te,[we]:ke}))},ye=ge=>{w(ge.target.value),E(we=>({...we,employeeId:""}))};if(!n)return null;const je=$(S.allowances),Le=$(S.deductions)+Number(S.tax||0),he=Math.round(Number(S.basic||0)+Number(S.hra||0)+je);z?z.netPay:Math.round(he-Le);const $e=["January","February","March","April","May","June","July","August","September","October","November","December"];return new Date().getFullYear(),r.jsx("div",{className:"fixed inset-0 backdrop-blur-sm bg-opacity-40 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto shadow-xl",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Create New Payroll"}),r.jsxs("span",{className:"text-gray-600",children:[$e[S.month-1]," ",S.year]})]}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:"✖"})]}),r.jsxs("form",{onSubmit:T,className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department *"}),r.jsxs("select",{value:v,onChange:ye,required:!0,className:"w-full p-3 border border-gray-300 rounded-md",children:[r.jsx("option",{value:"",children:"Select Department"}),u.map(ge=>r.jsx("option",{value:ge,children:ge},ge))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee *"}),r.jsxs("select",{name:"employeeId",value:S.employeeId,onChange:re,required:!0,disabled:!v||A,className:"w-full p-3 border border-gray-300 rounded-md",children:[r.jsx("option",{value:"",children:"Select Employee"}),A?r.jsx("option",{disabled:!0,children:"Checking payroll status..."}):m.length===0&&v?r.jsx("option",{disabled:!0,children:"All employees already have payroll for this period"}):m.map(ge=>r.jsxs("option",{value:ge._id,children:[ge.firstName," ",ge.lastName," (",ge.employeeId,")"]},ge._id))]})]})]}),r.jsx("input",{type:"hidden",name:"month",value:S.month}),r.jsx("input",{type:"hidden",name:"year",value:S.year}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Basic Salary *"}),r.jsx("input",{name:"basic",type:"number",value:S.basic,onChange:re,required:!0,min:0,className:"w-full p-3 border border-gray-300 rounded-md"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"HRA"}),r.jsx("input",{name:"hra",type:"number",value:S.hra,onChange:re,min:0,className:"w-full p-3 border border-gray-300 rounded-md"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tax (%)"}),r.jsx("input",{name:"taxPercentage",type:"number",value:S.taxPercentage,onChange:re,min:0,max:100,step:.1,className:"w-full p-3 border border-gray-300 rounded-md"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tax Amount"}),r.jsx("input",{name:"tax",type:"number",value:S.tax,onChange:re,readOnly:!0,className:"w-full p-3 border border-gray-300 rounded-md bg-gray-100"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Allowances"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{placeholder:"Title",value:C.title,onChange:ge=>R(we=>({...we,title:ge.target.value})),className:"flex-1 p-2 border rounded"}),r.jsx("input",{placeholder:"Amount",type:"number",value:C.amount,onChange:ge=>R(we=>({...we,amount:Number(ge.target.value)})),className:"w-28 p-2 border rounded"}),r.jsx("button",{type:"button",onClick:V,className:"px-3 py-2 bg-green-600 text-white rounded",children:"Add"})]}),S.allowances.map((ge,we)=>r.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[r.jsxs("span",{children:[ge.title,": ₹",(ge.amount||0).toLocaleString()]}),r.jsx("button",{type:"button",onClick:()=>M(we),className:"text-red-600",children:"Remove"})]},we))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deductions"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{placeholder:"Title",value:D.title,onChange:ge=>O(we=>({...we,title:ge.target.value})),className:"flex-1 p-2 border rounded"}),r.jsx("input",{placeholder:"Amount",type:"number",value:D.amount,onChange:ge=>O(we=>({...we,amount:Number(ge.target.value)})),className:"w-28 p-2 border rounded"}),r.jsx("button",{type:"button",onClick:G,className:"px-3 py-2 bg-green-600 text-white rounded",children:"Add"})]}),S.deductions.map((ge,we)=>r.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[r.jsxs("span",{children:[ge.title,": ₹",(ge.amount||0).toLocaleString()]}),r.jsx("button",{type:"button",onClick:()=>de(we),className:"text-red-600",children:"Remove"})]},we))]})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Salary Breakdown"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Basic Salary:"}),r.jsxs("span",{children:["₹",Number(S.basic||0).toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"HRA:"}),r.jsxs("span",{children:["₹",Number(S.hra||0).toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Allowances:"}),r.jsxs("span",{children:["₹",je.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between text-green-600 font-medium",children:[r.jsx("span",{children:"Total Earnings:"}),r.jsxs("span",{children:["₹",(Number(S.basic||0)+Number(S.hra||0)+je).toLocaleString()]})]}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Deductions:"}),r.jsxs("span",{className:"text-red-600",children:["-₹",$(S.deductions).toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{children:["Tax (",S.taxPercentage||0,"%):"]}),r.jsxs("span",{className:"text-red-600",children:["-₹",Number(S.tax||0).toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between text-red-600 font-medium",children:[r.jsx("span",{children:"Total Deductions:"}),r.jsxs("span",{children:["-₹",($(S.deductions)+Number(S.tax||0)).toLocaleString()]})]}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between text-lg font-bold pt-2",children:[r.jsx("span",{children:"Net Pay:"}),r.jsxs("span",{className:"text-green-600",children:["₹",(Number(S.basic||0)+Number(S.hra||0)+je-($(S.deductions)+Number(S.tax||0))).toLocaleString()]})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border rounded",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:l||!S.employeeId,className:"px-4 py-2 rounded text-white",style:{backgroundColor:qP},children:l?"Creating...":"Create Payroll"})]})]})]})})},BN=({isOpen:n,onClose:e,payroll:t,onUpdate:s,onApproveReject:i,actionLoading:l,formatCurrency:c,isHR:u=!1})=>{const[h,m]=_.useState(!1),[p,x]=_.useState({...t}),[y,v]=_.useState(""),[w,A]=_.useState("summary"),N=ce=>{const{name:me,value:L}=ce.target;x(q=>({...q,[me]:me==="basic"||me==="hra"||me==="tax"?Number(L):L}))},S=(ce,me,L)=>{const q=[...p.allowances||[]];q[ce][me]=me==="amount"?Number(L):L,x($=>({...$,allowances:q}))},E=(ce,me,L)=>{const q=[...p.deductions||[]];q[ce][me]=me==="amount"?Number(L):L,x($=>({...$,deductions:q}))},C=()=>{x(ce=>({...ce,allowances:[...ce.allowances||[],{title:"",amount:0}]}))},R=ce=>{x(me=>({...me,allowances:(me.allowances||[]).filter((L,q)=>q!==ce)}))},D=()=>{x(ce=>({...ce,deductions:[...ce.deductions||[],{title:"",amount:0}]}))},O=ce=>{x(me=>({...me,deductions:(me.deductions||[]).filter((L,q)=>q!==ce)}))},H=ce=>(ce||[]).reduce((me,L)=>me+(L.amount||0),0),F=H(p.allowances),P=H(p.deductions)+(p.tax||0),Z=(p.basic||0)+(p.hra||0)+F,z=Z-P,K=t.basic/(t.workingDays||22),W=t.absentDeduction/(t.absentDays||1);return n?r.jsx("div",{className:"fixed inset-0 backdrop-blur-xs bg-opacity-40 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-5xl max-h-[90vh] overflow-y-auto shadow-2xl",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Payroll Details - ",t.employeeProfile?.firstName," ",t.employeeProfile?.lastName]}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsx("div",{className:"flex border-b border-gray-200 mb-6",children:r.jsx("button",{className:`py-2 px-4 font-medium ${w==="summary"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500"}`,onClick:()=>A("summary"),children:"Summary"})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Employee ID"}),r.jsx("p",{className:"font-semibold",children:t.employeeProfile?.employeeId})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Period"}),r.jsxs("p",{className:"font-semibold",children:[t.month," ",t.year]})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${t.status==="approved"?"bg-green-100 text-green-800":t.status==="rejected"?"bg-red-100 text-red-800":t.status==="pending_approval"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.status.replace("_"," ").toUpperCase()})]})]}),w==="summary"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-green-700 mb-4",children:"Earnings"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Basic Salary:"}),h?r.jsx("input",{type:"number",name:"basic",value:p.basic||0,onChange:N,className:"w-32 p-2 border border-gray-300 rounded-md"}):r.jsx("span",{className:"font-semibold",children:c(t.basic||0)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"House Rent Allowance (HRA):"}),h?r.jsx("input",{type:"number",name:"hra",value:p.hra||0,onChange:N,className:"w-32 p-2 border border-gray-300 rounded-md"}):r.jsx("span",{className:"font-semibold",children:c(t.hra||0)})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("span",{className:"font-semibold",children:"Allowances:"}),h&&r.jsx("button",{onClick:C,className:"px-2 py-1 bg-green-600 text-white rounded-md text-sm",children:"+ Add"})]}),r.jsx("div",{className:"space-y-2",children:(p.allowances||[]).map((ce,me)=>r.jsx("div",{className:"flex justify-between items-center",children:h?r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"text",value:ce.title||"",onChange:L=>S(me,"title",L.target.value),placeholder:"Allowance title",className:"flex-1 p-2 border border-gray-300 rounded-md mr-2"}),r.jsx("input",{type:"number",value:ce.amount||0,onChange:L=>S(me,"amount",L.target.value),className:"w-24 p-2 border border-gray-300 rounded-md mr-2"}),r.jsx("button",{onClick:()=>R(me),className:"text-red-600 hover:text-red-800",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):r.jsxs(r.Fragment,{children:[r.jsxs("span",{children:[ce.title||"Allowance",":"]}),r.jsx("span",{className:"font-semibold",children:c(ce.amount||0)})]})},me))})]}),r.jsx("div",{className:"border-t pt-2 mt-2",children:r.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[r.jsx("span",{children:"Total Earnings:"}),r.jsx("span",{className:"text-green-600",children:c(Z)})]})})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-red-700 mb-4",children:"Deductions"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Tax:"}),h?r.jsx("input",{type:"number",name:"tax",value:p.tax||0,onChange:N,className:"w-32 p-2 border border-gray-300 rounded-md"}):r.jsxs("span",{className:"font-semibold text-red-600",children:["-",c(t.tax||0)]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("span",{className:"font-semibold",children:"Other Deductions:"}),h&&r.jsx("button",{onClick:D,className:"px-2 py-1 bg-green-600 text-white rounded-md text-sm",children:"+ Add"})]}),r.jsx("div",{className:"space-y-2",children:(p.deductions||[]).map((ce,me)=>r.jsx("div",{className:"flex justify-between items-center",children:h?r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"text",value:ce.title||"",onChange:L=>E(me,"title",L.target.value),placeholder:"Deduction title",className:"flex-1 p-2 border border-gray-300 rounded-md mr-2"}),r.jsx("input",{type:"number",value:ce.amount||0,onChange:L=>E(me,"amount",L.target.value),className:"w-24 p-2 border border-gray-300 rounded-md mr-2"}),r.jsx("button",{onClick:()=>O(me),className:"text-red-600 hover:text-red-800",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):r.jsxs(r.Fragment,{children:[r.jsxs("span",{children:[ce.title||"Deduction",":"]}),r.jsxs("span",{className:"font-semibold text-red-600",children:["-",c(ce.amount||0)]})]})},me))})]}),r.jsx("div",{className:"border-t pt-2 mt-2",children:r.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[r.jsx("span",{children:"Total Deductions:"}),r.jsxs("span",{className:"text-red-600",children:["-",c(P)]})]})})]})]}),r.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-4 rounded-lg mb-6",children:r.jsx("div",{className:"flex justify-between items-center",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Net Salary"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:c(z)})]})})})]}),w==="breakdown"&&r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Attendance Calculation"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Total Working Days"}),r.jsx("p",{className:"text-lg font-semibold",children:t.workingDays||22}),r.jsx("p",{className:"text-xs text-gray-500",children:"Total days excluding Sundays and holidays"})]}),r.jsxs("div",{className:"bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Present Days"}),r.jsx("p",{className:"text-lg font-semibold text-green-600",children:t.presentDays||0}),r.jsx("p",{className:"text-xs text-gray-500",children:"Days employee was marked present"})]}),r.jsxs("div",{className:"bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Leave Days"}),r.jsx("p",{className:"text-lg font-semibold text-blue-600",children:t.leaveDays||0}),r.jsx("p",{className:"text-xs text-gray-500",children:"Approved paid leaves"})]}),r.jsxs("div",{className:"bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Absent Days"}),r.jsx("p",{className:"text-lg font-semibold text-red-600",children:t.absentDays||0}),r.jsx("p",{className:"text-xs text-gray-500",children:"Days absent without approved leave"})]})]}),r.jsxs("div",{className:"mt-4 bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Daily Rate Calculation"}),r.jsxs("p",{className:"text-sm",children:["₹",t.basic?.toLocaleString()," ÷ ",t.workingDays||22," days = ₹",K.toFixed(2)," per day"]}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Basic salary divided by working days"})]}),t.absentDays>0&&r.jsxs("div",{className:"mt-4 bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Absent Deduction Calculation"}),r.jsxs("p",{className:"text-sm",children:[t.absentDays," days × ₹",W.toFixed(2)," = ₹",t.absentDeduction?.toLocaleString()]}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Absent days multiplied by daily rate"})]})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Tax Calculation"}),r.jsxs("div",{className:"bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Taxable Income"}),r.jsxs("p",{className:"text-lg font-semibold",children:["₹",t.basic?.toLocaleString()]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Basic salary used for tax calculation"})]}),t.tax>0&&r.jsxs("div",{className:"mt-4 bg-white p-3 rounded shadow-sm",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Tax Percentage"}),r.jsxs("p",{className:"text-lg font-semibold",children:[(t.tax/t.basic*100).toFixed(2),"%"]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Applicable tax rate on basic salary"})]})]}),r.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Net Pay Calculation"}),r.jsxs("div",{className:"space-y-2 bg-white p-4 rounded shadow-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Basic Salary:"}),r.jsxs("span",{children:["+₹",t.basic?.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"HRA:"}),r.jsxs("span",{children:["+₹",t.hra?.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Total Allowances:"}),r.jsxs("span",{children:["+₹",F.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between font-semibold border-t pt-2",children:[r.jsx("span",{children:"Gross Earnings:"}),r.jsxs("span",{children:["₹",t.totalEarnings?.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between text-red-600",children:[r.jsx("span",{children:"Tax Deduction:"}),r.jsxs("span",{children:["-₹",t.tax?.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between text-red-600",children:[r.jsx("span",{children:"Absent Deduction:"}),r.jsxs("span",{children:["-₹",t.absentDeduction?.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between text-red-600",children:[r.jsx("span",{children:"Other Deductions:"}),r.jsxs("span",{children:["-₹",H(t.deductions).toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between font-semibold text-red-600 border-t pt-2",children:[r.jsx("span",{children:"Total Deductions:"}),r.jsxs("span",{children:["-₹",t.totalDeductions?.toLocaleString()]})]}),r.jsxs("div",{className:"flex justify-between font-bold text-green-600 text-lg border-t pt-2",children:[r.jsx("span",{children:"Net Pay:"}),r.jsxs("span",{children:["₹",t.netPay?.toLocaleString()]})]})]})]})]}),t.status==="rejected"&&t.rejectionReason&&r.jsxs("div",{className:"bg-red-50 p-4 rounded-lg mb-6",children:[r.jsx("h4",{className:"text-sm font-semibold text-red-800 mb-2",children:"Rejection Reason:"}),r.jsx("p",{className:"text-sm text-red-700",children:t.rejectionReason})]}),r.jsxs("div",{className:"flex flex-wrap gap-3",children:[u&&t.status==="draft"&&r.jsx(r.Fragment,{children:h?r.jsx(r.Fragment,{children:r.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"})}):r.jsx(r.Fragment,{})}),r.jsx("button",{onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Close"})]})]})}):null},yw="#104774",$P="#0d3a61",GP=()=>{const{token:n,user:e}=ls(),[t,s]=_.useState([]),[i,l]=_.useState([]),[c,u]=_.useState(!0),[h,m]=_.useState({year:new Date().getFullYear(),month:new Date().getMonth()+1,status:"",employee:""}),[p,x]=_.useState([]),[y,v]=_.useState(!1),[w,A]=_.useState(null),[N,S]=_.useState(!1),[E,C]=_.useState(null);_.useEffect(()=>{D(),O()},[h]);const R=($,I="info",T=3500)=>{const V=Date.now()+Math.random();x(M=>[...M,{id:V,message:$,type:I}]),setTimeout(()=>x(M=>M.filter(G=>G.id!==V)),T)},D=async()=>{try{u(!0);const $=new URLSearchParams;h.year&&$.append("year",h.year),h.month&&$.append("month",h.month),h.status&&$.append("status",h.status),h.employee&&$.append("employee",h.employee);const I=await xe.get(`/payroll?${$}`,{headers:{Authorization:`Bearer ${n}`}});s(I.data.data||[])}catch($){console.error("Error fetching payrolls:",$),R($.response?.data?.message||"Could not fetch payroll records","error"),s([])}finally{u(!1)}},O=async()=>{try{const $=await xe.get("/employee/all-employees",{headers:{Authorization:`Bearer ${n}`}});l($.data.data||[])}catch($){console.error("Error fetching employees:",$),R("Error fetching employees","error")}},H=async $=>{try{const I=await xe.post("/payroll/monthly",$,{headers:{Authorization:`Bearer ${n}`}});R("Payroll created successfully","success"),v(!1),window.location.reload(),D()}catch(I){console.error("Error creating payroll:",I)}},F=async($,I)=>{try{C($);const T=await xe.put(`/payroll/${$}`,I,{headers:{Authorization:`Bearer ${n}`}});R("Payroll updated successfully","success"),S(!1),D()}catch(T){console.error("Error updating payroll:",T),R(T.response?.data?.message||"Error updating payroll","error")}finally{C(null)}},P=async $=>{try{C($);const I=await xe.patch(`/payroll/${$}/submit`,{},{headers:{Authorization:`Bearer ${n}`}});R("Payroll submitted for approval","success"),D()}catch(I){console.error("Error submitting payroll:",I),R(I.response?.data?.message||"Error submitting payroll","error")}finally{C(null)}},Z=$=>{const{name:I,value:T}=$.target;m(V=>({...V,[I]:T}))},z=()=>{m({year:new Date().getFullYear(),month:new Date().getMonth()+1,status:"",employee:""})},K=$=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format($),W=$=>new Date($).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),ce=$=>{const I={draft:"bg-gray-100 text-gray-800",pending_approval:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${I[$]||"bg-gray-100 text-gray-800"}`,children:$.replace("_"," ").toUpperCase()})},me=["January","February","March","April","May","June","July","August","September","October","November","December"],L=new Date().getFullYear(),q=Array.from({length:3},($,I)=>L+I);return c&&t.length===0?r.jsx("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin inline-block w-8 h-8 border-4 rounded-full",style:{borderColor:yw,borderLeftColor:"transparent"},role:"status"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Loading payroll records..."})]})}):r.jsxs("div",{className:"min-h-[80vh] p-4",children:[r.jsx("style",{children:`
        .primary-btn:hover { background: ${$P} !important }
      `}),r.jsx(Ki,{notifications:p}),r.jsx("header",{className:"mb-6",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Payroll Management"}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage employee payrolls"})]}),r.jsx("button",{onClick:()=>v(!0),className:"px-6 py-3 rounded-md text-white primary-btn",style:{backgroundColor:yw},children:"Create New Payroll"})]})}),r.jsxs("div",{className:"flex flex-col xl:flex-row gap-6 mb-6",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsxs("div",{className:"grid grid-cols-2 xl:grid-cols-4 gap-4",id:"stats-cards",children:[r.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-blue-500 text-center min-w-[200px]",children:[r.jsx("h3",{className:"text-sm text-gray-500",children:"Total Payrolls"}),r.jsx("p",{className:"text-2xl font-bold",children:t.length})]}),r.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-yellow-500 text-center min-w-[200px]",children:[r.jsx("h3",{className:"text-sm text-gray-500",children:"Draft"}),r.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:t.filter($=>$.status==="draft").length})]}),r.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-blue-500 text-center min-w-[200px]",children:[r.jsx("h3",{className:"text-sm text-gray-500",children:"Pending Approval"}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.filter($=>$.status==="pending_approval").length})]}),r.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-green-500 text-center min-w-[200px]",children:[r.jsx("h3",{className:"text-sm text-gray-500",children:"Approved"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter($=>$.status==="approved").length})]})]})}),r.jsx("div",{className:"flex-1 bg-white shadow rounded-lg border-l-4 border-blue-500 flex flex-col",style:{height:"85px"},children:r.jsx("div",{className:"flex-1 p-4",children:r.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 gap-3 h-full items-center",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Year"}),r.jsx("select",{name:"year",value:h.year,onChange:Z,className:"w-full p-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:q.map($=>r.jsx("option",{value:$,children:$},$))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Month"}),r.jsxs("select",{name:"month",value:h.month,onChange:Z,className:"w-full p-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Months"}),me.map(($,I)=>r.jsx("option",{value:I+1,children:$},I+1))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Status"}),r.jsxs("select",{name:"status",value:h.status,onChange:Z,className:"w-full p-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"draft",children:"Draft"}),r.jsx("option",{value:"pending_approval",children:"Pending Approval"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Employee"}),r.jsxs("select",{name:"employee",value:h.employee,onChange:Z,className:"w-full p-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Employees"}),i.map($=>r.jsxs("option",{value:$._id,children:[$.firstName," ",$.lastName," (",$.employeeId,")"]},$._id))]})]}),r.jsx("div",{className:"flex gap-2 justify-center mt-4",children:r.jsxs("button",{onClick:z,className:"px-3 py-2 text-xs bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 transition-colors flex items-center gap-1 border",title:"Clear Filters",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear"]})})]})})})]}),r.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Payroll Records"})}),t.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{className:"text-gray-500",children:"No payroll records found"}),r.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Try adjusting your filters or create a new payroll"})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Period"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Basic Salary"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map($=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:$.employee?.avatarUrl||"/default-avatar.png",alt:""})}),r.jsxs("div",{className:"ml-4",children:[r.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[$.employeeProfile?.firstName," ",$.employeeProfile?.lastName]}),r.jsx("div",{className:"text-sm text-gray-500",children:$.employeeProfile?.employeeId})]})]})}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsxs("div",{className:"text-sm text-gray-900",children:[me[parseInt($.month.split("-")[1])-1]," ",$.year]}),r.jsx("div",{className:"text-sm text-gray-500",children:W($.generatedAt)})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:K($.basic)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ce($.status)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>{A($),S(!0)},className:"text-blue-600 hover:text-blue-900",children:"View"}),$.status==="draft"&&r.jsx(r.Fragment,{children:r.jsx("button",{onClick:()=>P($._id),disabled:E===$._id,className:"text-green-600 hover:text-green-900 disabled:opacity-50",children:E===$._id?"Processing...":"Submit"})}),$.status==="rejected"&&r.jsx("button",{onClick:()=>{A($),S(!0)},className:"text-yellow-600 hover:text-yellow-900",children:"Edit & Resubmit"})]})})]},$._id))})]})})]}),y&&r.jsx(VP,{isOpen:y,onClose:()=>v(!1),onCreate:H,token:n,addNotification:R}),N&&w&&r.jsx(BN,{isOpen:N,onClose:()=>S(!1),payroll:w,onUpdate:F,onSubmitForApproval:P,actionLoading:E,formatCurrency:K,isHR:!0})]})},bw="#104774",YP="#0d3a61",WP=()=>{const{token:n}=ls(),[e,t]=_.useState([]),[s,i]=_.useState(!0),[l,c]=_.useState({year:new Date().getFullYear(),month:new Date().getMonth()+1,status:"",employee:""}),[u,h]=_.useState([]),[m,p]=_.useState([]),[x,y]=_.useState(null),[v,w]=_.useState(!1),[A,N]=_.useState(null),[S,E]=_.useState({total:0,pending:0,approved:0,rejected:0}),[C,R]=_.useState(new Set),[D,O]=_.useState(""),[H,F]=_.useState(""),[P,Z]=_.useState(!1),z=e.filter(he=>he.status!=="approved").map(he=>he._id),K=z.length;_.useEffect(()=>{ce(),me()},[l]);const W=(he,$e="info",ge=3500)=>{const we=Date.now()+Math.random();p(ke=>[...ke,{id:we,message:he,type:$e}]),setTimeout(()=>p(ke=>ke.filter(te=>te.id!==we)),ge)},ce=async()=>{try{i(!0);const he=new URLSearchParams;l.year&&he.append("year",l.year),l.month&&he.append("month",l.month),l.status&&he.append("status",l.status),l.employee&&he.append("employee",l.employee),he.append("fullData","true");const $e=await xe.get(`/payroll?${he}`,{headers:{Authorization:`Bearer ${n}`}});t($e.data.data||[]),L($e.data.data||[])}catch(he){console.error("Error fetching payrolls:",he),W(he.response?.data?.message||"Could not fetch payroll records","error"),t([])}finally{i(!1)}},me=async()=>{try{const he=await xe.get("/employee/all-employees",{headers:{Authorization:`Bearer ${n}`}});h(he.data.data||[])}catch(he){console.error("Error fetching employees:",he),W("Error fetching employees","error")}},L=he=>{const $e={total:he.length,pending:he.filter(ge=>ge.status==="pending_approval").length,approved:he.filter(ge=>ge.status==="approved").length,rejected:he.filter(ge=>ge.status==="rejected").length};E($e)},q=async(he,$e,ge="")=>{try{N(he);const we=await xe.patch(`/payroll/${he}/approve`,{action:$e,rejectionReason:ge},{headers:{Authorization:`Bearer ${n}`}}),ke=$e==="approve"?"Payroll rolled out successfully":$e==="reject"?"Payroll rejected successfully":`Payroll ${$e}ed successfully`;W(ke,"success"),w(!1),ce()}catch(we){console.error("Error processing payroll:",we),W(we.response?.data?.message||`Error ${$e}ing payroll`,"error")}finally{N(null)}},$=async()=>{if(!D){W("Please select an action first","error");return}if(D==="reject"&&!H.trim()){W("Please provide a rejection reason","error");return}if(C.size===0){W("Please select at least one payroll","error");return}try{N("bulk");const he=Array.from(C).map(ge=>xe.patch(`/payroll/${ge}/approve`,{action:D,rejectionReason:D==="reject"?H:""},{headers:{Authorization:`Bearer ${n}`}}));await Promise.all(he);const $e=D==="approve"?"rolled out":D==="reject"?"rejected":`${D}ed`;W(`${C.size} payrolls ${$e} successfully`,"success"),R(new Set),O(""),F(""),Z(!1),ce()}catch(he){console.error("Error processing bulk action:",he),W(he.response?.data?.message||"Error processing bulk action","error")}finally{N(null)}},I=he=>{if(e.find(we=>we._id===he)?.status==="approved")return;const ge=new Set(C);ge.has(he)?ge.delete(he):ge.add(he),R(ge)},T=()=>{C.size===K?R(new Set):R(new Set(z))},V=he=>{const{name:$e,value:ge}=he.target;c(we=>({...we,[$e]:ge}))},M=()=>{c({year:new Date().getFullYear(),month:new Date().getMonth()+1,status:"",employee:""})},G=he=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(he),de=he=>new Date(he).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),re=he=>{const $e={draft:"bg-gray-100 text-gray-800",pending_approval:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},ge=he==="approved"?"ROLLED OUT":he==="pending_approval"?"PENDING ROLLED OUT":he.replace("_"," ").toUpperCase();return r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${$e[he]||"bg-gray-100 text-gray-800"}`,children:ge})},ye=["January","February","March","April","May","June","July","August","September","October","November","December"],je=new Date().getFullYear(),Le=[je-1,je,je+1];return s&&e.length===0?r.jsx("div",{className:"min-h-screen bg-gray-50 p-6 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin inline-block w-8 h-8 border-4 rounded-full",style:{borderColor:bw,borderLeftColor:"transparent"},role:"status"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Loading payroll records..."})]})}):r.jsxs("div",{className:"min-h-[80vh] p-2 sm:p-4",children:[r.jsx("style",{children:`
        .primary-btn:hover { background: ${YP} !important }
      `}),r.jsx(Ki,{notifications:m}),r.jsx("header",{className:"mb-4 sm:mb-6",children:r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"Payroll Approval"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:"Review and approve employee payrolls"})]}),r.jsxs("button",{onClick:ce,className:"px-3 py-2 sm:px-4 text-xs sm:text-sm rounded-md text-white primary-btn flex items-center gap-2 justify-center",style:{backgroundColor:bw},children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 sm:h-5 sm:w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),r.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})]})}),r.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 sm:gap-6 mb-4 sm:mb-6",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsxs("div",{className:"grid grid-cols-2 xl:grid-cols-4 gap-2 sm:gap-4",id:"stats-cards",children:[r.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow border-l-4 border-blue-500 text-center min-w-[120px] sm:min-w-[200px]",children:[r.jsx("h3",{className:"text-xs sm:text-sm text-gray-500",children:"Total Payrolls"}),r.jsx("p",{className:"text-lg sm:text-2xl font-bold",children:S.total})]}),r.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow border-l-4 border-yellow-500 text-center min-w-[120px] sm:min-w-[200px]",children:[r.jsx("h3",{className:"text-xs sm:text-sm text-gray-500",children:"Pending Approval"}),r.jsx("p",{className:"text-lg sm:text-2xl font-bold text-yellow-600",children:S.pending})]}),r.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow border-l-4 border-green-500 text-center min-w-[120px] sm:min-w-[200px]",children:[r.jsx("h3",{className:"text-xs sm:text-sm text-gray-500",children:"Approved"}),r.jsx("p",{className:"text-lg sm:text-2xl font-bold text-green-600",children:S.approved})]}),r.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-lg shadow border-l-4 border-red-500 text-center min-w-[120px] sm:min-w-[200px]",children:[r.jsx("h3",{className:"text-xs sm:text-sm text-gray-500",children:"Rejected"}),r.jsx("p",{className:"text-lg sm:text-2xl font-bold text-red-600",children:S.rejected})]})]})}),r.jsx("div",{className:"flex-1 bg-white shadow rounded-lg border-l-4 border-blue-500",children:r.jsx("div",{className:"p-3 sm:p-4",children:r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 gap-3 items-end",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Year"}),r.jsx("select",{name:"year",value:l.year,onChange:V,className:"w-full p-2 text-xs sm:text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Le.map(he=>r.jsx("option",{value:he,children:he},he))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Month"}),r.jsxs("select",{name:"month",value:l.month,onChange:V,className:"w-full p-2 text-xs sm:text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Months"}),ye.map((he,$e)=>r.jsx("option",{value:$e+1,children:he},$e+1))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Status"}),r.jsxs("select",{name:"status",value:l.status,onChange:V,className:"w-full p-2 text-xs sm:text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Status"}),r.jsx("option",{value:"pending_approval",children:"Pending Approval"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Employee"}),r.jsxs("select",{name:"employee",value:l.employee,onChange:V,className:"w-full p-2 text-xs sm:text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[r.jsx("option",{value:"",children:"All Employees"}),u.map(he=>r.jsxs("option",{value:he._id,children:[he.firstName," ",he.lastName]},he._id))]})]}),r.jsx("div",{className:"flex justify-center sm:justify-start",children:r.jsxs("button",{onClick:M,className:"px-3 py-2 text-xs bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 transition-colors flex items-center gap-1 border",title:"Clear Filters",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear"]})})]})})})]}),e.length>0&&r.jsxs("div",{className:"mb-4 sm:mb-6 bg-blue-50 p-3 sm:p-4 rounded-lg border border-blue-200",children:[r.jsx("h3",{className:"text-base sm:text-lg font-semibold text-blue-800 mb-3",children:"Bulk Actions"}),r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",checked:C.size===K,onChange:T,className:"h-4 w-4 text-blue-600 rounded"}),r.jsxs("span",{className:"text-xs sm:text-sm text-gray-700",children:["Select all (",C.size," selected)"]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[r.jsxs("select",{value:D,onChange:he=>{O(he.target.value),Z(he.target.value==="reject")},className:"p-2 border border-gray-300 rounded-md text-xs sm:text-sm",children:[r.jsx("option",{value:"",children:"Select Action"}),r.jsx("option",{value:"approve",children:"Roll Out Selected"}),r.jsx("option",{value:"reject",children:"Reject Selected"})]}),P&&r.jsx("input",{type:"text",value:H,onChange:he=>F(he.target.value),placeholder:"Reason for rejection",className:"p-2 border border-gray-300 rounded-md flex-1 text-xs sm:text-sm"}),r.jsx("button",{onClick:$,disabled:A==="bulk"||!D,className:"px-3 sm:px-4 py-2 bg-[#104774] text-white rounded-md hover:bg-[#002442] disabled:opacity-50 flex items-center justify-center gap-2 text-xs sm:text-sm",children:A==="bulk"?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 sm:h-4 sm:w-4 border-b-2 border-white"}),r.jsx("span",{className:"hidden sm:inline",children:"Processing..."})]}):"Apply to Selected"})]})]})]}),r.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[r.jsxs("div",{className:"px-3 sm:px-6 py-3 sm:py-4 border-b border-gray-200 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2",children:[r.jsxs("h2",{className:"text-base sm:text-lg font-semibold text-gray-800",children:["Payroll Records (",e.length,")"]}),r.jsx("span",{className:"text-xs sm:text-sm text-gray-500",children:l.status==="pending_approval"?"Pending Approval":l.status==="approved"?"Approved":l.status==="rejected"?"Rejected":"All Records"})]}),e.length===0?r.jsxs("div",{className:"text-center py-8 sm:py-12 px-4",children:[r.jsx("svg",{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),r.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"No payroll records found"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-400 mt-1",children:l.status==="pending_approval"?"No payrolls pending approval":"Try adjusting your filters"})]}):r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r.jsx("input",{type:"checkbox",checked:C.size===K,onChange:T,className:"h-4 w-4 text-blue-600 rounded"})}),r.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[200px]",children:"Employee"}),r.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[120px]",children:"Period"}),r.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px]",children:"Net Pay"}),r.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[120px]",children:"Status"}),r.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[120px]",children:"Generated By"}),r.jsx("th",{className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[180px]",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(he=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-3 sm:px-6 py-2 sm:py-4 whitespace-nowrap",children:r.jsx("input",{type:"checkbox",checked:C.has(he._id),onChange:()=>I(he._id),className:"h-4 w-4 text-blue-600 rounded",disabled:he.status==="approved",title:he.status==="approved"?"Already Rolled Out":void 0})}),r.jsx("td",{className:"px-3 sm:px-6 py-2 sm:py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-8 w-8 sm:h-10 sm:w-10",children:r.jsx("img",{className:"h-8 w-8 sm:h-10 sm:w-10 rounded-full object-cover",src:he.employee?.avatarUrl||"/default-avatar.png",alt:he.employee?.firstName})}),r.jsxs("div",{className:"ml-2 sm:ml-4",children:[r.jsxs("div",{className:"text-xs sm:text-sm font-medium text-gray-900",children:[he.employee?.firstName," ",he.employee?.lastName]}),r.jsx("div",{className:"text-xs text-gray-400",children:he.employee?.email||"—"}),r.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:he.employee?.employeeId})]})]})}),r.jsxs("td",{className:"px-3 sm:px-6 py-2 sm:py-4 whitespace-nowrap",children:[r.jsxs("div",{className:"text-xs sm:text-sm text-gray-900",children:[ye[parseInt(he.month.split("-")[1],10)-1]," ",he.year]}),he.generatedAt&&r.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:de(he.generatedAt)})]}),r.jsx("td",{className:"px-3 sm:px-6 py-2 sm:py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-xs sm:text-sm font-semibold text-green-600",children:G(he.basic)})}),r.jsx("td",{className:"px-3 sm:px-6 py-2 sm:py-4 whitespace-nowrap",children:re(he.status)}),r.jsx("td",{className:"px-3 sm:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:he.generatedBy||"—"}),r.jsx("td",{className:"px-3 sm:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm font-medium",children:r.jsxs("div",{className:"flex flex-col sm:flex-row gap-1 sm:gap-2",children:[r.jsxs("button",{onClick:()=>{y(he),w(!0)},className:"text-blue-600 hover:text-blue-900 flex items-center gap-1 justify-center sm:justify-start p-1 sm:p-0",children:[r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 sm:h-4 sm:w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),r.jsx("span",{className:"text-xs",children:"Review"})]}),he.status==="pending_approval"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>q(he._id,"approve"),disabled:A===he._id,className:"text-green-600 hover:text-green-900 disabled:opacity-50 flex items-center gap-1 justify-center sm:justify-start p-1 sm:p-0",children:A===he._id?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-green-600"}),r.jsx("span",{className:"text-xs hidden sm:inline",children:"Processing..."})]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 sm:h-4 sm:w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),r.jsx("span",{className:"text-xs",children:"Roll Out"})]})}),r.jsxs("button",{onClick:()=>{y(he),w(!0)},className:"text-red-600 hover:text-red-900 flex items-center gap-1 justify-center sm:justify-start p-1 sm:p-0",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 sm:h-4 sm:w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),r.jsx("span",{className:"text-xs",children:"Reject"})]})]})]})})]},he._id))})]})})]}),v&&x&&r.jsx(BN,{isOpen:v,onClose:()=>w(!1),payroll:x,onApproveReject:q,actionLoading:A,formatCurrency:G,isHR:!1,actionLabel:"Roll Out"})]})},XP=({isOpen:n,onClose:e,onSuccess:t,token:s,leaveBalance:i})=>{const[l,c]=_.useState([]),[u,h]=_.useState({leaveType:"",fromDate:"",toDate:"",reason:"",totalDays:0}),[m,p]=_.useState({}),[x,y]=_.useState(!1),[v,w]=_.useState(!1);_.useEffect(()=>{n&&A()},[n]),_.useEffect(()=>{n||(h({leaveType:"",fromDate:"",toDate:"",reason:"",totalDays:0}),p({}))},[n]);const A=async()=>{try{const D=((await xe.get("/leave/get-leaveTypes",{headers:{Authorization:`Bearer ${s}`}})).data||[]).filter(O=>O.isActive);c(D),D.length>0&&!u.leaveType&&h(O=>({...O,leaveType:D[0].name}))}catch(R){console.error("Error fetching leave types:",R)}},N=(R,D)=>{if(!R||!D)return 0;const O=new Date(R),H=new Date(D);if(O>H)return 0;let F=0;const P=new Date(O);for(;P<=H;){const Z=P.getDay();Z!==0&&Z!==6&&F++,P.setDate(P.getDate()+1)}return F};_.useEffect(()=>{if(u.fromDate&&u.toDate){w(!0);const R=N(u.fromDate,u.toDate);h(D=>({...D,totalDays:R})),w(!1)}else h(R=>({...R,totalDays:0}))},[u.fromDate,u.toDate]);const S=R=>{const{name:D,value:O}=R.target;h(H=>({...H,[D]:O})),m[D]&&p(H=>({...H,[D]:""}))},E=()=>{const R={},D=new Date;if(D.setHours(0,0,0,0),u.leaveType||(R.leaveType="Leave type is required"),u.fromDate?new Date(u.fromDate)<D&&(R.fromDate="Cannot apply for backdated leaves"):R.fromDate="From date is required",u.toDate?u.fromDate&&new Date(u.toDate)<new Date(u.fromDate)&&(R.toDate="To date cannot be before from date"):R.toDate="To date is required",u.reason.trim()?u.reason.length>500&&(R.reason="Reason cannot exceed 500 characters"):R.reason="Reason is required",u.leaveType&&u.totalDays>0){const O=i[u.leaveType]||0;O<u.totalDays&&(R.leaveType=`Insufficient ${u.leaveType} leave balance! You have ${O} days left.`)}return p(R),Object.keys(R).length===0},C=async R=>{if(R.preventDefault(),!!E()){y(!0);try{await xe.post("/leave/create",u,{headers:{Authorization:`Bearer ${s}`}}),t()}catch(D){console.error("Error applying leave:",D);const O=D.response?.data?.message||"Error applying leave. Please try again.";p({submit:O})}finally{y(!1)}}};return n?r.jsx("div",{className:"fixed inset-0  bg-opacity-50 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:r.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md relative max-h-[90vh] overflow-y-auto shadow-xl border border-gray-200",children:[r.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(Zr,{size:24})}),r.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Apply for Leave"}),r.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Fill in the details to apply for leave"}),m.submit&&r.jsxs("div",{className:"mb-4 p-3 bg-red-50 text-red-700 rounded-lg text-sm flex items-center",children:[r.jsx(as,{size:16,className:"mr-2"}),m.submit]}),r.jsxs("form",{onSubmit:C,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block mb-2 font-medium text-sm text-gray-700",children:"Leave Type"}),r.jsxs("select",{name:"leaveType",value:u.leaveType,onChange:S,className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",children:[r.jsx("option",{value:"",children:"Select Leave Type"}),l.map(R=>r.jsxs("option",{value:R.name,children:[R.name.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase()),i[R.name]!==void 0&&` (${i[R.name]} days available)`]},R._id))]}),m.leaveType&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(as,{size:12,className:"mr-1"}),m.leaveType]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block mb-2 font-medium text-sm text-gray-700",children:"From Date"}),r.jsx("input",{type:"date",name:"fromDate",value:u.fromDate,onChange:S,min:new Date().toISOString().split("T")[0],className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm"}),m.fromDate&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(as,{size:12,className:"mr-1"}),m.fromDate]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-2 font-medium text-sm text-gray-700",children:"To Date"}),r.jsx("input",{type:"date",name:"toDate",value:u.toDate,onChange:S,min:u.fromDate||new Date().toISOString().split("T")[0],className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm"}),m.toDate&&r.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[r.jsx(as,{size:12,className:"mr-1"}),m.toDate]})]})]}),u.fromDate&&u.toDate&&r.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-100",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-blue-700 font-medium",children:"Working Days:"}),r.jsx("span",{className:"text-blue-800 font-semibold",children:v?r.jsxs("span",{className:"flex items-center",children:[r.jsx(pn,{size:14,className:"mr-1 animate-pulse"}),"Calculating..."]}):`${u.totalDays} day${u.totalDays!==1?"s":""}`})]}),r.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"(Excludes weekends)"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-2 font-medium text-sm text-gray-700",children:"Reason"}),r.jsx("textarea",{name:"reason",value:u.reason,onChange:S,rows:4,className:"w-full border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-[#104774] text-sm",placeholder:"Please provide a reason for your leave"}),r.jsxs("div",{className:"flex justify-between mt-1",children:[r.jsxs("div",{className:"text-xs text-gray-500",children:[u.reason.length,"/500 characters"]}),m.reason&&r.jsxs("p",{className:"text-red-500 text-xs flex items-center",children:[r.jsx(as,{size:12,className:"mr-1"}),m.reason]})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 text-sm font-medium transition-colors",disabled:x,children:"Cancel"}),r.jsx("button",{type:"submit",disabled:x,className:"px-4 py-2 rounded-lg bg-[#104774] text-white hover:bg-[#0d3a61] text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:x?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Applying..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Es,{size:16,className:"mr-2"}),"Apply for Leave"]})})]})]})]})}):null},QP=()=>{const{token:n,user:e}=ls(),[t,s]=_.useState({attendance:{},leaveBalance:{},attendanceSummary:{},leaveApplications:[]}),[i,l]=_.useState(!0),[c,u]=_.useState(!1),[h,m]=_.useState(!1),[p,x]=_.useState(!1),[y,v]=_.useState(!1),[w,A]=_.useState([]),[N,S]=_.useState([]),E=il(),C=(W,ce="info",me=4e3)=>{const L=Date.now()+Math.random();S(q=>[...q,{id:L,message:W,type:ce}]),setTimeout(()=>S(q=>q.filter($=>$.id!==L)),me)},R=async()=>{try{u(!0);const ce=(await xe.get("/attendance/today",{headers:{Authorization:`Bearer ${n}`}})).data||{},L=(await xe.get("/leave/balance",{headers:{Authorization:`Bearer ${n}`}})).data?.balance||{},$=(await xe.get("/attendance/history",{headers:{Authorization:`Bearer ${n}`}})).data||[],I=new Date,T=new Date;T.setDate(I.getDate()-30);const V={present:$.filter(de=>de.status==="accepted"&&new Date(de.date)>=T).length,absent:0,leave:$.filter(de=>de.status==="on_leave"&&new Date(de.date)>=T).length,holidays:0},G=(await xe.get("/leave/my-requests",{headers:{Authorization:`Bearer ${n}`}})).data||[];s({attendance:ce,leaveBalance:L,attendanceSummary:V,leaveApplications:G})}catch(W){console.error("Error fetching dashboard data:",W)}finally{l(!1),u(!1)}},D=async()=>{try{const ce=((await xe.get("/leave/get-leaveTypes",{headers:{Authorization:`Bearer ${n}`}})).data||[]).filter(me=>me.isActive);A(ce)}catch(W){console.error("Error fetching leave types:",W)}};_.useEffect(()=>{R(),D()},[]);const O=()=>{m(!1),R()},H=()=>{x(!1),R()},F=()=>{v(!1),R()},P=W=>W?yo(new Date(W),"dd MMM yy"):"",Z=W=>W.replace(/_/g," ").replace(/\b\w/g,ce=>ce.toUpperCase());if(i)return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#104774]"})});const K=Math.round(t.attendanceSummary.present/26*100);return r.jsxs("div",{className:"min-h-[80vh] p-6 bg-gray-50",children:[r.jsx(Ki,{notifications:N}),r.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Employee Dashboard"}),r.jsxs("p",{className:"text-gray-600",children:["Welcome back, ",e?.name,"! Here's your overview for today."]})]}),r.jsxs("button",{onClick:R,disabled:c,className:"bg-[#104774] text-white px-4 py-2 rounded-lg flex items-center disabled:opacity-50",children:[r.jsx(zi,{className:`w-4 h-4 mr-2 ${c?"animate-spin":""}`}),c?"Refreshing...":"Refresh Data"]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 flex flex-col h-[280px]",children:[r.jsx("div",{className:"flex items-center mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"Today's Attendance"})}),r.jsx("div",{className:"mb-4",children:r.jsx("span",{className:`px-3 py-1.5 rounded-full text-sm font-medium ${t.attendance.status==="accepted"?"bg-green-100 text-green-700":t.attendance.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:t.attendance.status?t.attendance.status.charAt(0).toUpperCase()+t.attendance.status.slice(1):"Not marked"})}),r.jsxs("div",{className:"space-y-2 mb-6 flex-grow overflow-y-auto pr-1 scrollbar-hide",children:[r.jsxs("div",{className:"text-sm text-slate-600 flex items-center",children:["Log In:"," ",r.jsx("span",{className:"font-medium text-slate-900 ml-1",children:t.attendance.checkIn?new Date(t.attendance.checkIn).toLocaleTimeString():"Not logged in"})]}),r.jsxs("div",{className:"text-sm text-slate-600 flex items-center",children:["Log Out:"," ",r.jsx("span",{className:"font-medium text-slate-900 ml-1",children:t.attendance.checkOut?new Date(t.attendance.checkOut).toLocaleTimeString():"Pending"})]})]}),t.attendance.checkOut?r.jsx("div",{className:"w-full text-center py-3 px-4 bg-gray-100 text-gray-700 rounded-xl font-medium",children:"Today's Session Ended"}):t.attendance.checkIn?r.jsx("button",{onClick:()=>x(!0),className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-3 px-4 rounded-xl font-medium transition-all duration-300 transform hover:scale-[1.02] shadow-md hover:shadow-lg mt-auto",children:"Log Out"}):r.jsx("button",{onClick:()=>m(!0),className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-3 px-4 rounded-xl font-medium transition-all duration-300 transform hover:scale-[1.02] shadow-md hover:shadow-lg mt-auto",children:"Mark Attendance"})]}),r.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 flex flex-col h-[280px]",children:[r.jsx("div",{className:"flex items-center mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"Leaves Summary"})}),r.jsxs("div",{className:"space-y-2 mb-6 flex-grow overflow-y-auto pr-1 scrollbar-hide",children:[r.jsxs("div",{className:"text-sm text-slate-600",children:["Total Leaves:"," ",r.jsx("span",{className:"font-medium text-slate-900",children:(t.leaveBalance.sick||0)+(t.leaveBalance.casual||0)+(t.leaveBalance.paid||0)})]}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Sick:"," ",r.jsx("span",{className:"font-medium text-red-500 ml-1",children:t.leaveBalance.sick||0})]}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Casual:"," ",r.jsx("span",{className:"font-medium text-blue-500 ml-1",children:t.leaveBalance.casual||0})]}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Paid:"," ",r.jsx("span",{className:"font-medium text-green-500 ml-1",children:t.leaveBalance.paid||0})]})]}),r.jsx("button",{onClick:()=>v(!0),className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-3 px-4 rounded-xl font-medium transition-all duration-300 transform hover:scale-[1.02] shadow-md hover:shadow-lg mt-auto",children:"Apply for Leave"})]}),r.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 flex flex-col h-[280px]",children:[r.jsx("div",{className:"flex items-center mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"Recent Leaves"})}),r.jsxs("div",{className:"space-y-3 mb-6 flex-grow max-h-[200px] overflow-y-auto pr-1 scrollbar-hide",children:[t.leaveApplications.slice(0,5).map((W,ce)=>r.jsxs("div",{className:"text-sm pb-2 last:border-0",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"font-medium text-slate-800",children:Z(W.leaveType)}),r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${W.status==="approved"?"bg-green-100 text-green-700":W.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:W.status})]}),r.jsxs("div",{className:"text-slate-600",children:[P(W.fromDate)," - ",P(W.toDate)]})]},ce)),t.leaveApplications.length===0&&r.jsx("div",{className:"text-sm text-slate-500 text-center py-4 mt-9",children:"No leave applications yet"})]}),r.jsx("button",{onClick:()=>E("/employee/leaves"),className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-3 px-4 rounded-xl font-medium transition-all duration-300 transform hover:scale-[1.02] shadow-md hover:shadow-lg mt-auto",children:"View All Leaves"})]}),r.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 flex flex-col h-[280px]",children:[r.jsx("div",{className:"flex items-center mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"Performance"})}),r.jsxs("div",{className:"space-y-2 mb-6 flex-grow overflow-y-auto pr-1 scrollbar-hide",children:[r.jsxs("div",{className:"text-sm text-slate-600",children:["Attendance Rate:"," ",r.jsxs("span",{className:"font-medium text-slate-900",children:[K,"%"]})]}),r.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${K}%`}})}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Present Days:"," ",r.jsx("span",{className:"font-medium text-slate-900",children:t.attendanceSummary.present||0})]}),r.jsxs("div",{className:"text-sm text-slate-600",children:["Leaves Taken:"," ",r.jsx("span",{className:"font-medium text-slate-900",children:t.attendanceSummary.leave||0})]})]}),r.jsx("button",{onClick:()=>E("/employee/attendance"),className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-3 px-4 rounded-xl font-medium transition-all duration-300 transform hover:scale-[1.02] shadow-md hover:shadow-lg mt-auto",children:"View Attendance"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-md hover:shadow-lg transition-all duration-300 border border-slate-200 flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"text-xl font-semibold text-slate-800 flex items-center",children:[r.jsx(YC,{className:"w-5 h-5 mr-2 text-blue-500"}),"Attendance Summary"]}),r.jsx("span",{className:"text-sm text-gray-500",children:"Last 30 Days"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4 flex-grow",children:[r.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg border border-green-100",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:t.attendanceSummary.present||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Present days"})]}),r.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg border border-blue-100",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:t.attendanceSummary.leave||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"On leave days"})]}),r.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg border border-yellow-100",children:[r.jsx("div",{className:"text-2xl font-bold text-yellow-600 mb-1",children:"25"}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Working days"})]}),r.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg border border-purple-100",children:[r.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:t.attendanceSummary.holidays||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Holidays"})]})]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-5 shadow-md hover:shadow-lg transition-all duration-300 border border-blue-100",children:[r.jsxs("div",{className:"flex items-center justify-between mb-5",children:[r.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"Leave Balance"}),r.jsx("span",{className:"text-sm text-gray-500",children:"Remaining"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-5",children:[r.jsxs("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm border border-slate-100",children:[r.jsx("div",{className:"text-2xl font-bold text-red-500 mb-1",children:t.leaveBalance.sick||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Sick Leave"})]}),r.jsxs("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm border border-slate-100",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-500 mb-1",children:t.leaveBalance.casual||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Casual Leave"})]}),r.jsxs("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm border border-slate-100",children:[r.jsx("div",{className:"text-2xl font-bold text-green-500 mb-1",children:t.leaveBalance.paid||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Paid Leave"})]}),r.jsxs("div",{className:"text-center p-4 bg-white rounded-xl shadow-sm border border-slate-100",children:[r.jsx("div",{className:"text-2xl font-bold text-purple-500 mb-1",children:t.leaveBalance.other||0}),r.jsx("div",{className:"text-xs text-slate-600 font-medium",children:"Other Leave"})]})]})]})]}),r.jsx(Iu,{isOpen:h,onClose:()=>m(!1),onSuccess:O,token:n,addNotification:C}),r.jsx(Bu,{isOpen:p,onClose:()=>x(!1),onSuccess:H,attendanceData:t.attendance,token:n,addNotification:C}),r.jsx(XP,{isOpen:y,onClose:()=>v(!1),onSuccess:F,token:n,leaveBalance:t.leaveBalance,leaveTypes:w,addNotification:C})]})},ZP=()=>{const{token:n,user:e}=ls(),t=il(),[s,i]=_.useState(null),[l,c]=_.useState([]),[u,h]=_.useState(null),[m,p]=_.useState({}),[x,y]=_.useState(!0),[v,w]=_.useState(!1),[A,N]=_.useState(!1),[S,E]=_.useState(!1);_.useEffect(()=>{C(),R()},[]);const C=async()=>{try{w(!0);const[z,K,W]=await Promise.all([xe.get("/dashboard/hr/stats"),xe.get("/dashboard/hr/attendance-log"),xe.get("/dashboard/hr/pending-approvals")]);i(z.data.data),c(K.data.data),h(W.data.data)}catch(z){console.error("Error fetching HR dashboard data:",z),alert("Error loading dashboard data")}finally{y(!1),w(!1)}},R=async()=>{try{const z=await xe.get("/attendance/hr/today",{headers:{Authorization:`Bearer ${n}`}});p(z.data||{})}catch(z){console.error("Error fetching HR attendance:",z)}},D=z=>{p(z),N(!1)},O=z=>{p(z),E(!1)},H=async z=>{try{await xe.patch(`/dashboard/hr/approve-attendance/${z}`,{status:"approved"}),alert("Attendance approved!"),C(),R()}catch(K){alert(K.response?.data?.message||"Error approving attendance")}},F=async z=>{try{await xe.patch(`/dashboard/hr/approve-attendance/${z}`,{status:"rejected"}),alert("Attendance rejected!"),C(),R()}catch(K){alert(K.response?.data?.message||"Error rejecting attendance")}},P=()=>N(!0),Z=()=>E(!0);return x?r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#104774]"})}):r.jsxs("div",{className:"min-h-[80vh] p-6",children:[r.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"HR Dashboard"}),r.jsxs("p",{className:"text-gray-600",children:["Welcome back, ",e?.name,"! Here's your overview for today."]})]}),r.jsxs("button",{onClick:()=>{C(),R()},disabled:v,className:"bg-[#104774] text-white px-4 py-2 rounded-lg flex items-center disabled:opacity-50",children:[r.jsx(zi,{className:`w-4 h-4 mr-2 ${v?"animate-spin":""}`}),v?"Refreshing...":"Refresh Data"]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[r.jsxs("div",{onClick:()=>{m.checkIn?m.checkIn&&!m.checkOut&&Z():P()},className:"bg-gradient-to-r from-yellow-100 to-yellow-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 cursor-pointer flex flex-col h-[180px]",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"Your Attendance"}),r.jsx("span",{className:`px-3 py-1.5 rounded-full text-xs font-medium ${m.status==="accepted"?"bg-green-100 text-green-700":m.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-700 text-yellow-200"}`,children:m.status?m.status.charAt(0).toUpperCase()+m.status.slice(1):"Not marked"})]}),r.jsxs("div",{className:"space-y-2 flex-grow overflow-y-auto pr-1 scrollbar-hide",children:[r.jsxs("div",{className:"text-sm text-slate-600 flex items-center",children:["Log In:"," ",r.jsx("span",{className:"font-medium text-slate-900 ml-1",children:m.checkIn?new Date(m.checkIn).toLocaleTimeString():"Not logged in"})]}),r.jsxs("div",{className:"text-sm text-slate-600 flex items-center",children:["Log Out:"," ",r.jsx("span",{className:"font-medium text-slate-900 ml-1",children:m.checkOut?new Date(m.checkOut).toLocaleTimeString():"Pending"})]})]}),r.jsx("div",{className:"text-center text-sm text-slate-700",children:m.checkOut?"Today's Session Ended":m.checkIn?"Click to Log Out":"Click to Mark Attendance"})]}),r.jsxs("div",{onClick:()=>t("/manage-employees"),className:"bg-gradient-to-r from-blue-100 to-blue-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 cursor-pointer",children:[r.jsx("div",{className:"mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"Total Employees"})}),r.jsx("div",{className:"text-3xl font-bold text-slate-800 mb-2",children:s?.totalEmployees||0}),r.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Active"})]}),r.jsxs("div",{onClick:()=>t("/hr/leaves"),className:"bg-gradient-to-r from-orange-100 to-orange-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 cursor-pointer",children:[r.jsx("div",{className:"mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"Pending Approvals"})}),r.jsxs("div",{className:"flex items-baseline mb-2",children:[r.jsx("span",{className:"text-3xl font-bold text-slate-800 mr-2",children:u?.leaveRequests||0}),r.jsx("span",{className:"text-lg text-slate-600",children:"Leave Requests"})]}),r.jsxs("div",{className:"flex items-baseline",children:[r.jsx("span",{className:"text-3xl font-bold text-slate-800 mr-2",children:u?.attendance||0}),r.jsx("span",{className:"text-lg text-slate-600",children:"Attendance"})]})]}),r.jsxs("div",{onClick:()=>t("/hr/payroll"),className:"bg-gradient-to-r from-green-100 to-green-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 cursor-pointer",children:[r.jsx("div",{className:"mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"Payroll Processed"})}),r.jsxs("div",{className:"text-3xl font-bold text-slate-800 mb-2",children:[s?.processedPayroll||0,"/",s?.totalEmployees||0]}),r.jsx("p",{className:"text-sm text-slate-600",children:"This Month"})]}),r.jsxs("div",{className:"bg-gradient-to-r from-purple-100 to-purple-200 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 cursor-pointer",children:[r.jsx("div",{className:"mb-4",children:r.jsx("h3",{className:"font-semibold text-slate-800 text-lg",children:"New Joiners"})}),r.jsx("div",{className:"text-3xl font-bold text-slate-800 mb-2",children:s?.newJoiners||0}),r.jsx("p",{className:"text-sm text-slate-600",children:"This Week"})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-slate-200 mb-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-slate-800",children:"Log in/Out"}),r.jsx(pn,{className:"w-5 h-5 text-slate-400"})]}),r.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200 shadow-sm",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{className:"bg-[#104774] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Name"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Team"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Log in"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Log out"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Task"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Notes"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide",children:"Action"})]})}),r.jsx("tbody",{children:l.map((z,K)=>r.jsxs("tr",{className:`${K%2===0?"bg-white":"bg-slate-50"} hover:bg-slate-100 transition-colors`,children:[r.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-800",children:z.name}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:z.team}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:z.checkIn?new Date(z.checkIn).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-"}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:z.checkOut?new Date(z.checkOut).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-"}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:z.task||"-"}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:z.notes||"-"}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${z.status==="Logged in"?"bg-green-100 text-green-700":z.status==="Pending"?"bg-yellow-100 text-yellow-700":z.status==="Rejected"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:z.status})}),r.jsx("td",{className:"px-4 py-3 flex gap-2",children:z.status==="Pending"&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>H(z._id),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1.5 rounded-md text-sm font-medium flex items-center gap-1 transition-colors",children:[r.jsx(js,{className:"w-4 h-4"}),"Approve"]}),r.jsxs("button",{onClick:()=>F(z._id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded-md text-sm font-medium flex items-center gap-1 transition-colors",children:[r.jsx(mn,{className:"w-4 h-4"}),"Reject"]})]})})]},z._id||K))})]})})]}),A&&r.jsx(Iu,{isOpen:A,onClose:()=>N(!1),onSuccess:D,token:n,addNotification:z=>alert(z),basePath:"/attendance/hr"}),S&&r.jsx(Bu,{isOpen:S,onClose:()=>E(!1),onSuccess:O,attendanceData:m,token:n,addNotification:z=>alert(z),basePath:"/attendance/hr"})]})},KP=()=>{const[n,e]=_.useState(null),[t,s]=_.useState([]),[i,l]=_.useState(!0),[c,u]=_.useState(!1),h=il();_.useEffect(()=>{m()},[]);const m=async()=>{try{u(!0);const[N,S]=await Promise.all([xe.get("/dashboard/admin/stats"),xe.get("/dashboard/admin/attendance-log")]);e(N.data.data),s(S.data.data)}catch(N){console.error("Error fetching admin dashboard data:",N),alert("Error loading dashboard data")}finally{l(!1),u(!1)}},p=async N=>{try{await xe.patch(`/dashboard/admin/approve-attendance/${N}`),m()}catch{alert("Error approving attendance")}},x=async N=>{try{await xe.patch(`/dashboard/admin/reject-attendance/${N}`),m()}catch{alert("Error rejecting attendance")}},y=()=>h("/admin/attendance"),v=()=>h("/admin/leaves"),w=()=>h("/admin/payroll-approval"),A=N=>N?new Date(N).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-";return i?r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#104774]"})}):r.jsxs("div",{className:"max-h-[80vh] p-4 md:p-6",children:[r.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[r.jsxs("div",{className:"text-center sm:text-left",children:[r.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:"Admin Dashboard"}),r.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:"System overview and management"})]}),r.jsxs("button",{onClick:m,disabled:c,className:"bg-[#104774] text-white px-4 py-2 rounded-lg flex items-center justify-center disabled:opacity-50 w-full sm:w-auto",children:[r.jsx(zi,{className:`w-4 h-4 mr-2 ${c?"animate-spin":""}`}),c?"Refreshing...":"Refresh Data"]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 md:gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white rounded-xl md:rounded-2xl p-4 md:p-6 shadow-lg border border-slate-200",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-gradient-to-r from-blue-100 to-blue-200 rounded-lg md:rounded-xl flex items-center justify-center mr-3 md:mr-4",children:r.jsx(pn,{className:"w-5 h-5 md:w-6 md:h-6 text-blue-600"})}),r.jsx("h3",{className:"font-semibold text-slate-800 text-base md:text-lg",children:"Today's Attendance"})]}),r.jsxs("div",{className:"space-y-2 mb-4",children:[r.jsxs("div",{className:"flex justify-between text-sm md:text-base",children:[r.jsx("span",{className:"text-slate-600",children:"Present Today:"}),r.jsx("span",{className:"font-bold text-green-600",children:n?.attendance?.present||0})]}),r.jsxs("div",{className:"flex justify-between text-sm md:text-base",children:[r.jsx("span",{className:"text-slate-600",children:"Absent Today:"}),r.jsx("span",{className:"font-bold text-red-600",children:n?.attendance?.absent||0})]}),r.jsxs("div",{className:"flex justify-between text-sm md:text-base",children:[r.jsx("span",{className:"text-slate-600",children:"On Leave:"}),r.jsx("span",{className:"font-bold text-orange-600",children:n?.attendance?.onLeave||0})]})]}),r.jsxs("button",{onClick:y,className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-2 px-4 rounded-lg md:rounded-xl font-medium flex items-center justify-center transition-all duration-300 text-sm md:text-base",children:["Go to Attendance",r.jsx(im,{className:"w-4 h-4 ml-2"})]})]}),r.jsxs("div",{className:"bg-white rounded-xl md:rounded-2xl p-4 md:p-6 shadow-lg border border-slate-200",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-gradient-to-r from-green-100 to-green-200 rounded-lg md:rounded-xl flex items-center justify-center mr-3 md:mr-4",children:r.jsx(Es,{className:"w-5 h-5 md:w-6 md:h-6 text-green-600"})}),r.jsx("h3",{className:"font-semibold text-slate-800 text-base md:text-lg",children:"Leaves Summary"})]}),r.jsxs("div",{className:"space-y-2 mb-4",children:[r.jsxs("div",{className:"flex justify-between text-sm md:text-base",children:[r.jsx("span",{className:"text-slate-600",children:"Pending Leaves:"}),r.jsx("span",{className:"font-bold text-yellow-600",children:n?.leaves?.pending||0})]}),r.jsxs("div",{className:"flex justify-between text-sm md:text-base",children:[r.jsx("span",{className:"text-slate-600",children:"Approved:"}),r.jsx("span",{className:"font-bold text-green-600",children:n?.leaves?.approved||0})]}),r.jsxs("div",{className:"flex justify-between text-sm md:text-base",children:[r.jsx("span",{className:"text-slate-600",children:"Rejected:"}),r.jsx("span",{className:"font-bold text-red-600",children:n?.leaves?.rejected||0})]})]}),r.jsxs("button",{onClick:v,className:"w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-2 px-4 rounded-lg md:rounded-xl font-medium flex items-center justify-center transition-all duration-300 text-sm md:text-base",children:["Go to Leaves",r.jsx(im,{className:"w-4 h-4 ml-2"})]})]}),r.jsxs("div",{className:"bg-white rounded-xl md:rounded-2xl p-4 md:p-6 shadow-lg border border-slate-200 flex flex-col h-full",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-gradient-to-r from-purple-100 to-purple-200 rounded-lg md:rounded-xl flex items-center justify-center mr-3 md:mr-4",children:r.jsx(CC,{className:"w-5 h-5 md:w-6 md:h-6 text-purple-600"})}),r.jsx("h3",{className:"font-semibold text-slate-800 text-base md:text-lg",children:"Payroll Summary"})]}),r.jsxs("div",{className:"space-y-2 mb-4",children:[r.jsxs("div",{className:"flex justify-between text-sm md:text-base",children:[r.jsx("span",{className:"text-slate-600",children:"Employees:"}),r.jsx("span",{className:"font-bold text-slate-800",children:n?.payroll?.employees||0})]}),r.jsxs("div",{className:"flex justify-between text-sm md:text-base",children:[r.jsx("span",{className:"text-slate-600",children:"Status:"}),r.jsx("span",{className:"font-bold text-blue-600",children:n?.payroll?.status||"Not available"})]})]}),r.jsxs("button",{onClick:w,className:"mt-auto w-full bg-[#104774] hover:bg-[#0d3a61] text-white py-2 px-4 rounded-lg md:rounded-xl font-medium flex items-center justify-center transition-all duration-300 text-sm md:text-base",children:["Go to Payroll",r.jsx(im,{className:"w-4 h-4 ml-2"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-xl md:rounded-2xl p-4 md:p-6 shadow-lg border border-slate-200 mb-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4 md:mb-6",children:[r.jsx("h2",{className:"text-lg md:text-xl font-semibold text-slate-800",children:"Log in/Out"}),r.jsx(pn,{className:"w-5 h-5 text-slate-400"})]}),r.jsx("div",{className:"block md:hidden space-y-4",children:t.map((N,S)=>r.jsxs("div",{className:"bg-white rounded-xl p-5 border border-slate-200 shadow-sm hover:shadow-md transition-shadow duration-200",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Name"}),r.jsx("p",{className:"text-sm font-medium text-slate-900",children:N.name})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Team"}),r.jsx("p",{className:"text-sm text-slate-700",children:N.team})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Login"}),r.jsx("p",{className:"text-sm text-slate-700",children:A(N.checkIn)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Logout"}),r.jsx("p",{className:"text-sm text-slate-700",children:A(N.checkOut)})]})]}),r.jsxs("div",{className:"space-y-3 mb-4 bg-slate-50 p-3 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Task"}),r.jsx("p",{className:"text-sm text-slate-700",children:N.task||"-"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Work Progress"}),r.jsx("p",{className:"text-sm text-slate-700",children:N.workProgress||"-"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:"Logout Notes"}),r.jsx("p",{className:"text-sm text-slate-700",children:N.notes||"-"})]})]}),r.jsx("div",{className:"flex justify-start items-center mb-4",children:r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${N.status==="Logged in"?"bg-green-100 text-green-800":N.status==="Pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:N.status})}),N.action==="Approve"&&r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("button",{onClick:()=>p(N._id),className:"flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",children:[r.jsx(js,{className:"w-5 h-5"})," Approve"]}),r.jsxs("button",{onClick:()=>x(N._id),className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",children:[r.jsx(mn,{className:"w-5 h-5"})," Reject"]})]})]},S))}),r.jsx("div",{className:"hidden md:block overflow-x-auto rounded-lg border border-slate-200 shadow-sm",children:r.jsxs("table",{className:"w-full border-collapse",children:[r.jsx("thead",{className:"bg-[#104774] text-white",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase",children:"Name"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase",children:"Team"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase",children:"Login"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase",children:"Logout"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase",children:"Task"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase",children:"Work Progress"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase",children:"Logout Notes"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase",children:"Status"}),r.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase",children:"Action"})]})}),r.jsx("tbody",{children:t.map((N,S)=>r.jsxs("tr",{className:`${S%2===0?"bg-white":"bg-slate-50"} hover:bg-slate-100`,children:[r.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-800",children:N.name}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:N.team}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:A(N.checkIn)}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:A(N.checkOut)}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:N.task||"-"}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:N.workProgress||"-"}),r.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:N.notes||"-"}),r.jsx("td",{className:"px-4 py-3",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N.status==="Logged in"?"bg-green-100 text-green-700":N.status==="Pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:N.status})}),r.jsx("td",{className:"px-4 py-3 flex gap-2",children:N.action==="Approve"&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>p(N._id),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1.5 rounded-md text-sm font-medium flex items-center gap-1",children:[r.jsx(js,{className:"w-4 h-4"})," Approve"]}),r.jsxs("button",{onClick:()=>x(N._id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded-md text-sm font-medium flex items-center gap-1",children:[r.jsx(mn,{className:"w-4 h-4"})," Reject"]})]})})]},S))})]})})]})]})},JP=()=>{const[n,e]=_.useState(""),[t,s]=_.useState(""),[i,l]=_.useState(""),[c,u]=_.useState(""),[h,m]=_.useState(!1),[p,x]=_.useState(!1),[y,v]=_.useState(!1),[w,A]=_.useState(""),[N,S]=_.useState(""),[E,C]=_.useState(1),{requestPasswordReset:R,verifyOtp:D,resetPassword:O}=ls(),H=async z=>{if(z.preventDefault(),A(""),S(""),v(!0),!n){A("Please enter your email address"),v(!1);return}if(!n.includes("@")){A("Please enter a valid email address"),v(!1);return}try{await R(n),S("OTP has been sent to your email"),C(2)}catch(K){A(K.response?.data?.message||"Failed to send OTP")}finally{v(!1)}},F=async z=>{if(z.preventDefault(),A(""),S(""),v(!0),!t||t.length!==6){A("Please enter a valid 6-digit OTP"),v(!1);return}try{await D(n,t),S("OTP verified successfully"),C(3)}catch(K){A(K.response?.data?.message||"Invalid OTP")}finally{v(!1)}},P=async z=>{if(z.preventDefault(),A(""),S(""),v(!0),!i||!c){A("Please fill in all fields"),v(!1);return}if(i!==c){A("Passwords do not match"),v(!1);return}if(i.length<6){A("Password must be at least 6 characters long"),v(!1);return}try{await O(n,t,i),S("Password has been reset successfully"),setTimeout(()=>{window.location.href="/login"},2e3)}catch(K){A(K.response?.data?.message||"Failed to reset password")}finally{v(!1)}},Z=()=>{E===1?window.location.href="/login":(C(E-1),A(""),S(""))};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 flex items-center justify-center px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"max-w-md w-full space-y-8",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto h-16 w-16 bg-[#104774] rounded-full flex items-center justify-center mb-4",children:r.jsx(Ur,{className:"h-8 w-8 text-white"})}),r.jsxs("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:[E===1&&"Reset Your Password",E===2&&"Enter OTP",E===3&&"Create New Password"]}),r.jsxs("p",{className:"text-gray-600",children:[E===1&&"Enter your email to receive a verification code",E===2&&"Enter the 6-digit code sent to your email",E===3&&"Enter your new password"]})]}),r.jsxs("button",{onClick:Z,className:"flex items-center text-sm text-[#104774] hover:text-[#0d385d] font-medium transition-colors duration-200",children:[r.jsx(dC,{className:"h-4 w-4 mr-1"}),"Back"]}),r.jsx("div",{className:"bg-white py-8 px-6 shadow-xl rounded-xl border border-gray-100",children:r.jsxs("form",{onSubmit:E===1?H:E===2?F:P,className:"space-y-6",children:[w&&r.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[r.jsx(as,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),r.jsx("span",{className:"text-sm text-red-700",children:w})]}),N&&r.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[r.jsx(js,{className:"h-5 w-5 text-green-500 flex-shrink-0"}),r.jsx("span",{className:"text-sm text-green-700",children:N})]}),E===1&&r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email address"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(c1,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] focus:border-[#104774] focus:z-10 sm:text-sm transition-colors duration-200",placeholder:"Enter your email",value:n,onChange:z=>e(z.target.value),disabled:y})]})]}),E===2&&r.jsxs("div",{children:[r.jsx("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700 mb-2",children:"Verification Code"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(Ur,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"otp",name:"otp",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:"6",autoComplete:"one-time-code",required:!0,className:"appearance-none relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] focus:border-[#104774] focus:z-10 sm:text-sm transition-colors duration-200 tracking-widest",placeholder:"Enter 6-digit code",value:t,onChange:z=>{const K=z.target.value.replace(/\D/g,"");s(K.slice(0,6))},disabled:y})]}),r.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Enter the 6-digit code sent to ",n]})]}),E===3&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(Ur,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"password",name:"password",type:h?"text":"password",autoComplete:"new-password",required:!0,className:"appearance-none relative block w-full pl-10 pr-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] focus:border-[#104774] focus:z-10 sm:text-sm transition-colors duration-200",placeholder:"Enter new password",value:i,onChange:z=>l(z.target.value),disabled:y}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>m(!h),disabled:y,children:h?r.jsx(Ym,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):r.jsx(To,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(Ur,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:p?"text":"password",autoComplete:"new-password",required:!0,className:"appearance-none relative block w-full pl-10 pr-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#104774] focus:border-[#104774] focus:z-10 sm:text-sm transition-colors duration-200",placeholder:"Confirm new password",value:c,onChange:z=>u(z.target.value),disabled:y}),r.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>x(!p),disabled:y,children:p?r.jsx(Ym,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):r.jsx(To,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]})]}),r.jsx("div",{children:r.jsx("button",{type:"submit",disabled:y,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-[#104774] hover:bg-[#0d385d] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#104774] disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105 active:scale-95",children:y?r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),r.jsx("span",{children:E===1?"Sending OTP...":E===2?"Verifying...":"Resetting..."})]}):r.jsxs(r.Fragment,{children:[E===1&&"Send OTP",E===2&&"Verify OTP",E===3&&"Reset Password"]})})})]})}),r.jsx("div",{className:"text-center",children:r.jsxs("p",{className:"text-sm text-gray-600",children:["Remember your password?"," ",r.jsx("a",{href:"/login",className:"font-medium text-[#104774] hover:text-[#0d385d] transition-colors duration-200",children:"Sign in"})]})})]})})};function eI(){const{user:n,loading:e}=ls();return r.jsx(x_,{children:r.jsxs(WE,{children:[r.jsx(xt,{path:"/login",element:r.jsx(ZC,{})}),r.jsx(xt,{path:"/forgot-password",element:r.jsx(JP,{})}),r.jsxs(xt,{path:"/admin",element:r.jsx(xm,{allowedRoles:["admin"],children:r.jsx(JC,{})}),children:[r.jsx(xt,{index:!0,element:r.jsx(r.Fragment,{children:r.jsx(KP,{})})}),r.jsx(xt,{path:"manage-employees",element:r.jsx(lv,{})}),r.jsx(xt,{path:"profile",element:r.jsx(ym,{})}),r.jsx(xt,{path:"calendar",element:r.jsx(Pm,{})}),r.jsx(xt,{path:"leaves",element:r.jsx(DP,{})}),r.jsx(xt,{path:"attendance",element:r.jsx(HP,{})}),r.jsx(xt,{path:"payroll-approval",element:r.jsx(WP,{})})]}),r.jsxs(xt,{path:"/hr",element:r.jsx(xm,{allowedRoles:["hr"],children:r.jsx(eT,{})}),children:[r.jsx(xt,{index:!0,element:r.jsx(r.Fragment,{children:r.jsx(ZP,{})})}),r.jsx(xt,{path:"manage-employees",element:r.jsx(lv,{})}),r.jsx(xt,{path:"profile",element:r.jsx(ym,{})}),r.jsx(xt,{path:"calendar",element:r.jsx(Pm,{})}),r.jsx(xt,{path:"leaves",element:r.jsx(NO,{})}),r.jsx(xt,{path:"attendance",element:r.jsx(PP,{})}),r.jsx(xt,{path:"payroll",element:r.jsx(GP,{})})]}),r.jsxs(xt,{path:"/employee",element:r.jsx(xm,{allowedRoles:["employee"],children:r.jsx(tT,{})}),children:[r.jsx(xt,{index:!0,element:r.jsx(r.Fragment,{children:r.jsx(QP,{})})}),r.jsx(xt,{path:"profile",element:r.jsx(ym,{})}),r.jsx(xt,{path:"calendar",element:r.jsx(Pm,{})}),r.jsx(xt,{path:"leaves",element:r.jsx(AO,{})}),r.jsx(xt,{path:"attendance",element:r.jsx(MP,{})}),r.jsx(xt,{path:"payslip",element:r.jsx(FP,{})})]}),r.jsx(xt,{path:"/",element:n===null&&e?r.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading..."}):n?n.role==="admin"?r.jsx(pa,{to:"/admin",replace:!0}):n.role==="hr"?r.jsx(pa,{to:"/hr",replace:!0}):r.jsx(pa,{to:"/employee",replace:!0}):r.jsx(pa,{to:"/login",replace:!0})}),r.jsx(xt,{path:"*",element:r.jsx(pa,{to:"/"})})]})})}sE.createRoot(document.getElementById("root")).render(r.jsx(_.StrictMode,{children:r.jsx(nC,{children:r.jsx(eI,{})})}));
